if (window.FR == null) {window.FR = {};}FR.servletURL = '/ReportServer';FR.serverURL = '';FR.server = 'http://localhost:8075';FR.PROJECTNAME = '';FR.shouldSendHeartBeat = true;(function(){var v=this;var k=v._;var I=Array.prototype,g=Object.prototype,n=Function.prototype;var L=I.push,l=I.slice,c=g.toString,j=g.hasOwnProperty;var s=Array.isArray,e=Object.keys,J=n.bind,B=Object.create;var E=function(){};var P=function(Q){if(Q instanceof P){return Q}if(!(this instanceof P)){return new P(Q)}this._wrapped=Q};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=P}exports._=P}else{v._=P}P.VERSION="1.8.3";var b=function(R,Q,S){if(Q===void 0){return R
}switch(S==null?3:S){case 1:return function(T){return R.call(Q,T)};case 2:return function(U,T){return R.call(Q,U,T)};case 3:return function(U,T,V){return R.call(Q,U,T,V)};case 4:return function(T,V,U,W){return R.call(Q,T,V,U,W)}}return function(){return R.apply(Q,arguments)}};var F=function(R,Q,S){if(R==null){return P.identity}if(P.isFunction(R)){return b(R,Q,S)}if(P.isObject(R)){return P.matcher(R)}return P.property(R)};P.iteratee=function(R,Q){return F(R,Q,Infinity)};var p=function(R,Q){return function(Z){var X=arguments.length;
if(X<2||Z==null){return Z}for(var T=1;T<X;T++){var Y=arguments[T],W=R(Y),S=W.length;for(var V=0;V<S;V++){var U=W[V];if(!Q||Z[U]===void 0){Z[U]=Y[U]}}}return Z}};var C=function(R){if(!P.isObject(R)){return{}}if(B){return B(R)}E.prototype=R;var Q=new E;E.prototype=null;return Q};var M=function(Q){return function(R){return R==null?void 0:R[Q]}};var K=Math.pow(2,53)-1;var O=M("length");var D=function(R){var Q=O(R);return typeof Q=="number"&&Q>=0&&Q<=K};P.each=P.forEach=function(U,V,R){V=b(V,R);var Q,T;
if(D(U)){for(Q=0,T=U.length;Q<T;Q++){V(U[Q],Q,U)}}else{var S=P.keys(U);for(Q=0,T=S.length;Q<T;Q++){V(U[S[Q]],S[Q],U)}}return U};P.map=P.collect=function(V,X,S){X=F(X,S);var U=!D(V)&&P.keys(V),T=(U||V).length,R=Array(T);for(var Q=0;Q<T;Q++){var W=U?U[Q]:Q;R[Q]=X(V[W],W,V)}return R};function z(Q){function R(W,Y,S,V,T,U){for(;T>=0&&T<U;T+=Q){var X=V?V[T]:T;S=Y(S,W[X],X,W)}return S}return function(X,Y,S,U){Y=b(Y,U,4);var W=!D(X)&&P.keys(X),V=(W||X).length,T=Q>0?0:V-1;if(arguments.length<3){S=X[W?W[T]:T];
T+=Q}return R(X,Y,S,W,T,V)}}P.reduce=P.foldl=P.inject=z(1);P.reduceRight=P.foldr=z(-1);P.find=P.detect=function(T,Q,S){var R;if(D(T)){R=P.findIndex(T,Q,S)}else{R=P.findKey(T,Q,S)}if(R!==void 0&&R!==-1){return T[R]}};P.filter=P.select=function(T,Q,S){var R=[];Q=F(Q,S);P.each(T,function(W,U,V){if(Q(W,U,V)){R.push(W)}});return R};P.reject=function(S,Q,R){return P.filter(S,P.negate(F(Q)),R)};P.every=P.all=function(V,Q,S){Q=F(Q,S);var U=!D(V)&&P.keys(V),T=(U||V).length;for(var R=0;R<T;R++){var W=U?U[R]:R;
if(!Q(V[W],W,V)){return false}}return true};P.some=P.any=function(V,Q,S){Q=F(Q,S);var U=!D(V)&&P.keys(V),T=(U||V).length;for(var R=0;R<T;R++){var W=U?U[R]:R;if(Q(V[W],W,V)){return true}}return false};P.contains=P.includes=P.include=function(T,S,Q,R){if(!D(T)){T=P.values(T)}if(typeof Q!="number"||R){Q=0}return P.indexOf(T,S,Q)>=0};P.invoke=function(S,T){var Q=l.call(arguments,2);var R=P.isFunction(T);return P.map(S,function(V){var U=R?T:V[T];return U==null?U:U.apply(V,Q)})};P.pluck=function(R,Q){return P.map(R,P.property(Q))
};P.where=function(R,Q){return P.filter(R,P.matcher(Q))};P.findWhere=function(R,Q){return P.find(R,P.matcher(Q))};P.max=function(T,V,Q){var Y=-Infinity,W=-Infinity,X,S;if(V==null&&T!=null){T=D(T)?T:P.values(T);for(var U=0,R=T.length;U<R;U++){X=T[U];if(X>Y){Y=X}}}else{V=F(V,Q);P.each(T,function(ab,Z,aa){S=V(ab,Z,aa);if(S>W||S===-Infinity&&Y===-Infinity){Y=ab;W=S}})}return Y};P.min=function(T,V,Q){var Y=Infinity,W=Infinity,X,S;if(V==null&&T!=null){T=D(T)?T:P.values(T);for(var U=0,R=T.length;U<R;U++){X=T[U];
if(X<Y){Y=X}}}else{V=F(V,Q);P.each(T,function(ab,Z,aa){S=V(ab,Z,aa);if(S<W||S===Infinity&&Y===Infinity){Y=ab;W=S}})}return Y};P.shuffle=function(U){var V=D(U)?U:P.values(U);var T=V.length;var Q=Array(T);for(var R=0,S;R<T;R++){S=P.random(0,R);if(S!==R){Q[R]=Q[S]}Q[S]=V[R]}return Q};P.sample=function(R,S,Q){if(S==null||Q){if(!D(R)){R=P.values(R)}return R[P.random(R.length-1)]}return P.shuffle(R).slice(0,Math.max(0,S))};P.sortBy=function(R,S,Q){S=F(S,Q);return P.pluck(P.map(R,function(V,T,U){return{value:V,index:T,criteria:S(V,T,U)}
}).sort(function(W,V){var U=W.criteria;var T=V.criteria;if(U!==T){if(U>T||U===void 0){return 1}if(U<T||T===void 0){return -1}}return W.index-V.index}),"value")};var q=function(Q){return function(T,U,S){var R={};U=F(U,S);P.each(T,function(X,V){var W=U(X,V,T);Q(R,X,W)});return R}};P.groupBy=q(function(Q,S,R){if(P.has(Q,R)){Q[R].push(S)}else{Q[R]=[S]}});P.indexBy=q(function(Q,S,R){Q[R]=S});P.countBy=q(function(Q,S,R){if(P.has(Q,R)){Q[R]++}else{Q[R]=1}});P.toArray=function(Q){if(!Q){return[]}if(P.isArray(Q)){return l.call(Q)
}if(D(Q)){return P.map(Q,P.identity)}return P.values(Q)};P.size=function(Q){if(Q==null){return 0}return D(Q)?Q.length:P.keys(Q).length};P.partition=function(U,Q,S){Q=F(Q,S);var T=[],R=[];P.each(U,function(W,V,X){(Q(W,V,X)?T:R).push(W)});return[T,R]};P.first=P.head=P.take=function(S,R,Q){if(S==null){return void 0}if(R==null||Q){return S[0]}return P.initial(S,S.length-R)};P.initial=function(S,R,Q){return l.call(S,0,Math.max(0,S.length-(R==null||Q?1:R)))};P.last=function(S,R,Q){if(S==null){return void 0
}if(R==null||Q){return S[S.length-1]}return P.rest(S,Math.max(0,S.length-R))};P.rest=P.tail=P.drop=function(S,R,Q){return l.call(S,R==null||Q?1:R)};P.compact=function(Q){return P.filter(Q,P.identity)};var x=function(W,S,X,aa){var R=[],Z=0;for(var U=aa||0,Q=O(W);U<Q;U++){var Y=W[U];if(D(Y)&&(P.isArray(Y)||P.isArguments(Y))){if(!S){Y=x(Y,S,X)}var T=0,V=Y.length;R.length+=V;while(T<V){R[Z++]=Y[T++]}}else{if(!X){R[Z++]=Y}}}return R};P.flatten=function(R,Q){return x(R,Q,false)};P.without=function(Q){return P.difference(Q,l.call(arguments,1))
};P.uniq=P.unique=function(X,T,W,R){if(!P.isBoolean(T)){R=W;W=T;T=false}if(W!=null){W=F(W,R)}var Z=[];var Q=[];for(var V=0,S=O(X);V<S;V++){var Y=X[V],U=W?W(Y,V,X):Y;if(T){if(!V||Q!==U){Z.push(Y)}Q=U}else{if(W){if(!P.contains(Q,U)){Q.push(U);Z.push(Y)}}else{if(!P.contains(Z,Y)){Z.push(Y)}}}}return Z};P.union=function(){return P.uniq(x(arguments,true,true))};P.intersection=function(W){var Q=[];var V=arguments.length;for(var S=0,U=O(W);S<U;S++){var T=W[S];if(P.contains(Q,T)){continue}for(var R=1;R<V;
R++){if(!P.contains(arguments[R],T)){break}}if(R===V){Q.push(T)}}return Q};P.difference=function(R){var Q=x(arguments,true,true,1);return P.filter(R,function(S){return !P.contains(Q,S)})};P.zip=function(){return P.unzip(arguments)};P.unzip=function(T){var S=T&&P.max(T,O).length||0;var Q=Array(S);for(var R=0;R<S;R++){Q[R]=P.pluck(T,R)}return Q};P.object=function(U,R){var Q={};for(var S=0,T=O(U);S<T;S++){if(R){Q[U[S]]=R[S]}else{Q[U[S][0]]=U[S][1]}}return Q};function u(Q){return function(V,R,T){R=F(R,T);
var U=O(V);var S=Q>0?0:U-1;for(;S>=0&&S<U;S+=Q){if(R(V[S],S,V)){return S}}return -1}}P.findIndex=u(1);P.findLastIndex=u(-1);P.sortedIndex=function(X,V,W,S){W=F(W,S,1);var U=W(V);var Q=0,T=O(X);while(Q<T){var R=Math.floor((Q+T)/2);if(W(X[R])<U){Q=R+1}else{T=R}}return Q};function f(Q,R,S){return function(X,W,T){var U=0,V=O(X);if(typeof T=="number"){if(Q>0){U=T>=0?T:Math.max(T+V,U)}else{V=T>=0?Math.min(T+1,V):T+V+1}}else{if(S&&T&&V){T=S(X,W);return X[T]===W?T:-1}}if(W!==W){T=R(l.call(X,U,V),P.isNaN);
return T>=0?T+U:-1}for(T=Q>0?U:V-1;T>=0&&T<V;T+=Q){if(X[T]===W){return T}}return -1}}P.indexOf=f(1,P.findIndex,P.sortedIndex);P.lastIndexOf=f(-1,P.findLastIndex);P.range=function(V,S,U){if(S==null){S=V||0;V=0}U=U||1;var T=Math.max(Math.ceil((S-V)/U),0);var R=Array(T);for(var Q=0;Q<T;Q++,V+=U){R[Q]=V}return R};var y=function(V,S,U,W,T){if(!(W instanceof S)){return V.apply(U,T)}var R=C(V.prototype);var Q=V.apply(R,T);if(P.isObject(Q)){return Q}return R};P.bind=function(T,R){if(J&&T.bind===J){return J.apply(T,l.call(arguments,1))
}if(!P.isFunction(T)){throw new TypeError("Bind must be called on a function")}var Q=l.call(arguments,2);var S=function(){return y(T,S,R,this,Q.concat(l.call(arguments)))};return S};P.partial=function(R){var S=l.call(arguments,1);var Q=function(){var T=0,W=S.length;var U=Array(W);for(var V=0;V<W;V++){U[V]=S[V]===P?arguments[T++]:S[V]}while(T<arguments.length){U.push(arguments[T++])}return y(R,Q,this,this,U)};return Q};P.bindAll=function(T){var R,S=arguments.length,Q;if(S<=1){throw new Error("bindAll must be passed function names")
}for(R=1;R<S;R++){Q=arguments[R];T[Q]=P.bind(T[Q],T)}return T};P.memoize=function(R,Q){var S=function(V){var U=S.cache;var T=""+(Q?Q.apply(this,arguments):V);if(!P.has(U,T)){U[T]=R.apply(this,arguments)}return U[T]};S.cache={};return S};P.delay=function(R,S){var Q=l.call(arguments,2);return setTimeout(function(){return R.apply(null,Q)},S)};P.defer=P.partial(P.delay,P,1);P.throttle=function(R,T,X){var Q,V,Y;var W=null;var U=0;if(!X){X={}}var S=function(){U=X.leading===false?0:P.now();W=null;Y=R.apply(Q,V);
if(!W){Q=V=null}};return function(){var Z=P.now();if(!U&&X.leading===false){U=Z}var aa=T-(Z-U);Q=this;V=arguments;if(aa<=0||aa>T){if(W){clearTimeout(W);W=null}U=Z;Y=R.apply(Q,V);if(!W){Q=V=null}}else{if(!W&&X.trailing!==false){W=setTimeout(S,aa)}}return Y}};P.debounce=function(S,U,R){var X,W,Q,V,Y;var T=function(){var Z=P.now()-V;if(Z<U&&Z>=0){X=setTimeout(T,U-Z)}else{X=null;if(!R){Y=S.apply(Q,W);if(!X){Q=W=null}}}};return function(){Q=this;W=arguments;V=P.now();var Z=R&&!X;if(!X){X=setTimeout(T,U)
}if(Z){Y=S.apply(Q,W);Q=W=null}return Y}};P.wrap=function(Q,R){return P.partial(R,Q)};P.negate=function(Q){return function(){return !Q.apply(this,arguments)}};P.compose=function(){var Q=arguments;var R=Q.length-1;return function(){var T=R;var S=Q[R].apply(this,arguments);while(T--){S=Q[T].call(this,S)}return S}};P.after=function(R,Q){return function(){if(--R<1){return Q.apply(this,arguments)}}};P.before=function(S,R){var Q;return function(){if(--S>0){Q=R.apply(this,arguments)}if(S<=1){R=null}return Q
}};P.once=P.partial(P.before,2);var G=!{toString:null}.propertyIsEnumerable("toString");var a=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function d(U,T){var Q=a.length;var R=U.constructor;var S=(P.isFunction(R)&&R.prototype)||g;var V="constructor";if(P.has(U,V)&&!P.contains(T,V)){T.push(V)}while(Q--){V=a[Q];if(V in U&&U[V]!==S[V]&&!P.contains(T,V)){T.push(V)}}}P.keys=function(S){if(!P.isObject(S)){return[]}if(e){return e(S)}var R=[];for(var Q in S){if(P.has(S,Q)){R.push(Q)
}}if(G){d(S,R)}return R};P.allKeys=function(S){if(!P.isObject(S)){return[]}var R=[];for(var Q in S){R.push(Q)}if(G){d(S,R)}return R};P.values=function(U){var T=P.keys(U);var S=T.length;var Q=Array(S);for(var R=0;R<S;R++){Q[R]=U[T[R]]}return Q};P.mapObject=function(V,X,S){X=F(X,S);var U=P.keys(V),T=U.length,R={},W;for(var Q=0;Q<T;Q++){W=U[Q];R[W]=X(V[W],W,V)}return R};P.pairs=function(U){var S=P.keys(U);var R=S.length;var T=Array(R);for(var Q=0;Q<R;Q++){T[Q]=[S[Q],U[S[Q]]]}return T};P.invert=function(U){var Q={};
var T=P.keys(U);for(var R=0,S=T.length;R<S;R++){Q[U[T[R]]]=T[R]}return Q};P.functions=P.methods=function(S){var R=[];for(var Q in S){if(P.isFunction(S[Q])){R.push(Q)}}return R.sort()};P.extend=p(P.allKeys);P.extendOwn=P.assign=p(P.keys);P.findKey=function(W,Q,T){Q=F(Q,T);var V=P.keys(W),S;for(var R=0,U=V.length;R<U;R++){S=V[R];if(Q(W[S],S,W)){return S}}};P.pick=function(S,W,Q){var aa={},T=S,V,Z;if(T==null){return aa}if(P.isFunction(W)){Z=P.allKeys(T);V=b(W,Q)}else{Z=x(arguments,false,false,1);V=function(ac,ab,ad){return ab in ad
};T=Object(T)}for(var U=0,R=Z.length;U<R;U++){var Y=Z[U];var X=T[Y];if(V(X,Y,T)){aa[Y]=X}}return aa};P.omit=function(S,T,Q){if(P.isFunction(T)){T=P.negate(T)}else{var R=P.map(x(arguments,false,false,1),String);T=function(V,U){return !P.contains(R,U)}}return P.pick(S,T,Q)};P.defaults=p(P.allKeys,true);P.create=function(R,S){var Q=C(R);if(S){P.extendOwn(Q,S)}return Q};P.clone=function(Q){if(!P.isObject(Q)){return Q}return P.isArray(Q)?Q.slice():P.extend({},Q)};P.tap=function(R,Q){Q(R);return R};P.isMatch=function(R,Q){var V=P.keys(Q),U=V.length;
if(R==null){return !U}var W=Object(R);for(var T=0;T<U;T++){var S=V[T];if(Q[S]!==W[S]||!(S in W)){return false}}return true};var N=function(Y,X,R,T){if(Y===X){return Y!==0||1/Y===1/X}if(Y==null||X==null){return Y===X}if(Y instanceof P){Y=Y._wrapped}if(X instanceof P){X=X._wrapped}var V=c.call(Y);if(V!==c.call(X)){return false}switch(V){case"[object RegExp]":case"[object String]":return""+Y===""+X;case"[object Number]":if(+Y!==+Y){return +X!==+X}return +Y===0?1/+Y===1/X:+Y===+X;case"[object Date]":case"[object Boolean]":return +Y===+X
}var S=V==="[object Array]";if(!S){if(typeof Y!="object"||typeof X!="object"){return false}var W=Y.constructor,U=X.constructor;if(W!==U&&!(P.isFunction(W)&&W instanceof W&&P.isFunction(U)&&U instanceof U)&&("constructor" in Y&&"constructor" in X)){return false}}R=R||[];T=T||[];var Q=R.length;while(Q--){if(R[Q]===Y){return T[Q]===X}}R.push(Y);T.push(X);if(S){Q=Y.length;if(Q!==X.length){return false}while(Q--){if(!N(Y[Q],X[Q],R,T)){return false}}}else{var aa=P.keys(Y),Z;Q=aa.length;if(P.keys(X).length!==Q){return false
}while(Q--){Z=aa[Q];if(!(P.has(X,Z)&&N(Y[Z],X[Z],R,T))){return false}}}R.pop();T.pop();return true};P.isEqual=function(R,Q){return N(R,Q)};P.isEmpty=function(Q){if(Q==null){return true}if(D(Q)&&(P.isArray(Q)||P.isString(Q)||P.isArguments(Q))){return Q.length===0}return P.keys(Q).length===0};P.isElement=function(Q){return !!(Q&&Q.nodeType===1)};P.isArray=s||function(Q){return c.call(Q)==="[object Array]"};P.isObject=function(R){var Q=typeof R;return Q==="function"||Q==="object"&&!!R};P.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(Q){P["is"+Q]=function(R){return c.call(R)==="[object "+Q+"]"
}});if(!P.isArguments(arguments)){P.isArguments=function(Q){return P.has(Q,"callee")}}if(typeof/./!="function"&&typeof Int8Array!="object"){P.isFunction=function(Q){return typeof Q=="function"||false}}P.isFinite=function(Q){return isFinite(Q)&&!isNaN(parseFloat(Q))};P.isNaN=function(Q){return P.isNumber(Q)&&Q!==+Q};P.isBoolean=function(Q){return Q===true||Q===false||c.call(Q)==="[object Boolean]"};P.isNull=function(Q){return Q===null};P.isUndefined=function(Q){return Q===void 0};P.has=function(R,Q){return R!=null&&j.call(R,Q)
};P.noConflict=function(){v._=k;return this};P.identity=function(Q){return Q};P.constant=function(Q){return function(){return Q}};P.noop=function(){};P.property=M;P.propertyOf=function(Q){return Q==null?function(){}:function(R){return Q[R]}};P.matcher=P.matches=function(Q){Q=P.extendOwn({},Q);return function(R){return P.isMatch(R,Q)}};P.times=function(U,T,S){var Q=Array(Math.max(0,U));T=b(T,S,1);for(var R=0;R<U;R++){Q[R]=T(R)}return Q};P.random=function(R,Q){if(Q==null){Q=R;R=0}return R+Math.floor(Math.random()*(Q-R+1))
};P.now=Date.now||function(){return new Date().getTime()};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var m=P.invert(r);var w=function(U){var R=function(V){return U[V]};var T="(?:"+P.keys(U).join("|")+")";var S=RegExp(T);var Q=RegExp(T,"g");return function(V){V=V==null?"":""+V;return S.test(V)?V.replace(Q,R):V}};P.escape=w(r);P.unescape=w(m);P.result=function(Q,S,T){var R=Q==null?void 0:Q[S];if(R===void 0){R=T}return P.isFunction(R)?R.call(Q):R};var A=0;P.uniqueId=function(Q){var R=++A+"";
return Q?Q+R:R};P.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\u2028|\u2029/g;var H=function(Q){return"\\"+h[Q]};P.template=function(Z,T,W){if(!T&&W){T=W}T=P.defaults({},T,P.templateSettings);var U=RegExp([(T.escape||t).source,(T.interpolate||t).source,(T.evaluate||t).source].join("|")+"|$","g");var V=0;var Q="__p+='";Z.replace(U,function(ab,ac,aa,ae,ad){Q+=Z.slice(V,ad).replace(i,H);
V=ad+ab.length;if(ac){Q+="'+\n((__t=("+ac+"))==null?'':_.escape(__t))+\n'"}else{if(aa){Q+="'+\n((__t=("+aa+"))==null?'':__t)+\n'"}else{if(ae){Q+="';\n"+ae+"\n__p+='"}}}return ab});Q+="';\n";if(!T.variable){Q="with(obj||{}){\n"+Q+"}\n"}Q="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+Q+"return __p;\n";try{var S=new Function(T.variable||"obj","_",Q)}catch(X){X.source=Q;throw X}var Y=function(aa){return S.call(this,aa,P)};var R=T.variable||"obj";Y.source="function("+R+"){\n"+Q+"}";
return Y};P.chain=function(R){var Q=P(R);Q._chain=true;return Q};var o=function(Q,R){return Q._chain?P(R).chain():R};P.mixin=function(Q){P.each(P.functions(Q),function(R){var S=P[R]=Q[R];P.prototype[R]=function(){var T=[this._wrapped];L.apply(T,arguments);return o(this,S.apply(P,T))}})};P.mixin(P);P.each(["pop","push","reverse","shift","sort","splice","unshift"],function(Q){var R=I[Q];P.prototype[Q]=function(){var S=this._wrapped;R.apply(S,arguments);if((Q==="shift"||Q==="splice")&&S.length===0){delete S[0]
}return o(this,S)}});P.each(["concat","join","slice"],function(Q){var R=I[Q];P.prototype[Q]=function(){return o(this,R.apply(this._wrapped,arguments))}});P.prototype.value=function(){return this._wrapped};P.prototype.valueOf=P.prototype.toJSON=P.prototype.value;P.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return P})}}.call(this));
/*!
 * jQuery JavaScript Library v1.9.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2012 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-2-4
 */
(function(a2,aG){var ai,w,aC=typeof aG,l=a2.document,aL=a2.location,bi=a2.jQuery,H=a2.$,aa={},a6=[],s="1.9.1",aI=a6.concat,ao=a6.push,a4=a6.slice,aM=a6.indexOf,z=aa.toString,V=aa.hasOwnProperty,aQ=s.trim,bJ=function(e,b3){return new bJ.fn.init(e,b3,w)
},bA=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ac=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,br=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bh=/^[\],:{}\s]*$/,bk=/(?:^|:|,)(?:\s*\[)+/g,bG=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,aZ=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,bS=/^-ms-/,aV=/-([\da-z])/gi,M=function(e,b3){return b3.toUpperCase()},bW=function(e){if(l.addEventListener||e.type==="load"||l.readyState==="complete"){bl();bJ.ready()}},bl=function(){if(l.addEventListener){l.removeEventListener("DOMContentLoaded",bW,false);
a2.removeEventListener("load",bW,false)}else{l.detachEvent("onreadystatechange",bW);a2.detachEvent("onload",bW)}};bJ.fn=bJ.prototype={jquery:s,constructor:bJ,init:function(e,b5,b4){var b3,b6;if(!e){return this}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){b3=[null,e,null]}else{b3=br.exec(e)}if(b3&&(b3[1]||!b5)){if(b3[1]){b5=b5 instanceof bJ?b5[0]:b5;bJ.merge(this,bJ.parseHTML(b3[1],b5&&b5.nodeType?b5.ownerDocument||b5:l,true));if(a.test(b3[1])&&bJ.isPlainObject(b5)){for(b3 in b5){if(bJ.isFunction(this[b3])){this[b3](b5[b3])
}else{this.attr(b3,b5[b3])}}}return this}else{b6=l.getElementById(b3[2]);if(b6&&b6.parentNode){if(b6.id!==b3[2]){return b4.find(e)}this.length=1;this[0]=b6}this.context=l;this.selector=e;return this}}else{if(!b5||b5.jquery){return(b5||b4).find(e)}else{return this.constructor(b5).find(e)}}}else{if(e.nodeType){this.context=this[0]=e;this.length=1;return this}else{if(bJ.isFunction(e)){return b4.ready(e)}}}if(e.selector!==aG){this.selector=e.selector;this.context=e.context}return bJ.makeArray(e,this)
},selector:"",length:0,size:function(){return this.length},toArray:function(){return a4.call(this)},get:function(e){return e==null?this.toArray():(e<0?this[this.length+e]:this[e])},pushStack:function(e){var b3=bJ.merge(this.constructor(),e);b3.prevObject=this;b3.context=this.context;return b3},each:function(b3,e){return bJ.each(this,b3,e)},ready:function(e){bJ.ready.promise().done(e);return this},slice:function(){return this.pushStack(a4.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)
},eq:function(b4){var e=this.length,b3=+b4+(b4<0?e:0);return this.pushStack(b3>=0&&b3<e?[this[b3]]:[])},map:function(e){return this.pushStack(bJ.map(this,function(b4,b3){return e.call(b4,b3,b4)}))},end:function(){return this.prevObject||this.constructor(null)},push:ao,sort:[].sort,splice:[].splice};bJ.fn.init.prototype=bJ.fn;bJ.extend=bJ.fn.extend=function(){var e,b8,b3,b4,cb,b9,b7=arguments[0]||{},b6=1,b5=arguments.length,ca=false;if(typeof b7==="boolean"){ca=b7;b7=arguments[1]||{};b6=2}if(typeof b7!=="object"&&!bJ.isFunction(b7)){b7={}
}if(b5===b6){b7=this;--b6}for(;b6<b5;b6++){if((cb=arguments[b6])!=null){for(b4 in cb){e=b7[b4];b3=cb[b4];if(b7===b3){continue}if(ca&&b3&&(bJ.isPlainObject(b3)||(b8=bJ.isArray(b3)))){if(b8){b8=false;b9=e&&bJ.isArray(e)?e:[]}else{b9=e&&bJ.isPlainObject(e)?e:{}}b7[b4]=bJ.extend(ca,b9,b3)}else{if(b3!==aG){b7[b4]=b3}}}}}return b7};bJ.extend({noConflict:function(e){if(a2.$===bJ){a2.$=H}if(e&&a2.jQuery===bJ){a2.jQuery=bi}return bJ},isReady:false,readyWait:1,holdReady:function(e){if(e){bJ.readyWait++}else{bJ.ready(true)
}},ready:function(e){if(e===true?--bJ.readyWait:bJ.isReady){return}if(!l.body){return setTimeout(bJ.ready)}bJ.isReady=true;if(e!==true&&--bJ.readyWait>0){return}ai.resolveWith(l,[bJ]);if(bJ.fn.trigger){bJ(l).trigger("ready").off("ready")}},isFunction:function(e){return bJ.type(e)==="function"},isArray:Array.isArray||function(e){return bJ.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){if(e==null){return String(e)
}return typeof e==="object"||typeof e==="function"?aa[z.call(e)]||"object":typeof e},isPlainObject:function(b5){if(!b5||bJ.type(b5)!=="object"||b5.nodeType||bJ.isWindow(b5)){return false}try{if(b5.constructor&&!V.call(b5,"constructor")&&!V.call(b5.constructor.prototype,"isPrototypeOf")){return false}}catch(b4){return false}var b3;for(b3 in b5){}return b3===aG||V.call(b5,b3)},isEmptyObject:function(b3){var e;for(e in b3){return false}return true},error:function(e){throw new Error(e)},parseHTML:function(b6,b4,b5){if(!b6||typeof b6!=="string"){return null
}if(typeof b4==="boolean"){b5=b4;b4=false}b4=b4||l;var b3=a.exec(b6),e=!b5&&[];if(b3){return[b4.createElement(b3[1])]}b3=bJ.buildFragment([b6],b4,e);if(e){bJ(e).remove()}return bJ.merge([],b3.childNodes)},parseJSON:function(e){if(a2.JSON&&a2.JSON.parse){return a2.JSON.parse(e)}if(e===null){return e}if(typeof e==="string"){e=bJ.trim(e);if(e){if(bh.test(e.replace(bG,"@").replace(aZ,"]").replace(bk,""))){return(new Function("return "+e))()}}}bJ.error("Invalid JSON: "+e)},parseXML:function(b5){var b3,b4;
if(!b5||typeof b5!=="string"){return null}try{if(a2.DOMParser){b4=new DOMParser();b3=b4.parseFromString(b5,"text/xml")}else{b3=new ActiveXObject("Microsoft.XMLDOM");b3.async="false";b3.loadXML(b5)}}catch(b6){b3=aG}if(!b3||!b3.documentElement||b3.getElementsByTagName("parsererror").length){bJ.error("Invalid XML: "+b5)}return b3},noop:function(){},globalEval:function(e){if(e&&bJ.trim(e)){(a2.execScript||function(b3){a2["eval"].call(a2,b3)})(e)}},camelCase:function(e){return e.replace(bS,"ms-").replace(aV,M)
},nodeName:function(b3,e){return b3.nodeName&&b3.nodeName.toLowerCase()===e.toLowerCase()},each:function(b7,b8,b3){var b6,b4=0,b5=b7.length,e=ab(b7);if(b3){if(e){for(;b4<b5;b4++){b6=b8.apply(b7[b4],b3);if(b6===false){break}}}else{for(b4 in b7){b6=b8.apply(b7[b4],b3);if(b6===false){break}}}}else{if(e){for(;b4<b5;b4++){b6=b8.call(b7[b4],b4,b7[b4]);if(b6===false){break}}}else{for(b4 in b7){b6=b8.call(b7[b4],b4,b7[b4]);if(b6===false){break}}}}return b7},trim:aQ&&!aQ.call("\uFEFF\xA0")?function(e){return e==null?"":aQ.call(e)
}:function(e){return e==null?"":(e+"").replace(C,"")},makeArray:function(e,b4){var b3=b4||[];if(e!=null){if(ab(Object(e))){bJ.merge(b3,typeof e==="string"?[e]:e)}else{ao.call(b3,e)}}return b3},inArray:function(b5,b3,b4){var e;if(b3){if(aM){return aM.call(b3,b5,b4)}e=b3.length;b4=b4?b4<0?Math.max(0,e+b4):b4:0;for(;b4<e;b4++){if(b4 in b3&&b3[b4]===b5){return b4}}}return -1},merge:function(b6,b4){var e=b4.length,b5=b6.length,b3=0;if(typeof e==="number"){for(;b3<e;b3++){b6[b5++]=b4[b3]}}else{while(b4[b3]!==aG){b6[b5++]=b4[b3++]
}}b6.length=b5;return b6},grep:function(b3,b8,e){var b7,b4=[],b5=0,b6=b3.length;e=!!e;for(;b5<b6;b5++){b7=!!b8(b3[b5],b5);if(e!==b7){b4.push(b3[b5])}}return b4},map:function(b4,b9,e){var b8,b6=0,b7=b4.length,b3=ab(b4),b5=[];if(b3){for(;b6<b7;b6++){b8=b9(b4[b6],b6,e);if(b8!=null){b5[b5.length]=b8}}}else{for(b6 in b4){b8=b9(b4[b6],b6,e);if(b8!=null){b5[b5.length]=b8}}}return aI.apply([],b5)},guid:1,proxy:function(b6,b5){var e,b4,b3;if(typeof b5==="string"){b3=b6[b5];b5=b6;b6=b3}if(!bJ.isFunction(b6)){return aG
}e=a4.call(arguments,2);b4=function(){return b6.apply(b5||this,e.concat(a4.call(arguments)))};b4.guid=b6.guid=b6.guid||bJ.guid++;return b4},access:function(e,b7,b9,b8,b5,cb,ca){var b4=0,b3=e.length,b6=b9==null;if(bJ.type(b9)==="object"){b5=true;for(b4 in b9){bJ.access(e,b7,b4,b9[b4],true,cb,ca)}}else{if(b8!==aG){b5=true;if(!bJ.isFunction(b8)){ca=true}if(b6){if(ca){b7.call(e,b8);b7=null}else{b6=b7;b7=function(cd,cc,ce){return b6.call(bJ(cd),ce)}}}if(b7){for(;b4<b3;b4++){b7(e[b4],b9,ca?b8:b8.call(e[b4],b4,b7(e[b4],b9)))
}}}}return b5?e:b6?b7.call(e):b3?b7(e[0],b9):cb},now:function(){return(new Date()).getTime()}});bJ.ready.promise=function(b6){if(!ai){ai=bJ.Deferred();if(l.readyState==="complete"){setTimeout(bJ.ready)}else{if(l.addEventListener){l.addEventListener("DOMContentLoaded",bW,false);a2.addEventListener("load",bW,false)}else{l.attachEvent("onreadystatechange",bW);a2.attachEvent("onload",bW);var b5=false;try{b5=a2.frameElement==null&&l.documentElement}catch(b4){}if(b5&&b5.doScroll){(function b3(){if(!bJ.isReady){try{b5.doScroll("left")
}catch(b7){return setTimeout(b3,50)}bl();bJ.ready()}})()}}}}return ai.promise(b6)};bJ.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b3,e){aa["[object "+e+"]"]=e.toLowerCase()});function ab(b4){var b3=b4.length,e=bJ.type(b4);if(bJ.isWindow(b4)){return false}if(b4.nodeType===1&&b3){return true}return e==="array"||e!=="function"&&(b3===0||typeof b3==="number"&&b3>0&&(b3-1) in b4)}w=bJ(l);var bY={};function ae(b3){var e=bY[b3]={};bJ.each(b3.match(ac)||[],function(b5,b4){e[b4]=true
});return e}bJ.Callbacks=function(cc){cc=typeof cc==="string"?(bY[cc]||ae(cc)):bJ.extend({},cc);var b6,b5,e,b7,b8,b4,b9=[],ca=!cc.once&&[],b3=function(cd){b5=cc.memory&&cd;e=true;b8=b4||0;b4=0;b7=b9.length;b6=true;for(;b9&&b8<b7;b8++){if(b9[b8].apply(cd[0],cd[1])===false&&cc.stopOnFalse){b5=false;break}}b6=false;if(b9){if(ca){if(ca.length){b3(ca.shift())}}else{if(b5){b9=[]}else{cb.disable()}}}},cb={add:function(){if(b9){var ce=b9.length;(function cd(cf){bJ.each(cf,function(ch,cg){var ci=bJ.type(cg);
if(ci==="function"){if(!cc.unique||!cb.has(cg)){b9.push(cg)}}else{if(cg&&cg.length&&ci!=="string"){cd(cg)}}})})(arguments);if(b6){b7=b9.length}else{if(b5){b4=ce;b3(b5)}}}return this},remove:function(){if(b9){bJ.each(arguments,function(cf,cd){var ce;while((ce=bJ.inArray(cd,b9,ce))>-1){b9.splice(ce,1);if(b6){if(ce<=b7){b7--}if(ce<=b8){b8--}}}})}return this},has:function(cd){return cd?bJ.inArray(cd,b9)>-1:!!(b9&&b9.length)},empty:function(){b9=[];return this},disable:function(){b9=ca=b5=aG;return this
},disabled:function(){return !b9},lock:function(){ca=aG;if(!b5){cb.disable()}return this},locked:function(){return !ca},fireWith:function(ce,cd){cd=cd||[];cd=[ce,cd.slice?cd.slice():cd];if(b9&&(!e||ca)){if(b6){ca.push(cd)}else{b3(cd)}}return this},fire:function(){cb.fireWith(this,arguments);return this},fired:function(){return !!e}};return cb};bJ.extend({Deferred:function(b4){var b3=[["resolve","done",bJ.Callbacks("once memory"),"resolved"],["reject","fail",bJ.Callbacks("once memory"),"rejected"],["notify","progress",bJ.Callbacks("memory")]],b5="pending",b6={state:function(){return b5
},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var b7=arguments;return bJ.Deferred(function(b8){bJ.each(b3,function(ca,b9){var cc=b9[0],cb=bJ.isFunction(b7[ca])&&b7[ca];e[b9[1]](function(){var cd=cb&&cb.apply(this,arguments);if(cd&&bJ.isFunction(cd.promise)){cd.promise().done(b8.resolve).fail(b8.reject).progress(b8.notify)}else{b8[cc+"With"](this===b6?b8.promise():this,cb?[cd]:arguments)}})});b7=null}).promise()},promise:function(b7){return b7!=null?bJ.extend(b7,b6):b6
}},e={};b6.pipe=b6.then;bJ.each(b3,function(b8,b7){var ca=b7[2],b9=b7[3];b6[b7[1]]=ca.add;if(b9){ca.add(function(){b5=b9},b3[b8^1][2].disable,b3[2][2].lock)}e[b7[0]]=function(){e[b7[0]+"With"](this===e?b6:this,arguments);return this};e[b7[0]+"With"]=ca.fireWith});b6.promise(e);if(b4){b4.call(e,e)}return e},when:function(b6){var b4=0,b8=a4.call(arguments),e=b8.length,b3=e!==1||(b6&&bJ.isFunction(b6.promise))?e:0,cb=b3===1?b6:bJ.Deferred(),b5=function(cd,ce,cc){return function(cf){ce[cd]=this;cc[cd]=arguments.length>1?a4.call(arguments):cf;
if(cc===ca){cb.notifyWith(ce,cc)}else{if(!(--b3)){cb.resolveWith(ce,cc)}}}},ca,b7,b9;if(e>1){ca=new Array(e);b7=new Array(e);b9=new Array(e);for(;b4<e;b4++){if(b8[b4]&&bJ.isFunction(b8[b4].promise)){b8[b4].promise().done(b5(b4,b9,b8)).fail(cb.reject).progress(b5(b4,b7,ca))}else{--b3}}}if(!b3){cb.resolveWith(b9,b8)}return cb.promise()}});bJ.support=(function(){var ce,cd,cb,ca,cc,b9,b5,b7,b4,b6,b3=l.createElement("div");b3.setAttribute("className","t");b3.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
cd=b3.getElementsByTagName("*");cb=b3.getElementsByTagName("a")[0];if(!cd||!cb||!cd.length){return{}}cc=l.createElement("select");b5=cc.appendChild(l.createElement("option"));ca=b3.getElementsByTagName("input")[0];cb.style.cssText="top:1px;float:left;opacity:.5";ce={getSetAttribute:b3.className!=="t",leadingWhitespace:b3.firstChild.nodeType===3,tbody:!b3.getElementsByTagName("tbody").length,htmlSerialize:!!b3.getElementsByTagName("link").length,style:/top/.test(cb.getAttribute("style")),hrefNormalized:cb.getAttribute("href")==="/a",opacity:/^0.5/.test(cb.style.opacity),cssFloat:!!cb.style.cssFloat,checkOn:!!ca.value,optSelected:b5.selected,enctype:!!l.createElement("form").enctype,html5Clone:l.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:l.compatMode==="CSS1Compat",deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};
ca.checked=true;ce.noCloneChecked=ca.cloneNode(true).checked;cc.disabled=true;ce.optDisabled=!b5.disabled;try{delete b3.test}catch(b8){ce.deleteExpando=false}ca=l.createElement("input");ca.setAttribute("value","");ce.input=ca.getAttribute("value")==="";ca.value="t";ca.setAttribute("type","radio");ce.radioValue=ca.value==="t";ca.setAttribute("checked","t");ca.setAttribute("name","t");b9=l.createDocumentFragment();b9.appendChild(ca);ce.appendChecked=ca.checked;ce.checkClone=b9.cloneNode(true).cloneNode(true).lastChild.checked;
if(b3.attachEvent){b3.attachEvent("onclick",function(){ce.noCloneEvent=false});b3.cloneNode(true).click()}for(b6 in {submit:true,change:true,focusin:true}){b3.setAttribute(b7="on"+b6,"t");ce[b6+"Bubbles"]=b7 in a2||b3.attributes[b7].expando===false}b3.style.backgroundClip="content-box";b3.cloneNode(true).style.backgroundClip="";ce.clearCloneStyle=b3.style.backgroundClip==="content-box";bJ(function(){var cf,ci,ch,cg="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",e=l.getElementsByTagName("body")[0];
if(!e){return}cf=l.createElement("div");cf.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";e.appendChild(cf).appendChild(b3);b3.innerHTML="<table><tr><td></td><td>t</td></tr></table>";ch=b3.getElementsByTagName("td");ch[0].style.cssText="padding:0;margin:0;border:0;display:none";b4=(ch[0].offsetHeight===0);ch[0].style.display="";ch[1].style.display="none";ce.reliableHiddenOffsets=b4&&(ch[0].offsetHeight===0);b3.innerHTML="";b3.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
ce.boxSizing=(b3.offsetWidth===4);ce.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==1);if(a2.getComputedStyle){ce.pixelPosition=(a2.getComputedStyle(b3,null)||{}).top!=="1%";ce.boxSizingReliable=(a2.getComputedStyle(b3,null)||{width:"4px"}).width==="4px";ci=b3.appendChild(l.createElement("div"));ci.style.cssText=b3.style.cssText=cg;ci.style.marginRight=ci.style.width="0";b3.style.width="1px";ce.reliableMarginRight=!parseFloat((a2.getComputedStyle(ci,null)||{}).marginRight)}if(typeof b3.style.zoom!==aC){b3.innerHTML="";
b3.style.cssText=cg+"width:1px;padding:1px;display:inline;zoom:1";ce.inlineBlockNeedsLayout=(b3.offsetWidth===3);b3.style.display="block";b3.innerHTML="<div></div>";b3.firstChild.style.width="5px";ce.shrinkWrapBlocks=(b3.offsetWidth!==3);if(ce.inlineBlockNeedsLayout){e.style.zoom=1}}e.removeChild(cf);cf=b3=ch=ci=null});cd=cc=b9=b5=cb=ca=null;return ce})();var bw=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,aN=/([A-Z])/g;function ba(b5,b3,b7,b6){if(!bJ.acceptData(b5)){return}var b8,ca,cb=bJ.expando,b9=typeof b3==="string",cc=b5.nodeType,e=cc?bJ.cache:b5,b4=cc?b5[cb]:b5[cb]&&cb;
if((!b4||!e[b4]||(!b6&&!e[b4].data))&&b9&&b7===aG){return}if(!b4){if(cc){b5[cb]=b4=a6.pop()||bJ.guid++}else{b4=cb}}if(!e[b4]){e[b4]={};if(!cc){e[b4].toJSON=bJ.noop}}if(typeof b3==="object"||typeof b3==="function"){if(b6){e[b4]=bJ.extend(e[b4],b3)}else{e[b4].data=bJ.extend(e[b4].data,b3)}}b8=e[b4];if(!b6){if(!b8.data){b8.data={}}b8=b8.data}if(b7!==aG){b8[bJ.camelCase(b3)]=b7}if(b9){ca=b8[b3];if(ca==null){ca=b8[bJ.camelCase(b3)]}}else{ca=b8}return ca}function Z(b5,b3,b6){if(!bJ.acceptData(b5)){return
}var b8,b7,b9,ca=b5.nodeType,e=ca?bJ.cache:b5,b4=ca?b5[bJ.expando]:bJ.expando;if(!e[b4]){return}if(b3){b9=b6?e[b4]:e[b4].data;if(b9){if(!bJ.isArray(b3)){if(b3 in b9){b3=[b3]}else{b3=bJ.camelCase(b3);if(b3 in b9){b3=[b3]}else{b3=b3.split(" ")}}}else{b3=b3.concat(bJ.map(b3,bJ.camelCase))}for(b8=0,b7=b3.length;b8<b7;b8++){delete b9[b3[b8]]}if(!(b6?N:bJ.isEmptyObject)(b9)){return}}}if(!b6){delete e[b4].data;if(!N(e[b4])){return}}if(ca){bJ.cleanData([b5],true)}else{if(bJ.support.deleteExpando||e!=e.window){delete e[b4]
}else{e[b4]=null}}}bJ.extend({cache:{},expando:"jQuery"+(s+Math.random()).replace(/\D/g,""),noData:{"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000","applet":true},hasData:function(e){e=e.nodeType?bJ.cache[e[bJ.expando]]:e[bJ.expando];return !!e&&!N(e)},data:function(b3,e,b4){return ba(b3,e,b4)},removeData:function(b3,e){return Z(b3,e)},_data:function(b3,e,b4){return ba(b3,e,b4,true)},_removeData:function(b3,e){return Z(b3,e,true)},acceptData:function(b3){if(b3.nodeType&&b3.nodeType!==1&&b3.nodeType!==9){return false
}var e=b3.nodeName&&bJ.noData[b3.nodeName.toLowerCase()];return !e||e!==true&&b3.getAttribute("classid")===e}});bJ.fn.extend({data:function(b5,b8){var b3,e,b6=this[0],b4=0,b7=null;if(b5===aG){if(this.length){b7=bJ.data(b6);if(b6.nodeType===1&&!bJ._data(b6,"parsedAttrs")){b3=b6.attributes;for(;b4<b3.length;b4++){e=b3[b4].name;if(!e.indexOf("data-")){e=bJ.camelCase(e.slice(5));by(b6,e,b7[e])}}bJ._data(b6,"parsedAttrs",true)}}return b7}if(typeof b5==="object"){return this.each(function(){bJ.data(this,b5)
})}return bJ.access(this,function(b9){if(b9===aG){return b6?by(b6,b5,bJ.data(b6,b5)):null}this.each(function(){bJ.data(this,b5,b9)})},null,b8,arguments.length>1,null,true)},removeData:function(e){return this.each(function(){bJ.removeData(this,e)})}});function by(b5,b4,b6){if(b6===aG&&b5.nodeType===1){var b3="data-"+b4.replace(aN,"-$1").toLowerCase();b6=b5.getAttribute(b3);if(typeof b6==="string"){try{b6=b6==="true"?true:b6==="false"?false:b6==="null"?null:+b6+""===b6?+b6:bw.test(b6)?bJ.parseJSON(b6):b6
}catch(b7){}bJ.data(b5,b4,b6)}else{b6=aG}}return b6}function N(b3){var e;for(e in b3){if(e==="data"&&bJ.isEmptyObject(b3[e])){continue}if(e!=="toJSON"){return false}}return true}bJ.extend({queue:function(b4,b3,b5){var e;if(b4){b3=(b3||"fx")+"queue";e=bJ._data(b4,b3);if(b5){if(!e||bJ.isArray(b5)){e=bJ._data(b4,b3,bJ.makeArray(b5))}else{e.push(b5)}}return e||[]}},dequeue:function(b7,b6){b6=b6||"fx";var b3=bJ.queue(b7,b6),b8=b3.length,b5=b3.shift(),e=bJ._queueHooks(b7,b6),b4=function(){bJ.dequeue(b7,b6)
};if(b5==="inprogress"){b5=b3.shift();b8--}e.cur=b5;if(b5){if(b6==="fx"){b3.unshift("inprogress")}delete e.stop;b5.call(b7,b4,e)}if(!b8&&e){e.empty.fire()}},_queueHooks:function(b4,b3){var e=b3+"queueHooks";return bJ._data(b4,e)||bJ._data(b4,e,{empty:bJ.Callbacks("once memory").add(function(){bJ._removeData(b4,b3+"queue");bJ._removeData(b4,e)})})}});bJ.fn.extend({queue:function(e,b3){var b4=2;if(typeof e!=="string"){b3=e;e="fx";b4--}if(arguments.length<b4){return bJ.queue(this[0],e)}return b3===aG?this:this.each(function(){var b5=bJ.queue(this,e,b3);
bJ._queueHooks(this,e);if(e==="fx"&&b5[0]!=="inprogress"){bJ.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){bJ.dequeue(this,e)})},delay:function(b3,e){b3=bJ.fx?bJ.fx.speeds[b3]||b3:b3;e=e||"fx";return this.queue(e,function(b5,b4){var b6=setTimeout(b5,b3);b4.stop=function(){clearTimeout(b6)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(b4,b8){var b3,b5=1,b9=bJ.Deferred(),b7=this,e=this.length,b6=function(){if(!(--b5)){b9.resolveWith(b7,[b7])}};if(typeof b4!=="string"){b8=b4;
b4=aG}b4=b4||"fx";while(e--){b3=bJ._data(b7[e],b4+"queueHooks");if(b3&&b3.empty){b5++;b3.empty.add(b6)}}b6();return b9.promise(b8)}});var a8,bZ,bM=/[\t\r\n]/g,ak=/\r/g,aF=/^(?:input|select|textarea|button|object)$/i,D=/^(?:a|area)$/i,L=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,aq=/^(?:checked|selected)$/i,bP=bJ.support.getSetAttribute,bF=bJ.support.input;bJ.fn.extend({attr:function(e,b3){return bJ.access(this,bJ.attr,e,b3,arguments.length>1)
},removeAttr:function(e){return this.each(function(){bJ.removeAttr(this,e)})},prop:function(e,b3){return bJ.access(this,bJ.prop,e,b3,arguments.length>1)},removeProp:function(e){e=bJ.propFix[e]||e;return this.each(function(){try{this[e]=aG;delete this[e]}catch(b3){}})},addClass:function(b9){var b3,e,ca,b6,b4,b5=0,b7=this.length,b8=typeof b9==="string"&&b9;if(bJ.isFunction(b9)){return this.each(function(cb){bJ(this).addClass(b9.call(this,cb,this.className))})}if(b8){b3=(b9||"").match(ac)||[];for(;b5<b7;
b5++){e=this[b5];ca=e.nodeType===1&&(e.className?(" "+e.className+" ").replace(bM," "):" ");if(ca){b4=0;while((b6=b3[b4++])){if(ca.indexOf(" "+b6+" ")<0){ca+=b6+" "}}e.className=bJ.trim(ca)}}}return this},removeClass:function(b9){var b3,e,ca,b6,b4,b5=0,b7=this.length,b8=arguments.length===0||typeof b9==="string"&&b9;if(bJ.isFunction(b9)){return this.each(function(cb){bJ(this).removeClass(b9.call(this,cb,this.className))})}if(b8){b3=(b9||"").match(ac)||[];for(;b5<b7;b5++){e=this[b5];ca=e.nodeType===1&&(e.className?(" "+e.className+" ").replace(bM," "):"");
if(ca){b4=0;while((b6=b3[b4++])){while(ca.indexOf(" "+b6+" ")>=0){ca=ca.replace(" "+b6+" "," ")}}e.className=b9?bJ.trim(ca):""}}}return this},toggleClass:function(b5,b3){var b4=typeof b5,e=typeof b3==="boolean";if(bJ.isFunction(b5)){return this.each(function(b6){bJ(this).toggleClass(b5.call(this,b6,this.className,b3),b3)})}return this.each(function(){if(b4==="string"){var b8,b7=0,b6=bJ(this),b9=b3,ca=b5.match(ac)||[];while((b8=ca[b7++])){b9=e?b9:!b6.hasClass(b8);b6[b9?"addClass":"removeClass"](b8)
}}else{if(b4===aC||b4==="boolean"){if(this.className){bJ._data(this,"__className__",this.className)}this.className=this.className||b5===false?"":bJ._data(this,"__className__")||""}}})},hasClass:function(e){var b5=" "+e+" ",b4=0,b3=this.length;for(;b4<b3;b4++){if(this[b4].nodeType===1&&(" "+this[b4].className+" ").replace(bM," ").indexOf(b5)>=0){return true}}return false},val:function(b5){var b3,e,b6,b4=this[0];if(!arguments.length){if(b4){e=bJ.valHooks[b4.type]||bJ.valHooks[b4.nodeName.toLowerCase()];
if(e&&"get" in e&&(b3=e.get(b4,"value"))!==aG){return b3}b3=b4.value;return typeof b3==="string"?b3.replace(ak,""):b3==null?"":b3}return}b6=bJ.isFunction(b5);return this.each(function(b8){var b9,b7=bJ(this);if(this.nodeType!==1){return}if(b6){b9=b5.call(this,b8,b7.val())}else{b9=b5}if(b9==null){b9=""}else{if(typeof b9==="number"){b9+=""}else{if(bJ.isArray(b9)){b9=bJ.map(b9,function(ca){return ca==null?"":ca+""})}}}e=bJ.valHooks[this.type]||bJ.valHooks[this.nodeName.toLowerCase()];if(!e||!("set" in e)||e.set(this,b9,"value")===aG){this.value=b9
}})}});bJ.extend({valHooks:{option:{get:function(e){var b3=e.attributes.value;return !b3||b3.specified?e.value:e.text}},select:{get:function(e){var b8,b4,ca=e.options,b6=e.selectedIndex,b5=e.type==="select-one"||b6<0,b9=b5?null:[],b7=b5?b6+1:ca.length,b3=b6<0?b7:b5?b6:0;for(;b3<b7;b3++){b4=ca[b3];if((b4.selected||b3===b6)&&(bJ.support.optDisabled?!b4.disabled:b4.getAttribute("disabled")===null)&&(!b4.parentNode.disabled||!bJ.nodeName(b4.parentNode,"optgroup"))){b8=bJ(b4).val();if(b5){return b8}b9.push(b8)
}}return b9},set:function(b3,b4){var e=bJ.makeArray(b4);bJ(b3).find("option").each(function(){this.selected=bJ.inArray(bJ(this).val(),e)>=0});if(!e.length){b3.selectedIndex=-1}return e}}},attr:function(b7,b5,b8){var e,b6,b4,b3=b7.nodeType;if(!b7||b3===3||b3===8||b3===2){return}if(typeof b7.getAttribute===aC){return bJ.prop(b7,b5,b8)}b6=b3!==1||!bJ.isXMLDoc(b7);if(b6){b5=b5.toLowerCase();e=bJ.attrHooks[b5]||(L.test(b5)?bZ:a8)}if(b8!==aG){if(b8===null){bJ.removeAttr(b7,b5)}else{if(e&&b6&&"set" in e&&(b4=e.set(b7,b8,b5))!==aG){return b4
}else{b7.setAttribute(b5,b8+"");return b8}}}else{if(e&&b6&&"get" in e&&(b4=e.get(b7,b5))!==null){return b4}else{if(typeof b7.getAttribute!==aC){b4=b7.getAttribute(b5)}return b4==null?aG:b4}}},removeAttr:function(b4,b6){var e,b5,b3=0,b7=b6&&b6.match(ac);if(b7&&b4.nodeType===1){while((e=b7[b3++])){b5=bJ.propFix[e]||e;if(L.test(e)){if(!bP&&aq.test(e)){b4[bJ.camelCase("default-"+e)]=b4[b5]=false}else{b4[b5]=false}}else{bJ.attr(b4,e,"")}b4.removeAttribute(bP?e:b5)}}},attrHooks:{type:{set:function(e,b3){if(!bJ.support.radioValue&&b3==="radio"&&bJ.nodeName(e,"input")){var b4=e.value;
e.setAttribute("type",b3);if(b4){e.value=b4}return b3}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(b7,b5,b8){var b4,e,b6,b3=b7.nodeType;if(!b7||b3===3||b3===8||b3===2){return}b6=b3!==1||!bJ.isXMLDoc(b7);if(b6){b5=bJ.propFix[b5]||b5;e=bJ.propHooks[b5]}if(b8!==aG){if(e&&"set" in e&&(b4=e.set(b7,b8,b5))!==aG){return b4
}else{return(b7[b5]=b8)}}else{if(e&&"get" in e&&(b4=e.get(b7,b5))!==null){return b4}else{return b7[b5]}}},propHooks:{tabIndex:{get:function(b3){var e=b3.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):aF.test(b3.nodeName)||D.test(b3.nodeName)&&b3.href?0:aG}}}});bZ={get:function(b5,b3){var b6=bJ.prop(b5,b3),e=typeof b6==="boolean"&&b5.getAttribute(b3),b4=typeof b6==="boolean"?bF&&bP?e!=null:aq.test(b3)?b5[bJ.camelCase("default-"+b3)]:!!e:b5.getAttributeNode(b3);return b4&&b4.value!==false?b3.toLowerCase():aG
},set:function(b3,b4,e){if(b4===false){bJ.removeAttr(b3,e)}else{if(bF&&bP||!aq.test(e)){b3.setAttribute(!bP&&bJ.propFix[e]||e,e)}else{b3[bJ.camelCase("default-"+e)]=b3[e]=true}}return e}};if(!bF||!bP){bJ.attrHooks.value={get:function(b4,b3){var e=b4.getAttributeNode(b3);return bJ.nodeName(b4,"input")?b4.defaultValue:e&&e.specified?e.value:aG},set:function(b3,b4,e){if(bJ.nodeName(b3,"input")){b3.defaultValue=b4}else{return a8&&a8.set(b3,b4,e)}}}}if(!bP){a8=bJ.valHooks.button={get:function(b4,b3){var e=b4.getAttributeNode(b3);
return e&&(b3==="id"||b3==="name"||b3==="coords"?e.value!=="":e.specified)?e.value:aG},set:function(b4,b5,b3){var e=b4.getAttributeNode(b3);if(!e){b4.setAttributeNode((e=b4.ownerDocument.createAttribute(b3)))}e.value=b5+="";return b3==="value"||b5===b4.getAttribute(b3)?b5:aG}};bJ.attrHooks.contenteditable={get:a8.get,set:function(b3,b4,e){a8.set(b3,b4===""?false:b4,e)}};bJ.each(["width","height"],function(b3,e){bJ.attrHooks[e]=bJ.extend(bJ.attrHooks[e],{set:function(b4,b5){if(b5===""){b4.setAttribute(e,"auto");
return b5}}})})}if(!bJ.support.hrefNormalized){bJ.each(["href","src","width","height"],function(b3,e){bJ.attrHooks[e]=bJ.extend(bJ.attrHooks[e],{get:function(b5){var b4=b5.getAttribute(e,2);return b4==null?aG:b4}})});bJ.each(["href","src"],function(b3,e){bJ.propHooks[e]={get:function(b4){return b4.getAttribute(e,4)}}})}if(!bJ.support.style){bJ.attrHooks.style={get:function(e){return e.style.cssText||aG},set:function(e,b3){return(e.style.cssText=b3+"")}}}if(!bJ.support.optSelected){bJ.propHooks.selected=bJ.extend(bJ.propHooks.selected,{get:function(b3){var e=b3.parentNode;
if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex}}return null}})}if(!bJ.support.enctype){bJ.propFix.enctype="encoding"}if(!bJ.support.checkOn){bJ.each(["radio","checkbox"],function(){bJ.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}bJ.each(["radio","checkbox"],function(){bJ.valHooks[this]=bJ.extend(bJ.valHooks[this],{set:function(e,b3){if(bJ.isArray(b3)){return(e.checked=bJ.inArray(bJ(e).val(),b3)>=0)}}})});var bH=/^(?:input|select|textarea)$/i,a3=/^key/,bN=/^(?:mouse|contextmenu)|click/,bB=/^(?:focusinfocus|focusoutblur)$/,bu=/^([^.]*)(?:\.(.+)|)$/;
function R(){return true}function X(){return false}bJ.event={global:{},add:function(b6,cb,cg,b8,b7){var b9,ch,ci,b4,cd,ca,cf,b5,ce,e,b3,cc=bJ._data(b6);if(!cc){return}if(cg.handler){b4=cg;cg=b4.handler;b7=b4.selector}if(!cg.guid){cg.guid=bJ.guid++}if(!(ch=cc.events)){ch=cc.events={}}if(!(ca=cc.handle)){ca=cc.handle=function(cj){return typeof bJ!==aC&&(!cj||bJ.event.triggered!==cj.type)?bJ.event.dispatch.apply(ca.elem,arguments):aG};ca.elem=b6}cb=(cb||"").match(ac)||[""];ci=cb.length;while(ci--){b9=bu.exec(cb[ci])||[];
ce=b3=b9[1];e=(b9[2]||"").split(".").sort();cd=bJ.event.special[ce]||{};ce=(b7?cd.delegateType:cd.bindType)||ce;cd=bJ.event.special[ce]||{};cf=bJ.extend({type:ce,origType:b3,data:b8,handler:cg,guid:cg.guid,selector:b7,needsContext:b7&&bJ.expr.match.needsContext.test(b7),namespace:e.join(".")},b4);if(!(b5=ch[ce])){b5=ch[ce]=[];b5.delegateCount=0;if(!cd.setup||cd.setup.call(b6,b8,e,ca)===false){if(b6.addEventListener){b6.addEventListener(ce,ca,false)}else{if(b6.attachEvent){b6.attachEvent("on"+ce,ca)
}}}}if(cd.add){cd.add.call(b6,cf);if(!cf.handler.guid){cf.handler.guid=cg.guid}}if(b7){b5.splice(b5.delegateCount++,0,cf)}else{b5.push(cf)}bJ.event.global[ce]=true}b6=null},remove:function(b5,cb,ci,b6,ca){var b8,cf,b9,b7,ch,cg,cd,b4,ce,e,b3,cc=bJ.hasData(b5)&&bJ._data(b5);if(!cc||!(cg=cc.events)){return}cb=(cb||"").match(ac)||[""];ch=cb.length;while(ch--){b9=bu.exec(cb[ch])||[];ce=b3=b9[1];e=(b9[2]||"").split(".").sort();if(!ce){for(ce in cg){bJ.event.remove(b5,ce+cb[ch],ci,b6,true)}continue}cd=bJ.event.special[ce]||{};
ce=(b6?cd.delegateType:cd.bindType)||ce;b4=cg[ce]||[];b9=b9[2]&&new RegExp("(^|\\.)"+e.join("\\.(?:.*\\.|)")+"(\\.|$)");b7=b8=b4.length;while(b8--){cf=b4[b8];if((ca||b3===cf.origType)&&(!ci||ci.guid===cf.guid)&&(!b9||b9.test(cf.namespace))&&(!b6||b6===cf.selector||b6==="**"&&cf.selector)){b4.splice(b8,1);if(cf.selector){b4.delegateCount--}if(cd.remove){cd.remove.call(b5,cf)}}}if(b7&&!b4.length){if(!cd.teardown||cd.teardown.call(b5,e,cc.handle)===false){bJ.removeEvent(b5,ce,cc.handle)}delete cg[ce]
}}if(bJ.isEmptyObject(cg)){delete cc.handle;bJ._removeData(b5,"events")}},trigger:function(b3,ca,b6,ch){var cb,b5,cf,cg,cd,b9,b8,b7=[b6||l],ce=V.call(b3,"type")?b3.type:b3,b4=V.call(b3,"namespace")?b3.namespace.split("."):[];cf=b9=b6=b6||l;if(b6.nodeType===3||b6.nodeType===8){return}if(bB.test(ce+bJ.event.triggered)){return}if(ce.indexOf(".")>=0){b4=ce.split(".");ce=b4.shift();b4.sort()}b5=ce.indexOf(":")<0&&"on"+ce;b3=b3[bJ.expando]?b3:new bJ.Event(ce,typeof b3==="object"&&b3);b3.isTrigger=true;
b3.namespace=b4.join(".");b3.namespace_re=b3.namespace?new RegExp("(^|\\.)"+b4.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;b3.result=aG;if(!b3.target){b3.target=b6}ca=ca==null?[b3]:bJ.makeArray(ca,[b3]);cd=bJ.event.special[ce]||{};if(!ch&&cd.trigger&&cd.trigger.apply(b6,ca)===false){return}if(!ch&&!cd.noBubble&&!bJ.isWindow(b6)){cg=cd.delegateType||ce;if(!bB.test(cg+ce)){cf=cf.parentNode}for(;cf;cf=cf.parentNode){b7.push(cf);b9=cf}if(b9===(b6.ownerDocument||l)){b7.push(b9.defaultView||b9.parentWindow||a2)
}}b8=0;while((cf=b7[b8++])&&!b3.isPropagationStopped()){b3.type=b8>1?cg:cd.bindType||ce;cb=(bJ._data(cf,"events")||{})[b3.type]&&bJ._data(cf,"handle");if(cb){cb.apply(cf,ca)}cb=b5&&cf[b5];if(cb&&bJ.acceptData(cf)&&cb.apply&&cb.apply(cf,ca)===false){b3.preventDefault()}}b3.type=ce;if(!ch&&!b3.isDefaultPrevented()){if((!cd._default||cd._default.apply(b6.ownerDocument,ca)===false)&&!(ce==="click"&&bJ.nodeName(b6,"a"))&&bJ.acceptData(b6)){if(b5&&b6[ce]&&!bJ.isWindow(b6)){b9=b6[b5];if(b9){b6[b5]=null}bJ.event.triggered=ce;
try{b6[ce]()}catch(cc){}bJ.event.triggered=aG;if(b9){b6[b5]=b9}}}}return b3.result},dispatch:function(e){e=bJ.event.fix(e);var b7,b8,cc,b3,b5,cb=[],ca=a4.call(arguments),b4=(bJ._data(this,"events")||{})[e.type]||[],b9=bJ.event.special[e.type]||{};ca[0]=e;e.delegateTarget=this;if(b9.preDispatch&&b9.preDispatch.call(this,e)===false){return}cb=bJ.event.handlers.call(this,e,b4);b7=0;while((b3=cb[b7++])&&!e.isPropagationStopped()){e.currentTarget=b3.elem;b5=0;while((cc=b3.handlers[b5++])&&!e.isImmediatePropagationStopped()){if(!e.namespace_re||e.namespace_re.test(cc.namespace)){e.handleObj=cc;
e.data=cc.data;var b6=((bJ.event.special[cc.origType]||{}).handle||cc.handler);if(b6.apply){b8=b6.apply(b3.elem,ca)}if(b8!==aG){if((e.result=b8)===false){e.preventDefault();e.stopPropagation()}}}}}if(b9.postDispatch){b9.postDispatch.call(this,e)}return e.result},handlers:function(e,b4){var b3,b9,b7,b6,b8=[],b5=b4.delegateCount,ca=e.target;if(b5&&ca.nodeType&&(!e.button||e.type!=="click")){for(;ca!=this;ca=ca.parentNode||this){if(ca.nodeType===1&&(ca.disabled!==true||e.type!=="click")){b7=[];for(b6=0;
b6<b5;b6++){b9=b4[b6];b3=b9.selector+" ";if(b7[b3]===aG){b7[b3]=b9.needsContext?bJ(b3,this).index(ca)>=0:bJ.find(b3,this,null,[ca]).length}if(b7[b3]){b7.push(b9)}}if(b7.length){b8.push({elem:ca,handlers:b7})}}}}if(b5<b4.length){b8.push({elem:this,handlers:b4.slice(b5)})}return b8},fix:function(b5){if(b5[bJ.expando]){return b5}var b3,b8,b7,b4=b5.type,e=b5,b6=this.fixHooks[b4];if(!b6){this.fixHooks[b4]=b6=bN.test(b4)?this.mouseHooks:a3.test(b4)?this.keyHooks:{}}b7=b6.props?this.props.concat(b6.props):this.props;
b5=new bJ.Event(e);b3=b7.length;while(b3--){b8=b7[b3];b5[b8]=e[b8]}if(!b5.target){b5.target=e.srcElement||l}if(b5.target.nodeType===3){b5.target=b5.target.parentNode}b5.metaKey=!!b5.metaKey;return b6.filter?b6.filter(b5,e):b5},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(b3,e){if(b3.which==null){b3.which=e.charCode!=null?e.charCode:e.keyCode
}return b3}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b5,b4){var e,b6,b7,b3=b4.button,b8=b4.fromElement;if(b5.pageX==null&&b4.clientX!=null){b6=b5.target.ownerDocument||l;b7=b6.documentElement;e=b6.body;b5.pageX=b4.clientX+(b7&&b7.scrollLeft||e&&e.scrollLeft||0)-(b7&&b7.clientLeft||e&&e.clientLeft||0);b5.pageY=b4.clientY+(b7&&b7.scrollTop||e&&e.scrollTop||0)-(b7&&b7.clientTop||e&&e.clientTop||0)
}if(!b5.relatedTarget&&b8){b5.relatedTarget=b8===b5.target?b4.toElement:b8}if(!b5.which&&b3!==aG){b5.which=(b3&1?1:(b3&2?3:(b3&4?2:0)))}return b5}},special:{load:{noBubble:true},click:{trigger:function(){if(bJ.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}}},focus:{trigger:function(){if(this!==l.activeElement&&this.focus){try{this.focus();return false}catch(b3){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===l.activeElement&&this.blur){this.blur();
return false}},delegateType:"focusout"},beforeunload:{postDispatch:function(e){if(e.result!==aG){e.originalEvent.returnValue=e.result}}}},simulate:function(b4,b6,b5,b3){var b7=bJ.extend(new bJ.Event(),b5,{type:b4,isSimulated:true,originalEvent:{}});if(b3){bJ.event.trigger(b7,null,b6)}else{bJ.event.dispatch.call(b6,b7)}if(b7.isDefaultPrevented()){b5.preventDefault()}}};bJ.removeEvent=l.removeEventListener?function(b3,e,b4){if(b3.removeEventListener){b3.removeEventListener(e,b4,false)}}:function(b4,b3,b5){var e="on"+b3;
if(b4.detachEvent){if(typeof b4[e]===aC){b4[e]=null}b4.detachEvent(e,b5)}};bJ.Event=function(b3,e){if(!(this instanceof bJ.Event)){return new bJ.Event(b3,e)}if(b3&&b3.type){this.originalEvent=b3;this.type=b3.type;this.isDefaultPrevented=(b3.defaultPrevented||b3.returnValue===false||b3.getPreventDefault&&b3.getPreventDefault())?R:X}else{this.type=b3}if(e){bJ.extend(this,e)}this.timeStamp=b3&&b3.timeStamp||bJ.now();this[bJ.expando]=true};bJ.Event.prototype={isDefaultPrevented:X,isPropagationStopped:X,isImmediatePropagationStopped:X,preventDefault:function(){var b3=this.originalEvent;
this.isDefaultPrevented=R;if(!b3){return}if(b3.preventDefault){b3.preventDefault()}else{b3.returnValue=false}},stopPropagation:function(){var b3=this.originalEvent;this.isPropagationStopped=R;if(!b3){return}if(b3.stopPropagation){b3.stopPropagation()}b3.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=R;this.stopPropagation()}};bJ.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b3,e){bJ.event.special[b3]={delegateType:e,bindType:e,handle:function(b6){var b4,b8=this,b7=b6.relatedTarget,b5=b6.handleObj;
if(!b7||(b7!==b8&&!bJ.contains(b8,b7))){b6.type=b5.origType;b4=b5.handler.apply(this,arguments);b6.type=e}return b4}}});if(!bJ.support.submitBubbles){bJ.event.special.submit={setup:function(){if(bJ.nodeName(this,"form")){return false}bJ.event.add(this,"click._submit keypress._submit",function(b5){var b4=b5.target,b3=bJ.nodeName(b4,"input")||bJ.nodeName(b4,"button")?b4.form:aG;if(b3&&!bJ._data(b3,"submitBubbles")){bJ.event.add(b3,"submit._submit",function(e){e._submit_bubble=true});bJ._data(b3,"submitBubbles",true)
}})},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){bJ.event.simulate("submit",this.parentNode,e,true)}}},teardown:function(){if(bJ.nodeName(this,"form")){return false}bJ.event.remove(this,"._submit")}}}if(!bJ.support.changeBubbles){bJ.event.special.change={setup:function(){if(bH.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){bJ.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true
}});bJ.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false}bJ.event.simulate("change",this,e,true)})}return false}bJ.event.add(this,"beforeactivate._change",function(b4){var b3=b4.target;if(bH.test(b3.nodeName)&&!bJ._data(b3,"changeBubbles")){bJ.event.add(b3,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){bJ.event.simulate("change",this.parentNode,e,true)}});bJ._data(b3,"changeBubbles",true)}})},handle:function(b3){var e=b3.target;
if(this!==e||b3.isSimulated||b3.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return b3.handleObj.handler.apply(this,arguments)}},teardown:function(){bJ.event.remove(this,"._change");return !bH.test(this.nodeName)}}}if(!bJ.support.focusinBubbles){bJ.each({focus:"focusin",blur:"focusout"},function(b5,e){var b3=0,b4=function(b6){bJ.event.simulate(e,b6.target,bJ.event.fix(b6),true)};bJ.event.special[e]={setup:function(){if(b3++===0){l.addEventListener(b5,b4,true)}},teardown:function(){if(--b3===0){l.removeEventListener(b5,b4,true)
}}}})}bJ.fn.extend({on:function(b4,e,b7,b6,b3){var b5,b8;if(typeof b4==="object"){if(typeof e!=="string"){b7=b7||e;e=aG}for(b5 in b4){this.on(b5,e,b7,b4[b5],b3)}return this}if(b7==null&&b6==null){b6=e;b7=e=aG}else{if(b6==null){if(typeof e==="string"){b6=b7;b7=aG}else{b6=b7;b7=e;e=aG}}}if(b6===false){b6=X}else{if(!b6){return this}}if(b3===1){b8=b6;b6=function(b9){bJ().off(b9);return b8.apply(this,arguments)};b6.guid=b8.guid||(b8.guid=bJ.guid++)}return this.each(function(){bJ.event.add(this,b4,b6,b7,e)
})},one:function(b3,e,b5,b4){return this.on(b3,e,b5,b4,1)},off:function(b4,e,b6){var b3,b5;if(b4&&b4.preventDefault&&b4.handleObj){b3=b4.handleObj;bJ(b4.delegateTarget).off(b3.namespace?b3.origType+"."+b3.namespace:b3.origType,b3.selector,b3.handler);return this}if(typeof b4==="object"){for(b5 in b4){this.off(b5,e,b4[b5])}return this}if(e===false||typeof e==="function"){b6=e;e=aG}if(b6===false){b6=X}return this.each(function(){bJ.event.remove(this,b4,b6,e)})},bind:function(e,b4,b3){return this.on(e,null,b4,b3)
},unbind:function(e,b3){return this.off(e,null,b3)},delegate:function(e,b3,b5,b4){return this.on(b3,e,b5,b4)},undelegate:function(e,b3,b4){return arguments.length===1?this.off(e,"**"):this.off(b3,e||"**",b4)},trigger:function(e,b3){return this.each(function(){bJ.event.trigger(e,b3,this)})},triggerHandler:function(e,b4){var b3=this[0];if(b3){return bJ.event.trigger(e,b4,b3,true)}}});
/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
(function(da,ch){var cx,cb,cn,cH,cJ,cS,cT,dg,cV,cB,co,cd,cZ,db,ca,cF,cD,c5="sizzle"+-(new Date()),cI=da.document,dd={},de=0,c0=0,b5=cz(),c4=cz(),cG=cz(),c9=typeof ch,cN=1<<31,c7=[],c8=c7.pop,b4=c7.push,cm=c7.slice,b9=c7.indexOf||function(di){var dh=0,e=this.length;
for(;dh<e;dh++){if(this[dh]===di){return dh}}return -1},cp="[\\x20\\t\\r\\n\\f]",b3="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",cK=b3.replace("w","w#"),ci="([*^$|!~]?=)",c2="\\["+cp+"*("+b3+")"+cp+"*(?:"+ci+cp+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cK+")|)|)"+cp+"*\\]",ck=":("+b3+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+c2.replace(3,8)+")*)|.*)\\)|)",cr=new RegExp("^"+cp+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cp+"+$","g"),cu=new RegExp("^"+cp+"*,"+cp+"*"),cA=new RegExp("^"+cp+"*([\\x20\\t\\r\\n\\f>+~])"+cp+"*"),cP=new RegExp(ck),cQ=new RegExp("^"+cK+"$"),cY={"ID":new RegExp("^#("+b3+")"),"CLASS":new RegExp("^\\.("+b3+")"),"NAME":new RegExp("^\\[name=['\"]?("+b3+")['\"]?\\]"),"TAG":new RegExp("^("+b3.replace("w","w*")+")"),"ATTR":new RegExp("^"+c2),"PSEUDO":new RegExp("^"+ck),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+cp+"*(even|odd|(([+-]|)(\\d*)n|)"+cp+"*(?:([+-]|)"+cp+"*(\\d+)|))"+cp+"*\\)|)","i"),"needsContext":new RegExp("^"+cp+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+cp+"*((?:-\\d)?\\d*)"+cp+"*\\)|)(?=[^-]|$)","i")},cW=/[\x20\t\r\n\f]*[+~]/,cM=/^[^{]+\{\s*\[native code/,cO=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,b8=/^(?:input|select|textarea|button)$/i,cl=/^h\d$/i,cL=/'|\\/g,ct=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,cs=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,c1=function(e,di){var dh="0x"+di-65536;
return dh!==dh?di:dh<0?String.fromCharCode(dh+65536):String.fromCharCode(dh>>10|55296,dh&1023|56320)};try{cm.call(cI.documentElement.childNodes,0)[0].nodeType}catch(cC){cm=function(dh){var di,e=[];while((di=this[dh++])){e.push(di)}return e}}function cE(e){return cM.test(e+"")}function cz(){var e,dh=[];return(e=function(di,dj){if(dh.push(di+=" ")>cn.cacheLength){delete e[dh.shift()]}return(e[di]=dj)})}function cj(e){e[c5]=true;return e}function cc(dh){var dj=cB.createElement("div");try{return dh(dj)
}catch(di){return false}finally{dj=null}}function cv(dp,dh,du,dw){try{cB===cB}catch(dr){cB=da.document}var dv,dl,dm,ds,dt,dk,dj,e,di,dq;if((dh?dh.ownerDocument||dh:cI)!==cB){cV(dh)}dh=dh||cB;du=du||[];if(!dp||typeof dp!=="string"){return du}if((ds=dh.nodeType)!==1&&ds!==9){return[]}if(!cd&&!dw){if((dv=cO.exec(dp))){if((dm=dv[1])){if(ds===9){dl=dh.getElementById(dm);if(dl&&dl.parentNode){if(dl.id===dm){du.push(dl);return du}}else{return du}}else{if(dh.ownerDocument&&(dl=dh.ownerDocument.getElementById(dm))&&cF(dh,dl)&&dl.id===dm){du.push(dl);
return du}}}else{if(dv[2]){b4.apply(du,cm.call(dh.getElementsByTagName(dp),0));return du}else{if((dm=dv[3])&&dd.getByClassName&&dh.getElementsByClassName){b4.apply(du,cm.call(dh.getElementsByClassName(dm),0));return du}}}}if(dd.qsa&&!cZ.test(dp)){dj=true;e=c5;di=dh;dq=ds===9&&dp;if(ds===1&&dh.nodeName.toLowerCase()!=="object"){dk=cf(dp);if((dj=dh.getAttribute("id"))){e=dj.replace(cL,"\\$&")}else{dh.setAttribute("id",e)}e="[id='"+e+"'] ";dt=dk.length;while(dt--){dk[dt]=e+cg(dk[dt])}di=cW.test(dp)&&dh.parentNode||dh;
dq=dk.join(",")}if(dq){try{b4.apply(du,cm.call(di.querySelectorAll(dq),0));return du}catch(dn){}finally{if(!dj){dh.removeAttribute("id")}}}}}return dc(dp.replace(cr,"$1"),dh,du,dw)}cJ=cv.isXML=function(e){var dh=e&&(e.ownerDocument||e).documentElement;return dh?dh.nodeName!=="HTML":false};cV=cv.setDocument=function(e){var dh=e?e.ownerDocument||e:cI;if(dh===cB||dh.nodeType!==9||!dh.documentElement){return cB}cB=dh;co=dh.documentElement;cd=cJ(dh);dd.tagNameNoComments=cc(function(di){di.appendChild(dh.createComment(""));
return !di.getElementsByTagName("*").length});dd.attributes=cc(function(dj){dj.innerHTML="<select></select>";var di=typeof dj.lastChild.getAttribute("multiple");return di!=="boolean"&&di!=="string"});dd.getByClassName=cc(function(di){di.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!di.getElementsByClassName||!di.getElementsByClassName("e").length){return false}di.lastChild.className="e";return di.getElementsByClassName("e").length===2});dd.getByName=cc(function(dj){dj.id=c5+0;
dj.innerHTML="<a name='"+c5+"'></a><div name='"+c5+"'></div>";co.insertBefore(dj,co.firstChild);var di=dh.getElementsByName&&dh.getElementsByName(c5).length===2+dh.getElementsByName(c5+0).length;dd.getIdNotName=!dh.getElementById(c5);co.removeChild(dj);return di});cn.attrHandle=cc(function(di){di.innerHTML="<a href='#'></a>";return di.firstChild&&typeof di.firstChild.getAttribute!==c9&&di.firstChild.getAttribute("href")==="#"})?{}:{"href":function(di){return di.getAttribute("href",2)},"type":function(di){return di.getAttribute("type")
}};if(dd.getIdNotName){cn.find["ID"]=function(dk,dj){if(typeof dj.getElementById!==c9&&!cd){var di=dj.getElementById(dk);return di&&di.parentNode?[di]:[]}};cn.filter["ID"]=function(dj){var di=dj.replace(cs,c1);return function(dk){return dk.getAttribute("id")===di}}}else{cn.find["ID"]=function(dk,dj){if(typeof dj.getElementById!==c9&&!cd){var di=dj.getElementById(dk);return di?di.id===dk||typeof di.getAttributeNode!==c9&&di.getAttributeNode("id").value===dk?[di]:ch:[]}};cn.filter["ID"]=function(dj){var di=dj.replace(cs,c1);
return function(dl){var dk=typeof dl.getAttributeNode!==c9&&dl.getAttributeNode("id");return dk&&dk.value===di}}}cn.find["TAG"]=dd.tagNameNoComments?function(di,dj){if(typeof dj.getElementsByTagName!==c9){return dj.getElementsByTagName(di)}}:function(di,dm){var dn,dl=[],dk=0,dj=dm.getElementsByTagName(di);if(di==="*"){while((dn=dj[dk++])){if(dn.nodeType===1){dl.push(dn)}}return dl}return dj};cn.find["NAME"]=dd.getByName&&function(di,dj){if(typeof dj.getElementsByName!==c9){return dj.getElementsByName(name)
}};cn.find["CLASS"]=dd.getByClassName&&function(dj,di){if(typeof di.getElementsByClassName!==c9&&!cd){return di.getElementsByClassName(dj)}};db=[];cZ=[":focus"];if((dd.qsa=cE(dh.querySelectorAll))){cc(function(di){di.innerHTML="<select><option selected=''></option></select>";if(!di.querySelectorAll("[selected]").length){cZ.push("\\["+cp+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!di.querySelectorAll(":checked").length){cZ.push(":checked")}});cc(function(di){di.innerHTML="<input type='hidden' i=''/>";
if(di.querySelectorAll("[i^='']").length){cZ.push("[*^$]="+cp+"*(?:\"\"|'')")}if(!di.querySelectorAll(":enabled").length){cZ.push(":enabled",":disabled")}di.querySelectorAll("*,:x");cZ.push(",.*:")})}if((dd.matchesSelector=cE((ca=co.matchesSelector||co.mozMatchesSelector||co.webkitMatchesSelector||co.oMatchesSelector||co.msMatchesSelector)))){cc(function(di){dd.disconnectedMatch=ca.call(di,"div");ca.call(di,"[s!='']:x");db.push("!=",ck)})}cZ=new RegExp(cZ.join("|"));db=new RegExp(db.join("|"));cF=cE(co.contains)||co.compareDocumentPosition?function(dj,di){var dl=dj.nodeType===9?dj.documentElement:dj,dk=di&&di.parentNode;
return dj===dk||!!(dk&&dk.nodeType===1&&(dl.contains?dl.contains(dk):dj.compareDocumentPosition&&dj.compareDocumentPosition(dk)&16))}:function(dj,di){if(di){while((di=di.parentNode)){if(di===dj){return true}}}return false};cD=co.compareDocumentPosition?function(dj,di){var dk;if(dj===di){cT=true;return 0}if((dk=di.compareDocumentPosition&&dj.compareDocumentPosition&&dj.compareDocumentPosition(di))){if(dk&1||dj.parentNode&&dj.parentNode.nodeType===11){if(dj===dh||cF(cI,dj)){return -1}if(di===dh||cF(cI,di)){return 1
}return 0}return dk&4?-1:1}return dj.compareDocumentPosition?-1:1}:function(dj,di){var dq,dm=0,dp=dj.parentNode,dl=di.parentNode,dk=[dj],dn=[di];if(dj===di){cT=true;return 0}else{if(!dp||!dl){return dj===dh?-1:di===dh?1:dp?-1:dl?1:0}else{if(dp===dl){return b6(dj,di)}}}dq=dj;while((dq=dq.parentNode)){dk.unshift(dq)}dq=di;while((dq=dq.parentNode)){dn.unshift(dq)}while(dk[dm]===dn[dm]){dm++}return dm?b6(dk[dm],dn[dm]):dk[dm]===cI?-1:dn[dm]===cI?1:0};cT=false;[0,0].sort(cD);dd.detectDuplicates=cT;return cB
};cv.matches=function(dh,e){return cv(dh,null,null,e)};cv.matchesSelector=function(di,dk){if((di.ownerDocument||di)!==cB){cV(di)}dk=dk.replace(ct,"='$1']");if(dd.matchesSelector&&!cd&&(!db||!db.test(dk))&&!cZ.test(dk)){try{var dh=ca.call(di,dk);if(dh||dd.disconnectedMatch||di.document&&di.document.nodeType!==11){return dh}}catch(dj){}}return cv(dk,cB,null,[di]).length>0};cv.contains=function(e,dh){if((e.ownerDocument||e)!==cB){cV(e)}return cF(e,dh)};cv.attr=function(dh,e){var di;if((dh.ownerDocument||dh)!==cB){cV(dh)
}if(!cd){e=e.toLowerCase()}if((di=cn.attrHandle[e])){return di(dh)}if(cd||dd.attributes){return dh.getAttribute(e)}return((di=dh.getAttributeNode(e))||dh.getAttribute(e))&&dh[e]===true?e:di&&di.specified?di.value:null};cv.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};cv.uniqueSort=function(di){var dj,dk=[],dh=1,e=0;cT=!dd.detectDuplicates;di.sort(cD);if(cT){for(;(dj=di[dh]);dh++){if(dj===di[dh-1]){e=dk.push(dh)}}while(e--){di.splice(dk[e],1)}}return di};function b6(dh,e){var dj=e&&dh,di=dj&&(~e.sourceIndex||cN)-(~dh.sourceIndex||cN);
if(di){return di}if(dj){while((dj=dj.nextSibling)){if(dj===e){return -1}}}return dh?1:-1}function cw(e){return function(di){var dh=di.nodeName.toLowerCase();return dh==="input"&&di.type===e}}function b7(e){return function(di){var dh=di.nodeName.toLowerCase();return(dh==="input"||dh==="button")&&di.type===e}}function c3(e){return cj(function(dh){dh=+dh;return cj(function(di,dm){var dk,dj=e([],di.length,dh),dl=dj.length;while(dl--){if(di[(dk=dj[dl])]){di[dk]=!(dm[dk]=di[dk])}}})})}cH=cv.getText=function(dk){var dj,dh="",di=0,e=dk.nodeType;
if(!e){for(;(dj=dk[di]);di++){dh+=cH(dj)}}else{if(e===1||e===9||e===11){if(typeof dk.textContent==="string"){return dk.textContent}else{for(dk=dk.firstChild;dk;dk=dk.nextSibling){dh+=cH(dk)}}}else{if(e===3||e===4){return dk.nodeValue}}}return dh};cn=cv.selectors={cacheLength:50,createPseudo:cj,match:cY,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(e){e[1]=e[1].replace(cs,c1);
e[3]=(e[4]||e[5]||"").replace(cs,c1);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},"CHILD":function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){cv.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+((e[7]+e[8])||e[3]==="odd")}else{if(e[3]){cv.error(e[0])}}return e},"PSEUDO":function(dh){var e,di=!dh[5]&&dh[2];if(cY["CHILD"].test(dh[0])){return null}if(dh[4]){dh[2]=dh[4]}else{if(di&&cP.test(di)&&(e=cf(di,true))&&(e=di.indexOf(")",di.length-e)-di.length)){dh[0]=dh[0].slice(0,e);
dh[2]=di.slice(0,e)}}return dh.slice(0,3)}},filter:{"TAG":function(e){if(e==="*"){return function(){return true}}e=e.replace(cs,c1).toLowerCase();return function(dh){return dh.nodeName&&dh.nodeName.toLowerCase()===e}},"CLASS":function(e){var dh=b5[e+" "];return dh||(dh=new RegExp("(^|"+cp+")"+e+"("+cp+"|$)"))&&b5(e,function(di){return dh.test(di.className||(typeof di.getAttribute!==c9&&di.getAttribute("class"))||"")})},"ATTR":function(di,dh,e){return function(dk){var dj=cv.attr(dk,di);if(dj==null){return dh==="!="
}if(!dh){return true}dj+="";return dh==="="?dj===e:dh==="!="?dj!==e:dh==="^="?e&&dj.indexOf(e)===0:dh==="*="?e&&dj.indexOf(e)>-1:dh==="$="?e&&dj.slice(-e.length)===e:dh==="~="?(" "+dj+" ").indexOf(e)>-1:dh==="|="?dj===e||dj.slice(0,e.length+1)===e+"-":false}},"CHILD":function(dh,dk,dj,dl,di){var dn=dh.slice(0,3)!=="nth",e=dh.slice(-4)!=="last",dm=dk==="of-type";return dl===1&&di===0?function(dp){return !!dp.parentNode}:function(dv,dt,dy){var dp,dB,dw,dA,dx,ds,du=dn!==e?"nextSibling":"previousSibling",dz=dv.parentNode,dr=dm&&dv.nodeName.toLowerCase(),dq=!dy&&!dm;
if(dz){if(dn){while(du){dw=dv;while((dw=dw[du])){if(dm?dw.nodeName.toLowerCase()===dr:dw.nodeType===1){return false}}ds=du=dh==="only"&&!ds&&"nextSibling"}return true}ds=[e?dz.firstChild:dz.lastChild];if(e&&dq){dB=dz[c5]||(dz[c5]={});dp=dB[dh]||[];dx=dp[0]===de&&dp[1];dA=dp[0]===de&&dp[2];dw=dx&&dz.childNodes[dx];while((dw=++dx&&dw&&dw[du]||(dA=dx=0)||ds.pop())){if(dw.nodeType===1&&++dA&&dw===dv){dB[dh]=[de,dx,dA];break}}}else{if(dq&&(dp=(dv[c5]||(dv[c5]={}))[dh])&&dp[0]===de){dA=dp[1]}else{while((dw=++dx&&dw&&dw[du]||(dA=dx=0)||ds.pop())){if((dm?dw.nodeName.toLowerCase()===dr:dw.nodeType===1)&&++dA){if(dq){(dw[c5]||(dw[c5]={}))[dh]=[de,dA]
}if(dw===dv){break}}}}}dA-=di;return dA===dl||(dA%dl===0&&dA/dl>=0)}}},"PSEUDO":function(dj,di){var e,dh=cn.pseudos[dj]||cn.setFilters[dj.toLowerCase()]||cv.error("unsupported pseudo: "+dj);if(dh[c5]){return dh(di)}if(dh.length>1){e=[dj,dj,"",di];return cn.setFilters.hasOwnProperty(dj.toLowerCase())?cj(function(dm,dp){var dl,dk=dh(dm,di),dn=dk.length;while(dn--){dl=b9.call(dm,dk[dn]);dm[dl]=!(dp[dl]=dk[dn])}}):function(dk){return dh(dk,0,e)}}return dh}},pseudos:{"not":cj(function(e){var dh=[],di=[],dj=cS(e.replace(cr,"$1"));
return dj[c5]?cj(function(dl,dr,dp,dm){var dq,dk=dj(dl,null,dm,[]),dn=dl.length;while(dn--){if((dq=dk[dn])){dl[dn]=!(dr[dn]=dq)}}}):function(dm,dl,dk){dh[0]=dm;dj(dh,null,dk,di);return !di.pop()}}),"has":cj(function(e){return function(dh){return cv(e,dh).length>0}}),"contains":cj(function(e){return function(dh){return(dh.textContent||dh.innerText||cH(dh)).indexOf(e)>-1}}),"lang":cj(function(e){if(!cQ.test(e||"")){cv.error("unsupported lang: "+e)}e=e.replace(cs,c1).toLowerCase();return function(di){var dh;
do{if((dh=cd?di.getAttribute("xml:lang")||di.getAttribute("lang"):di.lang)){dh=dh.toLowerCase();return dh===e||dh.indexOf(e+"-")===0}}while((di=di.parentNode)&&di.nodeType===1);return false}}),"target":function(e){var dh=da.location&&da.location.hash;return dh&&dh.slice(1)===e.id},"root":function(e){return e===co},"focus":function(e){return e===cB.activeElement&&(!cB.hasFocus||cB.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},"enabled":function(e){return e.disabled===false},"disabled":function(e){return e.disabled===true
},"checked":function(e){var dh=e.nodeName.toLowerCase();return(dh==="input"&&!!e.checked)||(dh==="option"&&!!e.selected)},"selected":function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},"empty":function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4){return false}}return true},"parent":function(e){return !cn.pseudos["empty"](e)},"header":function(e){return cl.test(e.nodeName)},"input":function(e){return b8.test(e.nodeName)},"button":function(dh){var e=dh.nodeName.toLowerCase();
return e==="input"&&dh.type==="button"||e==="button"},"text":function(dh){var e;return dh.nodeName.toLowerCase()==="input"&&dh.type==="text"&&((e=dh.getAttribute("type"))==null||e.toLowerCase()===dh.type)},"first":c3(function(){return[0]}),"last":c3(function(e,dh){return[dh-1]}),"eq":c3(function(e,di,dh){return[dh<0?dh+di:dh]}),"even":c3(function(e,di){var dh=0;for(;dh<di;dh+=2){e.push(dh)}return e}),"odd":c3(function(e,di){var dh=1;for(;dh<di;dh+=2){e.push(dh)}return e}),"lt":c3(function(e,dj,di){var dh=di<0?di+dj:di;
for(;--dh>=0;){e.push(dh)}return e}),"gt":c3(function(e,dj,di){var dh=di<0?di+dj:di;for(;++dh<dj;){e.push(dh)}return e})}};for(cx in {radio:true,checkbox:true,file:true,password:true,image:true}){cn.pseudos[cx]=cw(cx)}for(cx in {submit:true,reset:true}){cn.pseudos[cx]=b7(cx)}function cf(dk,dq){var dh,dl,dn,dp,dm,di,e,dj=c4[dk+" "];if(dj){return dq?0:dj.slice(0)}dm=dk;di=[];e=cn.preFilter;while(dm){if(!dh||(dl=cu.exec(dm))){if(dl){dm=dm.slice(dl[0].length)||dm}di.push(dn=[])}dh=false;if((dl=cA.exec(dm))){dh=dl.shift();
dn.push({value:dh,type:dl[0].replace(cr," ")});dm=dm.slice(dh.length)}for(dp in cn.filter){if((dl=cY[dp].exec(dm))&&(!e[dp]||(dl=e[dp](dl)))){dh=dl.shift();dn.push({value:dh,type:dp,matches:dl});dm=dm.slice(dh.length)}}if(!dh){break}}return dq?dm.length:dm?cv.error(dk):c4(dk,di).slice(0)}function cg(dj){var di=0,dh=dj.length,e="";for(;di<dh;di++){e+=dj[di].value}return e}function cq(dk,di,dj){var e=di.dir,dl=dj&&e==="parentNode",dh=c0++;return di.first?function(dp,dn,dm){while((dp=dp[e])){if(dp.nodeType===1||dl){return dk(dp,dn,dm)
}}}:function(dr,dp,dn){var dt,dm,dq,ds=de+" "+dh;if(dn){while((dr=dr[e])){if(dr.nodeType===1||dl){if(dk(dr,dp,dn)){return true}}}}else{while((dr=dr[e])){if(dr.nodeType===1||dl){dq=dr[c5]||(dr[c5]={});if((dm=dq[e])&&dm[0]===ds){if((dt=dm[1])===true||dt===cb){return dt===true}}else{dm=dq[e]=[ds];dm[1]=dk(dr,dp,dn)||cb;if(dm[1]===true){return true}}}}}}}function df(e){return e.length>1?function(dk,dj,dh){var di=e.length;while(di--){if(!e[di](dk,dj,dh)){return false}}return true}:e[0]}function cX(e,dh,di,dj,dm){var dk,dq=[],dl=0,dn=e.length,dp=dh!=null;
for(;dl<dn;dl++){if((dk=e[dl])){if(!di||di(dk,dj,dm)){dq.push(dk);if(dp){dh.push(dl)}}}}return dq}function ce(di,dh,dk,dj,dl,e){if(dj&&!dj[c5]){dj=ce(dj)}if(dl&&!dl[c5]){dl=ce(dl,e)}return cj(function(dx,du,dp,dw){var dz,dv,dr,dq=[],dy=[],dn=du.length,dm=dx||cy(dh||"*",dp.nodeType?[dp]:dp,[]),ds=di&&(dx||!dh)?cX(dm,dq,di,dp,dw):dm,dt=dk?dl||(dx?di:dn||dj)?[]:du:ds;if(dk){dk(ds,dt,dp,dw)}if(dj){dz=cX(dt,dy);dj(dz,[],dp,dw);dv=dz.length;while(dv--){if((dr=dz[dv])){dt[dy[dv]]=!(ds[dy[dv]]=dr)}}}if(dx){if(dl||di){if(dl){dz=[];
dv=dt.length;while(dv--){if((dr=dt[dv])){dz.push((ds[dv]=dr))}}dl(null,(dt=[]),dz,dw)}dv=dt.length;while(dv--){if((dr=dt[dv])&&(dz=dl?b9.call(dx,dr):dq[dv])>-1){dx[dz]=!(du[dz]=dr)}}}}else{dt=cX(dt===du?dt.splice(dn,dt.length):dt);if(dl){dl(null,du,dt,dw)}else{b4.apply(du,dt)}}})}function c6(dm){var dh,dk,di,dl=dm.length,dq=cn.relative[dm[0].type],dr=dq||cn.relative[" "],dj=dq?1:0,dn=cq(function(ds){return ds===dh},dr,true),dp=cq(function(ds){return b9.call(dh,ds)>-1},dr,true),e=[function(du,dt,ds){return(!dq&&(ds||dt!==dg))||((dh=dt).nodeType?dn(du,dt,ds):dp(du,dt,ds))
}];for(;dj<dl;dj++){if((dk=cn.relative[dm[dj].type])){e=[cq(df(e),dk)]}else{dk=cn.filter[dm[dj].type].apply(null,dm[dj].matches);if(dk[c5]){di=++dj;for(;di<dl;di++){if(cn.relative[dm[di].type]){break}}return ce(dj>1&&df(e),dj>1&&cg(dm.slice(0,dj-1)).replace(cr,"$1"),dk,dj<di&&c6(dm.slice(dj,di)),di<dl&&c6((dm=dm.slice(di))),di<dl&&cg(dm))}e.push(dk)}}return df(e)}function cU(dj,di){var dl=0,e=di.length>0,dk=dj.length>0,dh=function(dw,dq,dv,du,dC){var dr,ds,dx,dB=[],dA=0,dt="0",dm=dw&&[],dy=dC!=null,dz=dg,dp=dw||dk&&cn.find["TAG"]("*",dC&&dq.parentNode||dq),dn=(de+=dz==null?1:Math.random()||0.1);
if(dy){dg=dq!==cB&&dq;cb=dl}for(;(dr=dp[dt])!=null;dt++){if(dk&&dr){ds=0;while((dx=dj[ds++])){if(dx(dr,dq,dv)){du.push(dr);break}}if(dy){de=dn;cb=++dl}}if(e){if((dr=!dx&&dr)){dA--}if(dw){dm.push(dr)}}}dA+=dt;if(e&&dt!==dA){ds=0;while((dx=di[ds++])){dx(dm,dB,dq,dv)}if(dw){if(dA>0){while(dt--){if(!(dm[dt]||dB[dt])){dB[dt]=c8.call(du)}}}dB=cX(dB)}b4.apply(du,dB);if(dy&&!dw&&dB.length>0&&(dA+di.length)>1){cv.uniqueSort(du)}}if(dy){de=dn;dg=dz}return dm};return e?cj(dh):dh}cS=cv.compile=function(e,dl){var di,dh=[],dk=[],dj=cG[e+" "];
if(!dj){if(!dl){dl=cf(e)}di=dl.length;while(di--){dj=c6(dl[di]);if(dj[c5]){dh.push(dj)}else{dk.push(dj)}}dj=cG(e,cU(dk,dh))}return dj};function cy(dh,dk,dj){var di=0,e=dk.length;for(;di<e;di++){cv(dh,dk[di],dj)}return dj}function dc(di,e,dj,dm){var dk,dp,dh,dq,dn,dl=cf(di);if(!dm){if(dl.length===1){dp=dl[0]=dl[0].slice(0);if(dp.length>2&&(dh=dp[0]).type==="ID"&&e.nodeType===9&&!cd&&cn.relative[dp[1].type]){e=cn.find["ID"](dh.matches[0].replace(cs,c1),e)[0];if(!e){return dj}di=di.slice(dp.shift().value.length)
}dk=cY["needsContext"].test(di)?0:dp.length;while(dk--){dh=dp[dk];if(cn.relative[(dq=dh.type)]){break}if((dn=cn.find[dq])){if((dm=dn(dh.matches[0].replace(cs,c1),cW.test(dp[0].type)&&e.parentNode||e))){dp.splice(dk,1);di=dm.length&&cg(dp);if(!di){b4.apply(dj,cm.call(dm,0));return dj}break}}}}}cS(di,dl)(dm,e,cd,dj,cW.test(di));return dj}cn.pseudos["nth"]=cn.pseudos["eq"];function cR(){}cn.filters=cR.prototype=cn.pseudos;cn.setFilters=new cR();cV();cv.attr=bJ.attr;bJ.find=cv;bJ.expr=cv.selectors;bJ.expr[":"]=bJ.expr.pseudos;
bJ.unique=cv.uniqueSort;bJ.text=cv.getText;bJ.isXMLDoc=cv.isXML;bJ.contains=cv.contains})(a2);var aj=/Until$/,bt=/^(?:parents|prev(?:Until|All))/,an=/^.[^:#\[\.,]*$/,y=bJ.expr.match.needsContext,bx={children:true,contents:true,next:true,prev:true};bJ.fn.extend({find:function(b3){var b6,b5,b4,e=this.length;if(typeof b3!=="string"){b4=this;return this.pushStack(bJ(b3).filter(function(){for(b6=0;b6<e;b6++){if(bJ.contains(b4[b6],this)){return true}}}))}b5=[];for(b6=0;b6<e;b6++){bJ.find(b3,this[b6],b5)
}b5=this.pushStack(e>1?bJ.unique(b5):b5);b5.selector=(this.selector?this.selector+" ":"")+b3;return b5},has:function(b5){var b4,b3=bJ(b5,this),e=b3.length;return this.filter(function(){for(b4=0;b4<e;b4++){if(bJ.contains(this,b3[b4])){return true}}})},not:function(e){return this.pushStack(aO(this,e,false))},filter:function(e){return this.pushStack(aO(this,e,true))},is:function(e){return !!e&&(typeof e==="string"?y.test(e)?bJ(e,this.context).index(this[0])>=0:bJ.filter(e,this).length>0:this.filter(e).length>0)
},closest:function(b6,b5){var b7,b4=0,e=this.length,b3=[],b8=y.test(b6)||typeof b6!=="string"?bJ(b6,b5||this.context):0;for(;b4<e;b4++){b7=this[b4];while(b7&&b7.ownerDocument&&b7!==b5&&b7.nodeType!==11){if(b8?b8.index(b7)>-1:bJ.find.matchesSelector(b7,b6)){b3.push(b7);break}b7=b7.parentNode}}return this.pushStack(b3.length>1?bJ.unique(b3):b3)},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1}if(typeof e==="string"){return bJ.inArray(this[0],bJ(e))}return bJ.inArray(e.jquery?e[0]:e,this)
},add:function(e,b3){var b5=typeof e==="string"?bJ(e,b3):bJ.makeArray(e&&e.nodeType?[e]:e),b4=bJ.merge(this.get(),b5);return this.pushStack(bJ.unique(b4))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});bJ.fn.andSelf=bJ.fn.addBack;function aX(b3,e){do{b3=b3[e]}while(b3&&b3.nodeType!==1);return b3}bJ.each({parent:function(b3){var e=b3.parentNode;return e&&e.nodeType!==11?e:null},parents:function(e){return bJ.dir(e,"parentNode")},parentsUntil:function(b3,e,b4){return bJ.dir(b3,"parentNode",b4)
},next:function(e){return aX(e,"nextSibling")},prev:function(e){return aX(e,"previousSibling")},nextAll:function(e){return bJ.dir(e,"nextSibling")},prevAll:function(e){return bJ.dir(e,"previousSibling")},nextUntil:function(b3,e,b4){return bJ.dir(b3,"nextSibling",b4)},prevUntil:function(b3,e,b4){return bJ.dir(b3,"previousSibling",b4)},siblings:function(e){return bJ.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return bJ.sibling(e.firstChild)},contents:function(e){return bJ.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:bJ.merge([],e.childNodes)
}},function(e,b3){bJ.fn[e]=function(b6,b4){var b5=bJ.map(this,b3,b6);if(!aj.test(e)){b4=b6}if(b4&&typeof b4==="string"){b5=bJ.filter(b4,b5)}b5=this.length>1&&!bx[e]?bJ.unique(b5):b5;if(this.length>1&&bt.test(e)){b5=b5.reverse()}return this.pushStack(b5)}});bJ.extend({filter:function(b4,e,b3){if(b3){b4=":not("+b4+")"}return e.length===1?bJ.find.matchesSelector(e[0],b4)?[e[0]]:[]:bJ.find.matches(b4,e)},dir:function(b4,b3,b6){var e=[],b5=b4[b3];while(b5&&b5.nodeType!==9&&(b6===aG||b5.nodeType!==1||!bJ(b5).is(b6))){if(b5.nodeType===1){e.push(b5)
}b5=b5[b3]}return e},sibling:function(b4,b3){var e=[];for(;b4;b4=b4.nextSibling){if(b4.nodeType===1&&b4!==b3){e.push(b4)}}return e}});function aO(b5,b4,e){b4=b4||0;if(bJ.isFunction(b4)){return bJ.grep(b5,function(b7,b6){var b8=!!b4.call(b7,b6,b7);return b8===e})}else{if(b4.nodeType){return bJ.grep(b5,function(b6){return(b6===b4)===e})}else{if(typeof b4==="string"){var b3=bJ.grep(b5,function(b6){return b6.nodeType===1});if(an.test(b4)){return bJ.filter(b4,b3,!e)}else{b4=bJ.filter(b4,b3)}}}}return bJ.grep(b5,function(b6){return(bJ.inArray(b6,b4)>=0)===e
})}function A(e){var b4=d.split("|"),b3=e.createDocumentFragment();if(b3.createElement){while(b4.length){b3.createElement(b4.pop())}}return b3}var d="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",aA=/ jQuery\d+="(?:null|\d+)"/g,J=new RegExp("<(?:"+d+")[\\s/>]","i"),b2=/^\s+/,aD=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,m=/<([\w:]+)/,bX=/<tbody/i,I=/<|&#?\w+;/,al=/<(?:script|style|link)/i,q=/^(?:checkbox|radio)$/i,bU=/checked\s*(?:[^=]|=\s*.checked.)/i,bz=/^$|\/(?:java|ecma)script/i,ar=/^true\/(.*)/,aK=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,T={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:bJ.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},aS=A(l),j=aS.appendChild(l.createElement("div"));
T.optgroup=T.option;T.tbody=T.tfoot=T.colgroup=T.caption=T.thead;T.th=T.td;bJ.fn.extend({text:function(e){return bJ.access(this,function(b3){return b3===aG?bJ.text(this):this.empty().append((this[0]&&this[0].ownerDocument||l).createTextNode(b3))},null,e,arguments.length)},wrapAll:function(e){if(bJ.isFunction(e)){return this.each(function(b4){bJ(this).wrapAll(e.call(this,b4))})}if(this[0]){var b3=bJ(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){b3.insertBefore(this[0])}b3.map(function(){var b4=this;
while(b4.firstChild&&b4.firstChild.nodeType===1){b4=b4.firstChild}return b4}).append(this)}return this},wrapInner:function(e){if(bJ.isFunction(e)){return this.each(function(b3){bJ(this).wrapInner(e.call(this,b3))})}return this.each(function(){var b3=bJ(this),b4=b3.contents();if(b4.length){b4.wrapAll(e)}else{b3.append(e)}})},wrap:function(e){var b3=bJ.isFunction(e);return this.each(function(b4){bJ(this).wrapAll(b3?e.call(this,b4):e)})},unwrap:function(){return this.parent().each(function(){if(!bJ.nodeName(this,"body")){bJ(this).replaceWith(this.childNodes)
}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.insertBefore(e,this.firstChild)}})},before:function(){return this.domManip(arguments,false,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return this.domManip(arguments,false,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)
}})},remove:function(e,b5){var b4,b3=0;for(;(b4=this[b3])!=null;b3++){if(!e||bJ.filter(e,[b4]).length>0){if(!b5&&b4.nodeType===1){bJ.cleanData(k(b4))}if(b4.parentNode){if(b5&&bJ.contains(b4.ownerDocument,b4)){bs(k(b4,"script"))}b4.parentNode.removeChild(b4)}}}return this},empty:function(){var b3,e=0;for(;(b3=this[e])!=null;e++){if(b3.nodeType===1){bJ.cleanData(k(b3,false))}while(b3.firstChild){b3.removeChild(b3.firstChild)}if(b3.options&&bJ.nodeName(b3,"select")){b3.options.length=0}}return this},clone:function(b3,e){b3=b3==null?false:b3;
e=e==null?b3:e;return this.map(function(){return bJ.clone(this,b3,e)})},html:function(e){return bJ.access(this,function(b6){var b5=this[0]||{},b4=0,b3=this.length;if(b6===aG){return b5.nodeType===1?b5.innerHTML.replace(aA,""):aG}if(typeof b6==="string"&&!al.test(b6)&&(bJ.support.htmlSerialize||!J.test(b6))&&(bJ.support.leadingWhitespace||!b2.test(b6))&&!T[(m.exec(b6)||["",""])[1].toLowerCase()]){b6=b6.replace(aD,"<$1></$2>");try{for(;b4<b3;b4++){b5=this[b4]||{};if(b5.nodeType===1){bJ.cleanData(k(b5,false));
b5.innerHTML=b6}}b5=0}catch(b7){}}if(b5){this.empty().append(b6)}},null,e,arguments.length)},replaceWith:function(b3){var e=bJ.isFunction(b3);if(!e&&typeof b3!=="string"){b3=bJ(b3).not(this).detach()}return this.domManip([b3],true,function(b6){var b5=this.nextSibling,b4=this.parentNode;if(b4){bJ(this).remove();b4.insertBefore(b6,b5)}})},detach:function(e){return this.remove(e,true)},domManip:function(ca,cg,cf){ca=aI.apply([],ca);var b8,b4,e,b6,cd,b9,b7=0,b5=this.length,cc=this,ce=b5-1,cb=ca[0],b3=bJ.isFunction(cb);
if(b3||!(b5<=1||typeof cb!=="string"||bJ.support.checkClone||!bU.test(cb))){return this.each(function(ci){var ch=cc.eq(ci);if(b3){ca[0]=cb.call(this,ci,cg?ch.html():aG)}ch.domManip(ca,cg,cf)})}if(b5){b9=bJ.buildFragment(ca,this[0].ownerDocument,false,this);b8=b9.firstChild;if(b9.childNodes.length===1){b9=b8}if(b8){cg=cg&&bJ.nodeName(b8,"tr");b6=bJ.map(k(b9,"script"),t);e=b6.length;for(;b7<b5;b7++){b4=b9;if(b7!==ce){b4=bJ.clone(b4,true,true);if(e){bJ.merge(b6,k(b4,"script"))}}cf.call(cg&&bJ.nodeName(this[b7],"table")?x(this[b7],"tbody"):this[b7],b4,b7)
}if(e){cd=b6[b6.length-1].ownerDocument;bJ.map(b6,bc);for(b7=0;b7<e;b7++){b4=b6[b7];if(bz.test(b4.type||"")&&!bJ._data(b4,"globalEval")&&bJ.contains(cd,b4)){if(b4.src){bJ.ajax({url:b4.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})}else{bJ.globalEval((b4.text||b4.textContent||b4.innerHTML||"").replace(aK,""))}}}}b9=b8=null}}return this}});function x(b3,e){return b3.getElementsByTagName(e)[0]||b3.appendChild(b3.ownerDocument.createElement(e))}function t(b3){var e=b3.getAttributeNode("type");
b3.type=(e&&e.specified)+"/"+b3.type;return b3}function bc(b3){var e=ar.exec(b3.type);if(e){b3.type=e[1]}else{b3.removeAttribute("type")}return b3}function bs(e,b4){var b5,b3=0;for(;(b5=e[b3])!=null;b3++){bJ._data(b5,"globalEval",!b4||bJ._data(b4[b3],"globalEval"))}}function at(b9,b3){if(b3.nodeType!==1||!bJ.hasData(b9)){return}var b6,b5,e,b8=bJ._data(b9),b7=bJ._data(b3,b8),b4=b8.events;if(b4){delete b7.handle;b7.events={};for(b6 in b4){for(b5=0,e=b4[b6].length;b5<e;b5++){bJ.event.add(b3,b6,b4[b6][b5])
}}}if(b7.data){b7.data=bJ.extend({},b7.data)}}function Q(b6,b3){var b7,b5,b4;if(b3.nodeType!==1){return}b7=b3.nodeName.toLowerCase();if(!bJ.support.noCloneEvent&&b3[bJ.expando]){b4=bJ._data(b3);for(b5 in b4.events){bJ.removeEvent(b3,b5,b4.handle)}b3.removeAttribute(bJ.expando)}if(b7==="script"&&b3.text!==b6.text){t(b3).text=b6.text;bc(b3)}else{if(b7==="object"){if(b3.parentNode){b3.outerHTML=b6.outerHTML}if(bJ.support.html5Clone&&(b6.innerHTML&&!bJ.trim(b3.innerHTML))){b3.innerHTML=b6.innerHTML}}else{if(b7==="input"&&q.test(b6.type)){b3.defaultChecked=b3.checked=b6.checked;
if(b3.value!==b6.value){b3.value=b6.value}}else{if(b7==="option"){b3.defaultSelected=b3.selected=b6.defaultSelected}else{if(b7==="input"||b7==="textarea"){b3.defaultValue=b6.defaultValue}}}}}}bJ.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,b3){bJ.fn[e]=function(b4){var b5,b7=0,b6=[],b9=bJ(b4),b8=b9.length-1;for(;b7<=b8;b7++){b5=b7===b8?this:this.clone(true);bJ(b9[b7])[b3](b5);ao.apply(b6,b5.get())}return this.pushStack(b6)
}});function k(b5,e){var b3,b6,b4=0,b7=typeof b5.getElementsByTagName!==aC?b5.getElementsByTagName(e||"*"):typeof b5.querySelectorAll!==aC?b5.querySelectorAll(e||"*"):aG;if(!b7){for(b7=[],b3=b5.childNodes||b5;(b6=b3[b4])!=null;b4++){if(!e||bJ.nodeName(b6,e)){b7.push(b6)}else{bJ.merge(b7,k(b6,e))}}}return e===aG||e&&bJ.nodeName(b5,e)?bJ.merge([b5],b7):b7}function bV(e){if(q.test(e.type)){e.defaultChecked=e.checked}}bJ.extend({clone:function(b3,b5,e){var b7,b4,ca,b6,b8,b9=bJ.contains(b3.ownerDocument,b3);
if(bJ.support.html5Clone||bJ.isXMLDoc(b3)||!J.test("<"+b3.nodeName+">")){ca=b3.cloneNode(true)}else{j.innerHTML=b3.outerHTML;j.removeChild(ca=j.firstChild)}if((!bJ.support.noCloneEvent||!bJ.support.noCloneChecked)&&(b3.nodeType===1||b3.nodeType===11)&&!bJ.isXMLDoc(b3)){b7=k(ca);b8=k(b3);for(b6=0;(b4=b8[b6])!=null;++b6){if(b7[b6]){Q(b4,b7[b6])}}}if(b5){if(e){b8=b8||k(b3);b7=b7||k(ca);for(b6=0;(b4=b8[b6])!=null;b6++){at(b4,b7[b6])}}else{at(b3,ca)}}b7=k(ca,"script");if(b7.length>0){bs(b7,!b9&&k(b3,"script"))
}b7=b8=b4=null;return ca},buildFragment:function(b3,b5,ca,cf){var cb,b7,b9,ce,cg,cd,b4,b8=b3.length,b6=A(b5),e=[],cc=0;for(;cc<b8;cc++){b7=b3[cc];if(b7||b7===0){if(bJ.type(b7)==="object"){bJ.merge(e,b7.nodeType?[b7]:b7)}else{if(!I.test(b7)){e.push(b5.createTextNode(b7))}else{ce=ce||b6.appendChild(b5.createElement("div"));cg=(m.exec(b7)||["",""])[1].toLowerCase();b4=T[cg]||T._default;ce.innerHTML=b4[1]+b7.replace(aD,"<$1></$2>")+b4[2];cb=b4[0];while(cb--){ce=ce.lastChild}if(!bJ.support.leadingWhitespace&&b2.test(b7)){e.push(b5.createTextNode(b2.exec(b7)[0]))
}if(!bJ.support.tbody){b7=cg==="table"&&!bX.test(b7)?ce.firstChild:b4[1]==="<table>"&&!bX.test(b7)?ce:0;cb=b7&&b7.childNodes.length;while(cb--){if(bJ.nodeName((cd=b7.childNodes[cb]),"tbody")&&!cd.childNodes.length){b7.removeChild(cd)}}}bJ.merge(e,ce.childNodes);ce.textContent="";while(ce.firstChild){ce.removeChild(ce.firstChild)}ce=b6.lastChild}}}}if(ce){b6.removeChild(ce)}if(!bJ.support.appendChecked){bJ.grep(k(e,"input"),bV)}cc=0;while((b7=e[cc++])){if(cf&&bJ.inArray(b7,cf)!==-1){continue}b9=bJ.contains(b7.ownerDocument,b7);
ce=k(b6.appendChild(b7),"script");if(b9){bs(ce)}if(ca){cb=0;while((b7=ce[cb++])){if(bz.test(b7.type||"")){ca.push(b7)}}}}ce=null;return b6},cleanData:function(b3,cb){var b5,ca,b4,b6,b7=0,cc=bJ.expando,e=bJ.cache,b8=bJ.support.deleteExpando,b9=bJ.event.special;for(;(b5=b3[b7])!=null;b7++){if(cb||bJ.acceptData(b5)){b4=b5[cc];b6=b4&&e[b4];if(b6){if(b6.events){for(ca in b6.events){if(b9[ca]){bJ.event.remove(b5,ca)}else{bJ.removeEvent(b5,ca,b6.handle)}}}if(e[b4]){delete e[b4];if(b8){delete b5[cc]}else{if(typeof b5.removeAttribute!==aC){b5.removeAttribute(cc)
}else{b5[cc]=null}}a6.push(b4)}}}}}});var aE,bo,E,bg=/alpha\([^)]*\)/i,aT=/opacity\s*=\s*([^)]*)/,bn=/^(top|right|bottom|left)$/,F=/^(none|table(?!-c[ea]).+)/,aY=/^margin/,a9=new RegExp("^("+bA+")(.*)$","i"),W=new RegExp("^("+bA+")(?!px)[a-z%]+$","i"),S=new RegExp("^([+-])=("+bA+")","i"),bj={BODY:"block"},bb={position:"absolute",visibility:"hidden",display:"block"},bC={letterSpacing:0,fontWeight:400},bT=["Top","Right","Bottom","Left"],av=["Webkit","O","Moz","ms"];function b(b5,b3){if(b3 in b5){return b3
}var b6=b3.charAt(0).toUpperCase()+b3.slice(1),e=b3,b4=av.length;while(b4--){b3=av[b4]+b6;if(b3 in b5){return b3}}return e}function P(b3,e){b3=e||b3;return bJ.css(b3,"display")==="none"||!bJ.contains(b3.ownerDocument,b3)}function p(b8,e){var b9,b6,b7,b3=[],b4=0,b5=b8.length;for(;b4<b5;b4++){b6=b8[b4];if(!b6.style){continue}b3[b4]=bJ._data(b6,"olddisplay");b9=b6.style.display;if(e){if(!b3[b4]&&b9==="none"){b6.style.display=""}if(b6.style.display===""&&P(b6)){b3[b4]=bJ._data(b6,"olddisplay",bE(b6.nodeName))
}}else{if(!b3[b4]){b7=P(b6);if(b9&&b9!=="none"||!b7){bJ._data(b6,"olddisplay",b7?b9:bJ.css(b6,"display"))}}}}for(b4=0;b4<b5;b4++){b6=b8[b4];if(!b6.style){continue}if(!e||b6.style.display==="none"||b6.style.display===""){b6.style.display=e?b3[b4]||"":"none"}}return b8}bJ.fn.extend({css:function(e,b3){return bJ.access(this,function(b8,b5,b9){var b4,b7,ca={},b6=0;if(bJ.isArray(b5)){b7=bo(b8);b4=b5.length;for(;b6<b4;b6++){ca[b5[b6]]=bJ.css(b8,b5[b6],false,b7)}return ca}return b9!==aG?bJ.style(b8,b5,b9):bJ.css(b8,b5)
},e,b3,arguments.length>1)},show:function(){return p(this,true)},hide:function(){return p(this)},toggle:function(b3){var e=typeof b3==="boolean";return this.each(function(){if(e?b3:P(this)){bJ(this).show()}else{bJ(this).hide()}})}});bJ.extend({cssHooks:{opacity:{get:function(b4,b3){if(b3){var e=E(b4,"opacity");return e===""?"1":e}}}},cssNumber:{"columnCount":true,"fillOpacity":true,"fontWeight":true,"lineHeight":true,"opacity":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":bJ.support.cssFloat?"cssFloat":"styleFloat"},style:function(b5,b4,cb,b6){if(!b5||b5.nodeType===3||b5.nodeType===8||!b5.style){return
}var b9,ca,cc,b7=bJ.camelCase(b4),b3=b5.style;b4=bJ.cssProps[b7]||(bJ.cssProps[b7]=b(b3,b7));cc=bJ.cssHooks[b4]||bJ.cssHooks[b7];if(cb!==aG){ca=typeof cb;if(ca==="string"&&(b9=S.exec(cb))){cb=(b9[1]+1)*b9[2]+parseFloat(bJ.css(b5,b4));ca="number"}if(cb==null||ca==="number"&&isNaN(cb)){return}if(ca==="number"&&!bJ.cssNumber[b7]){cb+="px"}if(!bJ.support.clearCloneStyle&&cb===""&&b4.indexOf("background")===0){b3[b4]="inherit"}if(!cc||!("set" in cc)||(cb=cc.set(b5,cb,b6))!==aG){try{b3[b4]=cb}catch(b8){}}}else{if(cc&&"get" in cc&&(b9=cc.get(b5,false,b6))!==aG){return b9
}return b3[b4]}},css:function(b8,b6,b3,b7){var b5,b9,e,b4=bJ.camelCase(b6);b6=bJ.cssProps[b4]||(bJ.cssProps[b4]=b(b8.style,b4));e=bJ.cssHooks[b6]||bJ.cssHooks[b4];if(e&&"get" in e){b9=e.get(b8,true,b3)}if(b9===aG){b9=E(b8,b6,b7)}if(b9==="normal"&&b6 in bC){b9=bC[b6]}if(b3===""||b3){b5=parseFloat(b9);return b3===true||bJ.isNumeric(b5)?b5||0:b9}return b9},swap:function(b7,b6,b8,b5){var b4,b3,e={};for(b3 in b6){e[b3]=b7.style[b3];b7.style[b3]=b6[b3]}b4=b8.apply(b7,b5||[]);for(b3 in b6){b7.style[b3]=e[b3]
}return b4}});if(a2.getComputedStyle){bo=function(e){return a2.getComputedStyle(e,null)};E=function(b6,b4,b8){var b5,b3,ca,b7=b8||bo(b6),b9=b7?b7.getPropertyValue(b4)||b7[b4]:aG,e=b6.style;if(b7){if(b9===""&&!bJ.contains(b6.ownerDocument,b6)){b9=bJ.style(b6,b4)}if(W.test(b9)&&aY.test(b4)){b5=e.width;b3=e.minWidth;ca=e.maxWidth;e.minWidth=e.maxWidth=e.width=b9;b9=b7.width;e.width=b5;e.minWidth=b3;e.maxWidth=ca}}return b9}}else{if(l.documentElement.currentStyle){bo=function(e){return e.currentStyle
};E=function(b5,b3,b8){var b4,b7,b9,b6=b8||bo(b5),ca=b6?b6[b3]:aG,e=b5.style;if(ca==null&&e&&e[b3]){ca=e[b3]}if(W.test(ca)&&!bn.test(b3)){b4=e.left;b7=b5.runtimeStyle;b9=b7&&b7.left;if(b9){b7.left=b5.currentStyle.left}e.left=b3==="fontSize"?"1em":ca;ca=e.pixelLeft+"px";e.left=b4;if(b9){b7.left=b9}}return ca===""?"auto":ca}}}function aJ(e,b4,b5){var b3=a9.exec(b4);return b3?Math.max(0,b3[1]-(b5||0))+(b3[2]||"px"):b4}function aw(b6,b3,e,b8,b5){var b4=e===(b8?"border":"content")?4:b3==="width"?1:0,b7=0;
for(;b4<4;b4+=2){if(e==="margin"){b7+=bJ.css(b6,e+bT[b4],true,b5)}if(b8){if(e==="content"){b7-=bJ.css(b6,"padding"+bT[b4],true,b5)}if(e!=="margin"){b7-=bJ.css(b6,"border"+bT[b4]+"Width",true,b5)}}else{b7+=bJ.css(b6,"padding"+bT[b4],true,b5);if(e!=="padding"){b7+=bJ.css(b6,"border"+bT[b4]+"Width",true,b5)}}}return b7}function u(b6,b3,e){var b5=true,b7=b3==="width"?b6.offsetWidth:b6.offsetHeight,b4=bo(b6),b8=bJ.support.boxSizing&&bJ.css(b6,"boxSizing",false,b4)==="border-box";if(b7<=0||b7==null){b7=E(b6,b3,b4);
if(b7<0||b7==null){b7=b6.style[b3]}if(W.test(b7)){return b7}b5=b8&&(bJ.support.boxSizingReliable||b7===b6.style[b3]);b7=parseFloat(b7)||0}return(b7+aw(b6,b3,e||(b8?"border":"content"),b5,b4))+"px"}function bE(b4){var b3=l,e=bj[b4];if(!e){e=a1(b4,b3);if(e==="none"||!e){aE=(aE||bJ("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b3.documentElement);b3=(aE[0].contentWindow||aE[0].contentDocument).document;b3.write("<!doctype html><html><body>");b3.close();
e=a1(b4,b3);aE.detach()}bj[b4]=e}return e}function a1(e,b5){var b3=bJ(b5.createElement(e)).appendTo(b5.body),b4=bJ.css(b3[0],"display");b3.remove();return b4}bJ.each(["height","width"],function(b3,e){bJ.cssHooks[e]={get:function(b6,b5,b4){if(b5){return b6.offsetWidth===0&&F.test(bJ.css(b6,"display"))?bJ.swap(b6,bb,function(){return u(b6,e,b4)}):u(b6,e,b4)}},set:function(b6,b7,b4){var b5=b4&&bo(b6);return aJ(b6,b7,b4?aw(b6,e,b4,bJ.support.boxSizing&&bJ.css(b6,"boxSizing",false,b5)==="border-box",b5):0)
}}});if(!bJ.support.opacity){bJ.cssHooks.opacity={get:function(b3,e){return aT.test((e&&b3.currentStyle?b3.currentStyle.filter:b3.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":e?"1":""},set:function(b6,b7){var b5=b6.style,b3=b6.currentStyle,e=bJ.isNumeric(b7)?"alpha(opacity="+b7*100+")":"",b4=b3&&b3.filter||b5.filter||"";b5.zoom=1;if((b7>=1||b7==="")&&bJ.trim(b4.replace(bg,""))===""&&b5.removeAttribute){b5.removeAttribute("filter");if(b7===""||b3&&!b3.filter){return}}b5.filter=bg.test(b4)?b4.replace(bg,e):b4+" "+e
}}}bJ(function(){if(!bJ.support.reliableMarginRight){bJ.cssHooks.marginRight={get:function(b3,e){if(e){return bJ.swap(b3,{"display":"inline-block"},E,[b3,"marginRight"])}}}}if(!bJ.support.pixelPosition&&bJ.fn.position){bJ.each(["top","left"],function(e,b3){bJ.cssHooks[b3]={get:function(b5,b4){if(b4){b4=E(b5,b3);return W.test(b4)?bJ(b5).position()[b3]+"px":b4}}}})}});if(bJ.expr&&bJ.expr.filters){bJ.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||(!bJ.support.reliableHiddenOffsets&&((e.style&&e.style.display)||bJ.css(e,"display"))==="none")
};bJ.expr.filters.visible=function(e){return !bJ.expr.filters.hidden(e)}}bJ.each({margin:"",padding:"",border:"Width"},function(e,b3){bJ.cssHooks[e+b3]={expand:function(b6){var b5=0,b4={},b7=typeof b6==="string"?b6.split(" "):[b6];for(;b5<4;b5++){b4[e+bT[b5]+b3]=b7[b5]||b7[b5-2]||b7[0]}return b4}};if(!aY.test(e)){bJ.cssHooks[e+b3].set=aJ}});var bv=/%20/g,aR=/\[\]$/,U=/\r?\n/g,c=/^(?:submit|button|image|reset|file)$/i,au=/^(?:input|select|textarea|keygen)/i;bJ.fn.extend({serialize:function(){return bJ.param(this.serializeArray())
},serializeArray:function(){return this.map(function(){var e=bJ.prop(this,"elements");return e?bJ.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!bJ(this).is(":disabled")&&au.test(this.nodeName)&&!c.test(e)&&(this.checked||!q.test(e))}).map(function(e,b3){var b4=bJ(this).val();return b4==null?null:bJ.isArray(b4)?bJ.map(b4,function(b5){return{name:b3.name,value:b5.replace(U,"\r\n")}}):{name:b3.name,value:b4.replace(U,"\r\n")}}).get()}});bJ.param=function(e,b4){var b5,b3=[],b6=function(b7,b8){b8=bJ.isFunction(b8)?b8():(b8==null?"":b8);
b3[b3.length]=encodeURIComponent(b7)+"="+encodeURIComponent(b8)};if(b4===aG){b4=bJ.ajaxSettings&&bJ.ajaxSettings.traditional}if(bJ.isArray(e)||(e.jquery&&!bJ.isPlainObject(e))){bJ.each(e,function(){b6(this.name,this.value)})}else{for(b5 in e){i(b5,e[b5],b4,b6)}}return b3.join("&").replace(bv,"+")};function i(b4,b6,b3,b5){var e;if(bJ.isArray(b6)){bJ.each(b6,function(b8,b7){if(b3||aR.test(b4)){b5(b4,b7)}else{i(b4+"["+(typeof b7==="object"?b8:"")+"]",b7,b3,b5)}})}else{if(!b3&&bJ.type(b6)==="object"){for(e in b6){i(b4+"["+e+"]",b6[e],b3,b5)
}}else{b5(b4,b6)}}}bJ.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(b3,e){bJ.fn[e]=function(b5,b4){return arguments.length>0?this.on(e,null,b5,b4):this.trigger(e)}});bJ.fn.hover=function(e,b3){return this.mouseenter(e).mouseleave(b3||e)};var b1,Y,bO=bJ.now(),az=/\?/,ap=/#.*$/,O=/([?&])_=[^&]*/,ag=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,B=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,o=/^(?:GET|HEAD)$/,aH=/^\/\//,aU=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,b0=bJ.fn.load,v={},a7={},aW="*/".concat("*");
try{Y=aL.href}catch(bf){Y=l.createElement("a");Y.href="";Y=Y.href}b1=aU.exec(Y.toLowerCase())||[];function bL(e){return function(b6,b7){if(typeof b6!=="string"){b7=b6;b6="*"}var b3,b4=0,b5=b6.toLowerCase().match(ac)||[];if(bJ.isFunction(b7)){while((b3=b5[b4++])){if(b3[0]==="+"){b3=b3.slice(1)||"*";(e[b3]=e[b3]||[]).unshift(b7)}else{(e[b3]=e[b3]||[]).push(b7)}}}}}function n(e,b4,b8,b5){var b3={},b6=(e===a7);function b7(b9){var ca;b3[b9]=true;bJ.each(e[b9]||[],function(cc,cb){var cd=cb(b4,b8,b5);if(typeof cd==="string"&&!b6&&!b3[cd]){b4.dataTypes.unshift(cd);
b7(cd);return false}else{if(b6){return !(ca=cd)}}});return ca}return b7(b4.dataTypes[0])||!b3["*"]&&b7("*")}function r(b4,b5){var e,b3,b6=bJ.ajaxSettings.flatOptions||{};for(b3 in b5){if(b5[b3]!==aG){(b6[b3]?b4:(e||(e={})))[b3]=b5[b3]}}if(e){bJ.extend(true,b4,e)}return b4}bJ.fn.load=function(b5,b8,b9){if(typeof b5!=="string"&&b0){return b0.apply(this,arguments)}var e,b4,b6,b3=this,b7=b5.indexOf(" ");if(b7>=0){e=b5.slice(b7,b5.length);b5=b5.slice(0,b7)}if(bJ.isFunction(b8)){b9=b8;b8=aG}else{if(b8&&typeof b8==="object"){b6="POST"
}}if(b3.length>0){bJ.ajax({url:b5,type:b6,dataType:"html",data:b8}).done(function(ca){b4=arguments;b3.html(e?bJ("<div>").append(bJ.parseHTML(ca)).find(e):ca)}).complete(b9&&function(cb,ca){b3.each(b9,b4||[cb.responseText,ca,cb])})}return this};bJ.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,b3){bJ.fn[b3]=function(b4){return this.on(b3,b4)}});bJ.each(["get","post"],function(e,b3){bJ[b3]=function(b4,b6,b7,b5){if(bJ.isFunction(b6)){b5=b5||b7;b7=b6;b6=aG
}return bJ.ajax({url:b4,type:b3,dataType:b5,data:b6,success:b7})}});bJ.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Y,type:"GET",isLocal:B.test(b1[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":aW,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a2.String,"text html":true,"text json":bJ.parseJSON,"text xml":bJ.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(b3,e){return e?r(r(b3,bJ.ajaxSettings),e):r(bJ.ajaxSettings,b3)
},ajaxPrefilter:bL(v),ajaxTransport:bL(a7),ajax:function(b7,b4){if(typeof b7==="object"){b4=b7;b7=aG}b4=b4||{};var cg,ci,b8,cn,cc,b3,cj,b5,cb=bJ.ajaxSetup({},b4),cp=cb.context||cb,ce=cb.context&&(cp.nodeType||cp.jquery)?bJ(cp):bJ.event,co=bJ.Deferred(),cl=bJ.Callbacks("once memory"),b9=cb.statusCode||{},cf={},cm={},b6=0,ca="canceled",ch={readyState:0,getResponseHeader:function(cq){var e;if(b6===2){if(!b5){b5={};while((e=ag.exec(cn))){b5[e[1].toLowerCase()]=e[2]}}e=b5[cq.toLowerCase()]}return e==null?null:e
},getAllResponseHeaders:function(){return b6===2?cn:null},setRequestHeader:function(cq,cr){var e=cq.toLowerCase();if(!b6){cq=cm[e]=cm[e]||cq;cf[cq]=cr}return this},overrideMimeType:function(e){if(!b6){cb.mimeType=e}return this},statusCode:function(cq){var e;if(cq){if(b6<2){for(e in cq){b9[e]=[b9[e],cq[e]]}}else{ch.always(cq[ch.status])}}return this},abort:function(cq){var e=cq||ca;if(cj){cj.abort(e)}cd(0,e);return this}};co.promise(ch).complete=cl.add;ch.success=ch.done;ch.error=ch.fail;cb.url=((b7||cb.url||Y)+"").replace(ap,"").replace(aH,b1[1]+"//");
cb.type=b4.method||b4.type||cb.method||cb.type;cb.dataTypes=bJ.trim(cb.dataType||"*").toLowerCase().match(ac)||[""];if(cb.crossDomain==null){cg=aU.exec(cb.url.toLowerCase());cb.crossDomain=!!(cg&&(cg[1]!==b1[1]||cg[2]!==b1[2]||(cg[3]||(cg[1]==="http:"?80:443))!=(b1[3]||(b1[1]==="http:"?80:443))))}if(cb.data&&cb.processData&&typeof cb.data!=="string"){cb.data=bJ.param(cb.data,cb.traditional)}n(v,cb,b4,ch);if(b6===2){return ch}b3=cb.global;if(b3&&bJ.active++===0){bJ.event.trigger("ajaxStart")}cb.type=cb.type.toUpperCase();
cb.hasContent=!o.test(cb.type);b8=cb.url;if(!cb.hasContent){if(cb.data){b8=(cb.url+=(az.test(b8)?"&":"?")+cb.data);delete cb.data}if(cb.cache===false){cb.url=O.test(b8)?b8.replace(O,"$1_="+bO++):b8+(az.test(b8)?"&":"?")+"_="+bO++}}if(cb.ifModified){if(bJ.lastModified[b8]){ch.setRequestHeader("If-Modified-Since",bJ.lastModified[b8])}if(bJ.etag[b8]){ch.setRequestHeader("If-None-Match",bJ.etag[b8])}}if(cb.data&&cb.hasContent&&cb.contentType!==false||b4.contentType){ch.setRequestHeader("Content-Type",cb.contentType)
}ch.setRequestHeader("Accept",cb.dataTypes[0]&&cb.accepts[cb.dataTypes[0]]?cb.accepts[cb.dataTypes[0]]+(cb.dataTypes[0]!=="*"?", "+aW+"; q=0.01":""):cb.accepts["*"]);for(ci in cb.headers){ch.setRequestHeader(ci,cb.headers[ci])}if(cb.beforeSend&&(cb.beforeSend.call(cp,ch,cb)===false||b6===2)){return ch.abort()}ca="abort";for(ci in {success:1,error:1,complete:1}){ch[ci](cb[ci])}cj=n(a7,cb,b4,ch);if(!cj){cd(-1,"No Transport")}else{ch.readyState=1;if(b3){ce.trigger("ajaxSend",[ch,cb])}if(cb.async&&cb.timeout>0){cc=setTimeout(function(){ch.abort("timeout")
},cb.timeout)}try{b6=1;cj.send(cf,cd)}catch(ck){if(b6<2){cd(-1,ck)}else{throw ck}}}function cd(cu,cq,cv,cs){var e,cy,cw,ct,cx,cr=cq;if(b6===2){return}b6=2;if(cc){clearTimeout(cc)}cj=aG;cn=cs||"";ch.readyState=cu>0?4:0;if(cv){ct=g(cb,ch,cv)}if(cu>=200&&cu<300||cu===304){if(cb.ifModified){cx=ch.getResponseHeader("Last-Modified");if(cx){bJ.lastModified[b8]=cx}cx=ch.getResponseHeader("etag");if(cx){bJ.etag[b8]=cx}}if(cu===204){e=true;cr="nocontent"}else{if(cu===304){e=true;cr="notmodified"}else{e=af(cb,ct);
cr=e.state;cy=e.data;cw=e.error;e=!cw}}}else{cw=cr;if(cu||!cr){cr="error";if(cu<0){cu=0}}}ch.status=cu;ch.statusText=(cq||cr)+"";if(e){co.resolveWith(cp,[cy,cr,ch])}else{co.rejectWith(cp,[ch,cr,cw])}ch.statusCode(b9);b9=aG;if(b3){ce.trigger(e?"ajaxSuccess":"ajaxError",[ch,cb,e?cy:cw])}cl.fireWith(cp,[ch,cr]);if(b3){ce.trigger("ajaxComplete",[ch,cb]);if(!(--bJ.active)){bJ.event.trigger("ajaxStop")}}}return ch},getScript:function(e,b3){return bJ.get(e,aG,b3,"script")},getJSON:function(e,b3,b4){return bJ.get(e,b3,b4,"json")
}});function g(cb,ca,b7){var e,b6,b5,b8,b3=cb.contents,b9=cb.dataTypes,b4=cb.responseFields;for(b8 in b4){if(b8 in b7){ca[b4[b8]]=b7[b8]}}while(b9[0]==="*"){b9.shift();if(b6===aG){b6=cb.mimeType||ca.getResponseHeader("Content-Type")}}if(b6){for(b8 in b3){if(b3[b8]&&b3[b8].test(b6)){b9.unshift(b8);break}}}if(b9[0] in b7){b5=b9[0]}else{for(b8 in b7){if(!b9[0]||cb.converters[b8+" "+b9[0]]){b5=b8;break}if(!e){e=b8}}b5=b5||e}if(b5){if(b5!==b9[0]){b9.unshift(b5)}return b7[b5]}}function af(cd,b5){var b3,b9,cb,b6,cc={},b7=0,ca=cd.dataTypes.slice(),b4=ca[0];
if(cd.dataFilter){b5=cd.dataFilter(b5,cd.dataType)}if(ca[1]){for(cb in cd.converters){cc[cb.toLowerCase()]=cd.converters[cb]}}for(;(b9=ca[++b7]);){if(b9!=="*"){if(b4!=="*"&&b4!==b9){cb=cc[b4+" "+b9]||cc["* "+b9];if(!cb){for(b3 in cc){b6=b3.split(" ");if(b6[1]===b9){cb=cc[b4+" "+b6[0]]||cc["* "+b6[0]];if(cb){if(cb===true){cb=cc[b3]}else{if(cc[b3]!==true){b9=b6[0];ca.splice(b7--,0,b9)}}break}}}}if(cb!==true){if(cb&&cd["throws"]){b5=cb(b5)}else{try{b5=cb(b5)}catch(b8){return{state:"parsererror",error:cb?b8:"No conversion from "+b4+" to "+b9}
}}}}b4=b9}}return{state:"success",data:b5}}bJ.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){bJ.globalEval(e);return e}}});bJ.ajaxPrefilter("script",function(e){if(e.cache===aG){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});bJ.ajaxTransport("script",function(b4){if(b4.crossDomain){var e,b3=l.head||bJ("head")[0]||l.documentElement;return{send:function(b5,b6){e=l.createElement("script");
e.async=true;if(b4.scriptCharset){e.charset=b4.scriptCharset}e.src=b4.url;e.onload=e.onreadystatechange=function(b8,b7){if(b7||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(e.parentNode){e.parentNode.removeChild(e)}e=null;if(!b7){b6(200,"success")}}};b3.insertBefore(e,b3.firstChild)},abort:function(){if(e){e.onload(aG,true)}}}}});var bq=[],a5=/(=)\?(?=&|$)|\?\?/;bJ.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=bq.pop()||(bJ.expando+"_"+(bO++));
this[e]=true;return e}});bJ.ajaxPrefilter("json jsonp",function(b5,e,b6){var b8,b3,b4,b7=b5.jsonp!==false&&(a5.test(b5.url)?"url":typeof b5.data==="string"&&!(b5.contentType||"").indexOf("application/x-www-form-urlencoded")&&a5.test(b5.data)&&"data");if(b7||b5.dataTypes[0]==="jsonp"){b8=b5.jsonpCallback=bJ.isFunction(b5.jsonpCallback)?b5.jsonpCallback():b5.jsonpCallback;if(b7){b5[b7]=b5[b7].replace(a5,"$1"+b8)}else{if(b5.jsonp!==false){b5.url+=(az.test(b5.url)?"&":"?")+b5.jsonp+"="+b8}}b5.converters["script json"]=function(){if(!b4){bJ.error(b8+" was not called")
}return b4[0]};b5.dataTypes[0]="json";b3=a2[b8];a2[b8]=function(){b4=arguments};b6.always(function(){a2[b8]=b3;if(b5[b8]){b5.jsonpCallback=e.jsonpCallback;bq.push(b8)}if(b4&&bJ.isFunction(b3)){b3(b4[0])}b4=b3=aG});return"script"}});var ah,ax,ay=0,aP=a2.ActiveXObject&&function(){var e;for(e in ah){ah[e](aG,true)}};function bD(){try{return new a2.XMLHttpRequest()}catch(b3){}}function bd(){try{return new a2.ActiveXObject("Microsoft.XMLHTTP")}catch(b3){}}bJ.ajaxSettings.xhr=a2.ActiveXObject?function(){return !this.isLocal&&bD()||bd()
}:bD;ax=bJ.ajaxSettings.xhr();bJ.support.cors=!!ax&&("withCredentials" in ax);ax=bJ.support.ajax=!!ax;if(ax){bJ.ajaxTransport(function(e){if(!e.crossDomain||bJ.support.cors){var b3;return{send:function(b9,b4){var b7,b5,b8=e.xhr();if(e.username){b8.open(e.type,e.url,e.async,e.username,e.password)}else{b8.open(e.type,e.url,e.async)}if(e.xhrFields){for(b5 in e.xhrFields){b8[b5]=e.xhrFields[b5]}}if(e.mimeType&&b8.overrideMimeType){b8.overrideMimeType(e.mimeType)}if(!e.crossDomain&&!b9["X-Requested-With"]){b9["X-Requested-With"]="XMLHttpRequest"
}try{for(b5 in b9){b8.setRequestHeader(b5,b9[b5])}}catch(b6){}b8.send((e.hasContent&&e.data)||null);b3=function(cc,cb){var ca,cd,cg,ce;try{if(b3&&(cb||b8.readyState===4)){b3=aG;if(b7){b8.onreadystatechange=bJ.noop;if(aP){delete ah[b7]}}if(cb){if(b8.readyState!==4){b8.abort()}}else{ce={};ca=b8.status;cd=b8.getAllResponseHeaders();if(typeof b8.responseText==="string"){ce.text=b8.responseText}try{cg=b8.statusText}catch(cf){cg=""}if(!ca&&e.isLocal&&!e.crossDomain){ca=ce.text?200:404}else{if(ca===1223){ca=204
}}}}}catch(ch){if(!cb){b4(-1,ch)}}if(ce){b4(ca,cg,ce,cd)}};if(!e.async){b3()}else{if(b8.readyState===4){setTimeout(b3)}else{b7=++ay;if(aP){if(!ah){ah={};bJ(a2).unload(aP)}ah[b7]=b3}b8.onreadystatechange=b3}}},abort:function(){if(b3){b3(aG,true)}}}}})}var K,ad,bR=/^(?:toggle|show|hide)$/,bK=new RegExp("^(?:([+-])=|)("+bA+")([a-z%]*)$","i"),bQ=/queueHooks$/,aB=[h],a0={"*":[function(e,b9){var b5,ca,cb=this.createTween(e,b9),b6=bK.exec(b9),b7=cb.cur(),b3=+b7||0,b4=1,b8=20;if(b6){b5=+b6[2];ca=b6[3]||(bJ.cssNumber[e]?"":"px");
if(ca!=="px"&&b3){b3=bJ.css(cb.elem,e,true)||b5||1;do{b4=b4||".5";b3=b3/b4;bJ.style(cb.elem,e,b3+ca)}while(b4!==(b4=cb.cur()/b7)&&b4!==1&&--b8)}cb.unit=ca;cb.start=b3;cb.end=b6[1]?b3+(b6[1]+1)*b5:b5}return cb}]};function bm(){setTimeout(function(){K=aG});return(K=bJ.now())}function be(b3,e){bJ.each(e,function(b8,b6){var b7=(a0[b8]||[]).concat(a0["*"]),b4=0,b5=b7.length;for(;b4<b5;b4++){if(b7[b4].call(b3,b8,b6)){return}}})}function f(b4,b8,cb){var cc,e,b7=0,b3=aB.length,ca=bJ.Deferred().always(function(){delete b6.elem
}),b6=function(){if(e){return false}var ci=K||bm(),cf=Math.max(0,b5.startTime+b5.duration-ci),cd=cf/b5.duration||0,ch=1-cd,ce=0,cg=b5.tweens.length;for(;ce<cg;ce++){b5.tweens[ce].run(ch)}ca.notifyWith(b4,[b5,ch,cf]);if(ch<1&&cg){return cf}else{ca.resolveWith(b4,[b5]);return false}},b5=ca.promise({elem:b4,props:bJ.extend({},b8),opts:bJ.extend(true,{specialEasing:{}},cb),originalProperties:b8,originalOptions:cb,startTime:K||bm(),duration:cb.duration,tweens:[],createTween:function(cf,cd){var ce=bJ.Tween(b4,b5.opts,cf,cd,b5.opts.specialEasing[cf]||b5.opts.easing);
b5.tweens.push(ce);return ce},stop:function(ce){var cd=0,cf=ce?b5.tweens.length:0;if(e){return this}e=true;for(;cd<cf;cd++){b5.tweens[cd].run(1)}if(ce){ca.resolveWith(b4,[b5,ce])}else{ca.rejectWith(b4,[b5,ce])}return this}}),b9=b5.props;am(b9,b5.opts.specialEasing);for(;b7<b3;b7++){cc=aB[b7].call(b5,b4,b9,b5.opts);if(cc){return cc}}be(b5,b9);if(bJ.isFunction(b5.opts.start)){b5.opts.start.call(b4,b5)}bJ.fx.timer(bJ.extend(b6,{elem:b4,anim:b5,queue:b5.opts.queue}));return b5.progress(b5.opts.progress).done(b5.opts.done,b5.opts.complete).fail(b5.opts.fail).always(b5.opts.always)
}function am(b5,b7){var b6,b4,b3,b8,e;for(b3 in b5){b4=bJ.camelCase(b3);b8=b7[b4];b6=b5[b3];if(bJ.isArray(b6)){b8=b6[1];b6=b5[b3]=b6[0]}if(b3!==b4){b5[b4]=b6;delete b5[b3]}e=bJ.cssHooks[b4];if(e&&"expand" in e){b6=e.expand(b6);delete b5[b4];for(b3 in b6){if(!(b3 in b5)){b5[b3]=b6[b3];b7[b3]=b8}}}else{b7[b4]=b8}}}bJ.Animation=bJ.extend(f,{tweener:function(b3,b6){if(bJ.isFunction(b3)){b6=b3;b3=["*"]}else{b3=b3.split(" ")}var b5,e=0,b4=b3.length;for(;e<b4;e++){b5=b3[e];a0[b5]=a0[b5]||[];a0[b5].unshift(b6)
}},prefilter:function(b3,e){if(e){aB.unshift(b3)}else{aB.push(b3)}}});function h(b6,cc,e){var b4,cb,b5,ce,ci,b8,ch,cg,cf,b7=this,b3=b6.style,cd={},ca=[],b9=b6.nodeType&&P(b6);if(!e.queue){cg=bJ._queueHooks(b6,"fx");if(cg.unqueued==null){cg.unqueued=0;cf=cg.empty.fire;cg.empty.fire=function(){if(!cg.unqueued){cf()}}}cg.unqueued++;b7.always(function(){b7.always(function(){cg.unqueued--;if(!bJ.queue(b6,"fx").length){cg.empty.fire()}})})}if(b6.nodeType===1&&("height" in cc||"width" in cc)){e.overflow=[b3.overflow,b3.overflowX,b3.overflowY];
if(bJ.css(b6,"display")==="inline"&&bJ.css(b6,"float")==="none"){if(!bJ.support.inlineBlockNeedsLayout||bE(b6.nodeName)==="inline"){b3.display="inline-block"}else{b3.zoom=1}}}if(e.overflow){b3.overflow="hidden";if(!bJ.support.shrinkWrapBlocks){b7.always(function(){b3.overflow=e.overflow[0];b3.overflowX=e.overflow[1];b3.overflowY=e.overflow[2]})}}for(cb in cc){ce=cc[cb];if(bR.exec(ce)){delete cc[cb];b8=b8||ce==="toggle";if(ce===(b9?"hide":"show")){continue}ca.push(cb)}}b5=ca.length;if(b5){ci=bJ._data(b6,"fxshow")||bJ._data(b6,"fxshow",{});
if("hidden" in ci){b9=ci.hidden}if(b8){ci.hidden=!b9}if(b9){bJ(b6).show()}else{b7.done(function(){bJ(b6).hide()})}b7.done(function(){var cj;bJ._removeData(b6,"fxshow");for(cj in cd){bJ.style(b6,cj,cd[cj])}});for(cb=0;cb<b5;cb++){b4=ca[cb];ch=b7.createTween(b4,b9?ci[b4]:0);cd[b4]=ci[b4]||bJ.style(b6,b4);if(!(b4 in ci)){ci[b4]=ch.start;if(b9){ch.end=ch.start;ch.start=b4==="width"||b4==="height"?1:0}}}}}function G(b4,b3,b6,e,b5){return new G.prototype.init(b4,b3,b6,e,b5)}bJ.Tween=G;G.prototype={constructor:G,init:function(b5,b3,b7,e,b6,b4){this.elem=b5;
this.prop=b7;this.easing=b6||"swing";this.options=b3;this.start=this.now=this.cur();this.end=e;this.unit=b4||(bJ.cssNumber[b7]?"":"px")},cur:function(){var e=G.propHooks[this.prop];return e&&e.get?e.get(this):G.propHooks._default.get(this)},run:function(b4){var b3,e=G.propHooks[this.prop];if(this.options.duration){this.pos=b3=bJ.easing[this.easing](b4,this.options.duration*b4,0,1,this.options.duration)}else{this.pos=b3=b4}this.now=(this.end-this.start)*b3+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)
}if(e&&e.set){e.set(this)}else{G.propHooks._default.set(this)}return this}};G.prototype.init.prototype=G.prototype;G.propHooks={_default:{get:function(b3){var e;if(b3.elem[b3.prop]!=null&&(!b3.elem.style||b3.elem.style[b3.prop]==null)){return b3.elem[b3.prop]}e=bJ.css(b3.elem,b3.prop,"");return !e||e==="auto"?0:e},set:function(e){if(bJ.fx.step[e.prop]){bJ.fx.step[e.prop](e)}else{if(e.elem.style&&(e.elem.style[bJ.cssProps[e.prop]]!=null||bJ.cssHooks[e.prop])){bJ.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now
}}}}};G.propHooks.scrollTop=G.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};bJ.each(["toggle","show","hide"],function(b3,e){var b4=bJ.fn[e];bJ.fn[e]=function(b5,b7,b6){return b5==null||typeof b5==="boolean"?b4.apply(this,arguments):this.animate(bI(e,true),b5,b7,b6)}});bJ.fn.extend({fadeTo:function(e,b5,b4,b3){return this.filter(P).css("opacity",0).show().end().animate({opacity:b5},e,b4,b3)},animate:function(b8,b5,b7,b6){var b4=bJ.isEmptyObject(b8),e=bJ.speed(b5,b7,b6),b3=function(){var b9=f(this,bJ.extend({},b8),e);
b3.finish=function(){b9.stop(true)};if(b4||bJ._data(this,"finish")){b9.stop(true)}};b3.finish=b3;return b4||e.queue===false?this.each(b3):this.queue(e.queue,b3)},stop:function(b4,b3,e){var b5=function(b6){var b7=b6.stop;delete b6.stop;b7(e)};if(typeof b4!=="string"){e=b3;b3=b4;b4=aG}if(b3&&b4!==false){this.queue(b4||"fx",[])}return this.each(function(){var b9=true,b6=b4!=null&&b4+"queueHooks",b8=bJ.timers,b7=bJ._data(this);if(b6){if(b7[b6]&&b7[b6].stop){b5(b7[b6])}}else{for(b6 in b7){if(b7[b6]&&b7[b6].stop&&bQ.test(b6)){b5(b7[b6])
}}}for(b6=b8.length;b6--;){if(b8[b6].elem===this&&(b4==null||b8[b6].queue===b4)){b8[b6].anim.stop(e);b9=false;b8.splice(b6,1)}}if(b9||!e){bJ.dequeue(this,b4)}})},finish:function(e){if(e!==false){e=e||"fx"}return this.each(function(){var b5,b8=bJ._data(this),b4=b8[e+"queue"],b3=b8[e+"queueHooks"],b7=bJ.timers,b6=b4?b4.length:0;b8.finish=true;bJ.queue(this,e,[]);if(b3&&b3.cur&&b3.cur.finish){b3.cur.finish.call(this)}for(b5=b7.length;b5--;){if(b7[b5].elem===this&&b7[b5].queue===e){b7[b5].anim.stop(true);
b7.splice(b5,1)}}for(b5=0;b5<b6;b5++){if(b4[b5]&&b4[b5].finish){b4[b5].finish.call(this)}}delete b8.finish})}});function bI(b4,b6){var b5,e={height:b4},b3=0;b6=b6?1:0;for(;b3<4;b3+=2-b6){b5=bT[b3];e["margin"+b5]=e["padding"+b5]=b4}if(b6){e.opacity=e.width=b4}return e}bJ.each({slideDown:bI("show"),slideUp:bI("hide"),slideToggle:bI("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,b3){bJ.fn[e]=function(b4,b6,b5){return this.animate(b3,b4,b6,b5)}});
bJ.speed=function(b4,b5,b3){var e=b4&&typeof b4==="object"?bJ.extend({},b4):{complete:b3||!b3&&b5||bJ.isFunction(b4)&&b4,duration:b4,easing:b3&&b5||b5&&!bJ.isFunction(b5)&&b5};e.duration=bJ.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in bJ.fx.speeds?bJ.fx.speeds[e.duration]:bJ.fx.speeds._default;if(e.queue==null||e.queue===true){e.queue="fx"}e.old=e.complete;e.complete=function(){if(bJ.isFunction(e.old)){e.old.call(this)}if(e.queue){bJ.dequeue(this,e.queue)}};return e};bJ.easing={linear:function(e){return e
},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}};bJ.timers=[];bJ.fx=G.prototype.init;bJ.fx.tick=function(){var b4,b3=bJ.timers,e=0;K=bJ.now();for(;e<b3.length;e++){b4=b3[e];if(!b4()&&b3[e]===b4){b3.splice(e--,1)}}if(!b3.length){bJ.fx.stop()}K=aG};bJ.fx.timer=function(e){if(e()&&bJ.timers.push(e)){bJ.fx.start()}};bJ.fx.interval=13;bJ.fx.start=function(){if(!ad){ad=setInterval(bJ.fx.tick,bJ.fx.interval)}};bJ.fx.stop=function(){clearInterval(ad);ad=null};bJ.fx.speeds={slow:600,fast:200,_default:400};
bJ.fx.step={};if(bJ.expr&&bJ.expr.filters){bJ.expr.filters.animated=function(e){return bJ.grep(bJ.timers,function(b3){return e===b3.elem}).length}}bJ.fn.offset=function(b3){if(arguments.length){return b3===aG?this:this.each(function(b8){bJ.offset.setOffset(this,b3,b8)})}var e,b7,b5={top:0,left:0},b4=this[0],b6=b4&&b4.ownerDocument;if(!b6){return}e=b6.documentElement;if(!bJ.contains(e,b4)){return b5}if(typeof b4.getBoundingClientRect!==aC){b5=b4.getBoundingClientRect()}b7=bp(b6);return{top:b5.top+(b7.pageYOffset||e.scrollTop)-(e.clientTop||0),left:b5.left+(b7.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}
};bJ.offset={setOffset:function(b5,ce,b8){var b9=bJ.css(b5,"position");if(b9==="static"){b5.style.position="relative"}var b7=bJ(b5),b3=b7.offset(),e=bJ.css(b5,"top"),cc=bJ.css(b5,"left"),cd=(b9==="absolute"||b9==="fixed")&&bJ.inArray("auto",[e,cc])>-1,cb={},ca={},b4,b6;if(cd){ca=b7.position();b4=ca.top;b6=ca.left}else{b4=parseFloat(e)||0;b6=parseFloat(cc)||0}if(bJ.isFunction(ce)){ce=ce.call(b5,b8,b3)}if(ce.top!=null){cb.top=(ce.top-b3.top)+b4}if(ce.left!=null){cb.left=(ce.left-b3.left)+b6}if("using" in ce){ce.using.call(b5,cb)
}else{b7.css(cb)}}};bJ.fn.extend({position:function(){if(!this[0]){return}var b4,b5,e={top:0,left:0},b3=this[0];if(bJ.css(b3,"position")==="fixed"){b5=b3.getBoundingClientRect()}else{b4=this.offsetParent();b5=this.offset();if(!bJ.nodeName(b4[0],"html")){e=b4.offset()}e.top+=bJ.css(b4[0],"borderTopWidth",true);e.left+=bJ.css(b4[0],"borderLeftWidth",true)}return{top:b5.top-e.top-bJ.css(b3,"marginTop",true),left:b5.left-e.left-bJ.css(b3,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||l.documentElement;
while(e&&(!bJ.nodeName(e,"html")&&bJ.css(e,"position")==="static")){e=e.offsetParent}return e||l.documentElement})}});bJ.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b4,b3){var e=/Y/.test(b3);bJ.fn[b4]=function(b5){return bJ.access(this,function(b6,b9,b8){var b7=bp(b6);if(b8===aG){return b7?(b3 in b7)?b7[b3]:b7.document.documentElement[b9]:b6[b9]}if(b7){b7.scrollTo(!e?b8:bJ(b7).scrollLeft(),e?b8:bJ(b7).scrollTop())}else{b6[b9]=b8}},b4,b5,arguments.length,null)}});function bp(e){return bJ.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false
}bJ.each({Height:"height",Width:"width"},function(e,b3){bJ.each({padding:"inner"+e,content:b3,"":"outer"+e},function(b4,b5){bJ.fn[b5]=function(b9,b8){var b7=arguments.length&&(b4||typeof b9!=="boolean"),b6=b4||(b9===true||b8===true?"margin":"border");return bJ.access(this,function(cb,ca,cc){var cd;if(bJ.isWindow(cb)){return cb.document.documentElement["client"+e]}if(cb.nodeType===9){cd=cb.documentElement;return Math.max(cb.body["scroll"+e],cd["scroll"+e],cb.body["offset"+e],cd["offset"+e],cd["client"+e])
}return cc===aG?bJ.css(cb,ca,b6):bJ.style(cb,ca,cc,b6)},b3,b7?b9:aG,b7,null)}})});a2.jQuery=a2.$=bJ;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return bJ})}})(window);
/*!
 * jQuery Migrate - v1.1.1 - 2013-02-16
 * https://github.com/jquery/jquery-migrate
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT
 */
(function(s,p,i){var D={};s.migrateWarnings=[];if(!s.migrateMute&&p.console&&console.log){console.log("JQMIGRATE: Logging is active")}if(s.migrateTrace===i){s.migrateTrace=true}s.migrateReset=function(){D={};s.migrateWarnings.length=0};function h(G){if(!D[G]){D[G]=true;s.migrateWarnings.push(G);if(p.console&&console.warn&&!s.migrateMute){console.warn("JQMIGRATE: "+G);
if(s.migrateTrace&&console.trace){console.trace()}}}}function a(I,K,H,J){if(Object.defineProperty){try{Object.defineProperty(I,K,{configurable:true,enumerable:true,get:function(){h(J);return H},set:function(L){h(J);H=L}});return}catch(G){}}s._definePropertyBroken=true;I[K]=H}if(document.compatMode==="BackCompat"){h("jQuery is not compatible with Quirks Mode")}var f=s("<input/>",{size:1}).attr("size")&&s.attrFn,x=s.attr,w=s.attrHooks.value&&s.attrHooks.value.get||function(){return null},j=s.attrHooks.value&&s.attrHooks.value.set||function(){return i
},t=/^(?:input|button)$/i,y=/^[238]$/,B=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,k=/^(?:checked|selected)$/i;a(s,"attrFn",f||{},"jQuery.attrFn is deprecated");s.attr=function(K,I,L,J){var H=I.toLowerCase(),G=K&&K.nodeType;if(J){if(x.length<4){h("jQuery.fn.attr( props, pass ) is deprecated")}if(K&&!y.test(G)&&(f?I in f:s.isFunction(s.fn[I]))){return s(K)[I](L)}}if(I==="type"&&L!==i&&t.test(K.nodeName)&&K.parentNode){h("Can't change the 'type' of an input or button in IE 6/7/8")
}if(!s.attrHooks[H]&&B.test(H)){s.attrHooks[H]={get:function(N,M){var P,O=s.prop(N,M);return O===true||typeof O!=="boolean"&&(P=N.getAttributeNode(M))&&P.nodeValue!==false?M.toLowerCase():i},set:function(N,P,M){var O;if(P===false){s.removeAttr(N,M)}else{O=s.propFix[M]||M;if(O in N){N[O]=true}N.setAttribute(M,M.toLowerCase())}return M}};if(k.test(H)){h("jQuery.fn.attr('"+H+"') may use property instead of attribute")}}return x.call(s,K,I,L)};s.attrHooks.value={get:function(H,G){var I=(H.nodeName||"").toLowerCase();
if(I==="button"){return w.apply(this,arguments)}if(I!=="input"&&I!=="option"){h("jQuery.fn.attr('value') no longer gets properties")}return G in H?H.value:null},set:function(G,H){var I=(G.nodeName||"").toLowerCase();if(I==="button"){return j.apply(this,arguments)}if(I!=="input"&&I!=="option"){h("jQuery.fn.attr('value', val) no longer sets properties")}G.value=H}};var q,E,z=s.fn.init,A=s.parseJSON,v=/^(?:[^<]*(<[\w\W]+>)[^>]*|#([\w\-]*))$/;s.fn.init=function(G,J,I){var H;if(G&&typeof G==="string"&&!s.isPlainObject(J)&&(H=v.exec(G))&&H[1]){if(G.charAt(0)!=="<"){h("$(html) HTML strings must start with '<' character")
}if(J&&J.context){J=J.context}if(s.parseHTML){return z.call(this,s.parseHTML(s.trim(G),J,true),J,I)}}return z.apply(this,arguments)};s.fn.init.prototype=s.fn;s.parseJSON=function(G){if(!G&&G!==null){h("jQuery.parseJSON requires a valid JSON string");return null}return A.apply(this,arguments)};s.uaMatch=function(H){H=H.toLowerCase();var G=/(chrome)[ \/]([\w.]+)/.exec(H)||/(webkit)[ \/]([\w.]+)/.exec(H)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(H)||/(msie) ([\w.]+)/.exec(H)||H.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(H)||[];
return{browser:G[1]||"",version:G[2]||"0"}};if(!s.browser){q=s.uaMatch(navigator.userAgent);E={};if(q.browser){E[q.browser]=true;E.version=q.version}if(E.chrome){E.webkit=true}else{if(E.webkit){E.safari=true}}s.browser=E}a(s,"browser",s.browser,"jQuery.browser is deprecated");s.sub=function(){function G(J,K){return new G.fn.init(J,K)}s.extend(true,G,this);G.superclass=this;G.fn=G.prototype=this();G.fn.constructor=G;G.sub=this.sub;G.fn.init=function I(J,K){if(K&&K instanceof s&&!(K instanceof G)){K=G(K)
}return s.fn.init.call(this,J,K,H)};G.fn.init.prototype=G.fn;var H=G(document);h("jQuery.sub() is deprecated");return G};s.ajaxSetup({converters:{"text json":s.parseJSON}});var n=s.fn.data;s.fn.data=function(I){var H,G,J=this[0];if(J&&I==="events"&&arguments.length===1){H=s.data(J,I);G=s._data(J,I);if((H===i||H===G)&&G!==i){h("Use of jQuery.fn.data('events') is deprecated");return G}}return n.apply(this,arguments)};var o=/\/(java|ecma)script/i,u=s.fn.andSelf||s.fn.addBack;s.fn.andSelf=function(){h("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()");
return u.apply(this,arguments)};if(!s.clean){s.clean=function(G,H,N,J){H=H||document;H=!H.nodeType&&H[0]||H;H=H.ownerDocument||H;h("jQuery.clean() is deprecated");var K,I,L,O,M=[];s.merge(M,s.buildFragment(G,H).childNodes);if(N){L=function(P){if(!P.type||o.test(P.type)){return J?J.push(P.parentNode?P.parentNode.removeChild(P):P):N.appendChild(P)}};for(K=0;(I=M[K])!=null;K++){if(!(s.nodeName(I,"script")&&L(I))){N.appendChild(I);if(typeof I.getElementsByTagName!=="undefined"){O=s.grep(s.merge([],I.getElementsByTagName("script")),L);
M.splice.apply(M,[K+1,0].concat(O));K+=O.length}}}}return M}}var c=s.event.add,b=s.event.remove,g=s.event.trigger,r=s.fn.toggle,d=s.fn.live,m=s.fn.die,C="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",e=new RegExp("\\b(?:"+C+")\\b"),F=/(?:^|\s)hover(\.\S+|)\b/,l=function(G){if(typeof(G)!=="string"||s.event.special.hover){return G}if(F.test(G)){h("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'")}return G&&G.replace(F,"mouseenter$1 mouseleave$1")};if(s.event.props&&s.event.props[0]!=="attrChange"){s.event.props.unshift("attrChange","attrName","relatedNode","srcElement")
}if(s.event.dispatch){a(s.event,"handle",s.event.dispatch,"jQuery.event.handle is undocumented and deprecated")}s.event.add=function(J,H,I,K,G){if(J!==document&&e.test(H)){h("AJAX events should be attached to document: "+H)}c.call(this,J,l(H||""),I,K,G)};s.event.remove=function(K,I,J,G,H){b.call(this,K,l(I)||"",J,G,H)};s.fn.error=function(){var G=Array.prototype.slice.call(arguments,0);h("jQuery.fn.error() is deprecated");G.splice(0,0,"error");if(arguments.length){return this.bind.apply(this,G)}this.triggerHandler.apply(this,G);
return this};s.fn.toggle=function(K,I){if(!s.isFunction(K)||!s.isFunction(I)){return r.apply(this,arguments)}h("jQuery.fn.toggle(handler, handler...) is deprecated");var H=arguments,G=K.guid||s.guid++,J=0,L=function(M){var N=(s._data(this,"lastToggle"+K.guid)||0)%J;s._data(this,"lastToggle"+K.guid,N+1);M.preventDefault();return H[N].apply(this,arguments)||false};L.guid=G;while(J<H.length){H[J++].guid=G}return this.click(L)};s.fn.live=function(G,I,H){h("jQuery.fn.live() is deprecated");if(d){return d.apply(this,arguments)
}s(this.context).on(G,this.selector,I,H);return this};s.fn.die=function(G,H){h("jQuery.fn.die() is deprecated");if(m){return m.apply(this,arguments)}s(this.context).off(G,this.selector||"**",H);return this};s.event.trigger=function(I,J,H,G){if(!H&&!e.test(I)){h("Global events are undocumented and deprecated")}return g.call(this,I,J,H||document,G)};s.each(C.split("|"),function(H,G){s.event.special[G]={setup:function(){var I=this;if(I!==document){s.event.add(document,G+"."+s.guid,function(){s.event.trigger(G,null,I,true)
});s._data(this,G,s.guid++)}return false},teardown:function(){if(this!==document){s.event.remove(document,G+"."+s._data(this,G))}return false}}})})(jQuery,window);
(function(b){b.fn.__bind__=b.fn.bind;b.fn.__unbind__=b.fn.unbind;b.fn.__find__=b.fn.find;var a={version:"0.7.9",override:/keypress|keydown|keyup/g,triggersMap:{},specialKeys:{27:"esc",9:"tab",32:"space",13:"enter",8:"backspace",145:"scroll",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"del",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",109:"-",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",191:"/"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},newTrigger:function(e,d,f){var c={};
c[e]={};c[e][d]={cb:f,disableInInput:false};return c}};a.specialKeys=b.extend(a.specialKeys,{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/"});b.fn.find=function(c){this.query=c;return b.fn.__find__.apply(this,arguments)};b.fn.unHotbind=function(h,e,g){if(b.isFunction(e)){g=e;e=null}if(e&&typeof e==="string"){var f=((this.prevObject&&this.prevObject.query)||(this[0].id&&this[0].id)||this[0]).toString();var d=h.split(" ");for(var c=0;
c<d.length;c++){delete a.triggersMap[f][d[c]][e]}}return this.__unbind__(h,g)};b.fn.hotbind=function(j,f,k){var h=j.match(a.override);if(b.isFunction(f)||!h){return this.__bind__(j,f,k)}else{var n=null,i=b.trim(j.replace(a.override,""));if(i){n=this.__bind__(i,f,k)}if(typeof f==="string"){f={"combi":f}}if(f.combi){for(var m=0;m<h.length;m++){var d=h[m];var g=f.combi.toLowerCase(),e=a.newTrigger(d,g,k),l=((this.prevObject&&this.prevObject.query)||(this[0].id&&this[0].id)||this[0]).toString();e[d][g].disableInInput=f.disableInInput;
if(!a.triggersMap[l]){a.triggersMap[l]=e}else{if(!a.triggersMap[l][d]){a.triggersMap[l][d]=e[d]}}var c=a.triggersMap[l][d][g];if(!c){a.triggersMap[l][d][g]=[e[d][g]]}else{if(c.constructor!==Array){a.triggersMap[l][d][g]=[c]}else{a.triggersMap[l][d][g][c.length]=e[d][g]}}this.each(function(){var o=b(this);if(o.attr("hkId")&&o.attr("hkId")!==l){l=o.attr("hkId")+";"+l}o.attr("hkId",l)});n=this.__bind__(h.join(" "),f,a.handler)}}return n}};b.fn.codeToString=function(d){var e=d.which,j=a.specialKeys[e],i=!j&&String.fromCharCode(e).toLowerCase(),f=d.shiftKey,c=d.ctrlKey,h=d.altKey||d.originalEvent.altKey;
var k=j||i;var g="";if(h){g+="alt+"}if(c){g+="ctrl+"}if(f){g+="shift+"}return g+k};a.findElement=function(c){if(!b(c).attr("hkId")){if(b.browser.opera||b.browser.safari){while(!b(c).attr("hkId")&&c.parentNode){c=c.parentNode}}}return c};a.handler=function(e){var o=a.findElement(e.currentTarget),i=b(o),d=i.attr("hkId");if(d){d=d.split(";");var g=e.which,q=e.type,p=a.specialKeys[g],n=!p&&String.fromCharCode(g).toLowerCase(),h=e.shiftKey,c=e.ctrlKey,m=e.altKey||e.originalEvent.altKey,f=null;for(var r=0;
r<d.length;r++){if(a.triggersMap[d[r]][q]){f=a.triggersMap[d[r]][q];break}}if(f){var j;if(!h&&!c&&!m){j=f[p]||(n&&f[n])}else{var l="";if(m){l+="alt+"}if(c){l+="ctrl+"}if(h){l+="shift+"}j=f[l+p];if(!j){if(n){j=f[l+n]||f[l+a.shiftNums[n]]||(l==="shift+"&&f[a.shiftNums[n]])}}}if(j){var s=false;for(var r=0;r<j.length;r++){if(j[r].disableInInput){var k=b(e.target);if(i.is("input")||i.is("textarea")||i.is("select")||k.is("input")||k.is("textarea")||k.is("select")){return true}}s=s||j[r].cb.apply(this,[e])
}return s}}}};window.hotkeys=a;return b})(jQuery);
(function(f){function c(m){var i=f.data(m.data.target,"draggable");var h=i.options;var g=i.proxy;var l=m.data;var k=l.startLeft+m.pageX-l.startX;var j=l.startTop+m.pageY-l.startY;if(g){if(g.parent()[0]==document.body){if(h.deltaX!=null&&h.deltaX!=undefined){k=m.pageX+h.deltaX}else{k=m.pageX-m.data.offsetWidth}if(h.deltaY!=null&&h.deltaY!=undefined){j=m.pageY+h.deltaY}else{j=m.pageY-m.data.offsetHeight}}else{if(h.deltaX!=null&&h.deltaX!=undefined){k+=m.data.offsetWidth+h.deltaX}if(h.deltaY!=null&&h.deltaY!=undefined){j+=m.data.offsetHeight+h.deltaY
}}}if(m.data.parent!=document.body){k+=f(m.data.parent).scrollLeft();j+=f(m.data.parent).scrollTop()}if(h.axis=="h"){l.left=k}else{if(h.axis=="v"){l.top=j}else{l.left=k;l.top=j}}}function e(j){var i=f.data(j.data.target,"draggable");var h=i.options;var g=i.proxy;if(!g){g=f(j.data.target)}g.css({left:j.data.left,top:j.data.top});f("body").css("cursor",h.cursor)}function a(k){f.fn.draggable.isDragging=true;var j=f.data(k.data.target,"draggable");var i=j.options;var g=f(".droppable").filter(function(){return k.data.target!=this
}).filter(function(){var l=f.data(this,"droppable").options.accept;if(l){return f(l).filter(function(){return this==k.data.target}).length>0}else{return true}});j.droppables=g;var h=j.proxy;if(!h){if(i.proxy){if(i.proxy=="clone"){h=f(k.data.target).clone().insertAfter(k.data.target)}else{h=i.proxy.call(k.data.target,k.data.target)}j.proxy=h}else{h=f(k.data.target)}}h.css("position","absolute");c(k);e(k);i.onStartDrag.call(k.data.target,k);return false}function b(i){var h=f.data(i.data.target,"draggable");
c(i);if(h.options.onDrag.call(i.data.target,i)!=false){e(i)}var g=i.data.target;h.droppables.each(function(){var k=f(this);if(k.droppable("options").disabled){return}var j=k.offset();if(i.pageX>j.left&&i.pageX<j.left+k.outerWidth()&&i.pageY>j.top&&i.pageY<j.top+k.outerHeight()){if(!this.entered){f(this).trigger("_dragenter",[g]);this.entered=true}f(this).trigger("_dragover",[g])}else{if(this.entered){f(this).trigger("_dragleave",[g]);this.entered=false}}});return false}function d(n){f.fn.draggable.isDragging=false;
b(n);var j=f.data(n.data.target,"draggable");var g=j.proxy;var i=j.options;if(i.revert){if(k()==true){f(n.data.target).css({position:n.data.startPosition,left:n.data.startLeft,top:n.data.startTop})}else{if(g){var m,l;if(g.parent()[0]==document.body){m=n.data.startX-n.data.offsetWidth;l=n.data.startY-n.data.offsetHeight}else{m=n.data.startLeft;l=n.data.startTop}g.animate({left:m,top:l},function(){h()})}else{f(n.data.target).animate({left:n.data.startLeft,top:n.data.startTop},function(){f(n.data.target).css("position",n.data.startPosition)
})}}}else{f(n.data.target).css({position:"absolute",left:n.data.left,top:n.data.top});k()}i.onStopDrag.call(n.data.target,n);f(document).unbind(".draggable");setTimeout(function(){f("body").css("cursor","")},100);function h(){if(g){g.remove()}j.proxy=null}function k(){var o=false;j.droppables.each(function(){var q=f(this);if(q.droppable("options").disabled){return}var p=q.offset();if(n.pageX>p.left&&n.pageX<p.left+q.outerWidth()&&n.pageY>p.top&&n.pageY<p.top+q.outerHeight()){if(i.revert){f(n.data.target).css({position:n.data.startPosition,left:n.data.startLeft,top:n.data.startTop})
}f(this).trigger("_drop",[n.data.target]);h();o=true;this.entered=false;return false}});if(!o&&!i.revert){h()}return o}return false}f.fn.draggable=function(g,h){if(typeof g=="string"){return f.fn.draggable.methods[g](this,h)}return this.each(function(){var j;var l=f.data(this,"draggable");if(l){l.handle.unbind(".draggable");j=f.extend(l.options,g)}else{j=f.extend({},f.fn.draggable.defaults,g||{})}var k=j.handle?(typeof j.handle=="string"?f(j.handle,this):j.handle):f(this);f.data(this,"draggable",{options:j,handle:k});
if(j.disabled){f(this).css("cursor","");return}k.unbind(".draggable").bind("mousemove.draggable",{target:this},function(n){if(f.fn.draggable.isDragging){return}var m=f.data(n.data.target,"draggable").options;if(i(n)){f(this).css("cursor",m.cursor)}else{f(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(m){f(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(p){if(i(p)==false){return}f(this).css("cursor","");var m=f(p.data.target).position();var q=f(p.data.target).offset();
var o={startPosition:f(p.data.target).css("position"),startLeft:m.left,startTop:m.top,left:m.left,top:m.top,startX:p.pageX,startY:p.pageY,offsetWidth:(p.pageX-q.left),offsetHeight:(p.pageY-q.top),target:p.data.target,parent:f(p.data.target).parent()[0]};f.extend(p.data,o);var n=f.data(p.data.target,"draggable").options;if(n.onBeforeDrag.call(p.data.target,p)==false){return}f(document).bind("mousedown.draggable",p.data,a);f(document).bind("mousemove.draggable",p.data,b);f(document).bind("mouseup.draggable",p.data,d)
});function i(u){var n=f.data(u.data.target,"draggable");var s=n.handle;var q=f(s).offset();var o=f(s).outerWidth();var w=f(s).outerHeight();var x=u.pageY-q.top;var m=q.left+o-u.pageX;var v=q.top+w-u.pageY;var p=u.pageX-q.left;return Math.min(x,m,v,p)>n.options.edge}})};f.fn.draggable.methods={options:function(g){return f.data(g[0],"draggable").options},proxy:function(g){return f.data(g[0],"draggable").proxy},enable:function(g){return g.each(function(){f(this).draggable({disabled:false})})},disable:function(g){return g.each(function(){f(this).draggable({disabled:true})
})}};f.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,onBeforeDrag:function(g){},onStartDrag:function(g){},onDrag:function(g){},onStopDrag:function(g){}};f.fn.draggable.isDragging=false})(jQuery);
(function(a){function b(c){a(c).addClass("droppable");a(c).bind("_dragenter",function(f,d){a.data(c,"droppable").options.onDragEnter.apply(c,[f,d])});a(c).bind("_dragleave",function(f,d){a.data(c,"droppable").options.onDragLeave.apply(c,[f,d])});a(c).bind("_dragover",function(f,d){a.data(c,"droppable").options.onDragOver.apply(c,[f,d])});a(c).bind("_drop",function(f,d){a.data(c,"droppable").options.onDrop.apply(c,[f,d])})}a.fn.droppable=function(c,d){if(typeof c=="string"){return a.fn.droppable.methods[c](this,d)
}c=c||{};return this.each(function(){var e=a.data(this,"droppable");if(e){a.extend(e.options,c)}else{b(this);a.data(this,"droppable",{options:a.extend({},a.fn.droppable.defaults,c)})}})};a.fn.droppable.methods={options:function(c){return a.data(c[0],"droppable").options},enable:function(c){return c.each(function(){a(this).droppable({disabled:false})})},disable:function(c){return c.each(function(){a(this).droppable({disabled:true})})}};a.fn.droppable.defaults={accept:null,disabled:false,onDragEnter:function(d,c){},onDragOver:function(d,c){},onDragLeave:function(d,c){},onDrop:function(d,c){}}
})(jQuery);
(function(a){a.fn.resizable=function(d,h){if(typeof d=="string"){return a.fn.resizable.methods[d](this,h)}function c(m){var l=m.data;var j=a.data(l.target,"resizable").options;if(l.dir.indexOf("e")!=-1){var k=l.startWidth+m.pageX-l.startX;k=Math.min(Math.max(k,j.minWidth),j.maxWidth);l.width=k}if(l.dir.indexOf("s")!=-1){var i=l.startHeight+m.pageY-l.startY;i=Math.min(Math.max(i,j.minHeight),j.maxHeight);l.height=i}if(l.dir.indexOf("w")!=-1){var k=l.startWidth-m.pageX+l.startX;k=Math.min(Math.max(k,j.minWidth),j.maxWidth);
l.width=k;l.left=l.startLeft+l.startWidth-l.width}if(l.dir.indexOf("n")!=-1){var i=l.startHeight-m.pageY+l.startY;i=Math.min(Math.max(i,j.minHeight),j.maxHeight);l.height=i;l.top=l.startTop+l.startHeight-l.height}}function f(k){var j=k.data;var i=a(j.target);i.css({left:j.left,top:j.top});if(i.outerWidth()!=j.width){i._outerWidth(j.width)}if(i.outerHeight()!=j.height){i._outerHeight(j.height)}}function b(i){a.fn.resizable.isResizing=true;a.data(i.data.target,"resizable").options.onStartResize.call(i.data.target,i);
return false}function e(i){c(i);if(a.data(i.data.target,"resizable").options.onResize.call(i.data.target,i)!==false){f(i)}return false}function g(i){a.fn.resizable.isResizing=false;c(i,true);f(i);a.data(i.data.target,"resizable").options.onStopResize.call(i.data.target,i);a(document).unbind(".resizable");a("body").css("cursor","");return false}return this.each(function(){var j=null;var k=a.data(this,"resizable");if(k){a(this).unbind(".resizable");j=a.extend(k.options,d||{})}else{j=a.extend({},a.fn.resizable.defaults,d||{});
a.data(this,"resizable",{options:j})}if(j.disabled===true){return}a(this).bind("mousemove.resizable",{target:this},function(m){if(a.fn.resizable.isResizing){return}var l=i(m);if(l==""){a(m.data.target).css("cursor","")}else{a(m.data.target).css("cursor",l+"-resize")}}).bind("mouseleave.resizable",{target:this},function(l){a(l.data.target).css("cursor","")}).bind("mousedown.resizable",{target:this},function(o){var l=i(o);if(l==""){return}function n(p){var q=parseInt(a(o.data.target).css(p));if(isNaN(q)){return 0
}else{return q}}var m={target:o.data.target,dir:l,startLeft:n("left"),startTop:n("top"),left:n("left"),top:n("top"),startX:o.pageX,startY:o.pageY,startWidth:a(o.data.target).outerWidth(),startHeight:a(o.data.target).outerHeight(),width:a(o.data.target).outerWidth(),height:a(o.data.target).outerHeight(),deltaWidth:a(o.data.target).outerWidth()-a(o.data.target).width(),deltaHeight:a(o.data.target).outerHeight()-a(o.data.target).height()};a(document).bind("mousedown.resizable",m,b);a(document).bind("mousemove.resizable",m,e);
a(document).bind("mouseup.resizable",m,g);a("body").css("cursor",l+"-resize")});function i(r){var s=a(r.data.target);var n="";var o=s.offset();var l=s.outerWidth();var u=s.outerHeight();var m=j.edge;if(r.pageY>o.top&&r.pageY<o.top+m){n+="n"}else{if(r.pageY<o.top+u&&r.pageY>o.top+u-m){n+="s"}}if(r.pageX>o.left&&r.pageX<o.left+m){n+="w"}else{if(r.pageX<o.left+l&&r.pageX>o.left+l-m){n+="e"}}var t=j.handles.split(",");for(var p=0;p<t.length;p++){var q=t[p].replace(/(^\s*)|(\s*$)/g,"");if(q=="all"||q==n){return n
}}return""}})};a.fn.resizable.methods={options:function(b){return a.data(b[0],"resizable").options},enable:function(b){return b.each(function(){a(this).resizable({disabled:false})})},disable:function(b){return b.each(function(){a(this).resizable({disabled:true})})}};a.fn.resizable.defaults={disabled:false,handles:"n, e, s, w, ne, se, sw, nw, all",minWidth:233,minHeight:149,maxWidth:10000,maxHeight:10000,edge:5,onStartResize:function(b){},onResize:function(b){},onStopResize:function(b){}};a.fn.resizable.isResizing=false
})(jQuery);
(function(j){var c,m="sortable",l={drag:true,drop:true,exclude:"",nested:true,vertical:true},a={afterMove:function(q,d,r){},containerPath:"",containerSelector:"ol, ul",distance:0,delay:0,handle:"",itemPath:"",itemSelector:"li",isValidTarget:function(q,d){return true},onCancel:function(q,d,s,r){},onDrag:function(q,d,s,r){q.css(d)},onDragStart:function(q,d,s,r){q.css({height:q.height(),width:q.width()});q.addClass("dragged");j("body").addClass("dragging")},onDrop:function(q,d,s,r){q.removeClass("dragged").removeAttr("style");
j("body").removeClass("dragging")},onMousedown:function(d,r,q){if(q.target.nodeName!="INPUT"&&q.target.nodeName!="SELECT"){q.preventDefault();return true}},placeholder:'<li class="placeholder"/>',pullPlaceholder:true,serialize:function(s,r,q){var d=j.extend({},s.data());if(q){return r}else{if(r[0]){d.children=r;delete d.subContainer}}delete d.sortable;return d},tolerance:0},i={},e=0,f={left:0,top:0,bottom:0,right:0};c={start:"touchstart.sortable mousedown.sortable",drop:"touchend.sortable touchcancel.sortable mouseup.sortable",drag:"touchmove.sortable mousemove.sortable",scroll:"scroll.sortable"};
function n(r,q){var d=Math.max(0,r[0]-q[0],q[0]-r[1]),s=Math.max(0,r[2]-q[1],q[1]-r[3]);return d+s}function p(w,u,q,s){var r=w.length,d=s?"offset":"position";q=q||0;while(r--){var t=w[r].el?w[r].el:j(w[r]),v=t[d]();v.left+=parseInt(t.css("margin-left"),10);v.top+=parseInt(t.css("margin-top"),10);u[r]=[v.left-q,v.left+t.outerWidth()+q,v.top-q,v.top+t.outerHeight()+q]}}function k(r,d){var q=d.offset();return{left:r.left-q.left,top:r.top-q.top}}function o(s,u,r){u=[u.left,u.top];r=r&&[r.left,r.top];
var t,q=s.length,d=[];while(q--){t=s[q];d[q]=[q,n(t,u),r&&n(t,r)]}d=d.sort(function(w,v){return v[1]-w[1]||v[2]-w[2]||v[0]-w[0]});return d}function h(d){this.options=j.extend({},a,d);this.containers=[];if(!this.options.parentContainer){this.scrollProxy=j.proxy(this.scroll,this);this.dragProxy=j.proxy(this.drag,this);this.dropProxy=j.proxy(this.drop,this);this.placeholder=j(this.options.placeholder);if(!d.isValidTarget){this.options.isValidTarget=undefined}}}h.get=function(d){if(!i[d.group]){if(d.group===undefined){d.group=e++
}i[d.group]=new h(d)}return i[d.group]};h.prototype={dragInit:function(q,d){this.$document=j(d.el[0].ownerDocument);if(d.enabled()){this.item=j(q.target).closest(this.options.itemSelector);this.itemContainer=d;if(this.item.is(this.options.exclude)||!this.options.onMousedown(this.item,a.onMousedown,q)){return}this.setPointer(q);this.toggleListeners("on")}else{this.toggleListeners("on",["drop"])}this.setupDelayTimer();this.dragInitDone=true},drag:function(s){if(!this.dragging){if(!this.distanceMet(s)||!this.delayMet){return
}this.options.onDragStart(this.item,this.itemContainer,a.onDragStart,s);this.item.before(this.placeholder);this.dragging=true}this.setPointer(s);this.options.onDrag(this.item,k(this.pointer,this.item.offsetParent()),a.onDrag,s);var d=s.pageX,u=s.pageY,r=this.sameResultBox,q=this.options.tolerance;if(!r||r.top-q>u||r.bottom+q<u||r.left-q>d||r.right+q<d){if(!this.searchValidTarget()){this.placeholder.detach()}}},drop:function(d){this.toggleListeners("off");this.dragInitDone=false;if(this.dragging){if(this.placeholder.closest("html")[0]){this.placeholder.before(this.item).detach()
}else{this.options.onCancel(this.item,this.itemContainer,a.onCancel,d)}this.options.onDrop(this.item,this.getContainer(this.item),a.onDrop,d);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=undefined;this.dragging=false}},searchValidTarget:function(v,t){if(!v){v=this.relativePointer||this.pointer;t=this.lastRelativePointer||this.lastPointer}var q=o(this.getContainerDimensions(),v,t),s=q.length;while(s--){var r=q[s][0],w=q[s][1];if(!w||this.options.pullPlaceholder){var d=this.containers[r];
if(!d.disabled){if(!this.$getOffsetParent()){var u=d.getItemOffsetParent();v=k(v,u);t=k(t,u)}if(d.searchValidTarget(v,t)){return true}}}}if(this.sameResultBox){this.sameResultBox=undefined}},movePlaceholder:function(q,r,t,d){var s=this.lastAppendedItem;if(!d&&s&&s[0]===r[0]){return}r[t](this.placeholder);this.lastAppendedItem=r;this.sameResultBox=d;this.options.afterMove(this.placeholder,q,r)},getContainerDimensions:function(){if(!this.containerDimensions){p(this.containers,this.containerDimensions=[],this.options.tolerance,!this.$getOffsetParent())
}return this.containerDimensions},getContainer:function(d){return d.closest(this.options.containerSelector).data(m)},$getOffsetParent:function(){if(this.offsetParent===undefined){var d=this.containers.length-1,q=this.containers[d].getItemOffsetParent();if(!this.options.parentContainer){while(d--){if(q[0]!=this.containers[d].getItemOffsetParent()[0]){q=false;break}}}this.offsetParent=q}return this.offsetParent},setPointer:function(q){var r={left:q.pageX,top:q.pageY};if(this.$getOffsetParent()){var d=k(r,this.$getOffsetParent());
this.lastRelativePointer=this.relativePointer;this.relativePointer=d}this.lastPointer=this.pointer;this.pointer=r},distanceMet:function(d){return(Math.max(Math.abs(this.pointer.left-d.pageX),Math.abs(this.pointer.top-d.pageY))>=this.options.distance)},setupDelayTimer:function(){var d=this;this.delayMet=!this.options.delay;if(!this.delayMet){clearTimeout(this._mouseDelayTimer);this._mouseDelayTimer=setTimeout(function(){d.delayMet=true},this.options.delay)}},scroll:function(d){this.clearDimensions();
this.clearOffsetParent()},toggleListeners:function(r,d){var q=this;d=d||["drag","drop","scroll"];j.each(d,function(s,t){q.$document[r](c[t],q[t+"Proxy"])})},clearOffsetParent:function(){this.offsetParent=undefined},clearDimensions:function(){this.containerDimensions=undefined;var d=this.containers.length;while(d--){this.containers[d].clearDimensions()}},destroy:function(){i[this.options.group]=undefined}};function g(r,q){this.el=r;this.options=j.extend({},l,q);this.group=h.get(this.options);this.rootGroup=this.options.rootGroup||this.group;
this.parentContainer=this.options.parentContainer;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;var d=this.rootGroup.options.itemPath,s=d?this.el.find(d):this.el;s.on(c.start,this.handle,j.proxy(this.dragInit,this));if(this.options.drop){this.group.containers.push(this)}}g.prototype={dragInit:function(q){var d=this.rootGroup;if(!d.dragInitDone&&q.which===1&&this.options.drag){d.dragInit(q,this)}},searchValidTarget:function(d,r){var v=o(this.getItemDimensions(),d,r),s=v.length,w=this.rootGroup,y=!w.options.isValidTarget||w.options.isValidTarget(w.item,this);
if(!s&&y){var x=this.rootGroup.options.itemPath,u=x?this.el.find(x):this.el;w.movePlaceholder(this,u,"append");return true}else{while(s--){var t=v[s][0],q=v[s][1];if(!q&&this.hasChildGroup(t)){var z=this.getContainerGroup(t).searchValidTarget(d,r);if(z){return true}}else{if(y){this.movePlaceholder(t,d);return true}}}}},movePlaceholder:function(x,q){var B=j(this.items[x]),w=this.itemDimensions[x],d="after",r=B.outerWidth(),A=B.outerHeight(),v=B.offset(),s={left:v.left,right:v.left+r,top:v.top,bottom:v.top+A};
if(this.options.vertical){var z=(w[2]+w[3])/2,y=q.top<=z;if(y){d="before";s.bottom-=A/2}else{s.top+=A/2}}else{var t=(w[0]+w[1])/2,u=q.left<=t;if(u){d="before";s.right-=r/2}else{s.left+=r/2}}if(this.hasChildGroup(x)){s=f}this.rootGroup.movePlaceholder(this,B,d,s)},getItemDimensions:function(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(.placeholder, .dragged)").get();p(this.items,this.itemDimensions=[],this.options.tolerance)}return this.itemDimensions},getItemOffsetParent:function(){var q,d=this.el;
if(d.css("position")==="relative"||d.css("position")==="absolute"||d.css("position")==="fixed"){q=d}else{q=d.offsetParent()}return q},hasChildGroup:function(d){return this.options.nested&&this.getContainerGroup(d)},getContainerGroup:function(r){var s=j.data(this.items[r],"subContainer");if(s===undefined){var q=this.$getChildren(this.items[r],"container");s=false;if(q[0]){var d=j.extend({},this.options,{parentContainer:this,rootGroup:this.rootGroup,group:e++});s=q[m](d).data(m).group}j.data(this.items[r],"subContainer",s)
}return s},enabled:function(){return !this.disabled&&(!this.parentContainer||this.parentContainer.enabled())},$getChildren:function(s,r){var q=this.rootGroup.options,t=q[r+"Path"],d=q[r+"Selector"];s=j(s);if(t){s=s.find(t)}return s.children(d)},_serialize:function(s,r){var t=this,d=r?"item":"container",q=this.$getChildren(s,d).not(this.options.exclude).map(function(){return t._serialize(j(this),!r)}).get();return this.rootGroup.options.serialize(s,q,r)},clearDimensions:function(){this.itemDimensions=undefined;
if(this.items&&this.items[0]){var d=this.items.length;while(d--){var q=j.data(this.items[d],"subContainer");if(q){q.clearDimensions()}}}}};var b={enable:function(d){this.disabled=false},disable:function(d){this.disabled=true},serialize:function(){return this._serialize(this.el,true)},destroy:function(){this.rootGroup.destroy()}};j.extend(g.prototype,b);j.fn[m]=function(d){var q=Array.prototype.slice.call(arguments,1);return this.map(function(){var s=j(this),r=s.data(m);if(r&&b[d]){return b[d].apply(r,q)||this
}else{if(!r&&(d===undefined||typeof d==="object")){s.data(m,new g(s,d))}}return this})}})(jQuery);
if (window.FR == null) {
    window.FR = {};
}

$.extend(FR, {
    /**
     * FR.plainText(key)
     */
    chinese : {

    },

    i18n: {"FR-Engine_ConditionB-is_less_than_or_equal_to":"","FR-Designer_Certificate_Path":"","Select_Mail_Column":"","BindColumn-Have_Up_Parent_Cell":"","Plugin-Theme_License_Expired_Tip":",!","MConfig-BorderTitle":"","ChartF-Radar":"","FR-Chart-Help_UpdateOnline":"","Page-Attribute":"","ChartF-Interval":"","Icon_And_Text_Cannot_Be_Empty_In_The_Same_Time":"","FS-Setting-Theme_Config":"","FS-Schedule-End_If_Executed":"","Schedule-Hourly":"","FS-Mobile-Mobile_Dev_Binding":"","Chart_Legend_Is_Visible":"","TrueRunInterval":"","Platform-DB_Connection_Create_Failure":"","B-PrintSetup":"(P)","FR-Chart-Map_NameAlreadyExist":"","Export_Setting":"","FS-Generic-System_Status":"","Selection":"","FR-Chart-Map_Xining":"","turn":"","High-Low-Line":"","FS-Reg-Export_Info":"","Plugin-ChartF_Map_Image_RootName":"","FS-Monitor-Log_Clean_One_Month_Ago":"","FR-Designer_Unit_CM":"","FS-Report-Choose_ViewType":"","HTML-Write_Content_Save_Successfully":"","ChengduCity":"","Directory":"","Dismenber":"","Chart-In_Pie":"","Drag_To_Move":"","Center":"","FR-Chart-Type_Range":"","Schedule-Edit_Start_Time":"","DBCP_MAX_WAIT":"","M-Open_Report":"...","Red":"","ReportServerP-Report_server_parameter":"","Please_enter_the_export_file_name":"","Widget-Comb_Widget_Config":"","Plugin-ChartF_LimitAreaSize":"","FS-Plugin-Store_Expired":"","Template_Parameters":"","M_Format-Add_Column_After":"(L)","Add":"","Email-Sending":"","FR-Chart-Data_OnlyUseBefore":"","Prev_Month":"","Chart_Relief":"","FR-Engine_FS_End_Time":"","FR-Base_Sche_Friday":"","BackgroundTexture-Stationery":"","FR-Designer-Plugin_Duplicate_ID":"id","FS-System-Config_Sure_To_Restore":"?","Register_failed":"WEB-INF/resources","Search_Result":"","ParameterD-The_Other":"","FS-Generic-Privilege_Keep_Login_State":"","CellWrite-Including_Current_Cell":"","FR-Engine_FangSong":"","FR-App-Template_Save":"","FS-Admin-Enter_New_Password":"","Max-Files_Length":"","FR-Engine-Page_Setup_Landscape":"","Cannot_Parse_Template_File":"","FR-Chart-Map_Corresponding_Fields":"","Chart-Trend_Line":"","BindColumn-Summary_Parameters":"","PageSetup-Left_to_right":"","FR-Chart-Choose_Style":"","Chart_TrendLine":"","Utils-Activate_Designer":"","Form":"","ECP_error_pwd":"","FS-Msg-Update_Chosen":",","Warning-Template_Do_Not_Exsit":"","Form-Basic_Properties":"","FR-Chart-Type_Gantt":"","I-RadarChartStyle_Marker":"","M_Server-Public_Datasource_Manager":"(D)","Custom_Icon_RemoveIcon":"","FS-Generic-Simple_Closed":"","Present":"","HJS-Subject":"","FR-Designer-Dependence_Install_Online":"","FR-Chart-Series_Config":"","FR-Engine_WritePreview":"","FR-Engine_Over-Sheet":"sheet","Milliseconds":"","FR-Engine_ExecuteOneTime":"","Form-All_Files":"","FS-Setting-Homepage_URL_Pad":"","Plugin-ChartF_Preview_Bubble":"","Plugin-ChartF_CategoryLabel":"","BackgroundTexture-RecycledPaper":"","Version-does-not-support":"liclic","FR-Engine-Condition_Begin_With":"","Flash/PdfInstallSet_Message":"\u2018WEB-INF\u2019web","FR-Designer_FS_Close_Other_Templates":"","FR-Engine-Condition_Not_Contains":"","StyleAlignment-Bottom":"","Plugin-ChartF_New_Map":"","parameter_name_exist":"","FR-Designer_Unit_MM":"","ConditionB-does_not_equal_to":"","Fujian":"","Dic-Set_Key_And_Value":"","SQLWizard-add_subquery":"","Chart-Stock_Check_Data":"","FR-Designer-Undo_All_Authority_Operations":"","PageSetup-Predefined":"","M_Insert-Barcode":"","FR-Chart-Province_Map":"","ReportColumns-Columns_after":"","FS-Monitor-Visits_Template":"","DashBoard-Online_Document":"","HF-New_Line":"","NS_export_wordPageSize":":1114 WordSheet","Short-Sep":"","FR-Engine_Please_Install":"","Column_Cell":"","Form-Top_Align":"","FS-System-Dialog_Title":"","Sure_To_Close_Synch_Data_Sets":"","FS-Schedule-Execute_By_Expression":"","FR-Custom_styles_lost":"","FS-Generic-Mobile_Phone":"","Utils-OpenDemoEnv":"","contact_info":"()","FR-Base-Time_Day":"","Plugin-ChartF_Preview_TreeMap":"","FS-Setting-Input_Homepage_Name":"","FR-Designer_Message":"","Type-Parameter":"<html> <body> ${abc}abc<br>","FS-Monitor-Model_Unused":"","FS-Plugin-Store_Developer":"","Plugin-ChartF_HeatPoint":"","Plugin-ChartF_Flash_Animation":"","DS-Embedded_TableData":"","FR-Designer_WorkBook":"","RowTo":"","Form-Change_Widget_Name_Discription":"","FR-Designer-Widget_Settings":"","FR-Base_February":"","Plugin-ChartF_Preview_Stack_ColumnType_Radar":"","FS-System-Reportlets_root_directory_name":"","FS-Setting-Color_Custom":"","All":"","FR-Engine_Select_FS_Roles":"","Change_To_LayerReport":"","ChartF-Pie_Depth":"","M_File-Export-Word":"Word","FS-User-Ldap_Suffix":"","Password_Changed_Successfully":"","FS-Setting-Add_Home_Page":"","Chart_Average_Value":"","FR-Chart-Large_Data_Model":"","Show_Icon":"","Write_Preview":"","Datasource-SQL_Query":"SQL","Event-cardchange":"Tab","Event-callback":"","SQL":"SQL","WF-Junior":"","Plugin-ChartF_Preview_StackColumn_Line_Custom":"","Datasource-User_Defined":"","Bright-Style":"","FR-Chart-Design_ChartModule":"","FR-Engine_Please_Select_Step":"","And":"","SQLWizard-wait":"","Chart_Null_Value_Continue":"","FR-Base_March":"","FR-Engine_Current_Node_Staff":"","FR-Chart-Chart_Text":"","Row":"","Utils-Unregistered_Version":"(,)","BindColumn-Select":"","FR-Engine_Season":"","FR-Engine_Please_Select_Sort_Rule":"","Show_Grid_Line":"","FR-Designer-Basic_Restart_Designer_Later":"","Default_ParameterWindow_CountPerRow":"","CellWrite-Suppress_If_Duplicated(Used_in_Group_Report)":"()","Function":"","Form-Same_Width":"","FR-Chart-Map_Yunnan":"","Plugin-ChartF_NewCustom_ColumnArea":"-","Form-Empty":"","Cache-Local_Disk_Cache-Setting":"","Create_Time":"","Plugin-ChartF_Gauge_Pointer180":"180","ReportServerP-FormToolBar":"","BindColumn-Even_Selected_(2,4,6...)":"(2,4,6...)","FR-Chart-Type_Column":"","FR-Base_Value":"","FR-Designer_Utils-Move_Up":"","FR-Designer_Certificate_Pass":"https","FR-Chart-Color_Subject":"","FR-Engine_ConditionB-is_greater_than":"","FR-Engine_This_Template_Has_Exist":"","FR-Engine_Applet_Print":"Applet","FS-Base-User_Not_Login":"","BindColumn-Bottom_N":"N","FR-Engine_Failed":"","Cursor_to_next_row":"","FS-Generic-Simple_Fri":"","Widget-Load_Type":"","FR-Designer_Font":"","FR-Plugin_Attr-Set":"","NS_export_excelHtml":":1111 ExcelHtml","M-Print_Report":"(P)","FlowLayout-Right":"","FR-Designer-Widget-Style_Preview":"","Oracle_All_Tables":"","Chart-Link_Reportlet":"","FS-System-Task_Completed":"","SummaryFields":"","FR-Action_Sort":"","Hyperlink-Features":"","Form-RoleTableTree":"","Sort-Descending":"","Insert-Formula_Edit":"","FS-Setting-Homepage_URL_Mobile":"","FR-Engine_ConditionB-Parameter_name_cannot_be_null":"","Uping_File":"","FS-Schedule-Execute_Once":"","RP_Pass":"","ServerM-Define_Styles":"","ReportServerP-Write_Processor":"","FR-Engine_Export":"","ExpandD-Expandable":"","ReportServerP-Printers(Server)":"()","Group":"","Export-Word":"Word","Vertical-SplitPane":"","Datasource-Query_Type":"","Widget-Sizing":"","BackgroundTexture-PinkTissuePaper":"","must_choose_one_report":"","Event-beforeflashprint":"Flash","FR-Engine_ConditionB-OR":"(OR)","M_Report-Report_Interface":"(I)","ChartF-Axis":"","FR-Engine_ConditionB-null":"","FR-Engine-Export_Excel_LargeData_Page_Info":"","Has_been_gone":"  ","Datasource-Data_Map_Source":"","Run":"","FS-Schedule-Enter_Correct_Run_Times":"","REPORT_XML":"","Chart_Move_Average":"","Add_summary_fields":"","alert_word":", word, , .","FR-Engine_Utils_PDF_Print[Client]":"[]","FR-Base-Song_TypeFace":"","Event-afterwrite":"","FS-Admin-Account_Has_Set":"","M_Insert-Formula":"","Chart-LngFirst":"","FR-Designer_Component_Scale":"","SyncSuccess":"","EX-IP_Address_Overflow":"IP","FR-Engine_Image-Export":"","I-RadarChartStyle_FillwithMarker":"","FR-Designer-LayerPageReport_CustomCountQuery":"SQL","Search":"","FS-Generic-Simple_October":"","GroupReport-Set_Page_Footer_Of_Last_Page_Under_Report_Footer":"","FR-Engine_Select_FS_Users":"","FR-Base-Time_Year":"","FS-Generic-Schedule_Template":"","RoleName_Can_Not_Be_Null":"","FR-Chart-Table_Data":"","FR-Engine_Interactive-chart":"","FS-Mobile-User_Limit_Tip_Right":"","FS-Report-Do_Select_Dir":"","FR-Engine_Form":"","Data_Rollback_Failed":"","FR-Engine_Repeat":"","FR-Designer_Dropdown-More-Preview":"","ChartF-Series_Name_From":"","FS-Msg-Delete_YES_NO":"?","Dictionary-Dynamic_SQL":"SQL","FS-Process-Limit":"","FS-Report-BI_Data_Settings":"BI","FS-Generic-Simple_September":"","Select_DataColumn":"","UpBarBorderStyleAndColor":"","Preference-Horizontal_Scroll_Bar_Visible":"","Chart_Not_Zero":"","INFO-End_Converting_ReportPage_To_Html":"Html","Schedule-Unspecified_Report_File_Prefix":"","ExpandD-Data_Column":"","Form-Events":"","Others":"","FormulaD-Invalid_SQL":"SQL","FR-Chart-Category_Gap":"","FR-Chart-Stock_Close":"","FS-BI-Dezi_Report_Location":"","M-Cell":"","FS-System-Cache_Principle":"","WF-Reportlet_Field":"","FR-Engine_Schedule-Monthly":"","Preference-Is_Drag_Permited":"","FR-Engine_Hana-TableData":"Hana","FR-Engine-Err-The_value_must_be_number":"","FR-Engine_Schedule-Template_Parameter":"","FS-Plugin-Store_Permanent":"","FR-Basic_Failed":"","ChartDrawSet":"","ChartF-Legend":"","Utils-Column_Width":"","server_disconnected":"","Shared_To_Me":"","FS-Admin-Passwords_Not_Match":"","FR-Engine_Specified_Pages_Not_Exist":"","FR-Designer-FRFont_Size":"","Enter_Analysis_Name":"","Frozen":"","FR-Hyperlink_Dialog":"","FR-App-Export_png":"PNG","Refresh_Successfully":"","ContentDisplay":"","M_Edit-Unmerge_Cell":"","Rename_Column":"","Help":"","FR-Chart-Map_Zhengzhou":"","Plugin-ChartF_Range":"","FR-Base_RWA-Key":"","add_schedule_task":"","FS-Schedule-New_Task":"","Export":"","Utils-The-Form":"","FR-Engine_Task_List_Chosen":"","CellWrite-InsertRow_DEFAULT":"","FormulaD-Math_&_Trig":"","column_and_row":"","FR-Designer_Chart_Field_Name":"","ParameterD-New_parameter_name":"","Short-Apr":"","FS-Generic-Minute_Wrong":"","Type":"","Page-Setup-Scale-Units":"","FS-Setting-Top_Navigation":"","FR-Engine_Not_limited_IP":"","I-xyScatterStyle_LineMarker":"","Style-Right_Indent":"","Send":"","The_file_name_already_exists_,_override_it_?":"","Interactive-chart":"","FR-Designer-Widget-Style_Alpha":"","Unfrozen":"","FS-Generic-Parameter_String":"","Hyperlink-Height_Of_New_Window":"","FR-Designer-Widget-Style_Border_Line":"","Repeat-Block_Name":"","FR-Chart-Stock_High":"","FS-User_Import_User":"","Sat":"","Writer-ShortCuts_Setting":"","FR-Designer_Alignment-Style":"","FS-System-Email_Port":"","Short-Aug":"","FR-Designer-All_MSBold":"","FS-System_Simple_Email":"","Utils-Need_to_select_a_datasource_file":"","FS-CutomStyle_Toast_OK":"","RWA-NotChange_Unmodified":"","Utils-PDF_Print[Client]":"PDF[]","Schedule-Select_Path":"","Column Type":"","SecondGraduationLineStyle":"","FS-Admin-Admin_Password":"","Syn-transfer":"","Standerd":"","Docking-Docked_Mode":"","FS-Generic-Simple_Wed":"","Session":"","FS-CustomStyle_Toast_Exist_alert":"","FS-Generic-Simple_Ge":"","Inc_All_rights_Reserved":"","ChartF_Stock_Close":"","FR-Engine_Excel_Horizon":"Excel","GroupReport-Make_Up_Blank_Detail_Area":"","FR-Engine_Software":"","RP_Task_Created_By_Me":"","M_Insert-Slope_Line":"","Popup":"","SAP-Transfer_type_relation_setting":"","FR-mobile_html_analysis":"HTML5","FS-BI-Dezi_Report_Name":"","Schedule-Handle_Type":"","Space":"","FS-Mobile-Report_Cover_Upload_ToolTip":" 240*168px","Schedule-Save_To":"","FormulaD-Data_Fields":"","Server_Name":"","FR-App-All_Auto":"","FS-System-Connection_Description":"","CSS_warning":"  WebReport,WebReport\\csscsstest.csscss/test.css","Cancel_Repeat_Attributes":"","WF-ID":"","The_initial_background_of_the_button":"","Null_Value_Show":"","FR-Engine-Data_Submit_Error":"","FS-System-Config_Restore_Complete":"","Function-New_Function_Name":"","Plugin-ChartF_Each_Layer_Data_Special":"","Ser":"","Set":"","FS-Setting-Login_Background":"","BackgroundTexture-Parchment":"","Max Alpha":"","FRFont-Family":"","M-Close_Template":"(C)","RP_System_Message":"","FR-Engine_RP_Task_List":"","Schedule-Yearly":"","Ecp_Success":"","FS-Generic-Simple_De":"","Two_Rows_Of_Two_Grid":"","Parameter-Boolean":"","I-LineStyle_Line":"","FS-Setting-Custom_Icon":"","Printer-Are_you_sure_to_delete_this_alias":"","FS-User-Simple_Department":"","ChartB-Caculates_the_summary_of_field":"","I-BarStyle_3D":"","FR-Engine_Error-Code-PdfPrint":"\\:1121 PDFIE,PDF","Large-pitch-based":"","FS-Setting-Homepage_URL":"URL","FS-Reg-Part_Success_TipB":"&#59","FS-Reg-Part_Success_TipA":"","Event_Type":"","DataColumn":"","Plugin-ChartF_Delete":"","OriginalImage":"","Custom_FS_Roles":"","Organization_User":"","FR-Chart_Gis-Map":"Gis","FR-Designer-StyleAlignment_Left":"","SQL-View":"","HourWrong":"","Page_ToolBar_Event":"","Docking-Dock":"","Double_Click_Edit_OR_Clear":"","FR-Chart-Map_Haerbin":"","FR-Engine-Condition_End_With":"","DecimalNumber_Out":"","Schedule-Excute_Type":"","Chart_Not_Visible":"","FS-Generic-Synchronize_Now":"","FR-Action_Copy":"","ExpandD-Select_Datasource":"","ChartF-Units":"","Selected-Index":"","Chart-Series_AllData":"","Default_View":"","FR-Chart-Style_Transparent":"","DBTableData_Not_Get_RowCount":"","FS-System-Time":"","Schedule-Start_at":"","FS-User-Duplicated_Username":"","Printer-Define_Printer_Group":"","ReportGUI-Print_Background":"/","Form-CheckBox":"","Plugin-ChartF_NewTreeMap":"","FR-Designer_Fit-In-Web-Tip":"Pc","Mobile_Terminal":"","FS-Generic-Simple_Favorite":"","HF-Insert_Text":"","Executing_Report":"","FR-Chart-Data_Summary":"","Utils-The-PolyReport":"","FS-Generic-Simple_Remove":"","December":"","FR-Engine_NativePrint_Invalid_Para":", !","get-uuid-failed":"rootweb","Plugin-ChartF_NULL_Value_Color":"","Allow_Blank":"","Plugin-ChartF_Save_Error":"","Basic_Config":"","JavaScript-Parameter_Refresh":"","FuzhouCity":"","FS-Generic-Simple_OK":"","M-Template":"","FR-Chart-Map_Rename":"","FS-Module-User_Manager":"","FS-Generic-Simple_No":"","ChartF-Increment":"","ChartF-Chart_Shallow":"","RP_Add_SimpleNode":"","BindColumn-Expansion_Direction":"","FR-Engine_Sort_Horizontal":"","NS_exception_readExcelError":":1306 ","FR-Chart-Axis_Choose":"","Re-all-server-mac":"mac","Form-Widget_Property_Table":"","FS-Schedule-Simple_Execute_Time_Unit_Hour":"","FR-Plugin-Function_Description":"","ChartB-Group_Options":"","BindD-Should_select_a_datasource":"","HefeiCity":"","According_Cell_Set_Size":"","Form-Hierarchy_Tree":"","StyleAlignment-TextAndImage":"","FR-Chart-Chart_Module":"","FR-Engine_Excel_start":"sheet:","Utils-submitAll":"","HF-Defined":"","ChartF-Transparency":"","Datasource-The_name_of_datasource_cannot_be_null":"","FS-Plugin-Store_Category":"","Previous_Node_Staff":"","Options_Sources":"","Form-Delimiter":"","FS-Frame-Close_All":"","Plugin-ChartF_NewHeatMap":"()","WF-Assigned_Role":"","M_Report-Report_Footer":"","Son":"","Plugin-ChartF_Name":"","Plugin-ChartF_Circle":"","ExpandD-Horizontal_Extendable":"","Cannot_Found_Result_File":"","FR-Basic_Offline-Connect_Failed":"","FS-System-Simple_Sending":"","FR-mobile_analysis_annotation":": APP.","Indent-Character":"","FR-Base-Time_Back_In_Time":"","Plugin-ChartF_ValueAxis":"","Template":"","HF-The_Page_Number":"","FR-Engine_RP_Task_Status":"","FR-Engine__Column":"","select_same_data_to_ merge":"","Event-nodeadd":"","M_Edit-Send_Backward":"(B)","RP_Unlimited":"","Tree-Height":"","FR-Designer_Auto-Build":"","Come_True":"","ChartF-Pie":"","chartDesignerModule":"","FR-Engine_Process_RP_To_Report":"","ChartB-of":"of","DataFunction_Percent":"","ParameterD-Show_Window":"","UploadFileTip":"","FS-User-Edit_User":"","FS-System-Unlock_Gzip":"Gzip","FR-Engine_Prepare_Export":"","Re-Multi-privilege":"","Choose_DS-Server_TableData":"","SessionID":"sessionID","Datasource-Original_Charset":"","Default-Browser":"","Chart-Condition_Attributes":"","Collect-User_Information_DES":"\"\"3","Plugin-ChartF_Preview_HeatMap":"","FS-System-ServletMapping_name":"Servlet","Privilege-No_Privilege":"","Utils_UnDelete_Column":"","start_immidiately":"","Clear":"","Env-Remote_Server":"","Custom_FS_Users":"","RESTART":"","ChartF-Start_From_Zero":"","X-Coordinate":"","Finish":"","RP_Everyday":"","Combine Other to Other":"\"\"","Simplified_Chinese_Language":"","ConditionB-ends_with":"","FR-Engine_Select_the_repeated_row_and_column":"","FS-Report-Input_Cpt_Path":"","M-Form_Preview":"","FS-Generic-Export_And_Output":"","FR-Engine_File-Editor":"","Cell_Group":"","ECP_input_pwd":":","WF-Router_Task_Node":"","Set-Parent-Directory":"","M_Edit-Merge_Cell":"","FR-Chart-State_Map":"","Event-unloadcheck":"","Vertical":"","Privilege-The_Url_Must_Be_Specified":"URL","Owner":"","NS_browser_lang":":1119 ,","Plugin-ChartF_SameArcPie_Title":"","CLUSTER_REDIRECT":"","FS-Monitor-Error_Time":"","EX-Reportlets_Count_Overflow":"reportlets","Print":"","FR-Chart-Gantt_Chart":"","LIC-Support_Source_Relation":"","INFO-Reset_Webapp":"","HF-Right_Section":"","FR-Engine_SetPrinterOffset":"","Grouping_Report":"","FR-Designer-FRFont_Family":"","FS-Plugin-Store_Probation":":","fs_process_delete_tip":"","OverLap":"","Sun":"","M_Server-Scheduled_Task_Manager(T)":"(T)","Plugin-ChartF_TreeMapChart":"","ReportServerP-Email_Receiver":"","ChartF-Cross":"","RWA-Smart_Add_Cell_Group":"","Surport_String_To_Formula":"","Utils-Current_Value":"","FR-Designer_Integer":"","Plugin-ChartF_NormalLine":"","SingleName":"","Default_Parameter_Attribute_Setting":"","Utils-Report_Header":"","Logout":"","Chart_Alert_Right":"","Schedule-Save_As":"","FR-Designer-Plugin_Read_Plugin_List_Error":"","Plugin-ChartF_SlotBackground":"","Font Style Elements":"","FR-Chart-Type_Stock":"","Chart-Use_LatLng":"","Event-change":"","WF-Transition":"","FS-Reg-App_Name":"","Hebei":"","ReportServerP-From_Email_Address":"","FS-Plugin-Store_Login":"","BindD-Bind_Data":"","Event":"","FS-Plugin-Store_Authorize":":","Crimson":"","FR-Engine_Page_Total":"","FS-Privilege-Need_Input_Url_Key":"","ReportServerP-Choose_Printer":"","FS-Frame-Saved_successfully":"","Verify-Verify":"","CustomLoginPage":"","FR-Chart-Area_Name":"","FS-Generic-HJS_Send_Successfully":"","Utils-Delete_Record":"","FR-Designer_Present":"","Cannot_Found_Template_File":"","Plugin-ChartF_Pyramid":"","Utils-Delete_Column":"","Use_Default_ToolBar":"","CellWrite-Show_As_Image":"","Plugin-ChartF_Line_Map_Animation":"","Plugin-ChartF_ClockWise":"","You_are_using_unregisted_function":":1116 ","Sche-Hour":"","FR-Chart-Dialog_Cancle":"","TianjinInCity":"","FR-Designer_Fit_Ver":"","FS-Report-Add_Cpt":"","FR-Engine_Get_Registration_Code_Url":"http://www.finereporthelp.com/help/9/11.html","ColumnSpan":"","FR-Share_Module_OK":"","Schedule-File_Prefix":"","Plugin-ChartF_Gauge_Ring_Title":"","FieldBinding":"","Server_FlashInstallPath":"Flash","FR-Engine_Plugin_Expire_Dialog_Title":"","FS-Generic-Simple_Warning":"","FR_Designer_Attr_Horizontal_Adaptive":"","Options":"","Widget-Date_Selector_Return_Type":"","Dic-Data_Query":"","Time":"","Parameters_use_default_formula":"","HF-Left_Section":"","FS-Report-Input_Folder_Name":"","Form-EC_heightpercent":"","FR-Base_Format":"","Utils-New_name_cannot_be_null":"","China":"","Plugin-ChartF_CustomMap":"","FR-Designer_Set_Submit_Event":"","I-xyScatterStyle_Line":"","FR-Designer-Plugin_Shop_Need_Install":",?","Form-Newline":"","FR-Designer_Unit_PT":"","FS-Schedule-Please_Select_Execute_Month":"","BarCodeD-Define_BarCode":"","RWA-Free_SQL":"SQL","FR-Engine-Condition_Not_Begin_With":"","Every":"","Event-success":"","Whether_Query_Result_When_Paging_Preview_Timer":"","Start_Print":"","FR-App-All_Warning":"","FR-Basic_File_Not_Allow_To_Upload":"","NS_export_excelFormula":":1110 Exel","Style-Spacing":"","Datasource-Are_you_sure_to_delete_the_selected_hibernate_datasource":"Hibernate","Add_Browser":"","Ecp_Start":"","HF-Odd_Page":"","Xianggang":" ","FS-System-Config_Backup_Frequency_Oneday":"1","Data_Type":"","FS-Setting-BG_Upload_ToolTip":"1024*768PNGJPG","Capacity":"","Drag_the_selected_field":"()","Present-No_Present":"","CancelJSShow":"","FR-Chart-Gantt_Progress":"","FS-Msg-View_All":"","MakeSureOfCloseSyncDataSet":"\"\"","FS-Monitor-Form_Action":"","FR-Engine_Parameter-Boolean":"","DataFunction-Average":"","LayerPageReport_PageEngine":"","ReportColumns-Begin_at_Column":"","FR-Base_Short_Jun":"","FR-Base_Short_Jul":"","RP_Task_Type":"","ReportServerP-Browser_Background":"","DS-Report_DataList":"","LIC-Support_Meter_Chart":"","FS-Plugin-Store_Pay":"","FS-Web-Plugin_Connect_Server_Error":"","FS-Reg-Version_Number":"","Orthogonal Projection":"","Image-Extend":"","FS-Report-Add_Directory":"","Dictionary_Name_Exsited_Next_Choose_ReportDictionary":"","Save_Or_Not":"","FR-Engine_Custom":"","Plugin-ChartF_Preview_Percent_Stack_Area":"","FS-Generic-Process_Manager":"","FR-Engine_Buy_Or_Change":"","Plugin-ChartF_NewScatter_LargerData":"","Cross_Report":"","Plugin-ChartF_Longitude":"","FR-Chart-Mode_Custom":"","ES_Role_Instruction1":"","FS-Generic-Simple_Preview":"","About_The_Column":"","ES_Role_Instruction2":"","ES_Role_Instruction3":"","FR-Base_October":"","Platform-DB_Connection_Create_Successful":"","FR-Chart-Map_Shaanxi":"","ChartB-Should_select_an_on_change_column":"","Privilege-Select_Organization":"","TrueFormatIs":"","FR-Utils_Submit":"","Write-Custom_Css_Style_Path":"","FR-Engine_STKaiTi":"","Static_Setting":"","FR-Basic_NS_mail_config":":1204 ","Cursor":"","Show_Demo_Connection":"demo","Privilege-The_Url_Can_Not_Be_Null":"","Classpath":"","Plugin-ChartF_Define_Size":"","FR-Engine_Fit-Default":"","FS-Mobile-Authorized_Devices":"","Widget-Settings":"","Add_Column":"","FR-Engine_Printing":"","DS-Dictionary":"","FR-Engine_RP_NO_Privilege":"","FR-Engine_Error":"","FR-Import-Export_PDF":"PDF","Chart-Legend_Is_Visible":"","FR-Engine_RP_System_Message":"","RP_Overtime":"","FR-Chart-Map_Tianjing":"","FR-Engine_Month_Count":"","Read_Map_Use_Time":":","BindColumn-NoSort":"","Plugin-ChartF_NewForceBubble":"","FS-Schedule-Simple_Execute_Time_Unit_Day":"","FRFont-italic":"","Verify-Message":"","Chart-Unit_Billion":"","Plugin-ChartF_Inside":"","Load-Pull_Up":"","Datasource-Are_you_sure_to_delete_the_selected_SAP_datasource":"SAP","Chart_Negative_Bubble":"","FR-Plugin-Plugin_Is_Damaged":".","Image-Adjust":"","RCodeErrorCorrect":"","Column":"","FR-Chart-Map_Huhehaote":"","February":"","Tree-Mutiple_Selection_Or_Not":"","FR-Designer_Layout-Padding":"","Support-Current_Auto_Complete_Shortcut":"","Widget_Cascade":"","SetEndTime":"","FR-Engine_Value":"","PrintP-Print":"(T)","Grouping_Report_Wizard":"","Change":"","HJS-Send_Successfully":"","Chart_In_Pie":"","List-Need_Head":"","FR-Engine_ReportServerP-First":"","Sorting":"","Donot_Repeat_Data":"","StartFailed":"","FR-Chart-Field_Name":"","Next_Month":"","Delete":"","FR-Engine-NS_exception_readExcelError":":1306 ","RP_Timed_Write":"","Docking-Views_Menu":"","Server":"","Pointer-A-Tick-Order":"","Corre_parameter":"","Repeat":"","PageSetup-Horizontally":"","FS-Generic-Simple_Week":"","FR-Engine_RP_Task_Created_By_Me":"","Current_Preview_Rows":"","ChartF-Tick_Label_Property":"","__CUMULATE_PAGE_NUMBER__":"reportlets","Plugin-ChartF_Zoom_Layer":"","FR-Chart-Gantt_Step":"","GIVE-NAME":"","Plugin-ChartF_Map_Area_RootName":"","FR-Engine_ReportServerP-Next":"","M-SwitchWorkspace":"","Utils-Report_Runtime_Env":"","FR-Engine_Offline":"","Plugin-ChartF_Layer_Satellite":"","FS-Mobile-Report_Cover_Reset":"","ExpandD-Extend":"","FR-Engine_PageSetup-Page":"","FS-Generic-Simple_Pagination":"","Chart_Alpha_Int":"","Plugin-ChartF_Preview_Pointer_Semi_Gauge":"180","EditFailed":"","FS-Frame-Button_Star":"","DashBoard-AdhocSetting":"B/S","Utils-Last_Page":"","FS-Report-Simple_Device":"","At":"","FR-Chart-Map_Taibei":"","Schedule-Generate_Parameters":"","FR-Engine_Style_Name":"","Registration-User_Name":"","Thu":"","ChartF-High":"","FS-System-Visit_Template":"","LIC-Support_Online_Edit":"","RWA-Remove_Field":"","Designer_Language":"","Chart_Legend_Area":"","FS-User-User_Can_Not_Be_Null":"","Allow_Decimals":"","Zhongxi":"","FR-Basic-Email_Subject":"","FR-Designer-Plugin_Version_Is_Lower_Than_Current":"","Select_Export_Log_Directory":"","FS-Schedule-Skip_Execute":"","FR-Chart-Map_Xian":"","FR-Chart-Bar_Van":"()","Chart-Interactive_Tab":"","Flash_Print":"Flash","Default_ParameterWindow_Attribute_Setting":"","FR-Base_Short_Jan":"","Utils-Print[Server]":"[]","RadioField":"","DS-Server_TableData":"","FS-Privilege-Template_Role":"","FR-Chart-Type_Line":"","De":"","Liaoning":"","M_Edit-Paste":"(P)","FS-Process-Param_Display_Name":"","FR-Engine_Mon":"","FR-Chart-Map_Heilongjiang":"","Marker":"","FR-Engine-Report-Write_Attributes_Msg":"","Plugin-ChartF_DisplayNegative":"","FS-Monitor-Suggestion_Of_Global_Style":"","HJS-Mail_to":"","Ecp_Being":"\u2026\u2026","FR-Engine_Step":"","FS-Generic-Simple_Running":"","The_Num":"","UseTreeWillRemoveUser":"","Set_Certification":"","Multi-Excel-Import":"Excel","Show_Text":"","Condition":"","ChartF-Category":"","I-AreaStyle_Stack":"","Plugin-ChartF_DataType":"","ReportServerP-Last":"","CellWrite-Show_As_HTML":"HTML","CellWrite-Print_Content":"/","FS-Admin-Name_Can_Not_Be_Null":"","Event-beforedelete":"","Ge":"","FR-Engine_Word":"Word","Cannot find":"","Click-Get_Default_URL":"URL","FR-Chart-Chart_3D":"","ChartF_IsFilled":"","TopDownShade":"","JSShow":"","Privilege-No_Such_Authority":"","FS-Generic-Shared_To_Me":"","ID":"","English_Language":"","Chart_Gantt_Error_Check":"!","Utils-Move_To":"","FR-Designer-Basic_More_Color":"","FR-Designer_Verify-Message":"","Light_Orange":"","I-HBarStyle_3DPercentageStack":"","FR-Designer_open-new-form-tip":"711","FS-Generic-Simple_Tue":"","Chart-LatLngOrder":"","Top":"","Plugin-ChartF_Thumb":"","DS-Relation_TableData":"","ChartF-Interval_Label":"","Utils-This_name_has_been_existed":"","Preference-Support_Default_Parent_Calculate":"","Plugin-ChartF_FillColor":"","Task_Name_Exist":"","BindColumn-Specify_Rows":"","Plugin-ChartF_Layer_Midnight":"","FR-Designer_Allow_Blank":"","Should_select_an_Excel_file":"Excel","WEB-Pagination_Setting":"","Event-aftertoexcel":"Excel","Max_Value":"","Refresh":"","Hyperlink-Web_link":"","I-RadarChartStyle_LineMarker":"","Chart-Unit_Million":"","FS-Generic-Simple_Username":"","FR-Designer_ChartF-Transparency":"","Chart-Series_Index":"","FRFont-Foreground":"","Reverse-Scale-Value":"","__ISDEBUG__":"","Property":"","RP_View_Task":"","Unit_Ten_Million":"","Widget-Custom_Widget_Config":"","Function-Function_Class_Name":"","ChartF-Data-Field_Value_AS_Series":"()","Chart-Category_Index":"","ISEMPTY":"","Image-Select_Picture":"","Adaptive_Full_Area":"","ReportServerP-Congratulation_Email_Test_Success":"","FS-User-Empty_Department":"","Reg_Max_Length":"","FR-Chart-Type_Comb":"","Datasource-Datasource-name":"","Chart_Discard_Null_Cate":",","Datasource-Whole":"","Form-Edit_Text":"","Plugin-Chart_Style":"","FR-Designer_Form-Object":"","FS-User-Add_Position_Failure":"","ChartF-PIE":"","NoLimit":"","Hgap":"","DoSelectPosition":"","Output_Word":"Word","Widget-Array":"","FR-Engine_RP_Last_Node":"","Record-Number":"","Preference-Pagination_Line_Color":"","Banner-And-Title":"","Plugin-ChartF_Preview_Custom_Custom":"","SQLWizard-edit_condition":"","FR-Engine_Height":"","Attach_File":"","NO":"","Default_ParameterWindow_TextWidth":"","FR-Engine_Fail_To_Select_A_Data_Field":"","feedback_tip":"400","Data_range_configuration":"","Rename-Block":"","Formula_Dictionary_Display_Example":" =range(100), $$$ =0 - $$$\n1, 2, ..., 100, -1, -2, ... , -100","Phone":"","Record":"","OK":"","FS-User-Same_Department":"","Plugin-ChartF_CustomDrillMap":"","FS-Generic-Simple_Wrong":"","Registration-Basic_Edition":"","No":"","FR-Basic-Email_Sending":"","Tue":"","Button-Hotkeys":"","fs_process_one_time_task_tip":"","ReportServerP-Browser":"","FR-Engine_Task_Name":"","ThreeD_Column_Chart_Horizontal":"()","FR-Engine-Value_Not_Match":"","FR-Designer_Values-Editor":"","Application_name":"","Layer_Corresponding_Map":"","Utils-Move_Up":"","FS-Schedule-Simple_Execute_Time_Unit_Minute":"","FS-Generic-Server_Address":"","Plugin-ChartF_MinDiameter":"","FS-Schedule-Output_Different_Content_By_Different_User":"","ProcessName":"","Or":"","Tree_Data_Field":"","Privilege-Selected_None_Of_Any_Items":"","ExpandD-Father_Cell_Setting":"","Utils-Beyond_the_top_side_of_Border":"","Chart-Interact":"","Parameter-Dealwith_Parameter_Result":"","DashBoard-DashBoard":"","FR-Engine_Bottom":"","schedule_email_tip_first":"","Plugin-ChartF_Level_Number":"","FR-Engine_PDFPrint":"PDF","BindColumn-Have_Left_Parent_Cell":"","Chart_Null_Value_Diaplay":"","FR-Engine_Cpt_Backup_Sure":"","no-alternatives":"","FR-Chart-Data_Filter":"","ChartF-SecondAxis":"","ChartF-Category_Axis":"","SyncFailed":"","FS-Module-Look_And_Feel_Config":"","Utils-Append_Column":"","Chart_Gantt_ErrorTip1":":","FS-Report-Input_Link_URL":"","FR-Chart-Map_Shijiazhuang":"","Privilege-The_Role_Config_Can_Not_Be_Null":"","FR-Base_September":"","FR-Engine_Plugin_Finerest_Addon":"","RP_Pass_After_All_Operations":"","Plugin-ChartF_ZoomType":"","FR-Engine_Short-Apr":"","FS-Generic-Simple_Layout":"","LOG-Has_Been_Openned":"","Unload_Check_Msg":"","Plugin-ChartF_Custom_Height":"","FS-Reg-Function_List":"","Writer_ShortCuts_Setting":"","FR-Chart-Map_Xianggang":"","__locale__":"","Set_Row_Title_Start":"","Title_Start_ColumnOrRow":"","Need_Min_Value":"","File_Is_Being_Used":"","HF-Are_you_sure_to_delete_it":"","RP_Report_Deadline":"","FR-Designer_Covered_All":"","Privilege-The_Authentication_Can_Not_Be_Null":"","FR-Chart-Axis_labelWrap":"","Other":"","FR-Engine_Export-Excel-Simple":"","Label":"","FS-Schedule-Please_Enter":"","Delay":"","FR-Designer_Quarter":"","FS-Schedule-Restart_Policy":"","BindD-Define_Datasource":"","INFO-Time_Taken":"","PageSetup-Top_to_bottom":"","FS-Schedule-Output_Attach_Type":"","To":"","M_Edit-Clear_Contents":"(C)","FileNameForDownload":"","FS-Frame-Button_Unstar":"","Alignment-Style":"","ShanghaiInCity":"","Free":"","FS-Privilege-Simple_Setting":"","FS-User-Reset_Password_As":"123456","ReportD-Export_Hided_Column":"","BackgroundTexture-Walnut":"","Up":"","PageSetup-Orientation":"","FS-System-Config_Auto_Backup_Once":"","ChartF-Size":"","FS-Setting-Image_Only":"","Preview_ToolTips":"","System":"","ChartF-Descriptor":"","Chart-Property_Table":"","Utils-The_private_table_has_been_existed":"","Tree-Select_Leaf_Only":"","Utils-Available_Columns":"","Zhejiang":"","Chongqing":"","ClassName":"","M-Help":"","SUMMARY_MODE":"","Utils-Available_DataSets":"","Set_Legend_Sytle":"","FR-Engine_Short-Aug":"","Printer-Defined_Printer_Groups":"","fs_initDragBar_subpro_tip":":","Widget-Form_Widget_Config":"","Scope":"","Utils-Current_Sheet":"Sheet","Filter":"","Print_copy":"","RP_Send_Time":"","FR-Engine_Number":"","FS-System-Config_backup_Frequency_Sixmonths":"6","FS-Report-Link_Path":"","Utils-User_Definition":"","FS-PSqlInj-Custom_Forbid_Word":"","Err-The_number_is_less_than_the_minimum_value":"","BindColumn-Results_Filter":"","Usable_ParameterList":"","ChangChunCity":"","Datasource-SQL":"SQL","Chart_Current_Value":"","Blow_set":"","FS_Table_Rename":"","Display_Modes":"","FS-Generic-Simple_Previous":"","D-HotHyperlink":"","Plugin-ChartF_StepLine":"","HF-Center_Section":"","Traditional_Chinese_Language":"","FR-Chart-Radar_Van":"()","FR_FS-Task_Has_Been_Closed":"","Widget-Load_By_Complete":"","FR-Designer-Plugin_Install_Successful":"","PLEASE":"","FR-Chart-Data_Use":"","Always":"","MainGraduationUnit":"","RP_Authority_Edit":"","Define_Filter":"","FS-System-Time_To_Idle_Seconds":"","FS-Reg-Version_Info":"","ThreeD_Percent_Stacked_Column_Chart":"","FR-Chart-Map_Normal":"","FS-Setting-Background_Img":"","Offline-ReadMe":"html\r\n\r\n\r\n(Cookie)","FR-Engine-NS_export_excelFormula":":1110 Exel","FR-Engine_RP_Timed_Write":"","FS-System-Send_Test_Mail":"","Brown_Orange":"","Cannot_Do_This_Command_When_You_Choose_One_More_Areas":"","Utils-Global_Parameters":"","Chart-Stock_Open":"","FS-CustomStyle_Toast_Restart":"","Utils-Beyond_the_left_side_of_Border":"","Event-afterverify":"","FR-ConditionB_Operator":"","NS_exception_noTemplate":":1304 ","FR-Engine_Frozen":"","FR-Engine_Close":"","Schedule-Template_File":"","Day":"","FR-Designer-Plugin_Manager":"","FR-Engine_Style":"","FS-Generic-Simple_Day":"","Form-Height_Des":"","Attributes":"","DashBoard-NewTemplate":"","Plugin-ChartF_Line":"","FS-Generic-Simple_Expression":"","Plugin-ChartF_Preview_Custom_Area":"","FR-Engine-Verify_Verifying":"","Hyperlink-Self_Window":"","HighLightChart":"","timePoint":"","FS-Generic-Simple_Schema":"","Widget-Data_URL":"URL","FR-Base_Widget_Error_Mark_Text":"","FR-Engine_Function_RemoteDesign":"","NanningCity":"","FR-Engine-Verify-Verify_Success":"","Email_sentEmail":"","QRCode_Config":"","PageSetup-Overlap_Content":"","ConditionB-OR":"(OR)","TrueExtraRunTimes":"","FR-Engine_RP_Process_Created_By_Me":"","Widget-Comb_Widget_Report_Path":"","Edit-Row_Count":"","Layout_Container":"","FR-Engine-Import_Again":"","Plugin-ChartF_After_Period":"","FS-Mobile-Add_Device_With_Whitespace":" ","FR-Engine-Tip_Tooltips":"","FS-Generic-Email_Can_Preview_Report_Content":"","Plugin-ChartF_Alpha":"","Message":"","Poly":"","FR-Engine_RP_Execute_Month":"","ChartF-Up":"","Sche-Monday":"","RWA-Smart_Add_Cells":"","Openning":"","Layer_Report_Warnning_info":"<html><br/><br/><\/html>","Report-Write_Attributes_Msg":"","FR-Chart-Map_Nanjing":"","FS-Generic-Sign_In":"","Utils-Current_Cell":"","Until":"","zeroMarginWarn":"<br><br>.<br>&nbsp","HF-Insert_Time":"","From":"","Plugin-ChartF_Hinge":"","Deploy-Help":"","Connectionline":"","FR-Designer_Fit_Default":"","Summary":"","FR-Base_Help":"","TableData_Query":"","Idle_Connection_Size":"","FR-Chart-Custom_Map":"","Gansu":"","FS-Plugin-Store_User_Not_Exist":"","FR-Engine_Fit-Bidirectional":"","NOT_NULL_Des":"","Hubei":"","Parent-Directory":"","FR-Designer_layerIndex":"","FS_Start_Date":"","Parameters":"","Default_Data_Connect":"","MConfig-User_Defined_Designer":"","Saving":"","FR-Engine_RP_Everyday":"","BindColumn-Have_Father_Cell":"","Form-Change_Widget_Name":"","Plugin-ChartF_Preview_Area_Map":"","FRFont-Pick_A_Color":"","Database_User":"","ServerdatasourceSameWarning":"","SQLWizard-unpack_all_entities":"","check_communication":"","FR-Please_Rename":"","Chart-White_Black":"","FR-Chart-Bit_Map":"","Function-Function_Name_is_Null":"","NO_Border_Line":"","Form-NameWidget-Invalid":"","Plugin-ChartF_Show_Data_Sheet":"","formDesignerModule":"","FR-Chart-Add_Series_Setting":"","FS_Report_Type":"","DashBoard-ChartRecord":"","FS-User-LDAP_Authentification":"LDAP","Platform-Table_Create_Failure":"","ChartF-Close":"","Plugin-ChartF_Auto_Adjust":"","FS-System-Simple_Deal":"","Plugin-ChartF_Cabin":"","FS-Generic-Hour_Wrong":"","Plugin-ChartF_CustomFloatPosition":"","FR-Designer_Form-Widget_Name":"","RP_All_Tasks":"","Report_Query_Result_AS":"","FR-Designer_Is_Share_DBTableData":"","FR-Chart-Map_Changsha":"","Plugin-ChartF_Marker":"","M_Window-Unfrozen_WindowGrid":"(F)","FR-Engine_RP_Overtime":"","FormulaD-Reserve_when_export-edit_result":"/,","Datasource-Public_Datasource_Manager":"","Father":"","ServerM-Predefined_Styles":"","ExpandD-Not_Expand":"","FR-Chart-TimeUnit_Day":"","Port":"","has_saved":"","FR-Engine_Minute":"","Form-RadioButton":"","FR-Engine-Condition_Less_Than":"","Call_Back_Function":"","Adaptive":"","Event-afterflashprint":"Flash","Chart-Series_SingleData":"","FR-Designer_Fit-In-App-Tip":"App","FS-Report-Folder_Already_Exist":"","FR-Engine_Short-Sep":"","eg":"","ECP_re_input":", ","Delete_Button":"","HJS-Print_Failed":"","Chart-SetSecondGridStyle":"","Widget-Parameter-Name":"","formModule":"","Reportlet-Parameter_Type":"","DS-Real_Name_<->_Display_Name":" <-> ","FS-Schedule-Task_Name":"","FR-Designer_Name_has_Colon":"","MultiFileUpload":"","ECP_encode_failed":", ","FR-Export_SVG":"SVG","Need_Purchase_Info":"","FS-Plugin-Store_Enable":"","Show_Blank_Row":"","Schedule-Duplicate_Task_Name":"","FR-Engine_Rename":"","Number":"","FR-Engine_Filter":"...","LayerPageReport_WN_CellPage":"","FR-Engine_ViewPreview":"","FR-Plugin-Designer_Trial":":","FS-Reg-Simple_Deadline":"","Corresponding_Layer":"","Post":"","FR-Base_Sun":"","ChartF-Meter_Angle":"","Plugin-ChartF_Preview_Funnel":"","FR-Engine-NS_export_wordPageSize":":1114 WordSheet","Can_not_find_Data_Connection":"","FR-Designer_Form-CheckBox":"","FS-Report-Edit_BI":"BI","ConditionB-is_greater_than_or_equal_to":"","FS-Schedule-CPR_SUCCESS":"","Form-Object":":","FR-Engine_Role_Source":"","FS-Admin-My_Info":"","Sche-Second":"","triggered":"","M_Format_A-Cell_Attributes":"","Chart-Interactive-Tab":"","Auto_Adjust_Size":"","Chart-Plan_End":"","Plugin-ChartF_Width":"","File_Display_Name":"","__FILENAME__":"","PopChart":"","Please_Input_The_Key":"key","FR-Engine_ConditionB-in":"","Chart-Use_Local":"","Log_Level_WARNING":",","FR-Engine_RP_Process_Type":"","Position":"","Plugin-ChartF_LineMap":"","is":"","FS-Generic-Simple_Cancel":"","FS-Plugin-Store_Not_Official":"","Undo":"","APP_LAUNCHING":"APP","Plugin-ChartF_StartAngle":"","Server-version-warging":"\"  \"","Unregistered":"","FS-Frame-System_Menu":"","Chart-Area_Value":"","FR-Engine_Total":"","FS-User-Password_Reseted":"123456","FR-Base_Error_Input_Value":"","ChartF-Units_And_Needle":"","M_Format-Remove_Row":"(R)","FR-Engine_ConditionB-Conditions":"","M_Report-GroupReport_Attributes":"(G)","FS-Plugin-Store_Password":"","FS-Generic-Simple_Info":"","FS-Module-MobilePush_SureIGT":"","FS-System-Resources_root_directory_name":"","sending":"...","HJS-All_Pages":"","TaskEndWhenOneTime":"","Top_And_Thick_Bottom_Border_Line":"","FS-Privilege-User_View":"","Use":"","FS-Schedule-Output_Attach_Class_Name":"","Chart_OffSetPecent":"(X1/12)","FR-Base_sure_remove_item":"","FS-PSqlInj-Forbid_Word_Error":"SQL","FR-Engine_Receiver":"","Email_Des":"email","Plugin-ChartF_Preview_Custom_Drill_Map":"","Chart_Light":"","Schedule-New_Task":"","FR-Designer_Undo":"","FR-Base_Sche_Sunday":"","Hyperlink-Use_CJK_to_encode_parameter":"CJK","FR-Designer_Fit_No":"","Unit":"","Re-version-in-lic":"lic","Read":"","ReportColumns-Begin_at_Row":"","Web_Preview_Message":"","Real":"","FS-Generic-Simple_Skip":"","Utils-Append_Row":"","MConfig-CompanyName":"","Plugin-ChartF_Preview_Stack_Bar":"","Form-Double_quotes":"","Dictionary_Name_Has_Exsited":"","FR-Engine-Condition_In":"","Plugin-ChartF_Map_Data":"","FR-Engine_Remove":"","Utils-Report_Name":"","FR-Engine_Offline-Write":"","Load_Resource_File":"","Utils-Click_the_left_plus_button_to_add_item":"","Only Use Before":"","FR-Engine_RP_To_Check":"","Form-Cut":"","Chart_Alert_Tip":"","FR-Engine_Get_Lock":"","FR-Engine_RP_Send_Offline_Report":"","PageSetup-Resolution(PPI-Pixel_Per_Inch)":"(PPI-)","Widget-Widget_JS_Path":"JavaScript","Layer-Generated_Pages":"","DashBoard-Dateunfurl":"","Date_Time_Attention":"MM/dd/yyyy HH:mm:ss","Chart_DiscardOtherCate":"","FR-Base_Margin":"","Utils-has_been_existed":"","FR-Engine_Upload_Progress":"","FR-Chart-Meter_Field":"","This_ScheduleAction_Cannot_Be_Viewed":"","Chart-Chart-Title":"","Numbers":"","Perspective":"","FS-Schedule-Start_Time":"","Service_Phone":"","Plugin-ChartF-Custom":"","HF-Undefined":"","FR-Engine_Excel_Submit_Rights_Assignment":"","Click_To_Shrink_Panel":"","ExpressionSet":"","Plugin-ChartF_Map_Init_Status":"","Local_offset":"","Gradation":"","Event-beforeappend":"","PM-Privilege_Setting":"","Utils-Font_Not_Found":"","Image-Layout":"","FS-Monitor-Visited_Report":"","Selection-Filter":"","Chart-DataFunction_Percent":"","FR-Base_Sat":"","HotHyperlink-No_Hot_Hyperlink":"","FS-Report_Management-Directory":"","Plugin-ChartF_OpenLargeDataModel":"","px":"","FS-Plugin-Store_Jar_Damaged":"Jar","PageSetup-Start_Column":"","FineReport_Embbeded_Report_Server":"FineReport","FR-Designer_Form-CheckBoxGroup":"","Actual_Value":"","FR-Engine_RP_Sender":"","January":"","DBCP_INITIAL_SIZE":"","Plugin-ChartF_Preview_Line_Map":"","Guangdong":"","FR-Plugin-Designer_Expired":"","Utils-Flash_Print[Client]":"Flash[]","FR-Basic-File_Uping_File":"","ParameterD-Parameter_Interface":"","FR-Chart-TimeUnit_Hour":"","FR-Engine_Cell":"","Indent-Pixel":"","Unit_Million":"","Server_Charset":"","FR-Widget_Mobile_Terminal":"","Optionns":"","Filed":"","LIC-Support_Parameter_Interface":"","ExpandD-Rules_to_Find_Default_Father_Cell":"","ChartF-Background_Color":"","FR-Engine_Export_Excel_PageToSheet":"Sheet","Anhui":"","FR-Base-Plugin_Error_Message":" [{R1}] ","FS-Reg-Machine_Code":"","FS-System-Report_Message":"","Embed_User":"","Datasource-The_name_of_database_cannot_be_null":"","FS-Schedule-Define_Class_Name_Not_Null":"","ConditionB-begins_with":"","Datasource-Rename_remedy_datasource":"Remedy","Is-Cache":"","Loading":"","email":"","Plugin-ChartF_Sort":"","Re-binding-mac":"licmac","StyleFormat-None":"","Platform_Roles_Has_Changed":"","Preference-Support_Cell_Editor_Definition":"","Show_Grid_Row":"","Short-Oct":"","Chart_Second_Plot_Pie":"","FS-Privilege-Already_Set":"","I-AreaStyle_Normal":"","NS_LayerReport_present":":1103 ","Plugin-ChartF-FirstShowLegend":"","FS-Mobile-Need_User_Name_And_Mac_Address":"MAC","SingleMulti":"","WuhanCity":"","writeModule":"","FS-Schedule-Output_Attach_Class_Deal":"","Registration-Company_Name":"","CheckBoxField":"","Set_data_fields":"","BorderLayout":"","Formula_Dictionary_Display_Examples":"  =range(100),\n $$$ =0 - $$$\n 1, 2, ..., 100, \n -1, -2, ... , -100","FS-Admin-Simple_Account":"","Use_Current_Configuration":"","ConditionB-not_null":"","Layer_Report":"","FS-Plugin-Store_Integrate_Deployment":"","Event-writesuccess":"","ProcessStartedBySelf":"","Event-writefailure":"","EditRC-Entire_row":"(R)","Polyblock-Fixed_Height":"","FR-Chart-CopyJS_Message":"JS","StyleAlignment-Right":"","FS-Monitor-Templet_Lifecycle":"","FR-Engine_Deselect_All":"","FR-Designer_Utils-Available_Columns":"","Currency_Line":"","ChartF-Default_Style":"","Form-Same_Height_Des":"","SingleLayer":"","FR-Designer-LayerPageReport_Define_CustomCountQuery":"SQL","FR-Designer-Basic_Cancel":"","Deploy-Official-Website":"","Export-Template(embedded_data)":"()","FR-Designer_Form-RadioGroup":"","Ecp_Pwd_Long":"","FS-System-Messages":"","Integer":"","DashBoard-ReportShowPlatform":"","StyleFormat-Date":"","FS-Schedule-Frequency_Label_Width":"50","Importing":"","System_Status":"","FS-Frame-Full_Screen_Tip":"API","FR-Engine_Year":"","Multiline":"","Import2":"","FR-Basic-File_Upload":"","Datasource-Add_DataConnection":"","Compart":"","FR-Designer_Https_Enable":"https","ChartF-TheActualStart":"","Create_Cross_Report":"","FR-Chart-Map_Kunming":"","Chart_Show_Data_Sheet":"","ChartF-Interval_Range":"","CacheValidateTime":"","CellWrite-Hide_Column_If_Null":"","ChartF-Range_Axis_Increment":"","FR-Engine_Abnormal_Communication":"","FS-Privilege_Report_Tool_Margin":"10","LIC-Support_Advanced_Chart":"","FR-Designer_DisplayNothingBeforeQuery":"","ChartF-Label_Count":"","No_Processor":"","HF-Edit_Footer":"","SQLWizard-add_where_condition":"WHERE","DBCP_TIME_BETWEEN_EVICTIONRUNSMILLIS":"","Plugin-ChartF_Preview_Line":"","Show":"","FR-Engine-Excel_formula_error":"","FR-Chart-Axis_labelInterval":"","FR-Chart-Map_LayerData":"","LOG-Is_Being_Openned":"","M-Open_Recent":"","FR-Engine_Please_Enter":"","Report_Engine":"","Plugin-ChartF_NewMultiPie":"","FR-Engine_Show_All_Remaining_Values":"","FS-Generic-Simple_Upload":"","Chart-Manage_Chart_Type":"","Widget-Disabled":"","Hyperlink-Width_Of_New_Window":"","ChartF-Down":"","Table":"","FR-Remote_File_is_Locked":"","FR-Engine_Block_unextended":"","RP_Add_MultiNode":"","Custom":"","ConditionB-in":"","FS-Generic-QRCode_Config":"","Switch-Form-Mode":"","Model":"","FS-Monitor-Templet_name":"","FR-Chart-Map_Chengdu":"","FR-Chart-Map_Shenyang":"","VerticalBoxLayout":"","FR-App-Privilege_No":"","ConditionB-does_not_begin_with":"","Printer":"","FR-Chart-ThreeD_Custom_Chart":"","Tick Interval":"","Datasource-Datasource":"","Log_Declare_Head_Res_Read":"","chartModule":"","Hyperlink-New_Window":"","PaperSize_Rotate":"","Privilege-Your_Authentication_Can_Not_Access_The_Reportlet":"","FS-Monitor-Visit_Start_Time":"","I-BarStyle_3DStack":"","M_File-Export-Text":"()","FR-Engine_PageSetup-Orientation":"","Character":"","Basic_Information":"","BindColumn-Control":"","FR-Chart-Use_Name":"","DBCP_MIN_IDLE":"","FR-Base_Sche_Hour":"","FR-Engine_SQLWizard-would_you_like_to_continue":"","FS-CustomStyle_Module":"","Meter_Single":"","Preference-Setting_Visible":"","FR-Engine_Seriously":"","Plugin-ChartF_Car":"","FR-Designer-Plugin_Update_Successful":"","FR-Engine_Database":"","Schedule-Rename_Task":"","StyleAlignment-Vertical_Text":"","ChartDataLabelOutSide":"","Sche-Saturday":"","Export-Excel-PageToSheet":"Sheet","FR-Engine_NS_print_flashPaperSetting":":1118 Flash","This_Parameter_Is_Not_Exist":"","ReportColumns-Columns_horizontally":"","Chart-PreStyle":"","Plugin-ChartF_NotLimitAreaSize":"","Utils-Column_Serial_Number":"","ReportD-Excel_Export":"","pageModule":"","Web_Preview_Port_Setting":"","StyleAlignment-Text_Rotation":"","Privilege":"","FR-Engine_ConditionB-AND":"(AND)","DBCP_VALIDATION_QUERY":"SQL","FR-Chart-Map_ShowWay":"","FS-Schedule-Server_Address_Not_Null":"FTP","FR-Chart-Map_Column":"","Form-No_Selected_Will_Be":"","WLayout-Border-LayoutContainer":",","SQLWizard-add_to_group_by":"group by","invalid user or password.":"","RP_Send_Offline_Report":"","FR-Engine_Mobile_BI":"","ReportletParameterTip":"Category, : Series, Value ","Mail-Copy_Adress":"","FS-Plugin-Store_Plugins_Count":"","Percent_Stacked_Bar_Chart":"","Plugin-ChartF_Gauge_Ring":"","FS-Reg-Concurrent_Ip":"IP","FS-Setting-Login_Option":"","ManagerSystem":"","Plugin-ChartF_Mid_Tree_Map":"","FR-Designer-Basic_Copy_Build_NO":"","Query_Type":":","FR-Base_Tue":"","Error_With_Non_Template":"","Related":"","Function-Function_Manager":"","RP_Add_Task":"","Plugin-ChartF_Layer_Map_Type":"","Event_Name":"","FrequencySet":"","Forbid_Drag_into_Para_Pane":"","FR-Base_Post_Meridian":"","File-Default_URL":"","InnerRadis":"","I_Created":"","FR-Base_Sche_Wednesday":"","FR-Designer_JavaScript":"JavaScript","Plugin-ChartF_Html":"html","ImportMap":"","Axis_Title":"","Note_Normal-Formula":"","FS-Generic-Server_Name":"","Chart_Main_Grid":"","Printing":"","SetLoginPage":"","I-HBarStyle_NormalStack":"","Plugin-ChartF_Gauge_Slot":"","ShijiazhuangCity":"","FR-Engine_PageLayerReport":"","D-Step":"","INFO-Try_to_set_the_port_of_the_server_to":"","FS-Setting-Color_Scheme":"","Plugin-ChartF_Automatic":"","Start":"","Apply":"","Plugin-ChartF_XYAxis":"XY","FR-Designer-Plugin_Please_Update_Jar":"Jar:","FS-Generic-Simple_November":"","Datatype":"","StyleAlignment-between_-90_and_90":"-9090","FS-PSqlInj-Remove_Custom_FW":"","CLUSTER_REDIRECT_SHEAR":"","MostTimeRestart":"","Chart_Trend":"","Dialog":"","Chart-DataFunction_None":"","FS-Schedule-Execute_Repeat_Simply":"","Plugin-ChartF_AntiClockWise":"","FR-Engine_Detail-Message":"","SQL-Table":"","FS-System-Email_Encrypt_SSL":"SSL ","FR-Designer_Utils-Move_Down":"","Add_Position":"","FS-Generic-Simple_Run":"","Select-Color":"","State":"","Report_Show_Location":"","External":"","Function-The_class_must_inherit":"","Utils-File_name":"","M_Server-Server_Config_Manager":"","Chart_LinePlot_Should_Select_One_In_Line_Or_Marker":"","Saved_Connection_Count":"","FR-Engine_PrivilegeControl":"","Parameter-String":"","Plugin-ChartF_MonitorModel":"","X_Axis":"X","ParameterD-Parameter_name_cannot_be_null":"","I-PieStyle_3D":"","Utils-Template_File":"","FS-System-FlashP_Need_Settings":"Flash","Min_Value":"","Event-afterinit":"","FR-Base_SimSun_Not_Found":", .","FS-User-Add_User":"","Form-Url":"","Report":"","Admin":"","FS-Schedule-Start_Date":"","Plugin-ChartF_AxisVerticalZero":"0","FS-User-Authorized_Users":"","Guangxi":"","Report_Path":"","FS_BI":"","Aomen":"","Collect-Successfully":"","FR-Basic_About_No_Build":"","Values":"","Values-Editor":"","FR-Designer_Email":"","RP_Alert_Setting":"","Enter_Login_Page_URL":"url","FR-Chart-Map_Use_Field":"","Plugin-ChartF_Preview_MultiPie":"","SQLWizard-pack":"","Enter_Task_Name":"","Form-Widget_Name":"","Mail-Send_Adress":"","PageSetup-Start_Row":"","Privilege-Post_List":"","Utils-Column_Name":"","Chart-Layout_Position":"","Form-Split_Horizontal":"","Plugin-ChartF_Preview_Custom_Column":"","CanNotBigger":"","FS-Report-RP_MyTask":"","FR-Chart-Map_Beijing":"","Utils-Can't_Paste_to_Uneditable_Area":"","Colors":"","Chart_Curve":"","Build_Tree_Accord_Marked_Filed_Length":"","I-HBarStyle_PercentageStack":"","Layer_Report_alert_info":"","Finally":"","Hide":"","FS-User-Synchronized_DataSet":"","CellWrite-Print_Border":"","Organization":"","ConditionB-Conditions":"","Choose_columns":"","Plugin-ChartF_AxisProportion":"","XML_XPath_Message":"","FS-Setting-Homepage_Exists":"","GridLayout":"","M_Insert-Serial_Number":"(S)","Datasource-Connection_successfully":"","FR-Base_Right":"","FS-Module-Server_Setting":"","ReportColumns-Columns":"","FR-Base_Remove":"","FS-Monitor-Model_Process_Export":"","FR-Designer-Plugin_Has_Been_Installed":"","Default":"","FS-Generic-Simple_February":"","FS-Generic-Create_QRCode":"","Plugin-ChartF_JiangSu":"","M_Edit-Cut":"(T)","Dic-Only_Can_Rename_DataDictionary":"","FS-Report-Edit_Cpt":"","D-DataSeries":"","Email-Can_Preview_Report_Content":"","PageSetup-inches":"","Schedule-Reportlet_Group":"","DashBoard-Potence":"","fs_initDragBar_circle_tip":":,","Plugin-ChartF_AxisLineStyle":"","FR_Chart-Data_Range_Configuration":"","Docking-Pinned_Mode":"","FR-Base_Top":"","FS-Privilege-Department_And_Post":"","ConditionB-equals":"","M_Insert-TextBox":"(B)","Datasource-Add_Directory_of_hibernate.cfg.xml_to_Classpath":"hibernate.cfg.xmlClasspath","About-Version":"","Datasource-Text_datasource":"","FR-Engine_By-PageSize-False":"","Selection-Background":"","Text_IsVertical":"","ChartF-Alert-Line":"","Chart_Test":"","ExecuteOneTime":"","Event_Set":"","3DSimulation":"","FS-Schedule-Output_Push_Message":"","Chart-Chart_Title":"","DashBoard-Adhoc":"","FR-Engine_NoLimit":"","FS-Process-colon":"","M_Insert-Cell":"","DBCP_MAX_IDLE":"","Field_Filtration":"","Auto":"","FR-Engine_Closed":"","Sche-Month":"","ParameterD-DClick_Edit":"","FR-Engine_RP_Page_Write":"","The_file_is_already_slected.":"","FR-Chart-Dialog_OK":"","FR-Engine_WriteModule":"","Add_summary_info":"","ExecuteFrequency":"","High":"","FR-Plugin-Designer_Left":"","Dic-Choose_Database_And_Table":"","LogarithmicValue":"","Chart-Link_Mail":"","Report_Is_Being_Openned":"","Web-The_selected_directory_must_be_named_WEB-INF":"","Image-Titled":"","PrintFile":"","FS-Generic-Turn_Off":"","Plugin-ChartF_CategoryAxis":"","FormulaD-Invalid_Formula":"","FR-Plugin_Preview":"","Parent_Marked_Field":"","FS-PSqlInj-Remove_Custom_SC":"","LIC-Support_Dynamic_Chart":"HTML5","Chart-Stock_High":"","FR-Engine_Black-Font":"","FR-Plugin_Fit":"","Background-Over":"","JavaScrit-Asynch":"","Select_sort_order":"","Reportlet":"","FS-Reg_Version_Registration":"","Chart-Data_Resource":"","FS-Privilege-Digital_Sign":"","Plugin-ChartF_XiZang":"","FS-Schedule-Trans_SUCCESS":"","FR-Engine_RP_Timing_Issue":"","FS-Generic-Face_Write":"","Disk_File":"","Plugin-ChartF_Preview_Thermometer_Gauge":"","FR-Engine_Click_To_Get_Registration_Code":"","Running":"","FR-Chart-Version_Lasted":"","ChartF-CHORD":"","InColumn":"(L)","JavaScript_Set":"JS","FR-Base-Time_Second":"","Plugin-ChartF_TextRotation":"","Datasource-Add_Database":"","ReportServerP-PDF":"PDF","RestartByCondition":"","FR-Plugin_Edit-Global":"","FS-Plugin-Store_Day":"","FR-Designer-Plugin_Install":"","Chart-Use_Zoom":"","plugin-ChartF_FloatColor":"","FS-Setting-Navi_Upload_Tool_Tip":"42*42","System_default":"","FS_End_Date":"","HTML-Write_Insert_Data_Successfully":"","Window":"","Plugin-ChartF_Gradual_Light":"","Gradient":"","FS-CustomStyle_Toast_Error":"","Trillion":"","Connection":"","Chart_Log_Base":"","M_Edit-Send_to_Back":"(K)","Formula_Dictionary_Display":"($$$)","Data-Check":"","FR-Engine_Import_Failed":"","Reportlet-Schedule-Action":"","FR-Designer-Support":"","SingleOne":"","FS-Plugin-Store_Form_Components":"","ReportD-Report_Export_Attributes":"","Row-Fields":"","I-PieStyle_Normal":"","FR-Engine_ECP_encode_failed":", ","Cache-Disk_Memory_Page_Size":"","T_Insert-Float":"","Sort-Original":"","FR-Chart-Map_Hefei":"","Report_Template":"","M_Window-Title_Horizontal(H)":"(H)","FS-Web-Plugin_Jar_Expired":"Jar","FS-Generic-Task_Name_Exist":"","Web-Please_input_parameter_vlaues":"","ChartF-Percentages_Format":"","Form-Copy":"","FR-Designer_ChooseOneButton":"","FR-Base_Thu":"","FR-Designer-Widget_Size":"","ChartF-Marker":"","FR-Engine_RP_Unfinished_Task_Name":"","Select_Data_Set":"","FR-Designer_filedChosen":"","FS-Process-Package":"","M-Save_As":"","Is_Share_DBTableData":"","StyleAlignment-Degrees":"","Event-afterimportexcel":"Excel","Brown":"","FS-System-Simple_Settings":"","Env-Configure_Workspace":"","FS-Report-Simple_Named":"","Plugin-ChartF_Drill_Dir":"","FR-Designer_Env-Des1":"WEB-INF","FR-Engine_RP_After_Use":"","Chart_HorialTimeAxis":"()","FR-Report_Invalid_Cell":"","Password":"","Page_Setup":"","Compile_Success":"","FR-Engine_ConditionB-does_not_end_with":"","FS-Generic-Simple_Open":"","Continent":"","Privilege-The_User_Service_Can_Not_Be_Null":"","Border-Style-Radius":"","FR-Designer_Form-Password":"","I-PieStyle_3D_Seperate":"","FS-Schedule-Please_Select_Weekly_Execute_Time":"","FS-Plugin-Store_No_Plugins":"0","HF-Insert_Image":"","schedule_email_tip_second":"","FR-Action_Remove":"","FR-Engine_Create_Time":"","GroupReport-Set_Page_Footer_To_Page_Bottom":"","PageSetup-Title_Start_Column":"","Preference-Setting_Grid":"","Plugin-ChartF_WidgetBoundary":"","FS-Schedule-Select_True_Interval":"","ChartF-Show_values":"","FS-Schedule-Output_Mount_Virtual_Directory":"","Form-Button":"","RWA-Submit":"","Group_name":"","NS_LayerReport_MultiDs":":1101 ","FR-Designer-Plugin_Plugin":"","FR-Chart-Map_Changchun":"","FR-Engine_NameWidget-Invalid":"","DashBoard-BeautyReport":"","FS-Setting-Login_Style_Plugin":"","Chart_Project_ID":"","Web":"","FS-Plugin-Store_Quick_Login":":","Wed":"","Chart_Interval_Back":"","FS-Report-RP_InputName":"","BindColumn-Choose_The_Display_Type_of_Column":"","Plugin-ChartF_Location_With_AreaName":"","FS-System-Connection_List":"","FR-Engine_Excel_uc_list":":","FS-Report-RP_EditLabel":"","Operating-Parameters":"","FS-Generic-Simple_Sat":"","M_Insert-Sub_Report":"","DataList-Set_Value_Of_DataList":"","HohhotCity":"","FR-Chart-Map_Guangzhou":"","Report-Title":"","Title_End_ColumnOrRow":"","FS-Schedule-Restart_Number_Of_Times_Must_Be_Number":"","FS-System-Memory_Cache":"","FR-Designer_Add":"","Exception_StackTrace":"","Parameter-Design":"","Chart-Style_Name":"","FR-Engine-Should_Select_An_Excel_File":"Excel","FR-Base_Sche_Saturday":"","Report-Body":"","FS-Report-Edit_Link":"","Chart_Title_Is_Visible":"","Bubble-Width":"","SQLWizard-add_to_order_by":"order by","Plugin-ChartF_Filled_With_Image":"","FS-Generic-Simple_Failed":"","ChartF_Stock_Open":"","Detail-Information":"","Background_Settings":"","Chart_Acc_Set":"","Event-statechange":"","Datasource-JNDI_DES":":INITIAL_CONTEXT_FACTORY.jar/lib.","FR-Designer-Plugin_Has_Been_Actived":"","Schedule-Monthly":"","Formula":"","Pitch_Percentage":"","Datasource-Procedurewaring":"!","FR-Engine_RP_Have_Come_To_You_For":"","FR-Designer_WaterMark":"","FS-Generic-DS_Server_TableData":"","FR-Engine-Err-The_Value_Cannot_Be_Negative":"","FS-Generic-Register_Version":"","File-Auto_Upload":"","This_program_is_protected_by_international_copyright_laws":"","DashBoard-QucikAccidence":"() >>","BackgroundTexture-BrownMarble":"","Second_Axis":"","loadedTreeModel":",","PrintP-Previous":"(P)","ChartF-Stock-Volume-Axis":"","ExecuteSimpleRepeat":"","Short-Nov":"","FR-Engine_ReportServerP-Last":"","Chart-Change_Pie_Size":"","TopNavigation":"","Default_ParameterWindow_EditorWidth":"","FR-Designer-Widget-Style_Title_Format":"","Privilege-Password_Can_Not_Be_Null":"","Utils-Set_Default":"","Invalid_Cell":"","Face-Outlook_Structure":"Outlook","PaperSize_ML":"","GisTableDataError":"Gis","BindColumn-Group(Merger":"","FR-Engine_Function_Undefined":"","FR-Chart-Mode_Auto":"","FS-System_View_Detail":"","Only":"","FS-User-No_Encryption":"","FR-Chart-Style_Present":"","FS-Monitor-Global_Properties_detection":"","ChartF-Low":"","FR-Remote_Connect2Server_Again":"?","Cursor_to_next_column":"","Shortcut_Set":"","Border-Color":"","RP_Review":"","Schedule-Weekly":"","Map Show Type":"","Chart-Interactive_AxisTooltip":"","Event-beforeimportexcel":"Excel","RelatedChart":"","BindColumn-This_Condition_has_been_existed":"","Format_explan":"","Left":"","Size":"","M-Chart_Preview":"","FS-Admin-Old_Password":"","Plugin-ChartF_Connecting_WMP":"","FR-Engine_Utils-Print[Client]":"[]","Form-CheckBoxGroup":"","NoticeAndSave":"","FR-Chart-Map_Google":"","Design":"","Single_Close":"","Export-Excel":"Excel","ThreeD_Percent_Stacked_Bar_Chart":"","Template_Path":"","ServletMapping_msg":"\"()://web.xml\"url-pattern","Add_TableData":"","CellWrite-Preview_Border":"","Chart-Data_Import":"","HarbinCity":"","RP_Sure_to_delete_process":"","Utils-Open_File":"","PrintP-Print_Preview":"","Bounds":"","FR-Engine_RP_Creator":"","FR-Designer-Plugin_Illegal_Plugin_Zip_Cannot_Be_Install":"","FR-Engine_RP_Exist_Null_Node":"","Parameter-Float":"","M-Write_Preview":"","FS-Module-Platform_Manager":"","M-Window":"(N)","Week":"","f#Created":"","Chart_Cell":"-","ReportServerP-Show_Toolbar":"","FR-Engine_ConditionB-equals":"","FR-Designer-Plugin_Detecting_Update":"","X_offset":"X","Datasource-JDBC_Datasource":"JDBC","FR-Engine_Excel_uc_failed":":","FS-System-Config_Restore":"","Server-Start":"","ChartD-Chart_DefinitionStep3":"","ChartD-Chart_DefinitionStep2":"","Cursor_to_previous_column":"","ChartD-Chart_DefinitionStep1":"","Simple_general":"","Plugin-ChartF_NewBubble":"","Plane3D":"3D","Hyperlink-Show_Status":"","FS-Monitor_Clean_Successfully":"","FR-Engine_Multi-Privilege":"","Left_Margin":"","FR-Designer_Hyperlink":"","HotHyperlink-Bring_Parameter_Automatically":"","ConditionB-is_less_than_or_equal_to":"","Chart_Time_Interval":"","FR-Base-EX-IP_Address_Overflow":"IP","FS-Generic-Simple_User":"","BindColumn-The_Conditions_of_FatherCell":"","ConditionB-Operator":"","Form-List":"","Printer-Are_you_sure_to_delete_the_selected_printer_group":"","Or-you":"","User_Already_Logged":"","FR-Chart-Style_GradientHighlight":"","Printer-Save_Current_Work":"","ReportWebAttr-General_Css":"","Custom_Button_Message":"button","FR-Engine-Write_Stash":"","FR-Designer_Finish_Export":"","FS-User-Depart_Post_Together":"","FS-Generic-Simple_Print":"","I-AreaStyle_PercentStack3D":"","Plugin-ChartF_TopValue":"","FR-Chart-Server_disconnected":"","Encoding_Type":"","Server-version-tip":"  ","Plugin-ChartF_Preview_Ring_Gauge":"","FR-Engine_Combination":"","FR-Engine_RP_Operator":"","FR-Engine_Error-Tip":"Oops!!!","Re-not-start-in-jar":"JAR.","Utils-Can_not_create_connection":"","Utils-Design-Action_Cancel":"","Language":"","FS-Schedule-Execute_Condition_Custom_Class":"","FS-System-Max_Shared_Datasets":"","DisplayUnit":"","INFO-Current_Role":"","BindColumn-Top_N":"N","M-Popup_ChartData":"","FR-Chart-Style_Fresh":"","Hyperlink-Des1":"B\\S","BackgroundTexture-Canvas":"","Password_Has_Been_Reset_To":"","ChartF-TheActualEnd":"","ReportServerP-PDF2-INFO":"LINUX/UNIX","FS-Generic-Simple_Sun":"","Set_Role_Authorized":"","FR-Base_Sche_Minute":"","FR-Designer_Gradation":"","Fri":"","Multi_nam_formula":"  :                       :","FS-Web-Error_Cannot_Delete_In_War_Or_Cluster":"War.","Summary_Method":"","FS-Monitor-Visitor_User":"","ExpandD-Left_Father_Cell":"","FS-Plugin-Store_Disabled":"","FR-Engine-Not_In_List":"","FR-Engine_sure_to_delete":"","Event-aftertoword":"Word","FS-Schedule-Restart_Time_Gap_Must_Be_Number":"","CellWrite-Page_Before_Row":"","Institution":"","Chart_Needle_Max_Range":"","Continuum":"","Record In Series":"","FS-Module-Look_And_Feel":"","FR-Server-Design_template_unopened":"","RP_Deliver":"","FR-Designer_WidgetDisplyPosition":"","FS-Setting-Simple_Style":"","Get_Lock":"","Taiwan":"","Mail-Contacts":"","Widget-NeedSubmit":"","SpecifiedG-Leave_in_their_own_groups":"","Advanced":"","Docking-Pin":"","Right":"","I-HBarStyle_3DStack":"","tick-and-value":"","FS-System-Platform_Messages":"","Server-Always_Reload_Template":"","Classpath-Add_Folder_to_Classpath":"Classpath","Plugin-ChartF_AxisTop":"","FS-Setting-Login_URL":"","Utils-Check_Data_Consistency":"","Cannot_Set_Duplicate_Role_Name":"","Title_Name":"","Chart-Link_Cell":"-","FR-Engine_ReportServerP-PDF":"PDF","Superio":"","Chart-Black_White":"","Chart_Step_Name":"","Plugin-ChartF_Tooltip":"","trigger":"","CellWrite-Hide_Column_Row":"","FS-System-Date_Time":"","FR-Chart-Type_Meter":"","FS-Generic-Simple_August":"","Utils-Group_Detail":"","FS-Admin-Remember_Username_Password":"","FS_Task_End":"","Plugin-ChartF_ShowAllSeries":"","ChartData-Tooltip":"","FR-Engine_Page":"","Schedule-Please_select_a_directory":"","Chart-Bubble_Value":"","FR-Designer_Root":"","FS-Monitor-Error_When_Read_Template":"XML/","FR-Engine_RP_Execute_Time":"","DashBoard-OpenRecentReport":"","Using_Global_Offset":"","Hyperlink-Configuration_Of_New_Window":"","FR-Chart-Drill_Setting":"","I_Want_To_Set_Single":"","ModifiedColumnName":"","BindColumn-Increase":"","Verify_Error":"","FR-Engine_Short-May":"","Build":"","can_not_include_underline":"\"_\"","Plugin-ChartF_AxisBottom":"","ReportServerP-Import_Css":"Css","Xizang":"","FS-Generic-HF_First_Page":"","Plugin-ChartF_Word_Name_Index":"","Records":"","Edit-Browser-List":"","FR-Engine_Short-Mar":"","InterfaceStyle":"","Layer-Build":"","FS-Schedule-Enter_Correct_Extra_Run_Times":"","Edit-Column_Count":"","ExpandD-Vertical_Extendable":"","StyleAlignment-The_value_of_rotation_must_between_-90_and_90_degrees":"9090","CellWrite-Page_After_Row":"","NS_LayerReport_adFormula":":1106 ","Chart_PIE_TYPE":"","Plugin-ChartF_Preview_WordCloud":"","Format-Error":"","M_Help-Tutorial":"","FR-Engine_SetStartTime":"","Visibility":"","FS-Privilege-Department_or_Roles":"/","ChartF-Data-Resource":"","FS-System-Email_Encrypt_TLS":"TLS ","Chart-Stock_Low":"","ChartF-No_Style":"","FR-Designer_Fit_Hor":"","Record In Category":"","FR-Engine_Tooltips":"","FR-Chart-Map_Lanzhou":"","Utils-Report_Footer":"","Plugin-ChartF_Level_Name":"","LayerPageReport_WN_RepeatCR":"","FR-Designer-Plugin_Shop_Installed":",?","FR-Base-Time_Milliseconds":"","Chart_AxisArrow_IsVisible":"","M_Edit-DeleteRow":"","ReportServer-Frozen_Column":"","FS-Setting-Logo_Upload_ToolTip":" Logo ","Chart-Layout_And_Style":"","M_Insert-BindValue":"(B)","FS-Report-Edit_File":"","FR-Designer-Dependence_Not_Found":"","FS-Schedule-Notification_Email":"","FR-Basic_Clear":"","ChartF-Series":"","Next_Year":"","FS-Report-Devices_Tablet":"","Chart-USe_NewLine":"","Chart_Out_Pie":"","FR-Chart-Text_Rotation":"","select_data_set":"","Widget-Widget_Css_Path":"CSS","SQLWizard-join":"","Staff":"","FR-Designer_Show_in_Containing_Folder":"","FR-Engine_Export_Excel_Page":"","FR-Engine-Tab_Layout_Height":"","FR-Chart-Type_Stacked":"","ConditionB-is_not_empty":"","Parameter-Current":"","BorderLayout-Constraints":"","Unknown":"","RP_Email":"","RWA-Help":"\n","ChartF-Series_Index":"","All_Border_Line":"","Chart_Plan":"","FS-System_Backup_Restore":"","FS-Admin-Account_Setting":"","Chart-IsRoundBorder":"","Chart_Field_Name":"","Background":"","FR-Engine_Title":"","FS-Generic-Attenchments_By_Receiver":"","FS-System-Email_Send_Error":"SMTP","FR-Chart-Map_ImagePoint":"","FS-Schedule-Reporting_Action":"","Short-May":"","FR-Plugin_Dependence-Not-Found":"","FR-Engine_PagePreview":"","Short-Mar":"","Plugin-ChartF_ToolBar":"","newNode":"","del_schedule_task":"","Not_In_List":"","FR-Engine_Data-upload":"","PageSetup-Page_Order":"","CellWrite-InsertRow_Policy":"","SingleNew":"","RP_Add_Note":"","FS-System-Dialog_Ok":"","Chart-Change_Bar_SIze":"","FR-Engine_No_Priviledege":"","CellWrite-Support_Smart_Delete":"","M-Insert":"","FS-Generic-Simple_Receiver":"","FS-Reg-Support_Or_Not":"","FR-Engine_New":"","FR-Designer-Plugin_Will_Be_Delete":"","Plugin-ChartF_InnerPaneBackground":"","FR-Designer_Edit_String_To_Formula":"","Host_Name":"","Parameter-Design_DES":",","Report-Write_Attributes":"","After":"","Out_Thick_Border_Line":"","Plugin-ChartF_PercentStacked":"","FS-PSqlInj-SC_Edit_Title":"","Applet_Print":"Applet","FS-Generic-Simple_Management":"","Need_Max_Value":"","FS-Generic-Mobile_Pad":"","FS-Generic-Simple_Moment":"","Support_QQ":"QQ","FS-System-Report_Visit_Detail":"","FS-Setting-Customize_Login_Style":"","Datasource-Other_Attributes":"","Chart-Use_Items":"","INFO-End_Reading_XML":"XML","FS-Generic-Simple_Thu":"","Plugin-ChartF_Legend_Gradual":"","After_Changed_Some_Attributes_Are_Different":"","FR-Engine_RP_Leapfrog_Back_Tip":"","Report-Design-Ruler-Units":"","Poly-Block_Attr":"","FR-Engine_NS_register_sense":":1205 ","Save_Definition":"","TaskName":"","Plugin-ChartF_Start_And_End":"","FR-Engine_Please_Select_Report_Path":"","FS-Report-Create_Home_Page_Dialog_Label_width":"58","Border":"","Implement-Description":"SubmitJob","schedule_email_notice_tip_first":"","RP_AllProcesses":"","Import_Failed":"","FR-Engine-Import_Failed":"","FS-Schedule-Output_File_Name":"","SpecifiedG-Force_Group":"","Plugin-ChartF-Tooltip":"","WaterMark":"","FR-Plugin-Update_Log":"","FR-Engine_Inform_Appending":"","FR-Designer_Foreground":"","Plugin-ChartF_Layer_Custom":"tileLayer","ExpandD-Sort_After_Expand":"","Schedule-Index":"","EX-Can_not_create_WorkBook_from_Reportlets":"","FR-Plugin_Use-Global":"","Privilege-Select_Organizations":"","Docking-Floating_Mode":"","feedback_info":"","HJS-Print_Successfully":"","FS-Generic-Page_Total":"","RP_Remove_Process":"","ExcelImport_Write_Match_Error_Info":"","CellWrite-Print_Background":"/","FR-Engine_Exporting":"","FS-Schedule-Template_Name_Not_Null":"","Plugin-ChartF_Map_Point":"","Max-Mem-Row-Count":"","ServerM-SapSync_Manager":"SAP","Chart_Data_Sheet":"","Server_Address":"","Privilege-Invalid_User_Or_Password":"","Plugin-ChartF_Custom_Width":"","FS-Privilege-Department_All":"","FR-Chart-Use_Percent":"","Datasource-Add_TableData":"","Three_Rows_Of_Three_Grid":"","FR-Engine-Data_Type":"","GoogleMap":"","Plugin-ChartF_Preview_Percent_Stack_Column":"","FS-Schedule-Export_Settings":"","FS-Schedule-Execute_Frequency":"","NS_export_excelCellBg":":1112 Excel","FS-Report-Parameter_Binding":"","Date_Attention":"MM/dd/yyyy","Get":"","List-Filter":"","LayerPageReport_WN_Float":"","FR-Basic_Fail_Location":"","Chart-LatLng_Order":"","Plugin-ChartF_NewBubble_LargerData":"","FR-Designer_Fit-Set-Global":"","FS-Setting-Customize_Login":"","FR-Engine-Type_Date":"","FR-Engine_RP_Report":"","Description":"","FR-Base_TurnOn":"","FS-Reg-Simple_Register_Failed":"","Config_Servlet":"","Re-mac-match":"Mac","Xinjiang":"","Meter_More":"","Plugin-ChartF_BottomValue":"","FR-Engine_Month":"","FR-Engine-Loading_Data":"","FR-Chart_Map_Second_Title":"","Chart-Out_Pie":"","FRFont-plain":"","FS-Monitor-Visit_Template":"","SQLWizard-add_condition":"","FR-Engine_ConditionB-is_greater_than_or_equal_to":"","":"","FS-Module-Privilege_Manager":"","PageSetup-Page":"","FR-Engine-Restart_Browser_After_Installation":"","FailPass_ImproveYourVersion":"","FR-Designer-Tree_Width":"","FR-Plugin_Fit-Font":":","RP_Deal_With_It_As_Soon_As_Possible":"","FR.Chart-Series_Name":"","Log_Declare_Head_Web_Write":"","Pagination":"","FR-Chart-Shape_Line":"","Chart_Polynomial":"","Chart-Step_Name":"","FS-Mobile_User_Limit_Tip_Left":"","Not_Logged_In":"","FR-Designer_Enter-New-FileName":"","FR-Base_Short_Oct":"","Chart_Axis_AutoCount":"","FR-Designer-Widget-Style_Shadow":"","Web_Apply":"WEB","FR-Engine-No_Element_Need_Append":"","ConditionB-is_empty":"","FR-Base-Error_Statement_Is":"","FS-Monitor-Memory_Low":"","Plugin-ChartF_Change_Style":"","Content":"","Chart_Stock_Error_Data_Order":"!","FR-Designer_Error":"","FR-Chart-World_Map":"","Chart-AddMainGrid":"","FS-Reg-Bind_Info":"","Backup":"","FR-Engine_Week":"","Chart-Series_Value":"","Plugin-ChartF_EndAngle":"","paper":"","HF-Number_of_Page":"","FR-Engine_Show_in_Containing_Folder":"","TrueRunTimes":"","CloseAuthConfirm":"","Plugin-ChartF_Common":"","RP_Execute_Day":"","BackgroundTexture-BlueTissuePaper":"","ChartF-EndOfTheProject":"","FR-Engine_Left":"","Plugin-ChartF_Legend_Form":"","BindColumn-Setting_Data":"","WF-Start_Node":"","FS-User-Reset_Password":"","FR-Engine_RP_To_Report":"","Save_Path":"","M_Insert-Chart":"","ServerM-Workflow_Manager":"","FR-Chart-Gannt_PlanEndTime":"","Parameters_name":"","Participants":"","String":"","Refresh_Database":"","FS-PSqlInj-Custom_Special_Char":"","ChartF-FirstStartAngle":"","Plugin-ChartF_Heat_Map_Radius":"","FR-Engine_Parameter_Setting":"","WF-End_Node":"","ChartF_Stock_High":"","FR-Engine_Task_List_To_Choose":"","Thick_Bottom_Border_Line":"","Re-appname-in-lic":"licAppName","Edit_Position":"","Chart-Time_Interval":"","M_Close_Current":"","Privilege-Can_Not_Find_The_User_With_The_Name":"","Set_CallBefore_Function":"","Chart_Alert_Left":"","FR-Designer_Form-ComboCheckBox":"","FR-Engine_No_Back_Target":"no back target","Poly-Report_Block":"","Set_Column_Title_Start":"","Registration-Please_Purchase":", ","FS-Msg-No_Message":"","Submit_Style":"","FS-Generic-Simple_Label":"","Background-Click":"","FR-Chart-Gap_Category":"","FR-Engine-JavaScript-Commit_to_Database":"","FR-Engine-PageSetup_Paper_Size":"","FS-Generic-PDF_Print":"PDF","ReportColumns-Columns_to":"","FR-Engine_RP_Sure_to_delete_process":"","Form-RadioGroup":"","ParameterD-Custom_Parameter":"","FS-Generic-Simple_Formula":"","FS-Setting-Simple_Title":"","Shanxi":"","FR-Engine_This_Name_Has_Exist":"","Plugin-ChartF_Background_Area":"","Re-first-mac":"mac","FR-Engine_Data_Rollback_Failed":"","schedule_email_notice_tip_third":"","Path":"","max_undo_limit":"","FS-Generic-WF_Name":"","Chart-Chart_Name":"","Plugin-ChartF_Preview_Area_Drill_Map":"","FR-Engine_Delete_Column_Row":"","Choose-Key-point":"","Chart-Use_Auto":"","Unit_Billion":"","NotAllow":"","fs_initDragBar_rect_tip":":,","Interface":"","Email":"","ChartF-Category_Axis_Range":"","FS-Schedule-Execute_By_Frequency":"","Plugin-ChartF_Radar_Y_Axis":"","Polyblock-Fixed_Width":"","ServerM-Widget_Manager":"","Form-Single_quote":"","ALL_WORK":"","ParameterD-Rename_parameter":"","ChartF-Data-Field_Name_AS_Series":"()","FS-Ecp_New_Password":"","EXPORT_PDF_EMBED":"PDF","Protected":"","Sche-Tuesday":"","Printer-New_Printer_Group":"","FS_Table_Share":"","Plugin-ChartF_Preview_Slot_Gauge":"","Layout_Constraints":"","WLayout-Card-ToolTip":"","FS-Generic-Already_Pause":"","FR-Engine_Excel-Export":"Excel","CheckBox":"","FR-Engine_ConditionB-Add_bracket":"","getDataFromCache":"","FR-Engine_Not_Imported":"","FS-Module-Access_Info":"","Datasource-Datasoure_File":"","Polybolck":"","FS-System-Mail_Host(SMTP)":"(SMTP)","PageSetup-Page_Setup":"","Plugin-ChartF_Preview_Large_Scatter":"","Chart-Link_Form":"","FS-System-Config_Backup_Config":"","FS-Report-Using_Templates":"","This_product_is_licensed_to":"","Plugin-ChartF_AlertLine":"","Locked":"","WF-Description":"","undo":"","FS-Mobile-Device_Bind_Close":"","FR-Engine_Task_Name_Repeat":"","Des-Private_Data_Source":",Report,","FS-Plugin-Store_App":"","Event-beforeedit":"","Cell_Data":"","ChartF-SeperateType":"","Down":"","Add-all":"","Plugin-ChartF_Map_Area_And_Point":"/","ChartF-Custom_the_value_range":"","FS-User-Edit_Department":"","FR-Designer-Widget-Style_Render_Style":"","Info":"","FR-Engine_Fit-Impl":"","FR-Base_Ante_Meridian":"","FR-Engine-Err-The_Value_Must_Be_Integer":"","FS-User-Personnel_Management":"","Username":"","Chart_ValueIntPercent":"","FR-Engine_ECP_error_pwd":"","ChartF-Tick_Label_Color":"","HTML-Write_Content_Save_Failed":"","Forum":"","AllRotationType":"","FR-Engine_Excel_uc_to_location":", ","Chart-Layout_Left":"","LayerPageReport_PageQuery":"","PageSetup-Finis_Start_Column":"","Utils-Right_to_Left":"","FR-Chart-Delimiter_Symbol":"","Not_Set_Verify_Attribute":"","FR-Chart-TimeUnit_Minute":"","ChartF-Edit_Background":"","FS-Button_OK":"","FR-Designer_Text":"","Level_Setting":"","FR-Engine_RP_Edit_Process":"","FR-Chart-Map_Pie":"","HangzhouCity":"","M_Window-Title_Vertical":"(V)","Select_Fields":"","FS-Generic-Parameter_Double":"","Support-Auto_Complete_Shortcut":"","Plugin-ChartF_ShowAllLevel":"","Plugin-ChartF_Preview_Force_Bubble":"","Plugin-ChartF_NewArea":"","FS-Report-Need_Input_Name":"","Body-Background":"","FR-Designer_Row-Axis":"","Hyperlink-Form_link":"","local":"","FS-Admin-Password_Modify":"","FS-Monitor-Simple_Problem":"","M_Insert-Float":"","FR-Plugin-Plug-trial_Expired":"ID","ErrorHandlerTemplate":"","ECP_decode_failed":", ","Table_name":"","FR-Basic_File_Should_Select_Excel_File":"Excel","Chart_Title_Area":"","FR-Chart-Bubble_Van":"()","WF-Communion_Task_Node":"","Column-Axis":"","FR-BaseFile-Cancel":"","Chart-Unit_Hundred":"","DBCP_MIN_EVICTABLE_IDLE_TIMEMILLIS":"","M-New_ChartBook":"","FR-Designer_ConditionB-Operator":"","Transition":"","Widget-Report_Widget":"","Page_Layout":"","FR-Chart-Map_Aomenbandao":"","Export-Offline-Html":"html","FR-Designer-Min_Width":"","Layer_Authentication":"","FR-Base_Sche_Tuesday":"","FR-Plugin_API-Need-Update":"API.","Column_Does_Not_Exsit":"","Image-Specified_Size":"","FR-Engine_ES_Role_Instruction1":"","Chart_AxisAlignZeroValueLine":"0","ChooseContentByUser":"","FS-Setting-Preset_Theme_2":"","FR-Base_April":"","FR-Chart-Map_Gansu":"","FS-Setting-Preset_Theme_1":"","FS-Setting-Preset_Theme_4":"","FS-Setting-Preset_Theme_3":"","FR-Plugin-Dependence_Service_Not_Found":"","ReportColumns-Columns_Style_vertically":"","FS-Report-BI_Analysis":"BI","ConditionB-null":"","ExpandD-Insert_Cell":"","Plugin-ChartF_CurveLine":"","FR-Designer-FRFont_Bold":"","BiasD-From-upper_left_to_lower_right":"","Verify-Verify_Success":"","April":"","FS-User-Ldap_Referral":"","FR-Engine_RP_Pass_After_All_Operations":"","FR-Engine_RP_Email":"","Not_Appendable":"","Preview-Assign_Margin":"","Skip":"","FR-Engine_RP_Start_Node":"","LIC-Support_Dynamic_Meter_Chart":"","FR-Designer-Plugin_Delete":"","Stacked_Bar_Chart":"","Visit":"","FR-Engine_Unregistered":"","FR-Base_Short_Nov":"","redo":"","Chart_Power":"","FS-Generic-Parameter_Formula":"","FS-Generic-Upload_File_Tip":"","Format":"","HotHyperlink-Des1":"B\\S","PageSetup-Portrait":"","Old-Style":"","Event-beforesubmit":"","FS-Monitor-Model_Process":"","Datasource-New_Charset":"","FR-Designer-Plugin_Active":"","FS-Msg-New_Message":"","Env_Des":",","Series_Use_Default":"","FS-Schedule-Start_Policy_At_Time":"","Plugin-ChartF_Preview_Custom_Map":"","Muiti_In":"","Utils_UnDelete_Row":"","FR-Chart-Shape_Fill":"","Return-Value":"","HaikouCity":"","FS-Setting-Logo_Style":"Logo ","Chart-Unit_Thousand":"","Tianjin":"","ThereIs_No_keyword_Named":"","ChartF-High-Low-Close":"--","JavaScript-Form_Submit":"","Follow":"","Chart-Data":"","FS-Plugin-Store_BBS_Account_Login":"","FR-Import-Export_Word":"Word","FR-Designer_Show_Blank_Column":"","LatLng":"","fs_process_user_pane_tip":"","ColumnTo":"","Registration-Error_Registration_Information":"","FS-Generic-Simple_Edit":"","FR-Engine-Tab_Layout_Widget_Size":"","Delete_Column":"","Plugin-ChartF_Image_Map_Data":"","FR-Chart-Map_Single":"","FS-Plugin-Store_Forgot_Password":"","ExpandD-Fill_Cell":"","Plugin-ChartF_Plus_Color":"","ChartF-Interval_Color":"","FR-Engine_PDF-Export":"PDF","Plugin-ChartF_SecondGraduationLine":"","FS-User-No_Department":"","FR-Chart-Map_GoogleMap":"","FR-Chart-Direction_Vertical":"","Open":"","FR-Engine_Fit-Horizontal":"","FS-Admin-Confirm_Password":"","FR-Chart-Data_Records":"","Set_Role":"","FS-Generic-Simple_Calculating":"","FS-Plugin-Store_Login_By_QQ":"QQ","Output_PDF":"PDF","FR-Hyperlink_Reportlet":"","Execute_Report_by_Layer_Engine":"","FR-Engine_RP_Authority_Edit":"","FR-Designer_Number":"","FrameStyle":"","FR-Chart-Map_Fujian":"","Plugin-ChartF_Preview_Stack_Line":"","Choose":"","M-Server":"","Has":"","FR-Designer-Dependence_Connect_Server_Error":"","MConfig-SaveButton":"","Filter_Conditions":"","Chart-Use_Show":"","Any_Result":"","Last_Day":"","Pick_One_Column_And_Present_To_Display_Value":"","Datasource-Context":"","BarInside":"","Processor_Parameter":"","FR-Designer-StyleAlignment_Center":"","Hyperlink-Link_Opened_in":"","ChartF-Draw_Border":"","More-Field_Name":"","Des-MapManager":"\"WEB-INF\\resources\\datasource.xml\"","FS-System-war_deploy":"","plugin-ChartF_OpenShadow":"","LIC-Support_Advanced_Formula":"","Do_not_remind":"","WF-Name":"","FR-Engine_Setting":"","FR-Engine_Cluster-Close":"","FR-Engine_Creating_Group":"...","Background-Null":"","PrintP-PageSetup":"(S)","M_Insert-Shape_Isosceles_Triangle":"(I)","Yes":"","FS-Schedule-End_At_Time":"","FS-Generic-Parameter_Boolean":"","Preference-Vertical_Scroll_Bar_Visible":"","Plugin-ChartF_Flow":"","Chart-Use_Space":"","Utils-Beyond_the_right_side_of_Border":"","FS-User-Simple_Position":"","FR-Designer-Tree_Height":"","Form-Password":"","FR-Chart-Drill_Map":"","Chart-Legend_Count":"","Not_Support_This_Method":"","SelfDefineAttachmentDeal":"","FS-Schedule-Execute_Period_Time_Unit_Week":"","Plugin-ChartF_Custom_Image":"","FS-Generic-Enter_True_Time_Format":"","FR-Engine_ReportServerP-Print[Server]":"[]","Alert":"","DashBoard-FindDashBorad":"","Green":"","FR-Engine_Short-Nov":"","Email-Can-Preview_JForm_Content":"","FR-Engine_Please_Enter_New_Group_Name":"","Center-Cannnot_Be_Null":"","FS-User-Post_Management":"","FRFont-bolditalic":"","Privilege-The_User_Service_Must_Be_LDAPUserService":"LDAP","FS-System-Current_Number_of_Users_Online":"","Database":"","Schedule-Daily":"","Utils-The-Chart":"","FS_Close_Other_Templates":"","FS-User-Retrieve_Location":"","BeijingInCity":"","FR-Utils_Label":"","AffairToHandle":"","FR-Base_Left":"","Server-Stop":"","FS-Monitor-Templet_State":"","FR-Chart_Layout":"","clickToRefresh":"","Line_Width":"","FS-Plugin-Store_Disconnected":"","FR-Engine_Repeat-Freeze":"","FR-Chart_Bubble_Size":"","FR-Chart-Style_Category":"","User_Information":"","one_record_exists_in_many_groups":"","Shape":"","Utils-Top_to_Bottom_a":"","Privilege-The_User_Config_Can_Not_Be_Null":"","Sche-Friday":"","SQLWizard-union":"","FR-Basic_File_Upload":"","I-LineStyle_VerticalLine":"","Plugin-ChartF_Area_Map_Data":"","Minute":"","ChartF-Area":"","EmailPane-BCC":"","Ratio":"","Env-Invalid_User_or_Password":"","Join_Product_improve":"","FS-Admin-Modify_Secret_Will_Remove_User":"","Utils-Now_create_connection":"","FR-Engine_RP_End":"","FR-Engine_Width":"","Chart-MSBold":"","Plugin-ChartF_AreaMap":"","FS-Report-Devices_PC":"PC","FR-Engine_Finish_Export":"","KeyWord":"","Plugin-ChartF_Curve":"","FR-Engine_ConditionB-contains":"","New_offset":"","Data-Get_Data_Error":"","Chart-Area-Tittle":"","M_Format-Add_Column_Before":"(O)","FR-Engine_Error_With_Non_Template":"","FS-Report-Need_Select_BI":"","Utils-Source_File":"","Left_Border_Line":"","Collect-The_user_information_code_is_invalid":", ","FS-Privilege-Simple_Design":"","FR-Engine_Exception_Column":": ${N}","Covered_All":"","PageSetup-Margin":"","Plugin-ChartF_LegendMaxProportion":"","Adaptive_Layout":"","Chart_Text_Axis":"","FR-Engine_Sort_Vertical":"","FR-Engine-PageSetup_Orientation":"","Select-Folder":"","FS-System-Simple_LRU":"","FR-Chart-Chart_Label":"","Hyperlink-No_Hyperlink":"","Cache-Message1":"0","Err-The_number_is_larger_than_the_maximum_value":"","FS-System-Task_Expired":"","Chart_Border_Light":"","ParameterD-The_First_List":"","Function-Source_Code":"classjava","EmailNotice":"","FR-Export_PDF":"PDF","Authrized":"","Chart_F_Radar_Axis":"","3DSpace":"","FR-Designer-Basic_Activation_Key":"","Plugin-ChartF_Time_Interval":"","FR-Base_Not_Appendable":"","FS-Generic-Simple_None":"","FS-Generic-Turn_On":"","Execute":"","File-File_Too_Big":"","Utils-Enter_reportlet_name_prefix_or_pattern":"","FS-Process-Input_A_Name":"","FS-System-NS_mail_config":":1204 ","FS-System-Email_Has_Send_To":"","FS-Generic-Simple_Content":"","Axis":"","FR-Designer_Fit_Vertical":"","FR-Engine_Excel_Submit_Add_Task":"","FR-Engine_Need_Registration_Code_Or_Exceed_Limited_Number":"","original":"","Event-afteredit":"","FR-Designer-Widget-Style_Frame":"","Event-beforetoexcel":"Excel","Click_this_button":"","FS-Schedule-Interval_Execute_Interval":"","Links":"","SQL-Procedure":"","M_File-Excel_Import":"Excel(I)","Chart-Use_Unit":"","M_Insert-Columns":"(C)","FS-Monitor-Log_Clean_One_Month_Auto":"","FR-Designer-Widget-Style_Title_Content":"","Widget":"","Black":"","Chart-Category_Name":"","FS-Generic-Simple_Execute":"","FR-Engine_NativePrint_Invalid_Index":".","ThreeD_Stacked_Bar_Chart":"","ExpandD-Expand_Attribute":"","RP_Process_Select":"","Border-Style-Normal":"","FR-Share_Module_Error":"","FR-Designer-Widget-Style_Body_Background":"","EX-Can_not_create_WorkBook_from_Reportlet":"","NS_print_pdf":":1121 PDFIE,PDF","RP_Rollback_To":"","FR-Chart_All_Normal":"","FS-Generic-Simple_July":"","NS_LayerReport_sheets":":1108 Sheet","FS-Generic-True_Extra_Run_Times":"","Chart-Lng_First":"","ChartB-Sort_Order":"","FR-Import-Export_Text":"()","the_target_cell_is_at":"","Utils-Row_Height":"","FS-BI-Dezi_Real_Time_Report":"","FR-Base_StyleFormat_Sample":"","Server_Language":"","FS-Module-System_Exam":"","FS-Generic-NOT_NULL_Des":"","ReportServerP-User_concurrency":"","License-Your_license_is_not_support_multiple_connection":"License","FR-Engine_Sure_To_Remove_This_Role":"","ConditionB-does_not_in":"","Unit_MM":"","FR-Base_Short_Mar":"","FR-Basic_Calculating":"","LayerData":"","BindColumn-Custom_Data_Appearance":"","FS-Privilege-Username_And_Password":"","RP_Exist_Null_Node":"","FR-Base_Short_May":"","Selected":"","Unit_PT":"","FS-Plugin-Store_Cost":"","FormulaD-Define_Execute_Script":"","fs_process_log_tip":"","FS-Generic-Simple_Driver":"","Remove_Button_ToolBar":"","ChartF-Tick":"","FR-Designer_Sytle-FRFont":"","ReportD-Report_Web_Attributes":"Web","CellWrite-Hide_on_Print":"","FR-Engine_Search_Task_Name":"","Utils-This_file_has_been_existed":"","FR-Chart-Map_Jiangsu":"","BackgroundTexture-Bouquet":"","Cell-Cell_Attributes":"","Cannot-Find":"","Schedule-The_selected_file_must_be_end_with_'.xls'":".xls","Hyperlink":"","Verify-Verify_Result":"","FR-Engine_Successfully":"","ChartF-Shape":"","FS-Privilege-Simple_Preview":"","Exist_The_Same":"","NS-exception_readError":":1305 ","chart-PreStyle":"","Layer-Wake_Up_Thread_For_Calculating":"","FR-Engine_FS_Report_Type":"","Printer-Remove_Printer_Group":"","FormulaD-Check_Valid":"","ChartB-On_change_of":"","detail_description":"","Set_Default_Data_Connect":"","StartProcess":"","FR-Designer-FRFont_Foreground":"","INFO-Start_Executing_Report":"","FS-Schedule-Output_Upload_By_FTP":"FTP","SAP-System_Number":"System Number","choose_schedule_type":"","WF-Select_Field":"","PaperSize_XL":"","Chart_Table_Data_Not_Found":"","FS-Process-Selected_None_Of_Any_Items":"","performanceModule":"","FS-Plugin-Store_Install":"","M_Edit-FormatBrush":"(B)","FR-Chart-Muiti_In":"","FR-Base_Formula_Plugin":"","D-ChartStyle_Info":"","Chart-Interactive":"","Report-Subtitle":"","DS-Server_Dictionary":"","FS-Template_Refresh_Parameter":"","Widget-Visible":"","FR-Designer_Set_Submit_Condition":"","Collect-Enter_your_user_information_code(It's_free_to_get_from_product's_official_website)":"()","Mail-BCopy_Adress":"","SingleAfter":"","Privilege-Select_User":"","FS-Generic-Simple_June":"","FS-Reg-Simple_Unregistered":"","Chart_Second_Plot":"","FS-PSqlInj-Add_Custom_FW":"","Server-Embedded_Server":"","ConditionB-Parameter_name_cannot_be_null":"","ParameterD-Delay_Playing":"","FR-Chart-Map_Jiangxi":"","Utils-Import_Excel_Data":"[Excel]","current_not_support":"","single_choice":"","ChangshaCity":"","Horizontal_Layout":"","Style-Line_Spacing":"","FR-Chart-Gantt_RealStart":"","FR-Engine-Condition_Operator":"","FR-Engine_Offline_Html_Info":"IE9I9+","FS-Msg_Disable":",","FS-Schedule-Task_Manage":"","Import":"","FR-Server-All_Error":"","FS-PSqlInj-Use_Forbid_Word":"","Indent-Indentation_Value":"","Des-Remove_WorkSheet":",,''.","FR-Hyperlink_Please_Select_Reportlet":"","FR-Engine_Create_One_Group_For_Remaining_Values":"","ChartF-Y_Axis":"Y","FR-Engine-Error_Input_Value":"","Seriously":"","Event-beforeverifywrite":"","Utils-Delete_Row":"","TODO_WORK":"","Widget-Multi_Report_Widget":"","Datasource-SAP_datasource_name_cannot_be_null":"SAP ","BindColumn-Odd_Selected_(1,3,5...)":"(1,3,5...)","Re-appname-match":"AppName","RCodeDrawPix":"","FR-Base_January":"","PageSetup-Saving_current_settings_to_server":"","Polyblock-Attribute":"","Error_Cell":"","FS-Admin-Account_Is":"","FR-Designer_Datasource-Stored_Procedure":"","Reg_Expressions":"","FR-Engine-NS_export_excelHtml":":1111 ExcelHtml","FR-Engine_ProcessName":"","Condition_Attributes":"","StyleAlignment-Horizontal":"","FR-Chart-Waring_Please_Input_The_Key":"key","Embed":"","Event-afteremail":"Email","FR-Engine_Restart_Browser_After_Installation":".","EX-Image_stored_is_broken":"","cycle":"","FR-Chart-Format_PDF":"PDF","ChartF-Donut":"","FR-Engine-PageSetup_Margin":"","TimesSum":"","FR-Designer_Border":"","FS-Setting-Select_Theme":"","FS-Monitor-Log_Level":"","Privilege-The_Response_Is_Not_Instanceof_HttpServletResponse":"HTTP","FR-Engine_Short-Oct":"","Chart-Value_Conversion":"","Chart-Plan_Start":"","FR-Export_Excel":"Excel","Event-afterpdfprint":"PDF","HF-Delete_it":"","FR-Engine_Excel_import_cost":"Excel, ():","BindColumn-Summary(Including_SUM_,_AVERAGE_,_MAX_,_MIN_And_So_On)":"()","Customs":"","Panel":"","FS-User-Add_Department":"","FS-Plugin-Store_Designer":"","FR-Chart-App_UpdateProgress":"","FR-Plugin_Edit-Local":"","Show_in_Containing_Folder":"","Layout-Padding":"","Form-DataTable":"","Plugin-ChartF_SeriesColor":"","Plugin-ChartF_Layer_Zoom_Level":"","Form-Center_Align":"","FS-Generic-Simple_Task":"","SingleMan":"","FS-Admin-Super_Manager":"","No_Wanted_Result":"","FS-Admin-First_Set_FS":"","Invert_Selection":"","FS-PSqlInj-Forbid_Word_Input_Hint":"","FS-Generic-Simple_File":"","Schedule-Are_you_sure_to_delete_the_selected_task":"","Role_List":"","Chart_Area":"","Deselect_All":"","Receiver":"","FR-Basic_Plugin_Version_Warning":",,","Classifier-Ge":"","Double":"","Plugin-ChartF_HingeBackground":"","PrepareExpression":"","FR-Designer-Widget-Style_Title":"","ParameterD-Background":"","Tooltips":"","FR-Engine-INFO-End_Converting_ReportPage_To_Html":"Html,","FR-Engine-Condition_Not_Equals":"","Chart-Black_Font":"","Second_Value_Axis":"","FR-Base_Fri":"","ChartF-HorizontalDrawBar":"","FR-Designer_Seriously":"","FR-Engine-PageSetup_Predefined":"","Chart-Switch":"","Registration-Use_Authorization_File":"","SpecifiedG-Specified_Group":"","FS-Generic-End_Time":"","FS-Schedule-Output_Push_Content":"","WF-Superior":"","D-ChartValues":"","FR-Designer-Plugin_Has_Been_Disabled":"","Chart-Actual_Start":"","SQLWizard-choose_function":"","XMLA_Explain":"\n,\n1.\nFineBI\nFRcubeFR\n\n\nOPEN SQL${abc}\n2.MDX\nMDXMDX\nMDX\n${abc}\nFineBIcubeMDX","Hyperlink(failure)":"","FS-Schedule-Output_Push_New_Message":"","Data_Fields_can_be_used":"","BindColumn-Group(Merger_the_Items_Which_Have_The_Same_Value_in_Column)":"()","Plugin-ChartF_Polygonal":"","FR-Chart-Map_Fuzhou":"","Datasource-Table_Name":"","RP_Page_Write":"","Finish_Save":"","FR-Engine_Example":"","Verify-Expression":"","FR-Designer_Fit_Horizontal":"","FR-Engine_RestartAfterSet":"","Plugin-ChartF_Save_Edit":"?","Preference-Choose_Configuration_File":"","FR-Designer_Year":"","Plugin-ChartF_ZoomWidget":"","Re-Group-edition":"","DownBarBorderStyleAndColor":"","Chart-Gantt_ErrorTip":"","Plugin-ChartF_OpenAxisReversed":"","FS-Generic-Simple_Password":"","Schedule-Select_Report_File_Directory":"","Plugin-ChartF_Bubble":"","FS-Generic-Simple_Submit":"","ReportColumns-Repeat_Column":"","Plugin-ChartF-Automatic":"","Ecp_Input_Oldpwd":"","Release_Lock":"","Plugin-ChartF_Gauge_Slot_Title":"","FR-Chart-Map_Anhui":"","Form-ToolBar":"","FS-Monitor-Log_Clean_One_Week_Ago":"","FS-Generic-Simgle_Number":"","FR-Chart-Property_Table":"","I-HBarStyle_Normal":"","Utils-The_data_dictionary_is_not_exist":"","BarCodeD-Drawing_Text":"","Golden":"","FS-Plugin-Store_Key_Word":"","FS-User_Login2FS":"","FR-Chart-Map_ImageArea":"","FR-Engine_RP_Add_MultiNode":"","FR-Chart-Marker_Type":"","Cover_None":"","Chart-Change_Bar_Size":"","Plugin-ChartF_Border":"","Plugin-ChartF_Select_Color":"","ScheduleCycle":"","FormulaD-Custom_Function":"","LIC-Support_Advanced_DataSource":"","Please_Drag_ParaPane":"","Schedule-Template_Parameter":"","Plugin-ChartF_Legend_Section":"","FS-Generic-Simple_Opened":"","M_Server-Platform_Manager":"","FR-Engine_Custom_Sort_Rule":"...","M_Edit-Copy":"(C)","FS-Generic-Simple_Add":"","FS-System-Email_Encrypt_None":"","FR-Engine_Word-Export":"Word","FR-Engine_ConditionB-begins_with":"","FS-Setting-Colorful_FS":"","FS-Plugin-Store_Report_Write":"","PageSetup-mm":"","FR-Chart-Color_Color":"","TurnOn":"","FR-Engine_DS-TableData":"","Hyperlink-Show_Scrollbars":"","Import-Excel2007_Source":"Excel2007","CONTINUUM_MODE":"","Plugin-ChartF_Layer_Black":"","Add_Analysis":"","Modify_Column_Attibute":"","FR-Engine_Please_Enter_Correct_Date_Step":"","FR-Engine_Offline_Html_Error":"IE9I9+html","Top_Margin":"","FR-Chart-Map_Ningxia":"","Columns_choosed":"","BackgroundTexture-PurpleMesh":"","FR-Engine_Image":"","FR-Chart-Format_Image":"","M_Edit-DeleteColumn":"","FR-Utils_Background":"","Unit_CM":"","Custom_Define_Types":"","FS-System-Event_Submitsuccess":"","Log_Level_SEVERE":",","Privilege-Name_Not_Match_Password":"","Utils-Show_View":"","FS-Module-MobilePush_IOS_IsDevelop":"iOS","Tree-Grade":"","ExpandD-Define_Father_Cell":"","Parameter-Double":"","RP_Invalid_Task_Or_Process":"","OpenAuthConfirm":"","ExpandD-Rename_Datasource":"","FR-Engine_PrintPreview":"","Utils-Exit_Designer":"","FR-Chart-Map_Chongqing":"","Formula_Dictionary_Display_Examples_Html":"<html> =range(100),$$$ =0 - $$$<br>1, 2, ..., 100,-1, -2, ... , -100<br>&nbsp;<\/html>","ConditionB-does_not_end_with":"","FR-Designer_Sytle-Indentation":"","NS_print_plugin":":1201 ","ProcedureSameWarning":"","Orange":"","Err-The_value_cannot_be_negative":"","FR-Designer_Alert":"","FR-Engine_RP_Pass":"","GroupReport-Page_Break_After_Detail_Repeat_Times":"","FR-Engine_overflow":"","Function-J2EE_server":"J2EE","Test_Value":"","__SHOWTOOLBAR__":"","Chart_Second_Grid":"","FS-Plugin-Store_Update":"","Verify-Data_Verify":"","FS_Name":"","FS-User-Simple_Unselected":"","FR-Engine_Please_Enter_Start_Value":"","Preference-Column_Header_Visible":"","Para-Body":"","BindColumn-Select(Regardless_of_Having_the_Same_Value,Display_all_Item_in_Column)":"()","FR-Engine_PageSetup-Portrait":"","FR-Engine_No-tableData":"","No_Editor_Property_Definition":"","Chart-StyleAlignment_Left":"","plugin-ChartF_positionX":"x","plugin-ChartF_positionY":"y","FR-Designer-Widget-Style_Custom":"","Chart_Change_Bubble_Size":"","NNormal":"","FS-Privilege-Grade_Authority_Manager":"","FR-Engine_ConditionB-is_not_empty":"","HJS-Server_Printer":"","State-Toggle":"","FR-Report-Write_Offline-Verify_ToolTips":"","Chart_Project":"","FS-User-Username_Can_Not_Be_Null":"","FR-Engine_RP_Finished_Task":"","FS-Web-PluginLicense_Check_Failed":"","Select_Create_Role":"","FS-Schedule-Subject_Not_Null":"","JavaScript-Dynamic_Parameters":"","FS-Frame-Simple_Subscribed":"","Offline-Connect_Failed":"","Event-aftertopdf":"PDF","Function-Content_Function":"","Data_Filter":"","ChartDemo":"","FS-User-All_Users":"","FR-Chart-Versions_Lasted":"","Not_use_a_cell_attribute_table_editing":"","FR-Designer-Plugin_Search":"","ChartF-Y2_Axis":"Y2","FR-Base_November":"","Create_Grouping_Report":"","FS-Privilege-No_Privilege":"","FR-Engine_add":"","Selected_Dictionary":"","Form-Widget_Property_Value":"","LayerPageReport_WN_Hierarchy":"","Sure_To_Remove_This_Role":"","Privilege-Authority_Must_Be":"","FormulaD-Function_category":"","Server-version-info":"  ","Datasource-Rename_class_datasource":"","FR-Engine_RP_All_Tasks":"","FR-Base_Wed":"","FR-Designer_DS-Dictionary":"","FS-System-Simple_Detail":"","LOG-Please_Wait":"","FR-Base_NOT_NULL_Des":"","Chart_Scatter":"","FR-Engine_Utils-Submit":"","Use_ToolBar":"","DS-Report_TableData":"","Form-Widget_Scrollable":"","SQLWizard-all_Rows_From":"{0}","ExpandD-Repeat_Row_Height_Or_Column_Width":"","Are_You_Sure_To_Delete_The_Data":"","FS-System-Visit_IP":"IP","FR-Engine_Poly":"","Reg_Min_Length":"","Single_Open":"","User":"","Privilege_Form":"","Error_Statement_Is":"","Plugin-ChartF_Deploy":"","Plugin-ChartF_NewMap":"","RP_Process_View":"","FR-Engine_Face_View":"","Plugin-ChartF_UseDiffSlantAngle":"","FS-Privilege-Data_Connection_Control":"","Refresh_Parameter_In_SQL":"SQL","HJS-Message":"","Plugin-ChartF_AutoSort":"","FS-Setting-Style_Config":"","FS-System-Please_Check_Email_Attr":"","Management":"","LIC-Support_Advanced_Online_Writer":"","Already_exists_not_add_repeat":"","Mail_Setting":"","Pick_Two_Columns_As_Actual_And_Display_Value":"","Prev_Year":"","Input_Rule":"","Welcome":"","FR-Designer_Thanks-To":"","FS-Monitor-Use_Detail":"","Start_Process":"","FS-Schedule-Please_Select_Monthly_Execute_Time":"","FR-Engine_None":"","Choose_Role_Create":"()","Custom_Processor":"","Chart_TrendLine_Backward":"","FS-Schedule-Execute_Condition":"","Plugin-ChartF_Period":"","Double_Bottom_BorderLine":"","PageSetup-Shrink_to_fit_content":"","Form-Middle_Align":"","JSON-Error":"JSON","Registration-CPU_Number":"","Click_RadioButton_Change_Semantic":"","M_Edit-Undo":"","RenderStyle":"","M_Edit-Order":"(O)","FR-Engine_RP_View_Task":"","Chart-Switch_Selected_Chart":"","Y-Coordinate":"","CellWrite-InsertRow_Label":"","BackgroundTexture-MediumWood":"","Can_not_use_FormatBursh":"!","FS-Msg-War_Deploy_Block":"warwar.","FR-Designer_Tree-ComboBox":"","Utils-The_selected_reportlet_do_not_contain_any_parameter":"","FR-Engine-Page_Setup_Portrait":"","Parameter-Integer":"","Current_keys":"","FR-Designer_Style":"","FS-Schedule-Basic_Properties":"","FR-Designer_ConditionB-AND":"(AND)","Plugin-ChartF_From":"","Cpt_Backup_Sure":"","MConfig-SupportEmail":"","Enabled":"","Chart_Data_Monitor":"","Printer-Selected_Printers":"","UrumqiCity":"","FS-Generic-Simple_Welcome":"","Layout":"","Length":"","FR-Designer_Edit":"","SimgleNumber":"","FS-Frame-Sure_To_Leave":"","ChartF-3DSimulation":"3D","Report_Certification":"","Plugin-ChartF_Rule":"","ServerM-Privilege_Manager":"","Right_Border_Line":"","Log_Declare_Head_Print":"","ExpandD-Father_Cell":"","Utils-Server_Parameters":"","Plugin-ChartF_Drill":"","FS-PSqlInj-Use_Escape":"","Unit_Ten":"","NoAffairToHandle":"","Hyperlink-Show_Location":"","FS-Generic-Simple_Institution":"","Select_Username_Column":"","M_Format-Data_Map":"","FR-Basic_File_Allow_To_Upload_Contains":"","FS-Monitor-Log_Clean_One_Week_Auto":"","FS-Function_Authority_Control":"","FR-Chart-Style_Bright":"","Choose_Language":"","HF-Insert_Content":"","Chart-Edit-HotToolTip":"","connection_to_server_again":"?","Japanese_Language":"","FR-Designer-Widget_Style":"","Qinghai":"","M-New_Report":"(R)","CellWrite-Default_Value_To_Insert":"","FormulaD-Reserve_when_bs-write_or_analy":"/","FR-Engine_Do_Not_Know_Me":"","BackgroundTexture-Papyrus":"","FS-Msg-Not_Found_Plugin":",.","designerModule":"","Event-beforetoimage":"","FR-Engine_FlashPrint":"Flash","Choose_AnalysisData":"","Plugin-ChartF_StackColumnTypeRadar":"","FS-Privilege_You_Have_No_Privilege":"...","FR-Engine_ConditionB-ends_with":"","Drag_to_select_gradient":" ","FS-Monitor_Action_In_Detail":"","DS-Multi_Dimensional_Database":"","Rectangular Coordinates Projection":"","November":"","Plugin-ChartF_HeatMap":"","FS-Plugin_Fresh_Login":"","ReportServerP-Print[Server]":"[]","Not_Set_Verify_Class_Path":"","Create_Tree":"","Form-Name_For_Empty":"","NewAffairToHandle":"","Position_Name":"","Denied_To_Upload_Contains":"","FS-Generic-BS_Design":"B/S","FR-Engine_Role_Name":"","FS_New_Password":"","Plugin-ChartF_FilledWithImage":"","FormulaD-All":"","Condition_Display":"","Short-Jun":"","FR-Designer_ToolBar_Top":"","Short-Jul":"","FR-Chart-Map_Hangzhou":"","Hyperlink-Resizable":"","FR-Designer-Dependence":"","Alignment":"","FS-System-Mark_Confirm":"","FR-Engine_Release_Lock":"","RESULTLET":"","FirstRow_IS_ColumnName":"","LayerPageReport_WN_Chart":"","Chart-Animation_JSShow":"","FR-Chart-Pie_ReCombinePie":"","ChartF-Step":"","Hyperlink(success)":"","RP_Node_Name":"","Utils-Add_Row":"","FS-Frame-Full_Screen":"","FR-Already_exist":":","FR-Plugin-Plugin_Version":"","FR-Designer_DataTable-Build":"","Widget-User_Defined_Widget_Config":"","FS-Privilege-Entry_Config":"","FR-Engine_Verify_Failed":"","FR-Engine_Format":"","multiple_choice":"","The_file_is_already_selected.":"","FS-System-Email_Encryption_Method":"","FR-Chart_DataLabelOutSide":"","FS-Generic-Server_Usage":"","Plugin-ChartF_Preview_Radar":"","FR-Engine_Error-Info":"","Warning":"","FS-Schedule-Task_Run_Moment":"","Draw":"","M_Help-Quick_Start":"","__PARAMETERS__":"JSON","FR-Engine_RP_Send_Time":"","FR-Base_Sche_Monday":"","LayerPageReport_WN_CellExpand":"","FR-Engine_Sche-Minute":"","LeftParent":"","Button-Group-Display-Columns":"","NS_register_ipFull":":1115 ","I-LineStyle_LineWithMarker":"","FR-Chart-Type_Pie":"","FR-Designer-FRFont_Italic":"","FR-Engine_-None":"","HF-Insert_Formula":"","LasaCity":"","Repeat-Freeze":"","Smart":"","FR-Base-Need_Purchase_Info":"","CardinalNumber":"","GroupB-Report_Footer_Page":"","FS-Report-No_Folder_Edit_Privilege":"","FR-Designer-Plugin_Illegal_Plugin_Zip":"","Server-Define_Data_Connection":"","Plugin-ChartF_TimeAxis":"","Layout-HBox":"","Use_NormalGroup":"","FR-Engine_RP_Alert_Setting":"","FS-Generic-Simple_New":"","FR-Chart-Map_Guizhou":"","Plugin-ChartF_NewCustom_ColumnLine":"-","M-Others":"...","Utils-Are_you_sure_to_delete_the_role":"","StyleFormat-Percent":"","FR-Base_Sche_Week":"","Yong-Style":"","FS-User-Platform_User_Management":"","All_File_Uploaded":"","FS-Report_Inform_Appending":"","revert":"","LIC-Support_Schedule":"","Plugin-ChartF_Off":"","Preference-Undo_Cacheable":"","Loading_Component":"","Log_Level_INFO":",SQL","Sche-Wednesday":"","Drop_down_for_more_preview":"","DS-Class":"","Reg_ Expressions":"","FRFont-Strikethrough":"","GroupReport-Hide_Detail_When_There's_No_Data":"","Horizontal":"","Preference-Function":"","Export-Excel-LargeData-Page":"","World Map":"","FR-Chart-Chart_BubbleChart":"","Continue_add":"","M_Window-Next_Window":"(N)","M_File-Export-PDF":"PDF","Cache-DataBase-Parameters-Setting":"","FR-Engine_Enlarge_Or_Reduce":"","RWA-Column_Offset":"","FS-Module-Plugin_Operate":"","FR-Engine_Refresh":"","Form-Editing_Listeners":"","FR-Engine-Condition_Greater_Than_Or_Equals":"","FS-User-Position_Can_Not_Be_Null":"","FR-Engine_Sun":"","Plugin-ChartF_Shadow":"","Utils-The_Name_has_been_existed":"","Collect-Click!_Get_user_information_code":"!","FR-Engine_Edit":"","Plugin-ChartF_TitleMaxProportion":"","FR-Engine_Multi-Excel-Import":"Excel","FR-Engine-ReportServerP_Print[Server]":"[]","TaipeiCity":"","Verify-Formular_Parser_Error":"","Edit":"","FR-Engine-Loading_Component":"","ExpandD-Inherit_All_Condition":"","Layer-Waiting_For_Page_Number":"","Utils-Beyond_the_bottom_side_of_Border":"","Set_Callback_Function":"","Backup_To":"","Utils-Design-File_Open":"","FR-Engine_FS_Task_End":"","FR-Basic_Successfully":"","Function-The_selected_file_cannot_be_null":"","EmailPane-mailContent":"","RP_Content":"","FS-System-Cache_Template_Settings":"","FS-Mobile-Dev_Added_By_Admin":"","FR-Designer-Plugin_Install_From_Local":"","DS-Class_Name":"","FRFont-Style":"","Preference-Row_Header_Visible":"","FS-Reg-Lock_Serial_Number":"","RWA-Key":"","Type_Set":"","Datasource-SAP_datasource":"SAP ","Statistic":"","Err-The_value_must_be_number":"","Get-Cube":"cube","LayerPageReport_WN_Report_Columns":"","Chart-Project_ID":"","FR-Designer_No-Privilege":"","ReportWebAttr-Widget_Css":"","ChartF-Arrow":"","FR-Engine_RP_Son_Task_Not_Complete":"","FR-Designer_ReportColumns-Repeat_Column":"","Choice_Type":"","FR-Chart-Heat_Map":"","FS-Generic-Simple_Delete":"","ChartF-Tick_Size":"","Normal":"","Hyperlink-URL_cannot_be_null":"URL","Layout-Margin":"","FS-Generic-Simple_Hour":"","FS-Report-Simple_Analysis":"","FR-Engine-Click_To_Shrink_Panel":"","Border-Style":"","I-AreaStyle_PercentageStack":"","HF-Move_Right":"","Work_After_Restart_Designer":"","FS-Monitor-Log_Clean_Three_Months_Auto":"","Chart-Step_Nam":"","FR-Designer-Beyond_Bounds":"body","FR-Engine-Edit_Clear":"","FR-Chart-Pop_Chart":"","Plugin-ChartF_Gauge_Cuvette_Title":"","WEB-Write_Setting":"","FS-Generic-Platform_Module_Log":"","FR-Designer_ReportColumns-Repeat_Row":"","Attention":"","FR-Engine_RP_Execute_Day":"","Re-sametime-ip":"IP","FR-Chart-Gantt_RealEndTime":"","Plugin-ChartF_MultiPie_Series_Name":"","Chart-Pointer_Value":"","StyleFormat-Category":"","Plugin-ChartF_Map_Param_RootName":"","ExpandD-Remove_Datasource":"","ConnectionPool_Attr":"","FR-Chart-Product_Demo":"","FR-Designer_Server-version-tip-moreInfo":"FineReport\n","FR-Chart-TimeUnit_Second":"","FS-Schedule-Execute_Period_Time_Unit_Day":"","sure_to_delete":"","Execute_Error_info_forbid_formula":"","FS-Privilege-Template_Control":"","Plugin-ChartF_CustomIntervalBackground":"","FS-Report-RP_AddLabel":"","CardLayout":"","FR-Engine-Excel_poi_2007_third":"Error Code: 1207 Excel2007fr-third.jar","StyleAlignment-Left_To_Right":"","Plugin-ChartF_Layer_mapbox":"mapbox","Utils-Left_to_Right":"","FS-Admin-Verify_New_Password":"","BindColumn-Decrease":"","FR-Designer_Form-Iframe":"","Click_To_Change_Value":"","Verifying":"","Preference-Support_Undo":"","FR-Designer-Plugin_Installed":"","plugin-ChartF-FloatColor":"","FS-Setting-Background_Image":"","Chart_Line_Color":"","Support":"","M_Edit-Clear_Formats":"(F)","Right_Margin":"","FormulaD-Array":"","Server_Data_Relations_Table":"","PM-Use_Custom_Privilege":"","ReportServerP-First":"","Plugin-ChartF_Preview_DifferentArcPie":"","Utils-Insert_Column":"","fs_process_sontask_tip":":","ChartF-Column":"","Cache-Cpt-Parameters-Setting":"","M_Edit-Redo":"","LIC-Support_Server_Cluster":"","FS-Schedule-Output_Attach_Print":"","DashBoard-DashBoradSetting":"","Offline":"","M_Help_Licence":"","Utils-Remove_Row":"","Column-Fields":"","Utils-Actual_Value":"","read_time_out":"","Datasource-Datasource-value":"","ReportServerP-Basic":"","Tree-Filter_Condition":"","ChartF-Outside":"","DateFormat-yyyyMd":"yyyyMd","FR-Engine-Write_Clear":"","Start_automatically_when_starting":"","FR-Engine_RP_Rollback":"","MaxMarker":"","FS-PSqlInj-FW_Edit_Title":"","DateFormat-yyyyMM":"yyyyMM","Privilege-The_Authentication_Is_Not_Supported":"","Set_User_Type":"","FR-Designer-Datasource-Param_DES":"<html>&nbsp;\"${abc}\"abc<br/>&nbsp;select * from table where id=${abc}<br/>&nbsp;select * from table where id='${abc}'(id)<\/html>","Utils-Delete_Directory":"","Layout-Index":"","Plugin-ChartF_Cycle":"","Add_Department_Failure":"","FR-Background_Image_Default":"","DashBoard-LearnTutorial":"  FineReport v6.5","Short-Jan":"","FormulaD-Most_Recently_Used":"","Form-EC-toolbar":"","BiasD-Input_Slope_Line_text_separated_by_'|'":",'|'","GroupB-Summary_Columns":"","None":"","FS-Mobile-Select_Username":"","BackgroundTexture-GreenMarble":"","FR-Chart-Map_Hebei":"","FS-System-Config_Backup_Frequency_Threemonths":"3","FR-Engine_Sat":"","Ean13_less_than_12":"Ean1312","Series_Dismenber_As_Single":"","Chart_SetInterval_Grid":"","Export-Excel-Setting":"Excel","Priority":"","Re-version-match":"","FR-Designer-LayerPageReport_Define_PageQuerySQL":"sql","FR-Engine_FS_End_Date":"","Axis-Style-Option":"","FR-Chart-Map_Taiyuan":"","August":"","FR-Chart-Type_Funnel":"","Copy":"","FR-Engine-Unload_Check_Msg":"","WF-Auto_Task_Node":"","Form-Report":"","FR-Engine_User":"","Animation_Special":"","StyleFormat-Time":"","ExpandD-Top_to_Bottom":"","Save_As_Global_Style":"","Hyperlink-Show_Menubar":"","ChartF-PlansToBegin":"","FR-Engine_Parameter-String":"","RP_Have_Come_To_You_For":"","Preview_Used_Time":"","FR-Designer_Song_TypeFace":"","Required":"","__FLASH_FIRSTPAGEMARK__":"Flash","FR-Designer-Basic_Copy_Activation_Key":"","More-information":"","INFO-Server_Started_Successfully":"","M_Edit-Clear_All":"(A)","TemplatedatasourceSameWarning":"","FS-Monitor-Free_Memory":"","Selection-Foreground":"","FR-Server_Embedded_Server_Start":"-","CSS_Import_Description":"CSS: \nWebReport, WebReport\\csscsstest.csscss/test.css","FR-Chart-Bar3D_Chart":"","FR-Engine_ConditionB-does_not_in":"","Data":"","Date":"","FR-Engine-Sort_Ascending":"","Chart_Stock_Check_Data":"!","FR-Basic_Week":"","Second":"","Single":"","FS-Plugin-Store_Finereport":"","FR-Engine_Delete_Data":"","M_Format-Add_Row_After":"(D)","ispageBoxMemo":"","TableDismember":"","Cross_Report_Wizard":"","Dic-Set_Actual_Value_And_Display_Value":"","New_name":"","Actived":"","Schedule-Frequency":"","FR-Chart-Map_Zhongxiqu":"","Chart_Series_Separate":"","FR-Designer_AppFit_Hor":"APP","Utils-Data_consistency_check_successfully_Passed":"","FS-Plugin-Store_Update-ALL":"","FormulaD-Valid_Script":"","FS-Report-Link_Address":"","Verify-Verify_Formula":"","Server_Data_Relations":"","Plugin-ChartF_NewBar":"","Import-Datasource_Files":"","FR-Basic_OK":"","BackgroundTexture-WaterDroplets":"","PDF-Print_isPopup":"","FS-PSqlInj-ADD_Custom_SC":"","FS-Generic-Flash_Print":"Flash","DBCP_TEST_ON_RETURN":"","FS-System-Simple_LFU":"","Line":"","FS-Msg-Invalid_Plugin_Zip_File":"! zip!","Note":"","FR-Hyperlink_Chart_Float":"-","Link":"","Utils-Group_Footer":"","Utils-Current_Column":"","InsertBackward":"","FS-Generic-Face_View":"","Chart-Bubble_Size":"","FR-Engine_Search_Role":"","Plugin-ChartF_Preview_Bar":"","October":"","Compile-Not_Support":"","FR-Base-NS_Cell_Formula":":1203 ","FR-Engine_Write_Group_Name_Here":"","Chart":"","FS-Generic-Simple_Actions":"","FR-Base_Sche_Day":"","CellWrite-InsertRow_COPY":"","Printer-All_Printer_Groups":"","FS-Process-already_has":"","ComboCheckBox-Start_Symbol":"","FR-Engine_Add_Role":"","FR-Engine_Tree":"","ExpandD-Expand_Cell":"","ChartF-Stock":"","Remove_Selected_Button":"","FR-Widget_Tree_And_Table":"","Plugin-ChartF_Heat_Map_Blur":"","FR-Engine_Please_Enter_End_Value":"","FS-User-Department_Position":"","HotHyperlink-Hot_Hyperlink":"","Chart_Area_Style":"","I-LineStyle_Line3D":"","Import-Excel_Source":"Excel","Plugin-ChartF_LogBaseValue":"","M_Server-Function_Manager":"","StyleAlignment-Distibuted":"","Bottom_Border_Line":"","Plugin-ChartF_Preview_Column":"","FS-Monitor-Simple_Error_Message":"","FR-Engine_Export-Offline-Html":"html","Server_Print":"","List":"","Plugin-ChartF_type":"","FR-Plugin-Jar_Expired":"Jar,:","Plugin-ChartF_Carousel_Style":"","Content-empty":" ","FS-Monitor-Options_Static":"","NanjingCity":"","Guizhou":"","FR-Chart-Series_Gap":"","AxisValue":"","SpecifiedG-Put_all_others_together":"","FR-Engine_Every":"","Parameter_Query":"","ChartF-Range_Chart":"","AttenchmentsByReceiver":"","ChartF-Label_Interval":"","FR-Engine-Selection_Filter":"","Form-TextArea":"","FR-Chart-Map_Qinghai":"","RWA-Skip_Unmodified":"","LIC-Support_Remote_Design":"","FR-Engine_RP_Sponsor":"","Chart-Use_Percent":"","Utils-Would_you_like_to_save":"","title":"","Column_Multiple":"","TurnScreenVerticalToGetBestEffect":"","Add_NewUser":"","FS-Web-Plugin_Please_Update_Jar":"jar","FR-Engine_TaskName":"","Certification_Type":"","FS-Generic_Invalid_File_Type_To_Upload":"","FS-User_Create_Role":"","FR-Engine_RP_Unlimited":"","FR-Engine_Tab_Layout_Title":"","Classpath-Add_Folder":"","DEFAULT":"","LIC-Support_ADHOC":"","FR-Engine_Custom_FS_Process":"","Re-lock-serial":"","ChartZoom":"","FR-Basic_Not_In_List":"","Build-Way":"","ParameterD-DClick_New_Parameter":"","Plugin-Chart_TopDownShade":"","DataFunction-Count":"","Even":"","ChartF-MiddleLine":"","Chart_Bubble":"","M_Insert-Data_Column":"","FS-Generic-Times_Sum":"","HTML-Write_Insert_Data_Failed":"","Exit_Tutorial":"","FS-Generic-Last_Day":"","LIC-Support_Multi_Web_App":"","Input-New_Name":"","FS-Report-Simple_Way":"","CellWrite-Editable":"","data_configuration":"","FS-Schedule-Enter_Execute_Formula":"!","FS-Monitor-Log_View":"","Cache-Path-Setting":"","FS-Plugin-Store_Account":"","Confirm":"","Schedule-Scheduled_Task_Manager":"","Parameter_Setting":"","FS-Generic-Manager_System":"","BaiduMap":"","FR-Engine_Choose_All":"","FR-Chart-Style_Plane3D":"3D","Cache_Dir_File_Permission_Error":"cache.xml","FR-mobile_analysis_style":"","FS-System-Basic_Description":"","Return-String":"","Cell_Point":"","FR-Engine_ConditionB-not_null":"","FR-Engine_RP_Rollback_To":"","ReportServerP-Toolbar":"","ChartF-Show_Percentages":"","Want_To_New_Parameter":"","Open_Synchronized_DataSet":"","FR-Designer-FRFont_Underline":"","M_Window-Previous_Window":"(P)","Present-Formula_Present":"","Error_WidgetNameRepeat":"","Expression":"","Classpath-Add_Jar_to_Classpath":"JarClasspath","Procedure-Warning":"<html>Schema<br><\/html>","Set_More":"","Plugin-ChartF_Animation_Type":"","Group_Count":"","Utils-Report-Env_Directory":"","Value_Percent":"","Plugin-ChartF_Radar":"","DataFunction-None":"","Plugin-ChartF_NewCustom_StackColumnLine":"-","M_Report-Report_Header":"","I-RadarChartStyle_Fill":"","FR-Basic-File_Uploaded_File":"","Schedule-Select_Template":"","RP_Task_List":"","FR-Engine_Cancel":"","PageSetup-End_Row":"","CellWrite-Show_Content":"","FS-Monitor-Not_Exist":"","Value":"","Web-WEB-INF_Directory":"","FR-Layout_Padding":"","FR-Engine_NS_print_plugin":":1201 ","Import-Unconverted_Formula":"","WARNING-Fail_to_Delete_Cache_File":"","FS-Report-Simple_BI":"BI","FR-Chart-Gantt_PlanTime":"","Needle Value":"","FR-Engine_Add_Record":"","FR-Chart-Template_Preview":"","FS-Generic-Simple_January":"","ChartF-Original_Value":"","FR-Engine_ConditionB-is_less_than":"","FR-Designer_Submmit_WClass":"","ServerMenu_Privilege":"","M_Report-Formula_Parameter":"(P)","FR-Designer_Cancel":"","M_Insert-Shape_Rectangle":"(R)","ChartF-Tick_Color":"","Transmission_Encryption":"","ThreeD_Column_Chart":"","Display_Value":"","Bottom_Margin":"","FR-Chart-Action_Copy":"","Log_Declare_Head_Execute":"","Error":"","FS-CustomStyle_Toast_Add":"","Conditions_formula":"","AomenBandao":"","FR-Designer_Parameter_String":"","Corresponding_Fields":"","ChartF-PieSeperatePercent":"","Plugin-ChartF_UseLabel":"","Plugin-ChartF_New":"","XianCity":"","FS-Monitor-Log_Clean":"","History":"","HF-Header_and_Footer":"","FR-Engine_Prospecting_File_Error":"","Measure":"","Printer-Printer_Manager":"","FR-Engine_Registration_Code":"","already_exists":"","Utils-Set_ClassPath":"Classpath","DashBoard-NoMoreReminder":"","Form-ComboBox":"","Recursion_Pane_Only":"","FS-Reg-Mac_Address":"Mac","M_Insert-Image":"","Plugin-ChartF_Layer_Detail":"","Chart_Legend(Series)":"()","Please-Select-Float-E":"","Plugin-ChartF_Save_Success":"","Chart-Link_Float":"-","FR-Designer_Widget":"","ExpandD-Push_Cell":"","Key":"","FS-System-Config_Backup":"","Save_All_Records_In_Memory":"","Form-Component_Bounds":"","FR-Chart-Map_China":"","Chart-Category_Use_Name":"","March":"","Plugin-ChartF_Min":"","FS-Privilege-Template_Edit":"","Plugin-ChartF_Minus_Color":"","Dic-Database_Table":"","Plugin-ChartF_Auto":"","FS-Schedule-Output_Information_And_Archive":"","HF-Insert_Parameter":"","FR-Basic_Current":"","Parameter_Name":"","ChartF-Averge-To-Max-Color":"","Shanghai":"","FR-Engine_Row":"","Calendar":"","FR-Designer-Form-ToolBar_Chart":"","EDIT_REPORT_XML":"","Chart-LatFirst":"","Chart-Use_Data":"","FR-Designer_Show_Blank_Row":"","FR-Engine_EssBase-database":"EssBase","ChartF-Range":"","ReportServerP-Custom_Toolbar":"","Utils-No_File_Selected":"","FRFont-Subscript":"","FR-Chart-Types_Switch":"","Backup_Cpt":"","Export-Excel-Simple":"","FS-System-Config_Backup_Frequency_Onemonth":"1","Excel":"Excel","Chart_Log":"","LIC-Support_Predefined_Widget":"","FR-Chart_SecondGraduationUnit":"","First":"","PageSetup-Footer":"","FR-Designer_Month":"","FR-Designer_Date":"","CellPage-Can_Break_On_Paginate":"","Form-Hierarchy_Tree_Last":"","FS-Generic-Simple_Name":"","FR-Chart-Map_Hainan":"","EX-Hierarchy_Analysis_is_not_Supported_in_this_Edition":"","FS-Schedule-Simple_Times":"","Row_Dimension":"/","FR-Base-Load_Resource_File":"","FS-Plugin-Store_Update_From_Local":"","Please_input_with_right_format":"","FS-Schedule-File_Name_Not_Null":"","PageSetup-Placement_Center_on_Page":"","Browser_Address":"","LIC-Support_Frozen_View":"","M_Edit-Delete":"(D)","ChartF-Legend-Option":"","FR-Engine_ExecuteFrequency":"","FR-Engine_OK":"","Unit_Hundred":"","FS-Web-Plugin_Read_Plugin_List_Error":"","FS-Report-Enter_File_Name":"","FS-Generic-Simple_Description":"","Vgap":"","Depth_Style":"","FS-Monitor-Has_Error":"","Print_Setting":"","Chart-StyleAlignment_Top":"","not-found":"","Preference-Custom":"","ChartF-Axis_Scale":"","RWA-Des1":"","ThreeD_Bar_Chart_Horizontal":"()","FR-Engine_Print":"","FlowLayout-Center":"","Chart-Use_None":"","Utils-NewDemoEnv":"","ChartF-Gantt":"","fileLocked_undeleted":"","FR-Base_Yes":"","I-BarStyle_NormalStack":"","Projection":"","M-Data_Analysis_Settings":"","FS-System-Visit_Times":"","FR-App-Report_Template":"","Datasource-Select_the_class_name":"","FR-Designer_ComboBox":"","FR-Designer_Plugin_Normal_Update_From_Local":"","FS-User-User_Limit_Tip_Right":"","Print-Print_To_Fit_Paper_Size":"","FR-Designer_Prepare_Export":"","Form-Paste":"","FR-Engine_Overall_Upload_Progress":"","Plugin-ChartF_Point":"","FS-Reg-Lic_Upload_Success":"FineReport.lic, !","ChartF-Plot":"","DS-Convert_to_Private":"","FR-Chart-Type_Area":"","FR-Engine-Send_Failed":"","Set_group_fields":"","Title-Content":"","Sche-Day":"","FR-Engine_New_Name":"","Chart-Unit_Ten_Thousand":"","FR-Designer_Build-Way":"","FR-Base_Short_Sep":"","FR-Engine_Error-Page":"","FS-Monitor-Error_Template":"","roles_already_authority_edited":"","Form-Method":"","FR-Engine_RP_Back_To_Start":"","EndValue":"","Heilongjiang":"","FR-Engine_Add":"","FS-Setting-Image_With_Title":"+","These_Parameters haven't produced Widgets":"","RP_To_Report":"","FR-Engine-Condition_Greater_Than":"","FR-Engine_Last_Submit_Time":"","ChartFF-Line_Marker":"","Main_Value_Axis":"","Radio":"","FS-Generic-Re_Multi_Privilege":"","ChartF-Gis":"gis","FRFont-Superscript":"","FS-Generic-Most_Time_Restart":"","FS-System-Cache_Reload_Template_Policy":"","FR-Engine_Is":"","Event-aftertoimage":"","FR-Engine_EssBase-TableData":"EssBase","Plugin-ChartF_NewWordCloud":"()","ruleSet":"","Event-afterappend":"","Directory_Used_For_Text_Excel":"EXCELEXCEL","ParameterD-Des1":",","Moment":"","FR-Widget_Mobile_Tree":"","Deploy-You_Could_Access":"","FS-System-Email_Show_Full_Name":"","Tree":"","FR-Engine_Date":"","Client":"","FS-Monitor-Visit_Times":"","Is_Paint_Page":"","DS-Form_DataSource":"","SQLWizard-add_having_condition":"HAVING","FR-Engine_Refresh_Successfully":"","Background-Texture":"","DashBoard-More":"...","Widget-User_Defined":"","NS_register_lic":":1206 ","FS-Monitor-In_Detail":"","FS-Generic-M_Page_Preview":"","Basic":"","ReportColumns-Columns_Style_horizontally":"","FR-Engine_Enter-New-FileName":"","BiasD-From-lower_left_to_upper_right":"","FormulaD-Report":"","Image-Image_Layout":"","FS-System-Cache_Dataset_Share":"","FR-Engine_RP_Task_Type":"","FR-Base_New-Title":"","FR-Chart-Stock_Low":"","FR-Engine_Note":"","FR-Designer-Need":"","FS-System-FlashP_Default_Size":"","FS-Setting-Edit_Icon":"","RP_Support_Offline":"","FS-Process-Name_Cannot_Be_Null":"","Parameter-Refresh_Parameter_UI":"","Lower_LayerSet":"","Sort-Ascending":"","FS-Monitor-Log_Statistics":"","FR-Base_DecimalNumber_Out":"","Lookup_Range":"","Privilege_Login_Name":"","Desktop":"","ConditionB-contains":"","ChartF-Volume-High-Low-Close":"---","Utils-Print[Client]":"[]","Offline-Verify_ToolTips":"","FR-Engine_PageSetup-Margin":"","Area_Value":"","Chart-Link_Dynamic_Parameters":"","Form-Please_Select_A_Kind_Of_Form_Container":"","FS-Plugin-Store_Recommend":"","HJS-Specified_Pages":"","Schedule-Task_Content":"","Verify_Fail":"","Utils-Resign_in":"","PrintP-First":"(F)","ChartF-Custom_the_increment":"","Database_Connection":"","FR-Engine_KaiTi":"","July":"","Not_Layer_Report":"","Tree-ComboBox":"","BindCellD-Define_Value":"","Status":"","Chart_Axis_IsVisible":"","Set_Frozen_Cell":"","FR-Designer_Release_Lock":"","Datasource-Rename_hibernate_datasource":"Hibernate","I-LineStyle_LineStack":"","FR-Engine_Create_New_Groups_For_Remaining_Values":"","FR-Chart-Map_Haikou":"","FR-Following_parameters_are_not_generated":"","June":"","LayerPageReport_WN_DSColumn":"","Form-Left_Align":"","FS-User-Unauthorized_Users":"","FR-Engine_RP_Cpt_Operation":"","RP_Execute_Time":"","FR-Chart-Version_UpdateFail":"","M-Print_Preview":"(V)","Compile_Success_And_Then_Save":"","FS-Mobile_Authorized_Users":"","Plugin-ChartF_Preview_Area":"","ChartF-Outline_Color":"","Plugin-ChartF_NotFollowMouse":"","RP_Timing_Issue":"","FR-Chart-TimeSwitch_Global":"","FR-Engine_Clear_All_Filters":"","FR-Chart-Designer_Preparing4Restart":"","Preference-Predefined":"","Widget-TreeNode-Grade":"","Chart-LngLat":"","FR-Export_Word":"Word","Light_Blue":"","Privilege-No_Authentication":"","D-ChartArea":"","Plugin-ChartF_Label_Format":"","Foreground":"","FS-System-Unread_Messages":"","Please-Select-Cell-E":"","FS-Generic-Simple_Role":"","not_support_authority_edit":"","Korea_Language":"","Form-Reset":"","FR-Base_Sche_Month":"","TableData":"","FR-Base_Short_Apr":"","Plugin-ChartF_Latitude":"","FS-Frame-Exit_Full_Screen":"","FR-Engine-Excel_poi_2007":":1207 Excel2007libpoi","FR-Base_Sche_Thursday":"","Top_Bottom_Border_Line":"","FS-Module-System_Monitor":"","FR-Engine_Start_Print":"","FR-Engine_RP_Leapfrog_Back":"","FS-Setting-Background_Color":"","ChartF-Stock-Axis":"","Plugin-ChartF_Rename_Repeat":",","FR-Basic_Email_Send_Error":"SMTP","FS-Privilege-Digital_Sign_Key_Url":"","Fomr-NameWidget-Name":"","Fuction-The_compiled_class_should_be_copied_to":"","FR-Engine-Write_Submit":"","FR-Engine_RP_Node_Description":"","Plugin-ChartF_Layer_Blue":"","FlowLayout-Left":"","FR-Chart-Data_NotShowCate":",","FS-Admin-Can_not_find_Data_Connection":"","Loading_Data":"","Background-Initial":"","FS-System-Visit_Time":"","DeciPart":"","DS-Class_TableData":"","Home":"","Product_improve":"","FR-Chart-Map_Shandong":"","FR-Designer_File":"","FR-Engine_RP_Add_Process":"","FS-Admin-Please_Enter_Newpwd":"","HF-Page_Number":"","FR-Plugin_Fit-Element":"","Browser-Are_you_sure_to_delete_the_selected_browser":"","Add_From_Report":"","Previous":"","Plugin-ChartF_AlertLeft":"","Plugin-ChartF_Shape":"","FR-Engine_Role_List":"","Chart-NotSupport_IMG&ReportData":"","FR-Chart-Module_Name":"","M-New_Multi_Report":"(M)","Form-Width_Des":"","Config_Synchronized_DataSet":"","WidgetDisplyPosition":"","Whether_Change_To_LayerReport":"","FR-Chart-Format_Excel":"excel","FR-Menu-Server_Chart_PreStyle":"","FS-Monitor-Visits_User":"","FR-Engine_RP_Review":"","TableData_Dynamic_Parameter_Setting":"","ChartData":"","FR-Engine-Print_Set_Printer_Offset":"","Ecp_Re":"","ParameterD-Show_Parameter_Window":"","FR-Engine_FrequencySet":"","FR-Designer_Yes":"","FR-Designer-StyleAlignment_Right":"","Chart_HighLightRelif":"","FS-System-Detail_Info":"","FR-Chart-Data_Series":"","FR-Engine_Schedule-Weekly":"","fs_initDragBar_title_tip":"","Privilege-The_Request_Is_Not_Instanceof_HttpServletRequest":"HTTP","Add_Department_Member":"","FR-Chart-Data_NotShowSeries":",","Perspective Deep":"","ReportServerP-Previous":"","Function-Choose_Function_Class":"","Style":"","NS_LayerReport_subreport":":1109 ","FR-Engine_Invalid_Page_Number":"","Cpt_Backup":"","select_path":"","Product_Demo":"","FS-Monitor-Log_Clean_Two_Months_Auto":"","Feburary":"","FS-Generic-True_Run_Times":"","Simple_general_forV6":"(ECC 6)","FR-Engine_Page-Frozen":":","FS-Schedule-Output_Push_Content_Not_Null":"","NextToAxis":"","FR-Chart-Type_BaiduMap":"","Not_Found_Reportlet":"","Task":"","Chart_Pie_Click_Out":"","FR-Base_UnSignIn":"    ","FS-Mobile-Device_Bind":"","FR-Engine_FS_Start_Time":"","DeepSeriesCap":"","LIC-Support_Privilege":"","FS-Process-Exclamation_mark":"","croExpression4":"201341950","Sort":"","croExpression5":"96","FS-Generic-Simple_Save":"","Reset":"","croExpression1":"1950","croExpression2":"1950","croExpression3":"41950","FS-Admin-Password":" ","Login_Setting":"","ChartHyperlink":"","Plugin-ChartF_Index3":"","Yunnan":"","Plugin-ChartF_Index1":"","Plugin-ChartF_Delete_Error":"","FS-Setting_Home_Page_Manage":"","M_Insert-Rows":"(R)","FR-Designer_Double":"","FS-Generic-Get_Uuid_Failed":"rootweb","FS-Report-Choose_Data":"","Registration-Customize_Edition":"","Plugin-ChartF_Max":"","File":"","FS-Generic-M_Data_Analysis":"","FR-Report-Write_Attributes_Msg":"","FS-Generic-Simple_Report":"","Form-EC_toolbar":"","Compile":"","GroupReport-Only_Display_Grand_Total_Function_At_Last_Page":"","FR-Designer-Plugin_Shop_Need_Update":",?","WLayout-Vertical-ToolTips":"","Tree-Width":"","Return-Date":"","Form-Form_Element":"","FR-Engine_Cancel_Combination":"","FR-Engine_RP_Process_Select":"","Using_Server_Report_View_Settings":"","Percent_Stacked_Column_Chart":"","clickToCover":"","FR-Base_Short_Aug":"","WLayout-Horizontail-ToolTips":"","HJS-Send_Failed":"","Sheet":"","open-new-form-tip":"711","RWA-Batch_Modify_Cells":"","FS-System-Email_Send_Failed":"","ThreeD_Stacked_Column_Chart":"","CellWrite-Repeat_Content_When_Paging":"","Plugin-ChartF_Animation":"","FS-Monitor-Simple_Suggestion":"","File_Description":"","Export_Set":"","StyleAlignment-Top":"","Poly_Name":"","Plugin-ChartF_NewCustom_Custom":"","FRFont-Underline":"","Weeks":"","Hour":"","ChartDataLabelInside":"","Plugin-ChartF_StackColumnTypeRadar_Title":"","FS-Plugin-Store_Commodity_Description":"||","FR-Chart-CopyJS_Failed":"JS","Chart_Stock_Error":":","GroupTable":"","FR-Engine_Print_Copy":"","RP_Operator":"","FS-Admin-Old_Password_Error":"","FR-Engine_Short-Jan":"","Bubble-Series_Name":"","LIST_MODE":"","FR-App-All_Custom":"","Chart_Legend_IsRoundRect":"","Rose_Red":"","Plugin-ChartF_Bedding":"","Custom_FS_Process":"","CellWrite-Support_Smart_Insert":"","FS-CustomStyle_Toast_SetStyle_Failed":"","Enable":"","Use_Global_Configuration":"","SQLWizard-select_all":"","Server_Flash":"Flash","DS-Select_Data_Column_from_Left_Data_Tree":"","FS-Process-WF-Process":"","Form-Same_Height":"","FS-Generic-Can_Not_Bigger":"","FS-Reg-Simple_Registration":"","FR-Engine_ConditionB-does_not_contain":"","DBCP_MAX_ACTIVE":"","Function-Function_has_Existed":"","Plugin-ChartF_Map_Point_RootName":"","Plugin-ChartF_Location_With_LongAndLat":"","FR-Background_Image_Adjust":"","FS-Generic-Parameter_Integer":"","FR-Action_Add":"","Widget-Load_By_Async":"","Function-The_selected_file_must_end_with":"","FS-Schedule-Simple_Unlimited":"","Chart-Horizontal_TimeAxis":"()","DashBoard-GuideAction":"","FS-System-Config_Auto_Backup":"","Choose_Role":"","FR-Engine-Loading_Applet":"Applet","FS-Monitor-Log_Clean_Two_Months_Ago":"","September":"","Gradient_Right_Color":"","FS-Schedule-Restart_With_Frequency":"","Chart-AddSecondGrid":"","ConditionB-Input_Condition_Parameter":"","FS-Generic-Simple_Email":"","FR-Engine_Can_not_find_Data_Connection":"","FR-Engine_Previous_Node_Staff":"","RP_Cpt_Name":"","Chart_ProjectID":"","JavaScript":"JavaScript","FS-CustomStyle_Toast_Tab":"","GuiyangCity":"","FR-Engine_Report":"","RP_Unfinished_Task_Name":"","LOG-Close_Session":"Session","FR_Designer_Visible":"","FS-Schedule-Output_FTP_Port":"","FS-Msg_Warning":"","FR-Designer-Dependence_Install_Succeed":"","Chart_Clock_Type":"270","Please_Input_A_Effect_One":"","Form-Split_Pane":"","FormulaD-Operations":"","I-BarStyle_3DPercentageStack":"","Chart-OuterLight":"","FormulaD-Script":"","Plugin-ChartF_More_Label":"","RP_Creator":"","Henan":"","Select_The_Source_To_Save":"","FS-User_OK":"    ","Select_DataFields":"","ThreeD_Bar_Chart":"","Utils-Top_to_Bottom":"","M_Server-Printer_Manager":"(P)","XMLA":"","Break":"","I-RadarChartStyle_FillwithMarkerLine":"","FR-Plugin-Designer_Authorized":":","DS-XML_TableData":"XML","File-Allow_Upload_Files":"","File-tree":"","ChartF-Other_Styles":"","ChartF-High/Low":"/","FS-Generic-Sche_Second":"","FS-Frame-Enter_Entry_Name":"","FR-Engine_Loading":"","RCodeVersion":"","Log":"","FR-Utils-Would_you_like_to_cover_the_current_file":"","Definition":"","Registration-Input_Registration_Information":"","M_Format-Style":"","Low":"","FRFont-bold":"","Datasource-TabeData":"TableData","FR-Designer-Form-ToolBar_Report":"","FS-Module-Simple_Register":"","FR-Base_Bottom":"","KunmingCity":"","Select_FS_Roles":"","AxisInside":"","Chart-Gis_LatLng":"","ParameterD-Report_Parameter":"","FR-Designer_Create_Tree":"","Designer-Preview":"","QueryResult":"","Web_Preview_Port-Conflict-Message1":"(","Cache-Max-Elements-In-Memory":"","ReportServer-Frozen_Row":"","Web_Preview_Port-Conflict-Message2":")","Title-Background":"","Chart-SVG_MAP":"","FR-Chart-Value_Tick_And_Color":"","Plugin-ChartF_Preview_Custom_Line":"","FR-Chart-Data_Max":"","FR-Engine-Condition_Contains":"","MConfig-WebsiteURL":"","ChartF-Custom":"","Utils-Are_you_sure_to_remove_the_selected_item":"","FR-Engine_Parameter_Name":"","wrong":"","RWA-Click_Cell_To_Edit_Value":"","Plugin-ChartF_IntervalBackground":"","FR-Engine_Edit_Role":"","Widget-Widget_Config":"","plugin-ChartF_Radius":"","N.O.":"","CellWrite-Print_Export":"","Read_failure":"","Plugin-ChartF_Area":"","Plugin-ChartF_NewPie":"","FS-System-Settings_Button_Margin_Left":"55","Already_exist":":","Error_Template_File":"","BackgroundTexture-FishFossil":"","Plugin-ChartF_Hidden":"","Song_TypeFace":"","Widget-Widget_Type":"","Set_default_browser":"Intenet","SQLWizard-deselect_all":"","Not_Exist":"","FR-Engine_Define_Group_Value":"","Utils-Should_select_a_template_first":"","Plugin-ChartF_MultiPieChart":"","Tree-Show_Root_Or_Not":"","File-Des":"\u201c\u201d","Please_Input_A_Widget_Name":"","FormulaD-Functions":"","RP_End":"","FlowLayout":"","Compile_Failed":"","Plugin-ChartF_ValueLabel":"","Hyperlink-Self":"(S)","Parameter_Name_Can_Not_Be_Empty":"","FormulaD-Function_name":"","Chart-Address_Name":"","FS-User-Sync_Dataset_Config_Tip":"4","WF-Equal":"","Role_Name":"","HTML-Report_Mail_Server":"","HJS-Server_Print":"","FS-System-Sign_Dongle":"","Number-Format":"","Preview":"","Select_Name_Column":"","FR-Chart-Gannt_PlanStartTime":"","Re-connect-to-remote-server":"?","Today":"","Plugin-ChartF_Preview_Column_Line_Custom":"","FS-Generic-Simple_Printer":"","Utils-No_Pagination":"","Wizard":"","Utils-Switch_To_Template_Reportlet":"","ADD_Department_Failure":"","FS-Report-Devices_Phone":"","Query":"","FR-Basic_Page_Number":"","M_Insert-Text":"","FR-Plugin_Share_Read_Me_Tip":"FineReport.Reusereportlets","Insert":"","NS_LayerReport_float":":1105 ","File_Upload":"","FS-Module-Simple_Scheduler":"","ReportColumns-Repeat_Row":"","SQLWizard-join_expression":"","Verify":"","FR-Designer_Plugin_Should_Update":",","FR-App-All_File":"","INFO-End_Executing_Report":"","DashBoard-ConnectionList":"","FR-Chart-Pie_ReCombinePie_Bar":"","ReportColumns-End_at_Row":"","FS-Plugin-Store_Function":"","M_Insert-Shape_Rounded_Rectangle":"(U)","FreezeWarning2":"","FS-Generic-Simple_Mon":"","Schedule-Report_File_Directory":"","FreezeWarning1":"","FreezeWarning3":"A-Z","No-Privilege":"","M_Format-Remove_Column":"(C)","Staff_Management_InDepartment":"","BackgroundTexture-Cork":"","SpecifiedG-Group_Name":"","Datasource-JNDI_Name":"JNDI","ChartF-DeleteSecondGrid":"","Plugin-ChartF_Line_Width":"","FR-Base-Time_Hour":"","Plugin-ChartF_Radius":"","Chart-Gis_Address":"","FR-Engine_Day":"","LanguageSetUp":"","Event-afterappletprint":"Applet","FR-Designer-Basic_Copy_Build_NO_OK":"","WorkBook":"","Platform_Module_DataSetting":"B/S","FR-Chart-Type_XYScatter":"","FR-Plugin-Plug_Expired":"ID","try_resending":"","FS-Mobile-Unauth_Devices":"","Widget-Role_Table_Tree":"","FR-Designer-Plugin_Disable":"","FR-Engine-Decimal_Number_Out":"","FR-Designer-Form-Please_Drag_ParaPane":"","Plugin-ChartF_Map_Area":"","RWA-Class":"","LayerPageReport_WN_SIL":"Sheet","FR-Basic-Email_Format":"","M_File-ExportT-Template(embedded_data)":"()","mobile_number":"","LIC-Support_Global_Style":"","FR-Remote_Re_Connect_to_Server":"?","JavaScript-Synch":"","__BYPAGESIZE__":"","File-Denied_Upload_Files":"","Edit_Analysis":"","fs_process_p_tip":"","FR-Engine_PageSetup-Predefined":"","Plugin-ChartF_Gauge_Cuvette":"","FS-Generic-HJS_Send_Failed":"","":"","Jilin":"","Event-afterdelete":"","DBCP_NUM_TEST_PER_EVCTION_RUN":"","No_Advanced_Chart":"  ","Set_Row_Title_End":"","FS-Generic-Self_Define_Class_Name":"","Form-Form_Definition":"","FS-Report-Edit_Directory":"","Remedy":"Remedy","Plugin-ChartF_Rename_Error":"","FR-Engine_Verify-Message":"","Plugin-ChartF_Rotation_Angle":"","Three_Rows_Of_Two_Grid":"","StyleAlignment-Single_Line":"","FR-Engine_Short-Jun":"","FR-Engine_Short-Jul":"","Two_Rows_Of_Three_Grid":"","FR-Engine-Sort_Sorting":"","FR-Engine_Export-Excel-LargeData-Page-Info":"","FR-Engine-Cal_Calculating":"","DS-Database_TableData":"","FS-Schedule-Task_Run_Info":"","Plugin-ChartF_Preview_Large_Bubble":"","FR-Designer_StyleAlignment-Wrap_Text":"","FR-Designer_No":"","FS-Setting-Add_Theme":"","FS-Generic-R_Code_Version":"","Upload-Select_a_File":"","Chart_RadarPlot_Should_Select_One_In_Line_Or_Marker_Or_Fill":"","FS-Generic-Cro_Expression_1":"1950","FS-Generic-Cro_Expression_2":"1950","FS-Generic-Cro_Expression_3":"41950","FS-Generic-Cro_Expression_4":"201341950","Model_Selection":"","FS-Generic-Cro_Expression_5":"96","Input_The_Name_Of_Gloabel_Style":"","Select_FS_Users":"","Server_PdfInstallPath":"Pdf","RWA-Smart_Add_Fields":"","Unit_Thousand":"","FR-Chart-Map_Not_Supported":"liclic","Chart-Time_Seconds":"","Address":"","FR-Designer-Hyperlink_Name":"","FR-Engine_End_At":"","HF-Even_Page":"","StyleAlignment-Wrap_Text":"","FS-Plugin-Store_BI":"","Privilege_Use_Privilege":"","The_Columns_Hava_Relations_Whether_Add":"","Plugin-ChartF_Point_Map_Data":"","FR-Engine-Verify_Failed":"","Exit":"","Url_location":"","FR-Engine_RP_No_Property":"no property","User-defined-MDX":"MDX","FS-PSqlInj-Forbid_Word":"","FR-Basic_Email_Send_Success":"","Calculating":"","Plugin-ChartF_Create_Error":"","FS-Generic-Attach_File":"","Formula_Editor":"","Append_Delete_Row_Message":"","Application":"","Interval":"","Form-Remove_Repeat":"","May":"","Max":"","Cancel":"","Plugin-ChartF_Gradual_Deep":"","Upload":"","FS-Generic-You_Are_Using_Unregisted_Function":":1116 ","Two_rows_of_two_grid":"","Adaptive_Original_Scale":"","PendingVitureDirectiry":"","Sign_In":"","FS-User_BackAndReset":"","FR-Hyperlink_ChartHyperlink":"","FR-Engine-Excel_Title_Match":", :","FS-Monitor-Server_Max_Memory_Is":"","Error_To_Create_Report_From":"","EmailPane-mailSubject":"","ExcelImportD-Excel_Source_File":"Excel ","Datasource-Test_Connection":"","Form-SupportTag":"","FR-Designer_Form-List":"","InsertForward":"","Modify":"","StandardType":"","FS-Plugin-Store_Private_Message":"","Des-Merger_Cell":".","Server_Path":"","FR-Chart-Radar_Chart":"","FR-Chart-Custom_Van":"()","Plugin-ChartF_Origin":"","MobilePhone":"","Preference-Export_Configuration_File":"","FS-Module-MobilePush_SureToOpenIGT":"","BindColumn-Custom_Left_Father":"","FR-Utils_WorkBook":"","M-Edit":"(E)","Layer-Sleep_Thread_For_Calculating":"","Export-Excel-Page":"","FR-Engine_Tue":"","Registration-Enterprise_Edition":"","RP_Son_Task":"","Chart_Meter_Field":"","FS-System-Server_character_encoding":"","FR-Designer-Layout_Adaptive_Layout":"","ChartF-PercentageOfCompletion":"","FS-Schedule-Execute_Condition_Always":"","FS-Generic-Simple_April":"","Confirm-Delete-File":"","FR-Chart-Map_Map":"","Utils-switch":"\n\n","FS-Generic-Simple_Successfully":"","ChooseOneButton":"","Plugin-ChartF_Layer_Tree":"","FS-Generic-Simple_May":"","ECP_error_same":"","Fail_To_Select_A_Data_Field":"","Plugin-ChartF_Gauge_Pointer180_Title":"","M_Server-Global_Parameters":"","Chart-Title_Is_Visible":"","ParameterD-Interface":"","FR-Engine_Fit-None":"","Chart-Address-Name":"","Plugin-ChartF_OpenAnimation":"","SQLWizard-add_expression":"","FR-Engine_Parameter-Double":"","Original_Marked_Filed":"","Form-Text_File":"","FR-Chart-Curve_Line":"","Schedule-Task_Name":"","LDAP_User":"LDAP","FR-Engine_Verifying":"","ReportServerP-Add_Printer":"","NS-war-remote":":1117 ","FS_Table_Del":"","FR-Engine_Import_Again":"","No-tableData":"","SingleTime":"","Chart_Null_Value_Break":"","Schedule-Unspecified_Report_File_Save_Location":"","RP_Rollback":"","FR-Engine_Custom_FS_Users":"","FR-Basic_Choose_None":"","No-Supported-File-Types":"","FR-Chart-Map_Shanghai":"","HF-Default_Page":"","ChartB-Change_Summary":"","FS-Process-Import_Parameter":"","Plugin-ChartF_Radius_Set":"","BackgroundTexture-PaperBag":"","SQLWizard-remove_entities":"","plugin-ChartF_XYFromTheUpLeft":"%","ReportServerP-Server_Printers":"","Close":"","FS-System-Config_Manual_Backup":"","PageSetup-Finis_Start_Row":"","FR-Chart-Map_Wuhan":"","PieStyle":"","FS-User-Http_Authentification":"Http","Subquery":"","FR-Engine_getDataFromCache":"","FS-Setting-Default_HomePage":"","Select_the_repeated_row_and_column":"","FR-Basic_Email":"","confirm_server":"","Datasource-Column_Index":"","Chart-Stock_Close":"","Form-Design_Height":"","Convert":"","Remove_All_Button":"","FR-Chart-Map_Saved":"","Chart-Use_MSBold":"","KeyPoint":"","Bulletin":"","Widget-Default_Widget_Config":"","Report_Display":"","Plugin-ChartF_Preview_Stack_Column":"","RP_Process_Created_By_Me":"","SQLWizard-select_expression":"select","FR-Engine_Switch_Selected":"","FS-Frame-Simple_Subscribe":"","Face_View":"","Chart-Select_Data_Set":"","FR-Engine-Reportlet_Net":"","Name":"","DataFunction-Max":"","Pwd_Format":"6-16","Successfully":"","Custom_Icon_SelectIcon":"","Server-version-tip-moreInfo":"FineReport\n","Show_Content":"","FS-PSqlInj_Title":"SQL","PageSetup-End_Column":"","Create_QRCode":"","ChartF-MainAxis":"","FR-Basic_Time":"","Common":"","StyleAlignment-Multi_Line(Adjust_Font)":"()","FS-System-Deploy_Type":"","ReportColumns-Report_Columns":"","FR-Chart-Map_Baidu":"","HF-Insert_Date":"","FR-Designer_Component_Interval":"","FR-Chart-Meter_Yuan":"","NS_LayerReport_RowCol":":1102 ","CellWrite-Append_Row(Used_in_Web_Write_Report)":"(Web)","FR-Chart-Area_Title":"","Plugin-ChartF_LargeDataModelPrompt":"()","Form-Hierarchy_Tree_Next":"","Fill_blank_Data":"","PageSetup-Vertically":"","FR-Engine_Custom_FS_Roles":"","FR-Chart-TimeUnit_Month":"","FormulaD-Formula_Definition":"","FR-Engine_Top":"","FS-Reg-Register_email":"","FS-Plugin-Store_Delete":"","Mon":"","FR-Designer_Please_input_with_right_format":"","DS-Should_select_a_bind_column":"","Env-Local_Directory":"","FR-Background_Image":"","FS-System-Config_Delete_Backup":"","NC-Des":"","FR-Engine_FormPreview":"","FR-Chart-Pie_Van":"()","Chart-Map":"","PageSetup-Paper_Size":"","ReportD-Export_Hided_Row":"","FS-System-Marked_Read":"","Widget-TreeNode":"","SpecifiedG-Groups":"","Chart_Line_Type":"","Utils-please_waiting":"","Utils-The_selected_reportlet_is_not_a_reportlet_,_":"","SQLWizard-arrange_entities":"","Meter_Style_Set":"","FR-App-File_Lookup_range":"","I-RadarChartStyle_Line":"","FR-Designer-Basic_Only_Submit_Current_Sheet":"sheet","FS-Plugin-Store_Businesses":"","Card":"","RP_Finished_Task":"","FR-Base_Table":"","Chart_Linear":"","ECP-error_pwd":"","Not_limited_IP":"","Utils-Add_Column":"","FS_Start_Time":"","BS-Design":"B/S","FR-Engine_Export_Excel_Simple":"","Level":"","FR-Engine_Thu":"","FS-Setting-Login_Page":"","Browser":"","FS-Plugin-Store_My_Plugins":"","FS-Schedule-Remove_Task":"","FR-Chart-Map_Guiyang":"","FS-Report-File_Name":"","Form-Widget_Property":"","FR-Base_Column":"","Utils-Only_Rename_File_Under_Reportlets":"reportlets","FS-Setting-Edit_Home_Page":"","Sichuan":"","More":"","FS-Generic-Simple_Alert":"","FS-Setting-Login_URL_Detail":"URL","Utils-Click_the_left_plus_button_to_add_tree_node":"","ReportServerP-Are_you_sure_to_delete_the_selected_printer":"","FR-Engine_Add_Task":"","FR-Engine_Re-Multi-privilege":"","CellWrite-Page_After_Column":"","FS-BI-Dezi_New_Report":"","Face_Write":"","IntPart":"","DoSelectUser":"","World":"","Plugin-ChartF_PaneBackground":"","FS-Monitor-Visitor_IP":"IP","Sub_Report_ToolTips":"","DataFunction-Min":"","Utils-Submit":"","Line-Style":"","Not_Imported":"","FS-Schedule-End_Date":"","FR-Designer_Query":"","Form-Action":"","DS-TableData":"","M-New_WorkBook":"","FS-Monitor_Export_To_DB":"","Utils-Rename_Column":"","Period":"","FR-Engine_Parameter-Formula":"","Utils-You_will_rename_the_following_file":"","FR-Chart-Map_Xinjiang":"","Function-The_class_must_implement_the_interface":"","Datasource-Key":"","FS-Web-Plugin_Illegal_Plugin_Zip_Cannot_Be_Install":"! zip!","Widget-Height":"","I-AreaStyle_Normal_3D":"","Add_Role":"","FR-Chart_Custom-Map":"","Plugin-ChartF_Collapse":"","FR-Engine_Offline_Html_Browser":"","Favorite":"","Level_coordinates":"","ChartF-Min-To-Average-Color":"","FR-Engine_Institution":"","FR-Engine_Please_Enter_Define_Group_Name":"","M_Report-Report_Background":"","ChartF-Closing":"","PageSetup-Landscape":"","Variables":"","FS-Frame-Close_Other_Tabs":"","ExpandD-Child_Cell_Follows_Father_Cell_to_Expand":"","FR-Chart-Type_Bar":"","Schedule-Reportlet_Info":"","FR-Engine_Ssas-database":"SSAS","Docking-Float":"","FS-Report-Directory_Management":"","FS-Plugin-Store_Register":"","SQLWizard-distinct":"","Total":"","DataBinding":"","StyleAlignment-Left":"","Widget-Chart_Widget_Config":"","FR-Designer_Fit-Attr":"","SecondGraduationUnit":"","Export-SVG":"SVG","Hyperlink-Email_cannot_be_null":"Email","FR-Designer_Get_Lock":"","Plugin-ChartF_StackAndSeries":"","Hyperlink-Show_Toolbar":"","__PI__":"","Short-Feb":"","Choose_All":"","WLayout-Absolute-ToolTips":"","Report_Designer":"","Plugin-ChartF_ExportImage":"","FS-Plugin-Store_Unexpected_Error":"","NS_print_flashPaperSetting":":1118 Flash","ConditionB-is_greater_than":"","Chart-Unit":"","FR-Designer_Fit_Horizontal_Vertical":"","Form-Split_Vertical":"","FS-Setting-Config_File_Detection":"","Already_End":"","Web_Preview_Port":"","DS-No_Dictionary":"","Chart-Change_Config_Attributes":"","Deploy-Success_Info":"","LOG-Report_Server_IS_Started":"","Utils-Display_Value":"","FS-Report-RP_ProcessMgr":"","Schedule-The_selected_file_must_be_end_with_filter":".cpt.class.frm","Show Home Page":"","ChartF-Fill":"","FS-Report-Input_Link_Name":"","FR-Engine_CSV-Export":"CSV","FR-App-Template_Report_Not_Exist":"!","Task_List_Chosen":"","FR-Chart-Data_Average":"","Chart-Series_Name":"","BackgroundTexture-Denim":"","FR-Engine_Start_At":"","FR-Engine_Cannot_Set_Duplicate_Role_Name":"","StyleFormat-Text":"","Chart_Bubble_Size":"","FR-Chart-Pre_Defined":"","long_data_can_not_show_fully":"","FS-Monitor_Show_In_Console":"","XML_File_Cannot_Be_Resolved":"xml","Schedule-Defined_Tasks":"","Plugin-ChartF_Axis":"","Line-Color":"","Plugin-ChartF_InnerRadius":"","This_Name_Has_Exsit":"","M-Design_Report":"(D)","Merge":"","RP_Sponsor":"","Event-click":"","Relationship":"","LIC-Support_Performce_Optimise":"","JavaScript-Commit_to_Database":"","FR-Engine_RP_AllProcesses":"","Error_Input_Value":"","Plugin-ChartF_NewFunnel":"()","Quarter":"","Add_Task":"","Plugin-ChartF_Preview_Custom_Bar":"","FR-Chart-Map_Jinan":"","ReportServerP-Next":"","Event-afterload":"","FS-System-Simple_FIFO":"","FR-Chart-Style_TopDownShade":"","FR-Engine_AppletPrint":"Applet","Sche-Minute":"","Plugin-ChartF_Radar_X_Axis":"","FR-Designer_Plugin_Normal_Update":"","IS_TD_HEAVY_EXPORT":"","ReportServerP-ms":"","FR-Chart-Password_Error":"","ChartF-CIRCLE":"","Add_From_Server":"","About":"","Platform_Module_Log":"","FR-Designer_AppFit_Ver":"APP","Bottom":"","M_File-Export-CSV":"CSV()","Icon":"","M-Exit":"","Above":"","FR-Engine_Chart-Map":"","Stacked_Column_Chart":"","FR-Engine_Please_Enter_Step_Greater_Than_Zero":"","FR-Engine_Delete_Role":"","FR-Designer_Width":"","PageSetup-Header":"","Des-Show_private_data_dialog_when_creating_new_worksheet":"","Background-Background_is_NULL":"","Class_Processor":"","Plugin-ChartF_At_Least_One_Chart":"","MobilePad":"","FS-User-Department_Name":"","FS-Generic-Fail_And_Restart":"","Event_Name_Type":"","Hunan":"","Plugin-ChartF_SecType":"","Printer-Printer_Group":"","Allow":"","User-defined":"","FR-Designer_ToolBar_Bottom":"","Hyperlink-Choose":"(C)","BackgroundTexture-WovenMat":"","Jiangsu":"","FR-Designer-Widget-Style_Standard":"","Chart-Address":"","I-xyScatterStyle_Marker":"","FR-Engine_Please_Select_Define_Group_Value":"","Cache-Book-Parameters-Setting":"","HF-Insert_Number_of_Page":"","FormulaD-Other":"","BorderLayout-West":"","alraedy_close":"","FS-Module-Report_Manager":"","RP_Remove_Task":"","Plugin-ChartF_Position_Bottom":"","FR-Engine_Excel-Import":"Excel","Title-Format":"","period":"","Chart_BarSpacePecent":"","FR-Designer-DS-Database_Query":"","FS-Generic-Memory_Usage":"","ConditionB-does_not_contain":"","Deep":"","FS-Admin-Full_Name":"","You_Choose_An_Empty_Directory":"","ChartF-ProjectID":"ID","Chart_Alert_Bottom":"","Form-View_Tree":"","FS-Msg_Enable":",","Chart_Axis_UnitCount":"","Plugin-ChartF_Open":"","is_need_word_adjust":"","ChartF-Title":"","FS_End_Time":"","FS_Task_Start":"","Means":"","Pause":"","FR-Basic_Email_Send_Failed":"","Host_ Name":"","PrintP-Next":"(N)","FR-Chart-Map_Field":"","template_unopened":"","Plugin-ChartF_New_Chart":"()","REPORTLET":"","FR-Utils-New_Folder":"","Function_Detail":"","CellElement-Property_Table":"","FR-Engine_RP_Process_Name_Not_Null":"","FR-Chart-Data_Edit":"","FS-Reg-Lic_Upload_Failed":"FineReport.lic, !","FR-Designer_PageSetup-Vertically":"","FailAndRestart":"","HighLight":"","FR-Server_Embedded_Server_Stop":"-","Already_Pause":"","DS-Select_Data_Column":"","FR-Designer_New_Value":"","FS-Plugin-Store_Chart":"","BI_Global_Config":"BI","Chart-Gantt_Error_Check":"","StyleFormat-Currency":"","Number-Max_Int_Length":"","Chart-Map-Key":"","BindColumn-Summary":"","RP_Process_Name_Not_Null":"","FS-PSqlInj-Exist_Custom_SC":"","Datasource-Convert_Charset":"","FS-Monitor_Clean_Failed":"","New":"","Chart-Summary_Method":"","Widget-Form_Widget_Container":"","FR-Designer_Preview":"","Send-Email_Schedule_Action":"","FS-User-Builtin_Authentification":"","CUSTOM_MODE":"","FS-Web-Error_Cannot_Delete_In_Jetty":"jetty,.","FR-Chart-XY_Van":"()","HJS-Range":"","IS_Auto_Scale":"iframe","NS_cell_formula":":1203 ","FRFont-Size":"","Plugin-ChartF_Outside":"","FS-System-Settings_Button_Width":"50","Plugin-ChartF_Fixed":"","FR-Plugin-Dependence_Plugin_Not_Found":"","Connect_SQL_Cannot_Null":"SQL","Chart_Line_Style":"","FS-User-Delete_User":"","ExpandD-Up_Father_Cell":"","Sure_To_Leave":"","Reinstate_Report":"","Printer-Rename_Printer_Group":"","Forecast":"","ChartF-Open-High-Low-Close":"---","FR-Engine_PageSetup-Paper_Size":"","Display-Style":"","WF-Assigned_User":"","FS-Msg-Dependence_Install_Or_Not":"","ChartF-Start_Value":"","Plugin-ChartF_NewGauge":"","Nation":"","FS-Monitor-Templet_Active_Days":"","FS-Setting-Home_Page":"","Delete_Data":"","JS_WARNING2":"  http://localhost:8075/demo.js","PageSetup-Title_Start_Row":"","Chart-Unit_Ten_Million":"","M_Format-Add_Row_at":"","JS_WARNING1":"  WebReport,WebReport\\jsjstest.jsjs/test.js","Plugin-ChartF_Preview_Pie":"","FS-Generic-Simple_Address":"","Docking-Aggregate":"","FS-Schedule-Prepare_Expression":"","Allow_To_Upload_Contains":"","Platform_Module_PostManager":"","FS-System-Applet_Need_Settings":"Applet","Plugin-ChartF_End_Point":"","ConditionB-is_less_than":"","Utils-Repeat_ReportFooter":"","M-New_FormBook":"","VisitTime":"","Plugin-ChartF_MainGraduationLine":"","Mobile_Widget_Table":"","Err-The_value_must_be_integer":"","FR-Engine_Modify_Schedule-Task_Name":"","Function-Rename_Function":"","Preference-JDK_Home":"JDK","Ecp_Pwd_Short":"","Main_Axis":"","FR-Designer_Fit-Template":"","Chart_Alert_Top":"","FS-Web-Plugin_Has_Been_Installed":"","HF-Insert_Page_Number":"","FR-Engine_Cluster-Member":"","FS-Generic-Simple_Server":"","FR-Engine_Cluster-Leader":"","Highlight-Choose_Property_To_Modify":"","Chart_Float":"-","Sytle-FRFont":"","FR-Engine_Excel_by_location":"Excel, ","FR-Import-Export_SVG":"SVG","Printer-Set_Alias":"","FR-Basic-Email_From":"","ChartF-Range_of_RangeAxis":"","FR-Engine-Type_Number":"","FR-Designer_Record-Number":"","FS-Schedule-Step3_Label_Width":"100","ECP_error_input":"","Form-Comma":"","Form-Desin_Width":"","Registration-Professional_Edition":"","ChartF-Needle_Color":"","Series_Name":"","HyperLink_Must_Alone_Reset":"","First_Of_Week":"","INFO-Start_Converting_ReportPage_To_Html":"Html","ReportD-Html_Export":"HTML","FS-Generic-Simple_Mail":"","Attribute":"","FS-Web-Dependence_Connect_Server_Error":"","FR-Designer-Plugin_Load_Plugins_From_Server":"","JS_Import_Description":"js: \nWebReport, WebReport\\jsjstest.jsjs/test.js;\njs:\n:D:\\tomcat\\webapps\\WebReport\\WEB-INF\\scripts\\script.js","InRow":"(R)","FS-Generic-APP_LAUNCHING":"APP","RWA-Row_Offset":"","Error_TableDataNameRepeat":"","FR-Engine-Type_String":"","LayerPageReport_Define_PageQuerySQL":"sql","FR-Plugin-Dependence_File_Not_Found":"","Chart-Lat_First":"","CellWrite-InsertRow_NULL":"","FR-Module_Designer":"","CountStyle":"","FR-Chart-Map_Title":"","Utils-Group_Header":"","Select":"","DateFormat-yyyyMMdd":"yyyyMMdd","M_Report-Bind_Data":"(B)","Managed":"","Please_Install":"","FS-Privilege-Simple_Authorize":"","Build_Tree_Accord_Parent_Marked_Filed":"","Utils-Set_Default_Database":"","The_current_list_is_empty":"","FS-Schedule-Output_FTP_Address":"","M_Help-Demo":"(D)","Privilege_Allocate":"","FS-User-Simple_Management":"","Schema":"","Import-Save":"","FR-Chart-Title_NewTitle":"","Plugin-ChartF_NewScatter":"","FS-Schedule-Operation_Monitoring":"","Remember-Username_And_Password":"","data_import":"","FS_Table_Edit":"","Datasource-Param_DES":"<html>&nbsp;\"${abc}\"abc<br/>&nbsp;select * from table where id=${abc}<br/>&nbsp;select * from table where id='${abc}'(id)<\/html>","IDCard":"","FR-Module_Engine":"","FR-Chart-App_Update":"","FR-Engine_FS_BI":"","FR-Designer-Plugin_DownLoadMessage":" ({R1} m)?","I-LineStyle_LineStackWithMarker":"","FS-Msg_Install":"","ECP_decode":"","M_Edit-Free_Ajust_Size":"(S)","Specify":"","Chart_Set_Data_Sheet":"","Des-Would_you_like_to_cover_the_current_file":"","FS-Generic-Simple_Expression_Not_Null":"","ConditionB-AND":"(AND)","M-Excel_File":"Excel(E)","FR-Engine_Fri":"","Chart_TrendLine_Forward":"","Plugin-ChartF_AlertRight":"","DS-Define_Semantic":"","Plugin-ChartF_Flash_Period":"","Chart-Data_Filter":"","Print_As_Image":"(  )","FS-Schedule-Time_Validate":"!","FR-Designer-Dependence_Install_Failed":"","Event-stopedit":"","Rotation":"","View_Combo":"","Rename":"","Indent-Indentation_Unit":"","DashBoard-FormBook":"","FS-Ecp_Old_Password":"","Datasource-Connection_failed":"","Template-Design":"","FS-Plugin-Store_Front_End_Display":"","PageSetup-First_Page_Number":"","I-LineStyle_LinePercentageStackMarker":"","Form-TableTree":"","Choose_to_generate_file_displayed_in_the_virtual_directory":"","ChartF-Tick_Marker_Type":"","schedule_email_notice_tip_second":"","PageURL":"URL","Comfirm_To_Save":"","FR-Designer_RWA-Help":"\n","ChartF_Alert":"","Plugin-ChartF_Currency":"","Plugin-ChartF_Section_Config":"","SelfDefineClassName":"","Restore-Default":"","JinanCity":"","FR-Engine_Export-Excel-PageToSheet":"Sheet","FS-Setting-Edit_Directory_Icon":"","Role_Information":"","FS-Report-Analysis_Name":"","FR-Engine_RP_Report_Deadline":"","Plugin-ChartF_AlertText":"","Chart-Value_Percent":"","Report_Not_Exist":"","FS-System-Config_Backup_Every":"","Role_Source":"","FR-Designer_ConditionB-OR":"(OR)","Plugin-ChartF_Default":"","FR-Plugin_Local":"","Enter_Pwd_Ecp":"","Style-Spacing_After":"","REDIRECT_FROM":"FROMURL","Plugin-ChartF_PercentLabel":"","Current":"","RP_Reach_Node":"","FR-Engine_ConditionB-does_not_equal_to":"","FR-Engine_Current_File_Upload_Progress":"","Chart_Title":"","Set_Chart_Style":"","Export-CSV":"CSV()","FS-Privilege-Role_Name_Exists":"","FR-Designer_Form-Button":"","Printer-Rename_Printer":"","FR-Engine_Excel_not_found_start":"Excel","Chart_Float_chart":"-","Cache-Policy":"","Plugin-ChartF_Formula":"","FS-Generic-Activated_Printer":"","__SINGLESHEET__":"","FR-Engine_Delete":"","FS-System-PDFP_Need_Settings":"PDF","New_Value":"","FS-System-Config_Backup_Frequency_Oneweek":"1","RP_Process_Type":"","HF-Whether_to_define_the_selected_type":"","ChartF-Data-Filter":"","IN_and_INOUT_type_not_as_cursor":"ININOUT","RP_Edit_Process":"","Style_Name":"","LayerGrade":"","Plugin-ChartF_Preview_Point_Drill_Map":"","Inner_Parameter":"","FR-Chart-AutoRefresh_NotSupportIMGAndReportData":"","Update":"","FS-Mobile-User_Limit_Tip_Left":"","Sub_Report_Message2":"","Sub_Report_Message1":"","Chart-Select_Path":"","FR-Engine-List_Filter":"","CellWrite-Hide_Same_Cell_Vertically(Used_in_Group_Report)":"()","Collect-Use_Designer":"","Collect-Collect_User_Information":"","Utils-Insert_Row":"","D-ChartStyle_SubStyle":"","Sub_Report_Message3":"","Plugin-ChartF_Drill_Map":"()","Get_Catalog":"catalog","Value_Not_Match":"","plugin-ChartF-Radius":"","Input_Keyword":"","Device":"","Set-Parameter-Name":"","FS-Setting-Backgroung_Type":"","Role_changed_isRefresh":"","FS-Frame-Simple_Platform":"","ChartF-DeleteMainGrid":"","FS-Plugin-Store_Version":"","Edit_String_To_Formula":"","Set_Submit_Event":"","already-saved":"","Uploaded_File":"","Please_Set_Repeat_First":"","Sort-Sort_Order":"","FR-Designer_HyperLink_Must_Alone_Reset":"","FS-Schedule-Output_File_Description":"","Chart-Use_Format":"","Page_Total":"","RestartAfterSet":"","Background-Pattern":"","Clear_All":"","MainGraduationLineStyle":"","StyleAlignment-Right_To_Left":"","Using_single_template_set":"","BarStyle":"","Formula_Condition":"","fs_process_reporttask_tip":":,","ExpandD-Cell_Expand_Attributes":"","CopyRight":"","Plugin-ChartF_Layer_Null":"","M_Insert-Hyperlink":"","CategoryName":"","FS-PSqlInj-Exist_Custom_FW":"","time(s)":"","Chart-Song_TypeFace":"","FS-Monitor-Log_Clean_Three_Months_Ago":"","FS-Schedule-Extra_Execute_Times":"","Plugin-ChartF_To":"","Add_Chart_Map":"","RP_Edit_Task":"","Report-Web_Attributes":"Web","FS-Schedule-Trans_FAILED":"","Preference-Grid_Line_Color":"","Event-beforeemail":"Email","Freeze-Page_Row":"","Form-Properties":"","Log_Declare_Head_Res_Write":"","FS-Privilege-Normal_Role":"","RP_Task_Status":"","FR-Engine_RP_Invalid_Task_Or_Process":"","ChartF-Show_GuidLine":"","ChartF_Stock_Low":"","RP_Execute_Month":"","Plugin-ChartF_DisplayStrategy":"","Char-Lik_Cell":"","FR-Engine_Short-Dec":"","M_Window-Cascade(C)":"(C)","FR-Base_Not_Exsit":"","Custom_Login_Page":"","RP_Task_Operation":"","FR-Engine_no_title":", Excel","M_Edit-DeleteFloat":"","File-address":"","SQLWizard-reading":"","FS-Privilege-No_Control":"","Component_Interval":"","FR-Engine_Execute":"","Choose_Use_Authority":"","WLayout-Border-ThreeContainer":"","Repagination":"","Chart-DS_TableData":"","Opening_Report":"","DONE_WORK":"","FS-Report-RP_SelectLabel":"","M_File-Export-SVG":"SVG","Download":"","FR-Engine_Excel2007-not-support-pwd":"Excel2007","Last_Submit_Time":"","Excel_formula_error":"","FS-Monitor-Templet_Release_Date":"","Chart-Float_Chart":"-","Columns":"","FR-Engine_Block_extended":"","FR-Chart-Data_Min":"","Department_Roles":"","FR-Engine_Verify_Error":"","ConditionB-Add_bracket":"","Classpath-Add_Jar":"Jar","template_unsaved":"","Privilege-Keep_Login_State":"","DS-Database_Query":"","FS-Monitor-Not_Less_Than":"","Chart-Data_Configuration":"","FR-Chart-Map_Sichuan":"","No_offset":"","INFO-Page_is_Generated":"","FS-System-Messages_Count":"","Datasource-Set_Classpath":"Classpath","M_Edit-Bring_Forward":"(F)","DBCP_TEST_ON_BORROW":"","DisplayNothingBeforeQuery":"","FR-Engine_WF-Name":"","CellWrite-Print_Zero_Value":"","Plugin-ChartF_CommonModel":"","Plugin-ChartF_On":"","FR-Designer-Widget-Style_Title_Background":"","FR-Chart-Map_Yinchuan":"","Role":"","Update_OfflineWrite_Lic":"htmllic","I-Message_SummaryGrouper":"","Plugin-ChartF_Gis_Layer":"GIS","Plugin-ChartF_Layer_GaoDe":"","FS-Generic-RP_System_Message":"","Datasource-Are_you_sure_to_delete_the_selected_remedy_datasource":"Remedy","StyleFormat-Scientific":"","FR-Designer-Plugin_Cannot_Update_Not_Install":"","Field":"","Close_Synchronized_DataSet":"","You_have_not_made_a_report":"","FR-Chart-Map_Neimenggu":"","FR-Engine_JavaScript-Commit_to_Database":"","FR-Designer_Refresh":"","Chart-Right_Top":"","FR-Engine_Wed":"","Datasource-Read_Type":"","Add_JS_warning":"url!","M_Insert-Shape_Line":"(L)","Registration-User_Email":"","FR-Designer_Plugin_Should_Update_Title":"","BuildIn":"","Plugin-ChartF_NO":"","FS-CustomStyle_Toast_Res_Empty_alert":"","FR-Plugin_Developer":"","FS-Admin-Password_Can_Not_Be_Null":"","ComboCheckBox-End_Symbol":"","Event-beforetopdf":"PDF","FS-Frame-Simple_Comma":"","Delivery":"","Chart_Date_Axis":"","Plugin-ChartF_UseTooltip":"","FS-Admin-Simple_Exit":"","Chart-Change_Chart_Style":"","Remove":"","Plugin-ChartF_Custom":"","Odd":"","FS-User_Login2PlatForm":"","Utils-Connection_can_not_be_null":"","FS-Generic-Simple_Minute":"","M-File":"","RP_Report":"","BindColumn-Advanced_Summary":"","ChartF-TickLabelIsVisible":"","Sub_Report_Description":"","Root":"","Utils-Show_Cell_Value":"","This_ScheduleAction_Is_Not_Exsit":"","FR-Engine-Tab_Layout_Width":"","Plugin-ChartF_Center":"","FR-Engine-Sort_Sort":"","Unit_INCH":"","FR-Base_Columns":"","DS-Select_Database":"","FR-Engine_ConditionB-Remove_bracket":"","Unit_Hundred_Thousand":"","My_Computer":"","FR-Engine_TaskEndWhenOneTime":"","ServerM-Face_Manager":"","__ISJMETER__":"JMETER","ChartF_ValueRange_MatchColor":"","Folder":"","Custom_Type_Set":"","Schedule_DEC":"","Still":"","Prospecting_File_Error":"","FS-Generic-Simple_Form":"","Input-To_Search":"","M-Popup_ChartType":"","Mouse_move-background":"","FR-Chart-Interactive_timeSwitch":"","Utils-Total_Option":"","FR-Chart-Map_Guangxi":"","Chart_Half_Transparent":"","FR-Base_May":"","FR-Engine_ReportServerP-Previous":"","FR-Engine-Write_Stash_Failed_Msg":"","Gradient-Direction":"","Prospecting_File":"","FR-Base-NS_register_ipFull":":1115 ","M_Help-About_Software":"","I-AreaStyle_Stack_3D":"","FS-Generic-Simple_March":"","Right_Top":"","FR-Designer_Unit_INCH":"","Widget-Width":"","RWA-BuildIn_SQL":"SQL","FS-Plugin-Store_Install_From_Local":"","Ningxia":"","ZhengzhouCity":"","Form-Allow_CustomData":"","Pink":"","Column-Number-OR-Row-Number":"","ChartF-Meter_Type":"","Save":"","Cell-Location_And_Span":"","Plugin-ChartF_Word_Value":"","ChartF-Tick_Label":"","Display position":"","Schedule-Mail_To":"","Is_Need":"","Plugin-Chart_Gradient_Direction":"","FR_FS-Handle_Affairs":"","Custom_Icon_Message1":"16  16PNG","FS-System-not_war":"","Custom_Icon_Message2":"","Custom_Icon_Message3":"","ImgBoard":"","FR-Chart-Text_Vertical":"","Plugin-ChartF_FullScreenDisplay":"","Rows":"","Set_User":"","FR-Engine_ConditionB-Input_Condition_Parameter":"","FR-Designer_Modify":"","Datasource-From_Database":"","FR-Widget_Message_Letter_Space":"8","FR-Engine_Form-Action":"","OtherGroup_Name":"","Closed":"","RowSpan":"","FR-Engine_Sche-Hour":"","FS-Monitor_Suggestion_Comma":"","NS_print_noApplet":":1202 Applet","FR-Engine_ConditionB-does_not_begin_with":"","FR-Designer-Plugin_Connect_Server_Error":"","Release-To_Load_Data":"","Activity":"","SINGLE_FILE_UPLOAD":"","SecondGraduationLine":"","FS-Generic-Parameter_Setting":"","Empty_Input":"","Month":"","RWA-Add_Field":"","FS-Schedule-Invalid_Unsent_Email_Address":"","FS-Setting-Custom_Homepage":"","WF-Privilege_Setting":"","FR-Engine-ExcelImport_Write_Match_Error_Info":"","MicrosoftYaHeiInCN":"","Max-Decimal_Length":"","Form-Right_Align":"","FR-Engine-PageSetup_Landscape":"","Cursor_to_previous_row":"","Name_has_Colon":":","FS-Setting-Title_Only":"","Schedule-Unspecified_Template_File_Name":"","FR-Chart-Data_None":"","FS-Generic-Simple_Value":"","FR-Designer-Plugin_Jar_Expired":"Jar","Privilege-The_User_Account_Is_Expired":"","M-Report":"(R)","Float":"","Custom_Button_Type_Simple":"","Expand":"","FR-Base_Short_Feb":"","TurnOff":"","ExcelImportD-Save":"","ChartF-End_Value":"","FR_Chart-Data_Range_configuration":"Data range configuration","FR-Engine_Save":"","Provide":"","XiningCity":"","ChartF-Series_Name":"","FS-Web-Dependence_Install_Failed":"","Plugin-Chart_Tooltip":"","ReportColumns-End_at_Column":"","FS-Plugin-Store_Not_Login":"","FR-Designer-Plugin_Update":"","FR-Engine_Modify":"","Report-Write_Attributes_Group_Warning":"","Plugin-ChartF_MainType":"","GroupB-Add_Condition_to_List":"","Event-afterverifywrite":"","ExportAndOutput":"","FS-Msg_Prompt":"","ReportD-Report_Write_Attributes":"","RP_To_Check":"","FS_Old_Password":"","LanzhouCity":"","Registration-Standard_Edition":"","FR-Engine-Print_As_Image":"(  )","SAP_datatype":"SAP","Row_tag":"","FR-Engine_Function_Name_Should_Not_Be":"","M_Report-Report_Parameter":"","FR-Engine_Right":"","Chart-Actual_End":"","Display":"","Para-Shown_On_Default_Parameter_Page":"","FS-Report-Create_Dir_Dialog_Label_width":"58","Datasource-Single":"","Plugin-ChartF_Gauge_Pointer_Title":"","Plugin-ChartF_Y_Direction":"y","Please_Drag":"","SetStartTime":"","LIC-Support_Flash_Print":"Flash","FR-Chart-Map_Wulumuqi":"","Docking-Undock":"","MeterAngle":"","Registration-Project_Name":"","Tree-Select_Leaf_Only_Tips":"","FS-Setting-Generic_Setting":"","EveryInterval":"","FS-Generic-Applet_Print":"Applet","One-Name_Value":"","Poly-Report_Component":"","M_Format-Add_Row_Before":"(A)","LayerPageReport_CountPerPage":"","FR-Engine_Executing_Report":"","I-LineStyle_LinePercentageStack":"","Already_exists":"","FR-Import-Export_CSV":"CSV()","Vertical_Layout":"","Plugin-ChartF_Needle":"","FR-Plugin-Start_Version":"","FS-Generic-Simple_Example":"","Plugin-ChartF_SameArcPie":"","Utils-All_Sheets":"Sheet","FormulaD-Text":"","Form-Remove_Repeat_Data":"","Loading_Applet":"Applet","Preference-Locale":"","FR-Base_July":"","ParentCell_Setting":"","Hyperlink-Extends_Report_Parameters":"","Set_Column_Title_End":"","Show_Grid_Column":"","DateFormat-Custom_Warning":"","Title":"","FR-Engine_RP_Edit_Task":"","FR-Engine-Write_Column_Type_Mismatch":" ","FR-Chart-Map_Taiwan":"","Utils-Bottom_to_Top":"","NS_export_2007":":1122 Excel2007jdk1.5","FR-Base_June":"","FR_FS-FailPass_ImproveYourVersion":"","Ecp_Failed":"","Editor":"","ParameterD-Parameters_Processor":"","NS_register_sense":":1205 ","Location":"","Has_Selected":"","Plugin-ChartF_TickColor":"","ShowAsDownload":"","Utils-New_Directory":"","FR-Chart-Import_Map":"","FS-Generic-Simple_Next":"","Jiangxi":"","FS-User-Add_User_Failure":"","GroupReport-GroupReport_Attributes":"","ChartF-High-Low-Close-Chart":"--","BindColumn-Default_Father_Cell":"","Event-beforeappletprint":"Applet","FR-Base_TurnOff":"","ReportServerP-Import_JavaScript":"JavaScript","Plugin-ChartF_Height":"","WF-Reportlet_Info":"","Utils-No_Data":"","FR-Chart-Value_Divided_stage":"","FR-mobile_report_analysis":"","Suffix":"","EmailPane-tips":"<html>${abc}abc${today()}\"${today()}\"\"${p},123@gmail.com,mike\"mike<\/html>","Switch":"","FS-Plugin-Store_Free":"","ExpandD-Add_Datasource":"","FS-Reg-Simple_Jar":"Jar","Examples":"","Default_Certification":"","FR-Engine_Role":"","Sequenced_number":"","FR-Engine-Invalid_Cell":"","Plugin-ChartF_NewColumn":"","FS-System-Email_Ports_and_Encryption":"","FR-Engine_RP_Content":"","Function-Function_File":"","Plugin-Chart_Gradient_Color":"","FR-Share_Module_Removed_Failed":"","Form-Semicolon":"","FR-Chart-Map_Multilayer":"","Where_claus":"","Cannot_Set_Date":"","WLayout-Grid-ToolTips":"N,N","Plugin-ChartF_Null_Value_Break":"","FS-User-Encryption_Mode":"","Plugin-ChartF_Invalid_WMS":"WMS","Plugin-ChartF_WordCloud":"","Plugin-ChartF_Content":"","Datasource-Stored_Procedure":"","Registration-Develop_Edition":"","DisPlay_Proportion":"","FR-Engine-Condition_Less_Than_Or_Equals":"","Not_Exsit":"","BindColumn-Custom_Up_Father":"","M_File-Export-Excel":"Excel","Tree-Root_Name":"","Utils-Rename_File":"","Privilege-Select_Role":"","Event-aftersubmit":"","FS-Generic-User_Defined":"","FR-Engine_RP_Task_Operations":"","LayerPageReport_PageQuery_Unsupport_Msg1":"SQL!","DataFunction-Sum":"","FR-Chart-Map_Bubble":"","Choose_Date_Time":"","Area_Name":"","Unit_Ten_Thousand":"","Plugin-ChartF_UseSameSlantAngle":"","ReportColumns-Columns_vertically":"","M_Insert-Shape_None":"(N)","ShenyangCity":"","WLayout-Split-ToolTips":"","Form-Colon":"","FS-Admin-Simple_Name":"","RP_Add_Process":"","ChartF-Volume":"","SQLWizard-remove_all":"","FR-Engine_String":"","ReportServer-Frozen_Column_Row":"","Plugin-ChartF_MaxDiameter":"","Plugin-ChartF_Layer_Fresh":"","FS-User-Custom_Encryption":"","Highlight-Barcode":"","Utils-Click_the_database_button_to_add_database":"","FS-Monitor-No_Global_Style":"","Submit_Url":"","ParameterD-Are_you_sure_to_delete_the_selected_parameter":"?","Test_URL":"","Plugin-ChartF_Preview_Column_Area_Custom":"","FS-Schedule-CPR_FAILED":"","UpParent":"","Float_Element_Name":"","FS-Plugin-Store_Official":"()","FS-Monitor-Max_Memory":"","FR-Server_Version_Tip_MoreInfo":"FineReport\n","M-Page_Preview":"","HF-First_Page":"","Chart_Bubble_Outside":"","Plugin-ChartF_FollowMouse":"","Privilege-The_Password_Of_The_User_Is_Invalid":"","Select_Specified_Grouping":"","Log_Declare_Head_Export":"","FR-Chart-UpdateMessage_PushAuto":"","SetPrinterOffset":"","IDLE":"","FS-System-Time_To_Live_Seconds":"","Plugin-ChartF_Position":"","FS-Reg_Registration_Successfully":"","Utils-Submit_Forcibly":"","Select_All":"","Plugin-ChartF_Layer_Custom_WMS":"wms","FR-Engine-Write_Are_Stashed_Clear":"","Plugin-ChartF_Preview_SameArcPie":"","FS-Monitor-Log_Cleaning":"","FS-Plugin-Store_Installed":"","quote":"","ChartF-Stagger":"","FS-Report-RP_TaskMgr":"","Re-lic-out-date":"lic","FR-Chart-Line_Style":"","Hyperlink-Reportlet_name_cannot_be_null":"","Platform-Create_Table":"","FR-Engine_De":"","Form-Design_Size":"","FR-Designer_Indent-Pixel":"","Deploy-Page":"","Preference-Setting_Colors":"","FR-Base-Error_Cell":"","FS-System-Mail_Sender_Account":"","SetLoginBackground":"","EnterTrueTimeFormat":"","FR-Chart-Map_Nanchang":"","GuangzhouCity":"","FS-User-MD5_Encryption":"MD5","MinuteWrong":"","Group_by":"","Yuan":"","File-File_Size_Limit":"","Utils-Are_you_sure_to_refresh_all":"","FormulaD-Input_formula_in_the_text_area_below":"","FR-Engine_Unload_Check_Msg":"","FR-Engine-Err-The_Number_Is_Less_Than_The_Minimum_Value":"","FR-Engine_no_need_insert":"Excel, .","Following_parameters_are_not_generated":"","FS-Generic-Simple_Yes":"","Allow_Negative":"","Widget-User_Defined_Editor":"","FR-Engine_Fit-Vertical":"","Abnormal_Communication":"","Mobile_Widget_Tree":"","M_Report-Execute_Script":"(S)","Interval_Gap":"","FR-Engine_Import":"","Function-Are_you_sure_to_delete_selected_function":"","Style-Left_Indent":"","Plugin-ChartF_DifferentArcPie":"","Semicolon":"","Submit":"","Parameter":"","And_A":"","Not_Found_XML_File":"XML","Plugin-ChartF_Connect_WMP":"","FS-Report-Has_Parameter":"","ReportWebAttr-Write_Css":"","MConfig-ProductName":"","Printer-Selected_Printer_Groups":"","M_Insert-Shape_Oval":"(O)","FR-Engine_ConditionB-is_empty":"","Short-Dec":"","Form-Bottom_Align":"","FS-Schedule-Start_Policy_Immediately":"","BindColumn-Group":"","FR-Designer_Cover_None":"","FR-Engine_RP_Cpt_Name":"","ConditionB-Remove_bracket":"","PrintP-Last":"(L)","Test":"","Printer-Remove_Alias":"","plugin-ChartF_MatchColor":"","FS-Module-MobilePush_UseIGT":"","add":"","Undefined":"","Overlapping":"","Root_Path_Cannot_Remove":"","Enter-New-FileName":"","Shandong":"","FS-System-Config_Cleanup_Backup":"","Offline-Contain_Unsupport_Function":"","Hyperlink-Show_Directories":"","Excel2007-not-support-pwd":"Excel2007","EditRC-Entire_column":"(C)","Has_Existed":"","Plugin-ChartF_X_Direction":"x","FR-Designer_Tooltips":"","Auto-Build":"","FR-Chart-Map_Liaoning":"","FS-User-User_Limit_Tip_Left":"","Plugin-ChartF_Import_Image":"","FR-Engine_Utils_Flash_Print[Client]":"[]","Data-Label":"","FR-Designer_Confirm":"","FS-Privilege-Has_No_Privilege_To_Visit":"","FR-Background_Image_Titled":"","ChartF-Show_Labels":"","Hainan":"","Utils-Matching_Items":"","FR-Chart_MainGraduationUnit":"","Plugin-ChartF_Gradual_Level":"","BindColumn-Result_Serial_Number_Start_From_1":"1","FS-Plugin-Store_Jar":"jar","LIC-Support_WorkBook":"sheet","FORMLET":"","AxisReversed":"","FR-Engine_ConditionB-Operator":"","Utils-New_Report":"","SpecifiedG-Discard_all_others":"","Chart-Use_Address":"","FR-Plugin-Designer_Installed":"","HJS-CC_to":"","fixedTime":"","FR-Chart-Stock_Chart":"","FR-Chart-Map_Lasa":"","ReportDir":"","Freeze-Use_In_Write":"","REPORTLETS":"","FS-Schedule-CPR_SKIP":"","WLayout-Card-ToolTips":"","FR-Chart-Series_Setting":"","Chart-StyleAlignment_Right":"","ExpandD-Left_to_Right":"","FR-Chart-Series_Name":"","Back":"","FR-Plugin-Plugin_Name":"","M-Save":"","BackgroundTexture-Newsprint":"","FR-Base_Rows":"","Plugin-ChartF_NewCustom":"","Load":"","XML_TREE_Wait":"","FS-Generic-Synchronize_Rate":"","FR-Designer_ReportColumns-Columns":"","HJS-Current_Page":"","Margin":"","ChartF-Meter":"","FR-Plugin_Global":"","Import-Excel_Import":"Excel","FR-Chart-Area_Value":"","FR-Chart-Type_Donut":"","Privilege-The_User_Account_Is_Locked":"","Tree-Return_Full_Path":"","ChartF-Values":"","FS-Plugin-Store_User_Password_Error":"","Memory_Usage":"","Please-Wait":"","Cannot_Get_Date":"","FS-Schedule-Printer_Not_Null":"","FR-Share_Module_Removed_Successful":"","FR-Chart-Map_Drill":"","Width":"","FR-Designer_Layer-Build":"","Exchange_key":"","FR-Chart-Data_Current":"","Plugin-ChartF_Fixed_Radius":"","Custom_Button_Submit_URL":"","Event-beforewrite":"","FR-Engine_RP_Reach_Node":"","Text":"","FR-Engine_Re-not-start-in-jar":"JAR.","URL_Certification":"URL","FS-Plugin-Store_Data_Interface":"","FR-Server_Version_Tip":"  ","DS-Text_TableData":"","FR-Chart-Map_Jilin":"","Privilege-Cannot_Load_User_Just_With_Username_When_Use_LDAP":"LDAP","FS-Plugin-Store_Export_Print":"","FR-Engine_Export-Excel-Page":"","Write-Display Type After Edit":"","Null":"","FS-Generic-Page_Number":"","FR-Chart_Cell_Data":"","FS-Module-MobilePush_Setting":"","Component_Scale":"","FR-Designer-Plugin_Warning":"","Chart-Condition_Display":"","Hyperlink-Target_Frame":"","FR-Engine_RP_Process_View":"","Plugin-ChartF_DifferentArcPie_Title":"","Opened":"","Style-Spacing_Before":"","NS_LayerReport_columns":":1107 ","FR-Base-Time_Minute":"","FR-Chart-Map_Second_Title":"","MDX_Explain":"MDX\n\nWITH\nMEMBER [Measures].[Special Discount] AS\n[Measures].[Discount Amount] * 1.5\nSELECT\n[Measures].[Special Discount] on COLUMNS,\nNON EMPTY [Product].[Product].MEMBERS  ON Rows\nFROM [Adventure Works]\nWHERE [Product].[Category].[Bikes]\nCOLUMNSROWS01","FR-Designer_Fit-In-Web":"Pc","Custom_Button_Type_Submit":"","Utils-Move_Down":"","FS-System-Sender_Address":"","Transparent":"","Function-The_class_must_be_located_in":"","Ecp_Convert":"reportlets","Can_Be_Unselected":"","Chart-Table_Data_Not_Found":"","Plugin-ChartF_Preview_Scatter":"","M_Format_A-Border":"(B)","fs_process_endtask_tip":":,","Chart_Bubble_Inside":"","Datasource-TableData_Name":"","Border-Line":"","Form-ComboCheckBox":"","HF-Move_Left":"","FR-Chart-Map_Xizang":"","Plugin-ChartF_Rectangular_Coordinate_System":"","FR-Engine_Hour":"","Black_Font":"","FR-Engine-Flash_Print_Not_Support":"Flash, lic","and":"","Plugin-ChartF_Legend_Ordinary":"","Set_Submit_Condition":"","Gradient-Color":"","HF-NewLine_Des":"","FS-Setting-Style_Choice":"","Plugin-ChartF_NewLine":"","Series":"","Mail":"","Chart_Interval_Back_Color":"","Datasource-Class_datasource_name_cannot_be_null":"","FR-Background_Image_Extend":"","Select_A_Tree_DataSource_To_Build":"","Column_tag":"","Male":"","Data_Connection_Driver_Name":"","FS-Report-No_Dir_Selected":"","FR-Engine_FS_Name":"FS","ChartF-X_Axis":"X","FR-Base_No":"","Image-Image_Files":"","Parameter-Add_Parameter":"","FS-Setting-Homepage_URL_PC":"PC","FR-Base_December":"","LIC-Support_Collapable_Tree_View":"","GROUPING_MODE":"","ComboBox":"","HJS-BCC_to":"","FS-Generic-M_Form_Preview":"","ChartF-Line":"","Event-beforetoword":"Word","ChartF_OneSeriesSet":"","FR-Base_Not_exist":"","BarOutSide":"","LayerPageReport_WN_SubReport":"","FR-Engine_Dialog":"","Sub_Report":"","FR-Engine-ECP_decode_failed":", ","FR-Chart-Type_Radar":"","ChartF_Stock_Volume":"","FR-Engine_Define_Group_Name":"","NS_exception_ps":":1302 ","Female":"","ReportServerP-The_name_of_printer_cannot_be_null":"","FR-Plugin-Plugin_Damaged":"","FR-Engine-Not_NULL":"","Server-Demo_Server":"","FR-Chart-Map_Nanning":"","I-BarStyle_PercentageStack":"","RP_NO_Privilege":"","Chart-Stock_Error":"","ColumnName":"","RP_After_Use":"","FS-Plugin-Store_Switch_Account":"","FR-Engine_Task":"","FR-Engine_Modify_Task_Name":"","DrawChart":"","FS-Setting-Customize_Login_Style_Change_Info":"","FS-User-Ldap_Context":"","FS-Setting-Simple_FS":"","FR-Chart-Bar3DStack_Chart":"","FR-Engine_FS_Task_Start":"","BackgroundTexture-WhiteMarble":"","FR-Engine-Value_Value":"","FS-Generic-True_Run_Interval":"","Top_And_Double_Bottom_Border_Line":"","FR-Chart_Bit_Map":"","Plugin-ChartF_Background":"","CrossReport_Fields":"","FR-Chart-Meter_Van":"()","FR-Chart-Direction_Horizontal":"","FS-System-Email_Receiver":"","YinchuanCity":"","HJS-From":"","ChartB-Should_select_a_summary_column":"","DisplayTheLabel-In-Chart":"","PDF-Print_Setting":"PDF","FR-Designer_Height":"","lic-same-content":"lic","Plugin-ChartF_Highlight":"","FS-Privilege-Simple_Template":"","ChartF-XYScatter":"","Verify-Error_Information":"","FR-Chart-Map_Guangdong":"","Ean13_more_than_12":"Ean131212","FS-Generic-Simple_December":"","FR-Engine_Mobile-show":"","Loading_PDF":"PDF","User_Authentification_Mode":"","FS-Privilege_Template_Tool_Margin":"10","Event-startload":"","Class":"","About-CopyRight":"","Judge":"","FS-Monitor-Resource_Path_Is":"","Datasource-Rename_SAP_datasource":"SAP","NanchangCity":"","Formula_Description":"","Parent":"","Use_Semantic":"","FS-Schedule-Simple_Execute_Time":"","M_Format_W-Support_Write":"","Current_custom_global":"","ReportPageSetting_Message":"-1","FS-Plugin-Store_Mobile_Terminal":"","FR-Designer_Filter_Conditions":"","WLayout-Border-ToolTips":"\n","GroupB-Group_Columns":"","Y_offset":"Y","Registration-The_Registration_code_is_invalid":"","Chart_Line":"","FS-Admin-Use_Tree_Will_Remove_User":"","Ignore_All":"","PreStyle":"","DS-Report_Dictionary":"","FS-Schedule-Execute_Condition_Formula":"","Freeze-Page_Column":"","FR-Designer-Min_Height":"","FR-Engine_Search":"","FR-Engine_Excel-Multi_Import":"Excel","Parameter_Refresh_Waring":"","NS_exception_td":":1301 ","Choose_Different_Server_Data":"","Word":"Word","Horizontal-Split_Layout":"","viewModule":"","Registration-Purchase_Enterprise":"","Receiving_Page":"","Plugin-ChartF_Fixed_Column_Width":"","IS_Key_Equals_Value":"","FR-Engine-Filter_Filter":"","Only_selected_cell_can_paste_only":"","FR-Chart-Style_Retro":"","Utils-Print[PDF]":"[PDF]","FR-Hyperlink_Chart_Cell":"-","CellWrite-Merge_Extra_Blank_Cell(Used_in_Group_Report)":"()","Web-URL":"","FR-Base_Mon":"","Form-Delete":"","Login":"","ChartF-Bar":"","Need_Select_SAP_Task":"","Formula_Tips":"\"=\"","Server-Open_Service_Manager":"","Handle_Affairs":"","Plugin-ChartF_PointMap":"","FR-Designer_Tree-Grade":"","FR-Engine-Condition_Not_End_With":"","Choose_None":"","CrossTable":"","FR-Chart-Map_Zhejiang":"","FS-Generic-Simple_Criterion":"","FR-Designer_Input_Rule":"","Form-NullLayout":"","ChartF-Grid_Line":"","ProcessManager":"","SignIn-Confirm_Closing_The_Designer":"","FR-Engine_PageSetup-Landscape":"","FR-Engine_RP_Deal_With_It_As_Soon_As_Possible":"","Current_Node_Staff":"","Datasource-Are_you_sure_to_delete_the_selected_class_datasource":"","LIC-Support_Online_Write":"","Dimension":"","ChartF-Comb_Chart":"","Basic_Setting":"","Function_Name_Should_Not_Be":"","Mobile-show":"","Registration-Concurrency":"","FR-Designer_Parameter":"","FS-Generic-Already_End":"","M_Format_E-Cell_Expand_And_FatherCell":"(E)","ChartB-Add_Summary":"","FR-Engine_pageModule":"","Include":"","PageSetup-Repeated_Title":"","Chart_DiscardOtherSeries":"()","Undo_Authority":"","FR-Designer_Pagination":"","FR-Engine_JavaScript-Commit_to_Database_Failed":"","FS-Generic-Simple_Send":"","M_Insert-Date":"(D)","FS-Report-Input_Cpt_Name":"","FR-Engine_Please_Set_Repeat_First":"","FR-Basic_Today":"","ChartF-Stacked":"","DBCP_TEST_WHILE_IDLE":"","Plugin-ChartF_Axis_Rotation":"","FR-Engine_Task_Submit":"","Tips:You_Can_Input_B1_To_Input_The_Data_Of_The_First_Row_Second_Column":":B1","Chart-Use_Value":"","WF-Previous_User":"","FR-Engine_LayerReport":"","Form-Target":"","FR-Engine_Enter_Task_Name":"","FR-Designer-Basic_Restart_Designer":"","FS-Monitor-Total_Memory":"","EmailPane-warnings":"","User_TableData":"","FR-Engine_Short-Feb":"","Feature_Name":"","NS_exception_deathCircle":":1303 ","Chart-Chart_Alert":"","DashBoard-MainFunction":"","FR-Basic_Loading":"","FS-Generic-Simple_Type":"","Docking-Fix":"","GroupB-Page":"","Server_Usage":"","StartSuccessfully":"","Plugin-ChartF_Preview_Percent_Stack_Bar":"","Modify_Column":"","Data_Submit_Error":"","WF-Previous_User_Relation":"","FR-Chart_DataLabelInside":"","Plugin-ChartF_Gauge_Pointer":"360","FS-Privilege-Grade_Authority":"","CellWrite-Page_Before_Column":"","Custom_Button_Target_Type":"","Register_Version":"","CellWrite-Flag":"","Utils-The-WorkBook":"","FR-Chart-Column_Van":"()","FR-App-Template_Form":"","FR-Engine_Privilege_Allocate":"","Default_value":"","Custom_Roles":"","Want_To_Cover_It":"","FS-Monitor-Model_Using":"","NS_LayerReport_expandAttr":":1104 ","Utils-Current_Row":"","Chart-Layout_Right":"","FS-Plugin-Store_Not_Null":"","FR-mobile_native_analysis":"","Divided_stage":"","Utils-Left_to_Right_a":"","FR-Designer-Plugin_All_Plugins":"","Import_Export-Excel":"Excel","FR-Designer-Plugin_Plugin_Description":"","DashBoard-ChartFloat":"","FS-System-Connection_Pool":"","FS-Report-Add_Template_Width":"58","Original":"","FR-Designer-Plugin_Uninstall_Successful":"","RP_Alert_Mode":"","Form-EC-WebAttr-toolbar":"","ChartF-Funnel":"","Plugin-ChartF_Change":"","FR-Designer-Dependence_Need_Install":"","Chart-Area_Title":"","Chart-Default_Name":"","FR-Chart-Data_CombineOther":"\"\"","FR-Engine_HJS-Specified_Pages":"","Define":"","Chart_Exponent":"","Reload":"","Export-Text":"()","HF-Insert_New_Line":"","Task_List_To_Choose":"","FR-Chart-Version_Local":"","FS-Generic-HJS_CC_To":"","FR-Designer_Background":"","GroupB-Report_Header_Page":"","baseModule":"","Always_Execute":"","FR-Designer-Widget-Style_Common":"","Free_Report_Wizard":"","ExtraRepeatTime":"","FR-Engine_Excel_poi_2007":":1207 Excel2007libpoi","FR-Utils-App_AllFiles":"","FR-Engine-Err-The_Number_Is_Larger_Than_The_Maximum_Value":"","FR-Engine_RP_Send_Date":"","Layer-Wake_Up_Thread_For_Page_Retriever":"","FR-Engine_Email":"","Mobile_BI":"","PostAttachment":"","FR-Engine_RP_Alert_Mode":"","AddFailed":"","Edit_Button_ToolBar":"","Forbid_Drag_into_Adapt_Pane":"","Scheduler-parameters_were_found_,_Are_you_sure_to_apply_now":"","Plugin-ChartF_Preview_Pointer_Gauge":"360","Row-Axis":"","Utils-File_type":"","FS-Schedule-Interval_Execute_Once":"","FS-Special-Sure_To_Delete":"","Year":"","Schedule-Remove_Task":"","Chart-Link_Web":"","FR-Chart-TimeUnit_Year":"","FR-Designer_Rename":"","Preference-Menu_Configuration":"","BackgroundTexture-Oak":"","Highlight-Click_to_Choose_Property_To_Modify":"","FS-Monitor-Log_Setting":"","M-Page_Setup":"","FR-Base_August":"","AnalysisLine":"","file-is-locked":"","FR-Lic_does_not_Support_Remote":"liclic","FR-Chart-Category_Name":"","Docking-Unpin":"","RP_Node_Description":"","FR-Engine-Loading_PDF":"PDF","Index":"/","Chart-Stock_Volume":"","Utils-Selected_Option":"","NS_exception_readError":":1305 ","Need":"","CellWrite-Preview_Cell_Content":"","FRFont-Shadow":"","FR-Basic_Calendar":"","FS-Schedule-Please_Select":"","StyleAlignment-Single_Line(Adjust_Font)":"()","ChartF-Icon_Border_Color":"","Failed":"","FormulaD-Date_&_Time":"","Color":"","Setting-Ruler-Units":"","Plugin-ChartF_Location":"","Datasource-Maximum_Number_of_Preview_Rows":"","DS-Databse_Info_Save_Des":"\"/WEB-INF/resources/datasource.xml\"","ChartF-Legend_Count":"","User-DefinedType":"","Sche-Week":"","Logarithmic":"","Plugin-Chart_Alpha":"","FS-Generic-Sure_To_Delete":"","FR-Basic_Report":"","FS-Generic-EmailPane_BCC":"","FS-Monitor-Suggestion_Add_Name":"","Description_things":"","Unit_Hundred_Million":"","ToolBar_Top":"","Re-system-version":"","FS-System-Event_Submitfailure":"","M_Window-Frozen_WindowGrid":"(F)","FR-Engine_FreezeWarning1":"","Schedule-Template":"","RP_Task_Operations":"","M-Repeat-Freeze":"","Env-Invalid_User_and_Password":"","Agency":"","FR-Designer-Widget-Style_Border_Color":"","FS-Msg-Delete_Chosen":",","FS-Monitor-Suggestion_FS_Report":"FS","Purple":"","BorderLayout-North":"","hasRelation":"","plugin-ChartF-MatchColor":"","Plugin-ChartF_Start_Point":"","Image":"","Utils-Switch_To_Class_Reportlet":"","Create_Free_Report":"","ExpandD-Expand_Direction":"","Env-Des2":"ServletWEBServletServlet\"http://localhost:8080/ReportServer\"WEBServletServlet","Plugin-ChartF_LineStyle":"","product_feedback":"","General-ToolBar":"","Example":"","FS-Mobile-Add_Mac_Address":"mac","ReportServerP-Edit_Printer":"","FR-Engine_Parameter-Integer":"","This_Template_Has_Exist":"","I-PieStyle_Normal_Seperate":"","Platform_Module_WidgetletManager":"","Page_Number":"","Utils-Segment_Not_existed":"","Actions":"","M_Window-Preference":"","Show_Blank_Column":"","M_Help-API_Document":"API(A)","FR-Designer_Form-TextArea":"","Utils-Would_you_like_to_save_the_report":"","Utils-Insert_Record":"","Beijing":"","WF-Work_Flow":"","CellWrite-Hide_Row_If_Null":"","ECP_start_encode":"","Over-Sheet":"Sheet","FRFont-Effects":"","Select_Date":"","FR-Engine_Not_Allow_Null":"","FR-Designer_Remove":"","HF-Edit_Header/Footer":"/","FR-Designer_Fit-Elementcase":"","Frame":"","Chart-StyleAlignment_Bottom":"","Plugin-ChartF_Funnel_Shape":"","Event-beforepdfprint":"PDF","FR-Engine-PageSetup_Portrait":"","FR-Engine_SSAS-TableData":"SSAS","FR-Basic-Email_Message":"","SAP_column_name":"SAP","Form-Iframe":"","MSBold":"","FR-Designer_Connect_SQL_Cannot_Null":"SQL","FR-Template-Path_chooseRightPath":"","Save_Result":"","Plugin-ChartF_Word_Name":"","FR-Designer-Widget-Style_Frame_Style":"","INFO-Start_Reading_XML":"XML","BiasD-Slope_Line":"","FR-Engine_NameWidget-Name":"","M_Insert-Boolean":"(O)","Plugin-ChartF_Level":"","fs_process_para_message_tip":"","Export-Excel-LargeData-Page-Info":"","FR-Designer_Sche-Week":"","About-All_Rights_Reserved":"","the_template":"","ChartF-Volume-Open-High-Low-Close":"----","Enlarge_Or_Reduce":"","ParameterD-The_Second_List":"","Data_Setting":"","NotSupportIMG&ReportData":"","Utils-Default_Value":"","LIC-Support_Multi_Env":"","Import-Translate":"","FR-Widget_Mobile_Table":"","FR-Chart-Line_Van":"()","TaiyuanCity":"","File_Error":"","Cell":"","FS-Web-Plugin_Install_Failed":"","CellWrite-Hide_Cell":"","FR-Chart-Gap_Series":"","CommaDismenber":"","RP_Urgent":"","CellWrite-ToolTip":"","MConfig-CancelButton":"","Plugin-Theme_Select":"","FR-Engine_Plugin_Expire_Dialog_Text":",","M_Report-Report_Columns":"","FS-Admin-Unknown_Error":"","FS-Schedule-Simple_Execute_Time_Unit_Month":"","Plugin-ChartF_Preview_Stack_Area":"","FR-Engine_RP_Node_Name":"","File-Create-Failed":"","Warnning":"","Return_set_name":"","MainGraduationLine":"","ChartF-RadarAxis":"","Height":"","Click-Me":"","FR-Designer-Form-ToolBar_Widget":"","Gradient_Left_Color":"","Env-Des1":"WEB-INF","M-Data_Analysis":"","Plugin-ChartF_Position_Top":"","BorderLayout-South":"","FR-Chart-Axis_labelShowway":"","User_Defined_Event":"","DataList":"","Chart-Series_Drag":"","FS-System-Select_Tip":"","FS-Monitor-Log_Copy":"","FR-Engine_Confirm":"","I-HBarStyle_3D":"","Sche-Thursday":"","FS-User-Do_Select_Department":"","FS-PSqlInj-Special_Char":"","FR-Engine-Page_Number":"","Form-EC_heightrestrict":"","Data_Fields_will_be_displayed":"","Chart-Scatter_Name":"","ParameterD-Should_select_a_reportlet_first":"Reportlet","FR-Engine-NS_export_excelCellBg":":1112 Excel","Output_Excel":"Excel","FR-Engine_Hana-database":"Hana","M-Popup_ChartOption":"","Utils-Merge_datasource_files_successfully":"","Sure_To_Open_Synch_Data_Sets":"","FR-Engine-Condition_Not_In":"","ExpandD-Expand_Type":"","For_Help_press F1":"F1","SQLWizard-pack_all_entities":"","Perspective Projection":"","FS-Monitor-Server_Setting_Detection":"","FR-Engine_Offline-ReadMe":"html\r\n\r\n\r\n(Cookie)","After_Click_Widget_Show":"","StyleAlignment-Vertical":"","Sytle-Indentation":"","Not_Allow_To_Upload_File":"","Dic-Only_Can_Delete_DataDictionary":"","Cannot-Add_To_This_Area":"","FR-Engine-Sort_Descending":"","PostCode":"","Plugin-ChartF_Level_Order":"","FR-Engine_Please_Enter_Role_Name":"","PDF_Print":"PDF","FS-Admin-Authentication_failed":"","FS-Reg_Function_Name_List":"","RP_Cpt_Operation":"","Verify-ToolTips":"","StyleAlignment-Text_Style":"","FS-Template_Add_Parameter":"","Max_Peak_Limit":"","ToolBar_Bottom":"","Plugin-ChartF_Up_Tree_Map":"","FR-Engine_Please_Select":"","FS-System-View_All":"","Version-does-not-support-map":"liclic","FormulaD-Valid_Formula":"","Scheudle-Invalid_Template_File_Name":"","RP_Sender":"","FR-Designer_Restore_Default":"","FR-Designer-Basic_Activation_Key_Copy_OK":"","AbsoluteLayout":"","FS-Generic-Save_Path":"","IS_Need_Password":"","M_Edit-Bring_to_Front":"(T)","Task_Has_Been_Closed":"","Needle":"","Parameter-Formula":"","Function-Program_Function":"","Plugin-ChartF_Close":"","clickToCancel":"","FS-Generic-Privilege_Name_Not_Match_Password":"","Chart-SetMainGridStyle":"","FS-Reg-Fail_Tip":"","Please_Rename":"","FR-Designer-FRFont_Line_Style":"","DashBoard-ReportsPrint":"","Meter-Style":"","This_ScheduleTask_Is_Not_Exsit":"","FR-Engine_STXingKai":"","Event-showWidgets":"","Utils-Can_not_find_the_corresponding_TableData":"","Plugin-ChartF_Bottom_Data_Sum":"","BorderLayout-Center":"","Plugin-ChartF_Preview_Point_Map":"","WF-Basis":"","Row_Cell":"","Plugin-ChartF_Cloud":"","General":"","FS-System-Config_Backup_Complete":"","FR-Base_Short_Dec":"","Sche-Sunday":"","Column_Measure":"/","FS-Mobile_Unauthorized_Users":"","FS-Schedule-Execute_Period_Time_Unit_Month":"","FS-Generic-Simple_Query":"","StartValue":"","Utils-Merge_Cell":"","Inside":"","Driver":"","FS-System-FlashP_Need_Page_Selection":"Flash","Chart-Use_Refresh":"","FR-Engine_RP_Deliver":"","FR-Base_is":"","FS-System-Report_Manager_Detection":"","FR-Engine_Alert":"","Use_FormulaGroup":"","Chart-Unit_Hundred_Million":"","ChartF-PieNoneSeperate":"","FR-Engine_Please_input_with_right_format":"","FR-Basic-File_All_File_Uploaded":"","Schedule-Edit_Time":"","FR-Engine_Please_Rename":"","ReportServerP-Pre_concurrency":"","Y_Axis":"Y","FS-Frame-Button_Refresh":"","Plugin-ChartF_NewRadar":"","FR-Designer_Fit-App":"App","ColorMatch":"","I-BarStyle_Normal":"","HF-Edit_Header":"","FS-User-Department_Management":"","D-Dispaly_Divide_Result_Set_into_Groups":"","FS-Schedule-Step_Margin_Left":"22","Local-file":"","FS-Plugin-Store_Net_Connect_Failed":"","Platform":"","Import_Again":"","FR-Engine-Please_Install":"","At_least_one_visual_worksheet":",","Para-Help_Info":"","Plugin-ChartF_Layer_PlainJane":"","CapsLock":"","Neimenggu":"","seconds":"","FR-Base_Sche_Second":"","Chart-Step_Index":"","Form-Allow_Edit":"","Plugin-ChartF_Rotation":"","FR-Engine_SimgleNumber":"","FR-Engine_Custom_Sort":"","FR-Designer-Plugin_Install_Failed":"","Form-Layout":"","FRFont":"","FR-App-File_Message":"","FR-Engine_Lic_Update":"Flash, lic","BackgroundTexture-Granite":"","SQLWizard-would_you_like_to_continue":"","ChongqingInCity":"","Next":"","ChartF-Alpha":"","Chart-DS_Embedded_TableData":"","FS-Frame-Delete_Data":"","BindColumn-Extend_the_conditions_of_fatherCell(Applied_to_the_data_contains_other_data)":"()","PolyAccessWarning-NotSupport":"","RP_Son_Task_Not_Complete":"","Whether_Reinstate_Report":"","FS-Privilege_Please_Contact_Platform_Admin":"","FS-Generic-Import_2":"","Plugin-ChartF_YES":"","FR-Engine-Condition_Equals":"","Cannot_Get_Date_Format":"","FS-CustomStyle_Toast_Prompt":"","BindD-Need_to_select_columns_to_display":"","I-Message_FunctionGrouper_2":"\u201c$$$\u201d","I-Message_FunctionGrouper_1":"","BorderLayout-East":"","Waring_you":"","Chart-Bubble_X":"X","Plugin-ChartF_Button_Style":"","Plan":"","FS-Privilege-Simple_View":"","WorkSheet":"","FR-Chart-Map_Henan":"","Active_Connection_Size":"","Action-Type":"","FS-Report-Add_Link":"","FS-Generic-Simple_Time":"","Vertical-Split_Layout":"","Plugin-ChartF_View_Center":"","BackgroundTexture-Sand":"","Chart-Meter_Field":"","Import-Excel_File":"Excel","Report-WorkFlow_Attributes":"","FR-Designer_Dimension":"","FS-Generic-Report_Type":"","FS-Generic-I_Created":"","Chart_PaintInSeries":"","FS-User-Delete_Template":"","FS-Mobile-Report_Cover":"","FS-Report-Simple_Path":"","FS-Generic-DataFunction_None":"","ChartF-Sets_Alert_Range":"","FR-Chart-Map_Shanxi":"","FS-Schedule-Task_Name_Should_Not_Be_Empty":"","FR-Engine_SAP-TableData":"SAP","StyleFormat-Sample":"","FS-User-Simple_Authentication":"","SpecifiedG-New_Group":"","FR-Engine-Write_Submit_Failed_Reminder":"","3D-Style":"","Setting":"","Please_Select":"","Recursion":"","Printer-All_Printers":"","FormulaD-Logical":"","FR-Basic_Cancel":"","FR-Engine-NS_exception_readError":":1305 ","FS-Frame-Simple_Save":" ","Please_Enter":"","Privilege-Select_Roles":"","SAP":"SAP","ModifySecretWillRemoveUser":"","Printer-Alias":"","FS-Admin-First_Set_Platform":"","FR-Chart-Area_Van":"()","Datasource-Database_Type":"","Shaanxi":"","Printer-Edit_All_Printer_Groups":"","Custom_styles_lost":"","Out_Border_Line":"","FR-Utils-Please_Input_a_New_Name":"","Plugin-ChartF_Custom_Axis":"","M_Edit-Clear":"(A)","FR-Engine_Importing":"","Add_Member":"","ReportColumns-None":"","Function_browser":"","Plugin-ChartF_ValueDefinition":"","FS-Schedule-Execute_Period":"","satisfy":"","FR-Engine-Choose_None":"","Plugin-ChartF_AlertSet":"","FR-Chart-Env_Directory":"","FS-Privilege-Post_All":"","Common_Condition":"","FS-Reg-Unregister_Version":"","Plugin-ChartF_WMS_Layers":"wms","FR-Designer-LayerPageReport_PageQuery":"","FS-Reg-Unregister_Tip":"WEB-INF/resources\nIP2","Chart-Unit_Hundred_Thousand":""},
    /**
     * 
     * @param key 
     * @returns {String} 
     * @example
     *    FR.i18nText("Click");//""
     *    FR.i18nText("Sum({R1}, {R2}) = 3", 1,2);//"Sum(1, 2) = 3"
     */
    i18nText: function (key) {
        var localeText = FR.i18n[key];
        if (!localeText) {
            localeText = key;
        }
        var len = arguments.length;
        if(len > 1){
            for(var i = 1;i<len;i++){
                var key = "{R"+i+"}";
                localeText = localeText.replaceAll(key, arguments[i]+"");
            }
        }
        return localeText;
    },

    /**
     * 
     * @param key 
     * @returns {String} 
     */
    plainText : function(key) {
        return this.chinese[key] || key;
    },

    /**
     * 
     * @param key 
     * @param fontWidth 
     * @returns {number} 
     */
    i18nTextWidth: function (key, fontWidth) {
        return FR.byteLength(this.i18nText(key)) * (fontWidth ? fontWidth : 6);
    }
});if(window.FR==null){window.FR={}}$.extend(FR,{$defaultImport:function(){var b=arguments;if(b[0]&&typeof b[0]==="object"){var a=$.extend({op:"resource",path:null,type:null,must:false},b[0]);a.url=FR.servletURL+"?op="+a.op+"&resource="+a.path;this.$import(a.url,a.type,a.must)}else{if(b[0]!=null){b[0]=FR.servletURL+"?op=resource&resource="+b[0]}this.$import.apply(null,b)}},$import:function(){var b={};function a(d,c){var f=$("head script");$.each(f,function(g,h){if(h.src.indexOf(d)!=-1){b[d]=true}});
var e=$("head link");$.each(e,function(g,h){if(h.href.indexOf(d)!=-1&&c){b[d]=false;$(h).remove()}})}return function(g,e,c){a(g,c);if(b[g]===true){return}if(e==="css"){var f=document.createElement("link");f.rel="stylesheet";f.type="text/css";f.href=g;var d=document.getElementsByTagName("head")[0];d.appendChild(f);b[g]=true}else{$.ajax({url:g,dataType:"script",async:false,cache:true,complete:function(i,h){if(h=="success"){b[g]=true}}})}}}()});
$.extend(FR,{Events:{NOSELECT:"NOSELECT",EDITDATA:"EDITDATA",REMOVEDATA:"REMOVEDATA",REMOVESELF:"REMOVESELF",RESIZE:"_resize",BEFOREEDIT:"beforeedit",AFTEREDIT:"afteredit",VALUECHANGE:"valuechange",STOPEDIT:"stopedit",CHANGE:"change",EXPAND:"expand",COLLAPSE:"collapse",STATECHANGE:"statechange",CALLBACK:"callback",CLICK:"click",BEFORESTATECHANGE:"beforestatechange",DEALSELECTEDNODES:"dealselectednodes",AFTERBUILD:"afterbuild",AFTERREAD:"afterread",APPENDDATA:"appenddata",DEFAULTINIT:"defaultinit",TABCHANGE:"tabchange",TABCHANGESTART:"tabchangestart",SCROLLCHANGE:"scrollchange",AFTERINIT:"afterinit",STARTLOAD:"startload",AFTERLOAD:"afterload",INIT:"init",CELLVALUECHANGE:"cellvaluechange",BS:"beforesubmit",AS:"aftersubmit",SC:"submitcomplete",SF:"submitfailure",SS:"submitsuccess",BVW:"beforeverifywrite",AVW:"afterverifywrite",AV:"afterverify",BW:"beforewrite",AW:"afterwrite",WS:"writesuccess",WF:"writefailure",BA:"beforeappend",AA:"afterappend",BD:"beforedelete",AD:"beforedelete",UC:"unloadcheck",BTOPDF:"beforetopdf",ATOPDF:"aftertopdf",BTOEXCEL:"beforetoexcel",ATOEXCEL:"aftertoexcel",BTOWORD:"beforetoword",ATOWORD:"aftertoword",BTOIMAGE:"beforetoimage",ATOIMAGE:"aftertoimage",BTOHTML:"beforetohtml",ATOHTML:"aftertohtml",BIMEXCEL:"beforeimportexcel",AIMEXCEL:"afterimportexcel",BPDFPRINT:"beforepdfprint",APDFPRINT:"afterpdfprint",BFLASHPRINT:"beforeflashprint",AFLASHPRINT:"afterflashprint",BAPPLETPRINT:"beforeappletprint",AAPPLETPRINT:"afterappletprint",BSEVERPRINT:"beforeserverprint",ASERVERPRINT:"afterserverprint",BEMAIL:"beforeemail",AEMAIL:"afteremail",CARDCHANGE:"cardchange"}});
$(function(){if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(c){if(this===void 0||this===null){throw new TypeError()}var e,b,d=Object(this),a=d.length>>>0;if(a===0){return -1}e=a-1;if(arguments.length>1){e=Number(arguments[1]);if(e!=e){e=0}else{if(e!=0&&e!=(1/0)&&e!=-(1/0)){e=(e>0||-1)*Math.floor(Math.abs(e))}}}for(b=e>=0?Math.min(e,a-1):a-Math.abs(e);b>=0;b--){if(b in d&&d[b]===c){return b}}return -1}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;
var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}});$.extend(Array.prototype,{weakIndexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(FR.equals(c,this[b])){return b}}return -1},weakLastIndexOf:function(c){for(var a=this.length,b=a-1;b>=0;b--){if(FR.equals(c,this[b])){return b}}return -1},remove:function(b){var a=this.weakIndexOf(b);if(a!=-1){this.splice(a,1)}return this},clear:function(){while(this.length>0){this.pop()
}}});(function(){$.fn.swapClass=function(b,a){return b==undefined?this.removeClass().addClass(a):this.removeClass(b).addClass(a)};$.fn.switchClass=function(b,a){if(this.hasClass(b)){return(a||a===0)?this.swapClass(b,a):false}else{return this.swapClass(a,b)}};$.fn.isChildOf=function(a){var c=this;var e=c[0];var d=a[0];var f=e.parentNode;while(f){if(f==d){return true}else{if(!f.tagName||f.tagName.toUpperCase()=="HTML"){return false}}f=f.parentNode}return false};$.fn.isChildAndSelfOf=function(a){return(this.closest(a).length>0)
};$.fn.mousewheel=function(a){return this.each(function(){var b=this;b.D=0;if(FR.Browser.isIE()||FR.Browser.r.safari||FR.Browser.r.chrome){b.onmousewheel=function(){b.D=event.wheelDelta;event.returnValue=false;a&&a.call(b)}}else{b.addEventListener("DOMMouseScroll",function(c){b.D=c.detail>0?-1:1;c.preventDefault();a&&a.call(b)},false)}})};$.extend($.Event.prototype,{stopEvent:function(){this.stopPropagation();this.preventDefault()}})})();$.extend(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")
},leftPad:function(d,b,c){var a=String(d);if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}});$.extend(String.prototype,{startWith:function(a){if(a==null||a==""||this.length===0||a.length>this.length){return false}return this.substr(0,a.length)==a},endWith:function(a){if(a==null||a==""||this.length===0||a.length>this.length){return false}return this.substring(this.length-a.length)==a
},getQuery:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=this.substr(this.indexOf("?")+1).match(b);if(c){return unescape(c[2])}return null},appendQuery:function(a){if(!a){return this}var b=this;if(b.indexOf("?")===-1){b+="?"}if(b.endWith("?")!==false){}else{b+="&"}$.each(a,function(c,d){if(typeof(c)==="string"){b+=c+"="+d+"&"}});b=b.substr(0,b.length-1);return b},replaceAll:function(b,a){return this.replace(new RegExp(b,"gm"),a)},perfectStart:function(a){if(this.startWith(a)){return this
}else{return a+this}},allIndexOf:function(b){if(typeof b!="string"){return[]}var e=this;var a=[];var d=0;while(e.length>0){var c=e.indexOf(b);if(c===-1){break}a.push(d+c);e=e.substring(c+b.length,e.length);d+=c+b.length}return a}});$.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c){var d=this;var b=arguments[1];var a=arguments[2];return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);
f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c||c===0){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this
}var c=this;return function(){var d=c.apply(this||window,arguments);b.apply(a||this||window,arguments);return d}},getNameArguments:function(){var d=this.toString();var c=/function[^\(]*\(([^\)]*)\)/.exec(d);var b=[];if(c!=null){b=c[1].split(",")}return $.map(b,function(a){return $.trim(a)})},arguments2Json:function(){var a=arguments;var b=this.getNameArguments();var c={};$.each(b,function(d,e){if(a.length>d){c[e]=a[d]}});return c}});if(window.FR==null){window.FR={}}if(window.FR.servletURL==null){window.FR.servletURL={}
}$.extend(FR,{Plugin:{validLevel:function(d,c){var a=d.version||1;var b=c.version||1;return a>=b}}});var browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(d)||d.indexOf("edge")>-1,edge:d.indexOf("edge")>-1,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera&&!c.ie);var a=0;c.isInnerHtmlSuitable=true;
if(c.ie&&!c.edge){var g=d.match(/(?:msie\s([\w.]+))/);var f=d.match(/(?:trident.*rv:([\w.]+))/);if(g&&f&&g[1]&&f[1]){a=Math.max(g[1]*1,f[1]*1)}else{if(g&&g[1]){a=g[1]*1}else{if(f&&f[1]){a=f[1]*1}else{a=0}}}c.ie11Compat=document.documentMode===11;c.ie9Compat=document.documentMode===9;c.ie10Compat=document.documentMode===10;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode===8;c.ie7Compat=((a===7&&!document.documentMode)||document.documentMode===7);c.isInnerHtmlSuitable=(a===9&&c.ie9Compat)||(a===10&&c.ie10Compat)||(c.ie&&a===11&&c.ie11Compat)||(a===8);
c.ie6Compat=a<7;c.ie8bellow=a<8;c.ie9above=a>8;c.ie9below=a<9;c.ie11above=a>10;c.ie11below=a<11}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;return c
}();$.extend(FR,{Browser:{r:browser,isIE6:function(){return browser.ie6Compat},isIE7:function(){return browser.ie7Compat},isIE8:function(){return this.getIEVersion()===8},isIE9:function(){return this.getIEVersion()===9},isIE10:function(){return this.getIEVersion()===10},isIE11:function(){return browser.ie&&browser.version===11},isIE8Before:function(){return this.getIEVersion()<9},isIE6Before:function(){return this.getIEVersion()<7},isIE7Before:function(){return this.getIEVersion()<8},isIE9Later:function(){return browser.ie9above
},getIEVersion:function(){return browser.ie?browser.version:undefined},isIE:function(){return browser.ie},isEdge:function(){return browser.edge}}});(function(){$.extend(FR,{cjkEncodeDO:function(b){if($.isPlainObject(b)){var a={};$.each(b,function(d,c){if(!(typeof c=="string")){c=FR.jsonEncode(c)}d=FR.cjkEncode(d);a[d]=FR.cjkEncode(c)});return a}return b},ajax:function(a){if(a){a.data=FR.cjkEncodeDO(a.data)}$.ajax(a)},get:function(a,c,d,b){if($.isFunction(c)){b=b||d;d=c;c=undefined}if(c){c=FR.cjkEncodeDO(c)
}$.get(a,c,d,b)},post:function(a,c,d,b){if($.isFunction(c)){b=b||d;d=c;c=undefined}if(c){c=FR.cjkEncodeDO(c)}$.post(a,c,d,b)},param:function(b){b=FR.cjkEncodeDO(b);return $.param(b)},url:function(a,b){if($.isPlainObject(b)){return a+"?"+FR.param(b)}return FR.cjkEncode(a)},buildServletUrl:function(b,a){if(a){b=$.extend({_:(""+new Date().getTime())},b)}return FR.url(FR.servletURL,b)},resource:function(a){return FR.buildServletUrl({op:"resource",resource:a})},tc:function(c,b,a){try{return c.apply(b,a)
}catch(d){FR.Msg.toast(d.toString());throw d}},pick:function(){var a,c=arguments.length;for(var b=0;b<c;b++){a=arguments[b];if(typeof a!=="undefined"&&a!==null){return a}}return null}})})();(function(){$.extend(FR,{formulaEvaluator:function(d,b,a){var c=b;return function(f){if(f||c==undefined||a){try{if(FR.SessionMgr.getSessionID()){c=FR.remoteEvaluate(d)}}catch(g){}}return c}},remoteEvaluate:function(b){var a=null;b=encodeURIComponent(b);FR.ajax({url:FR.servletURL,type:"POST",async:false,data:{op:"fr_base",cmd:"evaluate_formula",sessionID:FR.SessionMgr.getSessionID(),expression:b},timeout:5000,complete:function(d,c){a=FR.jsonDecode(d.responseText);
a=a["result"]}});return a}})})();(function($){var COL_IDS="ABCDEFGHIJKLMNOPQRSTUVWXYZ";$.extend(FR,{limitData:500,constant:{success:"success",failure:"failure"},emptyFn:function(){},parseINT:function(str){return parseInt(str,10)},isWidthOrHeight:function(o){if(typeof o=="number"){return o>=0}else{if(typeof o=="string"){return/^\d{1,3}%$/.exec(o)||o=="auto"||/^\d+px$/.exec(o)}}},number2Percentage:function(number){return(~~(number*100))+"%"},isArray:function(a){return Object.prototype.toString.call(a)=="[object Array]"||a instanceof jQuery
},applyStyles:function($el,styles){if($el instanceof jQuery&&styles){if(typeof styles=="string"){var re=/\s?([a-z\-]*)\:\s?([^;]*);?/gi;var matches;while((matches=re.exec(styles))!=null){$el.css(matches[1],matches[2])}}else{if(typeof styles=="object"){$el.css(styles)}else{if(typeof styles=="function"){FR.applyStyles(dom,styles.call())}}}}},showMenuByEvent:function(o,evt,evtPosition){if(evtPosition===true){FR.showMenuByLocation(o,{left:evt.clientX,top:evt.clientY},{left:-5,top:-5})}else{if(evt.target){FR.showMenuByEl(o,$(evt.target))
}else{FR.showMenuByLocation(o,{left:evt.clientX,top:evt.clientY+10})}}},isEmptyArray:function(array){if($.isArray(array)){if(array.length===0){return true}else{if(array.length===1){return array[0]===""}}}return false},applyFunc:function(obj,func,param,defaultValue){if((typeof func)=="function"){return func.apply(obj,param?param:[])}return defaultValue},encodePrecentPlus:function(s){if(typeof(s)=="string"){s=s.replace(/%/gi,"%25");s=s.replace(/\+/gi,"%2B")}else{if(FR.isArray(s)){for(var i=0;i<s.length;
i++){s[i]=FR.encodePrecentPlus(s[i])}}}return s},showMenuByEl:function(o,$el){var menu;if($el.fr_menu&&$el.fr_menu.menu&&(FR.equals($.extend({xxxMMenu:true},o),$el.fr_menu.opts)||$el.fr_menu.menu.close())){menu=$el.fr_menu.menu}else{o.$el=$el;menu=FR.createShortMenu(o);delete o.$el}var modify=1;if($el.offset().top<menu.$menuRoot.height()+modify||$el.offset().top+$el.height()+modify+menu.$menuRoot.height()<document.body.clientHeight){var offsetTop=$el.offset().top+$el.height()+modify}else{var offsetTop=$el.offset().top-menu.$menuRoot.height()-modify
}o.xxxMMenu=true;menu.show();menu.position($el.offset().left,offsetTop);$el.fr_menu={"menu":menu,"opts":o}},showMenuByLocation:function(o,location,modify){if(!modify){modify={left:0,top:0}}var menu=FR.createShortMenu(o);FR.showWithMenu(menu,location,modify)},showWithMenu:function(menu,location,modify){if(location.left<menu.$menuRoot.width()+modify.left||location.left+modify.left+menu.$menuRoot.width()<document.body.clientWidth){var left=location.left+modify.left}else{var left=location.left-menu.$menuRoot.width()-modify.left
}if(location.top<menu.$menuRoot.height()+modify.top||location.top+modify.top+menu.$menuRoot.height()<document.body.clientHeight){var top=location.top+modify.top}else{var top=location.top-menu.$menuRoot.height()-modify.top}menu.show();left=FR.Browser.isIE()?left-5:left;top=FR.Browser.isIE()?top-5:top;menu.position(left,top)},versionRemind:function(o){var jo=FR.jsonDecode(o);if(jo.exception=="failpass"){var msg=FR.i18nText("FR_FS-FailPass_ImproveYourVersion");if(jo.func){msg=jo.func+", "+msg}FR.Msg.toast(msg);
return false}return true},createShortMenu:function(o){o=$.extend({minWidth:80,destroyOnClose:true},o);return new FR.frMenu(o)},doHyperlink:function(){function _doHyperlink(data){new Function(unescape(data))()}return function(evt,obj,evtPosition){if($.isArray(obj)){switch(obj.length){case 0:return;case 1:FR.doHyperlink(evt,obj[0]);break;default:var _noMenuHyperlink=function(data){return data&&(data.indexOf("changeParameter")>=0||data.indexOf("_g().name_widgets[")>=0)};var noMenuHyperlink=[];var otherHyperlink=[];
for(var i=0;i<obj.length;i++){var data=obj[i].data;if(_noMenuHyperlink(data)){noMenuHyperlink[noMenuHyperlink.length]=obj[i]}else{otherHyperlink[otherHyperlink.length]=obj[i]}}for(var i=0;i<noMenuHyperlink.length;i++){try{_doHyperlink(noMenuHyperlink[i].data)}catch(e){FR.Msg.toast(e.message)}}switch(otherHyperlink.length){case 0:return;case 1:FR.doHyperlink(evt,otherHyperlink[0]);break;default:FR.showMenuByEvent({items:$.map(otherHyperlink,function(cfg){return{src:cfg.name,handler:_doHyperlink.createCallback(cfg.data)}
})},evt,evtPosition||false)}}}else{_doHyperlink(obj.data)}}}(),doHyperlinkByGet:function(url,para,target,feature){if(arguments.length<1){return}var options=arguments[0];if(typeof options==="object"){url=options.url||"";para=options.para||{};target=options.target;feature=options.feature}para=$.extend({_:new Date().getTime()},para);var pString="";var paras={};$.each(para,function(pName,pValue){if(FR.isArray(pValue)&&!FR.isEmptyArray(pValue)&&FR.isArray(pValue[0])){pValue=pValue.join(";")}var tmpName=FR.cjkDecode(pName);
var tmpValue=FR.cjkDecode(pValue);paras[pName]=pValue;if(tmpName!="__LOCALE__"&&tmpName!="REPORTLET"&&tmpName!="OP"){pString+="&"+encodeURIComponent(tmpName)+"="+encodeURIComponent(tmpValue)}});if(url.indexOf("?")==-1){url+="?";pString=pString.substring(1)}var targetUrl=url+pString;if(this.shouldGet(target)){this.doHyperlinkActionByGet(targetUrl,target,feature,options.title)}else{if(this.shouldPost(targetUrl,target)){var submitForm=$("<form method='post' target='"+target+"' action='"+url+"'></form>").hide().appendTo($("body"));
for(var i in paras){$('<input type="hidden" name="'+i+'" value=""/>').attr("value",paras[i]).appendTo(submitForm)}submitForm.submit()}else{this.doHyperlinkActionByGet(targetUrl,target,feature,options.title)}}},showHyperlinkDialog:function(url,feature){var isIEUnder8=FR.Browser.isIE8Before();var iframeWidth=isIEUnder8?"99%":"100%";var iframeHeight=isIEUnder8?"99%":"100%";var iframeDialog="<iframe src='' width="+iframeWidth+" height= "+iframeHeight+" scrolling='no' frameborder='0'></iframe>";iframeDialog=$(iframeDialog).attr("src",url)[0];
if(feature.split(",").length>2){var width=feature.split(",")[0];if(width.indexOf("=")!=-1){width=width.substring(width.indexOf("=")+1,width.length)}var height=feature.split(",")[1];if(height.indexOf("=")!=-1){height=height.substring(height.indexOf("=")+1,height.length)}}FR.showDialog(" ",parseInt(width)||600,parseInt(height)||400,iframeDialog)},doHyperlinkByGet4Reportlet:function(url,para,target,feature){if(arguments.length<1){return}var options=arguments[0];if(typeof options==="object"){url=options.url||"";
para=options.para||{};target=options.target;feature=options.feature}para=$.extend({_:new Date().getTime()},para);$.each(para,function(pName,pValue){if(pName!="__LOCALE__"&&pName!="REPORTLET"&&pName!="OP"&&!$.isPlainObject(pValue)){if(FR.isArray(pValue)){para[pName]=pValue}else{para[pName]=encodeURIComponent(pValue)}}});var pString="__parameters__="+FR.cjkEncode(FR.jsonEncode(para));url+=url.indexOf("?")==-1?"?":"&";this.doHyperlinkActionByGet(url+pString,target,feature,options.title)},doHyperlinkByPost:function(url,para,target,feature){if(arguments.length<1){return
}var options=arguments[0];if(typeof options==="object"){url=options.url||"";para=options.para||{};target=options.target;feature=options.feature}para=para||{};$.each(para,function(pName,pValue){if(pName!="__LOCALE__"&&pName!="REPORTLET"&&pName!="OP"&&!$.isPlainObject(pValue)){if(FR.isArray(pValue)){para[pName]=pValue}else{para[pName]=encodeURIComponent(pValue)}}});if(this.$hyperlinkForm){this.$hyperlinkForm.html("")}else{this.$hyperlinkForm=($("<div>").appendTo($(document.body))).css({"display":"none","position":"absolute"})
}if(target==null){target="formresult"}para=FR.cjkEncode(FR.jsonEncode(para));var submitForm=$("<form method='post' target='"+target+"' action='"+url+"'></form>").appendTo(this.$hyperlinkForm);var input=$('<input type="hidden" name="__parameters__" value=""/>');input.attr("value",para);submitForm.append(input);if(this.shouldGet(target)){this.doHyperlinkActionByGet(this.getTargetUrlByPost(url,para),target,feature,options.title)}else{submitForm.submit()}},doHyperlinkActionByGet:function(targetUrl,target,feature,title){targetUrl=encodeURI(targetUrl);
if(target&&target==="_dialog"){this.showHyperlinkDialog(targetUrl,feature)}else{window.open(targetUrl,target)}},getTargetUrlByPost:function(url,para){var pString="__parameters__="+para;url+=url.indexOf("?")==-1?"?":"&";return url+pString},shouldPost:function(targetUrl,target){if(target===undefined){return false}return !this.shouldGet()&&targetUrl.length>=2048&&FR.Browser.isIE()},shouldGet:function(target){return target&&target==="_dialog"},isEmpty:function(value){var result=value===""||value===null||value===undefined;
return result},isEmptyObj:function(obj){return _.isEmpty(obj)},toRE:function(str){return str.replace(/\\/g,"\\\\").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/\*/g,"\\*").replace(/\|/g,"\\|").replace(/\?/g,"\\?").replace(/\$/g,"\\$").replace(/\^/g,"\\^")},_executeScriptFromHtml:function(html){var html_script=html.substring(0,500);var html_script_low=html_script.toLowerCase();var begin=html_script_low.indexOf("<"+"script>");
if(begin<0){return}var end=html_script_low.indexOf("</"+"script>");html_script=html_script.substring(begin+8,end);try{eval(html_script)}catch(e){}},extend:function(){return function(sb,sp,overrides){if(typeof sp=="object"){overrides=sp;sp=sb;sb=function(){sp.apply(this,arguments)}}if(sp==null){console&&console.log("empty")}var F=function(){},spp=sp.prototype;F.prototype=spp;sb.prototype=new F();sb.superclass=spp;$.extend(sb.prototype,overrides);return sb}}(),SessionMgr:function(){var sid,cp;$(window).unload(function(){$(window).unbind("unload",arguments.callee);
if(sid&&cp&&FR.servletURL&&cp.rtype!="preview"&&cp.rtype!="bi"&&!cp.noClossSession){var closeSession=function(sid){FR.ajax({async:false,url:FR.servletURL,data:{op:"closesessionid",sessionID:sid}})};closeSession(sid)}});if(FR.shouldSendHeartBeat){setInterval(function(){if(sid&&cp&&FR.servletURL){FR.ajax({url:FR.servletURL,data:{sessionID:sid,_:new Date().getTime()}})}},30000)}return{getSessionID:function(){return sid},getContentPane:function(){return cp},get:function(){return cp},register:function(id,s){sid=id;
cp=s}}}(),CookieInfor:{getCookies:function(){var cookieString=document.cookie;return unescape(cookieString).split(";")},addCookie:function(name,value,temp){var newCookie=name+"="+escape(value);var liveDays=temp?temp:30;var expires=new Date();expires.setDate(expires.getDate()+liveDays);newCookie+=";expires="+expires.toGMTString();document.cookie=newCookie},removeCookie:function(name){var expires=new Date();expires.setTime(expires.getTime()-1);document.cookie=name+"="+";expires="+expires.toGMTString()
},clearCookie:function(){var self=this;var $cookies=this.getCookies();$.each($cookies,function(i){var cookieName=$cookies[i].split("=")[0];self.removeCookie(cookieName)})},getCookieByName:function(name){var $cookies=this.getCookies();var re=new RegExp(name);var value=null;$.each($cookies,function(i){if($cookies[i].match(re)){value=$cookies[i].split(name+"=")[1];return false}});return value}},cjkEncode:function(text){if(typeof text!=="string"){return text}var newText="";for(var i=0;i<text.length;i++){var code=text.charCodeAt(i);
if(code>=128||code===91||code===93){newText+="["+code.toString(16)+"]"}else{newText+=text.charAt(i)}}return newText},cjkDecode:function(text){if(text==null){return""}if(!isNaN(text)||text.indexOf("[")==-1){return text}var newText="";for(var i=0;i<text.length;i++){var ch=text.charAt(i);if(ch=="["){var rightIdx=text.indexOf("]",i+1);if(rightIdx>i+1){var subText=text.substring(i+1,rightIdx);if(subText.length>0){ch=String.fromCharCode(eval("0x"+subText))}i=rightIdx}}newText+=ch}return newText},htmlSpaceDecode:function(text){return(text==null)?"":String(text).replace(/&nbsp;/," ")
},htmlEncode:function(text){return(text==null)?"":String(text).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode:function(text){return(text==null)?"":String(text).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")},jsonEncode:function(o){var useHasOwn={}.hasOwnProperty?true:false;var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];
if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+s+'"'};var encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":FR.jsonEncode(v));b=true}}a.push("]");return a.join("")};if(typeof o=="undefined"||o===null){return"null"}else{if($.isArray(o)){return encodeArray(o)}else{if(o instanceof Date){return FR.jsonEncode({__time__:o.getTime()})
}else{if(typeof o=="string"){return encodeString(o)}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"}else{if(typeof o=="boolean"){return String(o)}else{if($.isFunction(o)){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"unknown":break;default:if(b){a.push(",")}a.push(FR.jsonEncode(i),":",v===null?"null":FR.jsonEncode(v));b=true}}}a.push("}");return a.join("")}}}}}}}},jsonDecode:function(text){try{var jo=$.parseJSON(text);
if(jo==null){jo={}}}catch(e){try{jo=new Function("return "+text)()||{}}catch(e){}if(jo==null){jo=[]}}if(!FR._hasDateInJson(text)){return jo}return(function(o){if(typeof o==="string"){return o}if(o&&o.__time__!=null){return new Date(o.__time__)}for(var a in o){if(o[a]==o||typeof o[a]=="object"||$.isFunction(o[a])){break}o[a]=arguments.callee(o[a])}return o})(jo)},_hasDateInJson:function(json){if(!json||typeof json!=="string"){return false}return json.indexOf("__time__")!=-1},setBackground:function($dom,bg,height){var type=bg["type"];
if((type===4||type===2)&&FR.Browser.isIE()){if(FR.ieForFixBackground()){var url=bg["url"];var bgImage=$("<img src='"+url+"' id='para-bg'>");bgImage.appendTo($dom);setSize($dom);$(window).resize(function(){setSize($dom)});function setSize($dom){var $img=$("#para-bg",$dom);setTimeout(function(){if($img.isVisible()){$img.attr("width",$dom.width());$img.attr("height",$dom.height()||height)}},20)}}else{$.each(["background-image","background-repeat","filter","background"],function(idx,item){if(bg[item]!=null){$dom.css(item,bg[item])
}})}}else{$.each(["background","background-size","background-image","background-repeat"],function(idx,item){if(bg[item]!=null){$dom.css(item,bg[item])}})}},ieForFixBackground:function(){return FR.Browser.isIE8Before()},contains:function(p,c){return FR.isAncestor(p,c)?true:((!p||!c)?false:p==c)},isAncestor:function(p,c){if(!p||!c){return false}if(p.contains&&!(FR.Browser.r.safari||FR.Browser.r.chrome)){try{return p.contains(c)}catch(e){}}if(p.compareDocumentPosition){return !!(p.compareDocumentPosition(c)&16)
}else{var parent=c.parentNode;while(parent){if(parent==p){return true}else{if(!parent.tagName||parent.tagName.toUpperCase()=="HTML"){return false}}parent=parent.parentNode}return false}},isNavKeyPress:function(event){if(!event){return false}var safariKeys={63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35};var k=event.keyCode;k=(FR.Browser.r.safari||FR.Browser.r.chrome)?(safariKeys[k]||k):k;return(k>=33&&k<=40)||k===13||k==FR.keyCode.TAB||k==FR.keyCode.ESCAPE},isSpecialKey:function(e){if(!e){return false
}var k=e.keyCode;return(e.type=="keypress"&&e.ctrlKey)||k===9||k===13||k===40||k===27||(k===16)||(k===17)||(k>=18&&k<=20)||(k>=33&&k<=35)||(k>=36&&k<=39)||k===44||(k===13||k===229)},equals:function(v1,v2){if(FR.isNull(v1)||FR.isNull(v2)){return v1==undefined&&v2==undefined||v1==null&&v2==null}if(v1===v2){return true}else{if($.isArray(v1)){if(v1.length==v2.length){for(var i=0;i<v1.length;i++){if(!FR.equals(v1[i],v2[i])){return false}}}else{return false}}else{if(typeof v1=="object"){var lv1=0,lv2=0;
for(var i in v1){lv1++}for(var i in v2){lv2++}if(lv1!=lv2){return false}for(var a in v1){if(!FR.equals(v1[a],v2[a])){return false}}}else{return v1===v2}}}return true},isNull:function(v){return v==undefined||v==null},lengthenFileName:function(name,s){if(!name){return}if(name.lastIndexOf(".")==-1){return name+s}var leftName=name.substring(0,name.lastIndexOf("."));var rightName=name.substring(name.lastIndexOf("."),name.length);return leftName+s+rightName},getCursorPosition:function(input){try{if(input.value==""){return 0
}var cursurPosition=-1;if(input.selectionStart){cursurPosition=input.selectionStart}else{var rngSel=document.selection.createRange();var rngTxt=input.createTextRange();var flag=rngSel.getBookmark();rngTxt.collapse();rngTxt.moveToBookmark(flag);rngTxt.moveStart("character",-input.value.length);cursurPosition=rngTxt.text.length}return cursurPosition}catch(e){return input.value.length}},setCursorPosition:function(input,pos){if(input.setSelectionRange){input.focus();input.setSelectionRange(pos,pos)}else{if(input.createTextRange){var lineChangeNum=input.value.length-input.value.replace(/\n/g,"").length;
pos=pos-lineChangeNum+1;var range=input.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}},id2ColumnRowStr:function(id){return id.replace(/([A-Z]+\d+)-\d+-\d+/,"$1")},id2ColumnRow:function(id){return FR.cellStr2ColumnRow(FR.id2ColumnRowStr(id))},id2Location:function(id){var rt=FR.id2ColumnRow(id);var arr=id.split("-");rt.rptIdx=arr[1];return rt},cellStr2ColumnRow:function(name){name=$.trim(name.toUpperCase());if(!FR.isValidCellStr(name)){return null
}var colStr=name.replace(/([A-Z]+)\d+/,"$1");var rowStr=name.replace(/[A-Z]+(\d+)/,"$1");var col=FR.letter2Digit(colStr)-1;var row=parseInt(rowStr)-1;return{col:col,row:row}},columnRow2CellStr:function(cr){var col=parseInt(cr.col);var row=parseInt(cr.row);if(typeof col!="number"||typeof row!="number"){return""}return FR.digit2Letter(col+1)+(row+1)},isValidCellStr:function(str){if(str.match(/^[A-Z]+\d+$/)==null){return false}else{return true}},letter2Digit:function(abc){var len=abc.length;var col=0;
for(var i=len-1;i>=0;i--){var c=abc.charAt(i);col+=(COL_IDS.indexOf(c)+1)*Math.pow(26,len-1-i)}return col},digit2Letter:function(k){var c,abcBuf="";if(typeof k!="number"||k===0||isNaN(k)||!isFinite(k)){return abcBuf}for(;k!==0;){c=k%26;if(c===0){c=26}abcBuf=COL_IDS.charAt(c-1)+abcBuf;k=(k-c)/26}return abcBuf},byteLength:function(str){if(FR.isEmpty(str)){return 0}var byteLen=0,len=str.length;for(var i=0;i<len;i++){byteLen+=str.charCodeAt(i)>255?2:1}return byteLen},keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},location:function(callback){callback.call(this,"fail",FR.i18nText("FR-Basic_Fail_Location"))
}})})(jQuery);(function(b){var a={};b.shortcut=function(d,c){if(a[d]!=null){throw ("shortcut:["+d+"] has been registed")}a[d]=c;b.extend(c.prototype,{xtype:d})};FR.createWidget=function(d,h){if(d instanceof b){return new FR.Widget({renderEl:d})}if(d["classType"]){return new (new Function("return "+d["classType"]+";")())(d)}if(!d.type){if(h!==true){return new FR.ErrorMarkWidget({renderEl:d.renderEl,message:"config type cannot be null.",width:d.width,height:d.height})}}var g=d.type.toLowerCase();var c=a[g];
try{return new c(d)}catch(f){if(h===true){throw f}else{return new FR.ErrorMarkWidget({renderEl:d.renderEl,message:FR.i18nText("FR-Base_Widget_Error_Mark_Text")+":"+d.type+",message:"+f,width:d.width,height:d.height})}}};b.fn.extend({asComponent:function(c){c=c||{};c.renderEl=b(this);return FR.createWidget(c)}})})(jQuery);if(window._g==null){window._g=FR.SessionMgr.getContentPane}$.extend(FR,{string2ints:function(h){var b=[];var g=h.split(",");for(var e=0;e<g.length;e++){var d=g[e];var f=d.split("-");
var a=parseInt(f[0]),c=a;if(f.length>1){c=parseInt(f[1])}for(var j=a;j<=c;j++){b.push(j)}}return b}});$.extend(FR,{activeBranches:function(branches,parameters,processid,taskName,serverURL,needClose){if(processid&&taskName){var it={"id":processid,"taskname":taskName}}else{var it=this.getProcessIDAndTaskName();if(!it.processid){FR.Msg.toast(FR.i18nText("FR_FS-Task_Has_Been_Closed"));return}}if(!it){return}if(!$.isArray(branches)){branches=[branches]}if(parameters!=null&&!$.isArray(parameters)){parameters=[parameters]
}var data=$.extend(it,{branches:branches});if(parameters){$.each(parameters,function(idx,item){if(item.value.toString().startWith("eval")){var evalValue=item.value.toString().substring(5,item.value.toString().length-1);item.value=eval(evalValue)}});data.parameters=parameters}this.ajax({url:(serverURL?serverURL:FR.servletURL)+"?op=process_exe&cmd=continue",data:data,type:"post",complete:function(res,status){if(res.responseText=="close"){FR.Msg.toast(FR.i18nText("FR_FS-Task_Has_Been_Closed"));return
}this.refreshUserTask(it)}.createDelegate(this)})},getProcessIDAndTaskName:function(){var a={};this.ajax({url:FR.servletURL+"?op=process_exe",async:false,data:{sessionID:FR.SessionMgr.getSessionID(),cmd:"values"},complete:function(c,b){a=FR.jsonDecode(c.responseText)}});return a},refreshUserTask:function(b){var a=window.parent;if(!a||!a.FS||!a.FS.Process){location.reload(true);return}a.FS.Process.refreshTask();var c="?op=process_exe&cmd=seejob&taskname="+b.taskname+"&processexecutorid="+b.id+"&processid="+b.processid;
a.FS.tabPane.addItem({"title":FR.i18nText("FR_FS-Handle_Affairs")+b.id,src:c})}});$.extend(FR,{logoutApp:function(){}});(function(a){a(document).ready(function(){FR.windowHeight=a(window).height();FR.windowWidth=a(window).width();if(FR.windowHeight===0||FR.windowWidth===0){FR.windowHeight=document.body.clientHeight;FR.windowWidth=document.body.clientWidth}a(window).resize(function(){if(FR.Browser.isIE()){setTimeout(function(){FR.windowHeight=a(window).height();FR.windowWidth=a(window).width();if(FR.windowHeight===0||FR.windowWidth===0){FR.windowHeight=document.body.clientHeight;
FR.windowWidth=document.body.clientWidth}},0)}else{FR.windowHeight=a(window).height();FR.windowWidth=a(window).width()}});FR.parameterContainerHeight=0;FR.toolbarHeight=0})})($);
(function(a){a.extend(FR,{contentFormat:function(c,b){if(FR.isEmpty(c)){return""}var e=c.toString();if(FR.isEmpty(b)){return e}if(b.match(/^T/)){return e}else{if(b.match(/^D/)){if(!(c instanceof Date)){if(typeof c==="number"){c=new Date(c)}else{c=Date.parseDate(c+"",Date.patterns.ISO8601Long)}}if(!FR.isNull(c)){var d=b.match(/^DT/);e=FR.date2Str(c,b.substring(d?2:1))}}else{if(b.match(/E/)){e=FR._eFormat(e,b)}else{e=FR._numberFormat(e,b)}}}e=e.replace(/\/g,"");return e},_dealNumberPrecision:function(g,d){if(/[eE]/.test(g)){var c=0,e=0,f;
if(/[%]$/.test(d)){c=/[%]$/.test(d)?2:3}for(var b=d.length;e<b;e++){if((f=d.charAt(e))=="0"||f=="#"){c++}}return Number(g).toFixed(c)}return g},_numberFormat:function(l,j){var l=l+"";if(!(/[0-9]/.test(l))||!j){return l}var m=j.indexOf(";");if(m>-1){if(l>=0){return FR._numberFormat(l+"",j.substring(0,m))}else{return FR._numberFormat((-l)+"",j.substr(m+1))}}else{if(+l<0&&j.charAt(0)!=="-"){return FR._numberFormat((-l)+"","-"+j)}}var h=j.split("."),e=h[0]||"",b=h[1]||"";l=this._dealNumberPrecision(l,b);
var i=l.split("."),c=i[0]||"",f=i[1]||"";if(/[%]$/.test(j)){var g=/[%]$/.test(j)?"00":"000";f+=g;c+=f.substr(0,g.length);c=c.charAt(0)==="-"?c.replace(/^-0+/gi,"-"):c.replace(/^0+/gi,"");f=f.substr(g.length).replace(/0+$/gi,"")}var k=FR._dealWithRight(f,b);if(k.leftPlus){c=parseInt(c)+1+"";c=isNaN(c)?"1":c}k=k.num;var d=FR._dealWithLeft(c,e);if(!(/[0-9]/.test(d))){d=d+"0"}if(!(/[0-9]/.test(k))){return d+k}else{return d+"."+k}},_eFormat:function(r,d){var n=d.indexOf("E");var l=d.substr(0,n),q=d.substr(n+1);
if(/^[0\.-]+$/.test(r)){r=FR._numberFormat(0,l)+"E"+FR._numberFormat(0,q)}else{var b=r<0;if(b){r=r.substr(1)}var h=(l.split(".")[0]||"").length;var o=r.indexOf(".");if(o<0){o=r.length}var j=0;r=r.replace(".","");for(var m=r.length;j<m;j++){var s=r.charAt(j);if(s<="9"&&s>="1"){break}}var p=o-j-h;var f=r.substr(j,h);var c=j+h-r.length;if(c>0){for(var g=0;g<c;g++){f+="0"}}else{f+="."+r.substr(j+h)}f=f.replace(/^[0]+/,"");if(p<0&&q.indexOf("-")<0){q+=";-"+q}r=FR._numberFormat(f,l)+"E"+FR._numberFormat(p,q);
if(b){r="-"+r}}return r},_dealWithRight:function(l,d){var q="",h=0,k=0;for(var o=d.length;k<o;k++){var b=d.charAt(k);var p=l.charAt(h);switch(b){case"0":if(FR.isEmpty(p)){p="0"}q+=p;h++;break;case"#":q+=p;h++;break;default:q+=b;break}}var n=l.substr(h);var r={};if(!FR.isEmpty(n)&&n.charAt(0)>4){r.leftPlus=true;var f=q.match(/^[0-9]+/);if(f){var m=f[0];var e=m.length;var g=FR.parseINT(m)+1+"";if(g.length>e){g=g.substr(1)}else{g=String.leftPad(g,e,"0");r.leftPlus=false}q=q.replace(/^[0-9]+/,g)}}r.num=q;
return r},_dealWithLeft:function(e,k){var h="";var l=e.length-1;var g=-1,s=-1;var m=k.length-1;for(;m>=0;m--){var b=k.charAt(m);var r=e.charAt(l);switch(b){case"0":if(FR.isEmpty(r)){r="0"}s=-1;h=r+h;l--;break;case"#":s=m;h=r+h;l--;break;case",":if(!FR.isEmpty(r)){var d=k.match(/,[#0]+/);if(d){g=d[0].length-1}h=","+h}break;default:h=b+h;break}}if(s>-1){var t=e.substr(0,l+1);h=h.substr(0,s)+t+h.substr(s)}if(g>0){var q=h.match(/[0-9]+,/);if(q){q=q[0];var p="",f=q.length-1-g;for(;f>=0;f=f-g){p=q.substr(f,g)+","+p
}var o=q.substr(0,f+g);if(!FR.isEmpty(o)){p=o+","+p}}h=h.replace(/[0-9]+,/,p)}return h},object2Number:function(b){if(b==null){return 0}if(typeof b=="number"){return b}else{var c=b+"";if(c.indexOf(".")===-1){return parseInt(c)}else{return parseFloat(c)}}},object2Date:function(c){if(c==null){return new Date()}if(c instanceof Date){return c}else{if(typeof c=="number"){return new Date(c)}else{var d=c+"";d=d.replace(/-/g,"/");var b=new Date(d);if(!FR.isInvalidDate(b)){return b}return new Date()}}},object2Time:function(c){if(c==null){return new Date()
}if(c instanceof Date){return c}else{var d=c+"";d=d.replace(/-/g,"/");var b=new Date(d);if(!FR.isInvalidDate(b)){return b}if(d.indexOf("/")===-1&&d.indexOf(":")!==-1){b=new Date("1970/01/01 "+d);if(!FR.isInvalidDate(b)){return b}}b=FR.str2Date(d,"HH:mm:ss");if(!FR.isInvalidDate(b)){return b}return new Date()}},isInvalidDate:function(b){return b=="Invalid Date"||b=="NaN"}})})(jQuery);
FR.OB=function(a){this.options=$.extend(this._defaultConfig(),a);this._init();this._confirmEvents()};$.extend(FR.OB.prototype,{_defaultConfig:function(){return{}},_init:function(){var a=this;if(this.options.listeners!=null){$.each(this.options.listeners,function(c,b){(b.target?b.target:a)[b.once?"once":"on"](b.eventName,b.action.createDelegate(a))});delete this.options.listeners}},_confirmEvents:function(){this.fireEvent(FR.Events.AFTERINIT)},_getEvents:function(){if(!$.isArray(this.events)){this.events=[]
}return this.events},on:function(a,c){a=a.toLowerCase();var b=this._getEvents()[a];if(!$.isArray(b)){b=[];this._getEvents()[a]=b}b.push(c)},once:function(a,c){var b=function(){c.apply(this,arguments);this.un(a,b)};this.on(a,b)},un:function(a,c){a=a.toLowerCase();if(c==null){delete this._getEvents()[a]}else{var b=this._getEvents()[a];if($.isArray(b)){var d=[];$.each(b,function(e,f){if(f!=c){d.push(f)}});this._getEvents()[a]=d}}},purgeListeners:function(){this.events=[]},fireEvent:function(){var a=arguments[0].toLowerCase();
var d=this._getEvents()[a];if($.isArray(d)){var b=Array.prototype.slice.call(arguments,1);for(var c=0;c<d.length;c++){if(d[c].apply(this,b)===false){return false}}}return true}});FR.OB.capture=function(c,b,a){c.fireEvent=c.fireEvent.createInterceptor(b,a)};FR.OB.releaseCapture=function(a){a.fireEvent=FR.OB.prototype.fireEvent};
FR.widget={opts:{zIndex:8000,num:0}};FR.Widget=FR.extend(FR.OB,{_defaultConfig:function(){return $.extend(FR.Widget.superclass._defaultConfig.apply(this,arguments),{widgetName:"",disabled:false,invisible:false,usedAsEditor:false,resultWidgets:{}})},_init:function(){FR.Widget.superclass._init.apply(this,arguments);this._initRoot();this._initElementSize();this._initVisualEffects();this._initNameEffects()},_initRoot:function(){if(this.options.renderEl!=null){this.element=$(this.options.renderEl)}else{this.element=this._defaultRoot()
}if(this.options.baseCls){this.element.addClass(this.options.baseCls)}},_initElementSize:function(){var b=this.options;if(FR.isWidthOrHeight(b.width)){this.element.css({width:b.width-FR.fixBoxModelWidth(this.element)})}else{if(b.width=="auto"){this.element.width("auto")}else{if(this.isStringTypeNumber(b.width)){this.element.width(parseInt(b.width))}}}if(FR.isWidthOrHeight(b.height)){this.element.css({height:b.height-FR.fixBoxModelHeight(this.element)})}else{if(b.height=="auto"){this.element.height("auto")
}else{if(this.isStringTypeNumber(b.height)){this.element.height(parseInt(b.height))}}}var a=this;this.element.bind(FR.Events.RESIZE,function(c,d){a.doResize(d)})},isStringTypeNumber:function(a){return !isNaN(parseInt(a))},_initVisualEffects:function(){this[this.options.disabled?"disable":"enable"]();if(this.options.invisible){this.setVisible(false)}},_initNameEffects:function(){var a=this.options;if(a.widgetName){this.element.attr({widgetName:a.widgetName})}FR.widget.opts.num++;if(a.widgetName){this._addWidget(a.widgetName,this)
}else{this._addWidget("_widget_"+FR.widget.opts.num,this)}},_addWidget:function(a,b){this.options.resultWidgets[a]=b},getName:function(){return this.options.widgetName},getWidgetByName:function(a){return this.options.resultWidgets[a]},getText:function(){},setText:function(a){},getValue:function(){},setValue:function(b,a){},getType:function(){return this.options.type},isEnabled:function(){return !this.options.disabled},setEnable:function(a){if(a===true){this.options.disabled=false;this.element.addClass("ui-state-enabled");
this.element.removeClass("ui-state-disabled")}else{if(a===false){this.options.disabled=true;this.element.addClass("ui-state-disabled");this.element.removeClass("ui-state-enabled")}}},isVisible:function(){return !this.options.invisible},setVisible:function(a){this.resetVisible(a);if(a===true){this.options.invisible=false;this.element.show()}else{if(a===false){this.options.invisible=true;this.element.hide()}}},resetVisible:function(f){var b=this,c=b.titleWidget?b.titleWidget:b,a=c.options.adaptiveLayoutItems;
function d(h){for(var i=0;i<a.length;i++){if(a[i].widgetName.toLowerCase()===h.toLowerCase()){return a[i]}}return null}if(c.isVisible()===f||!b.options.form){return}var e={op:"fr_form",cmd:"visible_config",widgetName:b.getName(),visibility:f,sessionID:FR.SessionMgr.getSessionID()};var g={totalWidth:FR.windowWidth,totalHeight:FR.windowHeight};$.extend(e,g);FR.ajax({url:FR.servletURL,type:"POST",async:false,data:e,complete:function(D,x){if(!D.responseText){return}var m=b.options.form;var h=FR.jsonDecode(D.responseText);
if(h.layout==="absolute"){return}if(f){b.options.invisible=false;b.element.show();c.options.invisible=false;c.element.show();if(h.widgetSizeInfo){var j=h.widgetSizeInfo;for(var y=j.length-1;y>=0;y--){var E=j[y].widgetName;var p=m.getWidgetByName(E);var A=d(E);if(p.titleWidget){p=p.titleWidget}var o=j[y].x;var n=j[y].y;var w=j[y].width;var v=j[y].height;A.x=o;A.y=n;A.width=w;A.height=v;p.doResize({"left":o,"top":n,"width":w,"height":v})}return}}var s=d(b.getName());if(s.width===0||s.height===0){return
}function l(J){for(var G=0;G<J.length;G++){if(!J[G].trisection){var F=J[G].widgetName,I=J[G].extendDirection,H=d(F);if(I==="down"){return H.y-s.y-s.height}if(I==="up"){return s.y-H.y-H.height}}}}if(h.extendInfo.length>0){for(var y=0;y<h.extendInfo.length;y++){var k=h.extendInfo[y].widgetName,B=h.extendInfo[y].extendDirection,C=d(k);if(B==="right"){C.width=C.width+C.x-s.x;C.x=s.x;var r=m.getWidgetByName(k);r=r.titleWidget?r.titleWidget:r;r.doResize({"left":C.x,"width":C.width})}if(B==="left"){C.width=s.width+s.x-C.x;
var t=m.getWidgetByName(k);t=t.titleWidget?t.titleWidget:t;t.doResize({"width":C.width})}if(B==="down"){if(h.extendInfo[y].trisection){var z=l(h.extendInfo)}C.height=h.extendInfo[y].trisection?C.height-s.height-z:C.y+C.height-s.y;C.y=h.extendInfo[y].trisection?C.y+s.height+z:s.y;var u=m.getWidgetByName(k);u=u.titleWidget?u.titleWidget:u;u.doResize({"top":C.y,"height":C.height})}if(B==="up"){if(h.extendInfo[y].trisection){var z=l(h.extendInfo)}C.height=h.extendInfo[y].trisection?C.height-s.height-z:s.y+s.height-C.y;
var q=m.getWidgetByName(k);q=q.titleWidget?q.titleWidget:q;q.doResize({"height":C.height})}}}s.width=0;s.height=0;b.options.invisible=true;b.element.hide();c.options.invisible=true;c.element.hide()}})},setSource:function(a){this.setValue(a)},couldUsedAsEditor:function(){return this.options.usedAsEditor},reset:function(){},doResize:function(f){var b=this.options;var e=this.element;if(f){if(f.width){b.width=f.width}if(f.height){b.height=f.height}if(f.left!=null){b.left=f.left}if(f.top!=null){b.top=f.top
}}else{if(b.fit===true){var d=e.parent();var c=d.width();var a=d.height();b.width=c;b.height=a}}this.element.width(b.width);this.element.height(b.height)},destroy:function(){this.element.each(function(){$(this).remove();if(FR.Browser.isIE()){this.outerHTML=""}})},_defaultRoot:function(){return $("<div/>")},disable:function(){this.setEnable(false)},enable:function(){this.setEnable(true)},invisible:function(){this.setVisible(false)},visible:function(){this.setVisible(true)}});FR.ErrorMarkWidget=FR.extend(FR.Widget,{_defaultConfig:function(){return $.extend(FR.ErrorMarkWidget.superclass._defaultConfig.apply(),{width:120,height:24})
},_init:function(){FR.ErrorMarkWidget.superclass._init.apply(this,arguments);var a=this.options;this.element.text(a.message||"");this.element.css({textAlign:"center",width:a.width,height:a.height,lineHeight:a.height+"px"})},doResize:function(a){FR.ErrorMarkWidget.superclass.doResize.call(this,a);this.element.css({width:a.width,height:a.height,lineHeight:a.height+"px"})}});
(function(a){a.extend(FR,{Msg:function(){return{verticalOffset:0.77,horizontalOffset:1,repositionOnResize:true,overlayOpacity:0.01,overlayColor:"#FFF",draggable:true,okButton:FR.i18nText("FR-Basic_OK"),cancelButton:FR.i18nText("FR-Basic_Cancel"),dialogClass:null,style:null,textSpace:FR.i18nText("FR-Widget_Message_Letter_Space")+"px",msgStyle:function(){var b=this.style;var c="blue";a.each(["green","blue"],function(d,e){if(b&&e==b.toLowerCase()){c=b.toLowerCase()}});this.style=c},alert:function(c,b,d){FR.Keys.enable(false);
if(!c){c="Alert"}this._show(c,b,null,"alert",function(e){FR.Keys.enable(true);if(a.isFunction(d)){d(e)}},-1);if(typeof d=="number"&&d>0){setTimeout(function(){FR.Msg._hide()},d)}},confirm:function(c,b,e,d){FR.Keys.enable(false);if(!c){c="Confirm"}this._show(c,b,null,"confirm",function(f){FR.Keys.enable(true);if(e){e(f)}},d?d:-1)},prompt:function(d,b,c,f,e){FR.Keys.enable(false);if(!d){d="Prompt"}this._show(d,b,c,"prompt",function(g){FR.Keys.enable(true);if(f){f(g)}},e?e:-1)},toast:function(e){var d=-300;
if(FR.Browser.isIE7Before()){d=-370}var c=a("body").children("div.toast");if(c.length===0){var f=60;if(FR.Browser.isIE6()){f+=a("body")[0].scrollTop}c=a("<div/>").addClass("toast").css({right:d,top:f,"z-Index":FR.widget.opts.zIndex++}).appendTo("body")}c.text(e);var b=a("body").children("div.toastIcon");if(b.length===0){b=a("<div/>").addClass("toastIcon").css({right:0,top:c.css("top"),"z-index":c.css("z-index")+1}).appendTo("body");new FR.IconButton({width:b.css("width"),height:b.css("height"),imgsrc:"fr_show_toast",renderEl:a("<div/>").appendTo(b),handler:function(){c.animate({right:-4},"slow");
setTimeout(function(){c.animate({right:d},"slow")},5000)}})}b.hide();c.animate({right:-15},"slow");(function(){c.animate({right:d},"slow",function(){b.show();b.fadeOut(5000)})}).defer(5000)},_show:function(w,j,s,d,i,p){this.msgStyle();this._hide();this._overlay("show");a("BODY").append('<div id="popup_container">'+'<div id="popup_header" >'+'<h1 id="popup_title"></h1></div>'+'<div id="popup_content">'+'<div id="popup_message"></div>'+"</div>"+"</div>");if(this.dialogClass){a("#popup_container").addClass(this.dialogClass)
}var l=FR.Browser.isIE()?"absolute":"fixed";a("#popup_container").css({position:l,zIndex:99999,padding:0,margin:0,top:0,left:0});a("#popup_title").html(w);a("#popup_content").addClass(d);a("#popup_message").text(j);a("#popup_message").html(a("#popup_message").text().replace(/\n/g,"<br />"));var h=a("#popup_container").outerWidth();var g=a("#popup_container").outerWidth();a("#popup_container").css({minWidth:p>0?Math.max(h,p):h,maxWidth:p>0?Math.max(g,p):g});a("<div id = 'popup_close' class = 'close_mouseout' style='position: absolute;top: 0;right: 7px;width: 25px;height: 30px'>").appendTo("#popup_header").bind("mouseover",function(){a("#popup_close").removeClass("close_mouseout");
a("#popup_close").addClass("close_mouseover")}).bind("mouseout",function(){a("#popup_close").removeClass("close_mouseover");a("#popup_close").removeClass("close_click");a("#popup_close").addClass("close_mouseout")}).bind("mousedown",function(){a("#popup_close").removeClass("close_mouseover");a("#popup_close").addClass("close_click")}).bind("click",function(){FR.Msg._hide();if(i){i(null)}});j=p==-1?j:j.replace(/([\u4E00-\u9FA5\uf900-\ufa2d])/g,"aa");var m=j?FR.byteLength(j):0;switch(d){case"alert":a("#popup_container").css({minWidth:"400px",maxWidth:"400px",width:"400px"});
a("#popup_message").css({width:"380px",wordBreak:"break-all",fontSize:"14px",fontWeight:"bold"});var q=a("#popup_message").height();var v=q+87;v=v>150?v:150;a("#popup_container").css({height:v});a("#popup_header").css({width:"400px"});a("#popup_content").css({top:"40px",left:"10px",background:"none",padding:"0px",fontSize:"14px",textAlign:"left"});var c=new FR.createWidget({type:"quickbutton",style:this.style,text:FR.i18nText("FR-Basic_OK"),width:65,height:28,handler:function(){FR.Msg._hide();i(true)
}});var u=c.element.appendTo("#popup_container").css({position:"absolute",right:"20px",bottom:"8px",letterSpacing:FR.Msg.textSpace,textIndent:FR.Browser.isIE7Before()?0:FR.Msg.textSpace});u.focus();u.keydown(function(x){if(x.keyCode===13||x.keyCode===27){u.trigger("click")}});break;case"confirm":if(j){if(m<7){a("#popup_container").css({minWidth:"233px",maxWidth:"233px",width:"233px",height:"149px"});a("#popup_content").css({left:"32px",width:"100px"});a("#popup_header").css({width:"233px"});a("#popup_message").css({width:"100px"})
}else{if(m>6&&m<11){a("#popup_container").css({minWidth:"233px",maxWidth:"233px",width:"233px",height:"149px"});a("#popup_content").css({left:"33px",width:"98px",backgroundPosition:"23px 31px"});a("#popup_header").css({width:"233px"});a("#popup_message").css({width:"98px"})}else{var n=m*17/2+16;p=p>233?p:233;var b=(n+100)>p?n+100:p;a("#popup_container").css({minWidth:b+"px",maxWidth:b+"px",width:b+"px",height:"169px"});a("#popup_content").css({left:"15.5px",width:n+"px",backgroundPosition:"23px 31px"});
a("#popup_header").css({width:b+"px"});a("#popup_message").css({width:n+"px"})}}}else{a("#popup_container").css({minWidth:"233px",maxWidth:"233px",width:"233px",height:"149px"});a("#popup_header").css({width:"233px"});a("#popup_content").css({left:"46px",top:"45px"})}var k=document.getElementById("popup_container").offsetWidth;var r=(k-140)/2-1;var c=new FR.createWidget({type:"quickbutton",style:this.style,text:FR.i18nText("FR-Basic_OK"),width:65,height:28,handler:function(){FR.Msg._hide();i(true)
}});var u=c.element.appendTo("#popup_container").css({position:"absolute",left:r+"px",bottom:"8px",letterSpacing:FR.Msg.textSpace,textIndent:FR.Browser.isIE7Before()?0:FR.Msg.textSpace});var f=new FR.createWidget({type:"quickbutton",style:"gray",text:FR.i18nText("FR-Basic_Cancel"),width:65,height:28,handler:function(){FR.Msg._hide();i(false)}});var o=f.element.appendTo("#popup_container").css({position:"absolute",right:r+"px",bottom:"8px",letterSpacing:FR.Msg.textSpace,textIndent:FR.Browser.isIE7Before()?0:FR.Msg.textSpace});
break;case"prompt":a("#popup_content").append('<input type="text" size="21" id="popup_prompt" >');if(j){p=p>233?p:233;var n=(m*14+15)>p-100?(m*14+15):p-100;var b=n+100;a("#popup_container").css({minWidth:b,maxWidth:b,width:b});a("#popup_header").css({width:b});a("#popup_content").css({left:"50px",top:"45px",width:n,height:"59px",padding:"0"});a("#popup_message").css({fontSize:"14px",width:n,textAlign:"left"})}else{a("#popup_container").css({minWidth:"233px",maxWidth:"233px",width:"233px"});a("#popup_header").css({width:"233px"});
a("#popup_content").css({left:"50px",top:"52px",width:"130px",height:"59px",padding:"0"});a("#popup_message").css({width:"130px"})}var k=document.getElementById("popup_container").offsetWidth;var r=(k-140)/2-1;var c=new FR.createWidget({type:"quickbutton",style:this.style,text:FR.i18nText("FR-Basic_OK"),width:65,height:28,handler:function(){var e=a("#popup_prompt").val();FR.Msg._hide();if(i){i(e)}}});var u=c.element.appendTo("#popup_container").css({position:"absolute",left:r+"px",bottom:"8px",letterSpacing:FR.Msg.textSpace,textIndent:FR.Browser.isIE7Before()?0:FR.Msg.textSpace});
var f=new FR.createWidget({type:"quickbutton",style:"gray",text:FR.i18nText("FR-Basic_Cancel"),width:65,height:28,handler:function(){FR.Msg._hide();if(i){i(null)}}});var o=f.element.appendTo("#popup_container").css({position:"absolute",right:r+"px",bottom:"8px",letterSpacing:FR.Msg.textSpace,textIndent:FR.Browser.isIE7Before()?0:FR.Msg.textSpace});a("#popup_prompt").width(a("#popup_message").width());if(s){a("#popup_prompt").val(s)}a("#popup_prompt").focus().select();break}this._reposition();this._maintainPosition(true);
if(this.draggable){try{a("#popup_container").draggable({handle:a("#popup_title"),onStopDrag:function(){if(a("#popup_container").offset().top<0){a("#popup_container").css({top:"0px"})}if(a("#popup_container").offset().left<0){a("#popup_container").css({left:"0px"})}}});a("#popup_title").css({cursor:"move"})}catch(t){}}},_hide:function(){a("#popup_container").remove();this._overlay("hide");this._maintainPosition(false)},_overlay:function(b){switch(b){case"show":this._overlay("hide");a("BODY").append('<div id="popup_overlay"></div>');
a("#popup_overlay").css({position:"absolute",zIndex:99998,top:"0px",left:"0px",width:"100%",height:FR.windowHeight,background:this.overlayColor,opacity:this.overlayOpacity});break;case"hide":a("#popup_overlay").remove();break}},_reposition:function(){var c=FR.windowHeight;c=(c-a("#popup_container").outerHeight())/2+this.verticalOffset;c=c*this.verticalOffset;var b=FR.windowWidth;b=(b-a("#popup_container").outerWidth())/2+this.horizontalOffset;b=b*this.horizontalOffset;if(c<0){c=0}if(b<0){b=0}if(FR.Browser.isIE()){c=c+a(window).scrollTop()
}a("#popup_container").css({top:c+"px",left:b+"px"});a("#popup_overlay").height(FR.windowHeight)},_maintainPosition:function(b){if(this.repositionOnResize){switch(b){case true:a(window).bind("resize",function(){FR.Msg._reposition()});break;case false:a(window).unbind("resize");break}}}}}()})})(jQuery);
/*!
 * jLayout - JavaScript Layout Algorithms v0.2
 *
 * Licensed under the revised BSD License.
 * Copyright 2008, Bram Stein
 * All rights reserved.
 */
(function(){window.jLayout={layout:function(a,d){var b={},c=d||{};c.hgap=a.hgap||0;c.vgap=a.vgap||0;b.layout=function(e){return e};b.preferred=function(e){return{width:e.width(),height:e.height()}};b.minimum=function(e){return{width:0,height:0}};b.maximum=function(e){return{width:Number.MAX_VALUE,height:Number.MAX_VALUE}};return b},parameter:function(b){var g={},a=b.items||[],d=this.layout(b,g),f=b.scrollable,c=b.scrollContainer;
d.layout=function(j){var h=j.bounds(),n=j.insets(),p=h.width-(n.left+n.right),q=h.height-(n.top+n.bottom),m=0,l=0;for(var o=0;o<a.length;o++){var s=a[o];var k=(f||p==0)?s.width:Math.min(s.width,p-s.x);var r=(f||q==0)?s.height:Math.min(s.height,q-s.y);if(f){m=Math.max(m,k+s.x);l=Math.max(l,r+s.y)}s.el.bounds({"x":s.x,"y":s.y+(s.delta||0),"width":k,"height":r});s.el.doLayout()}if(c){c.bounds({"x":0,"y":0,width:m,height:l})}};function e(h){return function(){return{"width":0,"height":0}}}d.preferred=e("preferred");
d.minimum=e("minimum");d.maximum=e("maximum");return d},flow:function(h){var g={},b=this.layout(h,g),e=h.items||[],f=(h.alignment&&(h.alignment==="center"||h.alignment==="right"||h.alignment==="left")&&h.alignment)||"left",d=typeof h.hgap==="number"&&!isNaN(h.hgap)?h.hgap:5,i=typeof h.vgap==="number"&&!isNaN(h.vgap)?h.vgap:5;b.layout=function(j){var k=j.bounds(),l=j.insets(),n=0,o=e.length,r,q=[],p={width:0,height:0},m={x:l.left,y:l.top};k.width-=l.left+l.right;k.height-=l.top+l.bottom;for(;n<o;n+=1){if(e[n].el.isVisible()){r=e[n].el.preferredSize();
if((p.width+r.width)>k.width){c(q,m,p,k);q=[];m.y+=p.height;m.x=l.left;p.width=0;p.height=0}p.height=Math.max(p.height,r.height+i);p.width+=r.width+d;q.push(e[n])}}c(q,m,p,k);return j};function c(p,o,m,n){var k={x:o.x,y:o.y},l=0,j=p.length;switch(f){case"center":k.x+=(d+n.width-m.width)/2;break;case"right":k.x+=n.width-m.width+d;break}for(;l<j;l+=1){k.y=o.y;p[l].el.bounds(k);p[l].el.doLayout();k.x+=p[l].el.bounds().width+d}}function a(j){return function(n){var p=0,q=0,k=0,o,m=false,l=n.insets();for(;
p<e.length;p+=1){if(e[p].isVisible()){o=e[p][j+"Size"]();k=Math.max(k,o.height);q+=o.width}}return{"width":q+l.left+l.right+(e.length-1)*d,"height":k+l.top+l.bottom}}}b.preferred=a("preferred");b.minimum=a("minimum");b.maximum=a("maximum");return b},horizontal:function(h){var g={},c=this.layout(h,g),e=h.items||[],f=(h.alignment&&(h.alignment==="center"||h.alignment==="right"||h.alignment==="left")&&h.alignment)||"center",d=typeof h.hgap==="number"&&!isNaN(h.hgap)?h.hgap:2,i=typeof h.vgap==="number"&&!isNaN(h.vgap)?h.vgap:0;
c.layout=function(k){var j=k.bounds(),m=k.insets(),s=0,r=m.top+i,t=j.width-(m.left+m.right+d*2),o=0,q=j.height-(m.top+m.bottom),l=q-2*i,n,p=e.length;for(n=0;n<p;n++){var u=e[n];if(u.el.isVisible()){o+=(u.width+d)}}b(s,r,t-o+2*d,l);return k};function b(l,q,p,k){var o={"x":l,"y":q,"width":p,"height":k},m=0,j=e.length;switch(f){case"left":o.x+=0;break;case"center":o.x+=p/2;break;case"right":o.x+=p;break}for(;m<j;m++){var n=e[m];if(n.el.isVisible()){o.width=n.width;n.el.bounds(o);n.el.doLayout();o.x+=(n.width+d)
}}}function a(j){return function(m){var o=0,p=0,k=0,n,l=m.insets();for(;o<e.length;o+=1){if(e[o].el.isVisible()){n=e[o].el[j+"Size"]();k=Math.max(k,n.height);p+=e[o].width+d}}return{"width":p+l.left+l.right,"height":k+l.top+l.bottom}}}c.preferred=a("preferred");c.minimum=a("minimum");c.maximum=a("maximum");return c},vertical:function(b){var h={},d=this.layout(b,h),a=b.items||[],b=b,c=typeof b.hgap==="number"&&!isNaN(b.hgap)?b.hgap:0,g=typeof b.vgap==="number"&&!isNaN(b.vgap)?b.vgap:0;d.layout=function(k){var j=k.bounds(),l=k.insets(),m,o=a.length,r=l.left+c,q=l.top+g,s=j.height-(l.top+l.bottom+g*2),p=0,n=j.width-(l.left+l.right),t=n-2*c;
for(m=0;m<o;m++){var u=a[m];if(u.el.isVisible()){p+=u.height}}f(r,q,t,s-p);return k};function f(l,q,n,k){var p={"x":l,"y":q,"width":n,"height":k},m=0,j=a.length;for(;m<j;m++){var o=a[m];if(o.el.isVisible()){p.height=o.height;o.el.bounds(p);o.el.doLayout();p.y+=o.height+g}}}function e(i){return function(l){var n=0,o=0,j=0,m,k=l.insets();for(;n<a.length;n+=1){if(a[n].el.isVisible()){m=a[n].el[i+"Size"]();o=Math.max(o,m.width);j+=a[n].height+g}}return{"width":o+k.left+k.right,"height":j+k.top+k.bottom}
}}d.preferred=e("preferred");d.minimum=e("minimum");d.maximum=e("maximum");return d},gridLayout:function(l){var j={},f=this.layout(l,j),c=l.leftGap||0,g=l.rightGap||0,e=l.topGap||0,k=l.bottomGap||0,h=l.items||[],b=l.columns,m=l.rows,a=l.widths,i=l.heights;f.layout=function(D){var u=D.bounds();var I=D.insets(),r=u.width-(I.left+I.right)-c-g,M=u.height-(I.top+I.bottom)-e-k;var n={},C=0,o=0;if(a){for(var H=0;H<a.length;H++){var A=a[H];if(A!="auto"){n[""+H]=A;C+=A;o++}}}var q={},F=0,K=0;if(i){for(var H=0;
H<i.length;H++){var t=i[""+H];if(t!="auto"){q[H]=t;F+=t;K++}}}var G=(r-(b-1)*j.hgap-C)/(b-o),s=(M-(m-1)*j.vgap-F)/(m-K);var p=function(x,O,y,Q){if(!x){return y*(O+Q)}var w=0;for(var P=0;P<y;P++){var N=x[P];if(N=="auto"){w+=O}else{w+=N}if(P>0){w+=Q}}return w};for(var E=0;E<h.length;E++){var L=h[E];var B=n[L.column]||G,J=q[L.row]||s;var z=p(a,G,L.column,j.hgap);var v=p(i,s,L.row,j.vgap);if(L.el){L.el.bounds({"x":z+c,"y":v+e,"width":B,"height":J});L.el.doLayout()}}return D};function d(n){return function(q){if(n=="minimum"||n=="maximum"){return q[n.substring(0,3)+"Size"]()
}var s=q.bounds();var p=q.insets(),o=s.width-(p.left+p.right),r=s.height-(p.top+p.bottom),u=o-(b-1)*j.hgap,t=r-(m-1)*j.vgap;return{"width":u,"height":t}}}f.preferred=d("preferred");f.minimum=d("minimum");f.maximum=d("maximum");return f},tableLayout:function(m){var j={},f=this.layout(m,j),n=m.vgap,g=m.items,a=m.columnSize,l=m.rowSize,h=m.scrollContainer;f.layout=function(p){var o=p.bounds(),r=p.insets(),v=o.width-(r.left+r.right),w=o.height-(r.top+r.bottom),t=0,q=0;for(var C=0;C<g.length;C++){var A=g[C];
if(k(A)){t+=(i(C,w)+n)}else{for(var s=0;s<A.length;s++){var B=A[s];var z=c(C)-t;var u=i(C,w);q=Math.max(z+u,q);if(B==null){continue}var x={"x":e(s,v),"y":z};if(isNaN(B.el.width)){x.width=d(s,v)}if(isNaN(B.el.height)){x.height=u}B.element.bounds(x);B.element.doLayout()}}}if(h){h.bounds({x:0,y:0,width:v,height:q})}};function k(p){for(var o=0;o<p.length;o++){if(p[o]!=null&&p[o].element.isVisible()){return false}}return true}function e(q,p){var o=0;for(var r=0;r<q;r++){var s=a[r];if(s>0&&s<1){s=s*p}o+=s
}return o}function c(o){var q=0;for(var p=0;p<o;p++){q+=l[p]+n}return q}function d(p,o){var q=a[p];if(!isNaN(q)){if(q>0&&q<1){return q*o}return q}if(p!=a.length-1){return 0}return o-e(p,o)}function i(p,q){var o=l[p];if(!isNaN(o)){return o}if(p!=l.length-1){return 0}return q-c(p)}function b(o){return function(p){return{"width":0,"height":0}}}f.preferred=b("preferred");f.minimum=b("minimum");f.maximum=b("maximum");return f},borderlayout:function(i){var g={},d=this.layout(i,g),f=i.east,h=i.west,b=i.north,e=i.south,a=i.center;
d.layout=function(k){var j=k.bounds(),q=k.insets(),w=q.top,p=q.left,t=j.width-(q.left+q.right),u=j.height-(q.top+q.bottom);var l=0;var o=0;var x=t;var n=u;if(b&&b.el&&b.el.isVisible()){var m=b.height||b.el.height();b.el.bounds({"x":p,"y":w,"width":t,"height":m});l=w+m;n=u-m;b.el.doLayout()}if(e&&e.el&&e.el.isVisible()){var s=e.height||e.el.height();e.el.bounds({"x":p,"y":u-s,"width":t,"height":s});n-=s;e.el.doLayout()}if(h&&h.el&&h.el.isVisible()){var r=h.width||h.el.width();h.el.bounds({"x":p,"y":l,"width":r,"height":n});
o=p+r;x=t-r;h.el.doLayout()}if(f&&f.el&&f.el.isVisible()){var v=f.width||f.el.width();f.el.bounds({"x":t-v,"y":l,"width":v,"height":n});x=x-v;f.el.doLayout()}a.el.bounds({"x":o,"y":l,"width":x,"height":n});a.el.doLayout()};function c(j){return function(k){return{"width":0,"height":0}}}d.preferred=c("preferred");d.minimum=c("minimum");d.maximum=c("maximum");return d},card:function(b){var e={},c=this.layout(b,e),a=b.items;c.layout=function(h){var m=h.bounds(),g=h.insets(),f=m.width-(g.left+g.right),k=m.height-(g.top+g.bottom);
for(var j=0;j<a.length;j++){var l=a[j];if(l.el instanceof $&&l.el.isVisible()){l.el.bounds({"x":g.left,"y":g.top,"width":f,"height":k});l.el.doLayout()}}};function d(f){return function(g){return{"width":0,"height":0}}}c.preferred=d("preferred");c.minimum=d("minimum");c.maximum=d("maximum");return c},grid:function(h){var g={},d=this.layout(h,g),e=h.items||[],b=h.columns||e.length,i=h.rows||0;if(i>0){b=Math.floor((e.length+i-1)/i)}else{i=Math.floor((e.length+b-1)/b)}var a=h.widths||[],f=h.heights||[];
$.each([{ar:a,len:b},{ar:f,len:i}],function(j,k){while(k.ar.length<k.len){k.ar[k.ar.length]=-1}});d.layout=function(n){var m=n.bounds();var u,t,q=n.insets(),z=q.left,w=q.top,r=m.width-(q.left+q.right)-(b-1)*g.hgap,v=m.height-(q.top+q.bottom)-(i-1)*g.vgap;var l=Array.prototype.concat.call([],a),s=Array.prototype.concat.call([],f);$.each([{ar:l,len:r},{ar:s,len:v}],function(y,x){var j=0;$.each(x.ar,function(C,D){if(D>=0){x.len-=D}else{j++}});if(j>0){var B=x.len/j;$.each(x.ar,function(C,D){if(D<0){x.ar[C]=B
}})}});var k=0,p=0;for(u=0;u<e.length;u++){var o=l[k],A=s[p];e[u].bounds({"x":z,"y":w,"width":o,"height":A});if(k<b-1){z+=o+g.hgap;k++}else{w+=A+g.vgap;z=q.left;k=0;p++}e[u].doLayout()}return n};function c(j){return function(l){var t,m=0,u=0,v,p=l.insets();var r=Array.prototype.concat.call([],a),n=Array.prototype.concat.call([],f);var k=0,o=0;for(var t=0;t<e.length;t++){v=e[t][j+"Size"]();var m=r[k],u=n[o];if(a[k]<0){r[k]=Math.max(r[k],v.width)}if(f[o]<0){n[o]=Math.max(n[o],v.height)}if(k<b-1){k++
}else{k=0;o++}e[t].doLayout()}var s=0;$.each(r,function(x,y){if(y>0){s+=y}});var q=0;$.each(n,function(w,x){if(x>0){q+=x}});return{"width":p.left+p.right+s+(b-1)*g.hgap,"height":p.top+p.bottom+q+(i-1)*g.vgap}}}d.preferred=c("preferred");d.minimum=c("minimum");d.maximum=c("maximum");return d},center:function(a){var e={},c=this.layout(a,e),b=a.item||[];c.layout=function(g){var f=g.bounds(),i=g.insets(),m=i.left,l=i.top,j=f.width-(i.left+i.right),k=f.height-(i.top+i.bottom);var h=b.width||"auto",n=b.height||"auto";
if(h==="auto"){h=j}if(n==="auto"){n=k}if(b.el){b.el.bounds({"x":m+(j-h)*0.5,"y":l+(k-n)*0.5,"width":h,"height":n});b.el.doLayout()}};function d(f){return function(){return{"width":0,"height":0}}}c.preferred=d("preferred");c.minimum=d("minimum");c.maximum=d("maximum");return c}}})();
/*!
 * JSizes - JQuery plugin v0.31
 *
 * Licensed under the revised BSD License.
 * Copyright 2008, Bram Stein
 * All rights reserved.
 */
(function(b){var a=function(c){return parseFloat(c)||0};b.each(["min","max"],function(d,c){b.fn[c+"Size"]=function(g){var f,e;if(g){if(g.width){this.css(c+"-width",g.width)}if(g.height){this.css(c+"-height",g.height)}return this}else{f=this.css(c+"-width");e=this.css(c+"-height");return{"width":(c==="max"&&(f==="none"||a(f)===-1)&&Number.MAX_VALUE)||a(f),"height":(c==="max"&&(e==="none"||a(e)===-1)&&Number.MAX_VALUE)||a(e)}
}}});b.fn.isVisible=function(){return this.css("visibility")!=="hidden"&&this.css("display")!=="none"};b.each(["border","margin","padding"],function(d,c){b.fn[c]=function(e){if(e){if(e.top){this.css(c+"-top"+(c==="border"?"-width":""),e.top)}if(e.bottom){this.css(c+"-bottom"+(c==="border"?"-width":""),e.bottom)}if(e.left){this.css(c+"-left"+(c==="border"?"-width":""),e.left)}if(e.right){this.css(c+"-right"+(c==="border"?"-width":""),e.right)}return this}else{return{top:a(this.css(c+"-top"+(c==="border"?"-width":""))),bottom:a(this.css(c+"-bottom"+(c==="border"?"-width":""))),left:a(this.css(c+"-left"+(c==="border"?"-width":""))),right:a(this.css(c+"-right"+(c==="border"?"-width":"")))}
}}})})(jQuery);
/*!
 * jLayout JQuery Plugin v0.11
 *
 * Licensed under the revised BSD License.
 * Copyright 2008, Bram Stein
 * All rights reserved.
 */
if(jQuery&&jLayout){(function(a){a.fn.doLayout=function(){this.css({position:"absolute"});if(this.data("jlayout")){this.data("jlayout").layout(this,arguments)}};a.fn.insets=function(){var d=this.padding(),c=this.border();return{"top":d.top,"bottom":d.bottom+c.bottom+c.top,"left":d.left,"right":d.right+c.right+c.left}};a.fn.bounds=function(c){var b={hasIgnoredBounds:true};
if(c){if(!isNaN(c.x)){b.left=c.x}if(!isNaN(c.y)){b.top=c.y}if(c.width!=null){b.width=(c.width-(this.outerWidth(true)-this.width()));b.width=(b.width>=0)?b.width:c.width}if(c.height!=null){b.height=c.height-(this.outerHeight(true)-this.height());b.height=(b.height>=0)?b.height:c.height}if(a(this).data("sizeFixed")){b.width=c.width}this.css(b);var d=this.data("tmp");if(!d||!FR.equals(d,b)){this.triggerHandler(FR.Events.RESIZE,[b]);this.data("tmp",b)}return this}else{b=this.position();return{"x":b.left,"y":b.top,"width":this.outerWidth(),"height":this.outerHeight()}
}};a.each(["min","max"],function(c,b){a.fn[b+"imumSize"]=function(d){if(this.data("jlayout")){return this.data("jlayout")[b+"imum"](this)}else{return this[b+"Size"](d)}}});a.fn.preferredSize=function(){var d,e,c=this.margin(),b={width:0,height:0};if(this.data("jlayout")){b=this.data("jlayout").preferred(this);d=this.minimumSize();e=this.maximumSize();b.width+=c.left+c.right;b.height+=c.top+c.bottom;if(b.width<d.width||b.height<d.height){b.width=Math.max(b.width,d.width);b.height=Math.max(b.height,d.height)
}else{if(b.width>e.width||b.height>e.height){b.width=Math.min(b.width,e.width);b.height=Math.min(b.height,e.height)}}}else{b.width=this.bounds().width+c.left+c.right;b.height=this.bounds().height+c.top+c.bottom}return b}})(jQuery)};
jQuery.extend({unselectContents:function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}}});jQuery.fn.extend({selectContents:function(){$(this).each(function(b){var d=this;var c,a,f,e;if((f=d.ownerDocument)&&(e=f.defaultView)&&typeof e.getSelection!="undefined"&&typeof f.createRange!="undefined"&&(c=window.getSelection())&&typeof c.removeAllRanges!="undefined"){a=f.createRange();a.selectNode(d);if(b==0){c.removeAllRanges()
}c.addRange(a)}else{if(document.body&&typeof document.body.createTextRange!="undefined"&&(a=document.body.createTextRange())){a.moveToElementText(d);a.select()}}})},setCaret:function(){if(!$.browser.msie){return}var a=function(){var b=$(this).get(0);b.caretPos=document.selection.createRange().duplicate()};$(this).click(a).select(a).keyup(a)},insertAtCaret:function(c){var b=$(this).get(0);if(document.all&&b.createTextRange&&b.caretPos){var d=b.caretPos;d.text=d.text.charAt(d.text.length-1)==""?c+"":c
}else{if(b.setSelectionRange){var g=b.selectionStart;var f=b.selectionEnd;var h=b.value.substring(0,g);var e=b.value.substring(f);b.value=h+c+e;b.focus();var a=c.length;b.setSelectionRange(g+a,g+a);b.blur()}else{b.value+=c}}}});
$.extend(Date.prototype,{getTimezone:function(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getLastDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),this.getMonthDays())},getMonthDays:function(c){var b=[31,28,31,30,31,30,31,31,30,31,30,31];var a=this.getFullYear();if(typeof c=="undefined"){c=this.getMonth()}if(((0===(a%4))&&((0!==(a%100))||(0===(a%400))))&&c===1){return 29}else{return b[c]}},getWeekNumber:function(){var c=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);
var b=c.getDay();c.setDate(c.getDate()-(b+6)%7+3);var a=c.valueOf();c.setMonth(0);c.setDate(4);return Math.round((a-c.valueOf())/(7*86400000))+1}});(function(){var compileJFmt=function(jfmt,date){var str=jfmt.str,len=jfmt.len,ch=jfmt["char"];switch(ch){case"E":str=len<4?Date._SDN[date.getDay()]:Date._DN[date.getDay()];break;case"y":if(len<=3){str=(date.getFullYear()+"").slice(2,4)}else{str=date.getFullYear()}break;case"M":if(len>2){str=len>3?Date._MN[date.getMonth()]:Date._SMN[date.getMonth()]}else{if(len<2){str=date.getMonth()+1
}else{str=String.leftPad(date.getMonth()+1+"",2,"0")}}break;case"d":if(len>1){str=String.leftPad(date.getDate()+"",2,"0")}else{str=date.getDate()}break;case"h":var hour=date.getHours()%12;if(hour===0){hour=12}if(len>1){str=String.leftPad(hour+"",2,"0")}else{str=hour}break;case"H":if(len>1){str=String.leftPad(date.getHours()+"",2,"0")}else{str=date.getHours()}break;case"m":if(len>1){str=String.leftPad(date.getMinutes()+"",2,"0")}else{str=date.getMinutes()}break;case"s":if(len>1){str=String.leftPad(date.getSeconds()+"",2,"0")
}else{str=date.getSeconds()}break;case"a":str=date.getHours()<12?Date._NN[0]:Date._NN[1];break;case"z":str=date.getTimezone();break;default:str=jfmt.str;break}return str};FR.parseFmt=function(fmt){if(!fmt){return""}fmt=String(fmt).replace(/y{4,}/g,"%Y").replace(/y{2}/g,"%y").replace(/M{4,}/g,"%b").replace(/M{3}/g,"%B").replace(/M{2}/g,"%X").replace(/M{1}/g,"%x").replace(/a{1}/g,"%p");if(new RegExp("d{2,}","g").test(fmt)){fmt=fmt.replace(/d{2,}/g,"%d")}else{fmt=fmt.replace(/d{1}/g,"%e")}if(new RegExp("h{2,}","g").test(fmt)){fmt=fmt.replace(/h{2,}/g,"%I")
}else{fmt=fmt.replace(/h{1}/g,"%I")}if(new RegExp("H{2,}","g").test(fmt)){fmt=fmt.replace(/H{2,}/g,"%H")}else{fmt=fmt.replace(/H{1}/g,"%H")}fmt=fmt.replace(/m{2,}/g,"%M").replace(/s{2,}/g,"%S");return fmt};FR.matchDateFormat=function(date,format){if(typeof date!="string"||typeof format!="string"||!date||!format){return false}var zh_yMd="["+String.fromCharCode(24180)+String.fromCharCode(26376)+String.fromCharCode(26085)+"]";if(date.match(zh_yMd)){if(format.match(zh_yMd)){date=date.replaceAll(zh_yMd,"-");
format=format.replaceAll(zh_yMd,"-");if(date.endWith("-")&&format.endWith("-")){date=date.substring(0,date.length-1);format=format.substring(0,format.length-1)}}else{return false}}else{if(format.match(zh_yMd)){return false}}var isAM=null;if(format.endWith(" a")){format=format.substring(0,format.length-2);if(date.endWith(" am")||date.endWith(" pm")){isAM=date.endWith(" am");date=date.substring(0,date.length-3)}else{return false}}if(date.replace(/[0-9]/g,"")!=format.replace(/[YyMmDdHhSsa]/g,"")){return false
}var formatStr=format;var dateStr=date;var formatArr=[];var dateArr=[];if(format.indexOf(" ")==-1){dateArr=shortMatch(dateStr,formatStr);if(!dateArr){return false}}else{var ff=format.split(" ");var dd=date.split(" ");for(var i=0;i<ff.length;i++){var temp=shortMatch(dd[i],ff[i]);if(!temp){return false}else{dateArr=dateArr.concat(temp)}}}function shortMatch(str,fmt){var da=[];var fa=[];if(fmt.match(/[-/:.]/)){fa=fmt.split(/[-/:.]/);formatArr=formatArr.concat(fa);var da=str.split(/[-/:.]/);return da
}while(fmt.length>0){var reg=new RegExp(fmt.substring(0,1)+"+");var f=fmt.match(reg).toString();fa.push(f);formatArr.push(f);fmt=fmt.substring(f.length)}var len=0;for(var i=0;i<fa.length;i++){var tmpLen=0;if(fa[i].length===1){if(i==fa.length-1){tmpLen=str.length-len}else{if(i==fa.length-2){switch(str.length-len){case 2:tmpLen=1;break;case 3:if(invalidStr(str.substring(len,len+2),fa[i])||fa[i+1].length===2){tmpLen=1}else{if(fa[i+1].length===1&&invalidStr(str.substring(len+1,len+3),fa[i+1])){tmpLen=2
}else{tmpLen=1}}break;case 4:tmpLen=2;break;default:return false}}}}else{tmpLen=fa[i].length}da[i]=str.substring(len,len+tmpLen);len+=tmpLen}return da}function invalidStr(str,fm){return str.match(/[Mh]/)&&parseInt(fm,10)>12||str.match(/[d]/)&&parseInt(fm,10)>31||str.match(/[H]/)&&parseInt(fm,10)>23||str.match(/[ms]/)&&parseInt(fm,10)>59}if(formatArr.length!=dateArr.length){return false}else{for(var i=0;i<formatArr.length;i++){var ff=formatArr[i].replace(/ /g,"");var vv=dateArr[i].replace(/ /g,"");
if(ff.length===1&&((vv.length===2&&vv.startWith("0"))||vv.length>2)||ff.length===2&&vv.length!==2||ff.length===4&&vv.length!==4){return false}}var que=["y","M","d","h","H","m","s"];for(var i=0;i<formatArr.length;i++){if(formatArr[i].match(/[yMd]/)){for(var j=i+1;j<formatArr.length;j++){if(formatArr[j].match(/[yMd]/)&&que.indexOf(formatArr[i].substring(0,1))>que.indexOf(formatArr[j].substring(0,1))){var tmp=formatArr[i];formatArr[i]=formatArr[j];formatArr[j]=tmp;tmp=dateArr[i];dateArr[i]=dateArr[j];
dateArr[j]=tmp}}}}if(!format.match(/[hHms]/)){var dt="";for(var i=0;i<dateArr.length;i++){var yMd=formatArr[i]=="yy"?"20"+dateArr[i]:dateArr[i];dt=dt.length===0?yMd:dt+"/"+yMd}var res=new Date(dt);if(!FR.isInvalidDate(res)){if(!inMonthRange(res)){return false}return res}else{if(!FR.isInvalidDate(new Date(dt+"/01"))){return new Date(dt+"/01")}else{if(!FR.isInvalidDate(new Date(dt+"/01"+"/01"))){return new Date(dt+"/01"+"/01")}}}}else{if(checkHms(date)){return date}var dt="";var spt=false;for(var i=0;
i<formatArr.length;i++){if(formatArr[i].match(/[yMd]/)){var yMd=formatArr[i]=="yy"?"20"+dateArr[i]:dateArr[i];dt=dt.length===0?yMd:dt+"/"+yMd}else{var hms=dateArr[i];if(formatArr[i].indexOf("h")!=-1&&isAM===false&&parseInt(hms)<12){hms=parseInt(hms)+12}if(!spt){dt=dt+" "+hms;spt=true}else{dt=dt+":"+hms}}}var res=new Date(dt);if(!inMonthRange(res)){return false}return res}}function checkHms(timeStr){var parts;if(FR.isEmpty(timeStr)){return false}parts=timeStr.split(":");if(FR.isEmpty(parts)){return false
}for(i=0;i<parts.length;i++){if(isNaN(parts[i])){return false}}if(parts.length===2){h=parts[0];m=parts[1];if(format.match(/[s]/)){if(h<0||h>59){return false}if(m<0||m>59){return false}}else{if(h<0||h>23){return false}if(m<0||m>59){return false}}return true}else{if(parts.length===3){h=parts[0];m=parts[1];s=parts[3];if(h<0||h>23){return false}if(m<0||m>59){return false}if(s<0||s>59){return false}}}return true}function inMonthRange(res){var d,m;for(var i=0;i<formatArr.length;i++){if(formatArr[i].indexOf("d")!=-1){d=dateArr[i].replace(/^[0]/,"")
}else{if(formatArr[i].indexOf("M")!=-1){m=dateArr[i].replace(/^[0]/,"")}}}if(d==null||m==null){return true}return parseInt(d)==res.getDate()&&parseInt(m)==res.getMonth()+1}};FR.str2Date=function(str,format){if(typeof str!="string"||typeof format!="string"){return null}var fmt=FR.parseFmt(format);return Date.parseDateTime(str,fmt)};FR.date2Str=function(date,format){if(!date){return""}var len=format.length,result="";if(len>0){var flagch=format.charAt(0),start=0,str=flagch;for(var i=1;i<len;i++){var ch=format.charAt(i);
if(flagch!==ch){result+=compileJFmt({"char":flagch,"str":str,"len":i-start},date);flagch=ch;start=i;str=flagch}else{str+=ch}}result+=compileJFmt({"char":flagch,"str":str,"len":len-start},date)}return result};Date.patterns={ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"};Date.parseFunctions={count:0};
Date.parseRegexes=[];Date.formatFunctions={count:0};Date._MN=[FR.i18nText("FR-Base_January"),FR.i18nText("FR-Base_February"),FR.i18nText("FR-Base_March"),FR.i18nText("FR-Base_April"),FR.i18nText("FR-Base_May"),FR.i18nText("FR-Base_June"),FR.i18nText("FR-Base_July"),FR.i18nText("FR-Base_August"),FR.i18nText("FR-Base_September"),FR.i18nText("FR-Base_October"),FR.i18nText("FR-Base_November"),FR.i18nText("FR-Base_December")];Date._SMN=[FR.i18nText("FR-Base_Short_Jan"),FR.i18nText("FR-Base_Short_Feb"),FR.i18nText("FR-Base_Short_Mar"),FR.i18nText("FR-Base_Short_Apr"),FR.i18nText("FR-Base_Short_May"),FR.i18nText("FR-Base_Short_Jun"),FR.i18nText("FR-Base_Short_Jul"),FR.i18nText("FR-Base_Short_Aug"),FR.i18nText("FR-Base_Short_Sep"),FR.i18nText("FR-Base_Short_Oct"),FR.i18nText("FR-Base_Short_Nov"),FR.i18nText("FR-Base_Short_Dec")];
Date._DN=[FR.i18nText("FR-Base_Sche_Sunday"),FR.i18nText("FR-Base_Sche_Monday"),FR.i18nText("FR-Base_Sche_Tuesday"),FR.i18nText("FR-Base_Sche_Wednesday"),FR.i18nText("FR-Base_Sche_Thursday"),FR.i18nText("FR-Base_Sche_Friday"),FR.i18nText("FR-Base_Sche_Saturday")];Date._SDN=[FR.i18nText("FR-Base_Sun"),FR.i18nText("FR-Base_Mon"),FR.i18nText("FR-Base_Tue"),FR.i18nText("FR-Base_Wed"),FR.i18nText("FR-Base_Thu"),FR.i18nText("FR-Base_Fri"),FR.i18nText("FR-Base_Sat")];Date._NN=[FR.i18nText("FR-Base_Ante_Meridian"),FR.i18nText("FR-Base_Post_Meridian")];
Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.getMonthNumber=function(name){return Date.monthNumbers[name.substring(0,1).toUpperCase()+name.substring(1,3).toLowerCase()]};Date.parseDate=function(input,format){if(Date.parseFunctions[format]==null){Date.createParser(format)}var func=Date.parseFunctions[format];return Date[func](input)};Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;
var currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input){\n"+"var y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, ms = -1, o, z, u, v;\n"+"var d = new Date();\n"+"y = d.getFullYear();\n"+"m = d.getMonth();\n"+"d = d.getDate();\n"+"var results = input.match(Date.parseRegexes["+regexNum+"]);\n"+"if (results && results.length > 0) {";var regex="";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true
}else{if(special){special=false;regex+=String.escape(ch)}else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c){code+=obj.c}}}}code+="if (u)\n"+"{v = new Date(u * 1000);}"+"else if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0 && ms >= 0)\n"+"{v = new Date(y, m, d, h, i, s, ms);}\n"+"else if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n"+"{v = new Date(y, m, d, h, i, s);}\n"+"else if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n"+"{v = new Date(y, m, d, h, i);}\n"+"else if (y >= 0 && m >= 0 && d > 0 && h >= 0)\n"+"{v = new Date(y, m, d, h);}\n"+"else if (y >= 0 && m >= 0 && d > 0)\n"+"{v = new Date(y, m, d);}\n"+"else if (y >= 0 && m >= 0)\n"+"{v = new Date(y, m);}\n"+"else if (y >= 0)\n"+"{v = new Date(y);}\n"+"}return (v && (z || o))?\n"+"    (z ? v.add(Date.SECOND, (v.getTimezoneOffset() * 60) + (z*1)) :\n"+"        v.add(Date.HOUR, (v.getGMTOffset() / 100) + (o / -100))) : v\n"+";}";
Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$","i");eval(code)};Date.parseDateTime=function(str,fmt){var today=new Date();var y=0;var m=0;var d=1;var a=str.split(/\W+/);if(fmt.toLowerCase()=="%y%x"||fmt.toLowerCase()=="%y%x%d"){var tempStr=a.join("");var yearlength=4;var otherlength=2;a[0]=tempStr.substring(0,yearlength);a[1]=tempStr.substring(yearlength,yearlength+otherlength);a[2]=tempStr.substring(yearlength+otherlength,yearlength+otherlength*2)}var b=fmt.match(/%./g);var i=0,j=0;var hr=0;
var min=0;var sec=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%X":m=parseInt(a[i],10)-1;break;case"%x":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":for(j=0;j<12;++j){if(Date._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12
}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);case"%S":sec=parseInt(a[i],10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(isNaN(sec)){sec=today.getSeconds()}if(y!==0){return new Date(y,m,d,hr,min,sec)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Date._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;
break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y===0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d===0){d=a[i]}}}}}if(y===0){y=today.getFullYear()}if(m!==-1&&d!==0){return new Date(y,m,d,hr,min,sec)}return today};Date.formatCodeToRegex=function(character,currentGroup){switch(character){case"d":return{g:1,c:"d = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"D":for(var a=[],i=0;i<7;a.push(Date._SDN[i]),++i){}return{g:0,c:null,s:"(?:"+a.join("|")+")"};
case"j":return{g:1,c:"d = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"N":return{g:0,c:null,s:"[1-7]"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"[0-6]"};case"z":return{g:0,c:null,s:"(?:\\d{1,3}"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.getMonthNumber(results["+currentGroup+"]), 10);\n",s:"("+Date._MN.join("|")+")"};case"m":return{g:1,c:"m = parseInt(results["+currentGroup+"], 10) - 1;\n",s:"(\\d{2})"};
case"M":for(var a=[],i=0;i<12;a.push(Date._SMN[i]),++i){}return{g:1,c:"m = parseInt(Date.getMonthNumber(results["+currentGroup+"]), 10);\n",s:"("+a.join("|")+")"};case"n":return{g:1,c:"m = parseInt(results["+currentGroup+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"(?:\\d{2})"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"o":case"Y":return{g:1,c:"y = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+currentGroup+"], 10);\n"+"y = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};
case"a":return{g:1,c:"if (results["+currentGroup+"] == 'am') {\n"+"if (h == 12) { h = 0; }\n"+"} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+currentGroup+"] == 'AM') {\n"+"if (h == 12) { h = 0; }\n"+"} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":return{g:1,c:"h = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"h":case"H":return{g:1,c:"h = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"i":return{g:1,c:"i = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};
case"s":return{g:1,c:"s = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"u":return{g:1,c:"ms = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{3})"};case"O":return{g:1,c:["o = results[",currentGroup,"];\n","var sn = o.substring(0,1);\n","var hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60);\n","var mn = o.substring(3,5) % 60;\n","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))?\n","    (sn + String.leftPad(hr, 2, 0) + String.leftPad(mn, 2, 0)) : null;\n"].join(""),s:"([+\\-]\\d{4})"};
case"P":return{g:1,c:["o = results[",currentGroup,"];\n","var sn = o.substring(0,1);\n","var hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60);\n","var mn = o.substring(4,6) % 60;\n","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))?\n","    (sn + String.leftPad(hr, 2, 0) + String.leftPad(mn, 2, 0)) : null;\n"].join(""),s:"([+\\-]\\d{2}:\\d{2})"};case"T":return{g:0,c:null,s:"[A-Z]{1,4}"};case"Z":return{g:1,c:"z = results["+currentGroup+"] * 1;\n"+"z = (-43200 <= z && z <= 50400)? z : null;\n",s:"([+\\-]?\\d{1,5})"};
case"c":var df=Date.formatCodeToRegex,calc=[];var arr=[df("Y",1),df("m",2),df("d",3),df("h",4),df("i",5),df("s",6),df("P",7)];for(var i=0,l=arr.length;i<l;++i){calc.push(arr[i].c)}return{g:1,c:calc.join(""),s:arr[0].s+"-"+arr[1].s+"-"+arr[2].s+"T"+arr[3].s+":"+arr[4].s+":"+arr[5].s+arr[6].s};case"U":return{g:1,c:"u = parseInt(results["+currentGroup+"], 10);\n",s:"(-?\\d+)"};default:return{g:0,c:null,s:character.replace(/([.*+?^$}{()|[\]\/\\])/g,"\\$1")}}};if(FR.Browser.r.safari){Date.brokenSetMonth=Date.prototype.setMonth;
Date.prototype.setMonth=function(num){if(num<=-1){var n=Math.ceil(-num);var back_year=Math.ceil(n/12);var month=(n%12)?12-n%12:0;this.setFullYear(this.getFullYear()-back_year);return Date.brokenSetMonth.call(this,month)}else{return Date.brokenSetMonth.apply(this,arguments)}}}})();
(function(a){FR.Layout=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.Layout.superclass._defaultConfig.apply(),{scrollable:false,scrollx:false,scrolly:false,widgetBackground:null,border:null,onClick:null})},_init:function(){FR.Layout.superclass._init.apply(this,arguments);this._init4Margin();this._init4Style();this._init4Scroll();this._init4Click()},_init4Margin:function(){if(this.options.marginTop){this.element.css("marginTop",this.options.marginTop);this.marginHeight=(this.marginHeight||0)+parseInt(this.options.marginTop)
}if(this.options.marginLeft){this.element.css("marginLeft",this.options.marginLeft);this.marginWidth=(this.marginWidth||0)+parseInt(this.options.marginLeft)}if(this.options.marginBottom){this.element.css("marginBottom",this.options.marginBottom);this.marginHeight=(this.marginHeight||0)+parseInt(this.options.marginBottom)}if(this.options.marginRight){this.element.css("marginRight",this.options.marginRight);this.marginWidth=(this.marginWidth||0)+parseInt(this.options.marginRight)}},_init4Style:function(){this._initBackGround();
var b=this.options.border;if(b){this.element.css("border-style",b.type);this.element.css("border-color",b.color);this.element.css("border-width",b.width);if(b.corner){this.element.css("border-radius","15px 15px 15px 15px");if(a.browser.msie){this.element.addClass("ie-border-radius")}}if(!(a.browser.msie&&a.browser.version<"9.0")){this.element.css("box-shadow",b.borderStyle)}}},_initBackGround:function(){if(!this.options.widgetBackground){return}if(this.options.type&&this.options.type=="fit"){this._initFitBackground();
return}var b=this.options.widgetOpacity;if(!b){this.element.css("background",this.options.widgetBackground.background);return}this.$background=a("<div class='widgetBackground'></div>");this.$background.css("filter","alpha(opacity="+b*100+")");this.$background.css("opacity",b);this.element.css("background",this.options.widgetBackground.background);this.$background.prependTo(this.element)},_initFitBackground:function(){var d=this.element.parent();var e=this.element.margin();var b=this.element.width()+(e.left||0)+(e.right||0);
var c=this.element.height()+(e.top||0)+(e.bottom||0);if(this.$background&&d.has(this.$background).length>0){this._updateSimpleStyle(b,c);return}this.$background=a("<div class='widgetBackground'></div>");this.$background.css("position","absolute");var f=this.options.widgetOpacity;if(f){this.$background.css("filter","alpha(opacity="+f*100+")");this.$background.css("opacity",f)}this._updateSimpleStyle(b,c);FR.setBackground(this.$background,this.options.widgetBackground,c);this.$background.prependTo(d)
},_updateSimpleStyle:function(b,c){this.$background.css("width",(b||0));this.$background.css("height",(c||0));this.$background.css("top",this.element.css("top"));this.$background.css("left",this.element.css("left"))},_init4Scroll:function(){if(!this.options.scrollable){this.element.css("overflow","hidden")}else{this.element.css("overflow","auto")}if(this.options.scrollx){this.element.css({"overflow-x":"auto","overflow-y":"hidden"})}if(this.options.scrolly){this.element.css({"overflow-x":"hidden","overflow-y":"auto"})
}},_init4Click:function(){var b=this;this.element.click(function(d){b.fireEvent(FR.Events.CLICK,d)});var c=this.options;if(a.isFunction(c.onClick)){this.element.bind("click",c.onClick.createDelegate(this))}},doLayout:function(){this.element.doLayout(arguments)},setMinSize:function(){if(this.element.length>0&&this.element[0].tagName=="BODY"){var b=this.element["minimumSize"]();this.element.css({"min-width":b.width,"min-height":b.height});a("html").css("overflow","auto")}},_confirmEvents:function(){}});
FR.ParameterLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.ParameterLayout.superclass._defaultConfig.apply(),{baseCls:"fr-absolutelayout",scrollable:false})},_init:function(){FR.ParameterLayout.superclass._init.apply(this,arguments);var g=this.options;this.element.addClass(g.baseCls);if(!a.isArray(g.items)){g.items=[];return}var d=g.items,f,b=d.length;g.widgets=[];var j=this.element;if(g.scrollable){j=a('<div class="fr-core-layout-scrollable">').css({position:"absolute",top:0,left:0}).appendTo(this.element);
g.scrollContainer=j}for(f=0;f<b;f++){var c=d[f];if(!c.style){c.style=g.style}if(c.type){c.el=c}if(c.el.type){var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));g.widgets.push(h);var e=h.element;e.css({left:c.x,top:c.y,position:"absolute"});d[f].el=e;j.append(e);h.doResize({width:c.width,height:c.height})}else{if(c.el instanceof a){var e=c.el;e.css({left:c.x,top:c.y,position:"absolute"});j.append(e)}}}this.element.data("jlayout",jLayout.parameter(g));if(a.browser.msie&&!a.support.boxModel){if(g.height===0){g.height=1
}if(g.width===0){g.width=1}}},doResize:function(f){FR.ParameterLayout.superclass.doResize.call(this,f);var d=this.options;this.element.css({width:(f?(f.width||d.width):d.width),height:f?(f.height||d.height):d.height,left:f?(f.left||d.left):d.left,top:f?(f.top||d.top):d.top});for(var c=0,b=this.options.widgets.length;c<b;c++){var e=this.options.widgets[c];if(a.isFunction(e.doResize)){e.doResize({})}}},doLayout:function(){FR.ParameterLayout.superclass.doLayout.apply(this,arguments);for(var c=0,b=this.options.widgets.length;
c<b;c++){var d=this.options.widgets[c];if(a.isFunction(d.doLayout)){d.doLayout()}}}});a.shortcut("parameter",FR.ParameterLayout);FR.FlowLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.FlowLayout.superclass._defaultConfig.apply(),{hgap:5,vgap:5,baseCls:"fr-flowlayout"})},_init:function(){FR.FlowLayout.superclass._init.apply(this,arguments);var g=this.options;this.element.addClass(g.baseCls);var d=g.items,f,b=d.length;g.widgets=[];for(f=0;f<b;f++){var c=d[f];if(c.el&&c.el.type){if(!c.el.style){c.el.style=g.style
}var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));g.widgets.push(h);var e=h.element;d[f].el=e;this.element.append(e)}else{if(c.el instanceof a){this.element.append(c.el)}}}this.element.data("jlayout",jLayout.flow(g))},doResize:function(c){FR.FlowLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:b.width,height:b.height,left:b.left,top:b.top})},doLayout:function(){FR.FlowLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("flow",FR.FlowLayout);
FR.GridLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.GridLayout.superclass._defaultConfig.apply(),{hgap:0,vgap:0,leftGap:0,rightGap:0,topGap:0,bottomGap:0,baseCls:"fr-gridlayout"})},_init:function(){FR.GridLayout.superclass._init.apply(this,arguments);var g=this.options;this.element.addClass(g.baseCls);var d=g.items,b=d.length;g.widgets=[];for(var e=0;e<b;e++){var c=d[e];if(c.el.type){if(!c.el.style){c.el.style=g.style}var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));
g.widgets.push(h);var f=h.element}else{f=c.el}c.el=f;this.element.append(f)}this.element.data("jlayout",jLayout.gridLayout(g))},doResize:function(c){FR.GridLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:(c?(c.height||b.height):b.height),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top})},doLayout:function(){FR.GridLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("grid",FR.GridLayout);FR.FrozenGridLayout=FR.extend(FR.Layout,{_init:function(){FR.FrozenGridLayout.superclass._init.apply(this,arguments);
var c=this.element;var b=this.options;a.each(b.items||[],function(d,e){if(e.parent()[0]!=c[0]){e.appendTo(c)}});c.data("jlayout",jLayout.grid(b))},doLayout:function(){this.element.doLayout()},doResize:function(c){FR.FrozenGridLayout.superclass.doResize.apply(this,arguments);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width)-(this.marginWidth||0),height:(c?(c.height||b.height):b.height)-(this.marginHeight||0),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top})}});a.shortcut("frozengrid",FR.FrozenGridLayout);
FR.TableLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.TableLayout.superclass._defaultConfig.apply(),{baseCls:"fr-layout-table",vgap:5,items:[],columnSize:[],rowSize:[],scrollable:false})},_init:function(){FR.TableLayout.superclass._init.apply(this,arguments);var f=this.options;var b=f.items;var k=this.element;if(f.scrollable){k=a('<div class="fr-core-layout-scrollable">').css({position:"absolute",top:0,left:0}).appendTo(this.element);f.scrollContainer=k}for(var d=0;d<b.length;
d++){var h=b[d];for(var c=0;c<h.length;c++){var e=h[c];if(e==null){continue}if(e&&e.el&&e.el.type){if(!e.el.style){e.el.style=f.style}var g=FR.createWidget(a.extend(e.el,{resultWidgets:f.resultWidgets}));e.element=g.element}else{if(e&&e.el instanceof a){e.element=e.el}}k.append(e.element)}}this.element.data("jlayout",jLayout.tableLayout(f))},setRowVisible:function(c,b){if(a.isArray(c)){for(var g=0;g<c.length;g++){this.setRowVisible(c[g],b)}}else{var e=this.options.items[c];for(var d=0;d<e.length;
d++){var f=e[d];if(f&&f.element){if(b===true){f.element.show()}else{f.element.hide()}}}}},isRowVisible:function(b){var d=this.options.items[b];for(var c=0;c<d.length;c++){var e=d[c];if(e&&e.element){if(!e.element.isVisible()){return false}}}return true},refreshRowSize:function(b){this.options.rowSize=b;this.element.data("jlayout",jLayout.tableLayout(this.options));this.doLayout()},doResize:function(c){FR.TableLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:(c?(c.height||b.height):b.height),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top});
this.doLayout()},doLayout:function(){FR.TableLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("tablelayout",FR.TableLayout);FR.BorderLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.BorderLayout.superclass._defaultConfig.apply(),{baseCls:"fr-quick-border-layout"})},_init:function(){FR.BorderLayout.superclass._init.apply(this,arguments);var f=this.options;var b=f.items;var d=["north","south","east","west","center"];this.regionField={};for(var c=0;c<b.length;c++){var e=b[c];
var h=e["region"];if(d.indexOf(h)!=-1){if(e.el&&e.el.type){if(!e.el.style){e.el.style=f.style}var g=FR.createWidget(a.extend(e.el,{width:e.width,height:e.height,resultWidgets:f.resultWidgets}));e.el=g.element}this.element.append(e.el);this.regionField[h]=e}}this.element.data("jlayout",jLayout.borderlayout(this.regionField))},setRegionWH:function(c,b){if(!c||isNaN(b)){return}switch(c){case"north":this.regionField["north"].height=b;break;case"south":this.regionField["south"].height=b;break;case"east":this.regionField["east"].width=b;
break;case"west":this.regionField["west"].width=b;break;default:}this.element.data("jlayout",jLayout.borderlayout(this.regionField))},doResize:function(c){FR.BorderLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:(c?(c.height||b.height):b.height),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top});this.doLayout()},doLayout:function(){FR.BorderLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("border",FR.BorderLayout);
FR.CenterLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.CenterLayout.superclass._defaultConfig.apply(),{baseCls:"fr-quick-center-layout"})},_init:function(){FR.CenterLayout.superclass._init.apply(this,arguments);var c=this.options,b=c.item;if(b&&b.el){if(b.el.type){if(!b.el.style){b.el.style=c.style}var d=FR.createWidget(a.extend(b.el,{width:b.width,height:b.height,resultWidgets:c.resultWidgets}));b.el=d.element}else{if(!(b.el instanceof a)){FR.Msg.toast("el must be a widget or a jQuery element!");
b.el=a("<div>")}}this.element.append(b.el)}this.element.data("jlayout",jLayout.center(c))},doLayout:function(){FR.CenterLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("center",FR.CenterLayout);FR.CardLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.CardLayout.superclass._defaultConfig.apply(),{baseCls:"fr-quick-card-layout",defaultShowIndex:0,hideAction:null,showAction:null})},_init:function(){FR.CardLayout.superclass._init.apply(this,arguments);var b=this.options;
this.name2Index={};this.cardsHasCreated=[];this._initNameMap();this.showCardByIndex(b.defaultShowIndex)},_initNameMap:function(){var b=this.options.items;for(var d=0;d<b.length;d++){var c;if(b[d].el){c=b[d].el.widgetName}else{c=b[d].widgetName}if(!FR.isEmpty(c)){this.name2Index[c]=d}}},showPaneByIndex:function(b){this.showCardByIndex(b)},showCardByIndex:function(f){var b=this.options;var g=b.items;this.showIndex=f;for(var e=0;e<this.cardsHasCreated.length;e++){var i=this.cardsHasCreated[e];var c=g[i];
this._hideItem(c)}if(f>-1&&f<g.length){var j=this.cardsHasCreated.indexOf(f);if(j==-1){var k=g[f];if(!k.el){k.el=k}if(k&&k.el&&k.el.type){var d=FR.createWidget(a.extend(k.el,{resultWidgets:b.resultWidgets}));k.el=d.element}k.el.hide();this.element.append(k.el);this.cardsHasCreated.push(f);this.element.data("jlayout",jLayout.card(b));this._showItem(k)}else{c=g[f];this._showItem(c)}}this.doLayout()},_hideItem:function(c){var b=this.options;if(a.isFunction(b.hideAction)){b.hideAction.apply(this,[c])
}else{c.el.hide()}},_showItem:function(b){b.el.show()},getShowIndex:function(){return this.showIndex?this.showIndex:this.options.defaultShowIndex},showPaneByName:function(b){return this.showCardByName(b)},showCardByName:function(b){if(FR.isEmpty(b)){return}this.showCardByIndex(this.name2Index[b.toUpperCase()])},doResize:function(c){FR.CardLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:(c?(c.height||b.height):b.height),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top});
this.doLayout()},doLayout:function(){FR.CardLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("card",FR.CardLayout)})(jQuery);
(function(){var a;var c;var b;$.extend(FR,{showConfirmDialog:function(d){FR.showUpdateDialog(d)},showUpdateDialog:function(d){var f=$.extend({title:" ",text4OK:FR.i18nText("FR-Basic_OK"),text4Cancel:FR.i18nText("FR-Basic_Cancel"),onOK:FR.emptyFn(),onCancel:FR.emptyFn(),destroyOnClose:true,width:400,height:300,modal:true,confirm:true,doSize:true,border:true,closable:true,contentUrl:null,contentHtml:null,contentWidget:null,contentText:null,tools:null,style:null},d);var e=new FR.Dialog(f);e.setVisible(true)
},showDialog:function(f){if(arguments.length>1){var k=arguments[3];if(typeof arguments[3]==="string"){k="<div>"+arguments[3]+"</div>"}var i=arguments[1]?Math.min(FR.windowWidth,arguments[1]):400;var d=arguments[2]?Math.min(FR.windowHeight,arguments[2]):300;var e=$(window).width();var g=$(window).height();if(FR.Browser.isIE8Before()){e=FR.windowWidth;g=FR.windowHeight}var j={title:arguments[0]||""+(FR.PROJECTNAME==null?"":" "+FR.PROJECTNAME),width:i,height:d,contentHtml:k||"",left:(e-i)/2+$(document).scrollLeft(),top:(g-d)/2+$(document).scrollTop()};
f=$.extend(true,{modal:true,doSize:true,border:true,closable:true,destroyOnClose:FR.Browser.isIE()?true:false},arguments[4],j)}if(!a||FR.Browser.isIE()){if(a){FR.destroyDialog()}a=new FR.Dialog(f)}else{a.setTitle(f.title||"");a.setContent({type:"contentHtml",content:f.contentHtml})}a.doResize({width:f.width,height:f.height,left:f.left,top:f.top});a.setVisible(true)},showIframeDialog:function(d){if(typeof d=="string"){d={url:d}}var e;if(d.url){d.url=d.url+((/\?/.test(d.url)?"&":"?")+"_="+$.now());
e=$("<iframe width='100%' height='100%' scrolling='no' frameborder='0'>");e.attr("src",d.url)}else{if(d.iframe){e=$(d.iframe);if(d.widget){e.asComponent(d.widget)}}else{e=$("<iframe width='100%' height='100%' scrolling='no' frameborder='0'>")}}return FR.showDialog(d.title,d.width||350,d.height||480,e)},showAsyncDialog:function(d){FR.showLoadingDialog(d);var e=d.callback;FR.ajax($.extend({type:"POST",complete:function(g,f){FR.hideLoadingDialog();if(typeof(e)=="function"){e(g,f)}}},d))},closeDialog:function(){if(a!=null){a.setVisible(false)
}},showLoadingDialog:function(d){d=d||{};d.width=d.width||200;d.height=d.height||80;d.title=d.title||FR.i18nText("FR-Basic_Loading");d.closable=d.closable||false;d.modal=true;d.animate=0;d.contentHtml="<div class='fr-core-panel-loading'>"+(d.text?d.text:FR.i18nText("FR-Basic_Loading"))+"</div>";if(c==null){c=new FR.Dialog(d)}else{c.setTitle(d.title);c.doResize({width:d.width,height:d.height});c.setContent({type:"contentHtml",content:d.contentHtml})}c.setVisible(true)},hideLoadingDialog:function(){if(c!=null){c.setVisible(false)
}},destroyDialog:function(){if(a!=null){a.destroy();a=null}},showEmailDialog:function(e){e=e||{};e.width=e.width||400;e.height=e.height||410;e.title=FR.i18nText("FR-Basic_Email");e.onFinish=e.onFinish||FR.emptyFn();var h=12,f="simsun",p="#4C4C4C",l=e.sessionID||"",i=20,j=8000,m=37,n=71;var g=[{text:FR.i18nText("FR-Export_PDF"),value:"PDF"},{text:FR.i18nText("FR-Export_Excel"),value:"Excel"},{text:FR.i18nText("FR-Export_Word"),value:"Word"},{text:FR.i18nText("FR-Export_SVG"),value:"SVG"}];var k=21;
var d=FR.createWidget({type:"tablelayout",columnSize:[90,26,245],rowSize:[k,k,k,k,k,k,90,k],vgap:10,items:[[{el:{type:"label",color:p,value:FR.i18nText("FR-Basic-Email_From"),fontsize:h,verticalcenter:true,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:n},{region:"center",el:{type:"text",widgetName:"FROM",disabled:true,watermark:"loading data..."}}]}}],[{el:{type:"label",color:p,value:FR.i18nText("HJS-Mail_to"),fontsize:h,verticalcenter:true,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:n},{region:"center",el:{type:"combocheckbox",widgetName:"TO",directEdit:true,widgetUrl:FR.servletURL+"?op=fr_email&cmd=get_contacts_name&sessionID="+l,supportTag:true}}]}}],[{el:{type:"label",color:p,value:FR.i18nText("HJS-CC_to"),fontsize:h,verticalcenter:true,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:n},{region:"center",el:{type:"combocheckbox",widgetName:"CC",directEdit:true,widgetUrl:FR.servletURL+"?op=fr_email&cmd=get_contacts_name&sessionID="+l,supportTag:true}}]}}],[{el:{type:"label",color:p,value:FR.i18nText("HJS-BCC_to"),fontsize:h,verticalcenter:true,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:n},{region:"center",el:{type:"combocheckbox",widgetName:"BCC",directEdit:true,widgetUrl:FR.servletURL+"?op=fr_email&cmd=get_contacts_name&sessionID="+l,supportTag:true}}]}}],[{el:{type:"label",color:p,value:FR.i18nText("FR-Basic-Email_Format"),fontsize:h,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:n},{region:"center",el:{type:"combo",widgetName:"FORMAT",model:"local",directEdit:true,items:g}}]}}],[{el:{type:"label",color:p,value:FR.i18nText("FR-Basic-Email_Subject"),fontsize:h,verticalcenter:true,textalign:"right",fontfamily:f}},{el:$("<div>")},{el:{type:"border",items:[{region:"east",el:$("<div>"),width:m},{region:"center",el:{type:"text",widgetName:"SUBJECT"}}]}}],[{el:{type:"border",items:[{region:"north",height:k,el:{type:"label",color:p,value:FR.i18nText("FR-Basic-Email_Message"),fontsize:h,textalign:"right",fontfamily:f}},{region:"center",el:$("<div>")}]}},{el:$("<div>")},{el:{type:"textarea",widgetName:"MESSAGE",fontsize:h}}],[{el:$("<div>")},{el:$("<div>")},{el:{type:"checkbox",widgetName:"ISSHOWTPL",text:FR.i18nText("Email-Can_Preview_Report_Content")}}]]});
FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_dialog",cmd:"write_email_dialog",sessionID:l},complete:function(q,o){var r=d.getWidgetByName("FROM");r.removeWaterMark();if(o=="success"){r.setValue(q.responseText)}}});e.onOK=function(){FR.showLoadingDialog({title:FR.i18nText("FR-Basic_Email"),text:FR.i18nText("FR-Basic-Email_Sending")+"..."});FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_email",cmd:"deal_email",sessionID:l,FROM:d.getWidgetByName("FROM").getValue(),TO:d.getWidgetByName("TO").getValue(),SUBJECT:d.getWidgetByName("SUBJECT").getValue(),CC:d.getWidgetByName("CC").getValue(),BCC:d.getWidgetByName("BCC").getValue(),MESSAGE:d.getWidgetByName("MESSAGE").getValue(),FORMAT:d.getWidgetByName("FORMAT").getValue(),ISSHOWTPL:d.getWidgetByName("ISSHOWTPL").getValue()},complete:function(q,o){e.onFinish.apply();
if(o=="success"){var r=FR.jsonDecode(q.responseText);var s;if(r.status=="success"){s=FR.i18nText("FR-Basic_Email_Send_Success")}else{s=FR.i18nText("FR-Basic_Email_Send_Failed")+"\n"+FR.i18nText("FR-Basic_Email_Send_Error")}FR.hideLoadingDialog();FR.Msg.alert(FR.i18nText("FR-Basic_Email"),s,j)}}})};e.contentWidget={type:"border",items:[{region:"north",el:$("<div>"),height:i},{region:"center",el:d.element}]};FR.showUpdateDialog(e)},showUploadDialog:function(f){f.title=FR.i18nText("FR-Basic_File_Upload");
if(b==null){b=new FR.Dialog(f)}b.options=$.extend({url:"",el:this,allowTypes:"",err:"",callback:FR.emptyFn,autoUpload:false,beforeAction:FR.emptyFn,afterAction:FR.emptyFn},f);b.doResize({width:b.options.autoUpload?360:440,height:300});var d=$('<input type="file" name="file" size="35" style="width:320px"/>').change(function(){FR.autoSubmit(b.options,b.$form)});var e=$('<input type="button" value="'+FR.i18nText("FR-Basic_OK")+'" style="width:80px;margin-top:10px;"/>').click(function(){FR.autoSubmit(b.options,b.$form)
});if(b.options.autoUpload){b.$form=$('<form enctype="multipart/form-data" style="padding:10px"></form>').append(d)}else{b.$form=$('<form enctype="multipart/form-data" style="padding:10px"><input name="file" type="file" size="35" style="width:320px"/></form>').append(e)}b.setContent({type:"contentHtml",content:b.$form});b.setVisible(true)},preloadImgs:function(e){for(var d=0;d<e.length;d++){jQuery("<img>").attr("src",e[d])}},autoSubmit:function(g,f){var d=$("input:file",f);if(!d.val()){FR.Msg.toast(FR.i18nText("Function-The_selected_file_cannot_be_null")+"!");
return}else{if(g.allowTypes){var e=d.val().substring(d.val().lastIndexOf(".")+1);if(g.allowTypes&&g.allowTypes.indexOf(e)==-1){FR.Msg.toast(g.err?g.err:(e+FR.i18nText("FR-Basic_File_Not_Allow_To_Upload")+","+FR.i18nText("FR-Basic_File_Allow_To_Upload_Contains")+g.allowTypes));return false}}else{if(g.filter){if(d.val().toLowerCase().indexOf("."+g.filter)==-1){FR.Msg.toast(FR.i18nText("FR-Basic_File_Should_Select_Excel_File"));return}}}}FR.showLoadingDialog({width:310,height:80});if($.isFunction(g.beforeAction)){g.beforeAction()
}FR.domFormSubmit(f,{url:g.url,timeout:3000000},function(i,h){FR.hideLoadingDialog();if(b){b.setVisible(false)}if($.isFunction(g.callback)){g.callback(i,h,g.el)}if($.isFunction(g.afterAction)){g.afterAction()}})},__fileSizeFormat__:function(f){if(!f){return""}var e=0;var d=["B","KB","MB","GB","TB"];var g=f+d[e];while(f>1024&&e<d.length-1){f=f/1024;e++}g=f.toFixed(2)+d[e];return g}})})();$.extend(FR,{sentMail:function(a){FR.showLoadingDialog({title:FR.i18nText("FR-Basic_Email"),text:FR.i18nText("FR-Basic-Email_Sending")+"..."});
FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_email",cmd:"sent_email",sessionID:FR.SessionMgr.getSessionID(),mailXML:a.xmlconf,paraMap:a.paraMap||{}},complete:function(c,b){if(b=="success"){var d=FR.jsonDecode(c.responseText);var e;if(d.status=="success"){e=FR.i18nText("FR-Basic_Email_Send_Success")}else{e=FR.i18nText("FR-Basic_Email_Send_Failed")+"\n"+FR.i18nText("FR-Basic_Email_Send_Error")}FR.hideLoadingDialog();FR.Msg.alert(FR.i18nText("FR-Basic_Email"),e,8000)}}})},correctPNG:function(d){if(d instanceof $){d=d[0]
}var b=(d.id)?"id='"+d.id+"' ":"";var e=(d.className)?"class='"+d.className+"' ":"";var f=(d.title)?"title='"+d.title+"' ":"title='"+d.alt+"' ";var c="display:inline-block;"+d.style.cssText;if(d.align=="left"){c="float:left;"+c}if(d.align=="right"){c="float:right;"+c}if(d.parentElement.href){c="cursor:hand;"+c}var a="<span "+b+e+f+'style="'+"width:"+d.width+"px; height:"+d.height+"px;"+c+";"+"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader"+"(src='"+d.src+"', sizingMethod='scale');\"></span>";
d.outerHTML=a},open:function(a){var b="";var d=/[a-zA-z]+:\/\/[^\s]*/;var c=/\/[^\s]*/;if(a.match(d)||a.match(c)){b=a}else{b="http://"+a}window.open(b)},fixBoxModelWidth:function(a){if($.support.boxModel){return a.outerWidth()-a.width()}else{return 0}},fixBoxModelHeight:function(a){if($.support.boxModel){return a.outerHeight()-a.height()}else{return 0}},encrypt:function(f,e){if(f==""){return""}f=escape(f);if(!e||e==""){var e="655"}e=escape(e);if(e==null||e.length<=0){alert("Please enter a password with which to encrypt the message.");
return null}var k="";for(var i=0;i<e.length;i++){k+=e.charCodeAt(i).toString()}var g=Math.floor(k.length/5);var b=parseInt(k.charAt(g)+k.charAt(g*2)+k.charAt(g*3)+k.charAt(g*4)+k.charAt(g*5));var a=Math.ceil(e.length/2);var h=Math.pow(2,31)-1;if(b<2){alert("Algorithm cannot find a suitable hash. Please choose a different password. \nPossible considerations are to choose a more complex or longer password.");return null}var c=Math.round(Math.random()*1000000000)%100000000;k+=c;while(k.length>10){k=(parseInt(k.substring(0,10))+parseInt(k.substring(10,k.length),10)).toString()
}k=(b*k+a)%h;var d="";var j="";for(var i=0;i<f.length;i++){d=parseInt(f.charCodeAt(i)^Math.floor((k/h)*255));if(d<16){j+="0"+d.toString(16)}else{j+=d.toString(16)}k=(b*k+a)%h}c=c.toString(16);while(c.length<8){c="0"+c}j+=c;return j},decrypt:function(g,f){if(g==""){return""}if(!f||f==""){var f="655"}f=escape(f);if(g==null||g.length<8){return}if(f==null||f.length<=0){return}var l="";for(var j=0;j<f.length;j++){l+=f.charCodeAt(j).toString()}var h=Math.floor(l.length/5);var a=l.charAt(h)+l.charAt(h*2)+l.charAt(h*3)+l.charAt(h*4);
if(h*5<l.length){a+=l.charAt(h*5)}var c=parseInt(a);var b=Math.round(f.length/2);var i=Math.pow(2,31)-1;var d=parseInt(g.substring(g.length-8,g.length),16);g=g.substring(0,g.length-8);l+=d;while(l.length>10){l=(parseInt(l.substring(0,10),10)+parseInt(l.substring(10,l.length),10)).toString()}l=(c*l+b)%i;var e="";var k="";for(var j=0;j<g.length;j+=2){e=parseInt(parseInt(g.substring(j,j+2),16)^Math.floor((l/i)*255));k+=String.fromCharCode(e);l=(c*l+b)%i}return unescape(k)},clone:function(a){if($.isPlainObject(a)){return $.extend(true,{},a)
}return a}});$.extend(FR,{Keys:function(){var a=[];var b=true;$(document).keydown(function(d){if(b){if(a.length>0){var c=a[0];if($.isFunction(c)){c.call(window,d)}else{if($.isFunction(c.fn)){c.fn.call(c.scope||window,d)}}}}});return{reg:function(c){a.remove(c);a.unshift(c)},unreg:function(c){a.remove(c)},enable:function(c){if(typeof c=="boolean"){b=c}else{return b}}}}()});$.extend(FR,{HtmlLoader:function(){return{load:function(o){var cfg=$.extend({type:"GET",timeout:30000},o||{});cfg.callback=cfg.callback||FR.emptyFn;
var self=o.el;var animation=cfg.animation||this.loadingEffect;FR.ajax({url:cfg.url,type:cfg.type,async:cfg.params.async===false?false:true,dataType:"html",data:$.extend({_:new Date().getTime(),__boxModel__:$.support.boxModel},cfg.params),timeout:cfg.timeout,beforeSend:function(){animation.call(self,$.extend(o,{show:true}))},complete:function(res,status){var html=res.responseText;if(html==""||html.indexOf(FR.i18nText("FR-Server-All_Error")+FR.i18nText("FR-Engine_Page"))!=-1){window.needLoadMore=false
}var scripts=[];if(cfg.scripts===true){var hd=document.getElementsByTagName("head")[0];var re=/(?:<script([^>]*)?>)((?:\n|\r|.)*?)(?:<\/script>)/ig;var srcRe=/\ssrc=([\'\"])(.*?)\1/i;var typeRe=/\stype=([\'\"])(.*?)\1/i;var match;while(match=re.exec(html)){var attrs=match[1];var srcMatch=attrs?attrs.match(srcRe):false;if(srcMatch&&srcMatch[2]){var s=document.createElement("script");s.src=srcMatch[2];var typeMatch=attrs.match(typeRe);if(typeMatch&&typeMatch[2]){s.type=typeMatch[2]}hd.appendChild(s)
}else{if(match[2]&&match[2].length>0){scripts.push(match[2])}}}html=html.replace(/(?:<script([^>]*)?>)((?:\n|\r|.)*?)(?:<\/script>)/ig,"")}animation.call(self,$.extend(o,{show:false}));if(o.notReplaceBody){var iframeStart=html.indexOf("iframe");var start=html.indexOf("<body");if(start>-1&&iframeStart==-1){html=html.substr(start);start=html.indexOf(">");var end=html.indexOf("</body>");if(start>-1){html=html.substr(start+1,end-start-1)}}}if($.isFunction(cfg.loadHtml)){cfg.loadHtml.apply(self,[html])
}else{self.html(html)}$.each(scripts,function(i,n){if(window.execScript){window.execScript(n)}else{window.eval(n)}});self.each(cfg.callback,[res.responseText,status,res]);if(FR.Browser.isIE6()){setTimeout(function(){if(!$("div.pageContentDIV")[0]){return}var tr=$(".pageContentDIV tr").last();if(tr[0]&&!tr.height()&&!tr.is(":visible")){tr.show()}var tds=$(".pageContentDIV td");for(var i=0,len=tds.length;i<len;i++){var td=$(tds[i]);if(td.attr("rowspan")===1){td.attr("rowspan",1);break}}},25)}}});return this
},loadingMoreData:function(config){this.loading(config)},loading:function(conf){var config=$.extend({show:false,forceDisplay:false,cssConfig:null,loadingMoreData:false},conf||{});var el=config.el;var $indicator=el.data("indicator");if(!$indicator){$indicator=$("<div class='loading-indicator'>"+FR.i18nText("FR-Basic_Loading")+"</div>");var o=config.loadingMoreData?{position:"relative",width:"56px"}:{position:"absolute",left:0,top:0};if(config.cssConfig){$.extend(o,config.cssConfig)}$indicator.css(o);
el.data("indicator",$indicator)}if(!config.show){$indicator.detach()}else{if(config.show&&!$indicator.is(":visible")){$indicator.css("top",el.scrollTop());el.append($indicator)}}},loadingEffect:function(cfg){var el=cfg.el;var config=$.extend({show:false,overflow:false,fixed:true},cfg||{});var $indicator=el.data("indicator");if(!$indicator){$indicator=$("<div class='load-indicator'></div>");$("<div class='loading-ec-indicator'></div>").appendTo($indicator);$("<div class ='text-indicator' style='font-size:11pt'>"+FR.i18nText("FR-Basic_Loading")+"</div>").appendTo($indicator);
var o=cfg.fixed?{position:"fixed",margin:"auto",left:"0px",right:"0px",top:"0px",bottom:"0px",height:"64px",width:"64px"}:{position:"absolute",width:"64px",height:"64px",left:"50%",top:"50%"};$indicator.css(o);el.data("indicator",$indicator)}if(!config.show){$indicator.detach();el.css("overflow","auto");el.css("overflow",config.overflow||"auto")}else{if(config.show&&!$indicator.is(":visible")){el.append($indicator);el.css("overflow","hidden")}}}}}()});
(function($){$.extend($,{clearwatermarks:function(){$("[wmwrap='true']").find("input,textarea").watermark({remove:true})},addwatermarks:function(){$("[watermark]").each(function(num,el){$(el).watermark($(el).attr("watermark"))})},watermark:function(o){var defaultOffsetLeft=3;o.el=$(o.el);if(o.remove){if($.browser.msie){if(o.el.parent().attr("wmwrap")=="true"){o.el.parent().replaceWith(o.el)}}else{o.el.removeAttr("placeholder")}}else{if(o.clear){if($.browser.msie){if($("label.fr-watermark-label",o.el.parent())){$("label.fr-watermark-label",o.el.parent()).hide()
}}else{o.el.attr("placeholder","")}}else{if($.browser.msie){if(o.el.parent().attr("wmwrap")!="true"){o.el=o.el.wrap("<span wmwrap='true'/>");var l=$("<label/>").addClass("fr-watermark-label");if(o.html){l.html(o.html)}if(o.cls){l.addClass(o.cls)}if(o.css){l.css(o.css)}l.css({position:"absolute",left:defaultOffsetLeft+"px",top:"",display:"inline",cursor:"text",width:o.el.width(),height:o.el.height(),overflow:"hidden","font-size":"9pt","white-space":"nowrap"});if(o.isEditable){l.css("left",o.offsetLeft||defaultOffsetLeft)
}l.css("line-height",(o.el.height()+($.support.boxModel?4:0))+"px");if(!o.cls&&!o.css){l.css("color",l.getwatermarkcolor())}var focus=function(){l.hide()};var blur=function(){if(!o.el.val()){l.show()}else{l.hide()}};var click=function(){o.el.focus()};if(o.inherit){if(typeof o.inherit=="string"){l.css(o.inherit,o.el.css(o.inherit))}else{for(var x=0;x<o.inherit.length;x++){l.css(o.inherit[x],o.el.css(o.inherit[x]))}}}if(!o.el.attr("disabled")){o.el.focus(focus).blur(blur);o.el[0].onpropertychange=function(){if(!o.el.val()){l.show()
}else{l.hide()}};l.click(click)}o.el.before(l);if(o.el.val()){l.hide()}}}else{o.el.attr("placeholder",o.html);o.el.focus(function(){o.el.removeAttr("placeholder")}).blur(function(){o.el.attr("placeholder",o.html)})}}}return o.el}});$.fn.watermark=function(o,isEditable){var offestLeft=this.offset().left;return this.each(function(){if(typeof(o)=="string"){try{o=eval("("+o+")")}catch(ex){o={html:o}}if(typeof(o)=="number"){o={html:o}}}o.el=this;o.offsetLeft=offestLeft;o.isEditable=isEditable;return $.watermark(o)
})};$.fn.watermarkValueChange=function(){};$.fn.getwatermarkcolor=function(){return"rgb(204, 204, 204)"}})(jQuery);$().ready(function(){$.addwatermarks()});
(function($){var otherButton=[];var d=$("<div style='position:absolute;top:-1000px;width:100px;height:100px;padding:5px'></div>").appendTo("body");$._boxModel=parseInt(d.width())===100;d.remove();$.fn._outerWidth=function(el){if(el==undefined){if(this[0]==window){return this.width()||document.body.clientWidth}return this.outerWidth()||0}return this.each(function(){if($._boxModel){$(this).width(el-($(this).outerWidth()-$(this).width()))}else{$(this).width(el)}})};$.fn._outerHeight=function(el){if(el==undefined){if(this[0]==window){return this.height()||document.body.clientHeight
}return this.outerHeight()||0}return this.each(function(){if($._boxModel){$(this).height(el-($(this).outerHeight()-$(this).height()))}else{$(this).height(el)}})};FR.Panel=FR.extend(FR.Widget,{_defaultConfig:function(){return $.extend(FR.Panel.superclass._defaultConfig.apply(this,arguments),{baseCls:"fr-core-panel",titleHeight:25,headerBackground:null,borderRadius:false,fit:false,doSize:true,border:false,borderWidth:1,closable:false,maximizable:false,minimizable:false,collapsible:false,autoScroll:true,closed:false,animate:true,width:300,height:200,tools:null,style:null,onBeforeClose:null,onClose:null})
},_init:function(){var o=this.options;this.headerHeight=(!FR.isEmpty(o.title))?o.titleHeight:(o.miniExpand?8:0);if(typeof o.height=="number"){o.height+=(!FR.isEmpty(o.title))?o.titleHeight:0}FR.Panel.superclass._init.apply(this,arguments);var self=this;var defaultStyle="blue";$.each(["gray","green","blue"],function(i,item){if(o.style&&item==o.style.toLowerCase()){defaultStyle=o.style.toLowerCase()}});o.style=defaultStyle;this.element.addClass(o.baseCls);this._addContent();if((typeof o.height=="number"&&o.height>this.headerHeight)||typeof o.height!="number"){this._addHeader()
}this._addBorder();if(o.doSize===true){this.doResize({width:o.width,height:o.height})}if(o.closed===true){this.element.hide()}if(o.css){this.element.css(o.css)}this.on("_resize",function(){if(self.options._resize){self.options._resize()}})},_addContent:function(){var opts=this.options;var top=FR.isEmpty(opts.title)?0:opts.titleHeight;this.panelBody=$('<div class="fr-core-panel-body"></div>').css({position:"absolute",top:top,left:0}).appendTo(this.element);this.$contentPane=this._createContentPane();
this._loadContent(false)},_createContentPane:function(){if(this.options.autoScroll===false){this.panelBody.css({overflow:"hidden"})}return this.panelBody},_addBorder:function(){var o=this.options;if(o.border===true){if(this.$header){this.$header.removeClass("fr-core-panel-header-noborder")}this.borderFix4width=o.borderWidth*2;this.borderFix4height=o.borderWidth*2;this.panelBody.addClass("fr-core-panel-body-border").removeClass("fr-core-panel-body-noborder").css({borderWidth:o.borderWidth});if(!FR.isEmpty(o.title)){this.borderFix4height=o.borderWidth;
this.panelBody.css({borderTop:"none"})}}else{if(this.$header){this.$header.addClass("fr-core-panel-header-noborder")}this.panelBody.removeClass("fr-core-panel-body-border").addClass("fr-core-panel-body-noborder")}},_loadContent:function(forced){var opts=this.options;var ct=this.$contentPane;if(opts.contentUrl&&(!opts.isLoaded||forced===true)){opts.isLoaded=false;ct.html($('<div class="fr-core-panel-loading"></div>').html("loading..."));FR.ajax({url:opts.contentUrl,type:"POST",complete:function(res,status){var ht=res.responseText;
if($.isFunction(opts.callback)){opts.callback(ct,ht)}else{ct.html(ht)}opts.isLoaded=true}})}else{if(opts.contentWidget){if(opts.contentWidget.type){opts.contentWidget.style=opts.style;opts.contentWidget=FR.createWidget(opts.contentWidget)}$.extend(opts.resultWidgets,opts.contentWidget.options.resultWidgets);ct.append(opts.contentWidget.element)}else{if(opts.contentHtml){ct.html(opts.contentHtml);if(typeof opts.contentHtml==="object"){var newEl=$(opts.contentHtml)[0];if(newEl.tagName=="IFRAME"){var topHeight=FR.isEmpty(opts.title)?0:opts.titleHeight;
var loadTop=topHeight-opts.height;var $loading=$('<div class="fr-core-panel-loading" style="position: relative"></div>').css({width:opts.width,height:30,top:loadTop}).html(FR.i18nText("FR-Basic_Loading")+"...");if(!opts.noLoading){ct.append($loading)}if(newEl.attachEvent){newEl.attachEvent("onload",function(){$loading.remove()})}else{newEl.onload=function(){$loading.remove()}}}}}else{if(opts.contentText){ct.text(opts.contentText)}}}}},_addHeader:function(){var self=this;var opts=this.options;if(!FR.isEmpty(opts.title)){this.$header=$('<div class="fr-core-panel-header"></div>').addClass("fr-core-panel-style-"+opts.style).css({position:"absolute",top:0,left:0}).appendTo(this.element);
if(!opts.borderRadius){this.$header.css({borderRadius:0})}if(opts.headerBackground){this.$header.css({background:opts.headerBackground})}var fix=$.support.boxModel?2:0;this.$innerHeader=$('<div class="fr-core-panel-header-inner"></div>').css({position:"absolute",top:0,left:0}).appendTo(this.$header);this.$titleText=$("<div></div>").text(opts.title).addClass("fr-core-panel-title").appendTo(this.$innerHeader);this.rightDistance=7;if(opts.closable){$('<div class="fr-core-panel-tool-close"></div>').css({position:"absolute",top:0,right:this.rightDistance,width:25,height:opts.titleHeight-fix}).mouseout(function(){$(this).removeClass("fr-core-panel-tool-close-hover").removeClass("fr-core-panel-tool-close-down").removeClass("fr-core-panel-tool-over").addClass("fr-core-panel-tool-close")
}).mousedown(function(e){$(this).removeClass("fr-core-panel-tool-close-hover").addClass("fr-core-panel-tool-close-down")}).mouseover(function(){$(this).removeClass("fr-core-panel-tool-close").addClass("fr-core-panel-tool-over").addClass("fr-core-panel-tool-close-hover")}).bind("click",function(){self.doClose()}).appendTo(this.$innerHeader);this.rightDistance+=24}if(opts.tools){for(var i=opts.tools.length-1;i>=0;i--){var item=opts.tools[i];var itemWidth=item.width||24,itemHeight=item.height||opts.titleHeight-fix;
var t=$("<div></div>").css({position:"absolute",top:0,width:itemWidth,height:itemHeight,lineHeight:itemHeight+"px"}).addClass(item.iconCls).hover(function(){$(this).addClass("fr-core-panel-tool-over");$(this).addClass(item.iconCls+"-over")},function(){$(this).removeClass("fr-core-panel-tool-over");$(this).removeClass(item.iconCls+"-over")}).mousedown(function(){$(this).addClass(item.iconCls+"-click")}).mouseleave(function(){$(this).removeClass(item.iconCls+"-over");$(this).removeClass(item.iconCls+"-click")
}).mouseup(function(){$(this).removeClass(item.iconCls+"-click")}).appendTo(this.$innerHeader);item.el=t;item.width=itemWidth;if(item.invisible){t.hide()}if(item.handler){if($.isFunction(item.handler)){t.bind("click",item.handler.createDelegate(t))}else{if(typeof(item.handler)==="object"){if($.isFunction(item.handler.mousedown)){t.mousedown(item.handler.mousedown.createDelegate(t))}if($.isFunction(item.handler.mouseleave)){t.mouseleave(item.handler.mouseleave.createDelegate(t))}if($.isFunction(item.handler.mouseup)){t.mouseup(item.handler.mouseup.createDelegate(t))
}}else{t.bind("click",eval(item.handler))}}}if($.isArray(item.hover)&&item.hover.length>1){t.hover(item.hover[0].createDelegate(t),item.hover[1].createDelegate(t))}if(item.text){t.text(item.text)}if(item.styleText){FR.applyStyles(t,item.styleText)}}this._modifyToolsPosition()}this.panelBody.removeClass("fr-core-panel-body-noheader")}else{if(opts.miniExpand){var header=$("<div class='parameter-container-collapse'></div>").appendTo(self.element);header.css({position:"absolute",top:opts.height-8,left:0,"width":"100%","height":"8px","background":"none repeat scroll 0 0 #EEEEEE"});
var collapseImagWrapper=$("<div/>").css({width:"112px",height:"8px","margin-left":"auto","margin-right":"auto","position":"relative"}).appendTo(header);var collapseImag=$("<div class='parameter-container-collapseimg-up'/>").appendTo(collapseImagWrapper).click(eval(opts.miniExpand.handler))}else{this.panelBody.addClass("fr-core-panel-body-noheader")}}},setTitle:function(title){if(this.$innerHeader){this.$innerHeader.find(">div.fr-core-panel-title").html(title)}},setToolVisible:function(index,visible){var opts=this.options;
var ct=opts.tools[index];if(ct&&ct.el&&ct.el.isVisible()!=visible){visible?ct.el.show():ct.el.hide();this._modifyToolsPosition()}},_modifyToolsPosition:function(){var rd=this.rightDistance,opts=this.options;for(var i=opts.tools.length-1;i>=0;i--){var item=opts.tools[i];if(item.el&&item.el.isVisible()){item.el.css({right:rd});rd+=item.width}}},doOpen:function(){this.element.show();this.options.closed=false;if($.isFunction(this.options.onOpen)){this.options.onOpen.call(this)}},doClose:function(){var self=this;
this.element.hide(self.options.animate?"fast":0,function(){if($.isFunction(self.options.onBeforeClose)){self.options.onBeforeClose.call(self)}self.options.closed=true;if($.isFunction(self.options.onClose)){self.options.onClose.call(self)}})},doMove:function(give){var opts=this.options;if(give){if(give.left!=null){opts.left=give.left}if(give.top!=null){opts.top=give.top}}this.element.css({left:opts.left,top:opts.top});if($.isFunction(opts.onMove)){opts.onMove.apply(this,[opts.left,opts.top])}},enable:function(){if(this.mask){this.mask.hide()
}},disable:function(){if(!this.mask){this.mask=$("<div/>").addClass("fr-core-window-mask").appendTo(this.element);this.mask.css({zIndex:FR.widget.opts.zIndex++,width:this.element.width()?this.element.width():this.options.width,height:this.element.height()?this.element.height():this.options.height,background:"gray"})}this.mask.show()},doResize:function(give){var opts=this.options;var self=this;if(give){if(give.width){opts.width=give.width}if(give.height){opts.height=give.height}if(give.left!=null){opts.left=give.left
}if(give.top!=null){opts.top=give.top}}if(opts.fit===true){var p=this.element.parent();opts.width=p.width();opts.height=p.height()}this.element.css({left:opts.left,top:opts.top});if(opts.cls){this.element.addClass(opts.cls)}if(this.$header&&opts.headerCls){this.$header.addClass(opts.headerCls)}if(opts.bodyCls){this.panelBody.addClass(opts.bodyCls)}if(!isNaN(opts.width)){if($.support.boxModel===true){var panelWidth=opts.width-(this.element.outerWidth()-this.element.width());this.element.width(panelWidth);
if(!FR.isEmpty(opts.title)&&this.$header){this.$header.width(panelWidth-(this.$header.outerWidth()-this.$header.width()));this.$innerHeader.width(panelWidth-(this.$header.outerWidth()-this.$header.width()))}this.panelBody.width(panelWidth-(this.panelBody.outerWidth()-this.panelBody.width()))}else{this.element.width(opts.width);if(!FR.isEmpty(opts.title)&&this.$header){this.$header.width(opts.width);this.$innerHeader.width(opts.width)}this.panelBody.width(opts.width-this.borderFix4width)}}else{this.element.width("auto");
this.panelBody.width("auto")}if(!isNaN(opts.height)){if($.support.boxModel===true){var panelHeight=opts.height-(this.element.outerHeight()-this.element.height());this.element.height(panelHeight);if(!FR.isEmpty(opts.title)&&this.$header){this.$header.height(this.headerHeight-(this.$header.outerHeight()-this.$header.height()));this.$innerHeader.height(this.headerHeight-(this.$header.outerHeight()-this.$header.height()));this.$titleText.css({lineHeight:this.headerHeight-(this.$header.outerHeight()-this.$header.height())+"px"})
}this.panelBody.height(panelHeight-this.headerHeight-(this.panelBody.outerHeight()-this.panelBody.height()))}else{this.element.height(opts.height);if(!FR.isEmpty(opts.title)&&this.$header){this.$header.height(this.headerHeight);this.$innerHeader.height(this.headerHeight);this.$titleText.css({lineHeight:this.headerHeight+"px"})}this.panelBody.height(opts.height-this.headerHeight-this.borderFix4height)}}else{this.element.height("auto");this.$contentPane.height("auto")}if($.isFunction(opts.onResize)){opts.onResize.apply(this,[opts.width,opts.height])
}this._resizeContentWidget();this.fireEvent(FR.Events.RESIZE);this.element.doLayout()},_resizeContentWidget:function(){var opts=this.options;var pbodystylestring=this.$contentPane.attr("style");var pbodyheight=parseInt(pbodystylestring.replace(/.*height\:\s*(\d+).*/gi,"$1"));var pbodywidth=parseInt(pbodystylestring.replace(/.* width\:\s*(\d+).*/gi,"$1"));if(opts.contentWidget){opts.contentWidget.doResize({width:this.$contentPane.width(),height:pbodyheight})}else{if(opts.contentHtml&&FR.Browser.isIE6()){$(opts.contentHtml).css({width:pbodywidth,height:pbodyheight})
}}}});$.shortcut("panel",FR.Panel);FR.ConfirmPane=FR.extend(FR.Panel,{_defaultConfig:function(){return $.extend(FR.ConfirmPane.superclass._defaultConfig.apply(this,arguments),{text4OK:FR.i18nText("FR-Basic_OK"),text4Cancel:FR.i18nText("FR-Basic_Cancel"),width4OK:80,width4Cancel:80,height4OK:28,height4Cancel:28,controlPaneHeight:40,btnsGap:20,firstBtnMargin:20,needSeparate:false,btnsAlignment:"right",closeAfterAction:true,onOK:null,onCancel:null})},_init:function(){FR.ConfirmPane.superclass._init.apply(this,arguments)
},_createContentPane:function(){var opts=this.options;var $contentPane=$('<div class="fr-core-panel-content">').css({position:"absolute",top:0,left:0}).appendTo(this.panelBody);var self=this;this.okdiv=$('<div style="position:absolute"/>').appendTo(this.panelBody);this.canceldiv=$('<div style="position:absolute"/>').appendTo(this.panelBody);if(!FR.isEmpty(opts.text4OK)){self.okButton=new FR.createWidget({type:"quickbutton",text:opts.text4OK,width:opts.width4OK,height:opts.height4OK,style:opts.style,handler:function(){if($.isFunction(self.options.onOK)){var result=self.options.onOK.apply(self);
if(result===false){return}}if(self.options.closeAfterAction){self.doClose()}}});this.okButton.element.appendTo(this.okdiv);this.okdiv.css({width:opts.width4OK,height:opts.height4OK})}if(!FR.isEmpty(opts.text4Cancel)){self.cancelButton=new FR.createWidget({type:"quickbutton",text:opts.text4Cancel,width:opts.width4Cancel,height:opts.height4Cancel,handler:function(){if($.isFunction(self.options.onCancel)){self.options.onCancel.apply(self)}if(self.options.closeAfterAction){self.doClose()}}});this.cancelButton.element.appendTo(this.canceldiv);
this.canceldiv.css({width:opts.width4Cancel,height:opts.height4Cancel})}if(opts.needSeparate){$contentPane.addClass("fr-core-panel-content-separate");this.okdiv&&this.okdiv.css("margin-top",opts.needSeparate+"px");this.canceldiv&&this.canceldiv.css("margin-top",opts.needSeparate+"px")}return $contentPane},doResize:function(give){FR.ConfirmPane.superclass.doResize.apply(this,arguments);var opts=this.options;var alignment=opts.btnsAlignment;var oktop=0,canceltop=0,okalign=0,cancelalign=0;var height=opts.height;
if(opts.needSeparate){height=height-opts.needSeparate}if(!isNaN(height)){if($.support.boxModel===true){this.$contentPane.css({height:height-this.headerHeight-opts.controlPaneHeight-(this.$contentPane.outerHeight()-this.$contentPane.height()),width:opts.width-(this.panelBody.outerWidth()-this.panelBody.width())})}else{this.$contentPane.css({height:height-this.headerHeight-opts.controlPaneHeight,width:opts.width})}}oktop=height-this.headerHeight-opts.controlPaneHeight;canceltop=height-this.headerHeight-opts.controlPaneHeight;
if(alignment=="right"){okalign=opts.width4Cancel+opts.firstBtnMargin+opts.btnsGap;cancelalign=opts.firstBtnMargin}else{if(alignment=="left"){okalign=opts.firstBtnMargin;cancelalign=opts.width4OK+opts.firstBtnMargin+opts.btnsGap}else{var allWidth=opts.width4OK+opts.width4Cancel+opts.btnsGap;var Left=(opts.width-allWidth)/2;okalign=Left;cancelalign=Left+opts.width4OK+opts.btnsGap;alignment="left"}}if(this.okButton){this.okdiv.css("top",oktop);this.okdiv.css(alignment,okalign)}if(this.cancelButton){this.canceldiv.css("top",canceltop);
this.canceldiv.css(alignment,cancelalign)}this._resizeContentWidget()},loading:function(isFetching){this.okButton.setEnable(!isFetching)}});$.shortcut("confirm",FR.ConfirmPane);FR.ButtonPane=FR.extend(FR.Panel,{_defaultConfig:function(){return $.extend(FR.ButtonPane.superclass._defaultConfig.apply(this,arguments),{text4Cancel:FR.i18nText("FR-Basic_Cancel"),width4Cancel:80,button4Other:[],controlPaneHeight:40,btnsAlignment:"right",closeAfterAction:true})},_init:function(){FR.ButtonPane.superclass._init.apply(this,arguments)
},_createContentPane:function(){var opts=this.options;var $contentPane=$('<div class="fr-core-panel-content">').css({position:"absolute",top:0,left:0}).appendTo(this.panelBody);var other=opts.button4Other;this.otherButton=[];this.otherButtonWrap=[];for(var i=0;i<other.length;i++){this.otherButtonWrap[i]=$('<div style="position:absolute"/>').appendTo(this.panelBody);this.otherButton[i]=new FR.createWidget({type:"quickbutton",text:other[i].bT,width:other[i].bW?other[i].bW:80,baseCls:other[i].baseCls?other[i].baseCls:"",invisible:other[i].invisible,style:opts.style,handler:function(){var onAct=this.element.data("func");
if($.isFunction(onAct)){onAct.apply(self)}var aftAct=this.element.data("aftfunc");if(aftAct){self.doClose()}}});this.otherButton[i].element.appendTo(this.otherButtonWrap[i]);this.otherButtonWrap[i].css({width:other[i].bW,height:opts.height4Cancel});this.otherButton[i].element.data("func",other[i].bF?other[i].bF:FR.emptyFn());this.otherButton[i].element.data("aftfunc",other[i].bC?other[i].bC:false)}var self=this;this.canceldiv=$('<div style="position:absolute"/>').appendTo(this.panelBody);this.cancelButton=new FR.createWidget({type:"quickbutton",text:opts.text4Cancel,width:opts.width4Cancel,height:opts.height4Cancel,handler:function(){if($.isFunction(self.options.onCancel)){self.options.onCancel.apply(self)
}if(self.options.closeAfterAction){self.doClose()}}});this.cancelButton.element.appendTo(this.canceldiv);this.canceldiv.css({width:opts.width4Cancel,height:opts.height4Cancel});if(opts.needSeparate){$contentPane.addClass("fr-core-panel-content-separate");this.canceldiv&&this.canceldiv.css("margin-top",opts.needSeparate+"px");for(var i=0;i<this.otherButtonWrap.length;i++){this.otherButtonWrap[i]&&this.otherButtonWrap[i].css("margin-top",opts.needSeparate+"px")}}return $contentPane},doResize:function(give){FR.ButtonPane.superclass.doResize.apply(this,arguments);
var opts=this.options;var other=opts.button4Other;var alignment=opts.btnsAlignment;var canceltop=0,cancelalign=0;var height=opts.height;if(opts.needSeparate){height=height-opts.needSeparate}if(!isNaN(height)){if($.support.boxModel===true){this.$contentPane.css({height:height-this.headerHeight-opts.controlPaneHeight-(this.$contentPane.outerHeight()-this.$contentPane.height()),width:opts.width-(this.panelBody.outerWidth()-this.panelBody.width())})}else{this.$contentPane.css({height:height-this.headerHeight-opts.controlPaneHeight,width:opts.width})
}}canceltop=height-this.headerHeight-opts.controlPaneHeight;var alignment=opts.btnsAlignment;if(alignment=="right"){var right=opts.width4Cancel+40;this.canceldiv.css(alignment,20);this.canceldiv.css("top",canceltop);for(var i=0;i<other.length;i++){this.otherButtonWrap[i].css(alignment,right);this.otherButtonWrap[i].css("top",canceltop);right=right+other[i].bW+20}}else{if(alignment=="left"){var left=opts.width4Cancel+40;this.canceldiv.css(alignment,20);this.canceldiv.css("top",canceltop);for(var i=0;
i<other.length;i++){this.otherButtonWrap[i].css(alignment,left);this.otherButtonWrap[i].css("top",canceltop);left=left+other[i].bW+20}}else{var allWidth=0;for(var i=0;i<other.length;i++){allWidth=allWidth+other[i].bW+20}allWidth=allWidth+opts.width4Cancel;var otherLeft=(opts.width-allWidth)/2;for(var i=0;i<other.length;i++){this.otherButtonWrap[i].css("left",otherLeft);this.otherButtonWrap[i].css("top",canceltop);otherLeft=otherLeft+other[i].bW+20}this.cancelButton.element.css("left",otherLeft)}}this._resizeContentWidget()
}});$.shortcut("otherbutton",FR.ButtonPane);FR.Window=FR.extend(FR.Widget,{_defaultConfig:function(){return $.extend(FR.Window.superclass._defaultConfig.apply(),{baseCls:"fr-core-window",title:"Window",titleHeight:30,modal:true,confirm:false,otherButton:false,closable:true,collapsible:false,closed:true,destroyOnClose:false,width:300,height:200,resizeable:true,draggable:true})},_init:function(){FR.Window.superclass._init.apply(this,arguments);var o=this.options;var win=this.win;if(!$.support.boxModel){win.doResize({width:o.width,height:o.height})
}var self=this;if(this.mask){this.mask.remove()}if(o.modal===true){this.mask=$('<div class="fr-core-window-mask"></div>').appendTo("body");this.mask.css({zIndex:FR.widget.opts.zIndex++,width:this._getPageArea().width,height:this._getPageArea().height,display:"none"});$(window).resize(function(){self.mask.css({width:self._getPageArea().width,height:self._getPageArea().height})})}this.element.css({zIndex:FR.widget.opts.zIndex++});if(win.options.left==null){var width=win.options.width;if(isNaN(width)){width=this.element.outerWidth()
}var l=$(window).width();if(FR.Browser.isIE8Before()){l=FR.windowWidth}win.options.left=(l-width)/2+$(document).scrollLeft()}if(win.options.top==null){var height=win.options.height;if(isNaN(height)){height=this.element.outerHeight()}var h=$(window).height();if(FR.Browser.isIE8Before()){h=FR.windowHeight}win.options.top=(h-height)/2+$(document).scrollTop()}win.doMove();this.setVisible(!o.closed);if(this.options.draggable){this.element.draggable({handle:">div.fr-core-panel-header",onStartDrag:function(e){if(self.mask){self.mask.css("z-index",FR.widget.opts.zIndex.zIndex++)
}if(self.shadow){self.shadow.css("z-index",FR.widget.opts.zIndex.zIndex++)}self.element.css("z-index",FR.widget.opts.zIndex.zIndex++);var $contentDiv=$(self.element.children()[0]);$contentDiv.css("z-index",0);var top=$contentDiv.css("top");var height=$contentDiv.css("height");var width=$contentDiv.css("width");var transparentMask=$("#transparent-background");if(transparentMask.length>0){transparentMask.remove()}var $transparentDiv=$('<div id="transparent-background" style="position:absolute;filter:alpha(opacity=50);opacity:0.5;"></div>');
$transparentDiv.css("left","0px").css("top",top).css("width",width).css("height",height);$transparentDiv.css("z-index",1);self.element.append($transparentDiv);if(!self.proxy){self.proxy=$('<div class="fr-core-window-proxy"></div>').insertAfter(self.element)}self.proxy.css({display:"none",zIndex:FR.widget.opts.zIndex.zIndex++,left:e.data.left,top:e.data.top});self.proxy._outerWidth(self.element._outerWidth());self.proxy._outerHeight(self.element._outerHeight());setTimeout(function(){if(self.proxy){self.proxy.show()
}},500)},onDrag:function(e){var pluginLimit=FR.Window.PluginDialogLimit;if(pluginLimit){e.data.top=pluginLimit.onDrag.pluginTopFn(e.data.top,self.element._outerHeight(),self._getPageArea().height);e.data.left=pluginLimit.onDrag.pluginLeftFn(e.data.left,self.element._outerWidth(),self._getPageArea().width)}self.proxy.css({display:"block",left:e.data.left,top:e.data.top});return false},onStopDrag:function(e){$("#transparent-background").remove();self.proxy.remove();self.proxy=null}})}if(this.options.resizeable){this.element.resizable({onStartResize:function(e){if(!self.pmask){self.pmask=$('<div class="fr-core-window-proxy-mask"></div>').insertAfter(self.element)
}self.pmask.css({zIndex:FR.widget.opts.zIndex++,left:e.data.left,top:e.data.top,width:self.element._outerWidth(),height:self.element._outerHeight()});if(!self.proxy){self.proxy=$('<div class="fr-core-window-proxy"></div>').insertAfter(self.element)}self.proxy.css({zIndex:FR.widget.opts.zIndex++,left:e.data.left,top:e.data.top});self.proxy._outerWidth(e.data.width);self.proxy._outerHeight(e.data.height)},onResize:function(e){if(!self.proxy){return}self.proxy.css({left:e.data.left,top:e.data.top});
self.proxy._outerWidth(e.data.width);self.proxy._outerHeight(e.data.height);return false},onStopResize:function(e){var pluginLimit=FR.Window.PluginDialogLimit;if(pluginLimit){e.data.height=pluginLimit.onResize.pluginHeightFn(e.data.top,self.element._outerHeight(),self._getPageArea().height);e.data.width=pluginLimit.onResize.pluginWidthFn(e.data.left,self.element._outerWidth(),self._getPageArea().width);e.data.top=pluginLimit.onResize.pluginTopFn(e.data.top,self.element._outerHeight(),self._getPageArea().height);
e.data.left=pluginLimit.onResize.pluginLeftFn(e.data.left,self.element._outerWidth(),self._getPageArea().width)}$.extend(self.options,{left:e.data.left,top:e.data.top,width:e.data.width,height:e.data.height});self.doResize({top:self.options.top,left:self.options.left,width:self.options.width,height:self.options.height});self.pmask.remove();self.pmask=null;if(self.proxy){self.proxy.remove();self.proxy=null}}})}},_defaultRoot:function(){var o=this.options,override=o.override;if(FR.Browser.isIE()&&!FR.Browser.r.quirks){o.baseCls+=" fr-core-window-no-hack"
}var self=this;var panelType;if(o.confirm){panelType="confirm"}else{if(o.otherButton){panelType="otherbutton"}else{panelType="panel"}}var winOpts=$.extend({},o,{type:panelType,height:o.height-o.titleHeight,fit:false,renderEl:$("<div/>").appendTo("body"),doSize:true,border:true,borderRadius:"auto",cls:o.baseCls,headerCls:"fr-core-window-header",bodyCls:"fr-core-window-body",onClose:function(){if(self.mask){self.mask.hide()}if(o.destroyOnClose){self.destroy()}},onOpen:function(){if(self.mask){self.mask.show()
}},onResize:function(width,heigh){if($.isFunction(o.onDialogResize)){o.onDialogResize()}},onMove:function(left,top){}},override);this.win=FR.createWidget(winOpts);return this.win.element},_getPageArea:function(){if(document.compatMode=="BackCompat"){return{width:Math.max(document.body.scrollWidth,document.body.clientWidth),height:Math.max(document.body.scrollHeight,document.body.clientHeight)}}else{return{width:Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth),height:Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)}
}},doClose:function(){this.win.doClose()},doResize:function(give){this.win.doResize(give)},setTitle:function(title){this.win.setTitle(title)},setContent:function(c){this.win.options[c.type]=c.content;this.win._loadContent(true);if(FR.Browser.isIE8Before()){var self=this;setTimeout(function(){self.doResize({"width":undefined,"height":undefined})},150)}},setVisible:function(flag){if(flag===true&&this.win.options.closed===true){this.win.doOpen()}else{if(flag===false&&this.win.options.closed===false){this.win.doClose()
}}},destroy:function(){this.element.remove();this.mask.remove()},loading:function(isFetching){this.win.loading(isFetching)}});$.shortcut("window",FR.Window);FR.Dialog=FR.extend(FR.Window,{});$.shortcut("dialog",FR.Dialog)})(jQuery);
(function(a){FR.QuickList=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.QuickList.superclass._defaultConfig.apply(this,arguments),{baseCls:"fr-core-list",width:200,height:400,itemHeight:24,items:[],listItems:[],itemCanBeSelect:false,tools:null,index:0,alwaysShowTools:true,onItemToolClick:null,onItemSelect:null,async:null,dataFilter:null,valueField:"value",showField:"text",onBeforeItemCreate:null,scrollLoading:false,max:200})},_init:function(){FR.QuickList.superclass._init.apply(this,arguments);
var c=this.options;var b=this;this.element.css({width:c.width,height:c.height}).scroll(function(){b._onScroll(this)});if(c.async){this._addItemsByAjax()}else{this._addItemsByDefault()}},_addItemsByAjax:function(){var d=this.options,b=this;var c=d.async;var e=a('<div class="fr-core-panel-loading"></div>').css({width:100,height:30}).html(FR.i18nText("FR-Engine_Loading")+"...");this.element.append(e);FR.ajax({url:c.url,data:c.data,type:c.type?c.type:"POST",complete:function(h,f){if(f=="success"){e.remove();
var g=FR.jsonDecode(h.responseText);if(a.isArray(g)){d.items=g;if(!d.index){d.index=0}if(d.index<d.items.length&&d.items.length>d.max){d.need2Scroll=true}b._addItemsByDefault()}FR.applyFunc(b,d.onAsyncSuccess,[g],false)}}})},_onScroll:function(b){var c=this.options;if(!c.scrollLoading){return}if(c.need2Scroll&&a(b).scrollTop()+a(b).height()>=b.scrollHeight){if(c.isLoadingData){return}c.isLoadingData=true;this._addItemsByDefault();c.isLoadingData=false}},_addItemsByDefault:function(){var d=this.options;
if(!d.scrollLoading){d.max=d.items.length}if(d.items&&d.items.length>0){for(var b=d.index;b<d.index+d.max;b++){if(b>=d.items.length){d.need2Scroll=false;d.index=d.items.length;return false}var c=FR.applyFunc(this,d.dataFilter,[d.items[b]],d.items[b]);this.addItem(c)}d.index=d.index+d.max}},addItem:function(c,f){var b=this;var e=this.options;a.extend(c,{height:e.itemHeight,tools:e.tools,alwaysShowTools:e.alwaysShowTools,onItemToolClick:e.onItemToolClick,beforeSelect:e.beforeSelect,itemCanBeSelect:e.itemCanBeSelect,onCustomItemSelect:e.onCustomItemSelect,tooltype:e.tooltype,toolUnEditAble:e.toolUnEditAble,paddingRight:e.paddingRight,toolMargin:e.toolMargin,valueField:e.valueField,showField:e.showField,paddingLeft:e.paddingLeft,onBeforeItemCreate:e.onBeforeItemCreate,onItemSelect:function(){for(var g=0;
g<e.listItems.length;g++){var h=e.listItems[g];if(h!=this){h.doUnselect()}else{b.selectedIndex=g;if(a.isFunction(e.onItemSelect)){e.onItemSelect.apply(h)}}}},onToolClick:function(){for(var g=0;g<e.listItems.length;g++){var h=e.listItems[g];if(h===this){return g}}}});var d=new FR.ListItem(c);if(f){e.listItems.unshift(d);this.element.prepend(d.element)}else{e.listItems.push(d);this.element.append(d.element)}},refresh:function(b){var c=this.options;this.clear();if(b&&b.async){c.async=b.async;this._addItemsByAjax()
}else{if(c.async){this._addItemsByAjax()}}},clear:function(){this.element.empty();this.options.items=[];this.options.listItems=[];this.options.index=0;this.options.need2Scroll=false},remove:function(b){var c=this.options.listItems[b];this.options.listItems.remove(c);a(this.element.children()[b]).remove()},showToolByIndex:function(b){this.element.find("div[toolid="+b+"]").show();this.options.tools[b].invisible=false},hideToolByIndex:function(b){this.element.find("div[toolid="+b+"]").hide();this.options.tools[b].invisible=true
},getValueAtIndex:function(b){return this.options.listItems[b].getValue()},getTextAtIndex:function(b){return this.options.listItems[b].getText()},setTextAtIndex:function(b,c){return this.options.listItems[b].setText(c)},getValue:function(){if(this.options.tooltype==="check"){var b=[];for(var c=0;c<this.options.listItems.length;c++){b.push(this.options.listItems[c].getValue())}return b}if(!this.options.listItems[this.selectedIndex]){return null}return this.options.listItems[this.selectedIndex].getValue()
},getText:function(){if(this.options.tooltype==="check"){var b=[];for(var c=0;c<this.options.listItems.length;c++){b.push(this.options.listItems[c].getText())}return b}if(!this.options.listItems[this.selectedIndex]){return null}return this.options.listItems[this.selectedIndex].getText()},getAllItemText:function(){var b=[];for(var c=0;c<this.options.listItems.length;c++){b.push(this.options.listItems[c].getText())}return b},getItemLength:function(){return this.options.listItems.length},selectItemByIndex:function(b,c){this.options.listItems[b].doSelect(0,c);
this.selectedIndex=b;this.scrollToIndex(b)},getSelectedIndex:function(){return this.selectedIndex},removeSelect:function(){if(this.selectedIndex>=0){this.options.listItems[this.selectedIndex].doUnselect(0)}},clearState:function(){if(this.options.tooltype==="check"){var b=this.options.listItems;for(var c=0;c<b.length;c++){for(var d=0;d<this.options.tools.length;d++){b[c].doUnselect(d)}}}},setValue:function(c){for(var b=0;b<this.options.listItems.length;b++){var d=this.options.listItems[b];if(d.getValue()===c){d.doSelect();
this.selectedIndex=b;this.scrollToIndex(b)}else{d.doUnselect()}}},scrollToIndex:function(b){var d=this.element.height();var c=this.options.itemHeight*(b+1)-d;if(c>0){this.element.scrollTop(c)}else{this.element.scrollTop(0)}},setSelectedText:function(b){this.options.listItems[this.selectedIndex].setText(b)},getItemById:function(d){var c=this.options.listItems;for(var b=0;b<c.length;b++){if(c[b].options.id===d){return c[b]}}},selectByData:function(e){var c=this.options.listItems;for(var d=0;d<e.length;
d++){for(var b=0;b<c.length;b++){if(c[b].options.id===e[d].id){for(var f=0;f<this.options.tools.length;f++){if(e[d][this.options.tools[f].name]&&e[d][this.options.tools[f].name]!==0){c[b].doSelect(f)}}}}}},selectByText:function(e){var c=this.options.listItems;for(var d=0;d<e.length;d++){for(var b=0;b<c.length;b++){if(c[b].options.text===e[d].text){for(var f=0;f<this.options.tools.length;f++){if(e[d][this.options.tools[f].name]&&e[d][this.options.tools[f].name]!==0){c[b].doSelect(f)}}}}}},hasNodeSelect:function(d){var c=this.options.listItems;
for(var b=0;b<c.length;b++){var e=c[b];if(e.options[e.toolName[d]]===1){return true}}return false},selectAll:function(d){var c=this.options.listItems;for(var b=0;b<c.length;b++){c[b].onToolDivClick(c[b].toolDivs[d],new a.Event(),true)}},deSelectAll:function(d){var c=this.options.listItems;for(var b=0;b<c.length;b++){c[b].onToolDivClick(c[b].toolDivs[d],new a.Event(),false)}}});a.shortcut("quicklist",FR.QuickList);FR.ListItem=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.ListItem.superclass._defaultConfig.apply(this,arguments),{baseCls:"fr-core-list-item",paddingLeft:12,paddingRight:1,showField:"text",valueField:"value",onItemSelect:null,onBeforeItemCreate:null})
},_init:function(){FR.ListItem.superclass._init.apply(this,arguments);var b=this.options,l=this;FR.applyFunc(this,b.onBeforeItemCreate,[this.element,b],false);var c=b[b.showField];this.$text=a("<span/>").text(c).css({height:b.height,lineHeight:b.height+"px","padding-left":b.paddingLeft}).attr("title",c).appendTo(this.element);this.toolDivs=[];this.toolName=[];if(b.tools&&b.tools.length>0){var k=b.paddingRight;for(var d=0,g=b.tools.length;d<g;d++){var f=b.tools[d];this.toolName.push(f.name);var h=a("<div>").data("tool",f).data("index",d).css({position:"absolute",right:k,top:0,width:f.width||b.height,height:b.height,lineHeight:b.height+"px"}).appendTo(this.element);
if(b.toolMargin){h.css("margin-right",b.toolMargin);k+=b.toolMargin}if(!b.alwaysShowTools){h.hide();var j=function(){a(this).show()}.createDelegate(h);var e=function(){a(this).hide()}.createDelegate(h);this.element.hover(j,e)}if(b.tooltype==="check"){h.addClass("fs_tool_checkoff");if(b.toolUnEditAble){h.addClass("fs_tool_disabled")}if(b[f.name]===1){h.addClass("fs_tool_checkon")}h.click(function(i){l.onToolDivClick(this,i)})}if(f.iconCls){h.addClass(f.iconCls);h.mousedown(function(){a(this).addClass(a(this).data("tool").iconCls4Click)
}).mouseleave(function(){a(this).removeClass(a(this).data("tool").iconCls4Click)}).mouseup(function(m){a(this).removeClass(a(this).data("tool").iconCls4Click);if(a.isFunction(b.onToolClick)){var i=b.onToolClick.call(l)}if(a.isFunction(b.onItemToolClick)){b.onItemToolClick.call(this,a(this).data("index"),i,m)}m.stopEvent()});if(f.iconCls4Hover){h.hover(function(){a(this).addClass(a(this).data("tool").iconCls4Hover)},function(){a(this).removeClass(a(this).data("tool").iconCls4Hover)})}}h.attr("toolid",d);
if(this.options.tools[d].invisible){h.hide()}k+=(f.width||b.height);this.toolDivs.push(h)}}this.element.hover(function(){a(this).addClass("fr-core-list-item-hover")},function(){a(this).removeClass("fr-core-list-item-hover")});if(b.itemCanBeSelect){this.element.bind("mouseup",function(){l.doSelect();if(a.isFunction(b.onItemSelect)){b.onItemSelect.apply(l)}if(a.isFunction(b.onCustomItemSelect)){b.onCustomItemSelect.apply(l)}})}},onToolDivClick:function(g,j,c){var h=this.options;if(h.toolUnEditAble){return
}var i=a(g).data("index");var f=!a(g).hasClass("fs_tool_checkon");if(c===true||c===false){f=c}if(a.isFunction(h.onToolClick)){var d=h.onToolClick.call(this)}if(a.isFunction(h.beforeSelect)){var b=h.beforeSelect.call(g,i,d,f,j);if(b==="wait"){return}}if(!f){this.doUnselect(i)}else{this.doSelect(i)}if(a.isFunction(h.onItemToolClick)){h.onItemToolClick.call(g,i,d,f,j)}},getText:function(){return this.options[this.options.showField]},getValue:function(){var e=this.options;if(e.tooltype==="check"){var b={id:e.id,value:e[e.valueField]};
for(var c=0;c<this.options.tools.length;c++){var d=this.options.tools[c].name;b[d]=this.options[d]}return b}return e[e.valueField]},doSelect:function(b,d){this.element.addClass("fr-core-list-item-selected");if(this.options.tooltype==="check"){this.options[this.toolName[b]]=1;this.toolDivs[b].addClass("fs_tool_checkon")}if(d===true){var c=this.options;if(a.isFunction(c.onItemSelect)){c.onItemSelect.apply(this)}if(a.isFunction(c.onCustomItemSelect)){c.onCustomItemSelect.apply(this)}}},doUnselect:function(c){var b=this;
if(this.options.tooltype==="check"){this.options[this.toolName[c]]=0;this.toolDivs[c].removeClass("fs_tool_checkon")}var d=0;a.each(this.toolName,function(e,f){d|=b.options[f]});if(!d){this.element.removeClass("fr-core-list-item-selected")}},setText:function(c){var b=this.options;b[b.showField]=c;this.$text.text(c).attr("title",c)}})})(jQuery);
(function(a){FR.QuickButton=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.QuickButton.superclass._defaultConfig.apply(this,arguments),{baseCls:"fr-core-btn",alignment:"center",text:null,icon:null,iconPath:null,width:80,height:28,iconWidth:24,iconHeight:16,style:null})},_init:function(){FR.QuickButton.superclass._init.apply(this,arguments);var d=this.options;var c=this;var e="gray";a.each(["gray","green","blue"],function(f,g){if(d.style&&g==d.style.toLowerCase()){e=d.style.toLowerCase()
}});var b="fr-core-btn-hover"+"-"+e;this.element.addClass("fr-core-btn-style-"+e);this.$inner=a("<div class='fr-core-btn-inner'></div>").appendTo(this.element);this.$text=a("<span class='fr-core-btn-text' onselectstart='return false'></span>").appendTo(this.$inner);this._initTextFont();this.$text.css({textAlign:d.alignment});if(d.text){this.$text.text(d.text)}d.iconWidth=(d.icon||d.iconPath)?d.iconWidth:0;if(d.iconWidth>0){this.$icon=a("<span class='fr-core-btn-icon'></span>").css({position:"absolute",width:d.iconWidth,height:d.iconHeight,top:0,left:0}).appendTo(this.$inner);
if(d.icon){if(d.icon.indexOf("css:")!=-1){d.icon=d.icon.substring(4)}this.$icon.addClass(d.icon)}else{if(d.iconPath){this.$icon.css({background:"url('"+d.iconPath+"') no-repeat center"})}}}this.$text.css({left:d.iconWidth});this.doResize({width:d.width,height:d.height});if(a.isFunction(d.handler)){this.on(FR.Events.CLICK,d.handler.createDelegate(d.scope||this))}this.element.hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)});this.$inner.click(function(f){c.fireEvent(FR.Events.CLICK,f)
})},_initTextFont:function(){var b=this.options;if(b.color){this.$text.css("color",b.color)}if(b.decoration){this.$text.css("text-decoration",b.decoration)}if(b.fontsize){this.$text.css("fontSize",b.fontsize)}if(b.fontweight){this.$text.css("fontWeight",b.fontweight)}if(b.fontstyle){this.$text.css("fontStyle",b.fontstyle)}if(b.fontfamily){this.$text.css("fontFamily",b.fontfamily)}},setValue:function(b){if(!FR.isEmpty(b)){this.$text.text(b)}},getValue:function(){return this.$text.text()},setText:function(b){this.setValue(b)
},getText:function(){return this.getValue()},doResize:function(g){var d=this.options;if(g){if(g.width){d.width=g.width}if(g.height){d.height=g.height}if(g.left!=null){d.left=g.left}if(g.top!=null){d.top=g.top}}if(d.left||d.top){this.element.css({position:"absolute",left:d.left,top:d.top})}if(!isNaN(d.width)){var c=d.width;var f=0;if(a.support.boxModel===true){f=(this.element.outerWidth()-this.element.width())}if(!g.hasIgnoredBounds){c=c-f}this.element.css({width:c});this.$inner.css({width:c});this.$text.css({width:c-d.iconWidth})
}if(!isNaN(d.height)){var b=d.height;var e=0;if(a.support.boxModel===true){e=this.element.outerHeight()-this.element.height();this.$icon&&this.$icon.css({height:d.iconHeight,top:(this.element.outerHeight()-this.$icon.outerHeight())/2-e})}else{this.$icon&&this.$icon.css({height:d.iconHeight,top:(d.height-d.iconHeight)/2})}if(!g.hasIgnoredBounds){b=b-e}this.element.css({height:b});this.$text.css("line-height",b+"px");this.$text.css("height",b);this.$inner.css("height",b);this.$text.css("display","block")
}},setEnable:function(b){var c=this.options;if(a.isFunction(c.handler)){if(!this.isEnabled()&&b===true){this.un(FR.Events.CLICK);this.on(FR.Events.CLICK,c.handler.createDelegate(c.scope||this))}else{if(b===false){this.un(FR.Events.CLICK)}}}FR.QuickButton.superclass.setEnable.apply(this,arguments)}});a.shortcut("quickbutton",FR.QuickButton)})(jQuery);
(function(a){FR.Grid=FR.extend(FR.Widget,{NAV:{FIRSTPAGE:"first",PREVPAGE:"prev",NEXTPAGE:"next",LASTPAGE:"last",JUMPPAGE:"jump"},_defaultConfig:function(){return a.extend(FR.Grid.superclass._defaultConfig.call(),{baseCls:"fr-grid",baseId:null,marginLeft:10,marginRight:10,items:[],columnsConfig:[],pageCount:15,footAlign:"bottom",isFootShow:true,isHeadShow:true,multiSelect:false,intervalColor:false,isInitWithData:true,async:null,hasHoverCls:true,onPageTurn:null,onAsyncSuccess:null,onAsyncError:null,onBeforeRowCreate:null,onAfterRowCreate:null,onBeforeHeadCreate:null,onAfterHeadCreate:null,localeArray:[]})
},_init:function(){FR.Grid.superclass._init.apply(this,arguments);this.$container=a('<div class="fr-grid-table"/>');this.element.append(this.$container);this.activedPage=1;var b=this.options;if(b.baseId){this.element.attr("id",b.baseId)}if(b.isInitWithData){this.refresh()}else{this._initWidth();this.$table=a('<table cellPadding="0" cellSpacing="0"/>');this._onCreateHead();this._onCreateFoot();this.$table.appendTo(this.$container)}},refresh:function(b){},reBuild:function(){if(this.options.multiSelect){this.allBoxes=[]
}if(this.$table){this.$table.remove();this.$table=null}this._initWidth();this.$table=a('<table cellPadding="0" cellSpacing="0"/>');this._onCreateHead();this._onCreateTable();this._onCreateFoot();this._bindEvts();this.$container.append(this.$table)},_initWidth:function(){var d=0,e=this.options;for(var c=0,b=e.columnsConfig.length;c<b;c++){d+=e.columnsConfig[c].width}if(e.multiSelect){d+=25}d+=e.marginLeft;d+=e.marginRight;e.width=d;this.element.width(d)},_onCreateHead:function(){var b=this.options,i=this;
var d=b.isHeadShow;this.$head=a("<thead/>");var e=a("<tr/>").appendTo(this.$head);FR.applyFunc(this,b.onBeforeHeadCreate,[e],false);a("<td/>").append(a("<div/>").width(b.marginLeft)).appendTo(e);if(b.multiSelect){this.$AllCheck=new FR.CheckBox({width:25,listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(!i.allBoxes){return}var l=this.isSelected();for(var m=0,k=i.allBoxes.length;m<k;m++){var n=i.allBoxes[m];n.setValue(l)}}}]});a("<td/>").append(this.$AllCheck.element).appendTo(e)}for(var c=0,f=b.columnsConfig.length;
c<f;c++){var h=b.columnsConfig[c];var g=a("<td/>").width(this._calculateWidth(h));var j=FR.applyFunc(this,h.onHeadCellCreate,[c,h],false);if(j===false){g.css("text-align",h.textAlign?h.textAlign:"left").text(h.value?h.value:h.key)}else{g.append(j)}g.appendTo(e)}a("<td/>").append(a("<div/>").width(b.marginRight)).appendTo(e);FR.applyFunc(this,b.onAfterHeadCreate,[e],false);if(d){this.$table.append(this.$head)}},_calculateWidth:function(b){if(b){if(b.width>0&&b.width<1){return b.width*this.element.width()
}else{return b.width}}return 0},_onCreateTable:function(){this.$tbody=a("<tbody/>");var f=this.options;var d=f.items;if(f.page&&f.autoPage){this.totalpages=Math.ceil(f.items.length/f.pageCount);d=f.items.slice(f.pageCount*(this.activedPage-1),f.pageCount*this.activedPage)}for(var e=0,c=d.length;e<c;e++){var b=this.onCreateRow(e,d[e]);this.$tbody.append(b)}this.$table.append(this.$tbody)},_onCreateFoot:function(){var l=this,d=this.options,c=this.NAV;if(!d.page){return}if(this.$foot){this.$foot.remove();
this.$foot=null}this.$foot=a('<div class="fr-grid-foot"/>').css({"margin-left":d.width-240-d.marginRight});var j=new FR.IconButton({imgsrc:"fr-grid-foot-first",width:24,height:24,handler:function(){l.activedPage=1;if(!FR.applyFunc(l,d.onPageTurn,[l.activedPage,d.pageCount,c["FIRSTPAGE"]],false)){l.reBuild()}}});var e=new FR.IconButton({imgsrc:"fr-grid-foot-prev",width:24,height:24,handler:function(){l.activedPage--;if(!FR.applyFunc(l,d.onPageTurn,[l.activedPage,d.pageCount,c["PREVPAGE"]],false)){l.reBuild()
}}});var g=new FR.IconButton({imgsrc:"fr-grid-foot-next",width:24,height:24,handler:function(){l.activedPage++;if(!FR.applyFunc(l,d.onPageTurn,[l.activedPage,d.pageCount,c["NEXTPAGE"]],false)){l.reBuild()}}});var i=new FR.IconButton({imgsrc:"fr-grid-foot-last",width:24,height:24,handler:function(){l.activedPage=l.totalpages;if(!FR.applyFunc(l,d.onPageTurn,[l.activedPage,d.pageCount,c["LASTPAGE"]],false)){l.reBuild()}}});var f=a('<input class="fr-grid-foot-loader" type="text"/>').val(this.activedPage).keydown(function(m){if(m.keyCode===13){l.activedPage=a(this).val();
if(!FR.applyFunc(l,d.onPageTurn,[l.activedPage,d.pageCount,c["JUMPPAGE"]],false)){l.reBuild()}m.stopEvent()}});var h=this.totalpages?this.totalpages:1;if(this.activedPage>=h){i.setEnable(false);g.setEnable(false)}if(this.activedPage<=1){e.setEnable(false);j.setEnable(false)}var b=a('<div class="fr-grid-foot-page"/>').text(" /"+h+" "+FR.i18nText("FR-Basic_Page_Number"));var k=a("<table/>").attr({id:"fr-grid-foot-table",cellPadding:0,cellSpacing:0});a("<tr/>").append(a("<td/>").append(j.element)).append(a("<td>").append(e.element)).append(a("<td/>").addClass("fr-grid-foot-pageshow").append(f).append(b)).append(a("<td/>").append(g.element)).append(a("<td/>").append(i.element)).appendTo(k);
this.$foot.append(k);if(d.footAlign=="top"){this.$foot.prependTo(this.element)}else{this.$foot.appendTo(this.element)}},_bindEvts:function(){var b=this,d=this.options;var c=function(g){var h=g.target;var f=g.type;var e=b._getTargetDom(h,"TR");if(!e){return}if(f==="mousedown"){FR.applyFunc(b,d.onRowMouseDown,[e],false)}else{if(f==="mouseover"){d.hasHoverCls&&e.addClass("hover");FR.applyFunc(b,d.onRowMouseOver,[e],false)}else{if(f==="mouseout"){e.removeClass("hover");FR.applyFunc(b,d.onRowMouseOut,[e],false)
}else{if(f==="mouseup"){FR.applyFunc(b,d.onRowClick,[e],false)}}}}};this.element.bind("mousedown",c).bind("mouseover",c).bind("mouseup",c).bind("mouseout",c)},_getTargetDom:function(b,c){while(b&&b.tagName){if(b.tagName.toUpperCase()!==c.toUpperCase()){b=b.parentNode}else{return a(b)}}return null},onCreateRow:function(c,j){var e=this.options,k=this;var h=a("<tr/>");FR.applyFunc(this,e.onBeforeRowCreate,[h,c,j],false);a("<td/>").width(e.marginLeft).appendTo(h);if(e.multiSelect){var b=new FR.CheckBox({width:25,gridRowData:j,listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(!k.$AllCheck){return
}if(this.isSelected()){var m=true;for(var n=0,l=k.allBoxes.length;n<l;n++){var o=k.allBoxes[n];if(!o.isSelected()){m=false;break}}k.$AllCheck.setValue(m)}else{k.$AllCheck.setValue(false)}}}]});this.allBoxes.push(b);a("<td/>").append(b.element).appendTo(h)}for(var f=0,g=e.columnsConfig.length;f<g;f++){var d=e.columnsConfig[f];var i=this.onCellCreate(c,f,j,d);i.appendTo(h)}if(e.intervalColor&&c%2===0){h.addClass("even")}a("<td/>").width(e.marginRight).appendTo(h);FR.applyFunc(this,e.onAfterRowCreate,[h,c,j],false);
return h},onCellCreate:function(e,i,d,b){var h=a("<td/>"),c=this;var f=FR.applyFunc(this,b.onCellCreate,[e,i,d,b],false);if(f===false){if(!FR.isEmpty(b.value)){var g=a.inArray(b.key,c.options.localeArray)==-1?d[b.key]:FR.i18nText(d[b.key]);f=a('<div class="cell"/>').width(c._calculateWidth(b)).text(g).attr("title",g).appendTo(h)}}else{h.append(f)}h.click(function(){FR.applyFunc(c,b.onCellClick,[e,i,d,b,f],false)});FR.applyStyles(f,b.css);return h},getValue:function(){return this.options.items},addRowData:function(d){var c=this,e=this.options;
if(e.async){}else{var b=this.onCreateRow(this.options.items.length,d);this.options.items.push(d);b.appendTo(this.$tbody)}},getSelectedData:function(){var c=[];if(this.allBoxes){for(var d=0,b=this.allBoxes.length;d<b;d++){var e=this.allBoxes[d];if(e.isSelected()){c.push(e.options.gridRowData)}}}return c}})}(jQuery));
(function(a){FR.QuickGrid=FR.extend(FR.Grid,{_defaultConfig:function(){return a.extend(FR.QuickGrid.superclass._defaultConfig.call(),{page:false,autoPage:true})},refresh:function(c){var b=this,d=this.options;if(a.isArray(c)){this.options.items=c;this.reBuild()}else{if(d.async){FR.ajax({url:d.async.url,type:d.async.type?d.async.type:"POST",data:d.async.data,success:function(f,e){FR.applyFunc(b,d.onAsyncSuccess,[f,e,c]);b.reBuild()},error:function(f,e){FR.applyFunc(b,d.onAsyncError,[f,e,c])}})}else{this.reBuild()
}}}});a.shortcut("quickgrid",FR.QuickGrid)}(jQuery));
(function(a){FR.AsygnGrid=FR.extend(FR.Grid,{_defaultConfig:function(){return a.extend(FR.AsygnGrid.superclass._defaultConfig.call(),{page:true,autoPage:false})},refresh:function(){var b=this,c=this.options;if(c.async){b.activedPage=1;b.reBuild()}},reBuild:function(){var b=this,d=this.options;var c=a.extend({pn:b.activedPage,pageCount:d.pageCount},d.async.data);FR.ajax({url:d.async.url,type:d.async.type?d.async.type:"POST",data:c,success:function(g,f){FR.applyFunc(b,d.onAsyncSuccess,[g,f]);var e=FR.jsonDecode(g);
d.items=e.items;b.totalpages=e.totalpages;b._reBuildGrid()},error:function(f,e){FR.applyFunc(b,d.onAsyncError,[f,e])}})},_reBuildGrid:function(){FR.AsygnGrid.superclass.reBuild.apply(this)}});a.shortcut("asygngrid",FR.AsygnGrid)}(jQuery));
FR.Core=FR.Core||{};FR.Core.Plugin=FR.Core.Plugin||{};FR.Core.Plugin.Tree=FR.Core.Plugin.Tree||{};
(function(a){FR.progressBar=function(g,e){var d=this;function b(i){var h;FR.ajax({type:"POST",url:FR.servletURL,cache:false,data:{op:"export",cmd:"export_polling",sessionID:i,type:e,data:new Date().getTime()},async:false,success:function(k,j){var l=FR.jsonDecode(k);if(l.isExporting){d.createProgressBar()}else{d.removeProgressBar();h=true}}});return h}var f=function(){if(!b(g)){return}clearInterval(c)};var c=setInterval(f,5000)}}(jQuery));
/**
 * Created by richie on 15/11/11.
 */
;(function($){
    FR.layoutFrozen = function ($container, pageTop) {
        var $center = $('.frozen-center', $container);
        var $corner = $('.frozen-corner', $container);
        var $north = $('.frozen-north', $container);
        var $west = $('.frozen-west', $container);

        if ($center.length > 0 || $corner.length > 0 || $north.length > 0 || $west.length > 0) {

            var cornerNorthHeight = 0;
            $('.rows-height-counter', $north).each(function () {
                cornerNorthHeight += $(this).height();
            });
            var calculateDivHeight = function () {
                //, pageTop
                var top = pageTop;
                var buttonBarHeight = 0;

                var pageHeight = FR.windowHeight - cornerNorthHeight;

                var tabPane = contentPane.$contentPane.data('TabPane');
                if (tabPane) {
                    top += tabPane.options.tabHeight;
                }

                if (FR.hasBottomToolbar) {
                    top += FR.toolbarHeight;
                }

                if (FR.parameterContainerHeight > 0) {
                    var parameterPane = $('.parameter-container');
                    var visibility = parameterPane.isVisible();
                    var parameterHeight = FR.parameterContainerHeight;
                    if (visibility && top < parameterHeight) {
                        top += parameterHeight;
                    } else if (!visibility && top > parameterHeight) {
                        top -= parameterHeight;
                    }
                }

                pageHeight -= top;

                return pageHeight;
            };

            var setFrozenDiv = function () {
                var pageWidth;
                var pageHeight = calculateDivHeight();

                var $contentDIV = $(".pageContentDIV", this.$contentPane);
                var isPageCenter = $contentDIV.hasClass("contentDIV");
                var isFrozen = false;
                if ($('.frozen-table', $container).length > 0) {
                    isFrozen = true;
                }
                if (isPageCenter) {//
                    var left = parseInt($(".report-background").css('left'));
                    if (FR.Browser.isIE8Before()){
                        left = parseInt($("#fr-page-content").css('left'));
                    }
                    // ieleftauto leftNaN
                    left = isNaN(left) ? 0 : left;
                    var contentdivWidth = $contentDIV.width();
                    var frozenWidth = Math.min($('.content-container').width(), contentdivWidth) - left;
                    $(".frozen-page").css('width', frozenWidth);
                    pageWidth = frozenWidth;
                    if (pageWidth == contentdivWidth) {
                        //, , frozenpage
                        pageWidth -= left;//
                    }
                    var top = parseInt($(".report-background").css('top'));
                    if (FR.Browser.isIE8Before()){
                        top = parseInt($("#fr-page-content").css('top'));
                    }
                    top = isNaN(top) ? 0 : top;
                    pageHeight -= (top + 24);//
                    // north center frozen-pagecorner
                    pageWidth -= $corner.width();
                } else {
                    var westWidth = 0;
                    var xtable = $('table.x-table', $west);
                    if (xtable.length > 0) {
                        westWidth = parseInt(xtable[0].style.width || 0);
                        if (westWidth > 0) {
                            westWidth += 1;
                        }
                    }
                    if (!westWidth || westWidth === 0) {
                        westWidth = $west.width();
                    }
                    if (isFrozen) {//:
                        pageWidth = FR.windowWidth - parseInt($container[0].style['margin-left'] || 0) - westWidth;
                    } else {
                        pageWidth = FR.windowWidth - westWidth;
                    }

                    pageHeight -= $(".HF-footer").height();
                    pageHeight -= $(".HF-header").height();
                }

                //IE
                if (pageWidth < 0) {
                    pageWidth = 0;
                }
                if (pageHeight < 0) {
                    pageHeight = 0;
                }

                if ($center.length > 0) {
                    $center[0].style.width = pageWidth + 'px';
                    $center[0].style.height = pageHeight + 'px';
                }
                if ($north.length > 0) {
                    $north[0].style.width = pageWidth + 'px';
                }
                if ($west.length > 0) {
                    $west[0].style.height = pageHeight + 'px';
                }

                //  north 
//                if ($.browser.mozilla) {
//                    $north.height($north.children().height());
//                }

            };

            var checkViewMultiSheet = function () {
                if ($west.width() === 0 && cornerNorthHeight === 0) {
                    //viewsheet, container, $west,$northlgp
                    $container = $('.sheet-container');
                    var len = $('.frozen-center', $container).length;
                    for (var i = 0; i < len; i++) {
                        var tempWest = $($('.frozen-west', $container)[i]);
                        var tempNorth = $($('.frozen-north', $container)[i]);
                        if (tempWest.width() !== 0 && tempNorth.height() !== 0) {
                            $west = tempWest;
                            $north = tempNorth;
                            $center = $($('.frozen-center', $container)[i]);
                            $corner = $($('.frozen-corner', $container)[i]);
                            break;
                        }
                    }
                }
            };

            setFrozenDiv();
            // alex:$center_block,north & west
            var lastLeft = 0;
            var lastTop = 0;
            //$center$westscroll,$center$westscroll
            var westScroll = function () {
                $center.scrollTop($west.scrollTop());
            }.createDelegate(this);
            var scrollTimerId = null;
            $center.scroll(function () {
                var left = $center.scrollLeft();
                var top = $center.scrollTop();
                if (left != lastLeft) {
                    $north.scrollLeft(left);
                    lastLeft = left;
                }
                if (top != lastTop) {
                    $west.off('scroll', westScroll);
                    $west.scrollTop(top);
                    if (scrollTimerId) {
                        clearTimeout(scrollTimerId);
                    }
                    scrollTimerId = setTimeout(function () {
                        $west.on('scroll', westScroll);
                        scrollTimerId = null;
                    }, 100);
                    lastTop = top;
                }
            }.createDelegate(this));

            //zack:bug:70678
            $west.on('scroll', westScroll);

            //iedivoverflow-yscrolloverflow-xtableiframe
            //iecenternorth
            if(FR.Browser.isIE()){
                $north.scroll(function () {
                    $center.scrollLeft($north.scrollLeft());
                }.createDelegate(this));
            }

            window.onresize = function () {
                if (self.resizeid != null) {
                    clearTimeout(self.resizeid);
                    self.resizeid = null;
                }
                self.resizeid = setTimeout(function () {
                    checkViewMultiSheet();
                    setFrozenDiv();
                }, 200);
            };
        }
    };
})(jQuery);
(function(a){a.fn.extend({__scroll2View__:function(b,d){var e=a(b)[0];return a.each(this,function(p,h){var g=a(h).offset();var i=a(e).offset();var k=g.left-i.left+e.scrollLeft,s=g.top-i.top+e.scrollTop,o=s+h.offsetHeight,f=k+h.offsetWidth;var c=e.clientHeight;var m=parseInt(e.scrollTop,10);var q=parseInt(e.scrollLeft,10);var j=m+c;var n=q+e.clientWidth;if(h.offsetHeight>c||s<m){e.scrollTop=s}else{if(o>j){e.scrollTop=o-c}}if(d!==false){if(h.offsetWidth>e.clientWidth||k<q){e.scrollLeft=k}else{if(f>n){e.scrollLeft=f-e.clientWidth
}}e.scrollLeft=e.scrollLeft}})}})})(jQuery);
;
(function ($) {


    /**
     * 
     * @abstract
     * @class FR.BasePane
     * @extends FR.Widget
     */
    FR.BasePane = FR.extend(FR.Widget, {
        type: "basepane",
        zoom: 1.0,

        _defaultConfig: function () {
            return $.extend(FR.BasePane.superclass._defaultConfig.apply(this, arguments), {});
        },

        _init: function () {
            FR.BasePane.superclass._init.apply(this, arguments);
        },

        /**
         * 
         */
        autoScale: function () {
            if (window != top && this.$contentPane && this.options.autoScale) { // denny:
                // iframe
                var $contentDiv = $('.pageContentDIV', this.$contentPane);

                if ($contentDiv) {
                    // var bHeight = window.document.body.scrollHeight;
                    // var dHeight = window.document.documentElement.scrollHeight;
                    var height = $contentDiv.height();

                    // var bWidth = window.document.body.scrollWidth;
                    // var dWidth = window.document.documentElement.scrollWidth;
                    var width = $contentDiv.width();

                    var iframe_height = FR.windowHeight;
                    var iframe_width = FR.windowWidth;

                    this.scale(iframe_height / height);
                }
            }
        },

        /**
         * 
         *
         *     @example
         *     contentPane.scale('+');//
         *     contentPane.scale(1.5);//150%
         *
         * @param {'+'/'-'/Number} 
         */
        scale: (function () {
            // ["25%", "50%", "75%", "100%", "120%", "150%", "200%"]
            var zooms = [0.25, 0.5, 0.75, 1.0, 1.2, 1.5, 2.0];

            return function (zoom) {
                if (zoom === '+') {
                    for (var i = 0, len = zooms.length; i < len; i++) {
                        if (zooms[i] > this.zoom) {
                            return this.scale(zooms[i]);
                        }
                    }
                    if (i == zooms.length) {
                        return this.scale(zooms[zooms.length - 1]);
                    }
                } else if (zoom === '-') {
                    for (var i = (zooms.length - 1); i >= 0; i--) {
                        if (zooms[i] < this.zoom) {
                            return this.scale(zooms[i]);
                        }
                    }
                    if (i < 0) {
                        return this.scale(zooms[0]);
                    }
                } else if (typeof zoom == 'number') {
                    if (this.$contentPane) {
                        var $contentDiv = $('.pageContentDIV', this.$contentPane);
                        if (FR.Browser.r.gecko) {
                            $contentDiv.css('-moz-transform', 'scale(' + zoom + ','
                                + zoom + ')');
                            $contentDiv.css('-moz-transform-origin', 'top left');
                        } else if (FR.Browser.r.webkit) {
                            $contentDiv.css('-webkit-transform', 'scale(' + zoom
                                + ',' + zoom + ')');
                            $contentDiv.css('-webkit-transform-origin', 'top left');
                        } else if (FR.Browser.r.opera) {
                            $contentDiv.css('-o-transform', 'scale(' + zoom + ','
                                + zoom + ')');
                            $contentDiv.css('-o-transform-origin', 'top left');
                        } else {
                            $contentDiv.css('zoom', zoom);
                        }
                        this.zoom = zoom;

                        this.fireEvent("zoomchanged");
                    }
                } else {
                    return this.zoom;
                }
            }
        })(),

        /**
         * ReportPane
         * ParameterPane + ContentPane,ContentPane
         * @param options 
         * @protected
         */
        loadReportPane: function (options) {
            this.fireEvent(FR.Events.INIT);
            options = options || {};
            options.param = $.extend({
                showType: 1
            }, options.param); // ,showType1:embed

            var items = [];

            if (options.param.html) {
                this.parameterEl = this._createFormParameterPane(options, items);
            }

            this.$contentPane = this._createContentPane(options.sheets,
                options.browserbg, options.$paraContainer);
            items.push({
                region: 'center',
                el: this.$contentPane
            });

            // alex:BorderLayout
            this._doReportPaneLayout(items, options);

            // james:ContentPaneTab
            this.initContentPane();

            // loadContentPane
            if (this.parameterEl == null) {
                this.loadContentPane();
            } else if (options.param.delay === false) {
                this.parameterCommit();
            }

            this.delay = options.param.delay;
        },

        _doReportPaneLayout: function (items, options) {
            var self = this;
            var borderLayout = new FR.BorderLayout({
                items: items,
                renderEl: this.options.renderEl
            });
            $(window).bind("resize", function () {
                if (self.resizeid != null) {
                    clearTimeout(self.resizeid);
                    self.resizeid = null;
                }
                self.resizeid = setTimeout(function () {
                    if (options.$paraContainer) {
                        options.$paraContainer.width = document.body.offsetWidth;
                    }
                    var paramWidget = borderLayout.getWidgetByName(options.alignLayoutName);

                    if (paramWidget) {
                        paramWidget.element.css('width', options.param.width);
                        self.addParaPaneScrollBar(options.$paraContainer, paramWidget.element, options.param.height, self.scrollHeight);
                    }
                    borderLayout.doLayout();
                }, 200);
            });
            var paramWidget = borderLayout.getWidgetByName(options.alignLayoutName);
            if (paramWidget) {
                this.addParaPaneScrollBar(options.$paraContainer, paramWidget.element, options.param.height, this.scrollHeight);
            }
            options.onCollapse = function (isCollapsed, layoutName, paraHeight) {
                borderLayout.getWidgetByName(layoutName).setVisible(!isCollapsed);
                borderLayout.setRegionWH('north', paraHeight);
                borderLayout.doLayout();
            };
            options.onCalculate = function (maxHeight, collapseHeight, $container) {
                options.param.height = maxHeight;
                $container.height(maxHeight + collapseHeight);
                borderLayout.doLayout();
            };
            borderLayout.doLayout();
        },

        _createContentPane: function (sheetsO, browserbg, $paraContainer) {
            sheetsO = sheetsO || [];
            var $contentPane = $("div.content-container");
            if ($contentPane.length !== 1) {
                $contentPane = $("<div id='content-container'>")
                    .appendTo(this.element).addClass("content-container");
            }
            $contentPane.css({
                overflow: 'hidden'
            });
            if (sheetsO && sheetsO.length > 1) {
                this._initSheetTabPane($contentPane, sheetsO, browserbg.background);
            } else {// Sheettabs
                // alex: overflow:auto 
                // p: '0px solid #97A5B0'0px,,.
                $contentPane.css("overflow", "auto").css('border-top', '0px');
            }
            // 
            // 
            if (browserbg.background != null) {
                if (FR.Browser.isIE8Before()) {
                    $contentPane.css('background', browserbg.background + " fixed");
                    if (browserbg.filter !== undefined) {
                        $contentPane.css('filter', browserbg.filter);
                    }
                    if (FR.Browser.isIE6()
                        && $paraContainer) {
                        $contentPane.css('background-position', '0px '
                            + $paraContainer.height()
                            + 'px 0px 0px');
                    }
                } else {
                    $contentPane.css('background', browserbg.background);
                    var bgSize = browserbg["background-size"];
                    if (bgSize !== undefined) {
                        $contentPane.css('background-size', bgSize);
                    }
                }
            }
            return $contentPane;
        },
        addParaPaneScrollBar: function (container, mover, top, height) {
            if (container) {
                container.hScrollPane({
                    mover: mover, //container | ;
                    showArrow: false, // | ;
                    top: top, //top
                    height: height,//
                    //moverW:function(){return $(".press").width();}(), //,mover | ;
                    //handleMinWidth:100,//handle,handlecsshandlewidth width:28px!important; | ;
                    dragable: false, // | ;
                    easing: false, //, | ;
                    // handleCssAlter:"draghandlealter", // | ;
                    mousewheel: {bind: false, moveLength: 500} //mousewheel: bind->'true',mousewheel; ->'false',mousewheelmoveLength,{bind:true,moveLength:300} | ;
                });
            }
        },
        /**
         * 
         * @param o 
         */
        showPageSetupDialog: function (o) {
            o = o || {};
            o.width = o.width || 390;
            o.height = o.height || 295;
            o.title = FR.i18nText("PageSetup-Page_Setup");
            var fontsize = 12, label_color = '#4C4C4C', fontfamily = "simsun", sessionID = o.sessionID || '', reportIndex = o.reportIndex,
                widgetPadding = 10, northHeight = 25, mediumRightPadding = 162, rh = 21, radioRightPadding = 234;
            var paperSize_items = [
                {text: "Letter", value: "Letter"},
                {text: "A2", value: "A2"},
                {text: "Legal", value: "Legal"},
                {text: "A0", value: "A0"},
                {text: "A1", value: "A1"},
                {text: "Note", value: "Note"},
                {text: "A3", value: "A3"},
                {text: "A4", value: "A4"},
                {text: "A5", value: "A5"},
                {text: "A6", value: "A6"},
                {text: "A7", value: "A7"},
                {text: "A8", value: "A8"},
                {text: "B0", value: "B0"},
                {text: "B1", value: "B1"},
                {text: "B2", value: "B2"},
                {text: "B3", value: "B3"},
                {text: "B4", value: "B4"},
                {text: "B5", value: "B5"},
                {text: "Tabloid", value: "Tabloid"},
                {text: "Ledger", value: "Ledger"},
                {text: "Halfletter", value: "Halfletter"}
            ];
            var tableLayout = FR.createWidget({
                type: 'tablelayout',
                columnSize: [72, 16, 302],
                rowSize: [rh, 52, 52],
                vgap: 20,
                items: [
                    [
                        {
                            el: {
                                type: 'label',
                                value: FR.i18nText("FR-Engine-PageSetup_Orientation"),
                                fontsize: fontsize,
                                verticalcenter: true,
                                textalign: 'right',
                                fontfamily: fontfamily
                            }
                        },
                        {el: $('<div>')},
                        {
                            el: {
                                type: 'border', items: [
                                    {
                                        region: 'center', el: {
                                        type: 'radio',
                                        widgetName: 'portrait',
                                        text: FR.i18nText("FR-Engine-PageSetup_Portrait"),
                                        fontSize: fontsize,
                                        listeners: [
                                            {
                                                eventName: 'statechange',
                                                action: function () {
                                                    if (this.getValue()) {
                                                        var radio_landscape = tableLayout.getWidgetByName("landscape");
                                                        if (radio_landscape) {
                                                            radio_landscape.setValue(false);
                                                        }
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                    },
                                    {
                                        region: 'east', width: radioRightPadding, el: {
                                        type: 'radio',
                                        widgetName: 'landscape',
                                        text: FR.i18nText("FR-Engine-PageSetup_Landscape"),
                                        fontSize: fontsize,
                                        listeners: [
                                            {
                                                eventName: 'statechange',
                                                action: function () {
                                                    if (this.getValue()) {
                                                        var radio_portrait = tableLayout.getWidgetByName("portrait");
                                                        if (radio_portrait) {
                                                            radio_portrait.setValue(false);
                                                        }
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                    }
                                ]
                            }
                        }
                    ],
                    [
                        {
                            el: {
                                type: 'label',
                                value: FR.i18nText("FR-Engine-PageSetup_Paper_Size"),
                                fontsize: fontsize,
                                textalign: 'right',
                                fontfamily: fontfamily
                            }
                        },
                        {el: $('<div>')},
                        {
                            el: {
                                type: 'border', items: [
                                    {
                                        region: 'north', height: rh, el: {
                                        type: 'border', items: [
                                            {
                                                region: 'center', el: {
                                                type: 'radio',
                                                widgetName: 'predefined',
                                                text: FR.i18nText("FR-Engine-PageSetup_Predefined"),
                                                fontSize: fontsize,
                                                listeners: [
                                                    {
                                                        eventName: 'afteredit', action: function () {
                                                        var value = this.getValue();
                                                        var tableWidget = tableLayout.getWidgetByName('papaersize_setup');
                                                        if (value === false) {
                                                            tableWidget.setRowVisible(0, false);
                                                        } else {
                                                            tableWidget.setRowVisible(0, true);
                                                        }
                                                        tableWidget.doLayout();
                                                    }
                                                    },
                                                    {
                                                        eventName: 'statechange', action: function () {
                                                        var tableWidget = tableLayout.getWidgetByName('papaersize_setup');
                                                        if (this.getValue()) {
                                                            tableWidget.setRowVisible(1, false);
                                                            var radio_customed = tableLayout.getWidgetByName("customed");
                                                            if (radio_customed) {
                                                                radio_customed.setValue(false);
                                                            }
                                                        } else {
                                                            tableWidget.setRowVisible(1, true);
                                                        }
                                                        tableWidget.doLayout();
                                                    }
                                                    }
                                                ]
                                            }
                                            },
                                            {
                                                region: 'east', width: radioRightPadding, el: {
                                                type: 'radio',
                                                widgetName: 'customed',
                                                text: FR.i18nText("FR-Engine_Custom"),
                                                fontSize: fontsize,
                                                listeners: [
                                                    {
                                                        eventName: 'afteredit', action: function () {
                                                        var value = this.getValue();
                                                        var tableWidget = tableLayout.getWidgetByName('papaersize_setup');
                                                        if (value === false) {
                                                            tableWidget.setRowVisible(1, false);
                                                        } else {
                                                            tableWidget.setRowVisible(1, true);
                                                        }
                                                        tableWidget.doLayout();
                                                    }
                                                    },
                                                    {
                                                        eventName: 'statechange', action: function () {
                                                        var tableWidget = tableLayout.getWidgetByName('papaersize_setup');
                                                        if (this.getValue()) {
                                                            tableWidget.setRowVisible(0, false);
                                                            var radio_predefined = tableLayout.getWidgetByName("predefined");
                                                            if (radio_predefined) {
                                                                radio_predefined.setValue(false);
                                                            }
                                                        } else {
                                                            tableWidget.setRowVisible(0, true);
                                                        }
                                                        tableWidget.doLayout();
                                                    }
                                                    }
                                                ]
                                            }
                                            }
                                        ]
                                    }
                                    },
                                    {region: 'center', height: widgetPadding, el: $('<div>')},
                                    {
                                        region: 'south', height: rh, el: {
                                        type: 'tablelayout',
                                        widgetName: 'papaersize_setup',
                                        columnSize: [302],
                                        rowSize: [rh, rh],
                                        vgap: 0,
                                        items: [
                                            [
                                                {
                                                    el: {
                                                        type: 'border', items: [
                                                            {
                                                                region: 'center', el: {
                                                                type: 'combo',
                                                                widgetName: 'paperSize',
                                                                allowBlank: false,
                                                                directEdit: true,
                                                                items: paperSize_items,
                                                                fontSize: fontsize,
                                                                listeners: [
                                                                    {
                                                                        eventName: 'afteredit', action: function () {
                                                                        FR.ajax({
                                                                            url: FR.servletURL,
                                                                            type: 'POST',
                                                                            data: {
                                                                                op: 'fr_utils',
                                                                                cmd: 'utils_papersize',
                                                                                paperSize: this.getValue()
                                                                            },
                                                                            complete: function (res) {
                                                                                var paper = FR.jsonDecode(res.responseText);
                                                                                tableLayout.getWidgetByName("user_width").setValue(paper.width);
                                                                                tableLayout.getWidgetByName("user_height").setValue(paper.height);
                                                                                tableLayout.getWidgetByName("predefined").setValue(true);
                                                                                tableLayout.getWidgetByName("customed").reset();
                                                                            }
                                                                        });
                                                                    }
                                                                    }
                                                                ]
                                                            }
                                                            },
                                                            {region: 'east', width: mediumRightPadding, el: $('<div>')}
                                                        ]
                                                    }
                                                }
                                            ],
                                            [
                                                {
                                                    el: {
                                                        type: 'tablelayout',
                                                        columnSize: [12, 12, 60, 5, 21, 14, 12, 12, 60, 5, 21, 68],
                                                        rowSize: [rh],
                                                        vgap: 0,
                                                        items: [
                                                            [
                                                                {
                                                                    el: {
                                                                        type: 'label',
                                                                        value: FR.i18nText("FR-Engine_Width"),
                                                                        fontsize: fontsize
                                                                    }
                                                                },
                                                                {el: $('<div>')},
                                                                {
                                                                    el: {
                                                                        type: 'number',
                                                                        widgetName: 'user_width',
                                                                        fontSize: fontsize
                                                                    }
                                                                },
                                                                {el: $('<div>')},
                                                                {
                                                                    el: {
                                                                        type: 'label',
                                                                        value: "mm",
                                                                        fontsize: fontsize,
                                                                        color: label_color,
                                                                        fontfamily: 'tahoma'
                                                                    }
                                                                },
                                                                {el: $('<div>')},
                                                                {
                                                                    el: {
                                                                        type: 'label',
                                                                        value: FR.i18nText("FR-Engine_Height"),
                                                                        fontsize: fontsize
                                                                    }
                                                                },
                                                                {el: $('<div>')},
                                                                {
                                                                    el: {
                                                                        type: 'number',
                                                                        widgetName: 'user_height',
                                                                        fontSize: fontsize
                                                                    }
                                                                },
                                                                {el: $('<div>')},
                                                                {
                                                                    el: {
                                                                        type: 'label',
                                                                        value: "mm",
                                                                        fontsize: fontsize,
                                                                        color: label_color,
                                                                        fontfamily: 'tahoma'
                                                                    }
                                                                },
                                                                {el: $('<div>')}
                                                            ]
                                                        ]
                                                    }
                                                }
                                            ]
                                        ]
                                    }
                                    }
                                ]
                            }
                        }
                    ],
                    [
                        {
                            el: {
                                type: 'label',
                                value: FR.i18nText("FR-Engine-PageSetup_Margin"),
                                fontsize: fontsize,
                                textalign: 'right',
                                fontfamily: fontfamily
                            }
                        },
                        {el: $('<div>')},
                        {
                            el: {
                                type: 'tablelayout',
                                columnSize: [12, 12, 60, 5, 21, 14, 12, 12, 60, 5, 21, 68],
                                rowSize: [rh, rh],
                                vgap: 10,
                                items: [
                                    [
                                        {el: {type: 'label', value: FR.i18nText("FR-Engine_Top"), fontsize: fontsize}},
                                        {el: $('<div>')},
                                        {el: {type: 'number', widgetName: 'margin_top', fontSize: fontsize}},
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: "mm",
                                                fontsize: fontsize,
                                                color: label_color,
                                                fontfamily: 'tahoma'
                                            }
                                        },
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: FR.i18nText("FR-Engine_Bottom"),
                                                fontsize: fontsize
                                            }
                                        },
                                        {el: $('<div>')},
                                        {el: {type: 'number', widgetName: 'margin_bottom', fontSize: fontsize}},
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: "mm",
                                                fontsize: fontsize,
                                                color: label_color,
                                                fontfamily: 'tahoma'
                                            }
                                        },
                                        {el: $('<div>')}
                                    ],
                                    [
                                        {el: {type: 'label', value: FR.i18nText("FR-Engine_Left"), fontsize: fontsize}},
                                        {el: $('<div>')},
                                        {el: {type: 'number', widgetName: 'margin_left', fontSize: fontsize}},
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: "mm",
                                                fontsize: fontsize,
                                                color: label_color,
                                                fontfamily: 'tahoma'
                                            }
                                        },
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: FR.i18nText("FR-Engine_Right"),
                                                fontsize: fontsize
                                            }
                                        },
                                        {el: $('<div>')},
                                        {el: {type: 'number', widgetName: 'margin_right', fontSize: fontsize}},
                                        {el: $('<div>')},
                                        {
                                            el: {
                                                type: 'label',
                                                value: "mm",
                                                fontsize: fontsize,
                                                color: label_color,
                                                fontfamily: 'tahoma'
                                            }
                                        },
                                        {el: $('<div>')}
                                    ]
                                ]
                            }
                        }
                    ]
                ]
            });
            var widget_predefined = tableLayout.getWidgetByName('predefined');
            var widget_customed = tableLayout.getWidgetByName('customed');
            var widget_portrait = tableLayout.getWidgetByName('portrait');
            var widget_landscape = tableLayout.getWidgetByName('landscape');
            var widget_paperSize = tableLayout.getWidgetByName('paperSize');
            var widget_user_width = tableLayout.getWidgetByName('user_width');
            var widget_user_height = tableLayout.getWidgetByName('user_height');
            var widget_margin_top = tableLayout.getWidgetByName('margin_top');
            var widget_margin_bottom = tableLayout.getWidgetByName('margin_bottom');
            var widget_margin_left = tableLayout.getWidgetByName('margin_left');
            var widget_margin_right = tableLayout.getWidgetByName('margin_right');
            // ,
            FR.ajax({
                url: FR.servletURL,
                type: 'POST',
                data: {
                    op: 'fr_dialog',
                    cmd: 'read_page_setup_tpl',
                    sessionID: sessionID,
                    reportIndex: reportIndex
                },
                complete: function (res, status) {
                    var result = FR.jsonDecode(res.responseText);
                    if (result != null) {
                        widget_predefined.setValue(result.predefined);
                        if (widget_predefined.getValue()) {
                            tableLayout.getWidgetByName('papaersize_setup').setRowVisible(0, true);
                            tableLayout.getWidgetByName('papaersize_setup').setRowVisible(1, false);
                        } else {
                            tableLayout.getWidgetByName('papaersize_setup').setRowVisible(0, false);
                            tableLayout.getWidgetByName('papaersize_setup').setRowVisible(1, true);
                        }
                        tableLayout.getWidgetByName('papaersize_setup').doLayout();
                        widget_customed.setValue(result.customed);
                        widget_portrait.setValue(result.portrait);
                        widget_landscape.setValue(result.landscape);
                        widget_paperSize.setValue(result.paperSize);
                        widget_user_width.setValue(result.user_width);
                        widget_user_height.setValue(result.user_height);
                        widget_margin_top.setValue(result.margin_top);
                        widget_margin_bottom.setValue(result.margin_bottom);
                        widget_margin_left.setValue(result.margin_left);
                        widget_margin_right.setValue(result.margin_right);
                    }
                }
            });
            o.onOK = function () {
                FR.ajax({
                    url: FR.servletURL,
                    type: 'POST',
                    data: {
                        op: 'fr_dialog',
                        cmd: 'change_page_setup',
                        sessionID: sessionID,
                        reportIndex: reportIndex,
                        predefined: widget_predefined.getValue(),
                        customed: widget_customed.getValue(),
                        portrait: widget_portrait.getValue(),
                        landscape: widget_landscape.getValue(),
                        paperSize: widget_paperSize.getValue(),
                        user_width: widget_user_width.getValue(),
                        user_height: widget_user_height.getValue(),
                        margin_top: widget_margin_top.getValue(),
                        margin_bottom: widget_margin_bottom.getValue(),
                        margin_left: widget_margin_left.getValue(),
                        margin_right: widget_margin_right.getValue()
                    },
                    complete: function () {
                        FR.closeDialog();
                    }
                });
            };
            o.contentWidget = {
                type: 'border',
                items: [
                    {region: 'north', el: $('<div>'), height: northHeight},
                    {region: 'center', el: tableLayout.element}
                ]
            };
            FR.showUpdateDialog(o);
        },

        _sheetPositionPane: function () {
            return "bottom";
        },

        _initSheetTabPane: function ($contentPane, sheetsO, bg) {
            var sheetPosition = this._sheetPositionPane();
            var writeTab = new FR.TabPane({
                background: bg,
                items: sheetsO,
                tabPosition: sheetPosition,
                renderEl: $contentPane
            });
            $contentPane.data("TabPane", writeTab);
        },

        _initParameterFormPane: function () {
            return $("<div>").appendTo(this.element).addClass("parameter-container");
        },

        _createFormParameterPane: function (options, layout) {
            var collapsePaneHeight = 8;
            options.alignLayoutName = '__layout4align__';
            var self = this, paramO = options.param;
            var config = paramO.html;
            self.scrollHeight = 6;
            //maxWidth 7.1paramO.width, web
            var maxWidth = 0, maxHeight = 0;
            for (var i = 0; i < config.items.length; i++) {
                var item = config.items[i];
                maxWidth = Math.max(maxWidth, item.x + item.width);
                maxHeight = Math.max(maxHeight, item.y + item.height);
            }
            var deltaHeight = paramO.height - maxHeight;
            var formLayout;
            var barHeight = paramO.width > document.body.offsetWidth ? self.scrollHeight : 0;
            var $paraContainer = $("<div class='parameter-container' style='overflow: auto;'>").css({
                'height': paramO.height + barHeight + collapsePaneHeight,
                'width': document.body.offsetWidth
            });
            FR.parameterContainerHeight = paramO.height + barHeight + collapsePaneHeight;
            options.$paraContainer = $paraContainer;
            config.onCalculate = function (currentMaxHeight) {
                if ($.isFunction(options.onCalculate)) {
                    options.onCalculate.call(this, currentMaxHeight + deltaHeight, collapsePaneHeight, $paraContainer);
                }
            };
            var $expandEl = $("<div class='parameter-container-collapseimg-up' style='cursor: pointer'></div>").click(function () {
                var resizeTime = new Date();
                self.lastResizeTime = resizeTime;
                setTimeout(function () {
                    if (resizeTime == self.lastResizeTime) {
                        delete self.lastResizeTime;
                        $paraContainer.animate({
                            height: (self.hasCollapsed ? "+=" : "-=") + paramO.height
                        }, "fast", function () {
                            if (self.hasCollapsed) {
                                FR.parameterContainerHeight += paramO.height;
                            }
                            else {
                                FR.parameterContainerHeight -= paramO.height;
                            }
                            self.hasCollapsed = !self.hasCollapsed;
                            $expandEl.switchClass('parameter-container-collapseimg-down', 'parameter-container-collapseimg-up');
                            if ($.isFunction(options.onCollapse)) {
                                options.onCollapse.call(this, self.hasCollapsed, options.alignLayoutName, $paraContainer.height());
                                self.doAfterCollapse();
                            }
                        });
                    }
                }, 222);
            });

            var alignment = 'left';
            switch (paramO.alignLocation) {
                case 0 :
                    alignment = 'left';
                    break;
                case 1 :
                    alignment = 'center';
                    break;
                case 2 :
                    alignment = 'right';
                    break;
                default :
                    alignment = 'left';
            }
            var $center = $('<div class="pmeter-container"></div>').css({
                "height": paramO.height,
                "width": paramO.width
            });
            //
            var paraConfig = {
                renderEl: $paraContainer,
                type: 'border',
                items: [
                    {
                        region: 'south', height: collapsePaneHeight, el: {
                        type: 'horizontal',
                        items: [
                            {el: $expandEl, width: 120}
                        ]
                    }
                    },
                    {
                        region: 'center', el: {
                        type: 'para_horizontal',
                        width: paramO.width,
                        minWidth: paramO.width,
                        widgetName: options.alignLayoutName,
                        alignment: alignment,
                        items: [
                            {el: $center, width: maxWidth}
                        ]
                    }
                    }
                ]
            };
            this._setBackground(paramO, $paraContainer);
            if (paramO.showType === 1) {
                layout.push({
                    region: 'north',
                    el: paraConfig,
                    height: paramO.height + collapsePaneHeight + barHeight
                });
            }
            if (paramO.showType === 0) {
                $paraContainer.css({
                    position: "absolute",
                    width: paramO.width,
                    height: paramO.height
                }).appendTo("body");
                config.listeners = [
                    {
                        once: true,
                        eventName: 'submitcomplete',
                        action: function () {
                            FR.closeDialog();
                        }
                    }
                ];
                config.renderEl = $paraContainer;
                formLayout = new FR.contentForm(config);
            } else {
                config.renderEl = $center;
                config.container = $paraContainer;
                formLayout = new FR.contentForm(config);
            }
            if (paramO.showType === 0) {
                formLayout.doLayout();
                FR.showDialog({
                    title: paramO.paramWindowTitle,
                    width: paramO.width + 20,
                    height: paramO.height + 45,
                    contentHtml: $paraContainer
                });
            }
            return formLayout;
        },

        _setBackground: function (paramO, $dom) {
            var bg = paramO.parambg;
            if (bg != null) {
                FR.setBackground($dom, bg);
            }
        },

        doAfterCollapse: function () {
        },

        afterLoad: function () {

        },

        /**
         * 
         *
         *     @example
         *     contentPane.parameterCommit();
         *
         * @param {Object} reloadOthers 
         */
        parameterCommit: function (reloadOthers) {
            if ($.isFunction(this.parameterEl.formSubmit)) {
                this.parameterEl.formSubmit({
                    url: FR.servletURL
                    + "?op=fr_dialog&cmd=parameters_d&sessionID="
                    + _g().currentSessionID,
                    callback: function () {
                        _g().loadContentPane(reloadOthers);
                    }
                });
            }
        },

        /**
         * 
         *
         *     @example
         *     contentPane.makeHighlight('red', 'click');
         *
         * @param {String} color 
         * @param {'click'/'mouseover'} [op='click'] 
         * @param deep td
         */
        makeHighlight: function (color, op, deep) {
            var self = this;
            if (!op) {
                op = 'click';
            }
            var container = $('div.content-container');
            var tr = $("tr", container);
            var changeTds = function (currentTR, lastTDColors) {
                var tds = currentTR.children();
                for (var i = 0; i < tds.length; i++) {
                    var td = tds.eq(i);
                    lastTDColors.push(td[0].style.backgroundColor);
                    td[0].style.backgroundColor = color;
                }
            };
            var highLightFun = function (e) {
                if (!$(e.target).is("td")) {
                    return;
                }
                var currentTR = $(e.target).parent();
                if ($(e.target).attr("hv")) {
                    // marro:,PageCellWriter.getValueWrapper
                    currentTR = currentTR.closest("td").parent();
                }
                if (lastSelectedTR != null) {
                    if (deep === true) {
                        var tds = lastSelectedTR.children();
                        for (var i = 0; i < tds.length; i++) {
                            var td = tds.eq(i);
                            td[0].style.backgroundColor = lastTDColors[i] == "" ? "White" : lastTDColors[i];
                        }
                        lastTDColors.length = 0;
                        if (currentTR[0] != lastSelectedTR[0]) {
                            changeTds(currentTR, lastTDColors);
                            lastSelectedTR = currentTR;
                            return;
                        }
                    } else {
                        lastSelectedTR[0].style.backgroundColor = 'White';
                        if (currentTR[0] != lastSelectedTR[0]) {
                            currentTR[0].style.backgroundColor = (currentTR[0].style.backgroundColor == color
                                ? 'White'
                                : color);
                            lastSelectedTR = currentTR;
                            return;
                        }
                    }
                    lastSelectedTR = null;
                    return;
                }
                lastSelectedTR = currentTR;

                if (deep === true) {
                    changeTds(currentTR, lastTDColors);
                } else {
                    currentTR[0].style.backgroundColor = (currentTR[0].style.backgroundColor == color
                        ? 'White'
                        : color);
                }
            };

            var lastSelectedTR = null;
            var lastTDColors = [];
            var action = op.indexOf('over') != -1 ? "mouseover" : "click";
            if (window.highfun != null) {
                container.unbind(action, window.highfun);
            }
            window.highfun = function (e) {
                highLightFun(e);
            };
            container.bind(action, window.highfun);
        },

        initContentPane: function () {
            var events = FR.Report.Plugin.Panel.Events;
            if ($.isArray(events)) {
                for (var i = 0, len = events.length; i < len; i++) {
                    var evt = events[i];
                    this.on(evt.name, evt.action.createDelegate(this));
                }
            }
        },

        pdfPrint: function (isPopup) {
            if (this.fireEvent(FR.Events.BPDFPRINT) === false) {
                return;
            }
            if (FR.Browser.isIE()) {
                FR.doPDFPrint(this.currentSessionID, isPopup);
            } else {
                // jamespdfPrintformat=pdfPrint
                window.open(FR.servletURL + "?op=fr_pdfprint&cmd=native&sessionID=" + this.currentSessionID, "_blank");
                this.fireEvent(FR.Events.APDFPRINT);
            }
        },
        //wei:pc
        setAppearRefresh: function () {

        },
        /**
         * sheetsheet
         * @param index sheet
         */
        loadSheetByIndex: function (index) {
            var $contentPane = $("div.content-container");
            if (index && $contentPane && $contentPane.data && $contentPane.data('TabPane')) {
                $contentPane.data('TabPane').selectTabAt(index);
            }
        },
        /**
         * sheetsheet
         * @param sheetName sheet
         */
        loadSheetByName: function (sheetName) {
            var $contentPane = $("div.content-container");
            if (sheetName && $contentPane && $contentPane.data && $contentPane.data('TabPane')) {
                $contentPane.data('TabPane').selectTabByName(sheetName);
            }
        },
        /**
         * 
         * @param url 
         */
        downloadExportFile: function (url, type) {
            //
            if (FR.Report.Plugin.XHR2FileSaveProcessor.item && FR.Plugin.validLevel(FR.Report.Plugin.XHR2FileSaveProcessor, FR.Report.Plugin.XHR2FileSaveProcessor.item)) {
                FR.Report.Plugin.XHR2FileSaveProcessor.item.action.call(this, url, type);
                return;
            }
            if(FR.Browser.r.gecko){
                //window.locationgif
                var form = $("<form>");
                form.attr({"style": "display : none", "target": "", "method": "post", "action": url});
                var input = $("<input>");
                $("body").append(form);
                form.append(input);
                form.submit();
                form.remove();
            }else{
                window.location = url;
            }
            FR.progressBar.call(this, this.currentSessionID, type);
        },
        createProgressBar : function(){
            if($('#progressBar').length <= 0){
                var progressBar = $('<div id = '+'\"'+'progressBar'+'\"'+'>'+'</div>').appendTo("body");
                var tips = $('<div>'+FR.i18nText("FR-Engine_Exporting")+'...'+'</div>').appendTo($('#progressBar'));
                var $maskDiv = $('<div id="transparent_mask" style="position:absolute;filter:alpha(opacity=50);opacity:0.5;"></div>');
                $maskDiv.css('left', "0px").css('top', "0px").css('width', "100%").css('height', "100%").css('z-index', 2001).appendTo("body");
                progressBar.addClass("progressBar");
                tips.addClass("progressBarTips");
            }
        },
        removeProgressBar : function(){
            $('#progressBar').remove();
            while(document.getElementById("transparent_mask")){
                document.getElementById("transparent_mask").remove();
            }
        }
    });
})(jQuery);
(function(){$.extend(FR,{InsertMsg:function(d,e){var b=d.messagetype;var f=b;if(b==="alert_toast"||b==="remind_toast"){f="system_toast"}var c=e.options.form;var a=c?c.collectionValue():{};FR.ajax({url:FR.servletURL,async:true,type:"POST",data:{op:f,cmd:"save_message",message:d,sessionID:FR.SessionMgr.getSessionID(),__parameters__:a},complete:function(g){var h=FR.jsonDecode(g.responseText);if(!h.isLogin){FR.Msg.toast(FR.Msg.toast(FR.i18nText("FR-Plugin-Template_Message_Not_Login")));return}if(h.sendState){FR.Msg.toast(FR.i18nText("FR-Plugin-Template_Message_Send_Success"))
}else{FR.Msg.toast(FR.i18nText("FR-Plugin-Template_Message_Send_Failed"))}}})}})}());
(function($){var $PrintDiv,$PDFReader,$flashIframe,$appletDiv,showFlashPrintSetting,fitPaper,showAppletPrintSetting=null;var appletJarName="/fr-applet-8.0.jar";function isShowFlashPrintSetting(){if(typeof showFlashPrintSetting!="boolean"){$(function(){FR.ajax({url:FR.servletURL,data:{op:"flash_print",cmd:"get_fp_setting"},async:false,complete:function(res,status){if(status=="success"){showFlashPrintSetting=res.responseText=="true"}}})})}return showFlashPrintSetting}function isPrintAsPPAPI(){var isPPAPI=false;
var type="application/x-shockwave-flash";var mimeTypes=navigator.mimeTypes;var endsWith=function(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1};if(mimeTypes&&mimeTypes[type]&&mimeTypes[type].enabledPlugin&&(mimeTypes[type].enabledPlugin.filename==="pepflashplayer.dll"||mimeTypes[type].enabledPlugin.filename==="libpepflashplayer.so"||mimeTypes[type].enabledPlugin.filename=="PepperFlashPlayer.plugin"||endsWith(mimeTypes[type].enabledPlugin.filename,"Chrome.plugin"))){isPPAPI=true
}return isPPAPI}function isFitPaper(){if(!fitPaper){$(function(){FR.ajax({url:FR.servletURL,data:{op:"flash_print",cmd:"fit_fs_paper"},async:false,complete:function(res,status){if(status=="success"){fitPaper=res.responseText=="true"}}})})}return fitPaper}function supportPDFPrint(){return FR.Browser.isIE()}function supportCodebase(){return FR.Browser.isIE()}function isShowAppletPrintSetting(){if(typeof showAppletPrintSetting!="boolean"){$(function(){FR.ajax({url:FR.servletURL,data:{op:"fr_applet",cmd:"applet_print_setting"},async:false,complete:function(res,status){if(status=="success"){showAppletPrintSetting=res.responseText=="true"
}}})})}return showAppletPrintSetting}function isAppletPrintOver(sessionID){var appletPrintOver;FR.ajax({url:FR.servletURL,data:{op:"fr_applet",cmd:"is_printover",sessionID:sessionID,data:new Date().getTime()},async:false,complete:function(res,status){if(status=="success"){appletPrintOver=res.responseText=="true"}}});return appletPrintOver}function isSingleSheetFunc(sessionID){var isSingleSheet;FR.ajax({url:FR.servletURL,data:{op:"fr_applet",cmd:"is_singleSheet",sessionID:sessionID},async:false,complete:function(res,status){if(status=="success"){isSingleSheet=res.responseText=="true"
}}});return isSingleSheet}function checkPDFPrint(sessionID,popupSetup){FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_pdfprint",cmd:"pt_check",sessionID:sessionID},complete:function(res,status){var resText=res.responseText;if("ok"==resText){(function(){FR.closeDialog();if(popupSetup===true){$PDFReader[0].print()}else{$PDFReader[0].printAllFit(true)}if(_g()){_g().fireEvent("afterpdfprint")}}).defer(2000)}else{if("gening"==resText){checkPDFPrint.defer(300,this,[sessionID,popupSetup])}else{FR.Msg.toast(resText)
}}}})}function __getSessionID__(opts){var config={};if(arguments.length===1){config=arguments[0]}else{if(arguments.length===2){config.url=arguments[0];$.extend(config,arguments[1])}}var sessionID=null;var udata;config.url=config.url.replace("op=","op_=");if(config&&config.form){var $form=$(config.form);udata=$.param($form.serializeArray().concat([{name:"op",value:"getSessionID"}]))}else{if(config&&config["formid"]){$form=$("#"+config["formid"]);udata=$.param($form.serializeArray().concat([{name:"op",value:"getSessionID"}]))
}else{if(config&&config.data){udata=$.extend({op:"getSessionID"},config.data)}else{udata={op:"getSessionID"}}}}FR.ajax({url:config.url,type:"POST",data:udata,async:false,complete:function(res,status){if(status=="success"){sessionID=res.responseText}}});return sessionID}$.extend(FR,{doPDFPrint:function(sessionID,popupSetup){var isShowDialog=false;FR.ajax({url:FR.servletURL,data:{op:"fr_pdfprint",cmd:"pdf_print_setting"},type:"POST",async:false,complete:function(res,status){isShowDialog=res.responseText==="true"
}});var config={"url":FR.servletURL+"?sessionID="+sessionID,"isPopUp":isShowDialog};FR.doURLPDFPrint(config)},doURLPDFPrint:function(config){var url=arguments[0];var isPopUp;if(typeof url=="string"){isPopUp=arguments[1];config=arguments[2]}else{url=config.url;isPopUp=config.isPopUp}var sessionID=__getSessionID__(url,config);if(!supportPDFPrint()){window.open(FR.servletURL+"?op=fr_pdfprint&cmd=native&sessionID="+sessionID,"_blank");return}if(FR.Report.Plugin.Print.pdfURLPrint){FR.Report.Plugin.Print.pdfURLPrint(sessionID);
return}if($PrintDiv==null){$PrintDiv=$("<div>").appendTo("body")}FR.showDialog(FR.i18nText("FR-Engine_Printing"),250,100,FR.i18nText("FR-Engine-Loading_Component")+"...");FR.ajax({url:FR.servletURL,data:{sessionID:sessionID,op:"fr_pdfprint",cmd:"pt_print",frandom:Math.random()},type:"POST",complete:function(res,status){if(status=="success"){var resText=res.responseText;if(resText=="timeout"){FR.closeDialog();return}$PrintDiv[0].innerHTML=res.responseText;$PDFReader=$PrintDiv.find("Object");try{$PDFReader[0].gotoFirstPage();
FR.showDialog(FR.i18nText("FR-Engine_Printing"),250,100,FR.i18nText("FR-Engine-Loading_PDF")+"...");checkPDFPrint.defer(300,this,[sessionID,isPopUp])}catch(e){var content='<div style="text-align:center;">'+FR.i18nText("FR-Engine_Please_Install")+' <a href="http://www.adobe.com/products/reader/" target="_blank">Adobe Reader</a>.'+"</div>";FR.showDialog(FR.i18nText("FR-Engine_Alert"),200,80,content)}}}})},doURLAppletPrint:function(config){var url=arguments[0];var isShowDialog;var pageIndex;var loadJVM;
var printerName;var choosePrinter;var copies;if(typeof url=="string"){isShowDialog=arguments[1];if(isShowDialog==undefined||!(typeof isShowDialog=="boolean")){isShowDialog=isShowAppletPrintSetting()}config=arguments[2]}else{url=config.url;isShowDialog=config.isPopUp;pageIndex=config.pageIndex;loadJVM=config.loadJVM;choosePrinter=config.choosePrinter;printerName=config.printerName;copies=config.copies?config.copies:1;if(isShowDialog==undefined||!(typeof isShowDialog=="boolean")){isShowDialog=isShowAppletPrintSetting()
}}var index=0;var isIE9=FR.Browser.isIE9();if(isShowDialog){var dialog=new FR.Dialog({title:FR.i18nText("FR-Engine_Setting"),confirm:true,resizeable:false,width:450,height:190,contentWidget:{type:"tablelayout",columnSize:[20,100,155,150],rowSize:[10,20,20,20],vgap:10,items:[[{el:$("<div>")}],[{el:$("<div>")},{el:{type:"radio",widgetName:"All_Pages",text:FR.i18nText("HJS-All_Pages"),selected:true,fontSize:12,fontFamily:"SimSun",listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(this.isSelected()){dialog.getWidgetByName("Specified_Pages").setSelected(false)
}}}]}},{el:$("<div>")},{el:$("<div>")}],[{el:$("<div>")},{el:{type:"radio",widgetName:"Specified_Pages",text:FR.i18nText("HJS-Specified_Pages")+":",fontSize:12,fontFamily:"SimSun",listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(this.isSelected()){dialog.getWidgetByName("All_Pages").setSelected(false)}}}]}},{el:{type:"text",width:"155px",fontSize:12,fontFamily:"SimSun",widgetName:"CurrentPageNum",value:"1-1"}},{el:{type:"label",fontsize:12,fontFamily:"SimSun",textalign:"right",value:"("+FR.i18nText("FR-Engine_Example")+": 2,5,7-10,12)"}}],[{el:$("<div>")},{el:{type:"label",value:FR.i18nText("FR-Engine_Print_Copy")+": ",fontSize:12,fontFamily:"SimSun",textalign:"left"}},{el:{type:"text",width:"155px",fontSize:12,fontFamily:"SimSun",widgetName:"Copies_txt",value:"1"}}]]},onOK:function(){FR.closeDialog();
if(dialog.getWidgetByName("Specified_Pages").isSelected()){index=dialog.getWidgetByName("CurrentPageNum").getValue()}copies=dialog.getWidgetByName("Copies_txt").getValue();if($appletDiv==null){$appletDiv=$("<div>").appendTo("body")}var sessionID=__getSessionID__(url,config);if(url.indexOf("reportlet")!=-1||url.indexOf("resultlets")!=-1||(config&&config.data&&config.data.reportlets)){if(url.indexOf("?")!=-1){url+="&_="+new Date().getTime()}else{url+="?_="+new Date().getTime()}var sessionID=__getSessionID__(url,config);
url=FR.servletURL+"?sessionID="+sessionID}var isSingleSheet=isSingleSheetFunc(sessionID);var attributes=null;var parameters=null;if(supportCodebase()){attributes={codebase:FR.server+"/jre.exe"};parameters={code:"com.fr.print.PrintApplet",archive:FR.server+appletJarName,url:FR.serverURL+url+"&op=fr_applet&cmd=print",isIE9:isIE9,isShowDialog:isShowDialog||choosePrinter,printerName:printerName,index:index,copies:copies,isSingleSheet:isSingleSheet}}else{attributes={code:"com.fr.print.PrintApplet.class",archive:FR.server+appletJarName,width:0,height:0};
parameters={url:FR.serverURL+url+"&op=fr_applet&cmd=print",isIE9:isIE9,isShowDialog:isShowDialog||choosePrinter,printerName:printerName,index:index,copies:copies,isSingleSheet:isSingleSheet}}deployJava.runApplet(attributes,parameters,"1.4");FR.closeDialog();var isOverFunc=function(){if(!isAppletPrintOver(sessionID)){return}clearInterval(sh);if(_g()){_g().fireEvent("afterappletprint")}$("applet").remove()};var sh=setInterval(isOverFunc,3000)},onCancel:function(){index=0;FR.closeDialog()}});dialog.setVisible(true)
}else{if(pageIndex!=undefined&&(typeof pageIndex=="number")){index=pageIndex}var sessionID=__getSessionID__(url,config);if(url.indexOf("reportlet")!=-1||url.indexOf("resultlets")!=-1||(config&&config.data&&config.data.reportlets)){if(url.indexOf("?")!=-1){url+="&_="+new Date().getTime()}else{url+="?_="+new Date().getTime()}var sessionID=__getSessionID__(url,config);url=FR.servletURL+"?sessionID="+sessionID}var isSingleSheet=isSingleSheetFunc(sessionID);if(supportCodebase()){attributes={codebase:FR.server+"/jre.exe"};
parameters={code:"com.fr.print.PrintApplet",archive:FR.server+appletJarName,url:FR.serverURL+url+"&op=fr_applet&cmd=print",isIE9:isIE9,isShowDialog:isShowDialog,printerName:printerName,index:index,isSingleSheet:isSingleSheet}}else{var attributes={code:"com.fr.print.PrintApplet.class",archive:FR.server+appletJarName,width:0,height:0};var parameters={url:FR.serverURL+url+"&op=fr_applet&cmd=print",isIE9:isIE9,index:index,isShowDialog:isShowDialog,printerName:printerName,isSingleSheet:isSingleSheet,copies:copies}
}deployJava.runApplet(attributes,parameters,"1.4");FR.closeDialog();var isOverFunc=function(){if(!isAppletPrintOver(sessionID)){return}clearInterval(sh);if(_g()){_g().fireEvent("afterappletprint")}$("applet").remove()};var sh=setInterval(isOverFunc,3000)}},doAppletPrint:function(sessionID,choosePrinter,printerName){var url=FR.servletURL+"?sessionID="+sessionID;if(_g().fireEvent("beforeappletprint")===false){return}var config={"url":url,"choosePrinter":choosePrinter,"printerName":printerName};FR.doURLAppletPrint(config)
},doFlashPrint:function(sessionID,currentPageIndex){if(_g().fireEvent("beforeflashprint")===false){return}var fitPaper=isFitPaper();FR.doPrintURL(FR.servletURL+"?sessionID="+sessionID,currentPageIndex,fitPaper)},doPrintURL:function(url,currentPageIndex,fitPaper,config){var config=arguments[3];if(config==undefined){config={"url":url,"pageIndex":currentPageIndex,"isAutoZoom":fitPaper}}FR.doURLFlashPrint(config)},isInstalledFlash:function(){if(this.$i_flash===true){return true}var i_flash=false;var n=navigator;
if(n.plugins&&n.plugins.length){for(var ii=0;ii<n.plugins.length;ii++){if(n.plugins[ii]&&n.plugins[ii].name.indexOf("Shockwave Flash")!=-1){i_flash=true;break}}}else{if(window.ActiveXObject){for(var ii=11;ii>=2;ii--){try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){i_flash=true;break}}catch(e){}}}}this.$i_flash=i_flash;return i_flash},flashInstall:function(){var content;FR.ajax({type:"POST",url:FR.servletURL+"?op=flash_print&cmd=get_fp_installpath",complete:function(res,status){if(status=="success"){var path=res.responseText;
if(typeof path=="string"&&path.length>0&&path.length<150){content='<div style="text-align:center;">'+FR.i18nText("FR-Engine_Please_Install")+' <a href="'+path+'">FlashPlayer</a>.'+FR.i18nText("FR-Engine_Restart_Browser_After_Installation")+"</div>"}}if(!content){content='<div style="text-align:center;">'+FR.i18nText("FR-Engine_Please_Install")+' <a href="http://get.adobe.com/flashplayer/" target="_blank">FlashPlayer</a>.'+FR.i18nText("FR-Engine_Restart_Browser_After_Installation")+"</div>"}FR.showDialog(FR.i18nText("FR-Engine_Alert"),305,75,content)
}})},doURLFlashPrint:function(config){var url=arguments[0];var currentPageIndex;var isShowDialog;var isAutoZoom;if(typeof url=="string"){isShowDialog=arguments[1];isAutoZoom=isFitPaper();if(isShowDialog==undefined||!(typeof isShowDialog=="boolean")){isShowDialog=isShowFlashPrintSetting()}config=arguments[2]}else{url=config.url;currentPageIndex=config.pageIndex;isShowDialog=config.isPopUp;isAutoZoom=config.isAutoZoom;if(isShowDialog==undefined||!(typeof isShowDialog=="boolean")){isShowDialog=isShowFlashPrintSetting()
}if(isAutoZoom==undefined||!(typeof isAutoZoom=="boolean")){isAutoZoom=isFitPaper()}}if(FR.isInstalledFlash()===true){if($flashIframe==null){FR.__flash__=function(){FR.doPrintURL.call(this,url,currentPageIndex,isAutoZoom,config);delete FR.__flash__};$flashIframe=$("<iframe>").css({position:"absolute",left:-1000,top:-1000}).attr("src",FR.servletURL+"?op=resource&resource=/com/fr/web/core/printer.html").appendTo("body")}else{var checkVersion=FR.Browser.isIE()&&(FR.Browser.isIE8Before()||!$.support.boxModel);
var fm=checkVersion?$flashIframe[0].contentWindow["flashMovie"]:$flashIframe[0].contentDocument["flashMovie"];if(fm!=null&&fm.doLoadFlash!=null){var servletURL=url.split("?")[0];currentPageIndex=currentPageIndex||1;var sessionID=__getSessionID__(url,config);var isPPAPIPrint=isPrintAsPPAPI();FR.ajax({type:"POST",url:servletURL,data:{sessionID:sessionID,op:"flash_print",cmd:"get_fp_pageinfo"},complete:function(res,status){if(!FR.versionRemind(res.responseText)){return}var message_array=res.responseText.split("?");
var info_array=message_array[0].split(";");if(info_array[0].indexOf("FAILPASS")!=-1){FR.Msg.toast(FR.i18nText("FR-Engine-Flash_Print_Not_Support"));return}var init_page_setting="1-"+info_array[0];var offset=message_array.length>1?message_array[1].split(";"):["0.0","0.0"];var print_fn=function(page_setting,isAutoZoom,paperinfo,isPrintAsImage,isPPAPIPrint){FR.showDialog(FR.i18nText("FR-Engine_Print"),250,100,FR.i18nText("FR-Engine_Start_Print")+"...");fm.doLoadFlash(servletURL,sessionID+"&id="+(new Date().getTime()),FR.string2ints(page_setting).join(","),isAutoZoom,paperinfo,isPrintAsImage,isPPAPIPrint);
$flashIframe=null;if(_g()){_g().fireEvent("afterflashprint")}};if(isShowDialog){var dialog=new FR.Dialog({title:FR.i18nText("FR-Engine_Setting"),confirm:true,resizeable:false,width:450,height:280,contentWidget:{type:"border",width:420,height:240,items:[{region:"north",el:{type:"tablelayout",columnSize:[20,100,155,150],rowSize:[10,20,20,20],height:120,vgap:10,items:[[{el:$("<div>")}],[{el:$("<div>")},{el:{type:"radio",fontSize:12,fontFamily:"SimSun",widgetName:"All_Pages",text:FR.i18nText("HJS-All_Pages"),selected:true,only_be_selected:true,listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(this.isSelected()){dialog.getWidgetByName("Current_Page").setSelected(false);
dialog.getWidgetByName("Specified_Pages").setSelected(false)}}}]}},{el:$("<div>")},{el:$("<div>")}],[{el:$("<div>")},{el:{type:"radio",fontSize:12,fontFamily:"SimSun",widgetName:"Current_Page",text:FR.i18nText("HJS-Current_Page")+":",only_be_selected:true,listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(this.isSelected()){dialog.getWidgetByName("All_Pages").setSelected(false);dialog.getWidgetByName("Specified_Pages").setSelected(false)}}}]}},{el:{type:"label",fontsize:12,fontFamily:"SimSun",value:FR.i18nText("FR-Engine-Page_Number")+" "+FR.i18nText("FR-Engine_Is")+" "+currentPageIndex}},{el:$("<div>")}],[{el:$("<div>")},{el:{type:"radio",fontSize:12,fontFamily:"SimSun",widgetName:"Specified_Pages",text:FR.i18nText("HJS-Specified_Pages")+":",only_be_selected:true,listeners:[{eventName:FR.Events.STATECHANGE,action:function(){if(this.isSelected()){dialog.getWidgetByName("All_Pages").setSelected(false);
dialog.getWidgetByName("Current_Page").setSelected(false)}}}]}},{el:{type:"text",fontSize:12,fontFamily:"SimSun",widgetName:"SpecifiedPagesNum",value:"1-2"}},{el:{type:"label",fontsize:12,fontFamily:"SimSun",textalign:"right",value:"("+FR.i18nText("FR-Engine_Example")+" : 2,5,7-10,12)"}}]]}},{region:"center",el:{type:"tablelayout",columnSize:[16,300],rowSize:[20,20],vgap:0,items:[[{el:$("<div>")},{el:{type:"checkbox",fontSize:12,fontFamily:"SimSun",widgetName:"AsImage",text:FR.i18nText("FR-Engine-Print_As_Image"),selected:false,disabled:false}}],[{el:$("<div>")},{el:{type:"checkbox",widgetName:"FitPaperSize",fontSize:12,fontFamily:"SimSun",text:FR.i18nText("Print-Print_To_Fit_Paper_Size"),selected:isFitPaper(),disabled:false}}]]}},{region:"south",el:{type:"tablelayout",columnSize:[20,300],rowSize:[25],height:35,items:[[{el:$("<div>")},{el:{type:"label",fontsize:16,fontFamily:"SimSun",color:"red",value:FR.i18nText("FR-Engine-Print_Set_Printer_Offset")+": X="+offset[0]+"mm Y="+offset[1]+"mm"}}]]}}]},onOK:function(){FR.closeDialog();
if(dialog.getWidgetByName("Current_Page").isSelected()){init_page_setting=currentPageIndex+""}else{if(dialog.getWidgetByName("Specified_Pages").isSelected()){init_page_setting=dialog.getWidgetByName("SpecifiedPagesNum").getValue()}}var printAsImage=dialog.getWidgetByName("AsImage").isSelected();var isFit=dialog.getWidgetByName("FitPaperSize").isSelected();print_fn(init_page_setting,isFit,info_array[1]?info_array[1]:"",printAsImage,isPPAPIPrint)},onCancel:function(){FR.closeDialog()}});dialog.setVisible(true)
}else{print_fn(init_page_setting,isAutoZoom,info_array[1]?info_array[1]:"",false,isPPAPIPrint)}}})}else{FR.flashInstall()}}}else{FR.flashInstall()}}})})(jQuery);
var deployJava={debug:null,firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,getJavaURL:"http://java.sun.com/webapps/getjava/BrowserRedirect?host=java.com",appleRedirectPage:"http://www.apple.com/support/downloads/",oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:"http://java.sun.com/products/jfc/tsc/articles/swing2d/webstart.png",browserName:null,browserName2:null,getJREs:function(){var e=[];
if(deployJava.isPluginInstalled()){var d=deployJava.getPlugin();var a=d.jvms;for(var c=0;c<a.getLength();c++){e[c]=a.get(c).version}}else{var b=deployJava.getBrowser();if(b=="MSIE"){if(deployJava.testUsingActiveX("1.7.0")){e[0]="1.7.0"}else{if(deployJava.testUsingActiveX("1.6.0")){e[0]="1.6.0"}else{if(deployJava.testUsingActiveX("1.5.0")){e[0]="1.5.0"}else{if(deployJava.testUsingActiveX("1.4.2")){e[0]="1.4.2"}else{if(deployJava.testForMSVM()){e[0]="1.1"}}}}}}else{if(b=="Netscape Family"){deployJava.getJPIVersionUsingMimeType();
if(deployJava.firefoxJavaVersion!=null){e[0]=deployJava.firefoxJavaVersion}else{if(deployJava.testUsingMimeTypes("1.7")){e[0]="1.7.0"}else{if(deployJava.testUsingMimeTypes("1.6")){e[0]="1.6.0"}else{if(deployJava.testUsingMimeTypes("1.5")){e[0]="1.5.0"}else{if(deployJava.testUsingMimeTypes("1.4.2")){e[0]="1.4.2"}else{if(deployJava.browserName2=="Safari"){if(deployJava.testUsingPluginsArray("1.7.0")){e[0]="1.7.0"}else{if(deployJava.testUsingPluginsArray("1.6")){e[0]="1.6.0"}else{if(deployJava.testUsingPluginsArray("1.5")){e[0]="1.5.0"
}else{if(deployJava.testUsingPluginsArray("1.4.2")){e[0]="1.4.2"}}}}}}}}}}}}}if(deployJava.debug){for(var c=0;c<e.length;++c){alert("We claim to have detected Java SE "+e[c])}}return e},installJRE:function(b){var a=false;if(deployJava.isPluginInstalled()){if(deployJava.getPlugin().installJRE(b)){deployJava.refresh();if(deployJava.returnPage!=null){document.location=deployJava.returnPage}return true}else{return false}}else{return deployJava.installLatestJRE()}},installLatestJRE:function(){if(deployJava.isPluginInstalled()){if(deployJava.getPlugin().installLatestJRE()){deployJava.refresh();
if(deployJava.returnPage!=null){document.location=deployJava.returnPage}return true}else{return false}}else{var b=deployJava.getBrowser();var a=navigator.platform.toLowerCase();if((deployJava.EAInstallEnabled=="true")&&(a.indexOf("win")!=-1)&&(deployJava.EarlyAccessURL!=null)){deployJava.preInstallJREList=deployJava.getJREs();if(deployJava.returnPage!=null){deployJava.myInterval=setInterval("deployJava.poll()",3000)}location.href=deployJava.EarlyAccessURL;return false}else{if(b=="MSIE"){return deployJava.IEInstall()
}else{if((b=="Netscape Family")&&(a.indexOf("win32")!=-1)){return deployJava.FFInstall()}else{location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")}}return false}}},runApplet:function(b,f,d){if(d=="undefined"||d==null){d="1.1"}var e="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var a=d.match(e);if(deployJava.returnPage==null){deployJava.returnPage=document.location
}if(a!=null){var c=deployJava.getBrowser();if((c!="?")&&("Safari"!=deployJava.browserName2)){if(deployJava.versionCheck(d+"+")){deployJava.writeAppletTag(b,f)}else{if(b&&b.codebase){deployJava.writeAppletTag(b,f)}else{if(deployJava.installJRE(d+"+")){deployJava.refresh();location.href=document.location;deployJava.writeAppletTag(b,f)}}}}else{deployJava.writeAppletTag(b,f)}}else{if(deployJava.debug){alert("Invalid minimumVersion argument to runApplet():"+d)}}},writeAppletTag:function(a,f){deployJava.writePluginTag();
if($("applet").length>0){$("body").append($("applet"));return}if($("#AppletPrinter").length>0){$("#AppletPrinter").remove()}if(FR.Browser.isIE()){var h=[];var d="<"+"OBJECT ID='AppletPrinter' name='AppletPrinter' WIDTH='0' HEIGHT='0'"+" CLASSID='clsid:8AD9C840-044E-11D1-B3E9-00805F499D93'";var c=false;for(var e in a){d+=(" "+e+'="'+a[e]+'"')}d+=">";h[h.length]=d;if(f!="undefined"&&f!=null){for(var g in f){d='<param name="'+g+'" value="'+f[g]+'">';h[h.length]=d}}h[h.length]=("<"+"/"+"OBJECT"+">");
$("body").append(h.join(""))}else{var h=[];var d="<"+"applet ";var c=false;for(var e in a){d+=(" "+e+'="'+a[e]+'"');if(e=="code"){c=true}}if(!c){d+=(' code="dummy"')}d+=">";h[h.length]=d;if(f!="undefined"&&f!=null){var b=false;for(var g in f){if(g=="codebase_lookup"){b=true}d='<param name="'+g+'" value="'+f[g]+'">';h[h.length]=d}if(!b){h[h.length]=('<param name="codebase_lookup" value="false">')}}h[h.length]=("<"+"/"+"applet"+">");$("body").append(h.join(""))}},versionCheck:function(h){var c=0;var f="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";
var a=h.match(f);if(a!=null){var e=true;var b=[];for(var d=1;d<a.length;++d){if((typeof a[d]=="string")&&(a[d]!="")){b[c]=a[d];c++}}if(b[b.length-1]=="+"){e=false;b.length--}else{if(b[b.length-1]=="*"){b.length--}}var g=deployJava.getJREs();for(var d=0;d<g.length;++d){if(deployJava.compareVersionToPattern(g[d],b,e)){return true}}return false}else{alert("Invalid versionPattern passed to versionCheck: "+h);return false}},isWebStartInstalled:function(d){var c=deployJava.getBrowser();if((c=="?")||("Safari"==deployJava.browserName2)){return true
}if(d=="undefined"||d==null){d="1.4.2"}var b=false;var e="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var a=d.match(e);if(a!=null){b=deployJava.versionCheck(d+"+")}else{if(deployJava.debug){alert("Invalid minimumVersion argument to isWebStartInstalled(): "+d)}b=deployJava.versionCheck("1.4.2+")}return b},getJPIVersionUsingMimeType:function(){for(var b=0;b<navigator.mimeTypes.length;++b){var c=navigator.mimeTypes[b].type;var a=c.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(a!=null){deployJava.firefoxJavaVersion=a[1];
if("Opera"!=deployJava.browserName2){break}}}},launchWebStartApplication:function(a){return false},createWebStartLaunchButtonEx:function(c,b){if(deployJava.returnPage==null){deployJava.returnPage=c}var a="javascript:deployJava.launchWebStartApplication('"+c+"');";document.write("<"+'a href="'+a+"\" onMouseOver=\"window.status=''; "+'return true;"><'+"img "+'src="'+deployJava.launchButtonPNG+'" '+'border="0" /><'+"/"+"a"+">")},createWebStartLaunchButton:function(c,b){if(deployJava.returnPage==null){deployJava.returnPage=c
}var a="javascript:"+"if (!deployJava.isWebStartInstalled(&quot;"+b+"&quot;)) {"+"if (deployJava.installLatestJRE()) {"+"if (deployJava.launch(&quot;"+c+"&quot;)) {}"+"}"+"} else {"+"if (deployJava.launch(&quot;"+c+"&quot;)) {}"+"}";document.write("<"+'a href="'+a+"\" onMouseOver=\"window.status=''; "+'return true;"><'+"img "+'src="'+deployJava.launchButtonPNG+'" '+'border="0" /><'+"/"+"a"+">")},launch:function(a){document.location=a;return true},isPluginInstalled:function(){var a=deployJava.getPlugin();
if(a&&a.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(a){deployJava.installType=a;if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setInstallerType(a)}return false},setAdditionalPackages:function(a){if(deployJava.isPluginInstalled()){return deployJava.getPlugin().setAdditionalPackages(a)
}return false},setEarlyAccess:function(a){deployJava.EAInstallEnabled=a},isPlugin2:function(){if(deployJava.isPluginInstalled()){if(deployJava.versionCheck("1.6.0_10+")){try{return deployJava.getPlugin().isPlugin2()}catch(a){}}}return false},allowPlugin:function(){deployJava.getBrowser();var a=("Safari"!=deployJava.browserName2&&"Opera"!=deployJava.browserName2);return a},getPlugin:function(){deployJava.refresh();var a=null;if(deployJava.allowPlugin()){a=document.getElementById("deployJavaPlugin")
}return a},compareVersionToPattern:function(f,b,c){var g="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var h=f.match(g);if(h!=null){var e=0;var j=[];for(var d=1;d<h.length;++d){if((typeof h[d]=="string")&&(h[d]!="")){j[e]=h[d];e++}}var a=Math.min(j.length,b.length);if(c){for(var d=0;d<a;++d){if(j[d]!=b[d]){return false}}return true}else{for(var d=0;d<a;++d){if(j[d]<b[d]){return false}else{if(j[d]>b[d]){return true}}}return true}}else{return false}},getBrowser:function(){if(deployJava.browserName==null){var a=navigator.userAgent.toLowerCase();
if(deployJava.debug){alert("userAgent -> "+a)}if(a.indexOf("msie")!=-1){deployJava.browserName="MSIE";deployJava.browserName2="MSIE"}else{if(a.indexOf("firefox")!=-1){deployJava.browserName="Netscape Family";deployJava.browserName2="Firefox"}else{if(a.indexOf("chrome")!=-1){deployJava.browserName="Netscape Family";deployJava.browserName2="Chrome"}else{if(a.indexOf("safari")!=-1){deployJava.browserName="Netscape Family";deployJava.browserName2="Safari"}else{if(a.indexOf("mozilla")!=-1){deployJava.browserName="Netscape Family";
deployJava.browserName2="Other"}else{if(a.indexOf("opera")!=-1){deployJava.browserName="Netscape Family";deployJava.browserName2="Opera"}else{deployJava.browserName="?";deployJava.browserName2="unknown"}}}}}}if(deployJava.debug){alert("Detected browser name:"+deployJava.browserName+", "+deployJava.browserName2)}}return deployJava.browserName},testUsingActiveX:function(a){var c="JavaWebStart.isInstalled."+a+".0";if(!ActiveXObject){if(deployJava.debug){alert("Browser claims to be IE, but no ActiveXObject object?")
}return false}try{return(new ActiveXObject(c)!=null)}catch(b){return false}},testForMSVM:function(){var b="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var a=oClientCaps.getComponentVersion(b,"ComponentID");if((a=="")||(a=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(b){if(!navigator.mimeTypes){if(deployJava.debug){alert("Browser claims to be Netscape family, but no mimeTypes[] array?")}return false}for(var c=0;c<navigator.mimeTypes.length;
++c){s=navigator.mimeTypes[c].type;var a=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(a!=null){if(deployJava.compareVersions(a[1],b)){return true}}}return false},testUsingPluginsArray:function(b){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var a=navigator.platform.toLowerCase();for(var c=0;c<navigator.plugins.length;++c){s=navigator.plugins[c].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(deployJava.compareVersions("1.5.0",b)){return true
}}else{if(s.search(/^Java/)!=-1){if(a.indexOf("win")!=-1){if(deployJava.compareVersions("1.5.0",b)||deployJava.compareVersions("1.6.0",b)){return true}}}}}if(deployJava.compareVersions("1.5.0",b)){return true}return false},IEInstall:function(){location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")+((deployJava.installType!=null)?("&type="+deployJava.installType):"");
return false},done:function(b,a){},FFInstall:function(){location.href=deployJava.getJavaURL+((deployJava.returnPage!=null)?("&returnPage="+deployJava.returnPage):"")+((deployJava.locale!=null)?("&locale="+deployJava.locale):"")+((deployJava.brand!=null)?("&brand="+deployJava.brand):"")+((deployJava.installType!=null)?("&type="+deployJava.installType):"");return false},compareVersions:function(f,g){var d=f.split(".");var c=g.split(".");for(var e=0;e<d.length;++e){d[e]=Number(d[e])}for(var e=0;e<c.length;
++e){c[e]=Number(c[e])}if(d.length===2){d[2]=0}if(d[0]>c[0]){return true}if(d[0]<c[0]){return false}if(d[1]>c[1]){return true}if(d[1]<c[1]){return false}if(d[2]>c[2]){return true}if(d[2]<c[2]){return false}return true},enableAlerts:function(){deployJava.browserName=null;deployJava.debug=true},poll:function(){deployJava.refresh();var a=deployJava.getJREs();if((deployJava.preInstallJREList.length===0)&&(a.length!==0)){clearInterval(deployJava.myInterval);if(deployJava.returnPage!=null){location.href=deployJava.returnPage
}}if((deployJava.preInstallJREList.length!==0)&&(a.length!==0)&&(deployJava.preInstallJREList[0]!=a[0])){clearInterval(deployJava.myInterval);if(deployJava.returnPage!=null){location.href=deployJava.returnPage}}},writePluginTag:function(){if(deployJava.isWritePluginTag){return}deployJava.isWritePluginTag=true;var a=deployJava.getBrowser();if(a=="MSIE"){$("body").append("<"+'object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" '+'id="deployJavaPlugin" width="0" height="0">'+"<"+"/"+"object"+">")
}else{if(a=="Netscape Family"&&deployJava.allowPlugin()){deployJava.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var a=deployJava.getBrowser();if(a=="Netscape Family"&&deployJava.allowPlugin()){var b=document.getElementById("deployJavaPlugin");if(b==null){deployJava.writeEmbedTag()}}},writeEmbedTag:function(){var a=false;var c;if(navigator.mimeTypes!=null){for(var b=0;b<navigator.mimeTypes.length;b++){if(navigator.mimeTypes[b].type==deployJava.mimeType){if(navigator.mimeTypes[b].enabledPlugin){c=("<"+'embed id="deployJavaPlugin" type="'+deployJava.mimeType+'" hidden="true"/>');
a=true}}}if(!a){for(var b=0;b<navigator.mimeTypes.length;b++){if(navigator.mimeTypes[b].type==deployJava.oldMimeType){if(navigator.mimeTypes[b].enabledPlugin){c=("<"+'embed id="deployJavaPlugin" type="'+deployJava.oldMimeType+'" hidden="true" />')}}}}if(c){$("body").append(c)}}},do_initialize:function(){if(deployJava.locale==null){var b=null;if(b==null){try{b=navigator.userLanguage}catch(a){}}if(b==null){try{b=navigator.systemLanguage}catch(a){}}if(b==null){try{b=navigator.language}catch(a){}}if(b!=null){b.replace("-","_");
deployJava.locale=b}}}};deployJava.do_initialize();
FR.Report=FR.Report||{};FR.Report.Plugin=FR.Report.Plugin||{};FR.Report.Plugin.OpenOnNewTabpane={};FR.Report.Plugin.Panel=FR.Report.Plugin.Panel||{};FR.Report.Plugin.Panel.Events=[];FR.Report.Plugin.Print=FR.Report.Plugin.Print||{};FR.Report.Plugin.Write=FR.Report.Plugin.Write||{};FR.Report.Plugin.Fit=FR.Report.Plugin.Fit||{};FR.Report.Plugin.ScrollProcessor={version:1};FR.Report.Plugin.XHR2FileSaveProcessor={version:1};FR.Report.Plugin.Email=FR.Report.Plugin.Email||{};

(function(a){a.extend(jQuery.easing,{easeOutQuint:function(f,g,e,i,h){return i*((g=g/h-1)*g*g*g*g+1)+e}});a.fn.hScrollPane=function(b){b=a.extend(true,{},a.fn.hScrollPane.defaults,b);this.each(function(){var e=a(this),f=e.find(b.mover),d=e.width(),j=b.moverW||f.width(),i=(e.find(".hScrollPane_dragbar").length===0&&j>d)?e.append('<div class="hScrollPane_dragbar"><div class="hScrollPane_draghandle"></div></div>').find(".hScrollPane_dragbar"):e.find(".hScrollPane_dragbar"),h=i.find(".hScrollPane_draghandle");
if(b.showArrow){e.append('<a href="###" class="hScrollPane_leftarrow"></a><a href="###" class="hScrollPane_rightarrow"></a>');leftArrow=e.find(".hScrollPane_leftarrow");rightArrow=e.find(".hScrollPane_rightarrow");i.css({width:e.width()-leftArrow.outerWidth()*2,left:leftArrow.outerWidth()});leftArrow.unbind();rightArrow.unbind()}else{i.css("width",e.width())}f.stop().css("left","0px");h.css({top:b.top,height:parseInt(b.height)-2});e.unbind();h.unbind();i.unbind();h.stop().css({width:(d/j)*d>b.handleMinWidth?(d/j)*d:b.handleMinWidth,left:0});
if(j>d){i.show()}else{i.hide();return false}var g=parseInt(i.width())-parseInt(h.outerWidth());i.bind("click",function(k){var c=k.pageX>h.offset().left+h.outerWidth()?-1:1;a.fn.hScrollPane.move(b,f,h,d,j,g,c)});h.bind("mousedown",function(k){var c=k.pageX;var l=parseInt(h.css("left"));if(b.handleCssAlter){a(this).addClass(b.handleCssAlter)}a(document).bind("mousemove",function(n){var m=n.pageX-c+l<0?0:(n.pageX-c+l>=g?g:n.pageX-c+l);h.stop().css({left:m});if(b.easing){f.stop().animate({left:-m/g*(j-d)},{duration:1500,easing:"easeOutQuint",queue:false})
}else{f.css({left:-m/g*(j-d)})}return false});a(document).bind("mouseup",function(){if(b.handleCssAlter){h.removeClass(b.handleCssAlter)}a(this).unbind("mousemove")});return false}).click(function(){return false});if(b.dragable){f.bind("mousedown",function(k){var c=k.pageX;a(this).bind("mousemove",function(l){a.fn.hScrollPane.move(b,f,h,d,j,g,c,l.pageX);return false});a(document).bind("mouseup",function(){f.unbind("mousemove")})})}if(b.mousewheel.bind){e.bind("mousewheel",function(c,k){a.fn.hScrollPane.move(b,f,h,d,j,g,k);
return false})}if(b.showArrow){leftArrow.click(function(){a.fn.hScrollPane.move(b,f,h,d,j,g,1);return false}).focus(function(){this.blur()});rightArrow.click(function(){a.fn.hScrollPane.move(b,f,h,d,j,g,-1);return false}).focus(function(){this.blur()})}this.ondragstart=function(){return false};this.onselectstart=function(){return false}})};a.fn.hScrollPane.defaults={showArrow:false,handleMinWidth:0,dragable:true,easing:true,mousewheel:{bind:true,moveLength:300}};a.fn.hScrollPane.move=function(f,b,h,l,i,e,k,g){if(arguments.length===7){var d=parseInt(b.css("left"))+k*f.mousewheel.moveLength
}else{var d=parseInt(b.css("left"))+((g-k)/l)*(i-l)}d=d.toFixed(0);d=d>0?0:d<l-i?l-i:d;var j=(d/(l-i))*e;if(f.easing){b.stop().animate({left:d},{duration:1500,easing:"easeOutQuint",queue:false});h.stop().animate({left:j},{duration:1500,easing:"easeOutQuint",queue:false})}else{b.stop().animate({left:d},{duration:5,queue:false});h.css({left:j})}}})(jQuery);
FR.Form=FR.extend(FR.OB,{_init:function(){FR.Form.superclass._init.apply(this,arguments);this.name_widgets={};var b=this;var a=this.options.selector;if(typeof a=="string"){var c;$(a,this.options.renderEl).each(function(d,e){if(e.hasInit!==true){c=b.addWidget($(e));if(c.options.widgetName!=null){b.initLinkWidgetEvent(c)}}})}},addWidget:function(j){j[0].hasInit=true;var i=j.attr("widget");if(!i&&j.attr("widget-control")){var g=j.attr("idx");var a=j.attr("id");i=this.editConfig[g][a]}var h=FR.jsonDecode(i);
var f=j.attr("widgetWidth");f=f>0?f:j.attr("width");var e=j.attr("widgetHeight");e=e>0?e:j.attr("height");h.width=f;h.height=e;$.extend(h,{form:this});var b=$("<div/>").appendTo(j);h.renderEl=b;if(h["jspath"]){var d=h["jspath"].split(";");$.each(d,function(k,l){FR.$import(l,"js")})}if(h["csspath"]){var d=h["csspath"].split(";");$.each(d,function(k,l){FR.$import(l,"css")})}var c=FR.createWidget(h);return c},initLinkWidgetEvent:function(c){if(!c||!c.options){return}var a=c.options.dependence;var b=this;
if(FR.isArray(a)){$.each(a,function(d,f){var e=b.getWidgetByName(f);if(e!=null&&e!=c){if(!e.$linkWidget){e.$linkWidget={data:{},value:{}};e.on(FR.Events.AFTEREDIT,function(){b.fireWidgetValueChanged(e)})}e.$linkWidget["data"][c.options.widgetName]=c}})}},fireWidgetValueChanged:function(b){for(var a in b.$linkWidget["data"]){b.$linkWidget["data"][a].reset()}},getWidgetByName:function(a){if(!a){return null}if(a.startWith("$")){a=a.substring(1)}return this.name_widgets[a.toUpperCase()]},resolveVariable:function(a){var b;
if($.isFunction(this.options.resolveVariable)){b=this.options.resolveVariable(a)}var c;if(b==null){c=this.getWidgetByName(a);if(c==null){b=this._getValueByName(a)}else{b=c.getValue()}}return b},_getValueByName:function(c){var b=this.options.items;if(!c||!b){return null}var a=b.length;var e;if(c.startWith("$")){c=c.substring(1)}for(var d=0;d<a;d++){if(b[d].widgetName==c.toUpperCase()){var f=b[d];e=this._dealWithValueFormat(f);if(e){return e}}}},_dealWithValueFormat:function(c){if(!c){return null}var b;
b=c.value;if(b&&b.date_milliseconds){var a=b.date_milliseconds;if(c.format){return FR.contentFormat(b.date_milliseconds,"D"+c.format)}}return b},verify:function(){var a=true;for(var b in this.name_widgets){var c=this.name_widgets[b];if($.isFunction(c.isValidate)&&!c.isValidate()){FR.Msg.toast(c.errorMsg);a=false}}return a},collectionValue:function(c){var e={};for(var a in this.name_widgets){var b=this.name_widgets[a];if(!(b.options.needSubmit===true)){continue}if(b.options.widgetName){var d=b.getValue();
d=FR.encodePrecentPlus(d);if(d==undefined){d=null}e[b.options.widgetName.toUpperCase()]=d}}if(c){$.each(c,function(f,g){e[f]=g})}return FR.jsonEncode(e)},dbCommit:function(b,a){if(_g().saveReport){_g().saveReport((function(){this.formSubmit({url:FR.servletURL+"?op=dbcommit",data:{location:a?a.options.location:null,sheetNum:_g().selectedIndex,xmlconf:b.xmlconf,callback:b.callback,feedbackMap:b.feedbackMap,sessionID:_g().currentSessionID||_g().sessionID}})}).createDelegate(this))}else{this.formSubmit({url:FR.servletURL+"?op=dbcommit",data:{xmlconf:b.xmlconf,callback:b.callback,feedbackMap:b.feedbackMap,sessionID:_g().currentSessionID||_g().sessionID}})
}},formSubmit:function(){if(!this.verify()){if(this.QueryBtn){this.QueryBtn.enable()}return}if(_g()&&_g().options&&_g().options.type=="write"){_g().stopEditing();if(_g().isDirtyPage()&&_g().options.unloadCheck!==false){if(!confirm(FR.i18nText("FR-Engine_Unload_Check_Msg")+"!\n"+FR.i18nText("FR-Engine_SQLWizard-would_you_like_to_continue")+"")){if(this.QueryBtn){this.QueryBtn.enable()}return}}}var b=arguments[0];if(b.url==null){return}var c=this.config=$.extend({asyn:true},b);this.$sform=$($(".form-submit",this.element)[0]);
var a=this;if(c.asyn){FR.ajax({url:c.url,type:"POST",data:{__parameters__:this.collectionValue(c.data)},complete:function(f,d){var e=FR.jsonDecode(f.responseText);if(c.callback){c.callback.call(a,f,d)}if(e.callback){f.responseText=e.oldres;e.callback.call(a,f,d)}a._fireSubmitEvents(d)}})}else{this.$sform.attr("method","post");this.$sform.attr("action",b.url);if(b.target){this.$sform.attr("target",b.target)}if(!this.$sform_hidden){this.$sform_hidden=$("<input name = '__parameters__' type='hidden'/>").appendTo(this.$sform);
this.$sform_hidden.attr("value",FR.cjkEncode(this.collectionValue(c.data)))}this.$sform.submit()}},sentMail:function(a){FR.ajax({url:FR.servletURL,type:"POST",async:false,data:{op:"fr_email",cmd:"sent_email",sessionID:FR.SessionMgr.getSessionID(),mailXML:a.xmlconf,paraMap:a.paraMap||{},__parameters__:this.collectionValue()}})},customSubmit:function(a){FR.ajax({url:FR.servletURL,type:"POST",async:false,data:{op:"customevent",reportIndex:_g().curLGP.idx,sessionID:FR.SessionMgr.getSessionID(),xmlconf:a.xmlconf,reportXML:_g().generateReportXML(true),paraMap:a.paraMap||{}}})
},_fireSubmitEvents:function(a){if(a=="success"){this.fireEvent(FR.Events.SS)}else{this.fireEvent(FR.Events.SF)}this.fireEvent(FR.Events.SC)},getValueByName:function(a){var b=this.getWidgetByName(a);if(b&&b.getValue){return b.getValue()}},visible:function(e,b){if($.isArray(e)){for(var c=0,a=e.length;c<a;c++){var d=this.getWidgetByName(e[c]);if(d){d.visible(b)}}}},invisible:function(e,b){if($.isArray(e)){for(var c=0,a=e.length;c<a;c++){var d=this.getWidgetByName(e[c]);if(d){d.invisible(b)}}}}});$.shortcut("fr_form",FR.Form);
FR.contentForm=FR.extend(FR.Form,{_init:function(){this.name_widgets={};this.datakey_widgets=[];this.options.form=this;this.sessionID=this.options.widgetUrl?this.options.widgetUrl.getQuery("sessionID"):this.options.sessionID;this.content=this.createConfig2Form();this.content.fireEvent(FR.Events.AFTERINIT)},createConfig2Form:function(){var k=this.options;var e=this.afterInitEventList==undefined;if(e){this.afterInitEventList={}}var a=this._createConfig4Form(k);var d=FR.createWidget(a);this.rootWidget=d;
for(var b in d.options.resultWidgets){this.add(d.options.resultWidgets[b])}this.name_widgets=d.options.resultWidgets;var h=this;$.each(this.name_widgets,function(l,m){if(m.options.widgetName!=null){h.initLinkWidgetEvent(m)}});if(e){var j=this.afterInitEventList;delete this.afterInitEventList;d.once(FR.Events.AFTERINIT,function(){for(var l in j){var o=j[l];var p=h.getWidgetByName(l);if(p&&FR.isArray(o)){for(var n=0;n<o.length;n++){var m=o[n].action.createDelegate(o[n].target?o[n].target:p);if(m.apply(p)===false){break
}}}}});var g=FR.Form.Plugin.Panel.Events;if($.isArray(g)){for(var b=0,c=g.length;b<c;b++){var f=g[b];d.once(f.name,f.action.call(this))}}}return d},getRootWidget:function(){return this.rootWidget},_createConfig4Form:function(c){c.form=this;if(c.items){for(var d=0;d<c.items.length;d++){var b;if(c.items[d].el){b=c.items[d].el}else{if(c.items[d]){b=c.items[d]}}if(b){this._createConfig4Form(b)}}}if(c.listeners!=null){for(var d=0;d<c.listeners.length;d++){var a=c.listeners[d];if(a.eventName=="afterinit"){if(c.form.afterInitEventList[c.widgetName]==null){c.form.afterInitEventList[c.widgetName]=[]
}c.listeners.remove(a);d--;c.form.afterInitEventList[c.widgetName].push(a)}}}return c},add:function(c){if(c.options.Databinding){var a=c.options.Databinding;a.widget=c;this.datakey_widgets.push(a)}var b=this;c.load=function(){b.loadContentData(this)}},getWidgetByCell:function(){throw (' "getWidgetByCell" is not a function in form')},_confirmEvents:function(){this.fireEvent(FR.Events.AFTERINIT);this.doLayout()},initLinkWidgetEvent:function(c){if(!c||!c.options){return}FR.contentForm.superclass.initLinkWidgetEvent.apply(this,arguments);
var a=c.options.valueDependence;var b=this;if(FR.isArray(a)){$.each(a,function(d,f){var e=b.getWidgetByName(f);if(e!=null&&e!=c){if(!e.$linkWidget){e.$linkWidget={data:{},value:{}};e.on(FR.Events.AFTEREDIT,function(){b.fireWidgetValueChanged(e)})}e.$linkWidget["value"][c.options.widgetName]=c}})}},fireWidgetValueChanged:function(e){if(!e.$linkWidget){return}for(var d in e.$linkWidget["data"]){e.$linkWidget["data"][d].reset()}var b=FR.jsonDecode(this.collectionValue());var h={};var g={widgetNameList:[],chartWidgets:[],elementCaseWidgets:[]};
var a=[];var f=[];var c=[];this.pushLinkWidgetIntoList(e,h,g,b);this.executeWidgets(g.widgetNameList,h,b);this.executeCharts(g.chartWidgets);this.executeElements(g.elementCaseWidgets)},pushLinkWidgetIntoList:function(c,i,g,j){var d=c.$linkWidget;if(!d){return}var e=g.widgetNameList;var b=g.chartWidgets;var a=g.elementCaseWidgets;for(var f in d["value"]){var h=d["value"][f];if(h.xtype=="chartwidget"){b.push(h)}else{if(h.xtype=="elementcase"){a.push(h)}else{i[f]=h;e.push(f);j[f]="";this.pushLinkWidgetIntoList(h,i,g,j)
}}}for(var f in d["data"]){var h=d["data"][f];e.push(f);j[f]="";this.pushLinkWidgetIntoList(h,i,g,j)}},executeWidgets:_.debounce(function(b,e,a){if(b.length===0){return}var c=this;var d=FR.buildServletUrl({_:new Date().getTime(),op:"fr_form",cmd:"form_getsource",sessionID:this.options.form.sessionID,__widgetname__:b});FR.ajax({url:d,type:"POST",async:false,data:{__parameters__:FR.jsonEncode(a)},complete:function(h,g){if(g=="success"){var i=FR.jsonDecode(h.responseText);for(var f in i){if(e[f]){e[f].setSource(i[f])
}else{if(e[f.toUpperCase()]){e[f.toUpperCase()].setSource(i[f])}}}}}})},600),executeCharts:function(a){if(a.length>0){$.each(a,function(b,c){c.reload()})}},executeElements:function(a){var b=this;if(a.length>0){$.each(a,function(c,d){d.gotoPage(1,b.collectionValue(),"t",true)})}},loadContentData:function(e){var f={};var d={add:function(g){f[g.options.widgetName]=g},remove:function(g){delete f[g.options.widgetName]}};for(var c in e.options.resultWidgets){d.add(e.options.resultWidgets[c])}var a=this;
var b=FR.buildServletUrl({op:"fr_form",cmd:"form_getsource",sessionID:this.options.form.sessionID,__isContent__:true,__widgetname__:e.options.widgetName});FR.ajax({url:b,type:"POST",async:false,data:{__parameters__:a.collectionValue()},complete:function(i,h){if(h=="success"){var j=FR.jsonDecode(i.responseText);for(var g in j){if(f[g]){f[g].setSource(j[g])}}}else{}}})},parameterCommit:function(a){if(this.parameterEl){this.parameterEl.formSubmit({url:FR.servletURL+"?op=fr_dialog&cmd=parameters_d&sessionID="+this.sessionID,callback:function(){_g().loadContentPane(a)
}})}else{_g().loadContentPane()}},loadContentPane:function(b){var a;var c=this.sessionID;FR.ajax({url:FR.servletURL,data:{_:new Date().getTime(),op:"fr_form",cmd:"load_content",sessionID:c},beforeSend:function(){FR.HtmlLoader.loadingEffect({el:$(".content-container"),show:true})},async:true,complete:function(k,h){if(h=="success"){contenConfig=FR.jsonDecode(k.responseText);if(FR.Form.getFitConfigFromServer){contenConfig=FR.Form.getFitConfigFromServer(contenConfig)}var i=window.globalForm.parameterEl;
var j=$(".content-container");var n=$(".para-container");if(j){j.remove()}var g=$("body");var l=[];j=$("<div class='content-container'>");contenConfig.renderEl=j;var e=new FR.contentForm(contenConfig);l.push({region:"center",el:j});e.parameterEl=i;l.push({region:"north",el:n});var f=new FR.BorderLayout({items:l,renderEl:g});FR.SessionMgr.register(c,e);_g().name_widgets=e.name_widgets;f.doLayout();j.css("overflow","auto");var d=FR.windowWidth;var m=FR.windowHeight;$(window).resize(function(){if(!e.scaleProcess(f,d,m)){f.doLayout()
}d=FR.windowWidth;m=FR.windowHeight});FR.HtmlLoader.loadingEffect({el:j})}}});this.fireEvent(FR.Events.AFTERLOAD);if(FR.Form.bindFitResize){FR.Form.bindFitResize(this,b)}},load:function(){this.loadContentData(this.content)},remove:function(b){var a=this;if(b.options.Databinding){$.each(a.datakey_widgets,function(c,d){if(d&&d.Name==b.options.Databinding.Name&&d.Key==b.options.Databinding.Key){a.datakey_widgets.splice(c,1)}})}delete this.name_widgets[b.options.widgetName]},_fireSubmitEvents:function(a){if(a=="success"){this.content.fireEvent(FR.Events.SS)
}else{this.content.fireEvent(FR.Events.SF)}this.content.fireEvent(FR.Events.SC)},preferredLayout:function(){var a=0,d=2147483647,b=0,c=0;$.each(this.rootWidget.options.items,function(e,f){if(!f.el.isVisible()){d=Math.min(d,f.y);b=Math.max(b,f.y+f.height)}});$.each(this.rootWidget.options.items,function(e,f){if(f.el.isVisible()&&(f.y+f.height)<d){c=Math.max(f.y+f.height,c)}});$.each(this.rootWidget.options.items,function(e,f){if(f.el.isVisible()){if(f.y>d){f.delta=c-b}else{f.delta=0}}});$.each(this.rootWidget.options.items,function(e,f){if(f.el.isVisible()){a=Math.max(a,f.y+f.height+f.delta)
}});if($.isFunction(this.options.onCalculate)){this.options.onCalculate.call(this,a)}},doLayout:function(){if(this.content){this.content.setMinSize();this.content.doLayout()}},scaleProcess:function(f,b,a){var d=f.element.bounds();var c=Math.abs(a-d.height)<5;var e=Math.abs(b-d.width)<5;return c&&e}});$.shortcut("fr_contentform",FR.contentForm);$.extend(FR,{getDependence:function(a){if(a.getDependenceObj){return a.getDependenceObj()}},domFormSubmit:function(c,d,k,l){if(!FR.notCloseDialogOnSubmit){FR.closeDialog()
}d=$.extend({cjkEncode:true},d);var m;if(d.context){m=$(c,d.context)}else{m=$(c)}if(m.length===0){return}l=$.extend({scope:this},l);var b=m.serializeArray();var e={};for(var f=0;f<b.length;f++){var h=b[f];if(d.cjkEncode===true){e[FR.cjkEncode(h.name)]=FR.cjkEncode(h.value)}else{e[h.name]=h.value}}$.extend(e,d);var g={type:"POST",data:e,url:d.url||m[0].action,complete:function(n,i){$.isFunction(k)&&k.call(l.scope,n,i,l)}};var a=$("input:file",m);if(a.length>0){if(FR.Browser.webkit&&g.closeKeepAlive){$.get(g.closeKeepAlive,j)
}else{j()}}else{FR.ajax(g)}function j(){var r=m[0];if($(":input[name=submit]",r).length){alert('Error: Form elements must not be named "submit".');return}g.success=g.success||FR.emptyFn;var p=$.extend({},$.ajaxSettings,g);var D=jQuery.extend(true,{},$.extend(true,{},$.ajaxSettings),p);var q="jqFormIO"+(new Date().getTime());var y=$('<iframe id="'+q+'" name="'+q+'" />');var A=y[0];if(FR.Browser.isIE()||FR.Browser.opera){A.src='javascript:false;document.write("");'}y.css({position:"absolute",top:"-1000px",left:"-1000px"});
var C={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;y.attr("src","about:blank")}};var z=p.global;if(z&&!$.active++){$.event.trigger("ajaxStart")}if(z){$.event.trigger("ajaxSend",[C,p])}if(D.beforeSend&&D.beforeSend(C,D)===false){D.global&&jQuery.active--;return}if(C.aborted){return}var o=0;var v=0;var i=r.clk;if(i){var t=i.name;if(t&&!i.disabled){g.extraData=g.extraData||{};
g.extraData[t]=i.value;if(i.type=="image"){g.extraData[name+".x"]=r.clk_x;g.extraData[name+".y"]=r.clk_y}}}setTimeout(function(){var F=m.attr("target"),s=m.attr("action");m.attr({target:q,method:"POST",action:p.url});if(!g.skipEncodingOverride){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(p.timeout){setTimeout(function(){v=true;w()},p.timeout)}var E=[];try{if(g.extraData){for(var G in g.extraData){E.push($('<input type="hidden" name="'+G+'" value="'+g.extraData[G]+'" />').appendTo(r)[0])
}}y.appendTo("body");A.attachEvent?A.attachEvent("onload",w):A.addEventListener("load",w,false);r.submit()}finally{m.attr("action",s);F?m.attr("target",F):m.removeAttr("target");$(E).remove()}},10);function w(){if(o++){return}A.detachEvent?A.detachEvent("onload",w):A.removeEventListener("load",w,false);var s=0;var E=true;try{if(v){throw"timeout"}var F,H;H=A.contentWindow?A.contentWindow.document:A.contentDocument?A.contentDocument:A.document;if(H.body==null&&!s&&FR.Browser.opera){s=1;o--;setTimeout(w,100);
return}C.responseText=H.body?H.body.innerHTML:null;C.responseXML=H.XMLDocument?H.XMLDocument:H;C.getResponseHeader=function(J){var I={"content-type":p.dataType};return I[J]};if(p.dataType=="json"||p.dataType=="script"){var n=H.getElementsByTagName("textarea")[0];C.responseText=n?n.value:C.responseText}else{if(p.dataType=="xml"&&!C.responseXML&&C.responseText!=null){C.responseXML=x(C.responseText)}}F=B(C,p.dataType)}catch(G){E=false;u(p,C,"error",G)}if(E){p.success(F,"success");if(z){$.event.trigger("ajaxSuccess",[C,p])
}}if(z){$.event.trigger("ajaxComplete",[C,p])}if(z&&!--$.active){$.event.trigger("ajaxStop")}if(p.complete){p.complete(C,E?"success":"error")}setTimeout(function(){y.remove();C.responseXML=null},100)}function u(E,G,n,F){if(E.error){E.error.call(E.context||window,G,n,F)}if(E.global){(E.context?jQuery(E.context):jQuery.event).trigger("ajaxError",[G,E,F])}}function B(I,G,F){var E=I.getResponseHeader("content-type")||"",n=G==="xml"||!G&&E.indexOf("xml")>=0,H=n?I.responseXML:I.responseText;if(n&&H.documentElement.nodeName==="parsererror"){throw"parsererror"
}if(F&&F.dataFilter){H=F.dataFilter(H,G)}if(typeof H==="string"){if(G==="json"||!G&&E.indexOf("json")>=0){if(/^[\],:{}\s]*$/.test(H.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){if(window.JSON&&window.JSON.parse){H=window.JSON.parse(H)}else{H=(new Function("return "+H))()}}else{throw"Invalid JSON: "+H}}else{if(G==="script"||!G&&E.indexOf("javascript")>=0){jQuery.globalEval(H)}}}return H
}function x(n,E){if(window.ActiveXObject){E=new ActiveXObject("Microsoft.XMLDOM");E.async="false";E.loadXML(n)}else{E=(new DOMParser()).parseFromString(n,"text/xml")}return(E&&E.documentElement&&E.documentElement.tagName!="parsererror")?E:null}}},formSubmitCallback:function(c,a,b){FR.Msg.toast(a=="success"&&c.responseText=="true"?FR.i18nText("HJS-Send_Successfully")+"!":FR.i18nText("HJS-Send_Failed")+"!")},pagesetupSubmitCallback:function(c,a,b){FR.closeDialog();var e=b.sessionID;var d=_g();if(d!=null){d.loadContentPane()
}},recalculateElementTitle:function(b,c,a){FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_form",cmd:"recalculate_element_title",sessionID:_g().currentSessionID||_g().sessionID,widgetName:c,__parameters__:this.encodePara(b),noCache:a||"",_:new Date().getTime(),__boxModel__:$.support.boxModel},beforeSend:function(){},async:true,complete:function(e,d){if(d=="success"){var f=FR.jsonDecode(e.responseText);if(_g().name_widgets[c]){_g().name_widgets[c].setSource(f[c])}}}})},encodePara:function(a){if(!a){return""
}if(typeof a==="string"){a=FR.jsonDecode(a)}$.each(a,function(b,c){if(typeof c==="string"){a[b]=encodeURIComponent(FR.cjkDecode(c.replaceAll('"','\\"')))}});return a}});
FR.Form=FR.Form||{};FR.Form.Plugin=FR.Form.Plugin||{};FR.Form.Plugin.Panel=FR.Form.Plugin.Panel||{};FR.Form.Plugin.Panel.Events=[];
(function(a){if(window.jLayout){a.extend(window.jLayout,{scale:function(c){var h={},b=c.items||[],e=this.layout(c,h),g=c.scrollable,d=c.scrollContainer;e.layout=function(k){var j=k.bounds(),o=k.insets(),q=j.width-(o.left+o.right),r=j.height-(o.top+o.bottom),n=0,m=0;for(var p=0;p<b.length;p++){var s=b[p];var l=(g||q===0)?s.width:q;s.el.bounds({"x":0,"y":0,"width":l,"height":21});s.el.doLayout()}};function f(i){return function(){return{"width":0,"height":0}}}e.preferred=f("preferred");e.minimum=f("minimum");
e.maximum=f("maximum");return e},title:function(c){var h={},b=c.items||[],e=this.layout(c,h),g=c.scrollable,d=c.scrollContainer;e.layout=function(l){var k=l.bounds(),p=l.insets(),r=k.width-(p.left+p.right),s=k.height-(p.top+p.bottom),o=0,m=0;var u=b.length>1?s-38:s;var n=b.length>1?38:0;for(var q=0;q<b.length;q++){var x=b[q];var t=x.type!="elementcase"&&x.type!="chartwidget";var w=t?38:u;var v=t?0:n;x.el.bounds({"x":0,"y":v,"width":r,"height":w});x.el.doLayout();var j=FR.Browser.isIE8Before()&&!a.support.boxModel;
if(x.type=="elementcase"&&j){x.el.css("width","100%");x.el.css("height",u)}}};function f(i){return function(){return{"width":0,"height":0}}}e.preferred=f("preferred");e.minimum=f("minimum");e.maximum=f("maximum");return e},absolute:function(c){var h={},b=c.items||[],e=this.layout(c,h),g=c.scrollable,d=c.scrollContainer,i=c.absoluteCompState;e.layout=function(u){var j=u.data("preBounds");var m=u.bounds(),D=u.insets(),l=m.width-(D.left+D.right),I=m.height-(D.top+D.bottom);var n=w(j),G=E(j);var p=1,k=1;
var t=0,s=0,v=0,F=0;if(j&&m&&j.width>0){p=parseFloat(m.width/G);v=Math.abs(m.width-G)}if(j&&m&&j.height>0){k=parseFloat(m.height/n);F=Math.abs(m.height-n)}var A=false;for(var C=0;C<b.length;C++){var H=b[C];var B=H.width;if(B<=21){A=true}}for(var C=0;C<b.length;C++){var H=b[C];var B=H.width;var z=H.height;var r=H.x;var o=H.y;if(i===0&&!A){r=q(p,r);o=q(k,o);B=q(p,B+H.x)-r;z=q(k,z+H.y)-o;H.x=r;H.y=o;H.width=B;H.height=z}H.el.bounds({"x":r,"y":o,"width":B,"height":z});H.el.doLayout()}function E(x){return x?x.width:0
}function w(x){return x?x.height:0}function q(x,y){if(x!==0&&y){return parseInt(y*x)}else{return y}}if(!j||v>5||F>5){u.data("preBounds",m)}};function f(j){return function(){return{"width":0,"height":0}}}e.preferred=f("preferred");e.minimum=f("minimum");e.maximum=f("maximum");return e},adaptive:function(k){var i={},f=k.items||[],e=this.layout(k,i),g=k.scrollable,l=false,j=false,b=k.hasResized,c=k.compState,h=k.compInterval;e.layout=function(U){var T=U.bounds(),N=U.insets(),s=T.width-(N.left+N.right),M=T.height-(N.top+N.bottom),ap=0,ao=0;
var E=K(),an=af(),n;var A=0,Q=0,S=0,J=0;if(s!==0){A=ah();Q=c===0?o():ae();J=A-an;S=Q-E;if(Q>o()){a(U).css({"overflow-y":"scroll"});l=true}else{a(U).css({"overflow-y":"hidden"});l=false}}if(s===0&&M===0){for(var ai=0;ai<f.length;ai++){var L=f[ai];L.el.bounds({"x":L.x,"y":L.y,"width":L.width,"height":L.height});L.el.doLayout()}}var r=J!==0||S!==0;if(j&&r){V()}if(J!==0){if(!b){n=parseFloat(J/an);O(n)}ak(h)}if(S!==0){if(!b){n=parseFloat(S/E);p(n)}D(h)}var I=s!==0&&(J!==0||S!==0);if(I&&h>0){var q=C();
var H=m();var ab=H.length*21+(H.length-1)*h;var al=q.length*21+(q.length-1)*h;if(ab>s||c===0&&al>M){return}for(var ai=0;ai<f.length;ai++){var L=f[ai];var ac=b?0:B(H,L.x);var aa=b?0:B(q,L.y);var ad=b?0:B(H,L.x+L.width)-ac-1;var am=b?0:B(q,L.y+L.height)-aa-1;L.el.bounds({"x":L.x+ac*h,"y":L.y+aa*h,"width":L.width+ad*h,"height":L.height+am*h});L.el.doLayout()}j=true}if(I){for(var ai=0;ai<f.length;ai++){var L=f[ai];if(L.type!="elementcase"){continue}var z=L.el.bounds();var X=z.x,W=z.y,Y=z.width,aj=z.height;
if(L.marginTop){W=z.y+parseInt(L.marginTop)}if(L.marginLeft){X=z.x+parseInt(L.marginLeft)}if(L.marginBottom){aj=z.height-parseInt(L.marginBottom)-parseInt(L.marginTop)}if(L.marginRight){Y=z.width-parseInt(L.marginRight)-parseInt(L.marginLeft)}L.el.bounds({"x":X,"y":W,"width":Y,"height":aj});L.el.doLayout()}j=true}function B(aq,y){var w=aq.indexOf(y);if(w!=-1){return w}for(var x=0;x<aq.length;x++){if(Math.abs(aq[x]-y)<=1){return x}}return w}function ah(){var w=m().length-2;var x=l?16:0;return s-x-w*h
}function o(){var w=C().length-2;return M-w*h}function ae(){var w=C().length-2;return parseInt(A/an*E)-w*h}function ak(w){var y=f.length;for(var aq=0;aq<y;aq++){var at=f[aq];var ar=at.el.bounds();if(!ar.x){ar.x=parseInt(at.el.css("left"))}var x=Math.round(ar.x);at.x=at.el.isVisible()?x:parseInt(at.el.css("left"));at.width=ar.width}}function D(w){var y=f.length;for(var aq=0;aq<y;aq++){var at=f[aq];var ar=at.el.bounds();if(!ar.y){ar.y=parseInt(at.el.css("top"))}var x=Math.round(ar.y);at.y=at.el.isVisible()?x:parseInt(at.el.css("top"));
at.height=ar.height}}function V(){var w=f.length;for(var x=0;x<w;x++){var y=f[x];y.el.bounds({"x":y.x,"y":y.y,"width":y.width,"height":y.height});y.el.doLayout()}}function O(au){var ar=m();var aq=ar?ar.length:0;var w,y,av;for(var at=0;at<aq-1;at++){w=ar[at];av=ar[at+1];y=parseInt((av-w)*au);if(av-w<21-y){u(w)}else{Z(w,y)}}}function u(at){var av=G(at);if(!av){return}var w=0;for(var aq=0,ax=av.length;aq<ax;aq++){var aw=av[aq];if(at===0){return}if(aw.x<at){continue}var au=R(aw.x-5,aw.y);if(au){var ar=au.el.bounds();
var y=au.el.isVisible()?ar.x:parseInt(au.el.css("left"));y=y?y:parseInt(au.el.css("left"));w=ar.width+y;width=aw.x+aw.width==an?A-w:aw.width}aw.el.bounds({"x":w,"width":width});aw.el.doLayout()}}function Z(w,aq){var y=G(w);if(!y){return}for(var at=0,ar=y.length;at<ar;at++){var au=y[at];if(au.width===0){continue}if(au.x<w){if(au.x+au.width==an){continue}var av=au.el.bounds().width;au.el.bounds({"width":aq+av});au.el.doLayout();continue}P({item:au,dw:aq,x:w});au.el.doLayout()}}function P(ar){var ax=ar.item,w=ar.dw,av=ar.x;
var y=0;var aq=ax.el.bounds().width+w;var aw=R(ax.x-5,ax.y);if(aw){var au=aw.el.bounds();var at=aw.el.isVisible()?au.x:parseInt(aw.el.css("left"));at=at?at:parseInt(aw.el.css("left"));y=au.width+at}aq=ax.x+ax.width==an?A-y:aq;aq=aq<21?21:aq;ax.el.bounds({"x":y,"width":aq})}function p(ar){var w=C();var x=w?w.length-1:0;var av,at,au;for(var aq=0;aq<x;aq++){av=w[aq];au=w[aq+1];at=parseInt((au-av)*ar);if(au-av<21-at){t(av)}else{ag(av,at)}}}function t(at){var au=F(at);if(!au){return}var w=0;for(var aq=0,ay=au.length;
aq<ay;aq++){var ax=au[aq];if(at===0){return}if(ax.y<at){continue}var ar=R(ax.x,ax.y-5);if(ar){var av=ar.el.bounds();var x=ar.el.isVisible()?av.y:parseInt(ar.el.css("top"));x=x?x:parseInt(ar.el.css("top"));w=av.height+x;var aw=ax.y+ax.height==E?Q-w:ax.height}ax.el.bounds({"y":w,"height":aw});ax.el.doLayout()}}function ag(av,at){var w=F(av);if(!w){return}for(var aq=0,x=w.length;aq<x;aq++){var ar=w[aq];if(ar.height===0){continue}if(ar.y<av){if(ar.y+ar.height==E){continue}var au=ar.el.bounds().height;
ar.el.bounds({"height":au+at});ar.el.doLayout();continue}v({item:ar,dh:at,y:av});ar.el.doLayout()}}function v(aq){var ay=aq.item,au=aq.dh,av=aq.y;var w=0;var ar=ay.el.bounds().height;var at=R(ay.x,ay.y-5);if(at){var aw=at.el.bounds();var x=at.el.isVisible()?aw.y:parseInt(at.el.css("top"));x=x?x:parseInt(at.el.css("top"));w=aw.height+x}var ax=ay.y+ay.height==E?Q-w:ar+au;ax=ax<21?21:ax;ay.el.bounds({"y":w,"height":ax})}function R(aq,ax){for(var au=0,at=f.length;au<at;au++){var av=f[au];var w=av.x;var aw=av.y;
var ar=w<=aq&&aq<w+av.width&&aw<=ax&&ax<aw+av.height;if(ar){return av}}return null}function G(w){var y=[];for(var ar=0,aq=f.length;ar<aq;ar++){var at=f[ar];var av=at.x;var au=av<w&&w<av+at.width;if(au||av==w){y.push(at)}}return y}function F(av){var w=[];for(var aq=0,x=f.length;aq<x;aq++){var ar=f[aq];var au=ar.y;var at=au<av&&av<au+ar.height;if(at||au==av){w.push(ar)}}return w}function m(){var w,ar=[];ar.push(0);ar.push(af());for(var y=0;y<f.length;y++){var aq=f[y];w=aq.x;if(ar.indexOf(w)==-1){ar.push(w)
}}return ar.sort(function(at,x){return at>x?1:-1})}function C(){var ar,aq=[];aq.push(0);aq.push(K());for(var w=0;w<f.length;w++){var x=f[w];ar=x.y;if(aq.indexOf(ar)==-1){aq.push(ar)}}return aq.sort(function(at,y){return at>y?1:-1})}function af(){var au,x;var ar=0;for(var aq=0;aq<f.length;aq++){var at=f[aq];au=f[aq].el.isVisible()?at.y:parseInt(f[aq].el.css("top"));x=f[aq].el.css("display")==="none"?0:at.width;if(au===0){ar+=x}}return ar}function K(){var w,ar;var at=0;for(var y=0;y<f.length;y++){var aq=f[y];
w=f[y].el.isVisible()?aq.x:parseInt(f[y].el.css("left"));ar=f[y].el.css("display")==="none"?0:aq.height;if(w===0){at+=ar}}return at}return U};function d(m){return function(){return{"width":0,"height":0}}}e.preferred=d("preferred");e.minimum=d("minimum");e.maximum=d("maximum");return e}})}})(jQuery);
(function(a){FR.TitleLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.TitleLayout.superclass._defaultConfig.apply(),{baseCls:"fr-titlelayout",scrollable:false})},_init:function(){FR.TitleLayout.superclass._init.apply(this,arguments);var f=this.options;this.element.addClass(f.baseCls);if(!a.isArray(f.items)){f.items=[];return}var c=f.items,d,b=c.length;f.widgets=[];var h=this.element;for(d=0;d<b;d++){var e=c[d];if(!e.style){e.style=f.style}if(e.type){e.el=e}if(e.el.type){var g=FR.createWidget(a.extend(e.el,{resultWidgets:f.resultWidgets}));
g.titleWidget=this;f.widgets.push(g);e.el=g.element;h.append(e.el)}}this.element.data("jlayout",jLayout.title(f))},doResize:function(c){FR.TitleLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:c?(c.height||b.height):b.height,left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top});this.doLayout()},doLayout:function(){FR.TitleLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("title",FR.TitleLayout);FR.HorizontalLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.HorizontalLayout.superclass._defaultConfig.apply(),{alignment:"center",hgap:0,vgap:0,baseCls:"fr-horizontalboxlayout"})
},_init:function(){FR.HorizontalLayout.superclass._init.apply(this,arguments);var g=this.options;this.element.addClass(g.baseCls);this.element.css("min-width",g.minWidth);var d=g.items,f,b=d.length;g.widgets=[];for(f=0;f<b;f++){var c=d[f];if(!c.el.style){c.el.style=g.style}if(c.el&&c.el.type){var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));g.widgets.push(h);var e=h.element;d[f].el=e;this.element.append(e)}else{if(c.el instanceof a){this.element.append(c.el)}}}this.element.data("jlayout",jLayout.horizontal(g))
},doResize:function(c){FR.HorizontalLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:(c?(c.height||b.height):b.height),left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top})},doLayout:function(){FR.HorizontalLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("horizontal",FR.HorizontalLayout);FR.ParaHorizontalLayout=FR.extend(FR.HorizontalLayout,{_init:function(){FR.ParaHorizontalLayout.superclass._init.apply(this,arguments);
if(FR.Browser.isIE8Before()&&!a.support.boxModel){this.element.css("overflow","visible")}}});a.shortcut("para_horizontal",FR.ParaHorizontalLayout);FR.VerticalBoxLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.VerticalBoxLayout.superclass._defaultConfig.apply(),{hgap:5,vgap:5,baseCls:"fr-verticalboxlayout"})},_init:function(){FR.VerticalBoxLayout.superclass._init.apply(this,arguments);var g=this.options;this.element.addClass(g.baseCls);var d=g.items,f,b=d.length;g.widgets=[];
var j=this.element;if(g.scrollable){j=a('<div class="fr-core-layout-scrollable">').css({position:"absolute",top:0,left:0}).appendTo(this.element);g.scrollContainer=j}for(f=0;f<b;f++){var c=d[f];if(!c.el.style){c.el.style=g.style}if(c.el&&c.el.type){var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));g.widgets.push(h);var e=h.element;d[f].el=e;j.append(e)}else{if(c.el instanceof a){j.append(c.el)}}}this.element.data("jlayout",jLayout.vertical(g))},doResize:function(c){FR.VerticalBoxLayout.superclass.doResize.call(this,c);
var b=this.options;this.element.css({width:b.width,height:b.height,left:b.left,top:b.top})},doLayout:function(){FR.VerticalBoxLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("vertical",FR.VerticalBoxLayout);FR.CardBorder=FR.extend(FR.BorderLayout,{_init:function(){FR.CardBorder.superclass._init.apply(this,arguments)},_initBackGround:function(){if(!this.options.widgetBackground){return}FR.CardBorder.superclass._initFitBackground.apply(this,arguments)},doResize:function(b){if(!b||(this.options.width==b.width&&this.options.height==b.height)){return
}if(this.element.height()>0){this._initBackGround()}FR.CardBorder.superclass.doResize.call(this,b)}});a.shortcut("cardborder",FR.CardBorder);FR.CardTagLayout=FR.extend(FR.HorizontalLayout,{_init:function(){FR.CardTagLayout.superclass._init.apply(this,arguments)},_initBackGround:function(){if(!this.options.widgetBackground){return}FR.CardTagLayout.superclass._initFitBackground.apply(this,arguments)},doResize:function(b){if(!b||(this.options.width==b.width&&this.options.height==b.height)){return}if(this.element.height()>0){this._initBackGround()
}FR.CardTagLayout.superclass.doResize.call(this,b)},showSelectTab:function(d){var g=this.options;var c=g.items,e,b=c.length;var h=this.getMoveDelta(b,c);if(h===0){return}for(e=0;e<b;e++){var f=parseInt(c[e].el.css("left"));c[e].el.css("left",f+h+"px")}},getMoveDelta:function(c,d){for(i=0;i<c;i++){var b=d[i].el.width();if(b<=0){continue}if(d[i].el.css("opacity")==="1"){var e=parseInt(d[i].el.css("left"));if(b+e>this.element.width()){return -b}if(e<0){return b}return 0}}}});a.shortcut("cardtaglayout",FR.CardTagLayout);
FR.FormCardLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.FormCardLayout.superclass._defaultConfig.apply(),{baseCls:"fr-quick-form-card-layout",defaultShowIndex:0})},_init:function(){FR.FormCardLayout.superclass._init.apply(this,arguments);var k=this;this.tabID=k.options.tagLayoutName;this.element.attr("id",this.tabID);var e=k.options.items.length;var f=a('<button class="fr-slider-left">').css({}).appendTo(this.element).click(function(){if(e===1){return}var m=k.getShowIndex();
var l=(m+e-1)%e;k.showCardByIndex(l)}).mouseover(function(){k.sliderShow()}).mouseout(function(){k.sliderBlank()});var c=a('<button class="fr-slider-right">').css({}).appendTo(this.element).click(function(){if(e===1){return}var m=k.getShowIndex();var l=(m+e+1)%e;k.showCardByIndex(l)}).mouseover(function(){k.sliderShow()}).mouseout(function(){k.sliderBlank()});if(!k.options.isCarousel){f.hide();c.hide()}else{var j=51;for(d=0;d<e;d++){var h=a("<span/>").css({left:j-e+2*d+"%"}).addClass("slider-dot");
var g=a("<div/>").append(h).appendTo(this.element).click({index:d,sb:k},function(l){if(e===1){return}l.data.sb.showCardByIndex(l.data.index)})}}var b=this.options;this.name2Index={};this.cardsHasCreated=[];this._initNameMap();if(b.showAllCardOnInit){for(var d=b.items.length-1;d>=0;d--){this.showCardByIndex(d)}}else{this.showCardByIndex(0)}this.clock=null;if(k.options.isCarousel){this.animate()}},_initBackGround:function(){if(!this.options.widgetBackground){return}FR.FormCardLayout.superclass._initFitBackground.apply(this,arguments)
},sliderShow:function(){a("#"+this.tabID+" > .fr-slider-left").css("opacity","1.0");a("#"+this.tabID+" > .fr-slider-right").css("opacity","1.0");a("#"+this.tabID+" .slider-dot").css("float","left").css("display","inline")},sliderBlank:function(){a(".fr-slider-left").css("opacity","0.0");a(".fr-slider-right").css("opacity","0.0");a(".slider-dot").css("display","none")},_initNameMap:function(){var b=this.options.items;for(var d=0;d<b.length;d++){var c;if(b[d].el){c=b[d].el.widgetName}else{c=b[d].widgetName
}if(!FR.isEmpty(c)){this.name2Index[c]=d}}},showPaneByIndex:function(b){this.showCardByIndex(b)},showPrevCard:function(){if(!FR.isEmpty(this.showIndex)){this.showCardByIndex(this.showIndex-1);this.showCardTab(this.showIndex-1)}},showNextCard:function(){if(!FR.isEmpty(this.showIndex)){this.showCardByIndex(this.showIndex+1);this.showCardTab(this.showIndex+1)}},showCardTab:function(c){var d=this.options;if(!d.tagLayoutName){return}var b=d.form.getWidgetByName(d.tagLayoutName);if(!b){return}b.showSelectTab(c)
},hideTab:function(g,f){var b=this.options;var j=b.items;this.showIndex=g;var c=0;if(typeof(f)=="undefined"){return}var k=10;var e=0.1;var d=60;var h=setInterval(function(){c+=1;var l=j[f].el.css("opacity");if(c==k){j[f].el.hide();clearInterval(h)}var m=parseFloat(l)-e;j[f].el.css("opacity",m)},d)},showUnCachedTab:function(c,b,e){var d=b[c];if(!d.el){d.el=d}if(d&&d.el&&d.el.type){var f=FR.createWidget(a.extend(d.el,{resultWidgets:e.resultWidgets}));d.el=f.element;if(e.form&&e.form.initLinkWidgetEvent){a.each(e.resultWidgets,function(g,h){if(h.options.widgetName!=null){e.form.initLinkWidgetEvent(h)
}})}}this.element.append(d.el);this.cardsHasCreated.push(c);this.element.data("jlayout",jLayout.card(e))},showCardByIndex:function(h){if(this.showIndex===h){return}if(!FR.isEmpty(this.showIndex)){this.fireEvent(FR.Events.CARDCHANGE)}var b=this.options;var l=b.items;if(h>-1&&h<l.length){this.changeAllBackground(b,h);this.hideTab(h,this.showIndex);var p=this.cardsHasCreated.indexOf(h);if(p==-1){this.showUnCachedTab(h,l,b)}else{var m=10;var e=0.1;var d=60;l[h].el.show();l[h].el.css("opacity","0.0");
var c=0;var k=setInterval(function(){c+=1;var j=l[h].el.css("opacity");if(c==m){clearInterval(k)}var q=parseFloat(j)+e;l[h].el.css("opacity",q)},d)}}this.doLayout();var o=a("#"+this.tabID+" .slider-dot");if(o.length===0){return}if(this.options.isCarousel){var g=this.options.items.length;for(var f=0;f<g;f++){var n=o.eq(f);if(f===h){n.css("background",'url("'+FR.servletURL+"?op=resource&resource=/com/fr/web/core/js/demo/image/dot-click.png"+'")')}else{n.css("background",'url("'+FR.servletURL+"?op=resource&resource=/com/fr/web/core/js/demo/image/dot-unclick.png"+'")')
}}}},changeAllBackground:function(e,c){if(!e.allTagName){return}var f=e.allTagName;for(var d=0;d<f.length;d++){var b=e.form.getWidgetByName(f[d]);if(!b){continue}if(c===d){b.element.css("opacity","1");continue}b.element.css("opacity","0.6")}},getShowIndex:function(){return this.showIndex?this.showIndex:this.options.defaultShowIndex},showPaneByName:function(b){return this.showCardByName(b)},showCardByName:function(b){if(FR.isEmpty(b)){return}this.showCardByIndex(this.name2Index[b.toUpperCase()])},adjustWidth:function(d,g){if(g.width==d.width){return
}d.width=g.width;var c=d.form;if(!c){return}var f=d.titleWidth;var e=c.getWidgetByName(d.preBtnName);var b=c.getWidgetByName(d.nextBtnName);if(e&&b){e.setVisible(d.width<d.titleWidth);b.setVisible(d.width<d.titleWidth)}},doResize:function(c){if(!c||(this.options.width==c.width&&this.options.height==c.height)){return}if(this.element.height()>0){this._initBackGround()}var b=this.options;this.adjustWidth(b,c);FR.FormCardLayout.superclass.doResize.call(this,c);this.element.css({width:b.width,height:b.height,left:b.left,top:b.top});
this.doLayout()},doLayout:function(){FR.FormCardLayout.superclass.doLayout.apply(this,arguments)},animate:function(){var b=this;if(!b.options.isCarousel){return}var c=b.options.carouselInterval*1000;b.clock=setInterval(function(){a("#"+b.tabID).mouseenter(function(){b.sliderShow();clearInterval(b.clock)}).mouseleave(function(){b.sliderBlank();clearInterval(b.clock);b.animate()});b.gotoNextTab()},c)},gotoNextTab:function(){var b=this.options.items.length;var d=this.getShowIndex();var c=(d+1)%b;this.showCardByIndex(c)
}});a.shortcut("cardlayout",FR.FormCardLayout);FR.AdaptiveLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.AdaptiveLayout.superclass._defaultConfig.apply(),{baseCls:"fr-quick-adaptive-layout"})},_init:function(){FR.AdaptiveLayout.superclass._init.apply(this,arguments);var f=this.options;if(!a.isArray(f.items)){f.items=[];return}var c=f.items;f.widgets=[];for(var e=0;e<c.length;e++){var b=c[e];if(!b.style){b.style=f.style}if(b&&b.type){var g=FR.createWidget(a.extend(b,{width:b.width,height:b.height,resultWidgets:f.resultWidgets}));
f.widgets.push(g);var d=g.element;b.el=d;this.element.append(d);g.options.adaptiveLayoutItems=c}}this.element.data("jlayout",jLayout.adaptive(f))},doResize:function(d){if(this.element.height()>0){FR.AdaptiveLayout.superclass._initBackGround.apply(this,arguments)}var c=this.options;if(c.width==d.width&&c.height==d.height){return}var b=this;FR.AdaptiveLayout.superclass.doResize.call(b,d);b.element.css({width:d?(d.width||c.width):c.width,height:d?(d.height||c.height):c.height,left:d?(d.left||c.left):c.left,top:d?(d.top||c.top):c.top});
b.doLayout()},doLayout:function(){FR.AdaptiveLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("fit",FR.AdaptiveLayout);FR.ScaleLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.ScaleLayout.superclass._defaultConfig.apply(),{baseCls:"fr-scalelayout",scrollable:false})},_init:function(){FR.ScaleLayout.superclass._init.apply(this,arguments);var f=this.options;this.element.addClass(f.baseCls);if(!a.isArray(f.items)){f.items=[];return}var c=f.items,d,b=c.length;f.widgets=[];
var h=this.element;for(d=0;d<b;d++){var e=c[d];if(!e.style){e.style=f.style}if(e.type){e.el=e}if(e.el.type){var g=FR.createWidget(a.extend(e.el,{resultWidgets:f.resultWidgets}));f.widgets.push(g);e.el=g.element;h.append(e.el)}}this.element.data("jlayout",jLayout.scale(f))},doResize:function(c){FR.ScaleLayout.superclass.doResize.call(this,c);var b=this.options;this.element.css({width:(c?(c.width||b.width):b.width),height:c?(c.height||b.height):b.height,left:c?(c.left||b.left):b.left,top:c?(c.top||b.top):b.top});
this.doLayout()},doLayout:function(){FR.ScaleLayout.superclass.doLayout.apply(this,arguments)}});a.shortcut("scale",FR.ScaleLayout);FR.AbsoluteLayout=FR.extend(FR.Layout,{_defaultConfig:function(){return a.extend(FR.AbsoluteLayout.superclass._defaultConfig.apply(),{baseCls:"fr-absolutelayout",scrollable:false})},_init:function(){FR.AbsoluteLayout.superclass._init.apply(this,arguments);var g=this.options;if(g.absoluteCompState===1){this.element.css({overflow:"auto"})}this.element.addClass(g.baseCls);
if(!a.isArray(g.items)){g.items=[];return}var d=g.items,f,b=d.length;g.widgets=[];var j=this.element;for(f=0;f<b;f++){var c=d[f];if(g.absoluteCompState===0&&!g.hasResize){if(g.absoluteResolutionScaleW&&g.absoluteResolutionScaleH){c.x=parseInt(c.x/g.absoluteResolutionScaleW);c.y=parseInt(c.y/g.absoluteResolutionScaleH);c.width=parseInt(c.width/g.absoluteResolutionScaleW);if(c.type==="title"){c.height=parseInt(((c.height-36)/g.absoluteResolutionScaleH)+36)}else{c.height=parseInt(c.height/g.absoluteResolutionScaleH)
}}}if(!c.style){c.style=g.style}if(c.type){c.el=c}if(c.el.type){var h=FR.createWidget(a.extend(c.el,{resultWidgets:g.resultWidgets}));g.widgets.push(h);var e=h.element;e.css({left:c.x,top:c.y,position:"absolute"});d[f].el=e;j.append(e);h.doResize({width:c.width,height:c.height})}else{if(c.el instanceof a){var e=c.el;e.css({left:c.x,top:c.y,position:"absolute"});j.append(e)}}}this.element.data("jlayout",jLayout.absolute(g));if(FR.Browser.msie&&!a.support.boxModel){if(g.height===0){g.height=1}if(g.width===0){g.width=1
}}},doResize:function(f){FR.AbsoluteLayout.superclass.doResize.call(this,f);var d=this.options;this.element.css({width:(f?(f.width||d.width):d.width),height:f?(f.height||d.height):d.height,left:f?(f.left||d.left):d.left,top:f?(f.top||d.top):d.top});for(var c=0,b=this.options.widgets.length;c<b;c++){var e=this.options.widgets[c];if(a.isFunction(e.doResize)){e.doResize({})}}},doLayout:function(){FR.AbsoluteLayout.superclass.doLayout.apply(this,arguments);for(var c=0,b=this.options.widgets.length;c<b;
c++){var d=this.options.widgets[c];if(a.isFunction(d.doLayout)){d.doLayout()}}}});a.shortcut("absolute",FR.AbsoluteLayout)})(jQuery);
(function(a){FR.frMenu=function(b){this.$menuRoot=a("<div class='fr-ui-core-menu menu'>");this.closeNow=true;this.init();this.applyOptions(b);return this};FR.frMenu.prototype={init:function(){var b=this;this.$menuRoot.hover(function(){b.closeNow=false},function(c){if(c&&b.submenu&&b.submenu.$menuRoot&&(c.clientX<b.submenu.$menuRoot.offset().left)){b.close(true)}else{b.close()}});this.$menuRoot.appendTo("body")},hasSubmenu:function(){var b=false;if(this.items){a.each(this.items,function(c,d){if(d.submenu){b=true;
return false}})}return b},applyOptions:function(c){var b=this;this.removechildren();this.$menuRoot.css("z-index",3333);this.items=c.items;this.$el=c.$el;this.options=c;this.destroyOnClose=c.destroyOnClose!=null?c.destroyOnClose:true;this.closeOnHover=true;if(this.hasSubmenu()){this.submenu=new FR.frMenu({destroyOnClose:false,item:[]})}if(this.$el){this.$el.mouseout(function(){if(b.resizeid!=null){clearTimeout(b.resizeid);b.resizeid=null}b.resizeid=setTimeout(function(){if(b.closeNow){b.close()}},200)
})}this.cItems=[];this.minWidth=c.minWidth||80;this.xxxfixclientH=c.xxxfixclientH;this.xxxMMenu=c.xxxMMenu;if(a.isArray(this.items)){this.addItems(this.items)}if(this.xxxMMenu){if(contentPane&&contentPane.$contentPane&&!FR.xxxmenu_array){FR.xxxmenu_array=[];contentPane.$contentPane.click(function(){var e=[];for(var d=0;d<FR.xxxmenu_array.length;d++){e.unshift(FR.xxxmenu_array[d])}for(var d=0;d<e.length;d++){e[d].close(true)}})}}},addItems:function(c){for(var d=0,b=c.length;d<b;d++){this.addItem(c[d])
}if(this.minWidth&&this.minWidth>=this.$menuRoot.width()){this.$menuRoot.width(this.minWidth);this.$menuRoot.children("div").width(this.minWidth-8)}},addItem:function(c){var j=this;var g=a("<div style='width:80px'>").appendTo(this.$menuRoot);if(c.type==="sep"){g.addClass("menu-sep").html("'&nbsp;'")}else{j.bindMenuItemEvent(g,c);if(c.color){var d=a("<div id=mc style='background-color:"+c.color+";height:12px; width:12px; position:absolute; left:8px; top:4px'></div>").appendTo(g)}var i=a('<div class="menu-text"></div>').html(c.src).appendTo(g);
var b=i.position().left*2+i.width();if(this.minWidth<b){this.minWidth=b}var e=c.iconSrc?c.iconSrc.replace("css:",""):"";if(e){a('<div class="menu-icon"></div>').addClass(e).appendTo(g)}if(c.submenu){var f=c.arrowSrc?c.arrowSrc.replace("css:",""):"";if(f){a('<div class="menu-customarrow"></div>').addClass(f).appendTo(g)}else{a('<div class="menu-rightarrow"></div>').appendTo(g)}}if(a.support.boxModel===true){var h=g.height()||22;g.height(h-(g.outerHeight()-g.height()))}this.cItems[this.cItems.length]=g
}},children:function(){return this.cItems},bindMenuItemEvent:function(c,d){c.addClass("menu-item");var b=this;if(d.submenu){c.hover(function(){b.closeSub();c.siblings().each(function(){a(this).removeClass("menu-active")});if(c.attr("disabled")){return}c.addClass("menu-active");if(a.isArray(d.submenu)){var e={destroyOnClose:false,minWidth:b.minWidth,items:d.submenu,parMenu:b};b.submenu.applyOptions(e);var f=c.offset().left+c.outerWidth()+2;if(f+b.submenu.$menuRoot.outerWidth()>FR.windowWidth){f=c.offset().left-b.submenu.$menuRoot.outerWidth()
}b.submenu.position(f,c.offset().top);b.submenu.show()}},function(f){})}else{c.click(function(f){if(c.attr("disabled")){return}if(d.chartEvent){d.chartEvent.chartGlyph.layerToDataPointNext(d.dataPoint);d.chartEvent.refreshing()}else{d.handler.call(b,f,this)}b.close(true)});c.hover(function(){b.closeSub();if(c.attr("disabled")){return}c.siblings().each(function(){a(this).removeClass("menu-active")});c.addClass("menu-active")},function(f){c.removeClass("menu-active")})}},position:function(b,c){this.$menuRoot.css({left:b,top:c})
},show:function(){this.$menuRoot.show();if(parentMenu=this.options.parMenu){parentMenu.closeOnHover=false}},close:function(b){if(b){if(this.destroyOnClose){this.remove()}else{this.closeSub()}if(parentMenu=this.options.parMenu){parentMenu.close(true)}else{this.$menuRoot.hide()}}else{if(this.closeOnHover){if(this.destroyOnClose){this.remove()}else{this.closeSub();this.$menuRoot.hide()}if(parentMenu=this.options.parMenu){parentMenu.closeOnHover=true}}}},remove:function(){this.$menuRoot.remove();if(this.$el){delete this.$el.fr_menu
}if(this.submenu){this.submenu.remove()}},removechildren:function(){if(this.cItems){for(var c=0,b=this.cItems.length;c<b;c++){this.cItems[c].remove()}}if(this.submenu){this.submenu.remove()}},closeSub:function(){if(this.submenu&&!this.submenu.$menuRoot.is(":hidden")){this.submenu.close()}}}})(jQuery);
FR.Object=function(a){this.options=$.extend(this._defaultConfig(),a);this._init()};$.extend(FR.Object.prototype,{_defaultConfig:function(){return{}},_init:function(){}});FR.Record=FR.extend(FR.Object,{_defaultConfig:function(){return $.extend(FR.ObjectSource.superclass._defaultConfig.apply(this,arguments),{data:[],createFields:[],choosedFields:[],showField:"",titleField:"",showEmptyValue:"",valueField:"",showTemplate:"",valueTemplate:""})},_init:function(){FR.Record.superclass._init.apply(this,arguments);
$.extend(this,this.options);this.nameProperty();this.initMethods()},nameProperty:function(){if(this.createFields){for(var b=0,a=this.createFields.length;b<a;b++){if(this.createFields[b]!=b){this.data[this.createFields[b]]=this.data[b];delete this.data[b]}}}},initMethods:function(){if(this.choosedFields){var d=this;var c=function(i){return function(){return d.data[i]}};var g=function(i){return function(j){d.data[i]=j}};for(var f=0,a=this.choosedFields.length;f<a;f++){var e=this.choosedFields[f];var h=e.startWith("is")||e.startWith("get")?e:"get"+e;
var b;if(e.startWith("is")){b="set"+e.substr(2)}else{if(e.startWith("get")){b="set"+e.substr(3)}else{if(e.startWith("set")){b=e}else{b="set"+e}}}this[h]=c(e);this[b]=g(e)}}},getShowValue:function(){var a=this.getShowTemplate()||this.getShowField();if(a==null){a=this.getNoAppointShowValue()}a=this.formatShowValue(a);return(this.showEmptyValue&&a==null)?this.showEmptyValue:a},getTitleValue:function(){if(this.titleField){return this.data[this.titleField]}},setTitleValue:function(a){if(this.titleField){this.data[this.titleField]=a;
return true}},setShowValue:function(a){this.setShowTemplate(a)||this.setShowField(a)},setShowTemplate:function(a){if(this.showTemplate){this.data[this.showTemplate]=a;return true}},setShowField:function(a){if(this.showField){this.data[this.showField]=a;return true}},getValue:function(){var a=this.getValueTemplate()||this.getValueField();if(a!=null){return a}return this.getNoAppointValue()},setValue:function(a){this.setValueTemplate(a)||this.setValueField(a)},setValueTemplate:function(a){if(this.valueTemplate){this.data[this.valueTemplate]=a;
return true}},setValueField:function(a){if(this.valueField){this.data[this.valueField]=a;return true}},getNoAppointShowValue:function(){if(this.showField!=null||this.showTemplate!=null){return}return this.getFirstProperty()},getNoAppointValue:function(){if(this.valueField!=null||this.valueTemplate!=null){return}return this.getFirstProperty()},getFirstProperty:function(){for(var a in this.data){if(!$.isFunction(this.data[a])){return this.data[a]}}},getShowField:function(){if(this.showField){return this.data[this.showField]
}},getValueField:function(){if(this.valueField){return this.data[this.valueField]}},getShowTemplate:function(){if(this.showTemplate){return this.dealTemplate(this.showTemplate)}},getValueTemplate:function(){if(this.valueTemplate){return this.dealTemplate(this.valueTemplate)}},dealTemplate:function(b){var a;while((a=/{[^{}]+}/g.exec(b))!=null){b=b.substr(0,a.index)+a[0].substr(1,a[0].length-1)+b.substr(a.index+a[0].index)}return b},formatShowValue:function(a){if(typeof a=="string"&&a.indexOf("__time__")>-1){return FR.date2Str(FR.jsonDecode(a),"yyyy-MM-dd HH:mm:ss")
}return a},getContent:function(){return this.data},setContent:function(a){this.data=a},getProperty:function(a){return this.data[a]},setProperty:function(a,b){this.data[a]=b}});FR.Node=FR.extend(FR.Record,{_init:function(){FR.Node.superclass._init.apply(this,arguments);if(!this.nodeSource){if(this.children&&this.data[this.children]){this.nodeSource=new FR.ObjectSource({data:this.data[this.children]})}else{if(this.options.url){this.nodeSource=new FR.URLSource({url:this.options.url})}}}if(!this.nodeReader){this.nodeReader=new FR.NodeReader(this.copyProperties())
}this.childrenNodes=[]},getParent:function(){return this.parent},setParent:function(a){this.parent=a},getPathAsValueString:function(){return this.getValuePath(true)},getPathAsTextString:function(){return this.getTextPath(true)},getValuePath:function(b){var a=[this.data.value];var c=this.getParent();while(c){a.unshift(c.data.value);c=c.getParent()}return b?a.join(","):a},getTextPath:function(b){var a=[this.data.text];var c=this.getParent();while(c){a.unshift(c.data.text);c=c.getParent()}return b?a.join(","):a
},getLeafNode:function(d){var c=d||[];if(!this.hasChild()){c.push(this);return c}else{var b=this.getChildren();for(var a=0;a<b.length;a++){b[a].getLeafNode(c)}}return c},getAncestorsLength:function(){var a=0;var b=this.getParent();while(b){a++;b=b.getParent()}return a},hasChild:function(){return this.hasChildren!=null?this.data[this.hasChildren]||(this.data["ChildNodes"]&&(this.data["ChildNodes"]).length!==0):((this.children!=null&&this.data[this.children])||this.getChildrenLength()>0)},getChildren:function(){return this.loadChildren()
},getChildrenLength:function(){return this.loadChildren().length},getChild:function(a){return this.loadChildren()[a]},getID:function(){return this.data[this.id]},setID:function(a){this.data[this.id]=a},getParentID:function(){var a=this.data[this.parentID];return a!=null?a:(this.getParent()?this.getParent().getID():null)},getValue:function(){return this.data["value"]},getText:function(){return this.data["text"]},setParentID:function(){},setUnselectable:function(a){this.data[this.unselectable]=a},isUnselectable:function(){return this.data[this.unselectable]
},isSelected:function(){return this.selectedField!=null?this.data[this.selectedField]:this.selected},setSelected:function(a){this.selectedField!=null?this.data[this.selectedField]=a:this.selected=a},loadChildren:function(){if(!this.hasChild()){return[]}if(this.isLoaded){return this.childrenNodes}if(!this.nodeSource){return[]}this.resetStatus();this.childrenNodes=this.nodeReader.readObject(this.nodeSource.loadObject());this.isLoaded=true;return this.childrenNodes},isLoadComplete:function(){return this.nodeSource?this.nodeSource.isLoaded():true
},copyProperties:function(){var a={};this.createFields&&(a.createFields=this.createFields);this.choosedFields&&(a.choosedFields=this.choosedFields);this.showField&&(a.showField=this.showField);this.titleField&&(a.titleField=this.titleField);this.showEmptyValue&&(a.showEmptyValue=this.showEmptyValue);this.valueField&&(a.valueField=this.valueField);this.showTemplate&&(a.showTemplate=this.showTemplate);this.valueTemplate&&(a.valueTemplkate=this.valueTemplate);this.parameterFields&&(a.parameterFields=this.parameterFields);
this.hasChildren&&(a.hasChildren=this.hasChildren);this.type&&(a.type=this.type);this.id!=null&&(a.id=this.id);this.parentID!=null&&(a.parentID=this.parentID);this.options.url&&(a.url=this.getChildURL()||this.options.url);this.childurlField&&(a.childurlField=this.childurlField);this.children&&(a.children=this.children);this.selectedField&&(a.selectedField=this.selectedField);a.parent=this;return a},getChildURL:function(){return this.childurl?this.childurl:this.data[this.childurlField]},setChildURL:function(a){this.childurlField!=null?this.data[this.childurlField]=a:this.childurl=a
},addNode:function(a){this.isLoaded=true;this.childrenNodes.push(a);a.setParent(this)},removeNode:function(a){this.childrenNodes.remove(a)},sortChildren:function(){},clearData:function(){this.isLoaded=false;delete this.childrenNodes;this.childrenNodes=[]},createParaObj:function(){var b={};if(this.parameterFields){for(var c=0,a=this.parameterFields.length;c<a;c++){b[this.parameterFields[c]]=this.data[this.parameterFields[c]]}}if(this.additionalParameters){for(var c in this.additionalParameters){b[c]=this.additionalParameters[c]
}b["parent_values"]=this.getValuePath();b["parentID"]=this.getParentID()}return{parameter:b}},additionalParameter:function(a){this.additionalParameters=a.parameter},getAdditionalNodes:function(){var a=this.nodeReader.readObject(this.nodeSource.loadObject());this.childrenNodes=this.childrenNodes.concat(a);return a},resetStatus4AddNodes:function(b){var a=this.createParaObj();$.extend(a.parameter,b.parameter);this.nodeSource.resetStatus(a)},resetStatus:function(){if(!this.nodeSource){return}if(this.nodeSource.resetStatus(this.createParaObj())){this.clearData()
}},isAllChildrenChosen:function(){if(!this.hasChild()||!this.isLoadComplete()){return false}for(var a=0;a<this.childrenNodes.length;a++){if(this.childrenNodes[a].getcheckstate()!==1){return false}}return true}});FR.RootNodeLoader=FR.extend(FR.OB,{_init:function(){FR.RootNodeLoader.superclass._init.apply(this,arguments);this.options.rootSource=new FR.URLSource({url:this.options.url,data:this});if(!this.options.rootReader){this.options.rootReader=new FR.DefaultNodeReader({url:this.options.url})}this.rootNodes=[]
},updateData:function(b){var a=this.options.rootReader.readObject(b);if(this.rootNodes.length<1){this.rootNodes=a;this.fireEvent(FR.Events.AFTERREAD,a)}else{Array.prototype.push.apply(this.rootNodes,a);this.fireEvent(FR.Events.APPENDDATA,a)}},getRootNodes:function(){if(this.isLoaded){return this.rootNodes}this.rootNodes=this.loadNodes();this.isLoaded=true;return this.rootNodes},getRootNodesAsync:function(c){var a=this;if(this.isLoaded){c.call(this,this.rootNodes)}if(a.options.rootSource&&this.options.rootReader){var b=function(d){a.isLoaded=true;
if(c&&$.isFunction(c)){a.rootNodes=a.options.rootReader.readObject(d);c.call(this,a.rootNodes)}};a.options.rootSource.loadObject(b)}},loadNodes:function(){return this.options.rootReader.readObject(this.options.rootSource.loadObject())},appendRoot:function(a){this.rootNodes.push(a)},resetStatus4AddRootNodes:function(a){this.options.rootSource.resetStatus(a)},resetStatus:function(a){if(this.options.rootSource.resetStatus(a)){this.clearRoots()}},clearRoots:function(){this.isLoaded=false;this.rootNodes=[]
}});FR.DataSource=FR.extend(FR.OB,{_init:function(){FR.DataSource.superclass._init.apply(this,arguments)},loadObject:function(){return{}},resetStatus:function(){return false},isLocalSource:function(){return true},isLoaded:function(){return true}});FR.ObjectSource=FR.extend(FR.DataSource,{_defaultConfig:function(){return $.extend(FR.ObjectSource.superclass._defaultConfig.apply(),{data:[]})},_init:function(){FR.ObjectSource.superclass._init.apply(this,arguments)},loadObject:function(){return this.options.data
},isLocalSource:function(){return true}});FR.URLSource=FR.extend(FR.DataSource,{_defaultConfig:function(){return $.extend(FR.URLSource.superclass._defaultConfig.apply(this,arguments),{parameter:{},isLoaded:false})},_init:function(){FR.URLSource.superclass._init.apply(this,arguments);this.checkUrl()},checkUrl:function(){if(!this.options.url){FR.Msg.toast("URL is needed to create URLSource!");return}return true},setData:function(a,b){this.options.parameter=a.parameter;this.data=b;this.options.isLoaded=true
},loadObject:function(c){if(!this.checkUrl()){return}var b=this._getEncodeURL();if(this.need2load()){var a=this;FR.ajax({type:"POST",url:(b.length===0?a.options.url:b),data:this.generateParaData(true),async:c!==undefined,complete:function(d){if(!FR.versionRemind(d.responseText)){return}a.fireEvent(FR.Events.AFTERLOAD);a.options.isLoaded=true;a.data=FR.jsonDecode(d.responseText);if(c&&$.isFunction(c)){c.call(a,a.data);return}},error:function(){FR.Msg.toast(FR.i18nText("Data-Get_Data_Error"))}})}if(this.data&&c&&$.isFunction(c)){c.call(this,this.data)
}return this.data},_findShowValue:function(d,e){var b=this._getEncodeURL();var c=this.generateParaData(false);c.cmd="viewvalue";if(e!==false){c.__value__=d}else{c.__text__=d}var f;var a=this;FR.ajax({type:"POST",url:(b.length===0?a.options.url:b),data:c,async:false,complete:function(h){if(!FR.versionRemind(h.responseText)){return}var g=FR.jsonDecode(h.responseText);if(g.value!=undefined){f=g.value}},error:function(){FR.Msg.toast(FR.i18nText("Data-Get_Data_Error"))}});return f},_findAllValue:function(){if(!this.checkUrl()){return
}var b=this._getEncodeURL();var a=this;FR.ajax({type:"POST",url:(b.length===0?a.options.url:b),data:this.generateParaDataWithNoLimit(true),async:false,complete:function(c){if(!FR.versionRemind(c.responseText)){return}a.options.isLoaded=true;a.data=FR.jsonDecode(c.responseText)},error:function(){FR.Msg.toast(FR.i18nText("Data-Get_Data_Error"))}});return this.data},generateParaDataWithNoLimit:function(b){if(this.options.parameter){var c={};for(var a in this.options.parameter){if(!$.isFunction(this.options.parameter[a])){if(a=="startIndex"||a=="limitIndex"){continue
}else{c[a]=(typeof this.options.parameter[a]=="string")?this.options.parameter[a]:FR.jsonEncode(this.options.parameter[a])}}}if(this.reload){c.reload=true}if(b===true){c.reload=true}return c}},_getEncodeURL:function(){var b="";if(this.options.url.indexOf("widgetname")>=0){var a=this.options.url.split("&");$.each(a,function(c,d){if(d.indexOf("widgetname")>=0){a[c]="widgetname="+encodeURIComponent(encodeURIComponent(d.substring(11,d.length)))}});$.each(a,function(c,d){if(c!=a.length-1){b+=d+"&"}else{b+=d
}})}return b},resetStatus:function(a){return this.resetUrl(arguments.length===1?a.url:arguments[0])||this.resetParameter(arguments.length===1?a.parameter:arguments[1])},resetUrl:function(a){if(a!=null&&a!=this.options.url){this.options.url=a;this.clearData();return true}},resetParameter:function(a){if(a!=null&&!FR.equals(this.options.parameter,a)){if(!FR.equals(this.options.parameter["dependence"],a["dependence"])){this.reload=true}else{this.reload=false}this.options.parameter=a;this.clearData();
return true}},need2load:function(){return this.data==null},clearData:function(){if(this.data!=null){this.options.isLoaded=false;delete this.data;this.data=null}},destroy:function(){this.options.url=null;this.options.parameter=null;this.clearData()},generateParaData:function(b){if(this.options.parameter){b=!FR.isEmptyObj(this.options.parameter.dependence)||b;var c={};for(var a in this.options.parameter){if(!$.isFunction(this.options.parameter[a])){c[a]=(typeof this.options.parameter[a]=="string")?this.options.parameter[a]:FR.jsonEncode(this.options.parameter[a])
}}return this.setReloadPara(c,b)}},setReloadPara:function(b,a){if(this.reload){b.reload=true}if(a===true){b.reload=true}return b},isLocalSource:function(){return this.isLoaded()},isLoaded:function(){return this.options.isLoaded}});FR.SynchronObjectSource=FR.extend(FR.DataSource,{_defaultConfig:function(){return $.extend(FR.ObjectSource.superclass._defaultConfig.apply(),{object:[]})},_init:function(){FR.ObjectSource.superclass._init.apply(this,arguments)},loadObject:function(){this.options.data.updateData(this.options.object)
},isLocalSource:function(){return true},resetStatus:function(){return false}});FR.SynchronTreeSource=FR.extend(FR.OB,{_init:function(){FR.SynchronTreeSource.superclass._init.apply(this,arguments)},loadObject:function(){this.options.data.updateData(this.options.treedata)},resetStatus:function(){return false}});FR.SynchronURLSource=FR.extend(FR.URLSource,{_init:function(){FR.SynchronURLSource.superclass._init.apply(this,arguments)},loadObject:function(){if(!this.checkUrl()){return}var a=this;FR.ajax({type:"POST",url:this.options.url,data:this.generateParaData(),complete:function(b){if(!FR.versionRemind(b.responseText)){return
}a.fireEvent(FR.Events.AFTERLOAD);a.options.isLoaded=true;if(a.options.data){a.options.data.updateData(FR.jsonDecode(b.responseText))}},error:function(){FR.Msg.toast(FR.i18nText("Data-Get_Data_Error"))}})},resetParameter:function(b){if(b!=null&&!FR.equals(this.options.parameter,b)){var a=false;if(!FR.equals(this.options.parameter.dependence,b.dependence)){a=true;this.reload=true}else{this.reload=false}if(!FR.equals(this.options.parameter.filter,b.filter)){a=true}this.options.parameter=b;return a}}});
FR.DataReader=FR.extend(FR.Object,{readObject:function(e){if($.isArray(e)){var b=[];var c={};if(this.options){c.createFields=this.options.createFields;c.choosedFields=this.options.choosedFields;c.showField=this.options.showField;c.titleField=this.options.titleField;c.showEmptyValue=this.options.showEmptyValue;c.valueField=this.options.valueField;c.showTemplate=this.options.showTemplate;c.valueTemplate=this.options.valueTemplate}for(var d=0,a=e.length;d<a;d++){c.data=e[d];b.push(new FR.Record(c))}return b
}}});FR.ArrayReader=FR.extend(FR.DataReader,{_init:function(){FR.ArrayReader.superclass._init.apply(this,arguments)}});FR.JSONReader=FR.extend(FR.DataReader,{_init:function(){FR.JSONReader.superclass._init.apply(this,arguments)}});FR.DefaultReader=FR.extend(FR.ArrayReader,{_defaultConfig:function(){return $.extend(FR.DefaultReader.superclass._defaultConfig.apply(this,arguments),{showField:"text",titleField:"titleText",valueField:"value"})},_init:function(){FR.DefaultReader.superclass._init.apply(this,arguments)
}});FR.NodeReader=FR.extend(FR.DataReader,{_init:function(){FR.NodeReader.superclass._init.apply(this,arguments)},readObject:function(e){if(!$.isArray(e)){e=[e]}var b=[];var c=this.nodeProperties();for(var d=0,a=e.length;d<a;d++){c.data=e[d];b.push(new FR.Node(c))}return b},nodeProperties:function(){var a={};if(!this.options){return}a.createFields=this.options.createFields;a.choosedFields=this.options.choosedFields;a.showField=this.options.showField;a.titleField=this.options.titleField;a.showEmptyValue=this.options.showEmptyValue;
a.valueField=this.options.valueField;a.showTemplate=this.options.showTemplate;a.valueTemplate=this.options.valueTemplate;a.parameterFields=this.options.parameterFields;a.hasChildren=this.options.hasChildren;a.type=this.options.type;a.id=this.options.id;a.parentID=this.options.parentID;a.url=this.options.url;a.parent=this.options.parent;a.selectedField=this.options.selectedField;a.children=this.options.children;return a}});FR.DefaultNodeReader=FR.extend(FR.NodeReader,{_init:function(){FR.DefaultNodeReader.superclass._init.apply(this,arguments)
},nodeProperties:function(){return{url:this.options.url,id:"id",parentID:"parentID",showField:"text",titleField:"titleText",valueField:"value",hasChildren:"hasChildren",children:"ChildNodes",parameterFields:["id","value"],choosedFields:["isexpand","nodeicon","classes","showcheck","checkstate"],parent:this.options.parent}}});FR.DefaultSynchronNodeReader=FR.extend(FR.NodeReader,{_init:function(){FR.DefaultSynchronNodeReader.superclass._init.apply(this,arguments)},nodeProperties:function(){return{id:"id",parentID:"parentID",showField:"text",titleField:"titleText",valueField:"value",hasChildren:"hasChildren",children:"ChildNodes",parameterFields:["id","value"],choosedFields:["isexpand","nodeicon","classes","showcheck","checkstate"],parent:this.options.parent}
}});FR.Data=FR.extend(FR.Object,{_defaultConfig:function(){return $.extend(FR.DataReader.superclass._defaultConfig.apply(this,arguments),{records:[]})},_init:function(){FR.Data.superclass._init.apply(this,arguments);if(!this.options.dataSource){this.options.dataSource=new FR.ObjectSource()}if(!this.options.dataReader){this.options.dataReader=new FR.DataReader()}this.records=this.options.records},executeData:function(){if(this.options.dataSource&&this.options.dataReader){return this.options.dataReader.readObject(this.options.dataSource.loadObject())
}},getData:function(){return this.getRecords()},setData:function(a,b){if(this.options.dataSource){this.options.dataSource.setData(a,b)}this.records=this.executeData()},appendData:function(){var a=this.executeData();Array.prototype.push.apply(this.records,a);return a},getRecords:function(){if(this.records&&this.records.length>0){return this.records}this.records=this.executeData();return this.records},loadRecordsAsync:function(c){var a=this;if(this.records&&this.records.length>0){if($.isFunction(c)){c.call(this,this.records);
return}}if(this.options.dataSource&&this.options.dataReader){var b=function(d){if(c&&$.isFunction(c)){c.call(a,a.options.dataReader.readObject(d))}};a.options.dataSource.loadObject(b)}},getLoadedRecords:function(){return this.records},getLength:function(){var a=this.getRecords();if(!a){return 0}return a.length},getRecord:function(a){return this.getRecords()[a]},addRecord:function(a){this.getRecords().push(a)},removeRecord:function(a){if(typeof a=="number"){this.getRecords().splice(a,1)}else{if(typeof a=="object"){this.getRecords().remove(a)
}}},clearData:function(){if(this.records&&this.records.length>0){delete this.records;this.records=[]}},resetStatus:function(a){if(this.options.dataSource.resetStatus(a)){this.clearData()}},resetStatusKeepData:function(a){this.options.dataSource.resetStatus(a)},isLocalSource:function(){return this.options.dataSource.isLocalSource()},isLoaded:function(){return this.options.dataSource.isLoaded()}});FR.LocalTreeData=FR.extend(FR.OB,{_init:function(){},updateData:function(){},getData:function(){}});FR.TreeData=FR.extend(FR.OB,{_init:function(){FR.TreeData.superclass._init.apply(this,arguments);
if(!this.options.treeLoader&&!this.options.url){FR.Msg.toast("DataUrl or TreeLoader is needed to create TreeData.");return}if(!this.options.treeLoader&&this.options.url){this.options.treeLoader=FR.DataFactory.createDefaultRootNodes(this.options.url)}},getData:function(){return this.options.treeLoader.getRootNodes()},loadRecordsAsync:function(a){return this.options.treeLoader.getRootNodesAsync(a)},loadNodes:function(){this.options.treeLoader.loadNodes()},getChildrenLength:function(){return this.options.treeLoader.getRootNodes().length
},appendRoot:function(a){this.options.treeLoader.add(a)},resetStatus4AddRootNodes:function(a){this.options.treeLoader.resetStatus4AddRootNodes(a)},resetStatus:function(a){this.options.treeLoader.resetStatus(a)},setData:function(a,b){this.options.treeLoader.clearRoots();this.options.treeLoader.options.rootSource.setData(a,b)},afterRead:function(a){if(!a){return false}return this.options.treeLoader.on(FR.Events.AFTERREAD,a)},appendDataEvent:function(a){if(!a){return false}return this.options.treeLoader.on(FR.Events.APPENDDATA,a)
},isLocalSource:function(){return false}});FR.SynchronData=FR.extend(FR.OB,{_init:function(){FR.SynchronData.superclass._init.apply(this,arguments);if(!this.options.url&&!this.options.dataSource){FR.Msg.toast("SourceURL is needed to create SynchronData");return}if(!this.options.dataSource){this.options.dataSource=new FR.SynchronURLSource({url:this.options.url})}if(!this.options.dataReader){this.options.dataReader=new FR.DefaultReader()}this.options.dataSource.options.data=this;this.records=[]},updateData:function(b){var a=this.options.dataReader.readObject(b);
var c=this.records.length;this.appendData(a);return c?this.fireEvent(FR.Events.APPENDDATA,a):this.fireEvent(FR.Events.AFTERREAD,a)},addRecord:function(a){this.records.push(a)},removeRecord:function(a){this.records.remove(a)},getData:function(){return this},loadData:function(){this.options.dataSource.loadObject()},appendData:function(a){if(a!=null){Array.prototype.push.apply(this.records,a)}},getRecords:function(){return this.records},getLoadedRecords:function(){return this.records},getLength:function(){return this.getRecords().length
},getRecord:function(a){return this.records[a]},afterRead:function(a){if(!a){return false}return this.on(FR.Events.AFTERREAD,a)},clearData:function(){if(this.records&&this.records.length>0){delete this.records;this.records=[]}},appendDataEvent:function(a){if(!a){return false}return this.on(FR.Events.APPENDDATA,a)},resetStatus:function(a){this.options.dataSource.resetStatus(a);delete this.records;this.records=[];return true}});FR.SynchronTreeData=FR.extend(FR.OB,{_init:function(){FR.SynchronTreeData.superclass._init.apply(this,arguments);
if(!this.options.url&&!this.options.dataSource){FR.Msg.toast("SourceURL is needed to create SynchronTreeData");return}if(!this.options.dataSource){this.options.dataSource=new FR.SynchronURLSource({url:this.options.url})}if(!this.options.dataReader){this.options.dataReader=new FR.DefaultSynchronNodeReader()}this.options.dataSource.options.data=this;this.nodes=[]},updateData:function(b){var a=this.options.dataReader.readObject(b);var c=this.nodes.length;this.appendData(a);return c?this.fireEvent(FR.Events.APPENDDATA,a):this.fireEvent(FR.Events.AFTERREAD,a)
},getData:function(a){if(a&&$.isFunction(a)){a.call(this,this.nodes)}},loadNodes:function(){this.loadData()},loadData:function(){this.options.dataSource.loadObject()},appendData:function(b){for(var c=0,a=b.length;c<a;c++){var d;if(b[c].getParentID()!=null){d=this.getParentNodeByParentID(b[c].getParentID())}else{d=this.getParentNode(b[c].getID())}if(d){d.addNode(b[c])}else{this.nodes.push(b[c])}}},removeData:function(b){var a=b.getParent();if(a){a.removeNode(b)}else{this.nodes.remove(b)}},getParentNodeByParentID:function(d){for(var c=0,a=this.nodes.length;
c<a;c++){var b=this.getNodeByID(this.nodes[c],d);if(b){return b}}},getNodeByID:function(e,f){if(e.getID()==f){return e}var c=e.getChildren();for(var b=0,a=c.length;b<a;b++){var d=this.getNodeByID(c[b],f);if(d){return d}}},getParentNode:function(e){e=e.toString();var b=e.split("-");if(b.length<2){return}var d=this.nodes[b[0]-1];for(var c=1,a=b.length-1;c<a;c++){d=d.getChild(b[c]-1)}return d},getAllNodesLength:function(){var c=this.nodes.length;for(var b=0,a=this.nodes.length;b<a;b++){c+=this.executeLength(this.nodes[b])
}return c},isEmptyData:function(){return this.nodes.length<1},executeLength:function(c){var d=c.getChildrenLength();for(var b=0,a=c.getChildrenLength();b<a;b++){d+=this.executeLength(c.getChild(b))}return d},afterRead:function(a){if(!a){return false}return this.on(FR.Events.AFTERREAD,a)},appendDataEvent:function(a){if(!a){return false}return this.on(FR.Events.APPENDDATA,a)},getLastRootNode:function(){return this.nodes[this.nodes.length-1]},resetStatus:function(a){if(this.options.dataSource.resetStatus(a)){delete this.nodes;
this.nodes=[];return true}},isLocalSource:function(){return false}});FR.AjaxSearchData=FR.extend(FR.URLSource,{_init:function(){FR.AjaxSearchData.superclass._init.apply(this,arguments)},loadObject:function(d){if(!this.checkUrl()){return}var b=this;var c="";if(this.options.url.indexOf("widgetname")>=0){var a=this.options.url.split("&");$.each(a,function(e,f){if(f.indexOf("widgetname")>=0){a[e]="widgetname="+encodeURIComponent(encodeURIComponent(f.substring(11,f.length)))}});$.each(a,function(e,f){if(e!=a.length-1){c+=f+"&"
}else{c+=f}})}else{c=this.options.url}FR.ajax({type:"POST",url:c,data:this.generateParaData(false),async:true,complete:function(e){if(!FR.versionRemind(e.responseText)){return}b.fireEvent(FR.Events.AFTERLOAD);b.options.isLoaded=true;if($.isFunction(d)){d.call(b,FR.jsonDecode(e.responseText))}},error:function(){FR.Msg.toast(FR.i18nText("Data-Get_Data_Error"))}})}});FR.ItemTreeData=FR.extend(FR.OB,{_init:function(){FR.ItemTreeData.superclass._init.apply(this,arguments);if(!this.options.items){FR.Msg.toast("Tree Node Items is needed to create ItemTreeData.");
return}var a=this.options.items;if(typeof a=="string"){a=FR.jsonDecode(a)}if($.isArray(a)&&a.length>0&&!(a[0] instanceof FR.Node)){a=new FR.DefaultNodeReader().readObject(a)}this.nodes=a},getData:function(a){if(a&&$.isFunction(a)){a.call(this,this.nodes)}else{return this.nodes}},isLocalSource:function(){return false},resetStatus:function(){},appendDataEvent:function(){},loadNodes:function(){}});FR.DataFactory={};$.extend(FR.DataFactory,{createArrayData:function(a,b){return new FR.Data({dataSource:new FR.ObjectSource({data:a}),dataReader:new FR.DefaultReader(b)})
},createSynchronArrayData:function(a){return new FR.SynchronData({dataSource:new FR.SynchronObjectSource({object:a}),dataReader:new FR.DefaultReader()})},createJSONData:function(b,a){return new FR.Data({dataSource:new FR.URLSource({url:b}),dataReader:new FR.DefaultReader(a)})},createSynchronJSONData:function(a,b){return new FR.SynchronData({dataSource:new FR.SynchronURLSource({url:a,async:!!b}),dataReader:new FR.DefaultReader()})},createEmptyData:function(){return new FR.Data()},createItemRecord:function(a){return new FR.Record({data:a,showField:"text",valueField:"value",titleField:"titleText"})
},createDefaultRootNodes:function(a){return new FR.RootNodeLoader({url:a})}});
FR.DatePicker=FR.extend(FR.Widget,{CONSTS:{VIEWMODE:{YM:0,YMD:1,HMS:2,YMDHMS:3},MINYEAR:1900,MAXYEAR:2999,NAV:{"prevm":2,"nextm":3,"title":4,"clear":5,"today":6,"dok":7,"prevy":8,"nexty":9,"cancel":10,"mok":11,"plus":12,"minus":13,"firstday":14,"current":15,"day":100,"month":200,"year":300},FIRSTDAY:0},_TT:{CALENDAR:FR.i18nText("FR-Basic_Calendar"),WK:FR.i18nText("FR-Basic_Week"),CLEAR:FR.i18nText("FR-Basic_Clear"),TODAY:FR.i18nText("FR-Basic_Today"),OK:FR.i18nText("FR-Basic_OK"),CANCEL:FR.i18nText("FR-Basic_Cancel"),CURRENT:FR.i18nText("FR-Basic_Current")},_defaultConfig:function(){return $.extend(FR.DatePicker.superclass._defaultConfig.apply(this,arguments),{widgetName:"datepicker",inputField:null,format:null,viewMode:1,endDate:null,startDate:null,date:null,dateFormat:null,onDateUpdate:null,onClear:function(){this._hideView()
},onOK:function(){this._hideView()},onClose:function(){this._hideView()},onToday:function(){this._hideView()}})},_hideView:function(){if(FR.Browser.isIE8()){this.element.css("visibility","hidden")}else{this.element.hide()}},_init:function(){FR.DatePicker.superclass._init.apply(this,arguments);this.element.addClass("fr-datepicker");this.cache={showYear:null,showMonth:null};this._initTables();this._bindEvts()},_initTables:function(){var a=this.options;this.$datetable=this._createDatePicker();this._loadDateData(this.$datetable,new Date(this.options.date));
this.$monthtable=this._createMonthPicker();this.$timetable=this._createTimePicker();switch(a.viewMode){case this.CONSTS.VIEWMODE.YM:this._loadMonthData(this.$monthtable,new Date(this.options.date));this.$monthtable.appendTo(this.element).show();break;case this.CONSTS.VIEWMODE.HMS:this._loadTimeData(this.$timetable,this.options.date);this._addTimeOptPane(this.$timetable);this.$timetable.appendTo(this.element).show();break;case this.CONSTS.VIEWMODE.YMD:this.$datetable.appendTo(this.element).show();
this.$monthtable.hide().appendTo(this.element);break;default:this.$datetable.appendTo(this.element).show();this.$monthtable.hide().appendTo(this.element);var b=$("<tr/>").prependTo(this.$datetable.find("tfoot"));this._loadTimeData(this.$timetable,this.options.date);this.$timetable.show().appendTo($('<td colspan="8" class="time"/>').appendTo(b));break}},_createTimePicker:function(){var g=$('<table cellspacing = "0" cellpadding = "0" class="tt"/>');var b=$("<tbody>").appendTo(g);var h=this,a=this.options,d=this.CONSTS.NAV;
g.$h=$("<input/>").data("time","h").keyup(function(){var k=this.value;var j=parseInt(k,10);if(j<24&&j>=0){a.date.setHours(j);FR.applyFunc(h,a.onDateUpdate,arguments)}}).focus(function(){g.focus=$(this)}).mousedown(function(j){j.stopPropagation()});g.$m=$("<input/>").data("time","m").keyup(function(){var k=this.value;var j=parseInt(k,10);if(j<60&&j>=0){a.date.setMinutes(j);FR.applyFunc(h,a.onDateUpdate,arguments)}}).focus(function(){g.focus=$(this)}).mousedown(function(j){j.stopPropagation()});g.$s=$("<input/>").data("time","s").keyup(function(){var k=this.value;
var j=parseInt(k,10);if(j<60&&j>=0){a.date.setSeconds(j);FR.applyFunc(h,a.onDateUpdate,arguments)}}).focus(function(){g.focus=$(this)}).mousedown(function(j){j.stopPropagation()});g.focus=g.$s;var c=$("<td/>").html("&and;").data("nav",d["plus"]);var i=$("<td/>").html("&or;").data("nav",d["minus"]);var f=$("<tr/>").append($('<td rowspan="2"/>').text(FR.i18nText("FR-Basic_Time"))).append($('<td rowspan="2"/>').append(g.$h)).append($('<td class="common" rowspan="2"/>').text(":")).append($('<td rowspan="2"/>').append(g.$m)).append($('<td class="common" rowspan="2"/>').text(":")).append($('<td rowspan="2"/>').append(g.$s)).append(c).appendTo(b);
var e=$("<tr/>").append(i).appendTo(b);b.find("input").mousewheel(function(j){if(this.D<0){h._doTimeInc(g,$(this))}else{h._doTimeDec(g,$(this))}return false});return g},_addTimeOptPane:function(d){var c=this.CONSTS.NAV;var a=$("<tfoot/>");var b=$('<tr class="optbtns"/>').appendTo(a);this._createCell(b,this._TT["CLEAR"],2,c["clear"],"clear");this._createCell(b,this._TT["CURRENT"],3,c["current"],"current");this._createCell(b,this._TT["OK"],2,c["dok"],"ok");a.appendTo(d)},_createDatePicker:function(){var j=$('<table cellspacing = "0" cellpadding = "0" class="dt"/>');
var a=this.CONSTS.NAV;var f=$("<thead/>").appendTo(j);k=$('<tr class = "mainhead"/>');j.$prevm=this._createCell(k,"&lsaquo;",1,a["prevm"],"prevm");j.$title=$('<td class="title" colspan="6"/>').data("nav",a["title"]).appendTo(k);j.$nextm=this._createCell(k,"&rsaquo;",1,a["nextm"],"nextm");k.appendTo(f);k=$("<tr/>");$('<td class="name wn">'+this._TT["WK"]+"</td>").appendTo(k);for(var c=7;c>0;--c){$("<td/>").appendTo(k)}for(var c=0;c<7;++c){var b=k.children().eq(c+1);var e=(c+this.CONSTS.FIRSTDAY)%7;
b.addClass("day name").text(Date._SDN[e]);if([0,6].indexOf(e)!=-1){b.addClass("weekend")}if([0,1].indexOf(e)!=-1){b.addClass("fd").data("nav",this.CONSTS.NAV["firstday"]).data("fd",e)}}k.appendTo(f);var d=$('<tbody onselectstart="return false"/>').appendTo(j);for(c=6;c>0;c--){var k=$("<tr/>").appendTo(d);for(var h=0;h<=7;h++){$("<td/>").appendTo(k)}}var g=$("<tfoot/>").appendTo(j);var k=$('<tr class = "optbtns"/>');this._createCell(k,this._TT["CLEAR"],2,a["clear"],"clear");this._createCell(k,this._TT["TODAY"],4,a["today"],"today");
this._createCell(k,this._TT["OK"],2,a["dok"],"ok");k.appendTo(g);return j},_createMonthPicker:function(){var c=$('<table cellspacing = "0" cellpadding = "0" class="mt"/>');var f=this.CONSTS.NAV;var b=$('<tbody class="datemenubody"/>').appendTo(c);var e=$('<tr class="datemenutr"/>').appendTo(b);for(var g=0;g<2;g++){$('<td class="month"/>').appendTo(e)}this._createCell(e,"&laquo;",1,f["prevy"]," prevy");this._createCell(e,"&raquo;",1,f["nexty"]," nexty");for(var a=0;a<5;a++){e=$("<tr/>").appendTo(b);
$('<td class="month"/><td class="month"/>'+'<td class="year"/><td class="year"/>').appendTo(e)}var d=$("<tfoot/>").appendTo(c);e=$('<tr class="optbtns"/>').appendTo(d);this._createCell(e,this._TT["OK"],2,f["mok"],"ok");this._createCell(e,this._TT["CANCEL"],2,f["cancel"],"cancel");return c},_toPrevMonth:function(){var d=this.options.startDate,a=this.options.date;var c=this.cache.showMonth,b=this.cache.showYear;if(!d){if(c>0){this._setMonth(c-1)}else{a.setFullYear(b-1);this._setMonth(11)}return}if(b>d.getFullYear()){if(c>0){this._setMonth(c-1)
}else{a.setFullYear(b-1);this._setMonth(11)}}else{if(b==d.getFullYear()){if(c>d.getMonth()&&c>0){this._setMonth(c-1);if(a<d){a=new Date(d)}}}}},_toNextMonth:function(){var b=this.options.endDate,a=this.options.date;var d=this.cache.showMonth,c=this.cache.showYear;if(!b){if(d<11){this._setMonth(d+1)}else{a.setFullYear(c+1);this._setMonth(0)}return}if(c<b.getFullYear()){if(d<11){this._setMonth(d+1)}else{a.setFullYear(c+1);this._setMonth(0)}}else{if(c==b.getFullYear()){if(d<b.getMonth()){this._setMonth(d+1);
if(a>b){a=new Date(b)}}}}},_toPrevDecade:function(){var e=this.options.startDate,a=this.options.date;var b=a.getFullYear()-10,d=a.getMonth();var c,f;if(e&&b==(f=e.getFullYear())){c=e.getMonth()}if(!f||f<this.CONSTS.MINYEAR){f=this.CONSTS.MINYEAR}if(b<f){a.setFullYear(f);if(d<c){a.setMonth(c)}}else{a.setFullYear(b)}},_toNextDecade:function(){var c=this.options.endDate,b=this.options.date;var d=b.getFullYear()+10,e=b.getMonth();var f,a;if(c&&d==(a=c.getFullYear())){f=c.getMonth()}if(!a||a>this.CONSTS.MAXYEAR){a=this.CONSTS.MAXYEAR
}if(d>a){b.setFullYear(a);if(e<f){b.setMonth(f)}}else{b.setFullYear(d)}},_setMonth:function(b){var f=this.options.date;var d=f.getDate(),e=this.options.endDate,c=this.options.startDate;var a=f.getMonthDays(b);if(d>a){f.setDate(a)}f.setMonth(b);if(e&&f>e){f.setDate(e.getDate())}if(c&&f<c){f.setDate(c.getDate())}},_loadDateData:function(s,u){if(!u){return}var g=u.getFullYear(),v=u.getMonth(),p=u.getDate();var t=new Date(),k=t.getFullYear(),w=t.getMonth(),a=t.getDate();this.cache.showYear=g;this.cache.showMonth=v;
var x=this.options.startDate,r=this.options.endDate;s.$title.text(Date._MN[v]+", "+g);var b=new Date(u);b.setDate(b.getMonthDays()+1);if((r&&b>r)||b.getFullYear()>this.CONSTS.MAXYEAR){s.$nextm.addClass("disabled").removeClass("hover").data("disabled",true)}else{s.$nextm.removeClass("disabled").data("disabled",false)}var o=new Date(u);o.setDate(0);if((x&&o<x)||o.getFullYear()<this.CONSTS.MINYEAR){s.$prevm.addClass("disabled").removeClass("hover").data("disabled",true)}else{s.$prevm.removeClass("disabled").data("disabled",false)
}u.setDate(1);var l=(u.getDay()-this.CONSTS.FIRSTDAY)%7;u.setDate(0-l);u.setDate(u.getDate()+1);var m=s.find("tbody").children().eq(0);for(var q=0;q<6;q++){if(!m.length){break}var d=m.children().eq(0);d.addClass("week wn").text(u.getWeekNumber());var e;for(var n=0;n<7;++n,u.setDate(e+1)){d=d.next();d.removeClass().data("nav",this.CONSTS.NAV["day"]);if(!d.length){break}e=u.getDate();d.text(e);var h=(u.getMonth()==v);if(!h){d.addClass("oday").data("disabled",true);continue}var c=false;if((x!=null&&x>u)||(r!=null&&r<u)){d.addClass("day disabled");
c=true}else{d.addClass("day")}d.data("disabled",c);if(!c){if(h&&e==p){this.cache.selectedDate&&this.cache.selectedDate.removeClass("selected");d.addClass("selected");this.cache.selectedDate=d;this.cache.showDay=e}if(u.getFullYear()==k&&u.getMonth()==w&&e==a){d.addClass("today")}var f=u.getDay();if([0,6].indexOf(f)!=-1){d.addClass("weekend")}}}m=m.next()}},_loadMonthData:function(r,s){if(!s){return}var g=s.getFullYear(),u=s.getMonth();var h=$(r).data("midYear");if(!h){h=g}else{if(g>h+5){h+=10}else{if(g<h-4){h-=10
}}}$(r).data("midYear",h);var l=[h-4,h-3,h-2,h-1,h,h+1,h+2,h+3,h+4,h+5];var d=$("td.year",r);var j=$("td.month",r);var k=this.options;var e=k.endDate;var a=k.startDate;var b,c,t,n;if(e){if(e&&g==(b=e.getFullYear())){c=e.getMonth()}}if(!b||b>this.CONSTS.MAXYEAR){b=this.CONSTS.MAXYEAR}if(a){if(a&&g==(t=a.getFullYear())){n=a.getMonth()}}if(!t||t<this.CONSTS.MINYEAR){t=this.CONSTS.MINYEAR}for(var m=0;m<12;m++){var v=j.eq(m).text(Date._MN[m]).data("nav",this.CONSTS.NAV["month"]).data("month",m);if(m==u){this.cache.selectedMonth&&this.cache.selectedMonth.removeClass("selected");
v.addClass("selected");this.cache.selectedMonth=v}if((!FR.isEmpty(n)&&m<n)||(!FR.isEmpty(c)&&m>c)){v.addClass("disabled").data("disabled",true)}else{v.removeClass("disabled").data("disabled",false)}if(m<10){var f=d.eq(m).text(l[m]).data("nav",this.CONSTS.NAV["year"]);if(l[m]==g){this.cache.selectedYear&&this.cache.selectedYear.removeClass("selected");f.addClass("selected");this.cache.selectedYear=f}if((!FR.isEmpty(t)&&l[m]<t)||(!FR.isEmpty(b)&&l[m]>b)){f.addClass("disabled").data("disabled",true)
}else{f.removeClass("disabled").data("disabled",false)}}}var p=$("td.prevy",r).removeClass("disabled").data("disabled",false);if(l[0]<=t){p.addClass("disabled").data("disabled",true).removeClass("hover")}var q=$("td.nexty",r).removeClass("disabled").data("disabled",false);if(l[9]>=b){q.addClass("disabled").data("disabled",true).removeClass("hover")}},_loadTimeData:function(d,c){if(!c){return}var a=c.getHours(),e=c.getMinutes(),b=c.getSeconds();d.$h.val(String.leftPad(a,2,"0"));d.$m.val(String.leftPad(e,2,"0"));
d.$s.val(String.leftPad(b,2,"0"))},_doTimeInc:function(e,a){var b=a.data("time"),d=this.options;if(b==="h"){var c=(d.date.getHours()+1)%24;d.date.setHours(c);e.$h.val(String.leftPad(c,2,"0"))}else{if(b==="m"){var c=(d.date.getMinutes()+1)%60;d.date.setMinutes(c);e.$m.val(String.leftPad(c,2,"0"))}else{var c=(d.date.getSeconds()+1)%60;d.date.setSeconds(c);e.$s.val(String.leftPad(c,2,"0"))}}a.select();FR.applyFunc(this,d.onDateUpdate,arguments)},_doTimeDec:function(e,a){var b=a.data("time"),d=this.options;
if(b==="h"){var c=(d.date.getHours()+23)%24;d.date.setHours(c);e.$h.val(String.leftPad(c,2,"0"))}else{if(b==="m"){var c=(d.date.getMinutes()+59)%60;d.date.setMinutes(c);e.$m.val(String.leftPad(c,2,"0"))}else{var c=(d.date.getSeconds()+59)%60;d.date.setSeconds(c);e.$s.val(String.leftPad(c,2,"0"))}}a.select();FR.applyFunc(this,d.onDateUpdate,arguments)},_bindEvts:function(){this.element.unbind();var a=this,g=this.options,d=this.CONSTS.NAV;var c=this.$monthtable,e=this.$datetable,f=this.$timetable;var b=function(l){var m=l.target;
var k=l.type;var j=$(m).data("nav");if($(m).data("disabled")||m.tagName!=="TD"||!j){return}if(!a.options.date){a.options.date=new Date()}if(k==="mouseover"){$(m).addClass("hover")}else{if(k==="mouseup"){switch(j){case d["prevm"]:a._toPrevMonth();a._loadDateData(e,new Date(a.options.date));FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["nextm"]:a._toNextMonth();a._loadDateData(e,new Date(a.options.date));FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["title"]:a._loadMonthData(c,new Date(a.cache.showYear,a.cache.showMonth));
c.css({position:"absolute",top:0,"z-index":FR.widget.opts.zIndex++}).show("fast");break;case d["clear"]:a.options.date=null;a.cache.selectedDate&&a.cache.selectedDate.removeClass("selected");FR.applyFunc(a,g.onDateUpdate,arguments);FR.applyFunc(a,g.onClear,arguments);break;case d["current"]:a.options.date=new Date();FR.applyFunc(a,g.onDateUpdate,arguments);case d["today"]:var h=new Date();if((a.options.startDate&&h<a.options.startDate)||(a.options.endDate&&h>a.options.endDate)){return}else{a.options.date=h
}FR.applyFunc(a,g.onDateUpdate,arguments);FR.applyFunc(a,g.onToday,arguments);break;case d["dok"]:FR.applyFunc(a,g.onDateUpdate,arguments);FR.applyFunc(a,g.onOK,arguments);break;case d["prevy"]:a._toPrevDecade();a._loadMonthData(c,new Date(a.options.date));FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["nexty"]:a._toNextDecade();a._loadMonthData(c,new Date(a.options.date));FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["mok"]:a._loadDateData(e,new Date(a.options.date));FR.applyFunc(a,g.onDateUpdate,arguments);
c.hide("fast");break;case d["cancel"]:a._loadDateData(e,new Date(a.options.date));c.hide("fast");break;case d["year"]:a.cache.selectedYear&&a.cache.selectedYear.removeClass("selected");a.cache.selectedYear=$(m);var i=a.options.date;i.setFullYear($(m).text());a._loadMonthData(c,new Date(i));FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["month"]:a.cache.selectedMonth&&a.cache.selectedMonth.removeClass("selected");a.cache.selectedMonth=$(m).addClass("selected");a.options.date.setDate(1);a.options.date.setMonth($(m).data("month"));
FR.applyFunc(a,g.onDateUpdate,arguments);break;case d["day"]:a.cache.selectedDate&&a.cache.selectedDate.removeClass("selected");a.cache.selectedDate=$(m).addClass("selected");var i=a.options.date;i.setFullYear(a.cache.showYear);i.setMonth(a.cache.showMonth);i.setDate($(m).text());FR.applyFunc(a,g.onDateUpdate,arguments);if(!f.parent().length){FR.applyFunc(a,g.onClose,arguments)}break;case d["plus"]:a._doTimeInc(f,f.focus);break;case d["minus"]:a._doTimeDec(f,f.focus);break;case d["firstday"]:a.CONSTS.FIRSTDAY=$(m).data("fd");
a.element.empty();a._init();default:break}}else{if(k==="mouseout"){$(m).removeClass("hover")}}}};this.element.bind("mousedown",b).bind("mouseover",b).bind("mouseup",b).bind("mouseout",b)},_createCell:function(c,e,f,d,a){var b=$("<td class/>").attr("colSpan",f).html(e).appendTo(c);if(d){b.data("nav",d)}a=a?"btn "+a:"btn";b.addClass(a);return b},getValue:function(){return this.options.date},setValue:function(a){this.options.date=a},getText:function(){return this.getValue()},setText:function(a){this.setValue(a)
}});$.shortcut("datepicker",FR.DatePicker);
(function(){FR.BaseEditor=FR.extend(FR.Widget,{isSupportDatabinding:function(){return true},loadData:function(){if(this.options.widgetName){var a=this.options.form.formData[this.options.widgetName];if(a){this.setValue(a,false)}}},store:function(){if(this.options.Databinding){var a=this.options.Databinding.Name;var b=this.options.Databinding.Key;if(a&&b){var d=this.getValue();var c=this.options.form.formData.setValue(a,b,d)}}},getValue:function(){},getEditValue:function(){},setValue:function(a){if(!this.isValidate(a)){return false
}if((a||a===0)&&this.options.watermark){this.clearWaterMark()}if(arguments[1]!=undefined){this._dealValueWithEvents(a,arguments[1])}else{this._dealValueWithEvents(a,false)}},_dealValueWithEvents:function(b,a){},dealWithDisplayValue:function(a){},getText:function(){return this.getValue()},setText:function(a){this.setValue(a)},clearWaterMark:function(){},getErrorMsg:function(){return this.errorMsg},checkValid:function(a){if(this.isValidate(a)){this.validateCss();return true}else{this.invalidateCss();
return false}},isValidate:function(c){var f=c!=null&&c!=undefined?c:this.getValue();var e=this.options.regex;if(f==null||f===""||FR.isEmptyArray(f)){return this.validateEmptyValue(f)}if(e){for(var b=0,a=FR.BaseEditor.PluginRegex.length;b<a;b++){var g=FR.BaseEditor.PluginRegex[b];if(g.text===e){if(g.regex(f)){return true}else{this.errorMsg=FR.i18nText("FR-Base_Error_Input_Value");return false}}}if(typeof e=="string"){try{e=new RegExp(e)}catch(d){this.errorMsg="invalid Regular expressions";return false
}}if(!e.test(f)){if(!(e.source.indexOf(".{")>-1&&e.test((f+"").replace(/\n/g,"aa")))){this.errorMsg=this.options.regErrorMsg||FR.i18nText("FR-Base_Error_Input_Value");return false}}}return true},validateEmptyValue:function(b){var a=this.options.allowBlank!==false;if(a){return true}else{this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des");return false}},initData:function(){if(this.options.data){return}if(this.options.widgetUrl){this.options.data=FR.DataFactory.createJSONData(this.options.widgetUrl,this.options)
}else{if(this.options.items){this.options.data=FR.DataFactory.createArrayData(this.options.items,this.options)}}},getDependenceObj:function(){var b=this.options;var e={};if(b.dependenceMap){var j=this;$.each(b.dependenceMap,function(l,n){if(j.options.form){var p=j.options.form.resolveVariable(n);if(p!="FR.primitive"&&p!=null){e[l.toUpperCase()]=p}}else{if(j.options.write){n=n.startWith("$")?n.substring(1):n;var m;if(j.options.write){var o=j.options.write.getWidgetByCell(n)||j.options.write.getWidgetByName(n);
if(o){m=o.getValue()}}if(m==undefined){var k=FR.cellStr2ColumnRow(n);if(k){var q=contentPane.curLGP.getTDCell(k);if(q){m=FR.getCellValue(q)}}}if(m!="FR.primitive"&&m!=null&&m!=undefined&&m!=""){e[l.toUpperCase()]=m}}}})}else{if(FR.isArray(b.dependence)){for(var i=0;i<b.dependence.length;i++){var h=b.dependence[i];if(this.options.form){var d=this.options.form.resolveVariable(h);if(d!="FR.primitive"&&d!=null){e[h.toUpperCase()]=d}}else{if(this.options.write){h=h.startWith("$")?h.substring(1):h;var g;
if(contentPane.curLGP.write){var f=contentPane.curLGP.write.getWidgetByCell(h)||contentPane.curLGP.write.getWidgetByName(h);if(f){g=f.getValue()}}if(!g){var c=FR.cellStr2ColumnRow(h);if(c){var a=contentPane.curLGP.getTDCell(c);if(a){g=FR.getCellValue(a)}}}if(g!="FR.primitive"&&g!=null){e[h.toUpperCase()]=g}}}}}}return e},createDependencePara4Data:function(){var a=this.getDependenceObj();var b=FR.isEmptyObj(a)?{}:{dependence:a};return{parameter:b}},reset:function(){this.setValue("")}});FR.BaseEditor.PluginRegex=[];
FR.EditCompBaseEditor=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return $.extend(FR.EditCompBaseEditor.superclass._defaultConfig.apply(),{})},setWaterMark:function(a){if(a==undefined){a=this.options.watermark}FR.$defaultImport("/com/fr/web/core/js/jquery.watermark.js","js");this.editComp.watermark(a,this.options.isEditable)},removeWaterMark:function(){FR.$defaultImport("/com/fr/web/core/js/jquery.watermark.js","js");this.editComp.watermark({remove:true})},clearWaterMark:function(){FR.$defaultImport("/com/fr/web/core/js/jquery.watermark.js","js");
this.editComp.watermark({clear:true})},validateCss:function(){this.editComp.removeClass("fr-invalid");this.editComp.removeAttr("title")},invalidateCss:function(){this.editComp.addClass("fr-invalid");this.editComp.attr("title",this.getErrorMsg())}});FR.EditComp=FR.extend(FR.EditCompBaseEditor,{_defaultConfig:function(){return $.extend(FR.EditComp.superclass._defaultConfig.apply(),{cls:"fr-texteditor",width:120,height:22,autoVerify:false})},_init:function(){FR.EditComp.superclass._init.apply(this,arguments);
var a=this;var b=this.options;this.editComp=this._createEditComp();if(FR.Browser.isIE()){this.editComp.on("paste",function(){var c=window.clipboardData.getData("Text");c=c.replace(/\s|\n/g," ");this.value=this.value?this.value.append(c):c;return false})}this.editComp.appendTo(this.element);if(b.fontSize){this.editComp.css("font-size",b.fontSize)}this.validateCss();this.editComp.attr("name",b.widgetName).addClass(b.cls);if(FR.Browser.isIE8()){this.editComp.css("margin-top",0)}if(b.text){this.editComp.attr("value",b.text)
}if(b.id){this.editComp.attr("id",b.id)}if(b.disabled===true){this.editComp.attr("disabled","disabled")}b.width=(b.width>-1)?b.width:120;b.height=(b.height>-1)?b.height:22;this.doResize(b);FR.applyStyles(this.editComp,b.style);this.editComp.focus(function(c){a.editComp.addClass(b.cls+"-focus");if(!a.options.write){a.fireEvent(FR.Events.BEFOREEDIT)}}).blur(function(c){a.editComp.removeClass(b.cls+"-focus");if(!a.options.write){a.checkValid();a.fireEvent(FR.Events.STOPEDIT)}}).keyup(function(c){if(b.autoVerify){a.checkValid()
}if(a.isValidateInput(c)){a.fireEvent(FR.Events.AFTEREDIT,c)}});this.errorMsg=this.options.errorMsg||"";if(b.value!=null){this.setValue(b.value,false)}},_createEditComp:function(){return $("<input type='text'/>")},doResize:function(a){FR.EditComp.superclass.doResize.call(this,a);this.element.css({width:a.width,height:a.height});this.editComp.css("width",$.support.boxModel?a.width-8:a.width);this.editComp.css("height",$.support.boxModel?a.height-4:a.height);if(this.options.watermark){this.removeWaterMark();
this.setWaterMark()}},setEnable:function(a){FR.EditComp.superclass.setEnable.apply(this,arguments);if(this.editComp){if(a===true){this.editComp.removeAttr("disabled")}else{if(a===false){this.editComp.attr("disabled","disabled")}}}},selectText:function(f,a){if(!this.editComp.is(":visible")){return}var c=this.editComp.val();if(c&&c.length>0){f=f===undefined?0:f;a=a===undefined?c.length:a;var e=this.editComp[0];if(e.setSelectionRange){e.setSelectionRange(f,a)}else{if(e.createTextRange){var b=e.createTextRange();
b.moveStart("character",f);b.moveEnd("character",a-c.length);b.select()}}}}})})(jQuery);
(function(a){FR.Button=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.Button.superclass._defaultConfig.apply(),{baseCls:"fr-btn",hotkeys:"",icon:"",autoSize:false,scale:"small",iconAlign:"left",text:"",width:"auto",height:"auto",borderWidth:6})},_init:function(){FR.Button.superclass._init.apply(this,arguments);var c=this.options;this.initTable(c);this.addEvents(c);var b=this;if(c.hotkeys){FR.Keys.reg(function(g){if((a(document).codeToString(g)==c.hotkeys)&&b.isEnabled()){var f=FR.CookieInfor.getCookieByName("buttonHotKeyTimer");
var d=(new Date()).getTime();if(FR.isEmpty(f)||(d-f>1000)){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK,g);document.cookie="buttonHotKeyTimer="+d;g.preventDefault();g.stopPropagation()}}}})}if(a.isFunction(c.handler)){this.on(FR.Events.CLICK,c.handler.createDelegate(c.scope||this))}},initTable:function(e){if(!e.text&&e.value){e.text=e.value}var h=e.baseCls+"-"+e.widgetName;var g=(e.icon)?(e.text?" fr-btn-text-icon":" fr-btn-icon"):" fr-btn-noicon";g="fr-btn-up "+g;var b="height:"+(Number(e.height)+1)+"px;width:"+e.width+"px;";
var f="fr-btn-"+e.scale+" fr-btn-icon-"+e.scale+"-"+e.iconAlign;var d="";if(FR.Browser.isIE8Before()){var c=e.scale=="small"?14:e.scale=="middle"?24:32;d+=' style="margin-top:'+(e.height-c)/2+'px;"'}else{b+="display:table-cell;"}this.$btndiv=a('<div id="'+h+'" class="'+g+'" style="'+b+'">'+'<div class="'+f+'">'+'<em unselectable="on">'+'<button unselectable="none" type="button" data-role="none" class="fr-btn-text"'+d+">"+e.text+"</button>"+"</em>"+"</div>"+"</div>");this.$btnWrap=this.$btndiv.children();
this.$em=this.$btnWrap.children();this.$btn=this.$em.children();this.$btndiv.appendTo(this.element);FR.Button.setIcon(this.$btn,e.icon)},addEvents:function(c){if(!this.$btndiv){return}var b=this;var d={onMouseOver:function(){if(b.isEnabled()){b.$btndiv.addClass(c.baseCls+"-over")}},onMouseOut:function(){if(b.isEnabled()){b.$btndiv.removeClass(c.baseCls+"-over")}},onMouseDown:function(){if(b.isEnabled()){b.$btndiv.removeClass(c.baseCls+"-over");a(document).bind("mouseup",d.onMouseUp)}},onMouseUp:function(){if(b.isEnabled()){b.$btndiv.removeClass(c.baseCls+"-over");
a(document).unbind("mouseup",d.onMouseUp)}}};this.$btndiv.mouseover(d.onMouseOver.createInterceptor(this.isEnabled(),this)).mouseout(d.onMouseOut).mousedown(d.onMouseDown.createInterceptor(this.isEnabled(),this)).mouseup(d.onMouseUp);this.$btndiv.keydown(function(f){if(f.keyCode===13){f.stopPropagation()}});this.$btndiv.click(function(f){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK,f)}})},setEnable:function(b){FR.Button.superclass.setEnable.apply(this,arguments);var c=this.options.baseCls;if(this.$btndiv&&b===false){this.$btndiv.removeClass(c+"-over")
}},getText:function(){return this.$btn.text()},setText:function(b){if(FR.isEmpty(b)){return}this.$btn.text(b)},getValue:function(){return this.$btn.text()},setValue:function(b){if(FR.isEmpty(b)){return}this.$btn.text(b)},setIcon:function(c){if(FR.isEmpty(c)){return}this.$btn.removeClass();this.$btn.addClass("fr-btn-text");var b=this.$btn;if(FR.Browser.isIE6()){a("<span>"+this.$btn.text()+"</span>").appendTo(this.$btn.parent())}if(c.substring(0,4)=="css:"){b.addClass(c.substring(4))}else{if(c.substring(0,6)=="style:"){b.css({background:c.substring(6)})
}else{b.css({"background-image":"url("+c+")"})}}},setMaxWidth:function(b){if(!isNaN(b)){var c=this.options;if(FR.Browser.isIE()){if(FR.fixBoxModelWidth(this.$btn)+this.$btn.width()>(b-c.borderWidth)){this.$btn.width(b-c.borderWidth)}}else{this.$btn.css("max-width",(b-c.borderWidth)+"px")}}},doResize:function(d){FR.Button.superclass.doResize.call(this,d);var c=d?d.width:this.options.width;var b=d?d.height:this.options.height;this.$btndiv.css({width:c,height:b});this.setMaxWidth(c);this.element.css(d)
}});a.shortcut("button",FR.Button);FR.Button.setIcon=function(d,c){if(FR.isEmpty(c)){return}d.removeClass();d.addClass("fr-btn-text");var b=d;if(FR.Browser.isIE6()){a("<span>"+d.text()+"</span>").appendTo(d.parent())}if(c.substring(0,4)=="css:"){b.addClass(c.substring(4))}else{if(c.substring(0,6)=="style:"){b.css({background:c.substring(6)})}else{b.css({"background-image":"url("+c+")"})}}};FR.Button.setMaxWidth=function(d,b){if(d.isSetWidth){return}if(!isNaN(b.width)){if(FR.Browser.isIE()){var c=FR.fixBoxModelWidth(d)+d.width();
if(c>(b.width-b.borderWidth)){d.width(b.width-b.borderWidth);FR.Button.setPrototypeBtnWidth(b,b.width-b.borderWidth)}}else{d.css("max-width",(b.width-b.borderWidth)+"px");FR.Button.setPrototypeBtnMaxWidth(b,b.width-b.borderWidth)}}};FR.Button.setPrototypeBtnWidth=function(c,d){var b=FR.Button.CacheTable._getPrototypeTable(c);if(b){var e=b.$btn;e.width(d);e.isSetWidth=true}};FR.Button.setPrototypeBtnMaxWidth=function(c,d){var b=FR.Button.CacheTable._getPrototypeTable(c);if(b){var e=b.$btn;e.css("max-width",(c.width-c.borderWidth)+"px");
e.isSetWidth=true}};FR.IconButton=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.IconButton.superclass._defaultConfig.apply(),{tablable:true,render:false,width:18,height:18,baseClass:"fr-icon-btn"})},_init:function(){FR.IconButton.superclass._init.apply(this,arguments);var d=this.options;if(d.render===true){this.$btn=a("<div/>").appendTo(this.element)}else{this.$btn=this.element}this.$btn.addClass(d.baseClass);if(d.title){this.$btn.attr("title",d.title)}if(d.text){this.$btn.html(d.text)
}var c=d.baseClass;if(d.imgsrc){c=d.imgsrc;this.$btn.addClass(d.imgsrc)}var b=this;var e={onMouseOver:function(f){if(b.isEnabled()){b.$btn.addClass(c+"-hover")}},onMouseDown:function(f){if(b.isEnabled()){b.$btn.removeClass(c+"-hover");b.$btn.addClass(c+"-click");a(document).bind("mouseup",e.onMouseUp)}},onMouseOut:function(f){b.$btn.removeClass(c+"-hover");b.$btn.removeClass(c+"-click")},onMouseUp:function(f){b.$btn.removeClass(c+"-click");a(document).unbind("mouseup",e.onMouseUp)}};this.$btn.mouseover(e.onMouseOver).mouseout(e.onMouseOut).mousedown(e.onMouseDown).mouseup(e.onMouseUp);
this.$btn.click(function(f){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK,f)}});if(a.isFunction(d.handler)){this.on(FR.Events.CLICK,d.handler.createDelegate(d.scope||this))}},destroy:function(){this.element.empty()},doResize:function(b){FR.Button.superclass.doResize.call(this,b);this.$btn.css({width:b.width,height:b.height})}});a.shortcut("iconbutton",FR.IconButton);FR.FreeButton=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return a.extend(FR.FreeButton.superclass._defaultConfig.apply(),{width:200,height:100,initial:{background:""}})
},_init:function(){FR.FreeButton.superclass._init.apply(this,arguments);this.switchOn=false;var e=this.options;if(e.render===true){this.$img=a("<div style='text-align: center;'/>").appendTo(this.element)}else{this.$img=this.element.css("text-align","center")}this.element.addClass("fr-form-imgboard");if(e.icon){var c=a("<img style='vertical-align: middle;margin-right: 3px;'/>");if(e.icon.background){var g=e.icon.background.split("(");var d=g[1];g=d.split(")");d=g[0];c.attr("src",d).appendTo(this.$img)
}}this.text=a("<span style='text-align: center;'>"+((e.text!=null&&!FR.isEmpty(a.trim(e.text)))?e.text:"&nbsp;")+"</span>").appendTo(this.$img);if(e.fontsize){this.text.css("font-size",e.fontsize)}if(e.color){this.text.css("color",e.color)}if(e.decoration){this.text.css("text-decoration",e.decoration)}if(e.fontfamily){this.text.css("font-family",e.fontfamily)}if(e.fontweight){this.text.css("font-weight",e.fontweight)}if(e.fontstyle){this.text.css("font-style",e.fontstyle)}if(e.text&&!FR.isEmpty(a.trim(e.text))){this.setValue(e.text)
}if(e.width&&e.height){this.doResize(e)}if(e.hotkeys){FR.Keys.reg(function(j){if((a(document).codeToString(j)==e.hotkeys)&&b.isEnabled()){var i=FR.CookieInfor.getCookieByName("buttonHotKeyTimer");var h=(new Date()).getTime();if(FR.isEmpty(i)||(h-i>1000)){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK,j);document.cookie="buttonHotKeyTimer="+h;j.preventDefault();j.stopPropagation()}}}})}if(FR.Browser.isIE8Before()){if(e.click&&e.click.background){this.setBackground(e.click.background)}if(e.over&&e.over.background){this.setBackground(e.over.background)
}}this.setBackground(e.initial.background);var b=this;var f={onMouseOver:function(h){if(!b.options.disabled){b.fireOver()}},onMouseOut:function(h){if(!b.options.disabled){b.fireOut()}},onMouseDown:function(h){if(!b.options.disabled){b.fireDown()}a(document).bind("mouseup",f.onMouseUp)},onMouseUp:function(h){if(!b.options.disabled){b.fireUp()}a(document).unbind("mouseup",f.onMouseUp)}};this.$img.mouseover(f.onMouseOver.createInterceptor(this.isEnabled(),this)).mouseout(f.onMouseOut).mousedown(f.onMouseDown.createInterceptor(this.isEnabled(),this)).mouseup(f.onMouseUp);
if(this._getEvents().click){this.$img.addClass("fr-widget-click")}else{this.$img.css("cursor","default")}this.$img.click(function(h){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK,h)}});if(a.isFunction(e.handler)){this.on(FR.Events.CLICK,e.handler.createDelegate(e.scope||this))}},setValue:function(b){this.text.text(b)},getValue:function(){return this.text.text()},setEnable:function(b){if(b===true){this.options.disabled=false;if(this.options.isToggle&&this.switchOn){if(this.options.click){this.element.css("background",this.options.click.background)
}}else{this.element.css("background",this.options.initial.background)}this.element.addClass("ui-state-enabled");this.element.removeClass("ui-state-disabled")}else{if(b===false){this.options.disabled=true;this.element.css("background","none");this.element.addClass("ui-state-disabled");this.element.removeClass("ui-state-enabled")}}},fireOver:function(){if(this.options.over){this.setBackground(this.options.over.background)}},fireOut:function(){if(this.options.isToggle&&this.switchOn){if(this.options.click){this.setBackground(this.options.click.background)
}}else{this.setBackground(this.options.initial.background)}},fireDown:function(){if(this.options.isToggle&&!this.switchOn){var d=this.getWidgetsInSameGroup();if(d){for(var b=0;b<d.length;b++){var c=d[b];if(c!=this){c.switchDown()}}}this.switchOn=true}if(this.options.click){this.setBackground(this.options.click.background)}},fireUp:function(){if(this.options.over&&this.switchOn){this.setBackground(this.options.over.background)}else{this.setBackground(this.options.initial.background)}},switchDown:function(){if(this.options.isToggle){this.setBackground(this.options.initial.background);
this.switchOn=false}},getWidgetsInSameGroup:function(){if(this.options.group){return this.options.form.getWidgetsByGroup(this.options.group)}},setBackground:function(b){if(b==""){this.$img.css("background","white")}else{this.$img.css("background",b)}},doResize:function(b){this.$img.css({width:b.width,height:b.height});this.text.css("line-height",b.height+"px")}});a.shortcut("freebutton",FR.FreeButton);FR.ToggleButton=FR.extend(FR.BaseEditor,{selected_class:"fr-checkbox-checkon",unselected_class:"fr-checkbox-checkoff",_defaultConfig:function(){return a.extend(FR.ToggleButton.superclass._defaultConfig.apply(),{selected:false,scope:this,render:true,only_be_selected:false})
},_init:function(){FR.ToggleButton.superclass._init.apply(this,arguments);var c=this.options;if(c.render===true){this.element.css("height","auto").css("width","auto");this.$btn=a("<span>"+((c.text!=null&&!FR.isEmpty(a.trim(c.text)))?c.text:"&nbsp;")+"</span>").appendTo(this.element).addClass("x-text").addClass("fr-widget-click").click(function(d){this.onNodeClick()}.createDelegate(this))}else{this.$btn=this.element;if(c.text!=null){a("<span>"+c.text+"</span>").insertAfter(this.$btn)}}if(FR.Browser.r.chrome){this.$btn.css("padding-top",1)
}if(this.options.fontSize){var b=12;if(this.options.fontSize<b){this.options.fontSize=b}this.$btn.css("font-size",this.options.fontSize)}this.$btn.css("display","inline-block");if(a.isFunction(c.handler)){this.$btn.click(c.handler.createDelegate(c.scope||this).createInterceptor(this.isEnabled,this))}this.changeBoxState(c.selected);this.$formbtn=this.initFormBtn();if(c.value){if(!this.isValidate(c.value)){FR.Msg.toast(this.errorMsg);return}if(typeof c.value=="boolean"){this.setSelectedWithoutEvent(c.value)
}else{if(c.value=="true"){this.setSelectedWithoutEvent(true)}else{if(c.value=="false"){this.setSelectedWithoutEvent(false)}}}}},onNodeClick:function(){var b=this.options;if(this.isEnabled()){if(b.only_be_selected&&this.selected()){return false}else{if(!this.selected(!this.selected())){return false}}this.fireEvent(FR.Events.AFTEREDIT);this.fireEvent(FR.Events.CLICK)}},changeBoxState:function(b){b=typeof b=="boolean"?b:(b!="false");this.$btn[b?"addClass":"removeClass"](this.selected_class);this.$btn[b?"removeClass":"addClass"](this.unselected_class)
},initFormBtn:function(){return null},getValue:function(){return this.selected()},_dealValueWithEvents:function(b){if(typeof b=="boolean"){this.selected(b,"noFireEvent")}else{if(b=="true"){this.selected(true,"noFireEvent")}else{if(b=="false"){this.selected(false,"noFireEvent")}}}if(arguments[1]===true){this.fireEvent(FR.Events.AFTEREDIT)}},getText:function(){return this.options.text},reset:function(){this.selected(false)},selected:function(){if(arguments.length===0){return this.isSelected()}else{if(arguments[1]=="noFireEvent"){return this.setSelectedWithoutEvent(arguments[0])
}else{return this.setSelected(arguments[0])}}},isSelected:function(){return this.$btn.is("."+this.selected_class)},setSelected:function(b){if(!this.setSelectedWithoutEvent(b)){return false}this.fireEvent(FR.Events.STATECHANGE,this.selected());return true},setSelectedWithoutEvent:function(b){if(this.$formbtn){this.$formbtn.attr("checked",b!==false)}this.changeBoxState(b);return true},destroy:function(){FR.ToggleButton.superclass.destroy.apply(this)},doResize:function(b){FR.ToggleButton.superclass.doResize.call(this,b)
}});FR.CheckBox=FR.extend(FR.ToggleButton,{selected_class:"fr-checkbox-checkon",unselected_class:"fr-checkbox-checkoff",checkIconHeight:17,_defaultConfig:function(){return a.extend(FR.CheckBox.superclass._defaultConfig.apply(),{marginleft:5})},_init:function(){FR.CheckBox.superclass._init.apply(this,arguments);var c=this.options;var b;if(this.element&&FR.Browser.isIE()){this.element.css({"width":c.width,"height":this.checkIconHeight});b=this.checkIconHeight}if(b){this.$btn.css({"margin-left":c.marginleft,"height":"inherit","line-height":b+"px"})
}else{this.$btn.css("margin-left",c.marginleft)}},initFormBtn:function(){if(this.options.sessionID&&_g(this.options.sessionID).rtype=="form"){var b=a(this.$btn.parent());b.css("background-color","white");this.$box=a("<input type='checkbox'/>").css("display","none").attr("name",this.options.widgetName).appendTo(b);this.$box.attr("value",this.options.fieldValue||this.options.value||"")}return this.$box},doResize:function(b){FR.CheckBox.superclass.doResize.call(this,b);if(this.element){this.$btn.css("line-height",this.element.height()+"px")
}}});a.shortcut("checkbox",FR.CheckBox);FR.RadioButton=FR.extend(FR.ToggleButton,{selected_class:"fr-radio-radioon",unselected_class:"fr-radio-radiooff",_init:function(){FR.RadioButton.superclass._init.apply(this,arguments)},initFormBtn:function(){if(this.options.sessionID&&_g(this.options.sessionID).rtype=="form"){var b=a(this.$btn.parent());b.css("background-color","white");this.$radio=a("<input type='radio'/>").css("display","none").attr("name",this.options.name||this.options.widgetName).appendTo(b);
this.$radio.attr("value",this.options.fieldValue||this.options.value||"")}return this.$radio}});a.extend(FR.RadioButton,{RadioButtonGroup:{}});a.shortcut("radio",FR.RadioButton);FR.FormSubmitButton=FR.extend(FR.Button,{_init:function(){FR.FormSubmitButton.superclass._init.apply(this,arguments)}});a.shortcut("formsubmit",FR.FormSubmitButton);FR.CardSwitchButton=FR.extend(FR.FreeButton,{_init:function(){FR.CardSwitchButton.superclass._init.apply(this,arguments);this.$img.css("border-radius","5px 5px 0 0");
this.element.css("border-radius","5px 5px 0 0");this.element.css("opacity",this.options.opacity);var b=this;var c={cur_style:0,onMouseOver:function(f){var d=b.element.css("opacity");cur_style=d;if(d==="1"){return}b.element.css("opacity",1)},onMouseOut:function(d){if(cur_style==="1"){return}b.element.css("opacity",0.6)},onMouseDown:function(f){var d=b.element.css("opacity");cur_style=d}};this.$img.mouseover(c.onMouseOver).mouseout(c.onMouseOut).mousedown(c.onMouseDown)}});a.shortcut("cardswitch",FR.CardSwitchButton)
})(jQuery);
FR.Search=FR.extend(FR.EditCompBaseEditor,{_defaultConfig:function(){return $.extend(FR.Search.superclass._defaultConfig.apply(),{baseCls:"fr-search",width:164,height:28,width4searchBtn:44,defaultValue:null,watermark:null,onSearch:null,advanced:false,onTrigger:null,autoSearch:false,onKeyup:null,onFocus:null,onBlur:null,onEnter:null})},_init:function(){FR.Search.superclass._init.apply(this,arguments);var a=this.options;this._initEditComp();if(!a.autoSearch){this._createTriggerBtn();this.searchButton=this._createSearchBtn(this.element)
}this.doResize(a)},_initEditComp:function(){var b=this.options,a=this;this.editComp=$("<input/>").appendTo(this.element);if(b.watermark){this.setWaterMark(b.watermark)}if(b.defaultValue){this.editComp.val(b.defaultValue).data("defaultValue",b.defaultValue)}if(b.autoSearch){this.editComp.addClass("fr-search-auto-text")}else{this.editComp.addClass("fr-search-editor-text")}this.editComp.keyup(function(c){if(c.keyCode==FR.keyCode.ENTER){this.blur();if(b.onSearch){b.onSearch.apply(a,arguments)}}});this.editComp.focus(function(c){$(this).addClass("fr-search-editor-focus");
FR.applyFunc(a,b.onFocus,[c],false)}).blur(function(c){$(this).removeClass("fr-search-editor-focus");FR.applyFunc(a,b.onBlur,[c],false)}).keyup(function(c){if(c.keyCode==FR.keyCode.ENTER){this.blur();if(b.onSearch){FR.applyFunc(a,b.onSearch,[c],false)}}else{FR.applyFunc(a,b.onKeyup,[c],false)}})},_createTriggerBtn:function(){var a=this,b=this.options;if(!b.advanced){return}else{this.editComp.css({"border-right":"none"});$('<div class="fr-search-trigger"/>').hover(function(){$(this).addClass("fr-search-trigger-hover")
},function(){$(this).removeClass("fr-search-trigger-hover")}).click(function(){FR.applyFunc(a,b.onTrigger,arguments,false)}).appendTo(this.element)}},_createSearchBtn:function(d){var c=this.options,a=this;var b={renderEl:$("<div/>").appendTo(d),baseClass:"fr-search-button",width:44,height:28};if($.isFunction(c.onSearch)){b.handler=c.onSearch.createDelegate(a)}var e=new FR.IconButton(b);return e.element},getText:function(){return this.editComp.val()},setText:function(a){this.editComp.val(a)},getValue:function(){return this.getText()
},setValue:function(a){this.setText(a)},doResize:function(f){var d=this.options;var c=f.width,b=f.height;var e=8,a=4;if(d.autoSearch){e=27}else{c-=d.width4searchBtn}if(d.advanced){c-=24}if($.support.boxModel){c-=e;b-=a}this.editComp.css({height:b,width:c});if($.browser.msie){this.editComp.css("line-height",b+"px")}this.searchButton&&this.searchButton.width(d.width4searchBtn).height(d.height)}});$.shortcut("search",FR.Search);
FR.DataTable=FR.extend(FR.BaseEditor,{_init:function(){FR.DataTable.superclass._init.apply(this,arguments);var a=this.options;this.element.css("overflow","auto");this.table=$("<table/>").attr({cellspacing:"0",cellpadding:"0"});this.element.append(this.table);this.popuNewData(this.options.value)},initTableHead:function(f){if(!FR.isArray(f.head)){return}this.head=f.head;var e=$("<thead/>").addClass("fr-form-table-thead");var d=$("<tr>").addClass("fr-form-table-tr");e.append(d);for(var b=0,a=f.head.length;
b<a;b++){var c=$("<th/>").text(f.head[b]);if(f.columnWidth&&f.columnWidth[b]){c.css("width",f.columnWidth[b])}if(b==a-1){c.addClass("fr-form-table-last-th")}d.append(c)}this.table.append(e)},setTableHead:function(a){this.table.children("thead").empty();this.initTableHead(a)},popuNewData:function(c){this.setTableHead(c);this.table.children("tbody").empty();if(c.tablecontent){var d=c.tablecontent;for(var b=0,a=d.length;b<a;b++){this.addData(d[b],c.rowHeight)}}},updateDatas:function(){var c=[];var b=this.table.children("tbody").children("tr");
for(var e=0,a=b.length;e<a;e++){var g={};var f=$(b[e]).children();for(var d=0,h=f.length;d<h;d++){g[this.head[d]]=$(f[d]).text()}c.push(g)}return c},getValue:function(){return this.updateDatas()},setValue:function(a){this.popuNewData(a)},addData:function(g,c){if(!FR.isArray(g)){var b=[];b.push(g);g=b}var d=this;var f=$("<tr/>").addClass("fr-form-table-tr").click(function(){if(d.activedTR){d.activedTR.removeClass("fr-form-table-selectedtr")}$(this).addClass("fr-form-table-selectedtr");d.activedTR=$(this);
d.fireEvent(FR.Events.CLICK)});for(var e=0,a=g.length;e<a;e++){var h=$("<td/>").addClass("fr-form-table-td").append($("<pre>").css("white-space","pre-wrap").append(g[e]||""));h.css("height",c+1);f.append(h)}this.table.append(f);this.embellishTable()},embellishTable:function(){var a=this.table.children("tbody").children("tr");var b=this;$.each(a,function(d){$($(".fr-form-table-td",$(a[d]))[0]).addClass("fr-form-table-first-td");if(d===0&&b.table.children("thead").length===0){var c=$(".fr-form-table-td",a[d]);
$.each(c,function(e){$(c[e]).addClass("fr-form-table-top-td")})}if(d%2===0){$(a[d]).css({backgroundColor:"#EEEEEE"})}else{$(a[d]).addClass("fr-form-table-odd-tr")}})},getTable:function(){return this.table},getSelectedData:function(){if(!this.activedTR){return}else{var b={};var a=$("td",this.activedTR);if(this.head.length!=a.length){return}else{$.each(this.head,function(c,d){b[d]=$(a[c]).text()});return b}}},getSelectedIndex:function(){if(!this.activedTR){return -1}else{return this.activedTR[0].rowIndex-1
}}});$.shortcut("datatable",FR.DataTable);
(function(a){FR.SynchronBaseEditor=FR.extend(FR.BaseEditor,{_init:function(){FR.SynchronBaseEditor.superclass._init.apply(this,arguments)}});a.extend(FR,{createTreeConfig4Widget:function(b){FR.$defaultImport("/com/fr/web/core/js/jquerytree/tree.js","js");FR.$defaultImport("/com/fr/web/core/js/jquerytree/common.js","js");if(b.options.widgetCss&&b.options.widgetCss.length!==0){a.each(b.options.widgetCss,function(d,e){FR.$import(e,"css",true)})}var c={data:b.options.data,showcheck:b.options.mutiSelection,onnodeclick:function(e,f){var d=b.options.disableID;
if(d){if(d==e.getID()){return}}b._onEnterPressed(this,f)},beforeSelectItemChange:function(){return b.fireEvent(FR.Events.BEFORESTATECHANGE)},flatStyle:false,widget:b,selectLeafOnly:b.options.selectLeafOnly,afterBuild:function(){return b.fireEvent(FR.Events.AFTERBUILD)},loadByLayer:b.options.loadByLayer};return c},parseString2Array4Tree:function(g,f){if(typeof g!="string"||FR.isEmpty(f)){return a.makeArray(g)}var b=[];var e=f.options.nodeDelimiter||/[;]/;var c=f.options.pathDelimiter||/[,]/;if(g.indexOf(";")!=-1||g.indexOf("")!=-1){b=g.split(e)
}if(b.length>0){for(var d=0;d<b.length;d++){b[d]=b[d].split(c)}}else{if(g.indexOf(",")!=-1||g.indexOf("")!=-1){b=g.split(c)}}if(FR.isEmptyArray(b)){return g.split(";")}return b},parseTo2DArray:function(b){if(!FR.isEmptyArray(b)&&!a.isArray(b[0])){var c=[];c[0]=b;return c}else{return b}},getTreeTrace:function(l,b,h,d){var g=[];var n=[];var k=false;for(var f=0;f<b.length;f++){if(b[f].hasChild()&&d){continue}if(b[f].getValue()==l||b[f].getShowValue()==l){k=true;var c=b[f];g[0]=c.getValue();while(c.getParent()){c=c.getParent();
g.push(c.getValue());c.setexpand(true)}if(h===true){n.push(g.reverse())}else{return g.reverse()}}}for(var f=0;f<b.length;f++){if(b[f].ChildNodes||(b[f].data&&b[f].data.ChildNodes)){var m=FR.getTreeTrace(l,b[f].getChildren(),h,d);if(!FR.isEmptyArray(m)){k=true;if(h){for(var e=0;e<m.length;e++){n.push(m[e])}}else{return m}}}}if(k){return n}return[]},getValidTreeTrace:function(b,c,d){if(!FR.isArray(b)||FR.isEmptyArray(b)){return}if(b.length===1){return FR.getTreeTrace(b[0],c,false,d)}else{return e(b,0,c)?b:null
}function e(f,g,h){if(g>=f.length){return true}for(var j=0;j<h.length;j++){if(h[j].getValue()==f[g]){return e(f,g+1,h[j].getChildren())}else{if(h[j].getShowValue()==f[g]){f[g]=h[j].getValue();return e(f,g+1,h[j].getChildren())}}}return false}},setAllNodeState:function(b,d){for(var c=0;c<b.length;c++){b[c].setcheckstate(d);if(b[c].isLoadComplete()&&b[c].getChildrenLength()>0){FR.setAllNodeState(b[c].getChildren(),d)}}},setNodeStateByInitValue:function(c,b,h,g){if(!FR.isArray(h)){return}for(var f=0;
f<c.length;f++){if(c[f].getShowValue()==h[b]||c[f].getValue()==h[b]){if(b==h.length-1){if(!g||!c[f].hasChild()){c[f].setcheckstate(1)}return true}var k=c[f].getChildren();if(FR.setNodeStateByInitValue(k,b+1,h,g)&&g){var e=true;for(var d=0;d<k.length;d++){if(k[d].getcheckstate()!==1){e=false;break}}c[f].setcheckstate(e?1:2);return true}}}},findSelectedNode:function(d,b,f,c){if(!FR.isArray(f)){return}for(var e=0;e<d.length;e++){if(d[e].getShowValue()==f[b]||d[e].getValue()==f[b]){if(b==f.length-1){c.currentnode=d[e]
}FR.findSelectedNode(d[e].getChildren(),b+1,f,c)}}},findTrueValue:function(d,c,f,b,g){if(!FR.isArray(f)){return}for(var e=0;e<d.length;e++){if(d[e].getValue()==f[c]){if(c==f.length-1){b.push(d[e].getTextPath(false));g.push(f);return}d=d[e].getChildren();FR.findTrueValue(d,c+1,f,b,g);return}}},getTreeValueResult:function(b,g,f){if(f){return b}else{if(b==null){return null}if(g){var d=[];for(var c=0;c<b.length;c++){if(a.isArray(b[c])){var e=b[c];d[c]=e[e.length-1]}else{d[c]=b[c]}}return d}else{return b[b.length-1]||""
}}}});FR.TreeEditor=FR.extend(FR.SynchronBaseEditor,{_defaultConfig:function(){return a.extend(FR.TreeEditor.superclass._defaultConfig.apply(),{width:120,height:200,limitData:300,delimiter:";"})},_init:function(){FR.TreeEditor.superclass._init.apply(this,arguments);this.initData();if(this.options.widgetName!=null){this.element.attr("id",this.options.widgetName)}if(this.options.width>-1){this.element.css("width",this.options.width)}if(this.options.height>-1){this.element.css("height",this.options.height)
}this.element.css("overflow","auto");this.options.data.resetStatus(this.allPara());if(this.options.value||this.options.value===0){this._dealValueWithEvents(this.options.value)}this._setCheckStateByDefaultValue()},initData:function(){if(this.options.data){return}if(this.options.rootLoader){this.options.data=new FR.TreeData({treeLoader:this.options.rootLoader})}else{if(this.options.widgetUrl){this.options.data=new FR.TreeData({url:this.options.widgetUrl})}else{if(this.options.items){this.options.data=new FR.ItemTreeData({items:this.options.items})
}}}if(this.options.controlAttr){var c=this.options.controlAttr["data"]||this.options.controlAttr["value"];if(FR.isEmpty(c)||c==""){return}this._confirmEvents=function(){this.fireEvent(FR.Events.AFTERINIT)};var b=this.createDependencePara4Data();b.parameter.startIndex=0;b.parameter.limitIndex=this.options.limitData;this.options.data.setData(b,c);delete this.options.controlAttr}},allPara:function(d,c){var b=this.createDependencePara4Data();b.parameter.startIndex=d?d:0;b.parameter.limitIndex=c?c:this.options.limitData;
return b},isComboBoxTree:function(){return false},_onEnterPressed:function(b){this.fireEvent(FR.Events.CLICK,b);this.fireEvent(FR.Events.AFTEREDIT)},setValue:function(l,d){if(d===undefined){d=function(i){return i.getValuePath(false)}}var n=this;var e;if(typeof l==="string"){e=l.split(this.options.delimiter)}else{e=a.makeArray(l)}if(!FR.isEmptyArray(e)){var c=this.options.data.getData();var f=[];for(var g=0;g<c.length;g++){f=f.concat(c[g].getLeafNode())}var h=[];for(var k=0;k<f.length;k++){var m=f[k];
var j;if(a.isArray(e[0])&&n.options.mutiSelection){j=e.weakIndexOf(d(m))!==-1}else{j=FR.equals(d(m),e)}if(j){m.setcheckstate(1);h.push(m);if(!n.options.mutiSelection){break}}else{m.setcheckstate(0)}}a.each(h,function(o,p){var i=p.getParent();while(i){i.setcheckstate(i.isAllChildrenChosen()?1:2);i.setexpand(true);i=i.getParent()}});var b=FR.createTreeConfig4Widget(this);this._createTreeView(b)}},getValue:function(){var b;if(!this.options.mutiSelection){b=this.element.getTCPValue()||this.value}else{b=this.element.getTCPValues()||this.value
}return FR.getTreeValueResult(b,this.options.mutiSelection,this.options.returnFullPath)},getText:function(){var b;if(!this.options.mutiSelection){b=this.element.getTCPValue()===null?null:this.element.getTCPText()}else{b=this.element.getTCPValues()===null?null:this.element.getTCPTexts()}return FR.getTreeValueResult(b,this.options.mutiSelection,this.options.returnFullPath)},setText:function(b){this.setValue(b,function(c){return c.getTextPath(false)})},_dealValueWithEvents:function(h){var e=this.options.mutiSelection?[]:"";
if(typeof h==="string"){var f=h.split(this.options.delimiter)}else{var f=a.makeArray(h)}var d=this;var c=[];var g=[];if(!this.options.mutiSelection){FR.findTrueValue(this.options.data.getData(),0,f,c,g)}else{f=FR.parseTo2DArray(f);for(var b=0;b<f.length;b++){FR.findTrueValue(this.options.data.getData(),0,a.isArray(f[b])?f[b]:f[b].split(","),c,g)}}if(c.length!==0){this.value=this.options.mutiSelection?g:g[0]}else{this.value=f}leafNodes=nodes=null;if(e!=h){this.options.need2BuildList=true}},_setCheckStateByDefaultValue:function(){var e=this;
var g=this.options.value?this.options.value:[];var d=FR.createTreeConfig4Widget(this);var f=function(j){if(!a.isArray(j)){return}if(!FR.isEmptyArray(j)){for(var h=0;h<j.length;h++){if(a.isArray(j[h])){j[h]=j[h].toString()}}}};if(!FR.isEmptyArray(g)){var c=this.options.data.getData();if(!FR.isArray(g)){g=FR.getTreeTrace(g,c,e.options.mutiSelection,e.options.selectLeafOnly)}if(e.options.mutiSelection){g=FR.parseTo2DArray(g);f(g);FR.setAllNodeState(c,0);for(var b=0;b<g.length;b++){FR.setNodeStateByInitValue(c,0,g[b].split(","),e.options.selectLeafOnly)
}}else{FR.findSelectedNode(c,0,g,d)}}this._createTreeView(d)},reset:function(){this.setValue("");var c=this.options.data.getData();FR.setAllNodeState(c,0);var b=FR.createTreeConfig4Widget(this);this._createTreeView(b)},doResize:function(b){FR.TreeEditor.superclass.doResize.call(this,b)},_createTreeView:function(b){this.element.treeview(b)}});a.shortcut("tree",FR.TreeEditor);FR.ListEditor=FR.extend(FR.SynchronBaseEditor,{_defaultConfig:function(){return a.extend(FR.ListEditor.superclass._defaultConfig.apply(),{width:120,height:200,icon:false,multi:false,removeSelf:false,textAlign:"left"})
},_init:function(){FR.ListEditor.superclass._init.apply(this,arguments);this.initData();this._initList();var b=this;this.options.data.once(FR.Events.AFTERREAD,function(){b.fireEvent(FR.Events.DEFAULTINIT)})},initData:function(){if(this.options.data){return}if(this.options.controlAttr){this.setSource(this.options.controlAttr);this._confirmEvents=function(){this.fireEvent(FR.Events.AFTERINIT)};return}if(this.options.widgetUrl){this.options.data=FR.DataFactory.createSynchronJSONData(this.options.widgetUrl,false)
}else{if(this.options.items){this.options.data=FR.DataFactory.createSynchronArrayData(this.options.items)}}},refreshList:function(){if(this.options.controlAttr&&this.options.widgetUrl){this.options.controlAttr=null;this.options.data=FR.DataFactory.createSynchronJSONData(this.options.widgetUrl,false)}this.jlist({needHead:this.options.needHead})},setSource:function(c){var b=this;if(c["value"]!==undefined&&c["value"]!==""){this.once(FR.Events.DEFAULTINIT,function(){b.setValue(c["value"],false)})}this.options.data=FR.DataFactory.createSynchronArrayData(c["data"])
},_initList:function(){FR.$defaultImport("/com/fr/fs/web/platform/js/jquery.jlist.js","js");var b=this.options;if(b.width>-1){this.element.css("width",b.width)}if(b.height>-1){this.element.css("height",b.height)}if(b.textAlign){this.element.css("text-align",b.textAlign)}this.jlist({needHead:b.needHead})},getValue:function(){var b=this.getSelectedItem();return b!=null?b.getValue():null},_dealValueWithEvents:function(h,d){var g=this.getSelectedText(),f=this.options.data;for(var c=0,b=f.getLength();
c<b;c++){var e=this.options.data.getRecord(c);if(d&&(d.getShowValue()==e.getShowValue())){e.setValue(h);break}}},getSelectedText:function(){var b=this.getSelectedItem();return b!=null?b.getShowValue():null},addItem:function(b){this.doAddItem(b)},getAll:function(){var d=[],e=this.options.data;for(var c=0,b=e.getLength();c<b;c++){var f=e.getRecord(c);d.push({text:f.getShowValue(),value:f.getValue()!=null?f.getValue():f.getShowValue()})}return d},setAll:function(c){var b=this;a.each(c,function(e,f){var d=FR.DataFactory.createItemRecord({text:e,value:f});
b.doAddItem(d,true);b.options.data.addRecord(d)})},clear:function(){this.doClear()},clearSelected:function(){a(".fr-list-node",this.element).removeClass("fr-list-node-selected");this.fireEvent(FR.Events.NOSELECT)},doFilter:function(c){var b=a(".fr-list-node",this.element);if(c||c===0){c=c.toUpperCase();a.each(b,function(d,e){var f=a("a > span",a(this)).html();if(f.toUpperCase().indexOf(c)>-1){a(this).show()}else{a(this).hide()}})}else{b.show()}},popData:function(b){this.doClear();this.options.data=new FR.SynchronData({dataSource:new FR.SynchronObjectSource({object:b})});
this.jlist();if(this.getSelectedIndex()<0){this.fireEvent(FR.Events.NOSELECT)}},setSelectedIndex:function(c){var d=a("ul.fr-list-content",this.element);var b=a("li",d);if(!b){this.fireEvent(FR.Events.NOSELECT)}this.doSelected(null,a(b[c]))}});a.shortcut("list",FR.ListEditor);FR.ToggleButtonGroup=FR.extend(FR.SynchronBaseEditor,{_defaultConfig:function(){return a.extend(FR.ToggleButtonGroup.superclass._defaultConfig.apply(),{columnsInRow:0})},_init:function(){FR.ToggleButtonGroup.superclass._init.apply(this,arguments);
var e=this.options;var f;var d;if(e.border){d=e.border.b||e.border.t;f=e.border.l||e.border.r;if(e.border.b1){e.height=e.height-1;e.width=e.width-1}else{if(d){e.height=e.height-vgap.w}else{if(f){e.width=e.width-hgap.w}}}}var c=e.width>0?e.width:0;var b=e.height>0?e.height:0;this.$container=this.element.addClass("fr-form-btn-group");this.$container.css({"width":c,"height":b}).addClass(this.lbox_class);this.buttonArray=[];if(FR.Browser.isIE8Before()&&!a.support.boxModel&&b===0){this.$container.css({height:1,"overflow":"hidden"})
}if(e.value!=null){this.once(FR.Events.DEFAULTINIT,function(){this.setValue(e.value,false)})}this.initData()},initData:function(){if(this.options.data){return}if(this.options.controlAttr){this.setSource(this.options.controlAttr);this._confirmEvents=function(){this.fireEvent(FR.Events.AFTERINIT)};return}if(this.options.widgetUrl){this.options.data=FR.DataFactory.createSynchronJSONData(this.options.widgetUrl,false);this.options.data.resetStatus(this.createDependencePara4Data())}else{if(this.options.items){this.options.data=FR.DataFactory.createSynchronArrayData(this.options.items)
}}var b=this;this.options.data.afterRead(function(c){if(b.isBoxBuild!==true){b._buildBox(c)}});this.options.data.loadData()},setSource:function(c){var b=this;if(c["value"]!==undefined&&c["value"]!=""){this.once(FR.Events.DEFAULTINIT,function(){b.setValue(c["value"],false)})}this.options.data=FR.DataFactory.createSynchronArrayData(c["data"]);this.options.data.afterRead(function(d){b._buildBox(d)});this.options.data.loadData()},reset:function(){this.setValue(null);this.isBoxBuild=undefined;if(this.options.data.resetStatus(this.createDependencePara4Data())){this.options.data.loadData()
}},rebuild:function(b){this.setValue(null);this.options.data=null;this.options.widgetUrl=null;this.element.empty();this.options.items=b;this.isBoxBuild=undefined;if(b.widgetUrl){this.options.widgetUrl=b.widgetUrl}if(!this.options.renderEl){this.options.renderEl=this.element}this._init()},clearContent:function(){this.$container.empty()},_buildBox:function(){this.clearContent();var b=this.options.data.getRecords();this._initGridConfig(b);this._setItems(b);this.isBoxBuild=true;this.fireEvent(FR.Events.DEFAULTINIT)
},_initGridConfig:function(c){var b=c.length+(this.options.chooseAll===true?1:0),d=this.options.columnsInRow,e=d===0?1:1+Math.floor((b-0.1)/d);this.gridConfig={columns:d===0||e===0?b:d,rows:e,items:[],renderEl:this.$container};return this.gridConfig},setEnable:function(b){if(this.buttonArray){for(var c=0;c<this.buttonArray.length;c++){this.buttonArray[c].setEnable(b)}}FR.ToggleButtonGroup.superclass.setEnable.apply(this,arguments)},getErrorMessage:function(){return this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des")
},doResize:function(b){FR.ToggleButtonGroup.superclass.doResize.call(this,b);this.$container.css({width:b.width,height:b.height});if(this.grid){this.grid.doLayout();this._checkTable()}},_checkTable:function(){if(this.$container.parent()[0]&&this.$container.parent()[0].tagName=="TD"){this.$container.css("position","relative")}}});a.shortcut("togglebuttongroup",FR.ToggleButtonGroup);FR.TableTree=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return a.extend(FR.TableTree.superclass._defaultConfig.apply(),{width:120,height:200})
},_init:function(){FR.TableTree.superclass._init.apply(this,arguments);FR.$defaultImport("/com/fr/web/platform/js/jquery.tabletree.js","js");FR.$defaultImport("/com/fr/web/platform/css/jquery.tabletree.css","css");var d=this.options;this.$TableTreeDiv=this.element;if(d.width>-1){this.$TableTreeDiv.css("width",d.width)}if(d.height>-1){this.$TableTreeDiv.css("height",d.height)}var c;if(!this.options.data){this.options.data=new FR.Data({dataSource:new FR.URLSource({url:this.options.widgetUrl}),dataReader:new FR.DataReader({choosedFields:["name","state"]})})
}if(this.options.rootLoader){this.options.treedata=new FR.TreeData({treeLoader:this.options.rootLoader})}else{if(this.options.url){this.options.treedata=new FR.TreeData({url:this.options.url})}else{return}}var b={data:this.options.treedata.getData(),cvns:this.options.data.getData(),treedatatype:this.options.treedatatype,width:this.options.width,height:this.options.height,needleaficon:this.options.needleaficon,oncheckboxclick:this.options.oncheckboxclick};this.$TableTreeDiv.tabletree(b)},getValue:function(){return this.$TableTreeDiv.getTableTreeValue()
},_setValue:function(b){this.$TableTreeDiv.setTableTreeValue(b)}});a.shortcut("tabletree",FR.TableTree)})(jQuery);
(function(a){FR.Composite=FR.extend(FR.Widget,{type:"composite",_defaultConfig:function(){return a.extend(FR.Composite.superclass._defaultConfig.apply(),{innerWidget:{}})},_init:function(){FR.Composite.superclass._init.apply(this,arguments);var c=this.options.innerWidget;c.renderEl=a("<div>").appendTo(a("body"));var b=FR.createWidget(c);if(b.element.data("jlayout")){b.doResize(b.element.data("jlayout").preferred(this.element))}b.doLayout();b.element.css({position:""});c.renderEl.appendTo(this.element.css({position:"relative"}))
}});a.shortcut("composite",FR.Composite);FR.Toolbar=FR.extend(FR.Widget,{type:"toolbar",_defaultConfig:function(){return a.extend(FR.Toolbar.superclass._defaultConfig.apply(),{baseCls:"x-toolbar",items:[]})},_init:function(){FR.Toolbar.superclass._init.apply(this,arguments);var j=this.options;var b=28;FR.toolbarHeight=b;this.element.addClass(j.baseCls);this.element.css("height",b);if(j.toolbarbg){var f=j.toolbarbg;var h=this.element;FR.setBackground(h,f,h.height())}this.$tr=a("<tr>");this.$tr.appendTo(a("<tbody>").appendTo(a("<table cellspacing=0>").css({"height":b,"vertical-align":"center"}).appendTo(this.element)));
if(j.toolbarbg&&(j.toolbarbg["type"]===4||j.toolbarbg["type"]===2)&&FR.Browser.isIE()&&FR.ieForFixBackground()){this.$tr.css({position:"absolute",top:"0px"})}var e=[];if(j.items!=null){if(!FR.isArray(j.items)){j.items=[j.items]}for(var d=0;d<j.items.length;d++){if(d>0){this.addSep()}var g=j.items[d];var c=FR.createWidget(g);e.push(c);if(g.widgetName){this[g.widgetName.toLowerCase()]=c}this.addJQuery(c.element)}j.items=e}},getWidgetByName:function(d){var c=this.options.items;for(var e=0,b=c.length;
e<b;e++){var g=c[e];var f=g.options.widgetName;if(f&&d&&f.toUpperCase()===d.toUpperCase()){return g}}},addJQuery:function(c){if(FR.Browser.isIE()&&!a.support.boxModel){this.element.css("overflow","hidden")}if(c!=null){var b=a("<td>").append(c);this.$tr.append(b)}},addSep:function(){this.addJQuery("<span class='sep'> </span>")}});a.shortcut("toolbar",FR.Toolbar);FR.MenuButton=FR.extend(FR.Button,{_init:function(){FR.MenuButton.superclass._init.apply(this,arguments);if(this.$em){this.$em.addClass("fr-btn-arrow")
}var b=this.options.menu;if(FR.isArray(b)){this.on("click",function(){FR.showMenuByEl({destroyOnClose:true,items:b,minWidth:175,xxxfixclientH:this.options.istoolbarmenu?true:false},this.element)}.createDelegate(this));if(this.$table){this.$table.mouseleave(function(d){if(this.fr_menu){var c={x:this.fr_menu.menu.$menuRoot.offset().left,y:this.fr_menu.menu.$menuRoot.offset().top-1,width:this.fr_menu.menu.$menuRoot.bounds().width,height:this.fr_menu.menu.$menuRoot.bounds().height};if(d.clientY<c.y||d.clientY>c.y+c.height||d.clientX<c.x||d.clientX>c.x+c.width){this.fr_menu.menu.close()
}}}.createDelegate(this.element))}}}});a.shortcut("menubutton",FR.MenuButton)})(jQuery);
(function(a){FR.TextEditor=FR.extend(FR.EditComp,{_defaultConfig:function(){return a.extend(FR.TextEditor.superclass._defaultConfig.apply(),{autoVerify:true})},isValidateInput:function(b){return !FR.isSpecialKey(b)},_dealValueWithEvents:function(c){var b=this.getValue();this.editComp.val(c);if(arguments[1]!==false){this.fireEvent(FR.Events.CHANGE,c,b);this.fireEvent(FR.Events.AFTEREDIT)}},recoveryValue:function(){this.editComp.val(this.options.oldValue)},select:function(){if(this.editComp.select){this.editComp.select()
}},getValue:function(){return this.editComp.val()},doResize:function(b){FR.TextEditor.superclass.doResize.call(this,b)}});a.shortcut("text",FR.TextEditor);FR.Password=FR.extend(FR.TextEditor,{_defaultConfig:function(){return a.extend(FR.TextEditor.superclass._defaultConfig.apply(),{passwordText:true})},getValue:function(){var b=FR.Password.superclass.getValue.apply(this,arguments);b.encryption=true;return b},_createEditComp:function(){return a('<input type="password"/>')}});a.shortcut("password",FR.Password);
FR.TextArea=FR.extend(FR.TextEditor,{_defaultConfig:function(){return a.extend(FR.TextEditor.superclass._defaultConfig.apply(),{multiline:true})},_init:function(){FR.TextArea.superclass._init.apply(this,arguments);var c=this.options,b=this;if(c.multiline===true){this.editComp.keydown(function(h){if(b.options.write&&FR.keyCode.UP==h.keyCode||FR.keyCode.DOWN==h.keyCode){h.stopPropagation();return}if(h.keyCode===13){if(b.options.form){b.fireEvent(FR.Events.AFTEREDIT);h.stopPropagation()}}var g=this;
if(h.ctrlKey&&h.keyCode===13){h.ctrlKey=false;var i=g.value;var f=a("."+c.cls,b.element).eq(0)[0];if(typeof f.selectionStart=="number"&&typeof f.selectionEnd=="number"){var j=f.selectionStart;g.value=i.slice(0,j)+"\n"+i.slice(f.selectionEnd);f.selectionStart=f.selectionEnd=j+1}else{if(document.selection&&document.selection.createRange){this.focus();var d=document.selection.createRange();d.text="\r\n";d.collapse(false);d.select()}}b.fireEvent(FR.Events.AFTEREDIT)}});if(!jQuery.support.boxModel||FR.Browser.r.gecko){this.editComp.css({"white-space":"normal"})
}}},_createEditComp:function(){return a("<textarea style='overflow-y:auto;resize:none'></textarea>")},isValidateInput:function(b){return FR.TextArea.superclass.isValidateInput.call(this,b)||(b.keyCode===13&&this.options.form)},doResize:function(b){FR.TextEditor.superclass.doResize.call(this,b)}});a.shortcut("textarea",FR.TextArea)})(jQuery);
(function(a){FR.IframeEditor=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return a.extend(FR.IframeEditor.superclass._defaultConfig.apply(),{baseName:"fr_iframe",baseClass:"fr_iframeeditor",widgetName:"",src:"",width:"100%",height:"100%",showOverFlowX:true,showOverFlowY:true})},_init:function(){FR.IframeEditor.superclass._init.apply(this,arguments);this.initData();var b=this.options;this.editComp=this.element.css({width:"100%",height:"100%"});b.iframeName=b.widgetName||this.createNoRepeatName();
this.$iframe=a("<iframe  name="+b.iframeName+" id="+b.iframeName+">").css({width:b.width,height:b.height}).addClass(b.baseClass).attr({frameborder:0,scrolling:!b.showOverFlowX&&!b.showOverFlowY?"no":"yes"}).appendTo(this.editComp);this.$iframe[0].onload=function(){if(!b.showOverFlowX||!b.showOverFlowY){try{if(this.contentWindow){var f=this.contentWindow.document;var g=a(".content-container",a(f));if(g.length>0){c(g)}else{c(a(f.documentElement));c(a(f.body))}function c(e){if(!b.showOverFlowX){e.css("overflow-x","hidden")
}if(!b.showOverFlowY){e.css("overflow-y","hidden")}}}}catch(d){console&&console.log("error")}}};if(a.browser.msie&&(this.$iframe.parent()).is("div")&&(this.$iframe.parent().parent()).is("td")&&(this.$iframe.parent().parent().attr("widget"))!=null&&(this.$iframe.parent().parent().parent()).is("tr")){this.$iframe.parent().height("")}else{this.$iframe.css("overflow-x",b.showOverFlowX?"auto":"hidden");this.$iframe.css("overflow-y",b.showOverFlowY?"auto":"hidden")}if(b.controlAttr){this.setValue(b.controlAttr)
}else{if(b.src){this._loadIframeByGet()}}if(b.disabled){this._addDisableMask()}},createNoRepeatName:function(){var b=a("iframe"+this.options.baseClass).length;while(a("iframe[name="+this.options.baseName+b+"]").length!==0){b++}return this.options.baseName+b},_loadIframeByGet:function(){var b=this.options.src,h=this;if(this.options.data){var j=[];for(var e=0,f=this.options.data.getLength();e<f;e++){var d=this.options.data.getRecord(e).getContent();if(typeof d=="object"&&d.widgetName&&this.options.form){var g=this.options.form.getWidgetByName(d.widgetName);
if(g){var k={};k[d.widgetName]=g.getValue();b=b.appendQuery(k)}else{j.push(d.widgetName)}}else{b=b.appendQuery(d)}}if(j.length>1){var c=this.options.form;c.on(FR.Events.AFTERINIT,function(){for(var m=0;m<j.length;m++){var l=j[m];var i={};i[l]=c.getWidgetByName(l).getValue();b=b.appendQuery(i)}h._changeIframe(b)})}}this._changeIframe(b)},_addDisableMask:function(){this.mask=a("<span/>").css({backgroundColor:"#66B9FF",height:this.options.height,width:this.options.width,left:this.element.offset().left}).appendTo(this.element)
},getValue:function(){return this.$iframe.attr("src")},_dealValueWithEvents:function(b){this.options.src=b;this._changeIframe(b)},_changeIframe:function(b){this.$iframe.attr("src",b)},setEnable:function(b){FR.IframeEditor.superclass.setEnable.apply(this,arguments);if(b){if(this.mask){this.mask.remove()}}else{if(this.mask){this.mask.show()}else{this._addDisableMask()}}},doResize:function(b){FR.IframeEditor.superclass.doResize.apply(this,arguments);if(this.submitForm){this.submitForm.submit()}},reset:function(){this.options.data.clearData();
this._loadIframeByGet()}});a.shortcut("iframe",FR.IframeEditor)})(jQuery);
(function(a){FR.Label=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return a.extend(FR.Label.superclass._defaultConfig.apply(),{cls:"fr-label",wrap:true,width:120,height:24})},_init:function(){FR.Label.superclass._init.apply(this,arguments);this.element.css("overflow","hidden");var c=this.options;this.labelComp=a("<pre/>").addClass(c.cls);this.textContainer=a('<table cellpadding="0" cellspacing="0"/>');this.textContainer.css({"table-layout":"fixed",width:this.options.width,height:this.options.height,"-webkit-text-size-adjust":"none"}).append(a("<tr/>").append(a("<td/>").append(this.labelComp))).appendTo(this.element);
var b=this;this.labelComp.click(function(){if(b.isEnabled()){b.fireEvent(FR.Events.CLICK)}});if(this._getEvents().click){this.labelComp.addClass("fr-widget-click")}if(c.fontsize){this.labelComp.css("font-size",c.fontsize)}if(c.color){this.labelComp.css("color",c.color)}if(c.decoration){this.labelComp.css("text-decoration",c.decoration)}if(c.lineheight){this.labelComp.css("line-height",c.lineheight+"px")}if(c.textalign){this.labelComp.css("text-align",c.textalign)}if(c.fontfamily){this.labelComp.css("font-family",c.fontfamily)
}if(c.fontweight){this.labelComp.css("font-weight",c.fontweight)}if(c.fontstyle){this.labelComp.css("font-style",c.fontstyle)}if(c.border===true){this.labelComp.css({border:"1px solid #AAAAAA"})}if(c.widgetBackground){if(FR.Browser.isIE8Before()){this.textContainer.css("position","absolute")}FR.setBackground(this.element,c.widgetBackground,this.element.height())}if(c.borderStyle){this.element.css("border-style",c.borderStyle.type);this.element.css("border-color",c.borderStyle.color);this.element.css("border-width",c.borderStyle.width);
this.element.css("border-bottom-width",0)}if(c.width>-1){this.element.css({width:c.width})}if(c.height>-1){this.element.css({height:c.height})}if(c.title){this.labelComp.attr("title",c.title)}if(c.id){this.labelComp.attr("id",c.id)}if(c.wrap){this.labelComp.css("word-wrap","break-word").css("white-space","pre-wrap")}else{if(!FR.Browser.isIE()){this.labelComp.css("white-space","pre")}else{this.labelComp.css("white-space","pre-wrap").css("word-break","keep-all")}}if(c.value!=null){this.setValue(c.value)
}},setValue:function(c){var b=this.getValue();this.options.value=c;if(FR.Browser.isIE()){this.labelComp[0].innerText=c||""}else{this.labelComp.text(c)}if(arguments[1]!==false){this.fireEvent(FR.Events.CHANGE,c,b)}},getValue:function(){return this.options.value},doResize:function(b){FR.Label.superclass.doResize.call(this,b);this.textContainer.css({width:b.width,height:b.height});this.labelComp.css({width:b.width});if(!this.options.verticalcenter){this.labelComp.css("height",b.height+"px")}}});a.shortcut("label",FR.Label)
})(jQuery);
(function(a){FR.NumberEditor=FR.extend(FR.EditComp,{_defaultConfig:function(){return a.extend(FR.NumberEditor.superclass._defaultConfig.apply(),{allowDecimals:true,allowNegative:true,decimalPrecision:-1,autoVerify:true,decimalSeparator:"."})},_init:function(){FR.NumberEditor.superclass._init.apply(this,arguments);var d=this.options;var c="0123456789";this.allowed=c+"";if(d.allowDecimals){this.allowed+="."}if(d.allowNegative){this.allowed+="-"}this.editComp.css("ime-mode","disabled");var b=this;this.editComp.blur(function(){if("."==b.editComp.val().charAt(0)){b.editComp.val("0"+b.editComp.val())
}}).keydown(function(f){if(f.keyCode==FR.keyCode.ENTER&&!b.options.write){f.stopPropagation()}}).keypress(function(g){var f=g.keyCode;if(!a.browser.msie&&(FR.isNavKeyPress(g)||FR.isSpecialKey(g)||f==FR.keyCode.BACKSPACE)){return}var i=g.charCode||g.keyCode;var h=String.fromCharCode(i);if(a.browser.msie&&(i===27||i===13)){return}if(b.allowed.indexOf(h)===-1){g.preventDefault()}if(this.value.indexOf(".")>-1&&h=="."){g.preventDefault()}})},isValidateInput:function(b){var f=b.charCode||b.keyCode;if(f==FR.keyCode.BACKSPACE||f==FR.keyCode.ENTER){return true
}if(f>=96&&f<=105){f=f-48}var d=String.fromCharCode(f);if(f===190||f===110){d="."}return(this.allowed.indexOf(d)>-1)&&(d!="."||(this.editComp.val().substr(0,this.editComp.val().length-1)).indexOf(".")===-1)},_dealValueWithEvents:function(d){var c=this.getValue();var b;if(typeof c=="string"&&c!=""){b=c}else{b=String(d)}this.editComp.val(b.replace(".",this.options.decimalSeparator));if(arguments[1]!==false){this.fireEvent(FR.Events.CHANGE,d,c)}},_fixPrecision:function(c){var b=isNaN(c);if(!this.options.allowDecimals||this.options.decimalPrecision==-1||b||!c){return b?"":c
}return parseFloat(parseFloat(c).toFixed(this.options.decimalPrecision))},_parseValue:function(b){b=parseFloat(String(b).replace(this.options.decimalSeparator,"."));return isNaN(b)?"":b},getValue:function(){var b=this.editComp.val();if(b.length>17){return b}return this._fixPrecision(this._parseValue(b))},verifyDedimals:function(){if(typeof this.editComp.reg=="undefined"){this.editComp.reg=(this.options.allowNegative?"-?":"")+"\\d+"+(this.options.allowDecimals?("(\\.\\d{0,"+this.options.maxDecLength+"})?"):"")
}var c=new RegExp(this.editComp.reg);var b=c.exec(this.editComp.val());if(b!=null){return b[0]}return""},recoveryValue:function(){this.editComp.val(isNaN(this.options.oldValue)?"":String(this.options.oldValue).replace(".",this.options.decimalSeparator))},isValidate:function(b){var d=b!=null&&b!=undefined?b:this.editComp.val();if(b&&this.options.isEditable&&(""+b).indexOf(",")!=-1){d=d.replace(/,/g,"")}if(d==null||d==undefined||d===""){if(this.options.allowBlank!==false){return true}else{this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des");
return false}}d=(""+d).replace(this.options.decimalSeparator,".");if(isNaN(d)){this.errorMsg=this.options.regErrorMsg||FR.i18nText("Err-The_value_must_be_number");return false}var e=d;var c=new FR.BigDecimal({numStr:e});if(e.indexOf(this.options.decimalSeparator)>0){if(!this.options.allowDecimals){this.errorMsg=this.options.regErrorMsg||FR.i18nText("Err-The_value_must_be_integer");return false}else{if(e.length-e.indexOf(this.options.decimalSeparator)>this.options.maxDecLength+1){this.errorMsg=this.options.regErrorMsg||FR.i18nText("FR-Base_DecimalNumber_Out");
return false}}}if(!this.options.allowNegative&&!c.isPositive()){this.errorMsg=this.options.regErrorMsg||FR.i18nText("FR-Report_Invalid_Cell");return false}if(this.options.minValue!=null&&c.lessThan(new FR.BigDecimal({numStr:String(this.options.minValue)}))){this.errorMsg=this.options.regErrorMsg||FR.i18nText("Err-The_number_is_less_than_the_minimum_value")+this.options.minValue;return false}if(this.options.maxValue!=null&&c.greaterThan(new FR.BigDecimal({numStr:String(this.options.maxValue)}))){this.errorMsg=this.options.regErrorMsg||FR.i18nText("Err-The_number_is_larger_than_the_maximum_value")+this.options.maxValue;
return false}return true},doResize:function(b){FR.NumberEditor.superclass.doResize.call(this,b)}});a.shortcut("number",FR.NumberEditor);FR.BigDecimal=function(b){this.options=a.extend({numStr:"",decimalSeparator:"."},b);var g=this.options;var f=g.numStr;this.positive=true;this.intArray=[];this.decArray=[];if(f.indexOf("e")!==-1||f.indexOf("E")!==-1){}var d=0;var e=true;if(f.charAt(0).match(/[-+]/)){this.positive=f.charAt(0)=="+";d++}for(;d<f.length;d++){var h=f.charAt(d);if(h==g.decimalSeparator){e=false;
continue}if(e){this.intArray.push(h)}else{this.decArray.push(h)}}};a.extend(FR.BigDecimal.prototype,{isPositive:function(){return this.positive},equalsTo:function(b){return this.compareTo(b)===0},greaterThan:function(b){return this.compareTo(b)===1},lessThan:function(b){return this.compareTo(b)===-1},compareTo:function(c){if(c==null){return null}if(this.isPositive()&&!c.isPositive()){return 1}if(!this.isPositive()&&c.isPositive()){return -1}var l=0;var g=this.intArray;if(g.length>c.intArray.length){l=1
}else{if(g.length<c.intArray.length){l=-1}else{for(var f=0;f<g.length;f++){if(g[f]>c.intArray[f]){l=1;break}else{if(g[f]<c.intArray[f]){l=-1;break}}}if(l===0){var h=this.decArray;var n=Math.min(h.length,c.decArray.length);for(var e=0;e<n;e++){if(h[e]>c.decArray[e]){l=1;break}else{if(h[e]<c.decArray[e]){l=-1;break}}}if(l===0){if(h[n]!=null){for(var d=n;d<h.length;d++){if(h[d]!=0){l=1;break}}}else{if(c.decArray[n]!=null){for(var b=n;b<c.decArray.length;b++){if(c.decArray[b]!=0){l=-1;break}}}}}}}}return this.isPositive()?l:-l
}})})(jQuery);
(function(a){FR.TriggerEditor=FR.extend(FR.EditCompBaseEditor,{_defaultConfig:function(){return a.extend(FR.TriggerEditor.superclass._defaultConfig.apply(),{baseCls:"fr-trigger-editor",btn_up:"fr-trigger-btn-up",btn_down:"fr-trigger-btn-down",btn_over:"fr-trigger-btn-over",text_focus:"fr-trigger-text-focus",width:100,height:22})},_init:function(){FR.TriggerEditor.superclass._init.apply(this,arguments);this.initData();this.addContent2Element();this.validateCss()},addContent2Element:function(){var b=this.options;
this.element.addClass(b.baseCls);this.triggerTextComp=this.createTextComp();this._createTextComp();b.width=(b.width>-1)?b.width:this.triggerTextComp.width();b.height=(b.height>-1)?b.height:this.triggerTextComp.height();this._createTriggerBtn();this.arrow=a("<div/>").addClass("fr-trigger-center");this._createStyle4TriggerBtn();var c=a.support.boxModel?this.btn.outerWidth():this.btn.width();this.btnWidth=c>18?c:18+this.fixbtnWidthValue();this.doResize(b);if(b.value||b.value===0){this._dealValueWithEvents(b.value,false)
}if(b.isEditable){this.dealWithDisplayValue(b.showValue)}this._initViewContainer()},createTextComp:function(){return a("<div class='fr-trigger-text'></div>").appendTo(this.element)},getArrowIconHeight:function(){return 7},_createTextComp:function(){var c=this.options,b=this;this.editComp=a("<input type='text'/>").addClass("fr-trigger-texteditor").appendTo(this.triggerTextComp);this.editComp.blur(function(){b.editComp.removeClass("fr-trigger-texteditor-focus");b.triggerTextComp.removeClass(b.options.text_focus);
b._editCompBlur();if(b._canCancelSearch()&&!FR.isEmpty(b.searchText)&&b.searchCancel!==false){b.searchCancel=true;b.editComp.val("");b.setValue(b.originalValue,false)}else{if(jQuery.isFunction(b.isExpanded)&&b.isExpanded()){return}if(b.editComp&&b.editComp[0]==document.activeElement){return}b._editCompBlurValidValue();if(!b.options.write){b.fireEvent(FR.Events.STOPEDIT)}}}).focus(function(){b.editComp.addClass("fr-trigger-texteditor-focus");b.triggerTextComp.addClass(b.options.text_focus);if(b.originalValue==null){b.originalValue=b.getValue()
}if(!b.options.write){b.fireEvent(FR.Events.BEFOREEDIT)}b._editCompFocus()});if(c.fontSize){this.editComp.css("font-size",c.fontSize)}if(c.directEdit!==true){this.editComp.attr("readonly",true)}if(c.disabled===true){this.editComp.attr("disabled","disabled")}this.editComp.__bind__("keydown",this,this._onKeyDown)},_createTriggerBtn:function(){var b=this;var c=this.onTriggerClick.createDelegate(this);this.btn=a("<div/>").addClass(b.options.btn_up).appendTo(this.element);var d={onMouSeenter:function(f){if(!b.options.disabled){b.btn.switchClass(b.options.btn_over)
}},onMouseLeave:function(f){if(!b.options.disabled){b.btn.switchClass(b.options.btn_up)}},onMouseDown:function(f){if(!b.options.disabled){b.btn.switchClass(b.options.btn_down)}},onMouseUp:function(f){if(!b.options.disabled){b.btn.switchClass(b.options.btn_over);c()}}};this.btn.mouseenter(d.onMouSeenter).mouseleave(d.onMouseLeave).mouseup(d.onMouseUp).mousedown(d.onMouseDown)},isExpanded:function(){return this.$view&&this.$view.is(":visible")},collapseIf:function(c){var b=c.data;if(c.pageX==null||((c.pageX<b.$view.offset().left||c.pageX>b.$view.offset().left+b.$view.width()||c.pageY<b.$view.offset().top||c.pageY>b.$view.offset().top+b.$view.height())&&(c.pageX<b.btn.offset().left||c.pageX>b.btn.offset().left+b.btn[0].offsetWidth||c.pageY<b.btn.offset().top||c.pageY>b.btn.offset().top+b.btn[0].offsetHeight))){b.collapse()
}},collapse:function(){if(!this.isExpanded()){return}this.$view.hide();a(document).unbind("mousedown",this.collapseIf).unbind("mousewheel",this.collapseIf);if(this.options.write&&this.options.write.lgp){this.options.write.lgp.$container.unbind("scroll",this.collapseIf)}this.editComp.focus();this.focusIndex=undefined;this.fireEvent(FR.Events.COLLAPSE)},_canCancelSearch:function(){return false},_editCompBlurValidValue:function(){this.checkValid()},_editCompFocus:function(){},_editCompBlur:function(){},_initViewContainer:function(){if(!FR.$view_container){FR.$view_container=a("<div class='view-container'/>").appendTo("body")
}},_createStyle4TriggerBtn:function(){this.arrow.appendTo(this.btn)},setEnable:function(b){FR.TriggerEditor.superclass.setEnable.apply(this,arguments);if(this.editComp){if(b===true){this.editComp.removeAttr("disabled")}else{if(b===false){this.editComp.attr("disabled","disabled")}}}},modifyPosition:function(){var f=this.options.offset!=null&&this.triggerTextComp.offset().top===0&&this.triggerTextComp.offset().left===0;var g=Math.max(parseInt(f?this.options.offset.top:this.triggerTextComp.offset().top),0);
var c=Math.max(parseInt(f?this.options.offset.left:this.triggerTextComp.offset().left),0);var b=parseInt(this.options.height);var e=parseInt(this.options.width);var d=document.body.clientHeight-g-b;if(g-FR.toolbarHeight<d||g<this.tH){this.$view.css("top",g+b+(FR.Browser.r.gecko?1:0));if(d<this.tH){this.modifyTop(g)}}else{this.modifyTop(g)}if(c+this.tW>document.body.clientWidth&&(c+e>this.tW)){this.$view.css("left",c+e-this.tW)}else{this.$view.css("left",c)}},modifyTop:function(b){this.$view.css("top",(b-this.tH>0)?b-this.tH:0)
},onTriggerClick:function(){},setIcon:function(b){this.btn.attr("class",b)},fixValue:function(){return 2},fixbtnHeightValue:function(){return FR.Browser.isIE8Before()&&!a.support.boxModel?0:2},fixbtnWidthValue:function(){return FR.Browser.isIE8Before()&&!a.support.boxModel?0:1},doResize:function(f){FR.TriggerEditor.superclass.doResize.apply(this,arguments);var c=f.width-this.btnWidth,d=f.height,e=f.width-this.btnWidth,b=f.height;if(a.support.boxModel){c-=this.fixValue();d-=this.fixValue();e-=8;b-=4
}else{if(FR.Browser.r.ie10Compat||FR.Browser.r.ie9Compat||FR.Browser.r.ie11Compat){c-=3;d-=this.fixValue()}else{if(FR.Browser.isIE10()){c-=this.fixValue();d-=this.fixValue()}else{if(FR.Browser.isIE8()){if(!a.support.boxModel){e-=2}else{e-=3}}}}}this.triggerTextComp.css({width:c,height:d});this.editComp.css({width:e,height:b});if(FR.Browser.isIE()){this.editComp.css("line-height",b+"px")}this.btn.css({height:f.height-this.fixbtnHeightValue()});this.doResize4Triggerbtn(f);if(this.options.watermark){this.removeWaterMark();
this.setWaterMark()}},doResize4Triggerbtn:function(d){var b=this.getArrowIconHeight();var c=(this.btn.height()+this.fixbtnHeightValue()-b)/2;this.arrow.css("margin-top",c)},startEditing:function(){if(this.triggerTextComp){this.triggerTextComp.show()}if(this.editComp){this.editComp.focus()}this.editComp.select();if(this.options.watermark){this.removeWaterMark()}},stopEditing:function(){this.editComp.blur();if(this.triggerTextComp){this.triggerTextComp.hide()}FR.TriggerEditor.superclass.stopEditing.apply(this,arguments)
}});FR.BaseDateTimeEditor=FR.extend(FR.TriggerEditor,{_defaultConfig:function(){return a.extend(FR.BaseDateTimeEditor.superclass._defaultConfig.apply(),{})},_init:function(){FR.BaseDateTimeEditor.superclass._init.apply(this,arguments);if(this.options.value){this._dealValueWithEvents(this.options.value,false)}},getDefaultSupportFormat:function(){return["yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d","yyyy-MM-dd HH:mm:ss","yyyy-M-d HH:mm:ss","yyyy/MM/dd HH:mm:ss","yyyy/M/d HH:mm:ss"]
},_dealValueWithEvents:function(f){if(FR.isEmpty(f)){this.reset();return}if(FR.isArray(f)){f=f.toString()}var h=f||"";var g=this.options.format;if(h.date_milliseconds){h=new Date(h.date_milliseconds)}else{if(typeof f=="string"&&g){if(!this.options.customFormat){h=FR.matchDateFormat(f,g);if(h===false){var c=this.getDefaultSupportFormat();for(var e=0;e<c.length;e++){var b=FR.matchDateFormat(f,c[e]);if(b){h=b;break}}}}else{h=FR.str2Date(f,g)}}}if(h=="Invalid Date"||h=="NaN"||h===false){h=""}else{if(h instanceof Date){h=FR.date2Str(h,g);
this.options.value=h}}this.setText(h);this.options.currentDateTime=h;var d=this.options.value;this.options.value=f;if(arguments[1]!==false){this.fireEvent(FR.Events.CHANGE,f,d)}},setStartOrEndDate:function(c,b){if(!b){return}if(typeof b=="string"){b=b.replace(/-/g,"/")}if(!FR.isInvalidDate(new Date(b))){if(c=="startDate"){this.options.startDate=b;this.std=new Date(b)}else{if(c=="endDate"){this.options.endDate=b;this.edd=new Date(b)}}}},setStartDate:function(b){this.setStartOrEndDate("startDate",b)
},setEndDate:function(b){this.setStartOrEndDate("endDate",b)},setText:function(b){this.editComp.val(b)},recoveryValue:function(){this.editComp.val(this.options.oldValue)},isValidate:function(d){var c=this.options.allowBlank!==false;var i=this.options.format;var b=this.std;var h=this.edd;var g=d!=null&&d!=undefined?d:this.getValue();if(d==null&&g==null&&this.editComp.val()){this.errorMsg=FR.i18nText("FR-Engine-Value_Not_Match");return false}var f=this.options.regex;if(f){if(typeof f=="string"){f=new RegExp(f)
}if(!f.test(g)){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Engine-Error_Input_Value");return false}}if((!g)||(a.isArray(g)&&g.length===0)){if(c){return true}else{this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Engine-Not_NULL");return false}}var e=this.options.returnDate?new Date(g):FR.matchDateFormat(g,i);if(i&&typeof g=="string"&&!this.options.customFormat){if(!e){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Engine-Error_Input_Value");return false}}if(b&&new Date(e)<new Date(b)){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Engine-Err-The_Number_Is_Less_Than_The_Minimum_Value")+FR.date2Str(b,i);
return false}if(h&&new Date(e)>new Date(h)){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Engine-Err-The_Number_Is_Larger_Than_The_Maximum_Value")+FR.date2Str(h,i);return false}if(e>new Date("2999/12/31")||e<new Date("1900/01/01")){this.errorMsg="out of range";return false}return true},reset:function(){this.setText("")}});FR.BaseComboBoxEditor=FR.extend(FR.TriggerEditor,{_defaultConfig:function(){return a.extend(FR.BaseComboBoxEditor.superclass._defaultConfig.apply(),{name4Empty:FR.i18nText("FR-Engine-Choose_None"),searchTime:500,directEdit:true,customData:true})
},_init:function(){FR.BaseComboBoxEditor.superclass._init.apply(this,arguments)},initData:function(){FR.BaseComboBoxEditor.superclass.initData.apply(this,arguments);if(this.options.controlAttr){this.setSource(this.options.controlAttr);delete this.options.controlAttr}},setSource:function(c){if(c["data"]){var b=this.createDependencePara4Data();b.parameter.startIndex=0;b.parameter.limitIndex=this.options.limitData;this.options.data.setData(b,c["data"])}if(c["value"]){if(this.editComp){this.setValue(c["value"],false)
}}this.shouldReBuildList()},allPara:function(d,c){var b=this.createDependencePara4Data();b.parameter.startIndex=d?d:0;b.parameter.limitIndex=c?c:this.options.limitData;if(this.searchText||this.searchText===0||this.searchText=="0"){b.parameter.dataFilter=this.searchText;b.parameter.limitIndex=0}return b},_getViewList:function(){},getText:function(){return this.editComp.val()},getItemsLength:function(){return this.options.data.getLength()},_onEnterPressed:function(){this._selectWithoutTriggerEvent();
this.fireEvent(FR.Events.AFTEREDIT,this.selectedIndex<this.getItemsLength()?this._getSelectedItem().text():"")},_selectWithoutTriggerEvent:function(){if((this.getItemsLength()>0)&&(this.selectedIndex<this.getItemsLength())){this.setText(this._getSelectedItem().text());this.inList=true}else{this.clearText();this.searchText="";this.options.need2BuildList=true}this.checkValid();this.collapse()},_findInList:function(f){var c=this.options.data.getRecords();for(var d=0,b=c.length;d<b;d++){if((f!=""&&(c[d].getValue()==f||c[d].getShowValue()==f))||(f==""&&(c[d].getValue()===f||c[d].getShowValue()===f))){this.inList=true;
if(this.$view){this._setSelectedIndex(d)}return c[d].getShowValue()}}if(this.options.data.options.dataSource){var g=this.options.data.options.dataSource;if(g._findShowValue){var e=g._findShowValue(f);if(e){this.inList=true;return e}return false}}this.inList=false;return false},setText:function(b){this.editComp.val(b)},clearText:function(){this.editComp.val("")},_getSelectedItem:function(){return this.selectedItem},_getSelectedIndex:function(){return this.selectedIndex!=null?this.selectedIndex:-1},getSelectedIndex:function(){return this._getSelectedIndex()
},_setSelectedIndex:function(b){if(this.selectedItem){this.selectedItem.removeClass("fr-combo-selected")}this.selectedItem=this.$view.children(".fr-combo-list-item:eq("+b+")");this.selectedIndex=b;if(b>=0){this.selectedItem.addClass("fr-combo-selected").__scroll2View__(this.$view,false)}},setSelectedIndex:function(b){this._setSelectedIndex(b);this._onEnterPressed()},recoveryValue:function(){this.editComp.val(this.options.oldValue);this.searchText=this.options.oldValue;this.shouldReBuildList()},shouldReBuildList:function(){this.options.need2BuildList=true
},considerAllowBlankLength:function(){return this.getItemsLength()+(this.options.allowBlank===false?0:1)},isValidate:function(b){if(!FR.BaseComboBoxEditor.superclass.isValidate.apply(this,arguments)){return false}var c=b!=null?b:this.getValue();if(!this.options.customData){if((b!=null&&!this.isValueInList(c))||(b==null&&c===undefined)){this.errorMsg=FR.i18nText("FR-Engine-Not_In_List");this.invalidateCss();return false}}return true},isValueInList:function(b){return false},validateEmptyValue:function(c){var b=this.options.allowBlank!==false;
if(c===undefined){this.errorMsg=FR.i18nText("FR-Engine-Not_In_List");return false}if(b){return true}else{this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des");return false}},getValue:function(){var j=this.getText();var h=null;var c=this.options.data.getLoadedRecords();var d=this._getSelectedIndex();if(d>-1&&d<c.length){h=this._getValue(c[d],j,d);if(h!=null){return h}}var g=this.options.data.options.dataSource;if(c.length===0){if(g._findShowValue){var f=g._findShowValue(j,false);
if(f!=null){h=f;return h}}}else{for(var e=0,b=c.length;e<b;e++){h=this._getValue(c[e],j,e);if(h!=null){return h}}}if(h==null&&g._findShowValue){h=g._findShowValue(j,false)}if(h!=null){return h}if(this.options.customData){return j}},_getValue:function(c,f,d){var b=c.getShowValue();var e;if(typeof b=="string"){b=a.trim(b)}if(b===f||b+""===f||c.getShowValue()===f){e=c.getValue();if(this.$view){this._setSelectedIndex(d)}}return e},setValue:function(b){if(!this.isValidate(b)){return false}if((b||b===0)&&this.options.watermark){this.clearWaterMark()
}if(arguments[1]!=undefined){this._dealValueWithEvents(b,arguments[1])}else{this._dealValueWithEvents(b)}},_dealValueWithEvents:function(c){var b=this.getValue();this.options.oldValue=b;if(c===""){this.editComp.val("");return}var e=c;var d=this._findInList(c);if(d!==false){e=d}if(e&&e.length>24&&!FR.isInvalidDate(new Date(e))&&this.options.type!="datetime"){e=FR.date2Str(new Date(e),"yyyy-MM-dd")}this.setText(e);if(arguments[1]!==false){this.fireEvent(FR.Events.CHANGE,c,b);this.fireEvent(FR.Events.AFTEREDIT)
}},reset:function(){FR.BaseComboBoxEditor.superclass.reset.apply(this,arguments);this.shouldReBuildList();delete this.searchText;delete this.emptyContent;if(this.options.linkAutoChoose){this.onTriggerClick();this._setSelectedIndex(0);this._selectWithoutTriggerEvent()}}})})(jQuery);
(function(a){FR.MultiFileEditor=FR.extend(FR.BaseEditor,{_defaultConfig:function(){return a.extend(FR.MultiFileEditor.superclass._defaultConfig.apply(),{width:120,height:20,render:true,showViewImage:true})},_init:function(){FR.$defaultImport("/com/fr/web/core/js/noswfupload.js","js");FR.$defaultImport("/com/fr/web/core/css/widget/noswfupload-icons.css","css");FR.MultiFileEditor.superclass._init.apply(this,arguments);var h=this.options;var d=this;this.$uploadForm=a('<form enctype="multipart/form-data"></form>').css("position","relative").appendTo(this.element);
this.divWrap=a("<div></div>").css({"width":this.options.width+"px","height":this.options.height+"px","position":"relative","overflow":"hidden"}).appendTo(this.$uploadForm);this.$fileupload=a('<input type="file" name="file"/>').addClass("fr-fileupload").appendTo(this.divWrap);if(h.maxlength!==1){this.$fileupload[0].setAttribute("multiple","multiple")}if(h.disabled){this.$fileupload[0].setAttribute("disabled","disabled")}if(h.render===true){var e=Math.min(this.options.height,this.options.width);var c=e>32?32:e-2;
var b=e>32?20:e*0.7;this.$previewImage=a("<img>").attr("src",FR.servletURL+"?op=resource&resource=/com/fr/web/images/file/upload.gif").appendTo(this.divWrap).addClass("fr-fileupload-image").css({left:this.options.width>32?(this.options.width-32)/2:0,top:this.options.height>32?(this.options.height-32)/2:0,width:c,height:c});if(h.tooltipText){var g=a("<span/>").addClass("fr-fileupload-tooltipspan");this.tooltipDiv=a("<div/>").css({left:c+7+"px",height:c+"px"}).append(g.text(h.tooltipText)).addClass("fr-fileupload-tooltip").appendTo(this.$uploadForm)
}this.$preview=this.$previewImage;if(d.options.maxlength!==1){this.$previewCount=a('<div class="fr-fileupload-preview-count"/>').text(0).appendTo(this.divWrap).css({left:this.options.width>32?(this.options.width-32)/2+22:this.$previewImage.width()-10,top:this.options.height>32?(this.options.height-32)/2+8:0,width:b,height:b,"border-radius":b,"font-size":b*0.6})}}else{this.$preview=this.element}if(this.options.write){a(".fr-fileupload",d.element).css({"right":0,"font-size":d.element.height()<100?"100px":d.element.height()+"px","width":this.options.width,"height":this.options.height})
}this.wrap=noswfupload.wrap((this.$fileupload)[0],h.maxSize,h.maxlength,this.options.width,this.options.height);var f=this.wrap;f.onerror=function(){noswfupload.text(this.dom.info,"WARNING: Unable to upload "+this.file.fileName)};f.onloadstart=function(i,j){this.show(0,0);noswfupload.text(this.dom.info,"Preparing for upload ... ")};f.onprogress=function(i,j){this.show((this.sent+i.loaded)*100/this.total,i.loaded*100/i.total);noswfupload.text(this.dom.info,FR.i18nText("FR-Basic-File_Uping_File")+":  "+this.file.fileName);
if(this.file.fileSize!==-1){if(i.simulation){noswfupload.text(this.dom.info,FR.i18nText("FR-Basic-File_Uping_File")+":  "+this.file.fileName,FR.i18nText("FR-Basic-File_All_File_Uploaded")+noswfupload.size(this.sent+i.loaded))}else{noswfupload.text(this.dom.info,FR.i18nText("FR-Basic-File_Uping_File")+":  "+this.file.fileName,FR.i18nText("FR-Basic-File_Uploaded_File")+" "+noswfupload.size(i.loaded),FR.i18nText("FR-Basic-File_All_File_Uploaded")+noswfupload.size(this.sent+i.loaded))}}else{noswfupload.text(this.dom.info,"Uploading: "+this.file.fileName,"Sent: "+(this.sent/100)+" out of "+(this.total/100))
}};f.onerror=function(){noswfupload.text(this.dom.info,"WARNING: Unable to upload "+this.file.fileName)};f.onload=function(j,l){var k=this;noswfupload.text(this.dom.info,"Upload complete");setTimeout(function(){k.clean();k.hide();noswfupload.text(k.dom.info,"");d.fireEvent(FR.Events.AFTEREDIT)},1000);d.showViewList();var i=d.wrap.attach_array[0];d.fireEvent(FR.Events.CALLBACK,i)};f.url=this.options.url?this.options.url:FR.servletURL+"?op=fr_attach&cmd=ah_upload";f.url+=this.options.sessionID?"&sessionID="+this.options.sessionID:"";
f.url+=((window.FS&&window.FS.serverID)?"&serverID="+window.FS.serverID:"");f.fileType=h.accept;f.attach_array=[];f.attach_names=[];f.attachNum=0;this._dealValueWithEvents(h.value)},_dealValueWithEvents:function(b){if(FR.equals(b,this.wrap.attach_array)||(this.wrap.attach_array.length===1&&FR.equals(this.wrap.attach_array[0],b))){return}if((a.isArray(b)&&b.length>0&&b[0].attach_id)||(b&&b.attach_id)){var e=a.isArray(b)?b:[b];this.wrap.attach_array=[];for(var c=0;c<e.length;c++){this.wrap.attach_array.push(e[c]);
var d={};this.wrap.files.push(d)}this.showViewList();this.wrap.files.length=0}if(b==""){this.reset()}},createListItem:function(d,e){var c=this;var b=a("<li></li>");var f;b.append(f=(a("<a class='fr-fileupload-progressCancel' href='#'> </a>")).click(function(g){c.removeAttach(d,b);g.stopEvent()}).hide()).append(a("<span class='fr-fileupload-fileNameItem'>"+c.wrap.attach_names[e]+" "+FR.__fileSizeFormat__(d.fileSize)+"</span>").bind("click",function(){var g=d.attach_id;window.open(FR.servletURL+"?op=fr_attach&cmd=ah_download&id="+g)
}).mouseover(function(){a(this).css({color:"blue"})}).mouseout(function(){a(this).css({color:""})})).addClass("fr-fileupload-listitem").mouseover(function(){f.show();a(this).css({"background-color":"#9FC5F8"})}).mouseout(function(){f.hide();a(this).css({"background-color":""})});c.wrap.attachNum++;if(c.wrap.maxlength!==1){c.$previewCount.text(c.wrap.attachNum)}return b},showViewList:function(){var s=this;var h;var t;if(!s.options.hideFileList){var r=a("ul",s.element);if(r.length===0){var l=a("<div class='fr-fileupload-popview'/>").appendTo(s.element).css({marginTop:18-s.options.height/2,marginLeft:s.options.width/2+18});
h=a("<div class='fr-fileupload-popview-list'/>").appendTo(l);t=a("<ul/>").addClass("fr-fileupload-list").appendTo(h)}else{h=r.parent();t=r}}var d=s.wrap;this.imageURL=null;if(s.options.maxlength===1){var g=this.options;var q=d.attach_array[0];this.removeBackground();if(q.attach_type=="image"){s.$tempPreview=a("<td></td>").appendTo(this.divWrap).css({left:s.element.outerWidth(true)-s.element.width(),width:g.width,height:g.height,top:0,position:"absolute"});FR.lastTarget=s.$tempPreview;var f=a(s.$tempPreview);
f.css("background","");var c=FR.servletURL+"?op=fr_attach&cmd=ah_image&id="+q.attach_id;f.css("background","url("+c+") 0 0 no-repeat transparent");this.imageURL=c;f.css("cursor","default").unbind("click",b)}d.attach_names[0]=q.filename;if(t){t.children().remove();t.append(this.createListItem(q,0))}}if(s.options.maxlength!==1){for(var p=d.attach_array.length-1,k=0;k<d.files.length;p--,k++){d.attach_names[p]=d.attach_array[p].filename;var e=0;for(var n=0;n<d.attach_array.length-d.files.length;n++){if(d.attach_names[p]===d.attach_array[n].filename){e++
}}if(e>0){d.attach_names[p]=FR.lengthenFileName(d.attach_array[p].filename,"("+e+")")}t&&t.append(this.createListItem(d.attach_array[p],p))}}if(FR.Browser.isIE()&&h){if(h.height()>160){h.height(160);if(t.width()+18>h.width()){h.width(t.width()+18)}}}function b(i){window.open(FR.servletURL+"?op=fr_attach&cmd=ah_download&id="+i.data);i.stopPropagation()}},removeAttach:function(e,c){var b=e.attach_id;var d=this;var f=this.wrap;FR.ajax({url:FR.servletURL+"?op=fr_attach&cmd=ah_release",data:{id:b},complete:function(h,g){if(g=="success"){if(c){c.remove()
}for(var i=0;i<f.attach_array.length;i++){if(f.attach_array[i].attach_id==b){if(d.wrap.maxlength!==1){f.attachNum--;d.$previewCount.text(d.wrap.attachNum);if(f.attachNum===0){a(".fr-fileupload-popview",d.element).remove()}}f.attach_array.remove(f.attach_array[i]);break}}if(d.wrap.maxlength===1){a(".fr-fileupload-popview",d.element).remove();d.removeBackground()}d.fireEvent(FR.Events.CALLBACK)}}})},resetBackground:function(c){var b=c||this.imageURL;this.removeBackground();if(this.options.tdCell){this.options.tdCell.css("background","url("+b+"&height="+this.options.tdCell.height()+") 0 0 no-repeat transparent")
}},removeBackground:function(){if(this.options.tdCell){this.options.tdCell.css("background-image","")}var b=this.divWrap.children().eq(2);b.css("background-image","");b.remove()},startEditing:function(){if(this.options.tdCell){a(".attach-download-div,.fr-fileupload-download-all",a(this.options.tdCell)).hide()}this.$preview.show();if(this.options.disabled){this.$preview.unbind("click")}if(FR.Browser.isIE()&&!a.support.boxModel&&this.options.write){a(".x-editor").addClass("none-border")}},stopEditing:function(){if(this.options.tdCell){var c=a(".attach-download-div,.fr-fileupload-download-all",a(this.options.tdCell));
c.show()}if(FR.Browser.isIE()&&!a.support.boxModel&&this.options.write){a(".x-editor").removeClass("none-border")}if(this.imageURL!=null){var b=this;setTimeout(function(){b.resetBackground()},200)}},getValue:function(){if(!this.wrap.attach_array){return""}if(this.options.maxlength===1&&this.wrap.attach_array[0]&&this.wrap.attach_array[0].attach_type=="image"){return this.wrap.attach_array[0]}return this.wrap.attach_array.length===0?"":this.wrap.attach_array},setEnable:function(b){FR.MultiFileEditor.superclass.setEnable.apply(this,arguments);
if(this.$fileupload&&this.$fileupload[0]){if(b){this.$fileupload[0].removeAttribute("disabled")}else{this.$fileupload[0].setAttribute("disabled","disabled")}}},isShowViewImage:function(){return this.options.showViewImage&&this.options.maxlength===1},reset:function(){this.wrap.attach_array=[];this.wrap.attach_names=[];this.wrap.attachNum=0;if(this.options.tdCell){a(".attach-download-div",a(this.options.tdCell)).remove()}a(".fr-fileupload-popview",this.element).remove();this.removeBackground()}});a.shortcut("multifile",FR.MultiFileEditor)
})(jQuery);
(function(a){FR.TabPane=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.TabPane.superclass._defaultConfig.apply(),{baseCls:"fr-tabpane",width:"100%",height:"100%",active:0,tabPosition:"top",tabHeight:22,noControl:false,items:[],defaultActiveIndex:0})},_init:function(){FR.TabPane.superclass._init.apply(this,arguments);var d=this.options;this.element.css({width:d.width,height:d.height});var b=this._createConfig4TabPaneConfig();var e=new FR.BorderLayout(b);e.doLayout();this.wrapWidth=0;
this._initTabs();if(this.tabBtns[d.defaultActiveIndex]){this.tabBtns[d.defaultActiveIndex].setSelected()}this.isMoving=false;this.activeTabIndex=d.defaultActiveIndex;var c=this;this.tabsContent.parent().addClass(d.baseCls+"-tabscontent-bg");a(window).resize(function(){c.fireEvent(FR.Events.SCROLLCHANGE,c,c.activeTabIndex)})},_createConfig4TabPaneConfig:function(){var e=this.options;var d=e.tabPosition;var f=e.baseCls+"-content";this.tabPaneContent=a("<div></div>").addClass(f).addClass(f+"-"+d);var b=this._createConfig4TabControl();
var c={renderEl:this.element,items:[{region:"center",el:this.tabPaneContent},{height:e.tabHeight,region:d=="top"?"north":"south",el:b}]};return c},_createConfig4TabControl:function(){var d=this,e=this.options;this.tabsContent=a("<div/>").addClass(e.baseCls+"-tabscontent").addClass(e.baseCls+"-tabscontent-"+e.tabPosition);var c=[{region:"center",el:a("<div/>").append(this.tabsContent)}];if(!this.options.noControl){c.unshift({region:"west",el:{type:"horizontal",widgetName:"controlbuttons",baseCls:"fr-tabpane-controlbuttons",alignment:"center",hgap:3,vgap:2,items:[{el:this._createTabControlBtn("arrow1",function(){if(d.isMoving){return
}d._moveViewToPos("start")}),width:13},{el:this._createTabControlBtn("arrow2",function(){if(d.isMoving){return}var g=d.stepDis;var f=d.tabsContent.offset().left-d.tabsWrap.offset().left;g=Math.min(g,f);d._moveViewToPos(g)}),width:13},{el:this._createTabControlBtn("arrow3",function(){if(d.isMoving){return}var g=d.stepDis;var f=d.tabsWrap.offset().left+d.wrapWidth-d.tabsContent.offset().left-d.tabsContent.width();g=Math.min(g,f);g=g<0?0:g;d._moveViewToPos(-g)}),width:13},{el:this._createTabControlBtn("arrow4",function(){if(d.isMoving){return
}d._moveViewToPos("end")}),width:13}]},width:72})}var b={type:"border",items:c};return b},_createTabControlBtn:function(c,d){var b=new FR.IconButton({type:"iconbutton",baseClass:"fr-edit-sheetcontrol-icon-box",handler:d});a("<div>").addClass("fr-edit-sheetcontrol-icon-"+c).appendTo(b.element);return b.element},_initTabs:function(){var c=this.options;this.tabBtns=[];this.tabsWrap=a("<ul/>").addClass(c.baseCls+"-tabswrap").appendTo(this.tabsContent);if(!c.items){return}if(!c.tabs){c.tabs=[]}for(var b=0;
b<c.items.length;b++){this._addTabContent(c.items[b]);this._addTabTag(b,c.items[b])}},_addTabContent:function(d){var b=this.options.tabs;if(d.tabContent){var e=FR.createWidget(d.tabContent);e.element.appendTo(this.tabPaneContent);d.content=e.element}else{var c=a("<div/>").addClass("html-content").appendTo(this.tabPaneContent);c.css("background",this.options.background);d.content=c}d.content.hide();b.push(d)},_addTabTag:function(f,g){var d=this,c=this.options.items;var e={tabPane:this,name:g.title,index:f,isFirst:f===0,isLast:f===c.length-1,renderEl:a("<li/>").appendTo(this.tabsWrap),tabBtns:this.tabBtns,handler:function(){if(d.activeTabIndex>=0){d.options.tabs[d.activeTabIndex].content.hide()
}d.activeTabIndex=f;if(d.options.tabs[f].content){d.options.tabs[f].content.show()}d.showSheetContent(d.activeTabIndex);d._moveViewToShow(d.activeTabIndex)}};var b=new FR.SheetButton(e);this.tabBtns.push(b);this.wrapWidth+=b.getWidth();this.stepDis=this.wrapWidth/this.tabBtns.length},_moveViewToShow:function(d){var c=this.tabBtns[d].element;var j=this.tabsWrap;var b=this.tabsContent;var g=b.offset().left;var m=g+b.width();var l=j.offset().left;var f=l+this.wrapWidth;var k=c.offset().left;var i=k+c.width();
var e=c.width();var h=0;if(k<g){h=g-l;h=Math.min(h,e)}else{if(i>m){h=m-f;h=Math.max(h,-e)}else{return}}this._moveViewToPos(h)},_moveViewToPos:function(d){var b=this;this.isMoving=true;if(d=="start"){this.tabsWrap.animate({"left":"0"},"fast",function(){b.isMoving=false})}else{if(d=="end"){var c=this.tabsContent.width()-this.wrapWidth;if(c>0){c=0}this.tabsWrap.animate({"left":c},"fast",function(){b.isMoving=false})}else{this.tabsWrap.animate({"left":"+="+d},"fast",function(){b.isMoving=false})}}},showSheetContent:function(b){this.fireEvent(FR.Events.TABCHANGESTART,this,b);
this.fireEvent(FR.Events.TABCHANGE,this,b);this.fireEvent(FR.Events.SCROLLCHANGE,this,b)},doResize:function(b){this.element.css({width:b.width,height:b.height})},selectTabAt:function(b){if(b>=0){this.tabBtns[b].setSelected();return true}return false},selectTabByName:function(c){var b=this;if(c){a.each(this.options.tabs,function(d,e){if(e.title===c){b.tabBtns[d].setSelected()}});return true}return false},getTabByIndex:function(b){if(b>=0){return this.options.tabs[b]}return{}},getTabByName:function(b){if(!FR.isEmpty(b)){for(var c=0;
c<this.tabBtns.length;c++){if(this.tabBtns[c].options.name===b){return this.options.tabs[c]}}}return{}},switchTabByName:function(b){if(FR.isEmpty(b)){return false}for(var c=0;c<this.tabBtns.length;c++){if(this.tabBtns[c].options.name===b){return this.selectTabAt(c)}}return false},getSelectedIndex:function(){return this.activeTabIndex}});a.shortcut("tabpane",FR.TabPane);FR.SheetButton=FR.extend(FR.Widget,{_defaultConfig:function(){return a.extend(FR.SheetButton.superclass._defaultConfig.apply(),{tabPane:null,tabBtns:[],isFirst:false,isLast:false,index:0,minWidth:60,handler:null,disabled:false,name:"",containerCls4btn:"fr-sheetbutton-container",intersectCls4btn:"fr-sheetbutton-intersect",firstPartCls4btn:"fr-sheetbutton-firstpart",middlePartCls4btn:"fr-sheetbutton-middlepart",thirdPartCls4btn:"fr-sheetbutton-thirdpart",endPartCls4btn:"fr-sheetbutton-endpart",button_class_prefix:"fr-sheet-icon-",button_closebtn_class:"fr-sheetbutton-closebutton"})
},_init:function(){FR.SheetButton.superclass._init.apply(this,arguments);var d=this.options,b=this;var c=d.tabPane.options.tabPosition;if(c=="top"){d.firstPartCls4btn+="-"+c;d.middlePartCls4btn+="-"+c;d.thirdPartCls4btn+="-"+c;d.endPartCls4btn+="-"+c}this.element.addClass(d.containerCls4btn).attr("title",d.name);this._createTabBtnByName(d.name);if(a.isFunction(d.handler)){this.on(FR.Events.CLICK,d.handler.createDelegate(d.scope||this))}this.element.click(function(){if(b.isEnabled()){b.setSelected()
}});this.width=this.element.width();this.fireEvent(FR.Events.AFTERINIT)},_createTabBtnByName:function(c){var d=this.options;var b=this.element;if(this.options.isFirst){b.head=a("<span/>").addClass(d.firstPartCls4btn).appendTo(b)}b.middle=a("<span/>").addClass(d.middlePartCls4btn).text(c).appendTo(b);if(b.middle.width()<d.minWidth){b.middle.width(d.minWidth)}if(!d.isLast){b.end=a("<span/>").addClass(d.thirdPartCls4btn).appendTo(b)}else{b.end=a("<span/>").addClass(d.endPartCls4btn).appendTo(b)}},getWidth:function(){return this.width
},setSelected:function(){var c=this.options;if(this.isActive()){return}this.setActiveState(true);var b=c.tabPane.activeTabIndex;if(b>=0&&b!==c.index){c.tabBtns[b].setActiveState(false)}this.fireEvent(FR.Events.CLICK)},setActiveState:function(b){var c=this.options;this.isActiveState=b;if(b){this.element.addClass(c.containerCls4btn+"-active");if(!c.isFirst){c.tabBtns[c.index-1].element.addClass(c.intersectCls4btn)}}else{this.element.removeClass(c.containerCls4btn+"-active");if(!c.isFirst){c.tabBtns[c.index-1].element.removeClass(c.intersectCls4btn)
}}},setValidState:function(f){var b=this.element,d=this.options;var c=d.index;if(!f){if(d.isFirst){b.head.switchClass(d.firstPartCls4btn+"-invalidate")}else{var e=d.tabPane.tabBtns[c-1];if(e.isValid()){e.element.end.switchClass(d.thirdPartCls4btn+"-invalidate-style3")}else{e.element.end.switchClass(d.thirdPartCls4btn+"-invalidate-style2")}}b.middle.switchClass(d.middlePartCls4btn+"-invalidate");if(d.isLast){b.end.switchClass(d.endPartCls4btn+"-invalidate")}else{if(d.tabPane.tabBtns[c+1].isValid()){b.end.switchClass(d.thirdPartCls4btn+"-invalidate")
}else{if(d.tabPane.tabBtns[c-1].isValid()){b.end.switchClass(d.thirdPartCls4btn+"-invalidate-style2")}}}}else{if(d.isFirst){b.head.switchClass(d.firstPartCls4btn)}else{var e=d.tabPane.tabBtns[c-1];if(e.isValid()){e.element.end.switchClass(d.thirdPartCls4btn)}else{e.element.end.switchClass(d.thirdPartCls4btn+"-invalidate")}}b.middle.switchClass(d.middlePartCls4btn);if(d.isLast){b.end.switchClass(d.endPartCls4btn)}else{if(d.tabPane.tabBtns[c+1].isValid()){b.end.switchClass(d.thirdPartCls4btn)}else{b.end.switchClass(d.thirdPartCls4btn+"-invalidate-style3")
}}}this.isValidState=f},isValid:function(){return this.isValidState!==false},isActive:function(){return this.isActiveState===true},destroy:function(){this.element.empty()}});a.shortcut("sheetbutton",FR.SheetButton)})(jQuery);
(function(a){FR.Elementcase=FR.extend(FR.BaseEditor,{_init:function(){FR.Elementcase.superclass._init.apply(this,arguments);this.$toolbar=a("<div class='x-toolbar' style='height:21px'></div>");this.$inner=a("<div class='reportContent'></div>");this.$inner.css("overflow","auto");this.totalPage=-1;this.currentPage=1;var b=this;this.initPane();this.gotoPage(1);this._init4Style()},_init4Style:function(){this._init4Margin()},_init4Margin:function(){var b=a(".reportContent",this.element);if(!b){return}var c=this.options.border;
if(c){b.css("border-style",c.type);b.css("border-color",c.color);b.css("border-width",c.width);b.css("border-radius",c.borderRadius);this.borderWidth=(this.borderWidth||0)+parseInt(c.width*2)}if(this.options.marginTop){b.css("marginTop",this.options.marginTop);this.marginHeight=(this.marginHeight||0)+parseInt(this.options.marginTop)}if(this.options.marginLeft){b.css("marginLeft",this.options.marginLeft);this.marginWidth=(this.marginWidth||0)+parseInt(this.options.marginLeft)}if(this.options.marginBottom){b.css("marginBottom",this.options.marginBottom);
this.marginHeight=(this.marginHeight||0)+parseInt(this.options.marginBottom)}if(this.options.marginRight){b.css("marginRight",this.options.marginRight);this.marginWidth=(this.marginWidth||0)+parseInt(this.options.marginRight)}if(!this.options.widgetBackground){return}var d=this.options.widgetOpacity;if(!d){FR.setBackground(b,this.options.widgetBackground,b.height());return}this.$background=a("<div class='widgetBackground'></div>");this.$background.css("filter","alpha(opacity="+d*100+")");this.$background.css("opacity",d);
FR.setBackground(this.$background,this.options.widgetBackground,b.height())},encodePara:function(b){if(!b){return""}if(typeof b==="string"){b=FR.jsonDecode(b)}a.each(b,function(c,d){if(typeof d==="string"){b[c]=encodeURIComponent(FR.cjkDecode(d.replaceAll('"','\\"')))}});return b},gotoPage:function(f,c,b,e){var d=this;FR.ajax({url:FR.servletURL,type:"POST",data:{op:"fr_form",cmd:"load_report_content",sessionID:this.options.form.sessionID,widgetName:this.options.widgetName,__parameters__:e?c:FR.encodePara(c),noCache:b||"",pageIndex:f,_:new Date().getTime(),__boxModel__:a.support.boxModel,_PAPERWIDTH:FR.windowWidth,_PAPERHEIGHT:FR.windowHeight,_SHOWPARA:a(".parameter-container-collapseimg-down").length===0},beforeSend:function(){FR.HtmlLoader.loadingEffect({el:d.$inner,show:true,fixed:false})
},async:true,complete:function(j,g){if(g=="success"){var i=FR.jsonDecode(j.responseText);if(i.length===0){d.$inner.html(j.responseText);return}d.totalPage=i["totalPage"]?i["totalPage"]:1;if(d.options.showToolbar){d.numberLabel.setValue(" /"+d.totalPage);d.inputField.setValue(f)}d.$inner[0].innerHTML=i["htmlTag"];if(FR.Report.Plugin.ScrollProcessor.item&&FR.Plugin.validLevel(FR.Report.Plugin.ScrollProcessor,FR.Report.Plugin.ScrollProcessor.item)){if(a(".frozen-page").length>0){FR.Report.Plugin.ScrollProcessor.item.action.call(this,a(".frozen-north",d.$inner),"y");
FR.Report.Plugin.ScrollProcessor.item.action.call(this,a(".frozen-center",d.$inner),"both");FR.Report.Plugin.ScrollProcessor.item.action.call(this,a(".frozen-west",d.$inner),"x")}}d.$inner.asComponent({type:"fr_form",selector:"td[widget],div[widget][heavytd='light']"});d.currentPage=f;d.changeColWidth();d.changeHeight();a(".x-table",d.$inner).css("overflow","visible");var k=a(".frozen-page",d.$inner).length>0?"hidden":"auto";if(FR.Report.Plugin.ScrollProcessor.item&&FR.Plugin.validLevel(FR.Report.Plugin.ScrollProcessor,FR.Report.Plugin.ScrollProcessor.item)){k="hidden";
FR.Report.Plugin.ScrollProcessor.item.action.call(this,d.$inner,"both");var h=0;if(d.options.border){h=(d.options.border.width||0)*2}d.$inner.css("width",d.$inner.width()-(d.options.marginLeft||0)-(d.options.marginRight||0)-h);d.$inner.css("height",d.$inner.height()-(d.options.marginTop||0)-(d.options.marginBottom||0)-h)}FR.HtmlLoader.loadingEffect({el:d.$inner,show:false,overflow:k});if(d.$background){d.$background.prependTo(d.element)}}}})},isFit:function(){var b=this.options.form;return b.options&&b.options.__FIT__
},changeHeight:function(){var d=a(".frozen-page",this.$inner);if(d.length>0){var h=a(".page-block",this.$inner);var g=a(".frozen-west",d);var f=a(".frozen-north",d);var c=a(".frozen-center",d);var i=FR.toolbarHeight;var e=this.options.height-i-(this.marginHeight||0)-(this.borderWidth||0);var b=0;a(".rows-height-counter",f).each(function(){b+=a(this).height()});c.height(e-b);g.height(e-b);h.height(e+"px");c.scroll(function(){f.scrollLeft(c.scrollLeft());g.scrollTop(c.scrollTop())}.createDelegate(this))
}if(this.$background){this.$background.css("height",this.options.height);this.$background.css("margin-bottom",-this.options.height)}},changeColWidth:function(){var c=a(".frozen-page",this.$inner);var g=a(".page-block",this.$inner);if(c.length>0){this.doForzen(c,g)}else{var f=this.options.widgetName;var h=a("."+f+"col");var e=a("."+f+"table");var d=e.height()>this.options.height?this.options.width-20:this.options.width-2;var b={array:h,table:e,width:d-(this.marginWidth||0)-(this.borderWidth||0)};if(!this.isFit()){this.changeTableW(b)
}g.width(e.width())}if(this.$background){this.$background.css("width",this.options.width)}},doForzen:function(g,b){this.$inner.css("overflow","hidden");var k=g.width();var e=a(".frozen-corner",g);var i=a(".frozen-west",g);var c=a(".frozen-north",g);var h=a(".frozen-center",g);var j={cornerTable:a(".x-table",e),westTable:a(".x-table",i),northTable:a(".x-table",c),centerTable:a(".x-table",h)};if(!this.isFit()){this.changeFrozenTable(j,k)}var d=j.westTable.width();var f=this.options.width-d-(this.marginWidth||0)-(this.borderWidth||0);
d=parseInt(d)+"px";f=parseInt(f)+"px";e.width(d);i.width(d);h.width(f);c.width(f)},changeFrozenTable:function(n,q){var g=n.cornerTable;var d=n.westTable;var k=n.northTable;var p=n.centerTable;var s=(d.width()/q)*this.options.width;var i=20;var b=this.options.width-s-i-(this.marginWidth||0)-(this.borderWidth||0);var e=a("col",g);var o=a("col",d);var c=a("col",k);var r=a("col",p);var f=this.getCornerStartColumn(r,c);var m={array:e,table:g,width:s,start:0};var j={array:o,table:d,width:s,start:0};var h={array:c,table:k,width:b,start:f};
var l={array:r,table:p,width:b,start:f};this.changeTableW(m);this.changeTableW(j);this.changeTableW(h);this.changeTableW(l)},getCornerStartColumn:function(c,b){if(c.length>0){return parseInt(a(c[0]).attr("col"))}return Math.max(c.length,b.length)},changeTableW:function(e){var m=e.array;var o=e.table;var l=e.width;if(m.length===0||o.length===0){return}var g=this.getMinWidths(m);var f=0;for(var k=0;k<g.length;k++){f+=g[k]}if(f>l){l=f}var n=this.getCurrentWidths(m);var c=0;for(var k=0;k<n.length;k++){c+=n[k]
}var j=this.calculatorNewWidths(g,n,l,c);for(var k=0;k<m.length;k++){var b=a(m[k]);var h=j[k];b[0].style.width=h+"px";var d=parseInt(b.attr("col"));this.calCellFrozenTableWidth(d,e.start,o,h-5)}o[0].style.width=l+"px"},calculatorNewWidths:function(f,m,h,c){var k=[];var j=h;while(true){var e=h/c;var d=false;for(var g=0;g<f.length;g++){if(k[g]===undefined){var b=parseInt(e*m[g]);if(b<=f[g]){k[g]=f[g];h-=k[g];c-=k[g];d=true}}}if(!d){for(var g=0;g<f.length;g++){if(k[g]===undefined){var b=parseInt(e*m[g]);
k[g]=b}}break}}var l=0;for(var g=0;g<f.length;g++){l+=k[g]}k[k.length-1]=k[k.length-1]+j-l;return k},getCurrentWidths:function(d){var c=[];for(var b=0;b<d.length;b++){c[b]=parseInt(a(d[b]).attr("c-w"))}return c},getMinWidths:function(d){var c=[];for(var b=0;b<d.length;b++){c[b]=parseInt(a(d[b]).css("min-width"))}return c},calCellFrozenTableWidth:function(d,c,m,g){if(parseInt(c)>=0){var e="table.col"+d;var b="td.col"+d;var l=a(e,m);var j=a(b,m);var k=g+"px";for(var f=0,h=l.length;f<h;f++){l[f].style.width=k
}for(var f=0,h=j.length;f<h;f++){j[f].style.width=k}}},initToolbar:function(){var c=this;var d=new FR.Button({icon:"css:x-emb-formpre",width:25,height:20,render:false,renderEl:a("<div/>").appendTo(a('<div style="float:left;"></div>').appendTo(c.$toolbar)),handler:function(){if(c.currentPage-1>0){c.gotoPage(c.currentPage-1);c.currentPage--}}});c.inputField=new FR.NumberEditor({renderEl:a("<div/>").appendTo(a('<div style="float:left;padding-left:2px;"></div>').appendTo(c.$toolbar)),width:30,height:20,allowDecimals:true,allowNegative:true,style:"text-align:center"});
c.inputField.on(FR.Events.AFTEREDIT,function(f){if(f.keyCode==FR.keyCode.ENTER){c.gotoPage(this.getValue())}});c.numberLabel=new FR.Label({renderEl:a("<div/>").appendTo(a('<div style="float:left;padding-left:2px;"></div>').appendTo(c.$toolbar)),width:38,height:20});var b=new FR.Button({icon:"css:x-emb-formnext",width:25,height:20,render:false,renderEl:a("<div/>").appendTo(a('<div style="float:left;"></div>').appendTo(c.$toolbar)),handler:function(){if(c.currentPage+1<=c.totalPage){c.gotoPage(c.currentPage+1);
c.currentPage++}}})},initPane:function(){var c=this;var b=[];if(c.options.showToolbar){c.initToolbar();b.push({region:"north",el:c.$toolbar})}b.push({region:"center",el:c.$inner});var d=new FR.BorderLayout({items:b,renderEl:c.element});d.doLayout();a(window).resize(function(){d.doLayout()})},doResize:function(c){if(!FR.Browser.isIE8Before()&&this.options.border){this.element.parent().css("box-shadow",this.options.border.borderStyle)}var b=c.width;if(c.width&&c.width!=this.options.width){this.options.width=c.width;
this.changeColWidth()}if(c.height&&c.height!=this.options.height){this.options.height=c.height;this.changeHeight()}if(this.isFit()){this.gotoPage(this.currentPage)}}});a.shortcut("elementcase",FR.Elementcase)})(jQuery);
(function(a){FR.ComboBoxEditor=FR.extend(FR.BaseComboBoxEditor,{_defaultConfig:function(){return a.extend(FR.ComboBoxEditor.superclass._defaultConfig.apply(),{name4Empty:FR.i18nText("FR-Basic_Choose_None"),maxCount:10,sonHeight:18,value:"",limitData:500,autoFixWidth:true})},_init:function(){FR.ComboBoxEditor.superclass._init.apply(this,arguments);this._dealSearch();var c=this.options;this.scrollBarWidth=20;if(!this.$view){this.$view=a("<div/>").height(20).appendTo(FR.$view_container)}this.$view.hide();
this.shouldReBuildList();if(this.options.data&&this.options.data.isLocalSource()){if(this.options.dependence){this.options.data.resetStatus(this.allPara.apply(this,arguments))}var b=this.options.data.getRecords();this._setItems(b);this.checkViewScroll(b);this.options.need2BuildList=false;this.options.need2FixWidth=true}FR.applyStyles(this.editComp,c.style)},_dealSearch:function(){var b=this,c=this.options;if(this.options.widgetUrl){this.options.searchData=new FR.AjaxSearchData({url:this.options.widgetUrl});
this.editComp.keyup(function(d){if(!b.options.directEdit){return}if(b.options.offset==undefined){b.options.offset={"left":b.editComp.offset().left,"top":b.editComp.offset().top}}if(!FR.isNavKeyPress(d)){setTimeout(function(){if(b.searchText==b.editComp.val()&&d.keyCode!=FR.keyCode.BACKSPACE){if(!b.isExpanded()){b.expand()}return}b.edited=true;if(b.searchCancel!==true){b.searchText=b.editComp.val();b._doBeforeSearch();b.inList=false;b._ajaxSearch();b.fireEvent(FR.Events.AFTEREDIT);b.searchCancel=false
}else{b.searchCancel=undefined}},c.searchTime)}})}},_ajaxSearch:_.debounce(function(){this.embellishView();this.$view.empty();this.$view.height(30);FR.HtmlLoader.loadingMoreData({el:this.$view,show:true});this.modifyPosition();this.$view.show();var b=this.allPara.apply(this,arguments);this.options.searchData.resetStatus(b);var c=this;var d=c.lastAjaxSearchTimes?(c.lastAjaxSearchTimes+1):1;c.lastAjaxSearchTimes=d;this.options.searchData.loadObject(function(e){if(d<c.lastAjaxSearchTimes){return}c.options.data.setData(b,e);
c.checkViewScroll(c.options.data.getData());c._setItems(c.options.data.getData());FR.HtmlLoader.loadingMoreData({el:c.$view});c.$view.hide();c.options.need2BuildList=false;c._createVieList();c.__makeSureInputValueInResList();if(c.options.data.getData().length>0){c.setFocusWithIndex(0)}})},600),_canCancelSearch:function(){return true},__makeSureInputValueInResList:function(){var c=this;var b=c._getViewList();if(b.length!==0){if(c.searchText==""){c.inList=undefined}else{for(var d=0;d<b.length;d++){if(b.eq(d).text()==c.searchText){c.inList=true;
break}c.inList=false}}}else{c.inList=false}if(c.inList===false&&!c.options.customData){this.errorMsg=FR.i18nText("FR-Basic_Not_In_List");this.invalidateCss()}else{this.validateCss()}},isValueInList:function(b){return this._checkValueInResList(b)},_checkValueInResList:function(f){var b=f||this.editComp.val();var g=this.options.data.options.dataSource;if(g._findShowValue){var e=g._findShowValue(b,false);this.inList=e!=null}else{var c=this._getViewList();this.inList=false;if(c.length!==0){for(var d=0;
d<c.length;d++){if(c.eq(d).text()==b){this.inList=true;break}}}}if(this.inList===false){this.errorMsg=FR.i18nText("FR-Basic_Not_In_List");return false}else{return true}},_doBeforeSearch:function(){},rebuild:function(b){this.options.data=null;this.options.widgetUrl=null;this.element.empty();this.$view.empty();this.options.items=b;this.options.need2BuildList=true;if(b.widgetUrl){this.options.widgetUrl=b.widgetUrl}this._init()},_getViewList:function(){return this.$view.children(".fr-combo-list-item")
},setFocusWithIndex:function(b){a(".fr-combo-list-item",this.$view).removeClass("fr-combo-selected");this.focusIndex=b;a(".fr-combo-list-item",this.$view).eq(b).addClass("fr-combo-selected")},getData:function(){var h=this.getText();var g=h,d=this.options.data.getLoadedRecords(),e=this._getSelectedIndex();if(e>-1&&e<d.length){var c=d[e].getShowValue();if(typeof c=="string"){c=a.trim(c)}if(c==h){return d[e].getContent()}}else{for(var f=0,b=d.length;f<b;f++){if(d[f].getShowValue()==h){g=d[f].getContent();
if(this.$view){this._setSelectedIndex(f)}break}}return g}},_onKeyDown:function(c){var b=c.data;switch(c.keyCode){case FR.keyCode.DOWN:if(!b.isExpanded()){b.onTriggerClick()}else{if(b.focusIndex==undefined){b.focusIndex=b._getSelectedIndex()||0}if(b.focusIndex<(b.considerAllowBlankLength()-1)){b._setItemFocus(b.focusIndex+1,b.focusIndex);b.focusIndex=b.focusIndex+1}else{b._setItemFocus(0,b.focusIndex);b.focusIndex=0}}c.stopEvent();break;case FR.keyCode.UP:if(b.isExpanded()){if(b.focusIndex==undefined){b.focusIndex=b._getSelectedIndex()
}if(b.focusIndex-1>=0){b._setItemFocus(b.focusIndex-1,b.focusIndex);b.focusIndex=b.focusIndex-1}else{b._setItemFocus(b.considerAllowBlankLength()-1,b.focusIndex);b.focusIndex=b.considerAllowBlankLength()-1}c.stopEvent()}break;case FR.keyCode.ENTER:b.collapse();break;case FR.keyCode.TAB:if(b.isExpanded()){if(b.focusIndex!=undefined){b._setSelectedIndex(b.focusIndex)}else{b.collapse();b.editComp.blur();c.stopEvent();break}b._onEnterPressed();if(b.editComp.val()==""&&b.options.allowBlank!==false){b.inList=true
}c.stopEvent()}break}},onTriggerClick:function(){if(!this.isEnabled()){return}if(this.isExpanded()){this.collapse()}else{this._createVieList()}},_createVieList:function(c){var b=this;this.embellishView();if(this.options.need2BuildList){this.$view.empty();if(c!==false){this.tH=30;this.tW=Math.max(this.options.width,100);this.$view.height(this.tH);this.$view.width(this.tW);this.modifyPosition();this.$view.show()}FR.HtmlLoader.loadingMoreData({el:this.$view,show:true});var d=function(e){b.checkViewScroll(e);
b._setItems(e);b.$view.hide();b.options.need2BuildList=false;b.options.need2FixWidth=true;b._doExpand(c)};if(b.options.data){b.options.data.resetStatus(this.allPara.apply(this,arguments));b.options.data.loadRecordsAsync(d)}else{this.$view.hide();FR.HtmlLoader.loadingMoreData({el:this.$view});this.options.need2BuildList=false;this.options.need2FixWidth=true}}this._doExpand(c)},_doExpand:function(b){if(this.options.need2FixWidth!==false){this.fixViewWidth();this.options.need2FixWidth=false}if(b!==false){this.expand();
this.modifyPosition()}},scrollLoadMoreData:function(){if(this.isLoadingData){return}this.isLoadingData=true;FR.HtmlLoader.loadingMoreData({el:this.$view,show:true});this.options.data.resetStatusKeepData(this.allPara(this.options.data.getLength()));var b=this.data2Add();this.checkViewScroll(b);this.addData2View(b);this.isLoadingData=false},data2Add:function(){return this.options.data.appendData()},addData2View:function(c){var e=this.editComp.val();var b=-1;if(this.$view){if(!this.emptyContent){var j=this._checkAndAddEmptyContent()
}else{this.initContent(this.emptyContent,this.options.name4Empty,-1)}var l=document.createDocumentFragment();var g=this.options.data.getLength();for(var d=g-c.length;d<g;d++){var k=d+c.length-g;var h=a("<div/>");l.appendChild(h[0]);var f=c[k].getShowValue();this.initContent(h,f,d);if(b<0&&f==e){b=k}}this.$view[0].appendChild(l);this.$view.append(j||this.emptyContent);FR.HtmlLoader.loadingMoreData({el:this.$view});this._setSelectedIndex(b);this.fixWidth()}},fixWidth:function(c){a(this.$view[0]).css("width","auto");
if(this.$view.width()<this.element.width()){var b=this.element.width();if(this.addedScrollWidth){b+=this.scrollBarWidth}this.$view.width(b-2)}if(c&&this.$view.width()<c){this.$view.width(c)}},initContent:function(b,e,d){if(e==null){e=""}var c=this;b.height(this.options.sonHeight).attr("title",e).text(e).addClass(d>-1?"fr-combo-list-item":"fr-combo-list-item fr-combo-list-item-noselect").hover(function(f){c.setFocusWithIndex(d);setTimeout(function(h){if(!h){return}var g=a(h.target);if(c.$view[0].style.display!="none"&&g.isChildAndSelfOf(a(this).parent().children())){a(this).removeClass("fr-combo-selected")
}},10)}).click(function(f){c.inList=true;c.fireEvent(FR.Events.CLICK);c._setSelectedIndex(d>-1?d:c.getItemsLength());c._onEnterPressed()})},_checkAndAddEmptyContent:function(){if(this.options.allowBlank===false){return}this.emptyContent=a("<div/>");this.initContent(this.emptyContent,this.options.name4Empty,-1);return this.emptyContent},checkViewScroll:function(b){this.$view.need2Scroll=this.options.limitData<=b.length},embellishView:function(){if(this.viewEmbellished){return}a(".fr-combo-list").hide();
var b=this;if(!this.$view){this.$view=a("<div/>").appendTo(FR.$view_container).height(20)}this.$view.addClass("fr-combo-list").css({position:"absolute",width:"auto","z-index":"999"}).scroll(function(){if(b.$view.need2Scroll&&a(this).scrollTop()+a(this).height()>=this.scrollHeight){b.scrollLoadMoreData()}});this.viewEmbellished=true},_setItems:function(b){var c=this.options.sonHeight,e=this.considerAllowBlankLength();var d=this.options.maxCount||10;this.tH=e>d?(c+2)*d:(c+2)*e;this.$view.height(this.tH);
this.addData2View(b);this.tW=this.$view.width()},expand:function(){if(this.isExpanded()){return}this._showView();a(document).bind("mousedown",this,this.collapseIf).bind("mousewheel",this,this.collapseIf);if(this.options.write&&this.options.write.lgp){this.options.write.lgp.$container.bind("scroll",this,this.collapseIf)}if(document.activeElement!=this.editComp[0]){this.editComp.focus()}this.fireEvent(FR.Events.EXPAND)},_showView:function(){this.$view.show()},_setItemFocus:function(b,c){var d=this.$view.children(".fr-combo-list-item");
a(d[c]).removeClass("fr-combo-selected");a(d[b]).addClass("fr-combo-selected").__scroll2View__(this.$view,false)},setEnable:function(b){FR.ComboBoxEditor.superclass.setEnable.apply(this,arguments);if(b===false){this.collapse()}},setVisible:function(b){FR.ComboBoxEditor.superclass.setVisible.apply(this,arguments);if(b===false){this.collapse()}},isFiltering:function(){return !FR.isEmpty(this.searchText)},fixViewWidth:function(){if(FR.Browser.isIE()&&FR.Browser.isIE7Before()){var e=0;var f=a(".fr-combo-list-item",this.$view);
for(var c=0;c<f.length;c++){var b=FR.byteLength(f.eq(c).text())*6+30;e=Math.max(e,b)}this.$view.width(this.options.mutiSelection?e+30:e+10)}if(!FR.Browser.isIE()&&this.$view.children().length>this.options.maxCount&&!this.addedScrollWidth){this.$view.width(this.$view.width()+this.scrollBarWidth);this.addedScrollWidth=true}if(this.$view.width()<this.element.width()){var d=this.element.width();this.$view.width(this.element.width()-2)}if(FR.Browser.isIE()&&FR.Browser.isIE7Before()&&this.$view.width()<120){this.$view.width(120)
}if(FR.Browser.isIE()){this.$view.css("overflow-x","visible")}},dealWithDisplayValue:function(b){this.setText(b)}});a.shortcut("combo",FR.ComboBoxEditor)})(jQuery);
(function(a){FR.CheckBoxEditor=FR.extend(FR.ComboBoxEditor,{_defaultConfig:function(){return a.extend(FR.CheckBoxEditor.superclass._defaultConfig.apply(),{delimiter:",",startSymbol:"",endSymbol:"",itemCheckOnClass:".fr-checkbox-checkon",itemCheckOffClass:".fr-checkbox-checkoff"})},_init:function(){FR.CheckBoxEditor.superclass._init.apply(this,arguments);this.$view.addClass("fr-checkbox-list");this._initCheckBoxContainer();this.options.delimiter=this.options.delimiter.replace(/\\r/g,"\n")},_initCheckBoxContainer:function(){if(!this.ck_el_array){this.ck_el_array=[]
}},_setItems:function(d){var c=d||[];var e=this.options.sonHeight;var g=this.options.maxCount||10;var f=c.length>g?(e+2)*g:(e+2)*c.length;this.$view.height(f+e+2);this.tH=f+e;this.modifyPosition();var b=this;this.initControlPane();this.innerCheckBox=b._createInnerCheckBox();this.innerCheckBox.on(FR.Events.CLICK,function(){b.editComp.val("");if(this.selected()){b.doSelectAll()}else{b.deSelectAll()}b.editComp.focus()});this.$view.append(this.$controlPane);this.ck_el_array=[];this.addData2View(c)},initControlPane:function(){this.$controlPane=a("<div style='padding-right:20px'>").addClass("fr-checkbox-control")
},_createInnerCheckBox:function(){var b=this;var c=20;return new FR.CheckBox({renderEl:a("<div/>").appendTo(b.$controlPane),text:FR.i18nText("FR-Engine_Choose_All")+"/"+FR.i18nText("FR-Engine_Deselect_All"),width:b.$view.width()-c})},addData2View:function(f){var n=this;var d=this.ck_el_array.length;for(var h=d,l=d+f.length;h<l;h++){var g=f[h-d];var c=a("<div/>").height(this.options.sonHeight).attr("title",g.getShowValue()).addClass("fr-combo-list-item").appendTo(this.$view);var k=this._createItemCheckBox(c,g);
if(this.inAllSelectModel===true||a.inArray(g.getShowValue(),n.text)!==-1){k.setSelectedWithoutEvent(true)}this.ck_el_array[h]=k}if(!this.options.isInited){var j;if(typeof this.options.value=="string"){j=this.options.value.split(this.options.delimiter)}else{if(FR.isArray(this.options.value)){j=this.options.value}}if(!FR.isEmpty(j)&&!FR.isEmptyArray(j)){a.each(this.ck_el_array,function(i,q){var o=q.options.value;var p=q.options.text;if(j.indexOf(o+"")!=-1||j.indexOf(p+"")!=-1||j.indexOf(o)!=-1||j.indexOf(p)!=-1){q.changeBoxState(true)
}else{if(q.isSelected()){q.changeBoxState(false)}}})}this.options.isInited=true}var e=a(this.options.itemCheckOnClass,this.$view);if(e.length==this.ck_el_array.length){this.innerCheckBox.selected(true)}FR.HtmlLoader.loadingMoreData({el:this.$view});if(FR.Browser.isIE()){var m=FR.i18nText("FR-Engine_Choose_All")+"/"+FR.i18nText("FR-Engine_Deselect_All");var b=FR.byteLength(m)*6+28;this.fixWidth(b)}else{this.fixWidth()}},_createItemCheckBox:function(b,e){var c=this;var d=new FR.CheckBox({renderEl:a("<div/>").appendTo(b),text:e.getShowValue(),value:e.getValue(),listeners:[{eventName:FR.Events.STATECHANGE,action:function(){c.editComp.val("");
c.fireEvent(FR.Events.CLICK);if(!this.isSelected()){c.innerCheckBox.setSelected(false);if(c.inAllSelectModel){c.inAllSelectModel=false}}else{var f=a(this.options.itemCheckOnClass,c.$view);if(f.length==c.ck_el_array.length){c.innerCheckBox.setSelected(true)}}c._refreshComponentValue(this);c.editComp.focus()}}]});return d},_doBeforeSearch:function(){this.searchText=this.editComp.val()},_onEnterPressed:function(){var b=this._getSelectedIndex();var c=this.ck_el_array[b];if(c){c.setSelected(!c.isSelected())
}this.collapse()},_refreshComponentValue:function(b){if(!this.text){this.text=[]}if(b.isSelected()){this.text.push(b.getText())}else{this.text.remove(b.getText())}this._setCompText(this.text);this.fireEvent(FR.Events.AFTEREDIT)},modifyPosition:function(){this.options.offset={"top":this.element.offset().top,"left":this.element.offset().left};this.tW=this.$view.width();FR.CheckBoxEditor.superclass.modifyPosition.apply(this,arguments)},data2Add:function(){if(this.inAllSelectModel===true){var f=[];var c=this.options.data.getRecords();
var e=this.ck_el_array.length;for(var d=0,b=c.length;d<this.options.limitData;d++){if(d+e>=b){break}f[d]=c[d+e]}return f}else{return this.options.data.appendData()}},doSelectAll:function(){var c=[];var d=this;if(this.isFiltering()){a.each(this.ck_el_array,function(e,f){f.setSelectedWithoutEvent(true);c.push(f.getText())})}else{if(!this.allRecords){this.inAllSelectModel=true;var b=this.createDependencePara4Data();b.parameter.startIndex=0;b.parameter.limitIndex=0;this.options.data.resetStatus(b);this.allRecords=this.options.data.executeData();
this.options.data.records=this.allRecords}a.each(d.allRecords,function(e,f){c.push(f.getShowValue())});a.each(this.ck_el_array,function(e,f){f.setSelectedWithoutEvent(true)})}this._setCompText(c);d.fireEvent(FR.Events.AFTEREDIT)},deSelectAll:function(){var b=this;a.each(this.ck_el_array,function(c,d){d.setSelectedWithoutEvent(false)});this.inAllSelectModel=false;this._setCompText([]);b.fireEvent(FR.Events.AFTEREDIT)},_dealValueWithEvents:function(g){var d=this;var e=this.getValue();if(g==""){this._setCompText([]);
d.options.need2BuildList=true;return}var f;if(typeof g==="string"){if(!this.options.returnArray){if(g.startWith(this.options.startSymbol)){g=g.substring(this.options.startSymbol.length)}if(g.endWith(this.options.endSymbol)){g=g.substring(0,g.length-this.options.endSymbol.length)}}f=g.split(this.options.delimiter)}else{f=a.makeArray(g)}var c=this.options.data.getRecords();var b=false;if(c.length>0){a.each(f,function(j,k){for(var l=0,h=c.length;l<h;l++){if(c[l].getValue()==k){f[j]=c[l].getShowValue();
b=true;break}}})}if(!FR.equals(this.text,f)){this.options.need2BuildList=true}this._setCompText(f);if(arguments[1]!==false){this.fireEvent(FR.Events.AFTEREDIT,g,e)}},getValue:function(){var k=this;var g=this._getCompText();if(!this.options.data){return}var c=this.options.data.getLoadedRecords();var e={};var j={};for(var d=0,f=c.length;d<f;d++){e[c[d].getShowValue()]=c[d].getValue()}var b=this.options.data.options.dataSource;if(!FR.isEmptyArray(g)){a.each(g,function(m,q){var p=null;if(!k.isEmptyMap(j)){p=j[q]
}else{p=e[q]}if(p==null&&k.isEmptyMap(j)&&b._findAllValue){var n=b._findAllValue();if(!FR.isEmpty(n)){for(var o=0,l=n.length;o<l;o++){j[n[o].text]=n[o].value}p=j[q]}}if(p==null&&b._findShowValue){p=b._findShowValue(g[m],false)}if(FR.isEmpty(p)){if(k.options.customData){g[m]=q}else{if(p===undefined){g=undefined;return false}}}else{g[m]=p}})}if(g){if(this.options.returnArray){return g}var h=this.options.startSymbol+g.join(this.options.delimiter)+this.options.endSymbol;return h}},isEmptyMap:function(c){for(var b in c){if(b){return false
}}return true},getText:function(){var b=this._getCompText();return this.options.returnArray?b:this.options.startSymbol+b.join(this.options.delimiter)+this.options.endSymbol},_setCompText:function(b){this.text=b;this.editComp.val(b.join(this.options.delimiter))},_getCompText:function(){return this.editComp.val().split(this.options.delimiter)},rebuild:function(b){this.reset();FR.CheckBoxEditor.superclass.rebuild.apply(this,arguments)},reset:function(){this.ck_el_array=[];this.text=null;this.setValue("");
this.shouldReBuildList();this.allRecords=null}});a.shortcut("combocheckbox",FR.CheckBoxEditor)})(jQuery);
FR.TagCheckBoxEditor=FR.extend(FR.CheckBoxEditor,{_defaultConfig:function(){return $.extend(FR.TagCheckBoxEditor.superclass._defaultConfig.apply(),{tagBaseClass:"fr-tageditor",minWidth4Edit:24,tagMargin:4,animateSpeed:100})},_init:function(){FR.TagCheckBoxEditor.superclass._init.apply(this,arguments);this._initTagContainer();this.startTagIdx=-1;this.widthFix=0;if(FR.Browser.isIE6Before()){this.widthFix=4}},_editCompBlur:function(){if(this.options.watermark&&this.text&&this.text.length>0){this.removeWaterMark.defer(0,this)
}},_editCompBlurValidValue:function(){if(this.options.allowBlank===false&&(!this.text||this.text.length===0)){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des");this.invalidateCss()}else{this.validateCss()}this.searchText="";var a=this.editComp.val();if(a!=""){a=this._getEditTagFullValue(a);this._appendTagFromInput(a);this.editComp.val("");this._editCompBlur()}},_doBeforeSearch:function(){},_initTagContainer:function(){var c=this.options;c.minWidth4Edit=Math.max(2*c.fontSize,c.minWidth4Edit);
var a=this.editComp.height(),b=c.tagBaseClass;this.tagContainer=$("<div/>").addClass(b+"-container").height(a).prependTo(this.triggerTextComp);this.tagWrap=$("<span/>").addClass(b+"-wrapper").appendTo(this.tagContainer)},_bindEvent2Tag:function(a){var b=this,c=this.options;a.click(function(){b._setTagSelect($(this))});a.dblclick(function(){if(c.directEdit!==false&&c.customData!==false){b._editTag($(this))}})},_editTag:function(d){var c=this.tagWrap.children().index(d)+this.startTagIdx+1;d.hide();
var a=$("<input type='text'/>").addClass("fr-tageditor-tag-edit").val(d.text()).css({width:d.outerWidth(),"font-size":this.options.fontSize}).insertAfter(d);this.isTagEditing=true;var b=this;a.blur(function(){b.collapse();b.isTagEditing=false;var e=$(this).val();$(this).remove();if(e===""){b._removeTag(d)}else{d.text(e);e=b._getEditTagFullValue(e);b._spliceTagData(c,e);d.show();b._loadMoreTags(b.text);b._modifyTagPosition();b._moveViewToShow(d)}b.fireEvent(FR.Events.STOPEDIT)});a.keyup(function(g){var f=g.keyCode;
if(!FR.isNavKeyPress(g)){b._spliceTagData(c,a.val());b.fireEvent(FR.Events.AFTEREDIT)}else{if(f===FR.keyCode.ENTER){$(this).blur()}}});a.focus()},_setCompText:function(a){this.text=a;if(this.tagWrap){this.tagWrap.empty();this.startTagIdx=a.length-1;this._loadMoreTags(a);this._modifyTagPosition();this._moveViewToShow()}else{FR.TagCheckBoxEditor.superclass._setCompText.apply(this,arguments)}},_loadMoreTags:function(b){if(this.startTagIdx>=0){var a=this.element.width()-this.options.minWidth4Edit-this.btnWidth;
while(this.tagWrap.width()<a&&this.startTagIdx>=0){this._createTagFromText(b[this.startTagIdx]).prependTo(this.tagWrap);this.startTagIdx--}}},_appendTagFromInput:function(b){if(this.checkValid(b)){if($.inArray(b,this.text)===-1){this._pushTagData(b);this._createTagFromText(b).appendTo(this.tagWrap);this._modifyTagPosition();this._moveViewToShow();var a=$.grep(this.ck_el_array,function(c){return c.getText()==b});if(a&&a[0]){a[0].changeBoxState(true)}this.fireEvent(FR.Events.AFTEREDIT)}}else{FR.Msg.toast(this.errorMsg)
}},_getEditTagFullValue:function(a){return a},_pushTagData:function(a){if(!this.text){this.text=[]}this.text.push(a)},_spliceTagData:function(a,b){if(b==undefined){this.text.splice(a,1)}else{this.text.splice(a,1,b)}},_removeTag:function(d,c){if(c){this.text.pop()}else{var b=this.tagWrap.children().index(d)+this.startTagIdx+1;this._spliceTagData(b)}var a=d.next();d.remove();this.fireEvent(FR.Events.AFTEREDIT);this.inAllSelectModel=false;this.options.need2BuildList=true;this._loadMoreTags(this.text);
this._modifyTagPosition();this._setTagSelect(a)},_getCompText:function(){this.text=this.text||[];return this.text.slice(0)},_createTagFromText:function(f){var e=this.options;var b=f;if($.isArray(f)){b=f[f.length-1]}if(FR.isEmpty(b)){return $("")}var a=this.editComp.height();var d=this.options.tagBaseClass;var c=$("<span/>").addClass(d+"-tag").text(b).css({"line-height":a+"px","margin":"0 "+e.tagMargin/2+"px","font-size":this.options.fontSize});this._bindEvent2Tag(c);return c},_modifyTagPosition:function(){var d=this.options;
var b=d.minWidth4Edit;var c=d.tagBaseClass;if(d.isEditable){this.tagContainer.appendTo(this.triggerTextComp)}var f=$("."+c+"-container",this.triggerTextComp);var a=$.support.boxModel?this.triggerTextComp.width()-1:this.triggerTextComp.width()-2;var e=this.tagWrap.width();if(a-e<b){this.editComp.outerWidth(b-this.widthFix);f.width(a-b)}else{this.editComp.outerWidth(a-e-this.widthFix);f.width(e)}},_setTagSelect:function(e){var c=this.options.tagBaseClass;var b=c+"-tag-select";$("#"+b,this.tagWrap).removeAttr("id");
if(e){var a=this;var d=function(f){if(a.isTagEditing){return}if(f.keyCode==FR.keyCode.DELETE||f.keyCode==FR.keyCode.BACKSPACE){FR.Keys.unreg(d);a._removeTag(e)}else{if(f.keyCode==FR.keyCode.LEFT){if(e.prev().length>0){a._setTagSelect(e.prev())}}else{if(f.keyCode==FR.keyCode.RIGHT){a._setTagSelect(e.next());if(e.next().length===0){a.editComp.focus()}}}}};FR.Keys.reg(d);$("body").bind("mousedown.tagselect",function(f){if(!$(f.target).isChildAndSelfOf(a.tagWrap)){FR.Keys.unreg(d);$("#"+b,a.tagWrap).removeAttr("id")
}});e.attr("id",c+"-tag-select");this._moveViewToShow(e)}else{this._moveViewToShow()}},_editCompFocus:function(){var a=this.editComp.val();if(a!=""){this._setCompText(this.text);if(!this.isFiltering()){this.editComp.val("")}}else{this._setTagSelect()}},_moveViewToShow:function(h){var b=this.options,k=this;var a=this.tagContainer.width(),d=this.tagWrap.width();if(h&&h.length>0){if(this.editComp.outerWidth()>this.options.minWidth4Edit){return}var c=this.tagWrap.offset().left;var j=this.tagContainer.offset().left;
var e=c-j;var i=h.width();var f=j+a/2-i/2;while(this.startTagIdx>=0&&h.offset().left<f){this._createTagFromText(this.text[this.startTagIdx]).prependTo(this.tagWrap);this.startTagIdx--}var g=h.offset().left-f;d=this.tagWrap.width();if(g<0){g="-="+Math.max(g,e)}else{g="-="+Math.min(g,d-a+e)}}else{g=Math.min(a-d,0)}this.tagWrap.animate({left:g},b.animateSpeed)},_onKeyDown:function(f){var b=f.keyCode,a=f.data;if(b==FR.keyCode.ENTER){if(this.value==""){a.collapse()}else{a._appendTagFromInput(this.value);
a.editComp.val("");a._editCompBlur()}f.stopEvent()}else{if(b==FR.keyCode.LEFT){if(this.value==""&&a.tagWrap.children().length>0){var c=a.options.tagBaseClass;a._setTagSelect($("."+c+"-tag:last",a.tagWrap));a.editComp.blur();f.stopEvent()}}else{if(b==FR.keyCode.BACKSPACE){if(this.value==""&&a.tagWrap.children().length>0){var c=a.options.tagBaseClass;var d=$("."+c+"-tag:last",a.tagWrap);a._removeTag(d,true);f.stopEvent()}}}}FR.CheckBoxEditor.superclass._onKeyDown.apply(this,arguments)},__makeSureInputValueInResList:function(){if(this.searchText==undefined){return
}var d=this.searchText;var a=d.split(/[,;]/);var b=d.endWith(",")||d.endWith(";")||d.endWith("")||d.endWith("");if(!b){return}for(var c=0;c<a.length;c++){if(a[c]!=""){this._checkAndAddTag(a[c]);this.fireEvent(FR.Events.AFTEREDIT);break}}},_checkAndAddTag:function(b){if(FR.isEmpty(b)||b==""){return}this.searchText=b;FR.CheckBoxEditor.superclass.__makeSureInputValueInResList.apply(this,arguments);if(this.inList||this.options.customData){if(this.text==undefined){this.text=[]}if($.inArray(b,this.text)===-1){this._pushTagData(b);
this._addResultTag(b);this.searchText=null;this.editComp.val("");var a=$.grep(this.ck_el_array,function(c){return c.getText()==b});if(a&&a[0]){a[0].changeBoxState(true)}this.collapse();this.options.need2BuildList=true;this.editComp.focus()}}else{FR.Msg.toast("No custom value allowed");this.editComp.val(b)}},_addResultTag:function(a){this.tagWrap.append(this._createTagFromText(a));this._modifyTagPosition()},validateCss:function(){this.editComp.removeClass("fr-trigger-invalid");this.editComp.removeClass("fr-trigger-text-invalid");
this.editComp.removeAttr("title")},invalidateCss:function(){this.editComp.addClass("fr-trigger-text-invalid");this.editComp.attr("title",this.getErrorMsg())},startEditing:function(){FR.TagCheckBoxEditor.superclass.startEditing.apply(this,arguments);this._modifyTagPosition()},reset:function(){FR.TagCheckBoxEditor.superclass.reset.apply(this,arguments);this.inAllSelectModel=false;this.tagContainer&&this.tagContainer.remove();delete this.tagContainer;this._initTagContainer();if(this.options.watermark){this.removeWaterMark();
this.setWaterMark()}},setText:function(a){if(this.options.isEditable){this.tagContainer&&this.tagContainer.remove()}this.text=a;this.editComp.val(a)},getValue:function(){return FR.TagCheckBoxEditor.superclass.getValue.apply(this,[this._getCompText()])}});$.shortcut("tagcombocheckbox",FR.TagCheckBoxEditor);
(function(a){FR.TreeComboBoxEditor=FR.extend(FR.TagCheckBoxEditor,{_defaultConfig:function(){return a.extend(FR.TreeComboBoxEditor.superclass._defaultConfig.apply(),{width:120,height:300,returnArray:true,delimiter:";",nodeDelimiter:/[;]/,pathDelimiter:/[,]/,startSymbol:"",endSymbol:"",cascadecheck:true,mutiSelection:false,limitData:300,autoFixWidth:true})},_init:function(){FR.TreeComboBoxEditor.superclass._init.apply(this,arguments);this.$view.attr("id",this.options.location)},initData:function(){if(this.options.data){return
}if(this.options.rootLoader){this.options.data=new FR.TreeData({treeLoader:this.options.rootLoader})}else{if(this.options.widgetUrl){this.options.data=new FR.TreeData({url:this.options.widgetUrl})}else{if(this.options.items){this.options.data=new FR.ItemTreeData({items:this.options.items})}}}if(this.options.controlAttr){this.setSource(this.options.controlAttr);delete this.options.controlAttr}},_setItems:function(f){this.tH=150;this.$view.height(this.tH);var b=FR.createTreeConfig4Widget(this);var c=this.options.data.getData();
var l=this.options.selectLeafOnly;var k=this.options.mutiSelection;var j=[];this.value=this.value||[];this.text=this.text||[];if(this.options.autoMatch!==false){var h=this.searchText||this.editComp.val();if(typeof h=="string"){h=FR.isEmpty(h)?"":h.replace(/[,;]$/,"")}if((h.indexOf(";")!=-1||h.indexOf("")!=-1)&&k){var g=FR.parseString2Array4Tree(h,this);for(var e=0;e<g.length;e++){var n=FR.getValidTreeTrace(g[e],c,l);if(FR.isArray(n)&&!FR.isEmptyArray()){j.push(n)}}}else{if(h.indexOf(",")!=-1||h.indexOf("")!=-1){j=FR.getValidTreeTrace(h.split(/[,]/),c,l)
}else{if(h!=""){j=FR.getTreeTrace(h,c,k,l)}}}if(k){j=this.value}else{this.value=FR.isEmptyArray(j)?a.makeArray(h):j}}else{if(k){j=this.value}else{j=this.editComp.val().split(this.options.delimiter)}}FR.setAllNodeState(c,0);if(FR.isArray(j)&&!FR.isEmptyArray(j)){if(k){j=FR.parseTo2DArray(j);for(var d=0;d<j.length;d++){FR.setNodeStateByInitValue(c,0,j[d],l)}}else{FR.findSelectedNode(c,0,j,b)}}this._createTreeView(b);this.options.isInited=true;this.options.need2BuildList=false},_createTreeView:function(b){this.$view.treeview(b)
},_editCompBlur:function(){if(this.options.mutiSelection){FR.TreeComboBoxEditor.superclass._editCompBlur.apply(this,arguments)}},_editCompBlurValidValue:function(){if(this.options.allowBlank===false&&(!this.text||this.text.length===0)){this.errorMsg=this.options.errorMsg||FR.i18nText("FR-Base_NOT_NULL_Des");this.invalidateCss()}else{this.validateCss()}if(this.options.mutiSelection){var b=this.editComp.val();if(b!=""){b=this._getEditTagFullValue(b);this.options.need2BuildList=true;this.searchText="";
this._appendTagFromInput(b);this.editComp.val("");this._editCompBlur()}}},_getEditTagFullValue:function(b){return b.split(/[,]/)},_pushTagData:function(b){this.text.push(b);this.value.push(b)},_spliceTagData:function(b,c){if(c==undefined){this.text.splice(b,1);this.value.splice(b,1)}else{this.text.splice(b,1,c);this.value.splice(b,1,c)}},_removeTag:function(d,c){if(c){this.value.pop();this.text.pop()}else{var b=this.tagWrap.children().index(d)+this.startTagIdx+1;this._spliceTagData(b)}d.remove();
this.fireEvent(FR.Events.AFTEREDIT);this.inAllSelectModel=false;this.options.need2BuildList=true;this._loadMoreTags(this.text);this._modifyTagPosition();this._moveViewToShow()},_onKeyDown:function(b){if(b.data.options.mutiSelection){FR.TreeComboBoxEditor.superclass._onKeyDown.apply(this,arguments)}},setOptions:function(b){this.$view.setOptions(b)},setTraversal:function(b){this.setOptions({traversal:b})},_editCompFocus:function(){if(this.options.mutiSelection){FR.TreeComboBoxEditor.superclass._editCompFocus.apply(this,arguments)
}},checkViewScroll:function(){},initFilterData:function(){if(!this.options.filterData){this.options.data=new FR.TreeData({url:this.options.widgetUrl})}else{this.options.data=this.options.filterData}},_timer:null,_ajaxSearch:function(){if(this._timer){clearTimeout(this._timer)}var b=this;this._timer=setTimeout(function(){b._timer=null;if(b.searchText||b.searchText===0){b.initFilterData()}else{b.initData()}FR.TreeComboBoxEditor.superclass._ajaxSearch.apply(b,arguments)},600)},_onEnterPressed:function(g,f){if(!this.options.mutiSelection){this.text=this.$view.getTCPText();
this.value=this.$view.getTCPValue();var d=this.text.length;this.editComp.val(d===0?"":this.text[d-1]);this.collapse()}else{if(!this.options.selectLeafOnly){var j=g.getValuePath();var h=FR.parseString2Array4Tree(g.getShowValue(),this);if(g.getcheckstate()===1){this.value.push(j);this.text.push(h)}else{if(g.getcheckstate()===0){for(var e=0;e<this.value.length;e++){if(FR.equals(j,this.value[e])){this.value.remove(this.value[e]);break}}this.text.remove(h)}}this._dealWithEditComp()}else{this.text=this.$view.getTCPTexts();
this.value=this.$view.getTCPValues();var c=this.text;var b=[];for(var e=0;e<c.length;e++){b.push(c[e][c[e].length-1])}this._dealWithEditComp(b)}}this.fireEvent(FR.Events.CLICK);if(f!==false){this.fireEvent(FR.Events.AFTEREDIT)}},_dealWithEditComp:function(b){var c=b||this.text;this.editComp.val("");this.editComp.focus();this._setCompText(c)},_dealValueWithEvents:function(g){if(g===""){return}var d=this.getValue();var e;if(typeof g==="string"){e=FR.parseString2Array4Tree(g,this);if(FR.isEmptyArray(e)){e=g.split(this.options.delimiter)
}}else{e=a.makeArray(g)}var c=[];var f=[];if(!this.options.mutiSelection){FR.findTrueValue(this.options.data.getData(),0,e,c,f)}else{e=FR.parseTo2DArray(e);for(var b=0;b<e.length;b++){FR.findTrueValue(this.options.data.getData(),0,a.isArray(e[b])?e[b]:e[b].split(","),c,f)}}if(c.length!==0){this.text=c.slice(0);this.value=this.options.mutiSelection?f:f[0]}else{this.text=e.slice(0);this.value=e}this._setCompText(this.text);if(!FR.equals(d,g)){this.options.need2BuildList=true}if(arguments[1]!==false){this.fireEvent(FR.Events.AFTEREDIT)
}},dealWithDisplayValue:function(b){if(b==undefined||(this.options.mutiSelection&&b==="")){return}var c;if(typeof b==="string"){c=FR.parseString2Array4Tree(b,this);if(FR.isEmptyArray(c)){c=b.split(this.options.delimiter)}}else{c=a.makeArray(b)}this._setCompText(c.slice(0))},_setCompText:function(b){if(this.options.mutiSelection){FR.TreeComboBoxEditor.superclass._setCompText.apply(this,arguments)}else{FR.TagCheckBoxEditor.superclass._setCompText.apply(this,arguments)}},__makeSureInputValueInResList:function(){if(!this.options.mutiSelection){return
}FR.TreeComboBoxEditor.superclass.__makeSureInputValueInResList.apply(this,arguments)},getValue:function(){return FR.getTreeValueResult(this._getEditVal(),this.options.mutiSelection,this.options.returnFullPath)},getEditValue:function(){return this.getFullPathValue()},getFullPathValue:function(){return FR.getTreeValueResult(this._getEditVal(),this.options.mutiSelection,true)},_getEditVal:function(){var b=[];if(this.editComp&&this.editComp.val()==""&&!this.options.mutiSelection){b=[]}if(this.value){b=this.value
}else{if(this.$view&&this.options.isInited&&a.isFunction(this.$view.getTCPValue)){if(!this.options.mutiSelection){this.value=this.$view.getTCPValue()||this.editComp.val().split(this.options.delimiter)}else{this.value=this.$view.getTCPValues()||this.editComp.val().split(this.options.delimiter)}b=this.value}}return b},recoveryValue:function(){FR.TreeComboBoxEditor.superclass.recoveryValue.apply(this,arguments);this.value=this.options.oldValue},getText:function(){var b;if(this.text){b=this.text}else{b=FR.parseString2Array4Tree(this.editComp.val(),this)
}return FR.getTreeValueResult(b,this.options.mutiSelection,this.options.returnFullPath)},fixViewWidth:function(){FR.TreeComboBoxEditor.superclass.fixViewWidth.apply(this,arguments);this.options.oriWidth=this.$view.width()},isComboBoxTree:function(){return true},reset:function(){this._dealValueWithEvents([]);this.shouldReBuildList();this.options.isInited=false},getValueNodes:function(){return this.$view.getTSNs()},getNode:function(b){return this.$view.getNode(b)},getSelectedNodes:function(){this.selectedNodes=this.getValueNodes();
this.fireEvent(FR.Events.DEALSELECTEDNODES);return this.selectedNodes},getNodeByID:function(g,c){if(!c){c=this.options.data.getData()}for(var f=0,b=c.length;f<b;f++){if(c[f].getID()===g){return c[f]}if(c[f].ChildNodes||(c[f].data&&c[f].data.ChildNodes)){var e=c[f].getChildren();if(!e||(e.length===0)){continue}var d=this.getNodeByID(g,e);if(d){return d}}}},isValueInList:function(b){if(_.isArray(b)&&FR.isEmpty(b.toString())){return true}if(this.options.data.options.treeLoader&&this.options.data.options.treeLoader.options&&this.options.data.options.treeLoader.options.rootSource&&this.options.data.options.treeLoader.options.rootSource._findShowValue){return this.options.data.options.treeLoader.options.rootSource._findShowValue(b,false)!=null
}return true},isValidate:function(b){if(!FR.BaseComboBoxEditor.superclass.isValidate.apply(this,arguments)){return false}var c=b!=null?b:this.getFullPathValue();if(!this.options.customData&&!FR.isEmpty(c)&&!this.isValueInList(c)){this.errorMsg=FR.i18nText("FR-Engine-Not_In_List");this.invalidateCss();return false}return true}});a.shortcut("treecombobox",FR.TreeComboBoxEditor)})(jQuery);
FR.DateTimeEditor=FR.extend(FR.BaseDateTimeEditor,{_defaultConfig:function(){return $.extend(FR.DateTimeEditor.superclass._defaultConfig.apply(),{format:"yyyy-MM-dd",directEdit:true})},_init:function(){FR.DateTimeEditor.superclass._init.apply(this,arguments);this.switchArrow();if(this.options.widgetCss&&this.options.widgetCss.length!==0){$.each(this.options.widgetCss,function(c,d){FR.$import(d,"css",true)})}var b=this.options;this.viewMode=this._initViewMode();this.std=this._createStartDate(b.startDate,b.format,this.viewMode);
this.edd=this._createEndDate(b.endDate,b.format,this.viewMode);var a=this;if(!this.$view){this.$view=$("<div/>").appendTo(FR.$view_container).hide()}this.editComp.keydown(function(c){a.editComp[0].realValue=null});$(this.editComp).keyup(function(){if($(this).val()==a.oriText){return}a.isValidateInput();a.oriText=$(this).val();a.fireEvent(FR.Events.AFTEREDIT)})},getArrowIconHeight:function(){return 17},switchArrow:function(){this.arrow.switchClass("fr-trigger-center","fr-date-trigger-center")},_applyInvalidCss:function(a){this.errorMsg=a;
this.invalidateCss()},onTriggerClick:function(a){if(!this.isEnabled()){return}if(document.activeElement!=this.editComp[0]){this.editComp.focus()}if(this.isExpanded()){if(FR.Browser.isIE8()&&this.$view.css("visibility")=="hidden"){this.$view.css("visibility","visible")}else{this.$view.show()}}else{this.$view.empty();this._createCalendar()}},_showView:function(){if(FR.Browser.isIE8()&&this.$view.css("visibility")=="hidden"){this.$view.css("visibility","visible")}else{this.$view.show()}},_createStartDate:function(d,b,e){if(FR.isEmpty(d)){return null
}var a=FR.str2Date(d,b);switch(e){case 0:return new Date(a.getFullYear(),a.getMonth(),1,0,0,0);case 1:return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);case 2:var c=new Date();c.setHours(0);c.setMinutes(0);c.setSeconds(0);return c;case 3:return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);default:return a}},_createEndDate:function(c,a,e){if(FR.isEmpty(c)){return null}var d=FR.str2Date(c,a);switch(e){case 0:return new Date(d.getFullYear(),d.getMonth(),d.getMonthDays(),23,59,59);
case 1:return new Date(d.getFullYear(),d.getMonth(),d.getDate(),23,59,59);case 2:var b=new Date();b.setHours(23);b.setMinutes(59);b.setSeconds(59);return b;case 3:return new Date(d.getFullYear(),d.getMonth(),d.getDate(),23,59,59);default:return d}},modifyPosition:function(){this.tH=this.$view.height();this.tW=this.$view.width();FR.DateTimeEditor.superclass.modifyPosition.apply(this,arguments)},_initViewMode:function(){var b=this.options;var a=1;if(b.format.match(/[YyDd]/)&&b.format.match(/[Hh]/)){a=3
}else{if(b.format.match(/[M]/)&&!b.format.match(/[Dd]/)&&!b.format.match(/[Hh]/)){a=0}else{if(!b.format.match(/[YyMDd]/)){a=2}}}return a},_createCalendar:function(){var e=this.options;var b=this;if(this.options.need2BuildConfig===true&&this.options.data){this.options.data.resetStatus(this.createDependencePara4Data());var c=this.options.data.getData();if(c[0].data){if(c[0].data.startDate){var d=new Date(c[0].data.startDate);if(!FR.isInvalidDate(d)){e.startDate=FR.date2Str(d,"yyyy-MM-dd");this.std=this._createStartDate(e.startDate,e.format,this.viewMode)
}}if(c[0].data.endDate){var a=new Date(c[0].data.endDate);if(!FR.isInvalidDate(a)){e.endDate=FR.date2Str(a,"yyyy-MM-dd");this.edd=this._createEndDate(e.endDate,e.format,this.viewMode)}}}this.options.rebuildConfig=false}this.datepicker=new FR.DatePicker({renderEl:this.$view,viewMode:this.viewMode,date:FR.str2Date(this.editComp.val(),e.format),dateFormat:e.format,startDate:this.std,endDate:this.edd,onDateUpdate:function(){if($(":focus").length===0){b.editComp.focus()}b.editComp.val(FR.date2Str(this.getValue(),e.format));
b.isValidateInput();b.fireEvent(FR.Events.AFTEREDIT)}});if(FR.Browser.isIE8()&&this.$view.css("visibility")=="hidden"){this.$view.css("visibility","visible")}else{this.$view.show()}$(document).bind("mousedown",this,this.collapseIf);this.modifyPosition()},getValue:function(){var d=this.options.format;if(!this.options.returnDate){var c=this.editComp.val();return FR.str2Date(c,d)==null?"":c}var b=new Date();if(this.editComp[0].realValue){b.setTime(this.editComp[0].realValue.getTime())}else{b=this.editComp.val()
}if(!b){return""}var a=(b instanceof Date)?b:FR.str2Date(b,d);return(a==null)?"":a},isValidateInput:function(j){var h=this.options.format;var e=this.std;var f=this.edd;var i=this;var a=true;var b=this.options.customFormat;var c=j?j:this.editComp.val();if(this.options.allowBlank!==false&&FR.isEmpty(c)){return}var d=FR.matchDateFormat(c,h);if(!b&&!d){a=false;var g=function(){var n=i.editComp.val();if(c==n){var l=i.getDefaultSupportFormat();for(var m=0;m<l.length;m++){var k=FR.matchDateFormat(c,l[m]);
if(k){d=k;a=true;i.editComp.val(FR.date2Str(d,h));this.isValidateInput();break}}}};g.defer(1000,this)}if(!b&&!a){if(!FR.matchDateFormat(c,h)){this._applyInvalidCss(FR.i18nText("FR-Engine_Please_input_with_right_format")+":"+h)}}else{if(e&&!FR.isInvalidDate(new Date(e))&&d<new Date(e)){this._applyInvalidCss(FR.i18nText("Err-The_number_is_less_than_the_minimum_value")+FR.date2Str(e,"yyyy-MM-dd"))}else{if(f&&!FR.isInvalidDate(new Date(f))&&d>new Date(f)){this._applyInvalidCss(FR.i18nText("Err-The_number_is_larger_than_the_maximum_value")+FR.date2Str(f,"yyyy-MM-dd"))
}else{if(d>new Date(2999,11,31)||d<new Date(1900,0,1)){this._applyInvalidCss("out of range")}else{this.validateCss()}}}}},reset:function(){FR.DateTimeEditor.superclass.reset.apply(this,arguments);this.editComp[0].realValue=null;this.options.currentDateTime=null;this.options.need2BuildConfig=true;if(this.options.data){delete this.options.data.records}}});$.shortcut("datetime",FR.DateTimeEditor);
(function(a){FR.CheckBoxGroup=FR.extend(FR.ToggleButtonGroup,{lbox_class:"fr-group-box",sbox_class:"fr-group-span",_defaultConfig:function(){return a.extend(FR.CheckBoxGroup.superclass._defaultConfig.apply(),{delimiter:",",startSymbol:"",endSymbol:"",adaptive:false})},_init:function(){FR.CheckBoxGroup.superclass._init.apply(this,arguments)},changeAllState:function(d){if(this.buttonArray){for(var c=0,b=this.buttonArray.length-1;c<b;c++){this.buttonArray[c].setSelectedWithoutEvent(d)}this.buttonArray[this.buttonArray.length-1].setSelected(d)
}},_setItems:function(d){var c=d||[];var b=this;if(b.buttonArray){b.buttonArray.clear()}a.each(c,function(f,g){if(b.options.adaptive){var e=a("<span></span>").addClass(b.sbox_class).appendTo(b.$container)}else{var e=a("<span/>").addClass(b.sbox_class);var h={column:f%b.gridConfig.columns,row:Math.floor(f/b.gridConfig.columns),el:e};b.gridConfig.items.push(h)}b.buttonArray[f]=b.initItemBox(f,g,e);b.buttonArray[f].on(FR.Events.BEFORESTATECHANGE,function(){b.fireEvent(FR.Events.BEFORESTATECHANGE)});
b.buttonArray[f].on(FR.Events.STATECHANGE,function(){b.fireEvent(FR.Events.STATECHANGE,f,this.selected());b._checkInnerBoxState();b.fireEvent(FR.Events.AFTEREDIT)})});this._checkChooseAll()},initItemBox:function(c,d,b){return new FR.CheckBox({renderEl:a("<div/>").appendTo(b),disabled:this.options.disabled,text:d.getShowValue(),fieldValue:d.getValue(),sessionID:this.options.sessionID,widgetName:this.options.widgetName,fontSize:this.options.fontSize})},initInnerBox:function(b){return new FR.CheckBox({renderEl:b,disabled:this.options.disabled,text:FR.i18nText("FR-Engine_Choose_All"),fontSize:this.options.fontSize})
},getSelectedItems:function(){return a(".fr-checkbox-checkon",this.$container)},doResize:function(b){FR.ToggleButtonGroup.superclass.doResize.call(this,b);this._checkTable()},_checkChooseAll:function(){if(!this.options.adaptive){this.grid=new FR.GridLayout(this.gridConfig);this.grid.element.doLayout();this._checkTable()}if(this.options.chooseAll){var d;var b=this;if(this.options.adaptive){var c=this.options.form?this.element:this.element.parent();this.options.form||this.element.height(parseInt(c.height())-19);
d=a("<span/>").addClass(this.sbox_class).appendTo(c)}else{d=a("<span/>").addClass(this.sbox_class);var e=this.buttonArray.length;var f={column:e%this.gridConfig.columns,row:Math.floor(e/this.gridConfig.columns),el:d};this.gridConfig.items.push(f)}this.innerCheckBox=b.initInnerBox(d);this.innerCheckBox.on(FR.Events.STATECHANGE,function(){b.changeAllState(b.innerCheckBox.isSelected())})}if(!this.options.adaptive){this.grid=new FR.GridLayout(this.gridConfig);this.grid.element.doLayout();this._checkTable()
}},_checkInnerBoxState:function(){if(this.options.chooseAll){var d=this.getSelectedItems();var b=d.length;if(this.options.form){var c=this.innerCheckBox.isSelected()?1:0;b=d.length-c}if(b===this.buttonArray.length){this.innerCheckBox.setSelectedWithoutEvent(true)}else{this.innerCheckBox.setSelectedWithoutEvent(false)}}},getValue:function(){return this.getTV(false)},getText:function(){return this.getTV(true)},getTV:function(c){var b=this;var e=[];var f=this.options.noSelected;a.each(b.buttonArray,function(g,i){if(f){if(i.selected()){var h=b.options.data.getRecord(g);
e[g]=c?h.getShowValue():h.getValue()}else{e[g]=f}}else{if(i.selected()){var j=b.options.data.getRecord(g);e[e.length]=c?j.getShowValue():j.getValue()}}});if(this.options.returnArray){return e}var d=this.options.startSymbol+e.join(this.options.delimiter)+this.options.endSymbol;return d},_dealValueWithEvents:function(f){var b=this;var e=arguments[1];var c=function(){if(b.isBoxBuild!==true){return}clearInterval(d);var g=b.getValue();if(typeof f==="string"){var j=f.split(b.options.delimiter)}else{var j=a.makeArray(f)
}if(!b.options.returnArray){f=f+"";j=f.substring(b.options.startSymbol.length,f.length-b.options.endSymbol.length).split(b.options.delimiter)}for(var h=0;h<b.buttonArray.length;h++){b.buttonArray[h].setSelectedWithoutEvent(false)}a.each(j,function(l,m){for(var n=0,k=b.buttonArray.length;n<k;n++){if(b.buttonArray[n].options.fieldValue==m||b.buttonArray[n].options.text==m){b.buttonArray[n].setSelectedWithoutEvent(true);break}}});b._checkInnerBoxState();if(e!==false){b.fireEvent(FR.Events.CHANGE,f,g)
}};if(this.isBoxBuild===true){c();return}var d=setInterval(c,100)}});a.shortcut("checkboxgroup",FR.CheckBoxGroup)})(jQuery);
(function(a){FR.RadioGroup=FR.extend(FR.ToggleButtonGroup,{lbox_class:"fr-group-box",sbox_class:"fr-group-span",_init:function(){FR.RadioGroup.superclass._init.apply(this,arguments)},initData:function(){if(this.options.data){return}if(this.options.controlAttr){this.setSource(this.options.controlAttr);this._confirmEvents=function(){this.fireEvent(FR.Events.AFTERINIT)};return}if(this.options.widgetUrl){this.options.data=FR.DataFactory.createSynchronJSONData(this.options.widgetUrl,false);this.options.data.resetStatus(this.createDependencePara4Data())
}else{if(this.options.items){this.options.data=FR.DataFactory.createSynchronArrayData(this.options.items)}}var b=this;this.options.data.afterRead(function(c){if(b.isBoxBuild!==true){b._buildBox(c)}});this.options.data.loadData()},_setItems:function(e){var f=this.options.textalign?this.options.textalign:"left";var d=e||[],b=d.length;var g;if(this.options.widgetName){g=this.options.widgetName}else{g="noNameChild"}var c=this;a.each(d,function(i,j){if(c.options.adaptive){var h=a("<span></span>").addClass(c.sbox_class).css("text-align",f).appendTo(c.$container)
}else{var h=a("<span/>").addClass(c.sbox_class).css("text-align",f);var k={column:i%c.gridConfig.columns,row:Math.floor(i/c.gridConfig.columns),el:h};c.gridConfig.items.push(k)}c.buttonArray[i]=c.initItemRadio(i,j,h,g);c.buttonArray[i].on(FR.Events.BEFORESTATECHANGE,function(){c.fireEvent(FR.Events.BEFORESTATECHANGE)});c.buttonArray[i].on(FR.Events.STATECHANGE,function(){c.assureOneButtonChecked(this);if(this.selected()===true||c.getValue()==""){c.fireEvent(FR.Events.STATECHANGE,i);c.fireEvent(FR.Events.AFTEREDIT)
}else{c.oriValue=c.getValue()}})});if(!c.options.adaptive){this.grid=new FR.GridLayout(this.gridConfig);this.grid.element.doLayout();this._checkTable()}},initItemRadio:function(c,e,b,d){return new FR.RadioButton({renderEl:a("<div/>").appendTo(b),disabled:this.options.disabled,text:e.getShowValue(),fieldValue:e.getValue(),sessionID:this.options.sessionID,name:d,fontSize:this.options.fontSize})},assureOneButtonChecked:function(c){var e=false;if(c.isSelected()){for(var d=0,b=this.buttonArray.length;
d<b;d++){if(this.buttonArray[d]==c){e=true;continue}this.buttonArray[d].setSelectedWithoutEvent(false)}}if(!e&&this.options.assureSelect===true){c.setSelectedWithoutEvent(true)}},getValue:function(){return this.getTV(false)},getText:function(){return this.getTV(true)},getTV:function(c){var b=this;var d="";a.each(b.buttonArray,function(e,g){if(g.selected()){var f=b.options.data.getRecord(e);if(f){d=c?f.getShowValue():f.getValue()}}});return d},_dealValueWithEvents:function(f){var b=this;var e=arguments[1];
var c=function(){if(b.isBoxBuild!==true){return}clearInterval(d);var h=b.options.value;if(typeof f=="boolean"){f=f?"true":"false"}if(!f&&f!==0){return}for(var j=0;j<b.buttonArray.length;j++){b.buttonArray[j].setSelectedWithoutEvent(false)}for(var j=0,g=b.buttonArray.length;j<g;j++){if(b.buttonArray[j].options.fieldValue==f){if(e!==false){b.buttonArray[j].setSelected(true)}else{b.buttonArray[j].setSelectedWithoutEvent(true)}break}}};if(this.isBoxBuild===true){c();return}var d=setInterval(c,100)},isValidate:function(b){var c=FR.RadioGroup.superclass.isValidate.apply(this,arguments);
if(c===false){if(this.oriValue){this._dealValueWithEvents(this.oriValue)}}return c}});a.shortcut("radiogroup",FR.RadioGroup)})(jQuery);
(function(g){var d=FR.BaseEditor.PluginRegex;d.push({text:"idcardRegex",regex:function(i){return f(i)}});var c=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1];var a=[1,0,10,9,8,7,6,5,4,3,2];function f(i){i=i+"";if(i.length===15){return e(i)}else{if(i.length===18){var j=i.split("");if(b(i)&&h(j)){return true}else{return false}}else{return false}}}function h(j){var l=0;if(j[17].toLowerCase()=="x"){j[17]=10}for(var k=0;k<17;k++){l+=c[k]*j[k]}valCodePosition=l%11;if(j[17]==a[valCodePosition]){return true}else{return false
}}function b(j){var l=j.substring(6,10);var m=j.substring(10,12);var i=j.substring(12,14);var k=new Date(l,parseFloat(m)-1,parseFloat(i));if(k.getFullYear()!=parseFloat(l)||k.getMonth()!=parseFloat(m)-1||k.getDate()!=parseFloat(i)){return false}else{return true}}function e(l){var k=l.substring(6,8);var m=l.substring(8,10);var i=l.substring(10,12);var j=new Date(k,parseFloat(m)-1,parseFloat(i));if(j.getYear()!=parseFloat(k)||j.getMonth()!=parseFloat(m)-1||j.getDate()!=parseFloat(i)){return false}else{return true
}}})(jQuery);
;(function($){
    // FR.TreeNodeToggleButton start
    FR.TreeNodeToggleButton = FR.extend(FR.ToggleButton, {
        selected_class: 'x-treenode-expand',
        unselected_class: 'x-treenode-unexpand',
        son_array: undefined,
        expand_state: false,

        _init: function () {
            FR.TreeNodeToggleButton.superclass._init.apply(this, arguments);
            // b:ie paint special to change
            if (FR.Browser.isIE()) {
                this.$btn.css('background-position', '-1px -2px');
            }
        },

        _node_init: function () {
            var o = this.options = $.extend({
                expand: false
            }, this.options);

            if (o.sonarray && o.sonarray.length > 1) {
                if (o.sonarray[0] == -1) {
                    this.expand_mode = 0;
                } else {
                    this.expand_mode = 1;
                }

                var contentPane = _g();
                var cp = contentPane.curLGP;

                if (!contentPane.TREEMGR) {
                    contentPane.TREEMGR = [];
                    // 
                    contentPane.on(FR.Events.STARTLOAD, function (pane) {
                        if (contentPane.TREEMGR && pane) {
                            contentPane.TREEMGR[pane.idx] = null;
                        }
                    });
                }

                if (!contentPane.TREEMGR[o.reportIndex]) {
                    contentPane.TREEMGR[o.reportIndex] = {};
                    contentPane.TREEMGR[o.reportIndex].nodes = [];
                    contentPane.TREEMGR[o.reportIndex].location_nodes = {};
                }

                // view
                if (!this.options.parNode) {
                    for (var i = 0; i < contentPane.TREEMGR[o.reportIndex].nodes.length; i++) {
                        var treenode = contentPane.TREEMGR[o.reportIndex].nodes[i];
                        if (this.initNodeLayer(treenode)) {
                            break;
                        }
                    }

                    if (!this.parentNode) {
                        contentPane.TREEMGR[o.reportIndex].nodes[contentPane.TREEMGR[o.reportIndex].nodes.length] = this;
                    }
                } else {
                    if (this.options.parNode != 'null') {
                        this.parent = contentPane.TREEMGR[o.reportIndex].location_nodes[this.options.parNode];
                        if (this.parent) {
                            if (this.parent.sonNodes) {
                                this.parent.sonNodes[this.parent.sonNodes.length] = this;
                            } else {
                                this.parent.sonNodes = [];
                                this.parent.sonNodes[0] = this;
                            }
                        }
                    }

                    contentPane.TREEMGR[o.reportIndex].location_nodes[this.options.location] = this;
                }

                this.mgr = contentPane.TREEMGR[this.options.reportIndex];
                if (!this.mgr.row_expand_state) {
                    this.mgr.row_expand_state = [];
                    this.mgr.col_expand_state = [];

                    for (var i = 1; i < this.options.sonarray.length; i++) {
                        if (this.expand_mode === 0) {
                            this.mgr.row_expand_state[this.options.sonarray[i]] = 0;
                        } else if (this.expand_mode === 1) {
                            this.mgr.col_expand_state[this.options.sonarray[i]] = 0;
                        }
                    }
                }

                this.cells = [];
            } else {
                this.expand_mode = -1; // -1 0 1
            }

        },

        initNodeLayer: function (treenode) {
            if (treenode.expand_mode == this.expand_mode) {
                var matchValue = this.options.sonarray[1];
                // 
                for (var s = 1; s < treenode.options.sonarray.length; s++) {
                    if (matchValue == treenode.options.sonarray[s]) {
                        if (treenode.sonNodes) {
                            for (var n = 0; n < treenode.sonNodes.length; n++) {
                                if (this.initNodeLayer(treenode.sonNodes[n])) {
                                    return true;
                                }
                            }

                            treenode.sonNodes[treenode.sonNodes.length] = this;
                            this.parentNode = treenode;
                        } else {
                            treenode.sonNodes = [];
                            treenode.sonNodes[0] = this;
                            this.parentNode = treenode;
                        }

                        return true;
                    } else if (matchValue < treenode.options.sonarray[s]) {
                        return false;
                    }
                }
            }

            return false;
        },

        onNodeClick: function () {
            this.treeNodeClick();
        },
        // 
        treeNodeClick: function () {
            if (!this.options.sonarray) {
                // nothing
            } else {
                this.TreeNodeAction(!this.expand_state);
            }

            this.fireEvent(FR.Events.CLICK);
            // 
            _g().fireEvent("refresh");
        },

        /**
         * ie9 bug:55354,ie9
         */
        hideTr: function(element) {
            if (FR.Browser.isIE9()) {
                var table = null;
                var obj = $(element);
                for (; !obj.is('BODY'); obj = obj.parent()) {
                    if (obj.is('TABLE')) {
                        table = obj;
                        break;
                    }
                }
                if (table == null) {
                    return;
                }
                var initValue = table.css("border-collapse");
                table.css("border-collapse", "separate");
                $(element).css("display", this.expand_state ? "none" : "");
                table.css("border-collapse", initValue);
            } else {
                $(element).css("display", this.expand_state ? "none" : "");
            }
        },

        // 
        dealwithSelfSonArray: function () {
            if (this.options.needInit === false) {
                this.result_son_array = this.options.sonarray;
            } else if (this.sonNodes) {
                for (var i = 0; i < this.sonNodes.length; i++) {
                    var n = 1;
                    for (var j = 1; j < this.sonNodes[i].options.sonarray.length
                    && n < this.options.sonarray.length; j++) {
                        if (this.options.sonarray[n] == -1
                            || this.sonNodes[i].options.sonarray[j] > this.options.sonarray[n]) {
                            j--;
                            n++;
                            continue;
                        } else if (this.sonNodes[i].options.sonarray[j] == this.options.sonarray[n]) {
                            this.options.sonarray[n] = -1;
                            n++;
                            continue;
                        }
                    }
                }

                this.result_son_array = [];
                this.result_son_array[0] = this.options.sonarray[0];
                for (var i = 1; i < this.options.sonarray.length; i++) {
                    if (this.options.sonarray[i] >= 0) {
                        this.result_son_array[this.result_son_array.length] = this.options.sonarray[i];
                    }
                }
            } else {
                this.result_son_array = this.options.sonarray;
            }

            // 
            if (this.expand_mode === 0) {
                var tr;
                for (var i = this.result_son_array.length - 1; i > 0; i--) {
                    tr = this.mgr.tr_array[this.result_son_array[i]];
                    if (!tr.hasClass('tntr')) {
                        this.result_son_array.splice(i, 1); // 
                    }
                }
            }
        },

        // 
        TreeNodeAction: function (expand) {
            if (expand == this.expand_state) {
                return;
            }
            var self = this;
            if (!this.mgr) {
                this.mgr = _g().TREEMGR[this.options.reportIndex];
            }
            if (!this.mgr.tr_array) {
                var contentPane = _g().curLGP;
                this.mgr.tr_array = [];
                var tr;
                var $center = $('.frozen-center', contentPane.$container);
                var $west = $('.frozen-west', contentPane.$container);
                var $north = $('.frozen-north', contentPane.$container);
                var targetDomElement = $center;
                // west
                if ($west.length > 0 && $west[0].contains(this.$btn[0])) {
                    targetDomElement = $west;
                } else if ($north.length > 0 && $north[0].contains(this.$btn[0])) {
                    targetDomElement = $north;
                }
                // 655$containertbody,frozen-center
                var $table = $("table:eq(0)", targetDomElement.length > 0
                    ? targetDomElement
                    : contentPane.$container);
                $.each(($table.children("tbody")).children("tr[tridx]"), function (idx, item) {
                    tr = $(item);
                    self.mgr.tr_array[parseInt(tr.attr("tridx"))] = tr;
                });
            }
            if (!this.result_son_array) {
                this.dealwithSelfSonArray();
            }
            this.selected(expand);

            // 
            if (this.expand_mode === 0) {
                var tr;
                for (var i = 1; i < this.result_son_array.length; i++) {
                    tr = this.mgr.tr_array[this.result_son_array[i]];
                    if (tr) {
                        this.hideTr(tr);
                        // ie tr td
                        if (FR.Browser.isIE()) {
                            if (!this.cells[this.result_son_array[i]]) {
                                this.cells[this.result_son_array[i]] = [];
                                var td;
                                $.each(tr.children("td[tdcol]"), function (index, item) {
                                    td = $(item);
                                    self.cells[self.result_son_array[i]][parseInt(td.attr("tdcol"))] = td;
                                });
                            }

                            $.each(this.cells[this.result_son_array[i]], function (index, td) {
                                if (!td || (!self.expand_state && (self.mgr.col_expand_state[index] === 0
                                    || (self.mgr.col_expand_state[index] == null && td.attr("realhd") != null)))) {
                                    return;
                                }
                                td.css("display", self.expand_state ? "none" : "");
                            });
                        }

                        this.mgr.row_expand_state[this.result_son_array[i]] = this.expand_state
                            ? 0
                            : 1;
                    }
                }
                // 
            } else if (this.expand_mode === 1) {
                var rowcount = this.result_son_array[0];
                var td;
                var col;
                if (!this.mgr.td_table) {
                    this.mgr.td_table = [];
                    $.each(self.mgr.tr_array, function (idx, tr) {
                        if (tr) {
                            $.each(tr.children("td[tdcol]"), function (iidx, td) {
                                td = $(td);
                                col = parseInt(td.attr("tdcol"));
                                if (!self.mgr.td_table[col]) {
                                    self.mgr.td_table[col] = [];
                                }
                                self.mgr.td_table[col][idx] = td;
                            });
                        }
                    });
                }

                var td_array;
                for (var i = 1; i < self.result_son_array.length; i++) {
                    td_array = self.mgr.td_table[self.result_son_array[i]];
                    if (td_array) {
                        $.each(td_array, function (idx, td) {
                            if (td) {
                                if (!self.expand_state && self.mgr.row_expand_state[idx] === 0) {
                                    if(FR.Browser.isIE()){
                                        return;
                                    }
                                }
                                td.css("display", self.expand_state ? "none" : "");
                            }
                        });
                    }
                }

                for (var i = 1; i < this.result_son_array.length; i++) {
                    this.mgr.col_expand_state[this.result_son_array[i]] = this.expand_state
                        ? 0
                        : 1;
                }
            }

            if (this.sonNodes) {
                if (this.expand_state) {
                    this.last_son_state = [];
                    for (var i = 0; i < this.sonNodes.length; i++) {
                        this.last_son_state[i] = this.sonNodes[i].selected();
                        this.sonNodes[i].TreeNodeAction(false);
                    }
                } else if (this.last_son_state) {
                    for (var i = 0; i < this.sonNodes.length; i++) {
                        this.sonNodes[i].TreeNodeAction(this.last_son_state[i]);
                    }
                }
            }

            this.expand_state = !this.expand_state;
        }
    });
    $.shortcut("treenode", FR.TreeNodeToggleButton)
})(jQuery);
(function(a){FR.PagePane=FR.extend(FR.BasePane,{rtype:"page",doAfterCollapse:function(){var b=a(".frozen-page",contentPane.$contentPane);if(b&&b.length>0){FR.layoutFrozen(b,contentPane.$contentPane.offset().top)}}});FR.PagePane.exetendPara={};a.shortcut("page",FR.PagePane);FR.PreviewPane=FR.extend(FR.BasePane,{rtype:"preview"});a.shortcut("preview",FR.PreviewPane);FR.SimpleSheetPane=FR.extend(FR.BasePane,{rtype:"simplesheet",loadReportPane:function(b){}});a.shortcut("simplesheet",FR.SimpleSheetPane)
})(jQuery);
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2015 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.9/LICENSE
 */

(function (root, factory) {
    'use strict';

    /* global define, exports, module */
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(factory);
    } else if (typeof exports === 'object') {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like enviroments that support module.exports,
        // like Node.
        module.exports = factory();
    } else {
        // Browser globals (root is window)
        root.returnExports = factory();
    }
}(this, function () {
    /**
     * Brings an environment as close to ECMAScript 5 compliance
     * as is possible with the facilities of erstwhile engines.
     *
     * Annotated ES5: http://es5.github.com/ (specific links below)
     * ES5 Spec: http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf
     * Required reading: http://javascriptweblog.wordpress.com/2011/12/05/extending-javascript-natives/
     */

        // Shortcut to an often accessed properties, in order to avoid multiple
        // dereference that costs universally. This also holds a reference to known-good
        // functions.
    var $Array = Array;
    var ArrayPrototype = $Array.prototype;
    var $Object = Object;
    var ObjectPrototype = $Object.prototype;
    var $Function = Function;
    var FunctionPrototype = $Function.prototype;
    var $String = String;
    var StringPrototype = $String.prototype;
    var $Number = Number;
    var NumberPrototype = $Number.prototype;
    var array_slice = ArrayPrototype.slice;
    var array_splice = ArrayPrototype.splice;
    var array_push = ArrayPrototype.push;
    var array_unshift = ArrayPrototype.unshift;
    var array_concat = ArrayPrototype.concat;
    var array_join = ArrayPrototype.join;
    var call = FunctionPrototype.call;
    var apply = FunctionPrototype.apply;
    var max = Math.max;
    var min = Math.min;

    // Having a toString local variable name breaks in Opera so use to_string.
    var to_string = ObjectPrototype.toString;

    /* global Symbol */
    /* eslint-disable one-var-declaration-per-line, no-redeclare, max-statements-per-line */
    var hasToStringTag = typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol';
    var isCallable; /* inlined from https://npmjs.com/is-callable */ var fnToStr = Function.prototype.toString, constructorRegex = /^\s*class /, isES6ClassFn = function isES6ClassFn(value) { try { var fnStr = fnToStr.call(value); var singleStripped = fnStr.replace(/\/\/.*\n/g, ''); var multiStripped = singleStripped.replace(/\/\*[.\s\S]*\*\//g, ''); var spaceStripped = multiStripped.replace(/\n/mg, ' ').replace(/ {2}/g, ' '); return constructorRegex.test(spaceStripped); } catch (e) { return false; /* not a function */ } }, tryFunctionObject = function tryFunctionObject(value) { try { if (isES6ClassFn(value)) { return false; } fnToStr.call(value); return true; } catch (e) { return false; } }, fnClass = '[object Function]', genClass = '[object GeneratorFunction]', isCallable = function isCallable(value) { if (!value) { return false; } if (typeof value !== 'function' && typeof value !== 'object') { return false; } if (hasToStringTag) { return tryFunctionObject(value); } if (isES6ClassFn(value)) { return false; } var strClass = to_string.call(value); return strClass === fnClass || strClass === genClass; };

    var isRegex; /* inlined from https://npmjs.com/is-regex */ var regexExec = RegExp.prototype.exec, tryRegexExec = function tryRegexExec(value) { try { regexExec.call(value); return true; } catch (e) { return false; } }, regexClass = '[object RegExp]'; isRegex = function isRegex(value) { if (typeof value !== 'object') { return false; } return hasToStringTag ? tryRegexExec(value) : to_string.call(value) === regexClass; };
    var isString; /* inlined from https://npmjs.com/is-string */ var strValue = String.prototype.valueOf, tryStringObject = function tryStringObject(value) { try { strValue.call(value); return true; } catch (e) { return false; } }, stringClass = '[object String]'; isString = function isString(value) { if (typeof value === 'string') { return true; } if (typeof value !== 'object') { return false; } return hasToStringTag ? tryStringObject(value) : to_string.call(value) === stringClass; };
    /* eslint-enable one-var-declaration-per-line, no-redeclare, max-statements-per-line */

    /* inlined from http://npmjs.com/define-properties */
    var supportsDescriptors = $Object.defineProperty && (function () {
            try {
                var obj = {};
                $Object.defineProperty(obj, 'x', { enumerable: false, value: obj });
                for (var _ in obj) { // jscs:ignore disallowUnusedVariables
                    return false;
                }
                return obj.x === obj;
            } catch (e) { /* this is ES3 */
                return false;
            }
        }());
    var defineProperties = (function (has) {
        // Define configurable, writable, and non-enumerable props
        // if they don't exist.
        var defineProperty;
        if (supportsDescriptors) {
            defineProperty = function (object, name, method, forceAssign) {
                if (!forceAssign && (name in object)) {
                    return;
                }
                $Object.defineProperty(object, name, {
                    configurable: true,
                    enumerable: false,
                    writable: true,
                    value: method
                });
            };
        } else {
            defineProperty = function (object, name, method, forceAssign) {
                if (!forceAssign && (name in object)) {
                    return;
                }
                object[name] = method;
            };
        }
        return function defineProperties(object, map, forceAssign) {
            for (var name in map) {
                if (has.call(map, name)) {
                    defineProperty(object, name, map[name], forceAssign);
                }
            }
        };
    }(ObjectPrototype.hasOwnProperty));

    //
    // Util
    // ======
    //

    /* replaceable with https://npmjs.com/package/es-abstract /helpers/isPrimitive */
    var isPrimitive = function isPrimitive(input) {
        var type = typeof input;
        return input === null || (type !== 'object' && type !== 'function');
    };

    var isActualNaN = $Number.isNaN || function isActualNaN(x) {
            return x !== x;
        };

    var ES = {
        // ES5 9.4
        // http://es5.github.com/#x9.4
        // http://jsperf.com/to-integer
        /* replaceable with https://npmjs.com/package/es-abstract ES5.ToInteger */
        ToInteger: function ToInteger(num) {
            var n = +num;
            if (isActualNaN(n)) {
                n = 0;
            } else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0)) {
                n = (n > 0 || -1) * Math.floor(Math.abs(n));
            }
            return n;
        },

        /* replaceable with https://npmjs.com/package/es-abstract ES5.ToPrimitive */
        ToPrimitive: function ToPrimitive(input) {
            var val, valueOf, toStr;
            if (isPrimitive(input)) {
                return input;
            }
            valueOf = input.valueOf;
            if (isCallable(valueOf)) {
                val = valueOf.call(input);
                if (isPrimitive(val)) {
                    return val;
                }
            }
            toStr = input.toString;
            if (isCallable(toStr)) {
                val = toStr.call(input);
                if (isPrimitive(val)) {
                    return val;
                }
            }
            throw new TypeError();
        },

        // ES5 9.9
        // http://es5.github.com/#x9.9
        /* replaceable with https://npmjs.com/package/es-abstract ES5.ToObject */
        ToObject: function (o) {
            if (o == null) { // this matches both null and undefined
                throw new TypeError("can't convert " + o + ' to object');
            }
            return $Object(o);
        },

        /* replaceable with https://npmjs.com/package/es-abstract ES5.ToUint32 */
        ToUint32: function ToUint32(x) {
            return x >>> 0;
        }
    };

    //
    // Function
    // ========
    //

    // ES-5 15.3.4.5
    // http://es5.github.com/#x15.3.4.5

    var Empty = function Empty() {};

    defineProperties(FunctionPrototype, {
        bind: function bind(that) { // .length is 1
            // 1. Let Target be the this value.
            var target = this;
            // 2. If IsCallable(Target) is false, throw a TypeError exception.
            if (!isCallable(target)) {
                throw new TypeError('Function.prototype.bind called on incompatible ' + target);
            }
            // 3. Let A be a new (possibly empty) internal list of all of the
            //   argument values provided after thisArg (arg1, arg2 etc), in order.
            // XXX slicedArgs will stand in for "A" if used
            var args = array_slice.call(arguments, 1); // for normal call
            // 4. Let F be a new native ECMAScript object.
            // 11. Set the [[Prototype]] internal property of F to the standard
            //   built-in Function prototype object as specified in 15.3.3.1.
            // 12. Set the [[Call]] internal property of F as described in
            //   15.3.4.5.1.
            // 13. Set the [[Construct]] internal property of F as described in
            //   15.3.4.5.2.
            // 14. Set the [[HasInstance]] internal property of F as described in
            //   15.3.4.5.3.
            var bound;
            var binder = function () {

                if (this instanceof bound) {
                    // 15.3.4.5.2 [[Construct]]
                    // When the [[Construct]] internal method of a function object,
                    // F that was created using the bind function is called with a
                    // list of arguments ExtraArgs, the following steps are taken:
                    // 1. Let target be the value of F's [[TargetFunction]]
                    //   internal property.
                    // 2. If target has no [[Construct]] internal method, a
                    //   TypeError exception is thrown.
                    // 3. Let boundArgs be the value of F's [[BoundArgs]] internal
                    //   property.
                    // 4. Let args be a new list containing the same values as the
                    //   list boundArgs in the same order followed by the same
                    //   values as the list ExtraArgs in the same order.
                    // 5. Return the result of calling the [[Construct]] internal
                    //   method of target providing args as the arguments.

                    var result = apply.call(
                        target,
                        this,
                        array_concat.call(args, array_slice.call(arguments))
                    );
                    if ($Object(result) === result) {
                        return result;
                    }
                    return this;

                } else {
                    // 15.3.4.5.1 [[Call]]
                    // When the [[Call]] internal method of a function object, F,
                    // which was created using the bind function is called with a
                    // this value and a list of arguments ExtraArgs, the following
                    // steps are taken:
                    // 1. Let boundArgs be the value of F's [[BoundArgs]] internal
                    //   property.
                    // 2. Let boundThis be the value of F's [[BoundThis]] internal
                    //   property.
                    // 3. Let target be the value of F's [[TargetFunction]] internal
                    //   property.
                    // 4. Let args be a new list containing the same values as the
                    //   list boundArgs in the same order followed by the same
                    //   values as the list ExtraArgs in the same order.
                    // 5. Return the result of calling the [[Call]] internal method
                    //   of target providing boundThis as the this value and
                    //   providing args as the arguments.

                    // equiv: target.call(this, ...boundArgs, ...args)
                    return apply.call(
                        target,
                        that,
                        array_concat.call(args, array_slice.call(arguments))
                    );

                }

            };

            // 15. If the [[Class]] internal property of Target is "Function", then
            //     a. Let L be the length property of Target minus the length of A.
            //     b. Set the length own property of F to either 0 or L, whichever is
            //       larger.
            // 16. Else set the length own property of F to 0.

            var boundLength = max(0, target.length - args.length);

            // 17. Set the attributes of the length own property of F to the values
            //   specified in 15.3.5.1.
            var boundArgs = [];
            for (var i = 0; i < boundLength; i++) {
                array_push.call(boundArgs, '$' + i);
            }

            // XXX Build a dynamic function with desired amount of arguments is the only
            // way to set the length property of a function.
            // In environments where Content Security Policies enabled (Chrome extensions,
            // for ex.) all use of eval or Function costructor throws an exception.
            // However in all of these environments Function.prototype.bind exists
            // and so this code will never be executed.
            bound = $Function('binder', 'return function (' + array_join.call(boundArgs, ',') + '){ return binder.apply(this, arguments); }')(binder);

            if (target.prototype) {
                Empty.prototype = target.prototype;
                bound.prototype = new Empty();
                // Clean up dangling references.
                Empty.prototype = null;
            }

            // TODO
            // 18. Set the [[Extensible]] internal property of F to true.

            // TODO
            // 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).
            // 20. Call the [[DefineOwnProperty]] internal method of F with
            //   arguments "caller", PropertyDescriptor {[[Get]]: thrower, [[Set]]:
            //   thrower, [[Enumerable]]: false, [[Configurable]]: false}, and
            //   false.
            // 21. Call the [[DefineOwnProperty]] internal method of F with
            //   arguments "arguments", PropertyDescriptor {[[Get]]: thrower,
            //   [[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false},
            //   and false.

            // TODO
            // NOTE Function objects created using Function.prototype.bind do not
            // have a prototype property or the [[Code]], [[FormalParameters]], and
            // [[Scope]] internal properties.
            // XXX can't delete prototype in pure-js.

            // 22. Return F.
            return bound;
        }
    });

    // _Please note: Shortcuts are defined after `Function.prototype.bind` as we
    // use it in defining shortcuts.
    var owns = call.bind(ObjectPrototype.hasOwnProperty);
    var toStr = call.bind(ObjectPrototype.toString);
    var arraySlice = call.bind(array_slice);
    var arraySliceApply = apply.bind(array_slice);
    var strSlice = call.bind(StringPrototype.slice);
    var strSplit = call.bind(StringPrototype.split);
    var strIndexOf = call.bind(StringPrototype.indexOf);
    var pushCall = call.bind(array_push);
    var isEnum = call.bind(ObjectPrototype.propertyIsEnumerable);
    var arraySort = call.bind(ArrayPrototype.sort);

    //
    // Array
    // =====
    //

    var isArray = $Array.isArray || function isArray(obj) {
            return toStr(obj) === '[object Array]';
        };

    // ES5 15.4.4.12
    // http://es5.github.com/#x15.4.4.13
    // Return len+argCount.
    // [bugfix, ielt8]
    // IE < 8 bug: [].unshift(0) === undefined but should be "1"
    var hasUnshiftReturnValueBug = [].unshift(0) !== 1;
    defineProperties(ArrayPrototype, {
        unshift: function () {
            array_unshift.apply(this, arguments);
            return this.length;
        }
    }, hasUnshiftReturnValueBug);

    // ES5 15.4.3.2
    // http://es5.github.com/#x15.4.3.2
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray
    defineProperties($Array, { isArray: isArray });

    // The IsCallable() check in the Array functions
    // has been replaced with a strict check on the
    // internal class of the object to trap cases where
    // the provided function was actually a regular
    // expression literal, which in V8 and
    // JavaScriptCore is a typeof "function".  Only in
    // V8 are regular expression literals permitted as
    // reduce parameters, so it is desirable in the
    // general case for the shim to match the more
    // strict and common behavior of rejecting regular
    // expressions.

    // ES5 15.4.4.18
    // http://es5.github.com/#x15.4.4.18
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/array/forEach

    // Check failure of by-index access of string characters (IE < 9)
    // and failure of `0 in boxedString` (Rhino)
    var boxedString = $Object('a');
    var splitString = boxedString[0] !== 'a' || !(0 in boxedString);

    var properlyBoxesContext = function properlyBoxed(method) {
        // Check node 0.6.21 bug where third parameter is not boxed
        var properlyBoxesNonStrict = true;
        var properlyBoxesStrict = true;
        var threwException = false;
        if (method) {
            try {
                method.call('foo', function (_, __, context) {
                    if (typeof context !== 'object') {
                        properlyBoxesNonStrict = false;
                    }
                });

                method.call([1], function () {
                    'use strict';

                    properlyBoxesStrict = typeof this === 'string';
                }, 'x');
            } catch (e) {
                threwException = true;
            }
        }
        return !!method && !threwException && properlyBoxesNonStrict && properlyBoxesStrict;
    };

    defineProperties(ArrayPrototype, {
        forEach: function forEach(callbackfn/*, thisArg*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var i = -1;
            var length = ES.ToUint32(self.length);
            var T;
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.forEach callback must be a function');
            }

            while (++i < length) {
                if (i in self) {
                    // Invoke the callback function with call, passing arguments:
                    // context, property value, property key, thisArg object
                    if (typeof T === 'undefined') {
                        callbackfn(self[i], i, object);
                    } else {
                        callbackfn.call(T, self[i], i, object);
                    }
                }
            }
        }
    }, !properlyBoxesContext(ArrayPrototype.forEach));

    // ES5 15.4.4.19
    // http://es5.github.com/#x15.4.4.19
    // https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/map
    defineProperties(ArrayPrototype, {
        map: function map(callbackfn/*, thisArg*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);
            var result = $Array(length);
            var T;
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.map callback must be a function');
            }

            for (var i = 0; i < length; i++) {
                if (i in self) {
                    if (typeof T === 'undefined') {
                        result[i] = callbackfn(self[i], i, object);
                    } else {
                        result[i] = callbackfn.call(T, self[i], i, object);
                    }
                }
            }
            return result;
        }
    }, !properlyBoxesContext(ArrayPrototype.map));

    // ES5 15.4.4.20
    // http://es5.github.com/#x15.4.4.20
    // https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/filter
    defineProperties(ArrayPrototype, {
        filter: function filter(callbackfn/*, thisArg*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);
            var result = [];
            var value;
            var T;
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.filter callback must be a function');
            }

            for (var i = 0; i < length; i++) {
                if (i in self) {
                    value = self[i];
                    if (typeof T === 'undefined' ? callbackfn(value, i, object) : callbackfn.call(T, value, i, object)) {
                        pushCall(result, value);
                    }
                }
            }
            return result;
        }
    }, !properlyBoxesContext(ArrayPrototype.filter));

    // ES5 15.4.4.16
    // http://es5.github.com/#x15.4.4.16
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/every
    defineProperties(ArrayPrototype, {
        every: function every(callbackfn/*, thisArg*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);
            var T;
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.every callback must be a function');
            }

            for (var i = 0; i < length; i++) {
                if (i in self && !(typeof T === 'undefined' ? callbackfn(self[i], i, object) : callbackfn.call(T, self[i], i, object))) {
                    return false;
                }
            }
            return true;
        }
    }, !properlyBoxesContext(ArrayPrototype.every));

    // ES5 15.4.4.17
    // http://es5.github.com/#x15.4.4.17
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some
    defineProperties(ArrayPrototype, {
        some: function some(callbackfn/*, thisArg */) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);
            var T;
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.some callback must be a function');
            }

            for (var i = 0; i < length; i++) {
                if (i in self && (typeof T === 'undefined' ? callbackfn(self[i], i, object) : callbackfn.call(T, self[i], i, object))) {
                    return true;
                }
            }
            return false;
        }
    }, !properlyBoxesContext(ArrayPrototype.some));

    // ES5 15.4.4.21
    // http://es5.github.com/#x15.4.4.21
    // https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/reduce
    var reduceCoercesToObject = false;
    if (ArrayPrototype.reduce) {
        reduceCoercesToObject = typeof ArrayPrototype.reduce.call('es5', function (_, __, ___, list) {
                return list;
            }) === 'object';
    }
    defineProperties(ArrayPrototype, {
        reduce: function reduce(callbackfn/*, initialValue*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.reduce callback must be a function');
            }

            // no value to return if no initial value and an empty array
            if (length === 0 && arguments.length === 1) {
                throw new TypeError('reduce of empty array with no initial value');
            }

            var i = 0;
            var result;
            if (arguments.length >= 2) {
                result = arguments[1];
            } else {
                do {
                    if (i in self) {
                        result = self[i++];
                        break;
                    }

                    // if array contains no values, no initial value to return
                    if (++i >= length) {
                        throw new TypeError('reduce of empty array with no initial value');
                    }
                } while (true);
            }

            for (; i < length; i++) {
                if (i in self) {
                    result = callbackfn(result, self[i], i, object);
                }
            }

            return result;
        }
    }, !reduceCoercesToObject);

    // ES5 15.4.4.22
    // http://es5.github.com/#x15.4.4.22
    // https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/reduceRight
    var reduceRightCoercesToObject = false;
    if (ArrayPrototype.reduceRight) {
        reduceRightCoercesToObject = typeof ArrayPrototype.reduceRight.call('es5', function (_, __, ___, list) {
                return list;
            }) === 'object';
    }
    defineProperties(ArrayPrototype, {
        reduceRight: function reduceRight(callbackfn/*, initial*/) {
            var object = ES.ToObject(this);
            var self = splitString && isString(this) ? strSplit(this, '') : object;
            var length = ES.ToUint32(self.length);

            // If no callback function or if callback is not a callable function
            if (!isCallable(callbackfn)) {
                throw new TypeError('Array.prototype.reduceRight callback must be a function');
            }

            // no value to return if no initial value, empty array
            if (length === 0 && arguments.length === 1) {
                throw new TypeError('reduceRight of empty array with no initial value');
            }

            var result;
            var i = length - 1;
            if (arguments.length >= 2) {
                result = arguments[1];
            } else {
                do {
                    if (i in self) {
                        result = self[i--];
                        break;
                    }

                    // if array contains no values, no initial value to return
                    if (--i < 0) {
                        throw new TypeError('reduceRight of empty array with no initial value');
                    }
                } while (true);
            }

            if (i < 0) {
                return result;
            }

            do {
                if (i in self) {
                    result = callbackfn(result, self[i], i, object);
                }
            } while (i--);

            return result;
        }
    }, !reduceRightCoercesToObject);

    // ES5 15.4.4.14
    // http://es5.github.com/#x15.4.4.14
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf
    var hasFirefox2IndexOfBug = ArrayPrototype.indexOf && [0, 1].indexOf(1, 2) !== -1;
    if(!ArrayPrototype.indexOf){
        defineProperties(ArrayPrototype, {
            indexOf: function indexOf(searchElement/*, fromIndex */) {
                var self = splitString && isString(this) ? strSplit(this, '') : ES.ToObject(this);
                var length = ES.ToUint32(self.length);

                if (length === 0) {
                    return -1;
                }

                var i = 0;
                if (arguments.length > 1) {
                    i = ES.ToInteger(arguments[1]);
                }

                // handle negative indices
                i = i >= 0 ? i : max(0, length + i);
                for (; i < length; i++) {
                    if (i in self && self[i] === searchElement) {
                        return i;
                    }
                }
                return -1;
            }
        }, hasFirefox2IndexOfBug);
    }

    // ES5 15.4.4.15
    // http://es5.github.com/#x15.4.4.15
    // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/lastIndexOf
    var hasFirefox2LastIndexOfBug = ArrayPrototype.lastIndexOf && [0, 1].lastIndexOf(0, -3) !== -1;
    if(!ArrayPrototype.lastIndexOf){
        defineProperties(ArrayPrototype, {
            lastIndexOf: function lastIndexOf(searchElement/*, fromIndex */) {
                var self = splitString && isString(this) ? strSplit(this, '') : ES.ToObject(this);
                var length = ES.ToUint32(self.length);

                if (length === 0) {
                    return -1;
                }
                var i = length - 1;
                if (arguments.length > 1) {
                    i = min(i, ES.ToInteger(arguments[1]));
                }
                // handle negative indices
                i = i >= 0 ? i : length - Math.abs(i);
                for (; i >= 0; i--) {
                    if (i in self && searchElement === self[i]) {
                        return i;
                    }
                }
                return -1;
            }
        }, hasFirefox2LastIndexOfBug);
    }

    // ES5 15.4.4.12
    // http://es5.github.com/#x15.4.4.12
    var spliceNoopReturnsEmptyArray = (function () {
        var a = [1, 2];
        var result = a.splice();
        return a.length === 2 && isArray(result) && result.length === 0;
    }());
    defineProperties(ArrayPrototype, {
        // Safari 5.0 bug where .splice() returns undefined
        splice: function splice(start, deleteCount) {
            if (arguments.length === 0) {
                return [];
            } else {
                return array_splice.apply(this, arguments);
            }
        }
    }, !spliceNoopReturnsEmptyArray);

    var spliceWorksWithEmptyObject = (function () {
        var obj = {};
        ArrayPrototype.splice.call(obj, 0, 0, 1);
        return obj.length === 1;
    }());
    defineProperties(ArrayPrototype, {
        splice: function splice(start, deleteCount) {
            if (arguments.length === 0) {
                return [];
            }
            var args = arguments;
            this.length = max(ES.ToInteger(this.length), 0);
            if (arguments.length > 0 && typeof deleteCount !== 'number') {
                args = arraySlice(arguments);
                if (args.length < 2) {
                    pushCall(args, this.length - start);
                } else {
                    args[1] = ES.ToInteger(deleteCount);
                }
            }
            return array_splice.apply(this, args);
        }
    }, !spliceWorksWithEmptyObject);
    var spliceWorksWithLargeSparseArrays = (function () {
        // Per https://github.com/es-shims/es5-shim/issues/295
        // Safari 7/8 breaks with sparse arrays of size 1e5 or greater
        var arr = new $Array(1e5);
        // note: the index MUST be 8 or larger or the test will false pass
        arr[8] = 'x';
        arr.splice(1, 1);
        // note: this test must be defined *after* the indexOf shim
        // per https://github.com/es-shims/es5-shim/issues/313
        return arr.indexOf('x') === 7;
    }());
    var spliceWorksWithSmallSparseArrays = (function () {
        // Per https://github.com/es-shims/es5-shim/issues/295
        // Opera 12.15 breaks on this, no idea why.
        var n = 256;
        var arr = [];
        arr[n] = 'a';
        arr.splice(n + 1, 0, 'b');
        return arr[n] === 'a';
    }());
    defineProperties(ArrayPrototype, {
        splice: function splice(start, deleteCount) {
            var O = ES.ToObject(this);
            var A = [];
            var len = ES.ToUint32(O.length);
            var relativeStart = ES.ToInteger(start);
            var actualStart = relativeStart < 0 ? max((len + relativeStart), 0) : min(relativeStart, len);
            var actualDeleteCount = min(max(ES.ToInteger(deleteCount), 0), len - actualStart);

            var k = 0;
            var from;
            while (k < actualDeleteCount) {
                from = $String(actualStart + k);
                if (owns(O, from)) {
                    A[k] = O[from];
                }
                k += 1;
            }

            var items = arraySlice(arguments, 2);
            var itemCount = items.length;
            var to;
            if (itemCount < actualDeleteCount) {
                k = actualStart;
                var maxK = len - actualDeleteCount;
                while (k < maxK) {
                    from = $String(k + actualDeleteCount);
                    to = $String(k + itemCount);
                    if (owns(O, from)) {
                        O[to] = O[from];
                    } else {
                        delete O[to];
                    }
                    k += 1;
                }
                k = len;
                var minK = len - actualDeleteCount + itemCount;
                while (k > minK) {
                    delete O[k - 1];
                    k -= 1;
                }
            } else if (itemCount > actualDeleteCount) {
                k = len - actualDeleteCount;
                while (k > actualStart) {
                    from = $String(k + actualDeleteCount - 1);
                    to = $String(k + itemCount - 1);
                    if (owns(O, from)) {
                        O[to] = O[from];
                    } else {
                        delete O[to];
                    }
                    k -= 1;
                }
            }
            k = actualStart;
            for (var i = 0; i < items.length; ++i) {
                O[k] = items[i];
                k += 1;
            }
            O.length = len - actualDeleteCount + itemCount;

            return A;
        }
    }, !spliceWorksWithLargeSparseArrays || !spliceWorksWithSmallSparseArrays);

    var originalJoin = ArrayPrototype.join;
    var hasStringJoinBug;
    try {
        hasStringJoinBug = Array.prototype.join.call('123', ',') !== '1,2,3';
    } catch (e) {
        hasStringJoinBug = true;
    }
    if (hasStringJoinBug) {
        defineProperties(ArrayPrototype, {
            join: function join(separator) {
                var sep = typeof separator === 'undefined' ? ',' : separator;
                return originalJoin.call(isString(this) ? strSplit(this, '') : this, sep);
            }
        }, hasStringJoinBug);
    }

    var hasJoinUndefinedBug = [1, 2].join(undefined) !== '1,2';
    if (hasJoinUndefinedBug) {
        defineProperties(ArrayPrototype, {
            join: function join(separator) {
                var sep = typeof separator === 'undefined' ? ',' : separator;
                return originalJoin.call(this, sep);
            }
        }, hasJoinUndefinedBug);
    }

    var pushShim = function push(item) {
        var O = ES.ToObject(this);
        var n = ES.ToUint32(O.length);
        var i = 0;
        while (i < arguments.length) {
            O[n + i] = arguments[i];
            i += 1;
        }
        O.length = n + i;
        return n + i;
    };

    var pushIsNotGeneric = (function () {
        var obj = {};
        var result = Array.prototype.push.call(obj, undefined);
        return result !== 1 || obj.length !== 1 || typeof obj[0] !== 'undefined' || !owns(obj, 0);
    }());
    defineProperties(ArrayPrototype, {
        push: function push(item) {
            if (isArray(this)) {
                return array_push.apply(this, arguments);
            }
            return pushShim.apply(this, arguments);
        }
    }, pushIsNotGeneric);

    // This fixes a very weird bug in Opera 10.6 when pushing `undefined
    var pushUndefinedIsWeird = (function () {
        var arr = [];
        var result = arr.push(undefined);
        return result !== 1 || arr.length !== 1 || typeof arr[0] !== 'undefined' || !owns(arr, 0);
    }());
    defineProperties(ArrayPrototype, { push: pushShim }, pushUndefinedIsWeird);

    // ES5 15.2.3.14
    // http://es5.github.io/#x15.4.4.10
    // Fix boxed string bug
    defineProperties(ArrayPrototype, {
        slice: function (start, end) {
            var arr = isString(this) ? strSplit(this, '') : this;
            return arraySliceApply(arr, arguments);
        }
    }, splitString);

    var sortIgnoresNonFunctions = (function () {
        try {
            [1, 2].sort(null);
            [1, 2].sort({});
            return true;
        } catch (e) {}
        return false;
    }());
    var sortThrowsOnRegex = (function () {
        // this is a problem in Firefox 4, in which `typeof /a/ === 'function'`
        try {
            [1, 2].sort(/a/);
            return false;
        } catch (e) {}
        return true;
    }());
    var sortIgnoresUndefined = (function () {
        // applies in IE 8, for one.
        try {
            [1, 2].sort(undefined);
            return true;
        } catch (e) {}
        return false;
    }());
    defineProperties(ArrayPrototype, {
        sort: function sort(compareFn) {
            if (typeof compareFn === 'undefined') {
                return arraySort(this);
            }
            if (!isCallable(compareFn)) {
                throw new TypeError('Array.prototype.sort callback must be a function');
            }
            return arraySort(this, compareFn);
        }
    }, sortIgnoresNonFunctions || !sortIgnoresUndefined || !sortThrowsOnRegex);

    //
    // Object
    // ======
    //

    // ES5 15.2.3.14
    // http://es5.github.com/#x15.2.3.14

    // http://whattheheadsaid.com/2010/10/a-safer-object-keys-compatibility-implementation
    var hasDontEnumBug = !isEnum({ 'toString': null }, 'toString');
    var hasProtoEnumBug = isEnum(function () {}, 'prototype');
    var hasStringEnumBug = !owns('x', '0');
    var equalsConstructorPrototype = function (o) {
        var ctor = o.constructor;
        return ctor && ctor.prototype === o;
    };
    var excludedKeys = {
        $window: true,
        $console: true,
        $parent: true,
        $self: true,
        $frame: true,
        $frames: true,
        $frameElement: true,
        $webkitIndexedDB: true,
        $webkitStorageInfo: true,
        $external: true,
        $width: true,
        $height: true
    };
    var hasAutomationEqualityBug = (function () {
        /* globals window */
        if (typeof window === 'undefined') {
            return false;
        }
        for (var k in window) {
            try {
                if (!excludedKeys['$' + k] && owns(window, k) && window[k] !== null && typeof window[k] === 'object') {
                    equalsConstructorPrototype(window[k]);
                }
            } catch (e) {
                return true;
            }
        }
        return false;
    }());
    var equalsConstructorPrototypeIfNotBuggy = function (object) {
        if (typeof window === 'undefined' || !hasAutomationEqualityBug) {
            return equalsConstructorPrototype(object);
        }
        try {
            return equalsConstructorPrototype(object);
        } catch (e) {
            return false;
        }
    };
    var dontEnums = [
        'toString',
        'toLocaleString',
        'valueOf',
        'hasOwnProperty',
        'isPrototypeOf',
        'propertyIsEnumerable',
        'constructor'
    ];
    var dontEnumsLength = dontEnums.length;

    // taken directly from https://github.com/ljharb/is-arguments/blob/master/index.js
    // can be replaced with require('is-arguments') if we ever use a build process instead
    var isStandardArguments = function isArguments(value) {
        return toStr(value) === '[object Arguments]';
    };
    var isLegacyArguments = function isArguments(value) {
        return value !== null &&
            typeof value === 'object' &&
            typeof value.length === 'number' &&
            value.length >= 0 &&
            !isArray(value) &&
            isCallable(value.callee);
    };
    var isArguments = isStandardArguments(arguments) ? isStandardArguments : isLegacyArguments;

    defineProperties($Object, {
        keys: function keys(object) {
            var isFn = isCallable(object);
            var isArgs = isArguments(object);
            var isObject = object !== null && typeof object === 'object';
            var isStr = isObject && isString(object);

            if (!isObject && !isFn && !isArgs) {
                throw new TypeError('Object.keys called on a non-object');
            }

            var theKeys = [];
            var skipProto = hasProtoEnumBug && isFn;
            if ((isStr && hasStringEnumBug) || isArgs) {
                for (var i = 0; i < object.length; ++i) {
                    pushCall(theKeys, $String(i));
                }
            }

            if (!isArgs) {
                for (var name in object) {
                    if (!(skipProto && name === 'prototype') && owns(object, name)) {
                        pushCall(theKeys, $String(name));
                    }
                }
            }

            if (hasDontEnumBug) {
                var skipConstructor = equalsConstructorPrototypeIfNotBuggy(object);
                for (var j = 0; j < dontEnumsLength; j++) {
                    var dontEnum = dontEnums[j];
                    if (!(skipConstructor && dontEnum === 'constructor') && owns(object, dontEnum)) {
                        pushCall(theKeys, dontEnum);
                    }
                }
            }
            return theKeys;
        }
    });

    var keysWorksWithArguments = $Object.keys && (function () {
            // Safari 5.0 bug
            return $Object.keys(arguments).length === 2;
        }(1, 2));
    var keysHasArgumentsLengthBug = $Object.keys && (function () {
            var argKeys = $Object.keys(arguments);
            return arguments.length !== 1 || argKeys.length !== 1 || argKeys[0] !== 1;
        }(1));
    var originalKeys = $Object.keys;
    defineProperties($Object, {
        keys: function keys(object) {
            if (isArguments(object)) {
                return originalKeys(arraySlice(object));
            } else {
                return originalKeys(object);
            }
        }
    }, !keysWorksWithArguments || keysHasArgumentsLengthBug);

    //
    // Date
    // ====
    //

    var hasNegativeMonthYearBug = new Date(-3509827329600292).getUTCMonth() !== 0;
    var aNegativeTestDate = new Date(-1509842289600292);
    var aPositiveTestDate = new Date(1449662400000);
    var hasToUTCStringFormatBug = aNegativeTestDate.toUTCString() !== 'Mon, 01 Jan -45875 11:59:59 GMT';
    var hasToDateStringFormatBug;
    var hasToStringFormatBug;
    var timeZoneOffset = aNegativeTestDate.getTimezoneOffset();
    if (timeZoneOffset < -720) {
        hasToDateStringFormatBug = aNegativeTestDate.toDateString() !== 'Tue Jan 02 -45875';
        hasToStringFormatBug = !(/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/).test(aPositiveTestDate.toString());
    } else {
        hasToDateStringFormatBug = aNegativeTestDate.toDateString() !== 'Mon Jan 01 -45875';
        hasToStringFormatBug = !(/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/).test(aPositiveTestDate.toString());
    }

    var originalGetFullYear = call.bind(Date.prototype.getFullYear);
    var originalGetMonth = call.bind(Date.prototype.getMonth);
    var originalGetDate = call.bind(Date.prototype.getDate);
    var originalGetUTCFullYear = call.bind(Date.prototype.getUTCFullYear);
    var originalGetUTCMonth = call.bind(Date.prototype.getUTCMonth);
    var originalGetUTCDate = call.bind(Date.prototype.getUTCDate);
    var originalGetUTCDay = call.bind(Date.prototype.getUTCDay);
    var originalGetUTCHours = call.bind(Date.prototype.getUTCHours);
    var originalGetUTCMinutes = call.bind(Date.prototype.getUTCMinutes);
    var originalGetUTCSeconds = call.bind(Date.prototype.getUTCSeconds);
    var originalGetUTCMilliseconds = call.bind(Date.prototype.getUTCMilliseconds);
    var dayName = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    var monthName = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    var daysInMonth = function daysInMonth(month, year) {
        return originalGetDate(new Date(year, month, 0));
    };

    defineProperties(Date.prototype, {
        getFullYear: function getFullYear() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetFullYear(this);
            if (year < 0 && originalGetMonth(this) > 11) {
                return year + 1;
            }
            return year;
        },
        getMonth: function getMonth() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetFullYear(this);
            var month = originalGetMonth(this);
            if (year < 0 && month > 11) {
                return 0;
            }
            return month;
        },
        getDate: function getDate() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetFullYear(this);
            var month = originalGetMonth(this);
            var date = originalGetDate(this);
            if (year < 0 && month > 11) {
                if (month === 12) {
                    return date;
                }
                var days = daysInMonth(0, year + 1);
                return (days - date) + 1;
            }
            return date;
        },
        getUTCFullYear: function getUTCFullYear() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetUTCFullYear(this);
            if (year < 0 && originalGetUTCMonth(this) > 11) {
                return year + 1;
            }
            return year;
        },
        getUTCMonth: function getUTCMonth() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetUTCFullYear(this);
            var month = originalGetUTCMonth(this);
            if (year < 0 && month > 11) {
                return 0;
            }
            return month;
        },
        getUTCDate: function getUTCDate() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var year = originalGetUTCFullYear(this);
            var month = originalGetUTCMonth(this);
            var date = originalGetUTCDate(this);
            if (year < 0 && month > 11) {
                if (month === 12) {
                    return date;
                }
                var days = daysInMonth(0, year + 1);
                return (days - date) + 1;
            }
            return date;
        }
    }, hasNegativeMonthYearBug);

    defineProperties(Date.prototype, {
        toUTCString: function toUTCString() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var day = originalGetUTCDay(this);
            var date = originalGetUTCDate(this);
            var month = originalGetUTCMonth(this);
            var year = originalGetUTCFullYear(this);
            var hour = originalGetUTCHours(this);
            var minute = originalGetUTCMinutes(this);
            var second = originalGetUTCSeconds(this);
            return dayName[day] + ', ' +
                (date < 10 ? '0' + date : date) + ' ' +
                monthName[month] + ' ' +
                year + ' ' +
                (hour < 10 ? '0' + hour : hour) + ':' +
                (minute < 10 ? '0' + minute : minute) + ':' +
                (second < 10 ? '0' + second : second) + ' GMT';
        }
    }, hasNegativeMonthYearBug || hasToUTCStringFormatBug);

    // Opera 12 has `,`
    defineProperties(Date.prototype, {
        toDateString: function toDateString() {
            if (!this || !(this instanceof Date)) {
                throw new TypeError('this is not a Date object.');
            }
            var day = this.getDay();
            var date = this.getDate();
            var month = this.getMonth();
            var year = this.getFullYear();
            return dayName[day] + ' ' +
                monthName[month] + ' ' +
                (date < 10 ? '0' + date : date) + ' ' +
                year;
        }
    }, hasNegativeMonthYearBug || hasToDateStringFormatBug);

    // FRie8tostringnew Date('2016/10')
    // can't use defineProperties here because of toString enumeration issue in IE <= 8
    // if (hasNegativeMonthYearBug || hasToStringFormatBug) {
    //     Date.prototype.toString = function toString() {
    //         if (!this || !(this instanceof Date)) {
    //             throw new TypeError('this is not a Date object.');
    //         }
    //         var day = this.getDay();
    //         var date = this.getDate();
    //         var month = this.getMonth();
    //         var year = this.getFullYear();
    //         var hour = this.getHours();
    //         var minute = this.getMinutes();
    //         var second = this.getSeconds();
    //         var timezoneOffset = this.getTimezoneOffset();
    //         var hoursOffset = Math.floor(Math.abs(timezoneOffset) / 60);
    //         var minutesOffset = Math.floor(Math.abs(timezoneOffset) % 60);
    //         return dayName[day] + ' ' +
    //             monthName[month] + ' ' +
    //             (date < 10 ? '0' + date : date) + ' ' +
    //             year + ' ' +
    //             (hour < 10 ? '0' + hour : hour) + ':' +
    //             (minute < 10 ? '0' + minute : minute) + ':' +
    //             (second < 10 ? '0' + second : second) + ' GMT' +
    //             (timezoneOffset > 0 ? '-' : '+') +
    //             (hoursOffset < 10 ? '0' + hoursOffset : hoursOffset) +
    //             (minutesOffset < 10 ? '0' + minutesOffset : minutesOffset);
    //     };
    //     if (supportsDescriptors) {
    //         $Object.defineProperty(Date.prototype, 'toString', {
    //             configurable: true,
    //             enumerable: false,
    //             writable: true
    //         });
    //     }
    // }

    // ES5 15.9.5.43
    // http://es5.github.com/#x15.9.5.43
    // This function returns a String value represent the instance in time
    // represented by this Date object. The format of the String is the Date Time
    // string format defined in 15.9.1.15. All fields are present in the String.
    // The time zone is always UTC, denoted by the suffix Z. If the time value of
    // this object is not a finite Number a RangeError exception is thrown.
    var negativeDate = -62198755200000;
    var negativeYearString = '-000001';
    var hasNegativeDateBug = Date.prototype.toISOString && new Date(negativeDate).toISOString().indexOf(negativeYearString) === -1;
    var hasSafari51DateBug = Date.prototype.toISOString && new Date(-1).toISOString() !== '1969-12-31T23:59:59.999Z';

    var getTime = call.bind(Date.prototype.getTime);

    defineProperties(Date.prototype, {
        toISOString: function toISOString() {
            if (!isFinite(this) || !isFinite(getTime(this))) {
                // Adope Photoshop requires the second check.
                throw new RangeError('Date.prototype.toISOString called on non-finite value.');
            }

            var year = originalGetUTCFullYear(this);

            var month = originalGetUTCMonth(this);
            // see https://github.com/es-shims/es5-shim/issues/111
            year += Math.floor(month / 12);
            month = ((month % 12) + 12) % 12;

            // the date time string format is specified in 15.9.1.15.
            var result = [month + 1, originalGetUTCDate(this), originalGetUTCHours(this), originalGetUTCMinutes(this), originalGetUTCSeconds(this)];
            year = (
                (year < 0 ? '-' : (year > 9999 ? '+' : '')) +
                strSlice('00000' + Math.abs(year), (0 <= year && year <= 9999) ? -4 : -6)
            );

            for (var i = 0; i < result.length; ++i) {
                // pad months, days, hours, minutes, and seconds to have two digits.
                result[i] = strSlice('00' + result[i], -2);
            }
            // pad milliseconds to have three digits.
            return (
                year + '-' + arraySlice(result, 0, 2).join('-') +
                'T' + arraySlice(result, 2).join(':') + '.' +
                strSlice('000' + originalGetUTCMilliseconds(this), -3) + 'Z'
            );
        }
    }, hasNegativeDateBug || hasSafari51DateBug);

    // ES5 15.9.5.44
    // http://es5.github.com/#x15.9.5.44
    // This function provides a String representation of a Date object for use by
    // JSON.stringify (15.12.3).
    var dateToJSONIsSupported = (function () {
        try {
            return Date.prototype.toJSON &&
                new Date(NaN).toJSON() === null &&
                new Date(negativeDate).toJSON().indexOf(negativeYearString) !== -1 &&
                Date.prototype.toJSON.call({ // generic
                    toISOString: function () { return true; }
                });
        } catch (e) {
            return false;
        }
    }());
    if (!dateToJSONIsSupported) {
        Date.prototype.toJSON = function toJSON(key) {
            // When the toJSON method is called with argument key, the following
            // steps are taken:

            // 1.  Let O be the result of calling ToObject, giving it the this
            // value as its argument.
            // 2. Let tv be ES.ToPrimitive(O, hint Number).
            var O = $Object(this);
            var tv = ES.ToPrimitive(O);
            // 3. If tv is a Number and is not finite, return null.
            if (typeof tv === 'number' && !isFinite(tv)) {
                return null;
            }
            // 4. Let toISO be the result of calling the [[Get]] internal method of
            // O with argument "toISOString".
            var toISO = O.toISOString;
            // 5. If IsCallable(toISO) is false, throw a TypeError exception.
            if (!isCallable(toISO)) {
                throw new TypeError('toISOString property is not callable');
            }
            // 6. Return the result of calling the [[Call]] internal method of
            //  toISO with O as the this value and an empty argument list.
            return toISO.call(O);

            // NOTE 1 The argument is ignored.

            // NOTE 2 The toJSON function is intentionally generic; it does not
            // require that its this value be a Date object. Therefore, it can be
            // transferred to other kinds of objects for use as a method. However,
            // it does require that any such object have a toISOString method. An
            // object is free to use the argument key to filter its
            // stringification.
        };
    }

    // ES5 15.9.4.2
    // http://es5.github.com/#x15.9.4.2
    // based on work shared by Daniel Friesen (dantman)
    // http://gist.github.com/303249
    var supportsExtendedYears = Date.parse('+033658-09-27T01:46:40.000Z') === 1e15;
    var acceptsInvalidDates = !isNaN(Date.parse('2012-04-04T24:00:00.500Z')) || !isNaN(Date.parse('2012-11-31T23:59:59.000Z')) || !isNaN(Date.parse('2012-12-31T23:59:60.000Z'));
    var doesNotParseY2KNewYear = isNaN(Date.parse('2000-01-01T00:00:00.000Z'));
    if (doesNotParseY2KNewYear || acceptsInvalidDates || !supportsExtendedYears) {
        // XXX global assignment won't work in embeddings that use
        // an alternate object for the context.
        /* global Date: true */
        var maxSafeUnsigned32Bit = Math.pow(2, 31) - 1;
        var hasSafariSignedIntBug = isActualNaN(new Date(1970, 0, 1, 0, 0, 0, maxSafeUnsigned32Bit + 1).getTime());
        // eslint-disable-next-line no-implicit-globals, no-global-assign
        Date = (function (NativeDate) {
            // Date.length === 7
            var DateShim = function Date(Y, M, D, h, m, s, ms) {
                var length = arguments.length;
                var date;
                if (this instanceof NativeDate) {
                    var seconds = s;
                    var millis = ms;
                    if (hasSafariSignedIntBug && length >= 7 && ms > maxSafeUnsigned32Bit) {
                        // work around a Safari 8/9 bug where it treats the seconds as signed
                        var msToShift = Math.floor(ms / maxSafeUnsigned32Bit) * maxSafeUnsigned32Bit;
                        var sToShift = Math.floor(msToShift / 1e3);
                        seconds += sToShift;
                        millis -= sToShift * 1e3;
                    }
                    date = length === 1 && $String(Y) === Y ? // isString(Y)
                        // We explicitly pass it through parse:
                        new NativeDate(DateShim.parse(Y)) :
                        // We have to manually make calls depending on argument
                        // length here
                        length >= 7 ? new NativeDate(Y, M, D, h, m, seconds, millis) :
                            length >= 6 ? new NativeDate(Y, M, D, h, m, seconds) :
                                length >= 5 ? new NativeDate(Y, M, D, h, m) :
                                    length >= 4 ? new NativeDate(Y, M, D, h) :
                                        length >= 3 ? new NativeDate(Y, M, D) :
                                            length >= 2 ? new NativeDate(Y, M) :
                                                length >= 1 ? new NativeDate(Y instanceof NativeDate ? +Y : Y) :
                                                    new NativeDate();
                } else {
                    date = NativeDate.apply(this, arguments);
                }
                if (!isPrimitive(date)) {
                    // Prevent mixups with unfixed Date object
                    defineProperties(date, { constructor: DateShim }, true);
                }
                return date;
            };

            // 15.9.1.15 Date Time String Format.
            var isoDateExpression = new RegExp('^' +
                '(\\d{4}|[+-]\\d{6})' + // four-digit year capture or sign +
                // 6-digit extended year
                '(?:-(\\d{2})' + // optional month capture
                '(?:-(\\d{2})' + // optional day capture
                '(?:' + // capture hours:minutes:seconds.milliseconds
                'T(\\d{2})' + // hours capture
                ':(\\d{2})' + // minutes capture
                '(?:' + // optional :seconds.milliseconds
                ':(\\d{2})' + // seconds capture
                '(?:(\\.\\d{1,}))?' + // milliseconds capture
                ')?' +
                '(' + // capture UTC offset component
                'Z|' + // UTC capture
                '(?:' + // offset specifier +/-hours:minutes
                '([-+])' + // sign capture
                '(\\d{2})' + // hours offset capture
                ':(\\d{2})' + // minutes offset capture
                ')' +
                ')?)?)?)?' +
                '$');

            var months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365];

            var dayFromMonth = function dayFromMonth(year, month) {
                var t = month > 1 ? 1 : 0;
                return (
                    months[month] +
                    Math.floor((year - 1969 + t) / 4) -
                    Math.floor((year - 1901 + t) / 100) +
                    Math.floor((year - 1601 + t) / 400) +
                    (365 * (year - 1970))
                );
            };

            var toUTC = function toUTC(t) {
                var s = 0;
                var ms = t;
                if (hasSafariSignedIntBug && ms > maxSafeUnsigned32Bit) {
                    // work around a Safari 8/9 bug where it treats the seconds as signed
                    var msToShift = Math.floor(ms / maxSafeUnsigned32Bit) * maxSafeUnsigned32Bit;
                    var sToShift = Math.floor(msToShift / 1e3);
                    s += sToShift;
                    ms -= sToShift * 1e3;
                }
                return $Number(new NativeDate(1970, 0, 1, 0, 0, s, ms));
            };

            // Copy any custom methods a 3rd party library may have added
            for (var key in NativeDate) {
                if (owns(NativeDate, key)) {
                    DateShim[key] = NativeDate[key];
                }
            }

            // Copy "native" methods explicitly; they may be non-enumerable
            defineProperties(DateShim, {
                now: NativeDate.now,
                UTC: NativeDate.UTC
            }, true);
            DateShim.prototype = NativeDate.prototype;
            defineProperties(DateShim.prototype, { constructor: DateShim }, true);

            // Upgrade Date.parse to handle simplified ISO 8601 strings
            var parseShim = function parse(string) {
                var match = isoDateExpression.exec(string);
                if (match) {
                    // parse months, days, hours, minutes, seconds, and milliseconds
                    // provide default values if necessary
                    // parse the UTC offset component
                    var year = $Number(match[1]),
                        month = $Number(match[2] || 1) - 1,
                        day = $Number(match[3] || 1) - 1,
                        hour = $Number(match[4] || 0),
                        minute = $Number(match[5] || 0),
                        second = $Number(match[6] || 0),
                        millisecond = Math.floor($Number(match[7] || 0) * 1000),
                        // When time zone is missed, local offset should be used
                        // (ES 5.1 bug)
                        // see https://bugs.ecmascript.org/show_bug.cgi?id=112
                        isLocalTime = Boolean(match[4] && !match[8]),
                        signOffset = match[9] === '-' ? 1 : -1,
                        hourOffset = $Number(match[10] || 0),
                        minuteOffset = $Number(match[11] || 0),
                        result;
                    var hasMinutesOrSecondsOrMilliseconds = minute > 0 || second > 0 || millisecond > 0;
                    if (
                        hour < (hasMinutesOrSecondsOrMilliseconds ? 24 : 25) &&
                        minute < 60 && second < 60 && millisecond < 1000 &&
                        month > -1 && month < 12 && hourOffset < 24 &&
                        minuteOffset < 60 && // detect invalid offsets
                        day > -1 &&
                        day < (dayFromMonth(year, month + 1) - dayFromMonth(year, month))
                    ) {
                        result = (
                                ((dayFromMonth(year, month) + day) * 24) +
                                hour +
                                (hourOffset * signOffset)
                            ) * 60;
                        result = ((
                                ((result + minute + (minuteOffset * signOffset)) * 60) +
                                second
                            ) * 1000) + millisecond;
                        if (isLocalTime) {
                            result = toUTC(result);
                        }
                        if (-8.64e15 <= result && result <= 8.64e15) {
                            return result;
                        }
                    }
                    return NaN;
                }
                return NativeDate.parse.apply(this, arguments);
            };
            defineProperties(DateShim, { parse: parseShim });

            return DateShim;
        }(Date));
        /* global Date: false */
    }

    // ES5 15.9.4.4
    // http://es5.github.com/#x15.9.4.4
    if (!Date.now) {
        Date.now = function now() {
            return new Date().getTime();
        };
    }

    //
    // Number
    // ======
    //

    // ES5.1 15.7.4.5
    // http://es5.github.com/#x15.7.4.5
    var hasToFixedBugs = NumberPrototype.toFixed && (
            (0.00008).toFixed(3) !== '0.000' ||
            (0.9).toFixed(0) !== '1' ||
            (1.255).toFixed(2) !== '1.25' ||
            (1000000000000000128).toFixed(0) !== '1000000000000000128'
        );

    var toFixedHelpers = {
        base: 1e7,
        size: 6,
        data: [0, 0, 0, 0, 0, 0],
        multiply: function multiply(n, c) {
            var i = -1;
            var c2 = c;
            while (++i < toFixedHelpers.size) {
                c2 += n * toFixedHelpers.data[i];
                toFixedHelpers.data[i] = c2 % toFixedHelpers.base;
                c2 = Math.floor(c2 / toFixedHelpers.base);
            }
        },
        divide: function divide(n) {
            var i = toFixedHelpers.size;
            var c = 0;
            while (--i >= 0) {
                c += toFixedHelpers.data[i];
                toFixedHelpers.data[i] = Math.floor(c / n);
                c = (c % n) * toFixedHelpers.base;
            }
        },
        numToString: function numToString() {
            var i = toFixedHelpers.size;
            var s = '';
            while (--i >= 0) {
                if (s !== '' || i === 0 || toFixedHelpers.data[i] !== 0) {
                    var t = $String(toFixedHelpers.data[i]);
                    if (s === '') {
                        s = t;
                    } else {
                        s += strSlice('0000000', 0, 7 - t.length) + t;
                    }
                }
            }
            return s;
        },
        pow: function pow(x, n, acc) {
            return (n === 0 ? acc : (n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc)));
        },
        log: function log(x) {
            var n = 0;
            var x2 = x;
            while (x2 >= 4096) {
                n += 12;
                x2 /= 4096;
            }
            while (x2 >= 2) {
                n += 1;
                x2 /= 2;
            }
            return n;
        }
    };

    var toFixedShim = function toFixed(fractionDigits) {
        var f, x, s, m, e, z, j, k;

        // Test for NaN and round fractionDigits down
        f = $Number(fractionDigits);
        f = isActualNaN(f) ? 0 : Math.floor(f);

        if (f < 0 || f > 20) {
            throw new RangeError('Number.toFixed called with invalid number of decimals');
        }

        x = $Number(this);

        if (isActualNaN(x)) {
            return 'NaN';
        }

        // If it is too big or small, return the string value of the number
        if (x <= -1e21 || x >= 1e21) {
            return $String(x);
        }

        s = '';

        if (x < 0) {
            s = '-';
            x = -x;
        }

        m = '0';

        if (x > 1e-21) {
            // 1e-21 < x < 1e21
            // -70 < log2(x) < 70
            e = toFixedHelpers.log(x * toFixedHelpers.pow(2, 69, 1)) - 69;
            z = (e < 0 ? x * toFixedHelpers.pow(2, -e, 1) : x / toFixedHelpers.pow(2, e, 1));
            z *= 0x10000000000000; // Math.pow(2, 52);
            e = 52 - e;

            // -18 < e < 122
            // x = z / 2 ^ e
            if (e > 0) {
                toFixedHelpers.multiply(0, z);
                j = f;

                while (j >= 7) {
                    toFixedHelpers.multiply(1e7, 0);
                    j -= 7;
                }

                toFixedHelpers.multiply(toFixedHelpers.pow(10, j, 1), 0);
                j = e - 1;

                while (j >= 23) {
                    toFixedHelpers.divide(1 << 23);
                    j -= 23;
                }

                toFixedHelpers.divide(1 << j);
                toFixedHelpers.multiply(1, 1);
                toFixedHelpers.divide(2);
                m = toFixedHelpers.numToString();
            } else {
                toFixedHelpers.multiply(0, z);
                toFixedHelpers.multiply(1 << (-e), 0);
                m = toFixedHelpers.numToString() + strSlice('0.00000000000000000000', 2, 2 + f);
            }
        }

        if (f > 0) {
            k = m.length;

            if (k <= f) {
                m = s + strSlice('0.0000000000000000000', 0, f - k + 2) + m;
            } else {
                m = s + strSlice(m, 0, k - f) + '.' + strSlice(m, k - f);
            }
        } else {
            m = s + m;
        }

        return m;
    };
    defineProperties(NumberPrototype, { toFixed: toFixedShim }, hasToFixedBugs);

    var hasToPrecisionUndefinedBug = (function () {
        try {
            return 1.0.toPrecision(undefined) === '1';
        } catch (e) {
            return true;
        }
    }());
    var originalToPrecision = NumberPrototype.toPrecision;
    defineProperties(NumberPrototype, {
        toPrecision: function toPrecision(precision) {
            return typeof precision === 'undefined' ? originalToPrecision.call(this) : originalToPrecision.call(this, precision);
        }
    }, hasToPrecisionUndefinedBug);

    //
    // String
    // ======
    //

    // ES5 15.5.4.14
    // http://es5.github.com/#x15.5.4.14

    // [bugfix, IE lt 9, firefox 4, Konqueror, Opera, obscure browsers]
    // Many browsers do not split properly with regular expressions or they
    // do not perform the split correctly under obscure conditions.
    // See http://blog.stevenlevithan.com/archives/cross-browser-split
    // I've tested in many browsers and this seems to cover the deviant ones:
    //    'ab'.split(/(?:ab)*/) should be ["", ""], not [""]
    //    '.'.split(/(.?)(.?)/) should be ["", ".", "", ""], not ["", ""]
    //    'tesst'.split(/(s)*/) should be ["t", undefined, "e", "s", "t"], not
    //       [undefined, "t", undefined, "e", ...]
    //    ''.split(/.?/) should be [], not [""]
    //    '.'.split(/()()/) should be ["."], not ["", "", "."]

    if (
        'ab'.split(/(?:ab)*/).length !== 2 ||
        '.'.split(/(.?)(.?)/).length !== 4 ||
        'tesst'.split(/(s)*/)[1] === 't' ||
        'test'.split(/(?:)/, -1).length !== 4 ||
        ''.split(/.?/).length ||
        '.'.split(/()()/).length > 1
    ) {
        (function () {
            var compliantExecNpcg = typeof (/()??/).exec('')[1] === 'undefined'; // NPCG: nonparticipating capturing group
            var maxSafe32BitInt = Math.pow(2, 32) - 1;

            StringPrototype.split = function (separator, limit) {
                var string = String(this);
                if (typeof separator === 'undefined' && limit === 0) {
                    return [];
                }

                // If `separator` is not a regex, use native split
                if (!isRegex(separator)) {
                    return strSplit(this, separator, limit);
                }

                var output = [];
                var flags = (separator.ignoreCase ? 'i' : '') +
                        (separator.multiline ? 'm' : '') +
                        (separator.unicode ? 'u' : '') + // in ES6
                        (separator.sticky ? 'y' : ''), // Firefox 3+ and ES6
                    lastLastIndex = 0,
                    // Make `global` and avoid `lastIndex` issues by working with a copy
                    separator2, match, lastIndex, lastLength;
                var separatorCopy = new RegExp(separator.source, flags + 'g');
                if (!compliantExecNpcg) {
                    // Doesn't need flags gy, but they don't hurt
                    separator2 = new RegExp('^' + separatorCopy.source + '$(?!\\s)', flags);
                }
                /* Values for `limit`, per the spec:
                 * If undefined: 4294967295 // maxSafe32BitInt
                 * If 0, Infinity, or NaN: 0
                 * If positive number: limit = Math.floor(limit); if (limit > 4294967295) limit -= 4294967296;
                 * If negative number: 4294967296 - Math.floor(Math.abs(limit))
                 * If other: Type-convert, then use the above rules
                 */
                var splitLimit = typeof limit === 'undefined' ? maxSafe32BitInt : ES.ToUint32(limit);
                match = separatorCopy.exec(string);
                while (match) {
                    // `separatorCopy.lastIndex` is not reliable cross-browser
                    lastIndex = match.index + match[0].length;
                    if (lastIndex > lastLastIndex) {
                        pushCall(output, strSlice(string, lastLastIndex, match.index));
                        // Fix browsers whose `exec` methods don't consistently return `undefined` for
                        // nonparticipating capturing groups
                        if (!compliantExecNpcg && match.length > 1) {
                            /* eslint-disable no-loop-func */
                            match[0].replace(separator2, function () {
                                for (var i = 1; i < arguments.length - 2; i++) {
                                    if (typeof arguments[i] === 'undefined') {
                                        match[i] = void 0;
                                    }
                                }
                            });
                            /* eslint-enable no-loop-func */
                        }
                        if (match.length > 1 && match.index < string.length) {
                            array_push.apply(output, arraySlice(match, 1));
                        }
                        lastLength = match[0].length;
                        lastLastIndex = lastIndex;
                        if (output.length >= splitLimit) {
                            break;
                        }
                    }
                    if (separatorCopy.lastIndex === match.index) {
                        separatorCopy.lastIndex++; // Avoid an infinite loop
                    }
                    match = separatorCopy.exec(string);
                }
                if (lastLastIndex === string.length) {
                    if (lastLength || !separatorCopy.test('')) {
                        pushCall(output, '');
                    }
                } else {
                    pushCall(output, strSlice(string, lastLastIndex));
                }
                return output.length > splitLimit ? arraySlice(output, 0, splitLimit) : output;
            };
        }());

        // [bugfix, chrome]
        // If separator is undefined, then the result array contains just one String,
        // which is the this value (converted to a String). If limit is not undefined,
        // then the output array is truncated so that it contains no more than limit
        // elements.
        // "0".split(undefined, 0) -> []
    } else if ('0'.split(void 0, 0).length) {
        StringPrototype.split = function split(separator, limit) {
            if (typeof separator === 'undefined' && limit === 0) {
                return [];
            }
            return strSplit(this, separator, limit);
        };
    }

    var str_replace = StringPrototype.replace;
    var replaceReportsGroupsCorrectly = (function () {
        var groups = [];
        'x'.replace(/x(.)?/g, function (match, group) {
            pushCall(groups, group);
        });
        return groups.length === 1 && typeof groups[0] === 'undefined';
    }());

    if (!replaceReportsGroupsCorrectly) {
        StringPrototype.replace = function replace(searchValue, replaceValue) {
            var isFn = isCallable(replaceValue);
            var hasCapturingGroups = isRegex(searchValue) && (/\)[*?]/).test(searchValue.source);
            if (!isFn || !hasCapturingGroups) {
                return str_replace.call(this, searchValue, replaceValue);
            } else {
                var wrappedReplaceValue = function (match) {
                    var length = arguments.length;
                    var originalLastIndex = searchValue.lastIndex;
                    searchValue.lastIndex = 0;
                    var args = searchValue.exec(match) || [];
                    searchValue.lastIndex = originalLastIndex;
                    pushCall(args, arguments[length - 2], arguments[length - 1]);
                    return replaceValue.apply(this, args);
                };
                return str_replace.call(this, searchValue, wrappedReplaceValue);
            }
        };
    }

    // ECMA-262, 3rd B.2.3
    // Not an ECMAScript standard, although ECMAScript 3rd Edition has a
    // non-normative section suggesting uniform semantics and it should be
    // normalized across all browsers
    // [bugfix, IE lt 9] IE < 9 substr() with negative value not working in IE
    var string_substr = StringPrototype.substr;
    var hasNegativeSubstrBug = ''.substr && '0b'.substr(-1) !== 'b';
    defineProperties(StringPrototype, {
        substr: function substr(start, length) {
            var normalizedStart = start;
            if (start < 0) {
                normalizedStart = max(this.length + start, 0);
            }
            return string_substr.call(this, normalizedStart, length);
        }
    }, hasNegativeSubstrBug);

    // ES5 15.5.4.20
    // whitespace from: http://es5.github.io/#x15.5.4.20
    var ws = '\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003' +
        '\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028' +
        '\u2029\uFEFF';
    var zeroWidth = '\u200b';
    var wsRegexChars = '[' + ws + ']';
    var trimBeginRegexp = new RegExp('^' + wsRegexChars + wsRegexChars + '*');
    var trimEndRegexp = new RegExp(wsRegexChars + wsRegexChars + '*$');
    var hasTrimWhitespaceBug = StringPrototype.trim && (ws.trim() || !zeroWidth.trim());
    defineProperties(StringPrototype, {
        // http://blog.stevenlevithan.com/archives/faster-trim-javascript
        // http://perfectionkills.com/whitespace-deviations/
        trim: function trim() {
            if (typeof this === 'undefined' || this === null) {
                throw new TypeError("can't convert " + this + ' to object');
            }
            return $String(this).replace(trimBeginRegexp, '').replace(trimEndRegexp, '');
        }
    }, hasTrimWhitespaceBug);
    var trim = call.bind(String.prototype.trim);

    var hasLastIndexBug = StringPrototype.lastIndexOf && 'abc'.lastIndexOf('', 2) !== -1;
    defineProperties(StringPrototype, {
        lastIndexOf: function lastIndexOf(searchString) {
            if (typeof this === 'undefined' || this === null) {
                throw new TypeError("can't convert " + this + ' to object');
            }
            var S = $String(this);
            var searchStr = $String(searchString);
            var numPos = arguments.length > 1 ? $Number(arguments[1]) : NaN;
            var pos = isActualNaN(numPos) ? Infinity : ES.ToInteger(numPos);
            var start = min(max(pos, 0), S.length);
            var searchLen = searchStr.length;
            var k = start + searchLen;
            while (k > 0) {
                k = max(0, k - searchLen);
                var index = strIndexOf(strSlice(S, k, start + searchLen), searchStr);
                if (index !== -1) {
                    return k + index;
                }
            }
            return -1;
        }
    }, hasLastIndexBug);

    var originalLastIndexOf = StringPrototype.lastIndexOf;
    defineProperties(StringPrototype, {
        lastIndexOf: function lastIndexOf(searchString) {
            return originalLastIndexOf.apply(this, arguments);
        }
    }, StringPrototype.lastIndexOf.length !== 1);

    // ES-5 15.1.2.2
    // eslint-disable-next-line radix
    if (parseInt(ws + '08') !== 8 || parseInt(ws + '0x16') !== 22) {
        /* global parseInt: true */
        parseInt = (function (origParseInt) {
            var hexRegex = /^[\-+]?0[xX]/;
            return function parseInt(str, radix) {
                var string = trim(String(str));
                var defaultedRadix = $Number(radix) || (hexRegex.test(string) ? 16 : 10);
                return origParseInt(string, defaultedRadix);
            };
        }(parseInt));
    }

    // https://es5.github.io/#x15.1.2.3
    if (1 / parseFloat('-0') !== -Infinity) {
        /* global parseFloat: true */
        parseFloat = (function (origParseFloat) {
            return function parseFloat(string) {
                var inputString = trim(String(string));
                var result = origParseFloat(inputString);
                return result === 0 && strSlice(inputString, 0, 1) === '-' ? -0 : result;
            };
        }(parseFloat));
    }

    if (String(new RangeError('test')) !== 'RangeError: test') {
        var errorToStringShim = function toString() {
            if (typeof this === 'undefined' || this === null) {
                throw new TypeError("can't convert " + this + ' to object');
            }
            var name = this.name;
            if (typeof name === 'undefined') {
                name = 'Error';
            } else if (typeof name !== 'string') {
                name = $String(name);
            }
            var msg = this.message;
            if (typeof msg === 'undefined') {
                msg = '';
            } else if (typeof msg !== 'string') {
                msg = $String(msg);
            }
            if (!name) {
                return msg;
            }
            if (!msg) {
                return name;
            }
            return name + ': ' + msg;
        };
        // can't use defineProperties here because of toString enumeration issue in IE <= 8
        Error.prototype.toString = errorToStringShim;
    }

    if (supportsDescriptors) {
        var ensureNonEnumerable = function (obj, prop) {
            if (isEnum(obj, prop)) {
                var desc = Object.getOwnPropertyDescriptor(obj, prop);
                if (desc.configurable) {
                    desc.enumerable = false;
                    Object.defineProperty(obj, prop, desc);
                }
            }
        };
        ensureNonEnumerable(Error.prototype, 'message');
        if (Error.prototype.message !== '') {
            Error.prototype.message = '';
        }
        ensureNonEnumerable(Error.prototype, 'name');
    }

    if (String(/a/mig) !== '/a/gim') {
        var regexToString = function toString() {
            var str = '/' + this.source + '/';
            if (this.global) {
                str += 'g';
            }
            if (this.ignoreCase) {
                str += 'i';
            }
            if (this.multiline) {
                str += 'm';
            }
            return str;
        };
        // can't use defineProperties here because of toString enumeration issue in IE <= 8
        RegExp.prototype.toString = regexToString;
    }
}));

(function (root, factory) {
    'use strict';

    /* global define, exports, module */
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(factory);
    } else if (typeof exports === 'object') {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like enviroments that support module.exports,
        // like Node.
        module.exports = factory();
    } else {
        // Browser globals (root is window)
        root.returnExports = factory();
    }
}(this, function () {

    var call = Function.call;
    var prototypeOfObject = Object.prototype;
    var owns = call.bind(prototypeOfObject.hasOwnProperty);
    var isEnumerable = call.bind(prototypeOfObject.propertyIsEnumerable);
    var toStr = call.bind(prototypeOfObject.toString);

    // If JS engine supports accessors creating shortcuts.
    var defineGetter;
    var defineSetter;
    var lookupGetter;
    var lookupSetter;
    var supportsAccessors = owns(prototypeOfObject, '__defineGetter__');
    if (supportsAccessors) {
        /* eslint-disable no-underscore-dangle */
        defineGetter = call.bind(prototypeOfObject.__defineGetter__);
        defineSetter = call.bind(prototypeOfObject.__defineSetter__);
        lookupGetter = call.bind(prototypeOfObject.__lookupGetter__);
        lookupSetter = call.bind(prototypeOfObject.__lookupSetter__);
        /* eslint-enable no-underscore-dangle */
    }

    var isPrimitive = function isPrimitive(o) {
        return o == null || (typeof o !== 'object' && typeof o !== 'function');
    };

    // ES5 15.2.3.2
    // http://es5.github.com/#x15.2.3.2
    if (!Object.getPrototypeOf) {
        // https://github.com/es-shims/es5-shim/issues#issue/2
        // http://ejohn.org/blog/objectgetprototypeof/
        // recommended by fschaefer on github
        //
        // sure, and webreflection says ^_^
        // ... this will nerever possibly return null
        // ... Opera Mini breaks here with infinite loops
        Object.getPrototypeOf = function getPrototypeOf(object) {
            // eslint-disable-next-line no-proto
            var proto = object.__proto__;
            if (proto || proto === null) {
                return proto;
            } else if (toStr(object.constructor) === '[object Function]') {
                return object.constructor.prototype;
            } else if (object instanceof Object) {
                return prototypeOfObject;
            } else {
                // Correctly return null for Objects created with `Object.create(null)`
                // (shammed or native) or `{ __proto__: null}`.  Also returns null for
                // cross-realm objects on browsers that lack `__proto__` support (like
                // IE <11), but that's the best we can do.
                return null;
            }
        };
    }

    // ES5 15.2.3.3
    // http://es5.github.com/#x15.2.3.3

    var doesGetOwnPropertyDescriptorWork = function doesGetOwnPropertyDescriptorWork(object) {
        try {
            object.sentinel = 0;
            return Object.getOwnPropertyDescriptor(object, 'sentinel').value === 0;
        } catch (exception) {
            return false;
        }
    };

    // check whether getOwnPropertyDescriptor works if it's given. Otherwise, shim partially.
    if (Object.defineProperty) {
        var getOwnPropertyDescriptorWorksOnObject = doesGetOwnPropertyDescriptorWork({});
        var getOwnPropertyDescriptorWorksOnDom = typeof document === 'undefined' ||
            doesGetOwnPropertyDescriptorWork(document.createElement('div'));
        if (!getOwnPropertyDescriptorWorksOnDom || !getOwnPropertyDescriptorWorksOnObject) {
            var getOwnPropertyDescriptorFallback = Object.getOwnPropertyDescriptor;
        }
    }

    if (!Object.getOwnPropertyDescriptor || getOwnPropertyDescriptorFallback) {
        var ERR_NON_OBJECT = 'Object.getOwnPropertyDescriptor called on a non-object: ';

        /* eslint-disable no-proto */
        Object.getOwnPropertyDescriptor = function getOwnPropertyDescriptor(object, property) {
            if (isPrimitive(object)) {
                throw new TypeError(ERR_NON_OBJECT + object);
            }

            // make a valiant attempt to use the real getOwnPropertyDescriptor
            // for I8's DOM elements.
            if (getOwnPropertyDescriptorFallback) {
                try {
                    return getOwnPropertyDescriptorFallback.call(Object, object, property);
                } catch (exception) {
                    // try the shim if the real one doesn't work
                }
            }

            var descriptor;

            // If object does not owns property return undefined immediately.
            if (!owns(object, property)) {
                return descriptor;
            }

            // If object has a property then it's for sure `configurable`, and
            // probably `enumerable`. Detect enumerability though.
            descriptor = {
                enumerable: isEnumerable(object, property),
                configurable: true
            };

            // If JS engine supports accessor properties then property may be a
            // getter or setter.
            if (supportsAccessors) {
                // Unfortunately `__lookupGetter__` will return a getter even
                // if object has own non getter property along with a same named
                // inherited getter. To avoid misbehavior we temporary remove
                // `__proto__` so that `__lookupGetter__` will return getter only
                // if it's owned by an object.
                var prototype = object.__proto__;
                var notPrototypeOfObject = object !== prototypeOfObject;
                // avoid recursion problem, breaking in Opera Mini when
                // Object.getOwnPropertyDescriptor(Object.prototype, 'toString')
                // or any other Object.prototype accessor
                if (notPrototypeOfObject) {
                    object.__proto__ = prototypeOfObject;
                }

                var getter = lookupGetter(object, property);
                var setter = lookupSetter(object, property);

                if (notPrototypeOfObject) {
                    // Once we have getter and setter we can put values back.
                    object.__proto__ = prototype;
                }

                if (getter || setter) {
                    if (getter) {
                        descriptor.get = getter;
                    }
                    if (setter) {
                        descriptor.set = setter;
                    }
                    // If it was accessor property we're done and return here
                    // in order to avoid adding `value` to the descriptor.
                    return descriptor;
                }
            }

            // If we got this far we know that object has an own property that is
            // not an accessor so we set it as a value and return descriptor.
            descriptor.value = object[property];
            descriptor.writable = true;
            return descriptor;
        };
        /* eslint-enable no-proto */
    }

    // ES5 15.2.3.4
    // http://es5.github.com/#x15.2.3.4
    if (!Object.getOwnPropertyNames) {
        Object.getOwnPropertyNames = function getOwnPropertyNames(object) {
            return Object.keys(object);
        };
    }

    // ES5 15.2.3.5
    // http://es5.github.com/#x15.2.3.5
    if (!Object.create) {

        // Contributed by Brandon Benvie, October, 2012
        var createEmpty;
        var supportsProto = !({ __proto__: null } instanceof Object);
        // the following produces false positives
        // in Opera Mini => not a reliable check
        // Object.prototype.__proto__ === null

        // Check for document.domain and active x support
        // No need to use active x approach when document.domain is not set
        // see https://github.com/es-shims/es5-shim/issues/150
        // variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346
        /* global ActiveXObject */
        var shouldUseActiveX = function shouldUseActiveX() {
            // return early if document.domain not set
            if (!document.domain) {
                return false;
            }

            try {
                return !!new ActiveXObject('htmlfile');
            } catch (exception) {
                return false;
            }
        };

        // This supports IE8 when document.domain is used
        // see https://github.com/es-shims/es5-shim/issues/150
        // variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346
        var getEmptyViaActiveX = function getEmptyViaActiveX() {
            var empty;
            var xDoc;

            xDoc = new ActiveXObject('htmlfile');

            var script = 'script';
            xDoc.write('<' + script + '></' + script + '>');
            xDoc.close();

            empty = xDoc.parentWindow.Object.prototype;
            xDoc = null;

            return empty;
        };

        // The original implementation using an iframe
        // before the activex approach was added
        // see https://github.com/es-shims/es5-shim/issues/150
        var getEmptyViaIFrame = function getEmptyViaIFrame() {
            var iframe = document.createElement('iframe');
            var parent = document.body || document.documentElement;
            var empty;

            iframe.style.display = 'none';
            parent.appendChild(iframe);
            // eslint-disable-next-line no-script-url
            iframe.src = 'javascript:';

            empty = iframe.contentWindow.Object.prototype;
            parent.removeChild(iframe);
            iframe = null;

            return empty;
        };

        /* global document */
        if (supportsProto || typeof document === 'undefined') {
            createEmpty = function () {
                return { __proto__: null };
            };
        } else {
            // In old IE __proto__ can't be used to manually set `null`, nor does
            // any other method exist to make an object that inherits from nothing,
            // aside from Object.prototype itself. Instead, create a new global
            // object and *steal* its Object.prototype and strip it bare. This is
            // used as the prototype to create nullary objects.
            createEmpty = function () {
                // Determine which approach to use
                // see https://github.com/es-shims/es5-shim/issues/150
                var empty = shouldUseActiveX() ? getEmptyViaActiveX() : getEmptyViaIFrame();

                delete empty.constructor;
                delete empty.hasOwnProperty;
                delete empty.propertyIsEnumerable;
                delete empty.isPrototypeOf;
                delete empty.toLocaleString;
                delete empty.toString;
                delete empty.valueOf;

                var Empty = function Empty() {};
                Empty.prototype = empty;
                // short-circuit future calls
                createEmpty = function () {
                    return new Empty();
                };
                return new Empty();
            };
        }

        Object.create = function create(prototype, properties) {

            var object;
            var Type = function Type() {}; // An empty constructor.

            if (prototype === null) {
                object = createEmpty();
            } else {
                if (prototype !== null && isPrimitive(prototype)) {
                    // In the native implementation `parent` can be `null`
                    // OR *any* `instanceof Object`  (Object|Function|Array|RegExp|etc)
                    // Use `typeof` tho, b/c in old IE, DOM elements are not `instanceof Object`
                    // like they are in modern browsers. Using `Object.create` on DOM elements
                    // is...err...probably inappropriate, but the native version allows for it.
                    throw new TypeError('Object prototype may only be an Object or null'); // same msg as Chrome
                }
                Type.prototype = prototype;
                object = new Type();
                // IE has no built-in implementation of `Object.getPrototypeOf`
                // neither `__proto__`, but this manually setting `__proto__` will
                // guarantee that `Object.getPrototypeOf` will work as expected with
                // objects created using `Object.create`
                // eslint-disable-next-line no-proto
                object.__proto__ = prototype;
            }

            if (properties !== void 0) {
                Object.defineProperties(object, properties);
            }

            return object;
        };
    }

    // ES5 15.2.3.6
    // http://es5.github.com/#x15.2.3.6

    // Patch for WebKit and IE8 standard mode
    // Designed by hax <hax.github.com>
    // related issue: https://github.com/es-shims/es5-shim/issues#issue/5
    // IE8 Reference:
    //     http://msdn.microsoft.com/en-us/library/dd282900.aspx
    //     http://msdn.microsoft.com/en-us/library/dd229916.aspx
    // WebKit Bugs:
    //     https://bugs.webkit.org/show_bug.cgi?id=36423

    var doesDefinePropertyWork = function doesDefinePropertyWork(object) {
        try {
            Object.defineProperty(object, 'sentinel', {});
            return 'sentinel' in object;
        } catch (exception) {
            return false;
        }
    };

    // check whether defineProperty works if it's given. Otherwise,
    // shim partially.
    if (Object.defineProperty) {
        var definePropertyWorksOnObject = doesDefinePropertyWork({});
        var definePropertyWorksOnDom = typeof document === 'undefined' ||
            doesDefinePropertyWork(document.createElement('div'));
        if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) {
            var definePropertyFallback = Object.defineProperty,
                definePropertiesFallback = Object.defineProperties;
        }
    }

    if (!Object.defineProperty || definePropertyFallback) {
        var ERR_NON_OBJECT_DESCRIPTOR = 'Property description must be an object: ';
        var ERR_NON_OBJECT_TARGET = 'Object.defineProperty called on non-object: ';
        var ERR_ACCESSORS_NOT_SUPPORTED = 'getters & setters can not be defined on this javascript engine';

        Object.defineProperty = function defineProperty(object, property, descriptor) {
            if (isPrimitive(object)) {
                throw new TypeError(ERR_NON_OBJECT_TARGET + object);
            }
            if (isPrimitive(descriptor)) {
                throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);
            }
            // make a valiant attempt to use the real defineProperty
            // for I8's DOM elements.
            if (definePropertyFallback) {
                try {
                    return definePropertyFallback.call(Object, object, property, descriptor);
                } catch (exception) {
                    // try the shim if the real one doesn't work
                }
            }

            // If it's a data property.
            if ('value' in descriptor) {
                // fail silently if 'writable', 'enumerable', or 'configurable'
                // are requested but not supported
                /*
                 // alternate approach:
                 if ( // can't implement these features; allow false but not true
                 ('writable' in descriptor && !descriptor.writable) ||
                 ('enumerable' in descriptor && !descriptor.enumerable) ||
                 ('configurable' in descriptor && !descriptor.configurable)
                 ))
                 throw new RangeError(
                 'This implementation of Object.defineProperty does not support configurable, enumerable, or writable.'
                 );
                 */

                if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {
                    // As accessors are supported only on engines implementing
                    // `__proto__` we can safely override `__proto__` while defining
                    // a property to make sure that we don't hit an inherited
                    // accessor.
                    /* eslint-disable no-proto */
                    var prototype = object.__proto__;
                    object.__proto__ = prototypeOfObject;
                    // Deleting a property anyway since getter / setter may be
                    // defined on object itself.
                    delete object[property];
                    object[property] = descriptor.value;
                    // Setting original `__proto__` back now.
                    object.__proto__ = prototype;
                    /* eslint-enable no-proto */
                } else {
                    object[property] = descriptor.value;
                }
            } else {
                var hasGetter = 'get' in descriptor;
                var hasSetter = 'set' in descriptor;
                if (!supportsAccessors && (hasGetter || hasSetter)) {
                    throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);
                }
                // If we got that far then getters and setters can be defined !!
                if (hasGetter) {
                    defineGetter(object, property, descriptor.get);
                }
                if (hasSetter) {
                    defineSetter(object, property, descriptor.set);
                }
            }
            return object;
        };
    }

    // ES5 15.2.3.7
    // http://es5.github.com/#x15.2.3.7
    if (!Object.defineProperties || definePropertiesFallback) {
        Object.defineProperties = function defineProperties(object, properties) {
            // make a valiant attempt to use the real defineProperties
            if (definePropertiesFallback) {
                try {
                    return definePropertiesFallback.call(Object, object, properties);
                } catch (exception) {
                    // try the shim if the real one doesn't work
                }
            }

            Object.keys(properties).forEach(function (property) {
                if (property !== '__proto__') {
                    Object.defineProperty(object, property, properties[property]);
                }
            });
            return object;
        };
    }

    // ES5 15.2.3.8
    // http://es5.github.com/#x15.2.3.8
    if (!Object.seal) {
        Object.seal = function seal(object) {
            if (Object(object) !== object) {
                throw new TypeError('Object.seal can only be called on Objects.');
            }
            // this is misleading and breaks feature-detection, but
            // allows "securable" code to "gracefully" degrade to working
            // but insecure code.
            return object;
        };
    }

    // ES5 15.2.3.9
    // http://es5.github.com/#x15.2.3.9
    if (!Object.freeze) {
        Object.freeze = function freeze(object) {
            if (Object(object) !== object) {
                throw new TypeError('Object.freeze can only be called on Objects.');
            }
            // this is misleading and breaks feature-detection, but
            // allows "securable" code to "gracefully" degrade to working
            // but insecure code.
            return object;
        };
    }

    // detect a Rhino bug and patch it
    try {
        Object.freeze(function () {});
    } catch (exception) {
        Object.freeze = (function (freezeObject) {
            return function freeze(object) {
                if (typeof object === 'function') {
                    return object;
                } else {
                    return freezeObject(object);
                }
            };
        }(Object.freeze));
    }

    // ES5 15.2.3.10
    // http://es5.github.com/#x15.2.3.10
    if (!Object.preventExtensions) {
        Object.preventExtensions = function preventExtensions(object) {
            if (Object(object) !== object) {
                throw new TypeError('Object.preventExtensions can only be called on Objects.');
            }
            // this is misleading and breaks feature-detection, but
            // allows "securable" code to "gracefully" degrade to working
            // but insecure code.
            return object;
        };
    }

    // ES5 15.2.3.11
    // http://es5.github.com/#x15.2.3.11
    if (!Object.isSealed) {
        Object.isSealed = function isSealed(object) {
            if (Object(object) !== object) {
                throw new TypeError('Object.isSealed can only be called on Objects.');
            }
            return false;
        };
    }

    // ES5 15.2.3.12
    // http://es5.github.com/#x15.2.3.12
    if (!Object.isFrozen) {
        Object.isFrozen = function isFrozen(object) {
            if (Object(object) !== object) {
                throw new TypeError('Object.isFrozen can only be called on Objects.');
            }
            return false;
        };
    }

    // ES5 15.2.3.13
    // http://es5.github.com/#x15.2.3.13
    if (!Object.isExtensible) {
        Object.isExtensible = function isExtensible(object) {
            // 1. If Type(O) is not Object throw a TypeError exception.
            if (Object(object) !== object) {
                throw new TypeError('Object.isExtensible can only be called on Objects.');
            }
            // 2. Return the Boolean value of the [[Extensible]] internal property of O.
            var name = '';
            while (owns(object, name)) {
                name += '?';
            }
            object[name] = true;
            var returnValue = owns(object, name);
            delete object[name];
            return returnValue;
        };
    }

}));

(function(){

    if (!window.Element) {
        Element = function() {};

        Element.prototype.matches = function(el, selector){
            var parent = el.parentNode
            var match = query(selector, parent)
            var len = match.length

            if (parent) {
                if (len) {
                    while (len--) {
                        if (match[len] == el) {
                            return true
                        }
                    }
                    return false
                } else {
                    return false
                }
            } else {
                var parent = document.createElement('div')
                parent.appendChild(el)
                match = query(selector, parent)
                parent.removeChild(el)
                return !!match.length
            }
        }
    }

    if(!window.CSSStyleDeclaration){
        window.CSSStyleDeclaration = function(){};

        CSSStyleDeclaration.prototype.getProperty = function(a) {
            return this.getAttribute(a);
        };

        CSSStyleDeclaration.prototype.setProperty = function(a,b) {
            return this.setAttribute(a,b);
        };

        CSSStyleDeclaration.prototype.removeProperty = function(a) {
            return this.removeAttribute(a);
        };
    }
}());
/*
 * heatmap.js v2.0.5 | JavaScript Heatmap Library
 *
 * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.
 * Dual licensed under MIT and Beerware license
 *
 * :: 2016-09-05 01:16
 */
;(function (name, context, factory) {

    // Supports UMD. AMD, CommonJS/Node.js and browser context
    if (typeof module !== "undefined" && module.exports) {
        module.exports = factory();
    } else if (typeof define === "function" && define.amd) {
        define(factory);
    } else {
        context[name] = factory();
    }

})("h337", this, function () {

// Heatmap Config stores default values and will be merged with instance config
    var HeatmapConfig = {
        defaultRadius: 40,
        defaultRenderer: 'canvas2d',
        defaultGradient: { 0.25: "rgb(0,0,255)", 0.55: "rgb(0,255,0)", 0.85: "yellow", 1.0: "rgb(255,0,0)"},
        defaultMaxOpacity: 1,
        defaultMinOpacity: 0,
        defaultBlur: .85,
        defaultXField: 'x',
        defaultYField: 'y',
        defaultValueField: 'value',
        plugins: {}
    };
    var Store = (function StoreClosure() {

        var Store = function Store(config) {
            this._coordinator = {};
            this._data = [];
            this._radi = [];
            this._min = 10;
            this._max = 1;
            this._xField = config['xField'] || config.defaultXField;
            this._yField = config['yField'] || config.defaultYField;
            this._valueField = config['valueField'] || config.defaultValueField;

            if (config["radius"]) {
                this._cfgRadius = config["radius"];
            }
        };

        var defaultRadius = HeatmapConfig.defaultRadius;

        Store.prototype = {
            // when forceRender = false -> called from setData, omits renderall event
            _organiseData: function(dataPoint, forceRender) {
                var x = dataPoint[this._xField];
                var y = dataPoint[this._yField];
                var radi = this._radi;
                var store = this._data;
                var max = this._max;
                var min = this._min;
                var value = dataPoint[this._valueField] || 1;
                var radius = dataPoint.radius || this._cfgRadius || defaultRadius;

                if (!store[x]) {
                    store[x] = [];
                    radi[x] = [];
                }

                if (!store[x][y]) {
                    store[x][y] = value;
                    radi[x][y] = radius;
                } else {
                    store[x][y] += value;
                }
                var storedVal = store[x][y];

                if (storedVal > max) {
                    if (!forceRender) {
                        this._max = storedVal;
                    } else {
                        this.setDataMax(storedVal);
                    }
                    return false;
                } else if (storedVal < min) {
                    if (!forceRender) {
                        this._min = storedVal;
                    } else {
                        this.setDataMin(storedVal);
                    }
                    return false;
                } else {
                    return {
                        x: x,
                        y: y,
                        value: value,
                        radius: radius,
                        min: min,
                        max: max
                    };
                }
            },
            _unOrganizeData: function() {
                var unorganizedData = [];
                var data = this._data;
                var radi = this._radi;

                for (var x in data) {
                    for (var y in data[x]) {

                        unorganizedData.push({
                            x: x,
                            y: y,
                            radius: radi[x][y],
                            value: data[x][y]
                        });

                    }
                }
                return {
                    min: this._min,
                    max: this._max,
                    data: unorganizedData
                };
            },
            _onExtremaChange: function() {
                this._coordinator.emit('extremachange', {
                    min: this._min,
                    max: this._max
                });
            },
            addData: function() {
                if (arguments[0].length > 0) {
                    var dataArr = arguments[0];
                    var dataLen = dataArr.length;
                    while (dataLen--) {
                        this.addData.call(this, dataArr[dataLen]);
                    }
                } else {
                    // add to store
                    var organisedEntry = this._organiseData(arguments[0], true);
                    if (organisedEntry) {
                        // if it's the first datapoint initialize the extremas with it
                        if (this._data.length === 0) {
                            this._min = this._max = organisedEntry.value;
                        }
                        this._coordinator.emit('renderpartial', {
                            min: this._min,
                            max: this._max,
                            data: [organisedEntry]
                        });
                    }
                }
                return this;
            },
            setData: function(data) {
                var dataPoints = data.data;
                var pointsLen = dataPoints.length;


                // reset data arrays
                this._data = [];
                this._radi = [];

                for(var i = 0; i < pointsLen; i++) {
                    this._organiseData(dataPoints[i], false);
                }
                this._max = data.max;
                this._min = data.min || 0;

                this._onExtremaChange();
                this._coordinator.emit('renderall', this._getInternalData());
                return this;
            },
            removeData: function() {
                // TODO: implement
            },
            setDataMax: function(max) {
                this._max = max;
                this._onExtremaChange();
                this._coordinator.emit('renderall', this._getInternalData());
                return this;
            },
            setDataMin: function(min) {
                this._min = min;
                this._onExtremaChange();
                this._coordinator.emit('renderall', this._getInternalData());
                return this;
            },
            setCoordinator: function(coordinator) {
                this._coordinator = coordinator;
            },
            _getInternalData: function() {
                return {
                    max: this._max,
                    min: this._min,
                    data: this._data,
                    radi: this._radi
                };
            },
            getData: function() {
                return this._unOrganizeData();
            }/*,

             TODO: rethink.

             getValueAt: function(point) {
             var value;
             var radius = 100;
             var x = point.x;
             var y = point.y;
             var data = this._data;

             if (data[x] && data[x][y]) {
             return data[x][y];
             } else {
             var values = [];
             // radial search for datapoints based on default radius
             for(var distance = 1; distance < radius; distance++) {
             var neighbors = distance * 2 +1;
             var startX = x - distance;
             var startY = y - distance;

             for(var i = 0; i < neighbors; i++) {
             for (var o = 0; o < neighbors; o++) {
             if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {
             if (data[startY+i] && data[startY+i][startX+o]) {
             values.push(data[startY+i][startX+o]);
             }
             } else {
             continue;
             }
             }
             }
             }
             if (values.length > 0) {
             return Math.max.apply(Math, values);
             }
             }
             return false;
             }*/
        };


        return Store;
    })();

    var Canvas2dRenderer = (function Canvas2dRendererClosure() {

        var _getColorPalette = function(config) {
            var gradientConfig = config.gradient || config.defaultGradient;
            var paletteCanvas = document.createElement('canvas');

            if(paletteCanvas.getContext){
                var paletteCtx = paletteCanvas.getContext('2d');

                paletteCanvas.width = 256;
                paletteCanvas.height = 1;

                var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);
                for (var key in gradientConfig) {
                    gradient.addColorStop(key, gradientConfig[key]);
                }

                paletteCtx.fillStyle = gradient;
                paletteCtx.fillRect(0, 0, 256, 1);

                return paletteCtx.getImageData(0, 0, 256, 1).data;
            }

            return {};
        };

        var _getPointTemplate = function(radius, blurFactor) {
            var tplCanvas = document.createElement('canvas');
            var tplCtx = tplCanvas.getContext('2d');
            var x = radius;
            var y = radius;
            tplCanvas.width = tplCanvas.height = radius*2;

            if (blurFactor === 1) {
                tplCtx.beginPath();
                tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);
                tplCtx.fillStyle = 'rgba(0,0,0,1)';
                tplCtx.fill();
            } else {
                var gradient = tplCtx.createRadialGradient(x, y, radius*blurFactor, x, y, radius);
                gradient.addColorStop(0, 'rgba(0,0,0,1)');
                gradient.addColorStop(1, 'rgba(0,0,0,0)');
                tplCtx.fillStyle = gradient;
                tplCtx.fillRect(0, 0, 2*radius, 2*radius);
            }

            return tplCanvas;
        };

        var _prepareData = function(data) {
            var renderData = [];
            var min = data.min;
            var max = data.max;
            var radi = data.radi;
            var data = data.data;

            var xValues = Object.keys(data);
            var xValuesLen = xValues.length;

            while(xValuesLen--) {
                var xValue = xValues[xValuesLen];
                var yValues = Object.keys(data[xValue]);
                var yValuesLen = yValues.length;
                while(yValuesLen--) {
                    var yValue = yValues[yValuesLen];
                    var value = data[xValue][yValue];
                    var radius = radi[xValue][yValue];
                    renderData.push({
                        x: xValue,
                        y: yValue,
                        value: value,
                        radius: radius
                    });
                }
            }

            return {
                min: min,
                max: max,
                data: renderData
            };
        };


        function Canvas2dRenderer(config) {
            var container = config.container;
            var shadowCanvas = this.shadowCanvas = document.createElement('canvas');
            var canvas = this.canvas = config.canvas || document.createElement('canvas');

            //excanvas
            window.G_vmlCanvasManager && G_vmlCanvasManager.initElement(canvas);
            window.G_vmlCanvasManager && G_vmlCanvasManager.initElement(shadowCanvas);

            var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];

            var computed = config.container.currentStyle || getComputedStyle(config.container) || {};

            canvas.className = 'heatmap-canvas';

            this._width = canvas.width = shadowCanvas.width = config.width || +(computed.width.replace(/px/,''));
            this._height = canvas.height = shadowCanvas.height = config.height || +(computed.height.replace(/px/,''));

            this.shadowCtx = shadowCanvas.getContext('2d');
            this.ctx = canvas.getContext('2d');

            // @TODO:
            // conditional wrapper

            canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';

            container.style.position = 'relative';
            container.appendChild(canvas);

            this._palette = _getColorPalette(config);
            this._templates = {};

            this._setStyles(config);
        };

        Canvas2dRenderer.prototype = {
            renderPartial: function(data) {
                if (data.data.length > 0) {
                    if(this.ctx.getImageData){
                        this._drawAlpha(data);
                        this._colorize();
                    }else{
                        this._drawPoints(data);
                    }
                }
            },
            renderAll: function(data) {
                // reset render boundaries
                this._clear();
                if (data.data.length > 0) {
                    var data = _prepareData(data);
                    if(this.ctx.getImageData){
                        this._drawAlpha(data);
                        this._colorize();
                    }else{
                        this._drawPoints(data);
                    }
                }
            },

            _drawPoints:function(data){
                var min = this._min = data.min, max = this._max = data.max;
                var data = data.data || [], dataLen = data.length;
                var blur = 1 - this._blur, ctx = this.ctx;
                while(dataLen--) {
                    var point = data[dataLen], radius = +point.radius;
                    var value = Math.min(point.value, max);
                    var x = +point.x, y = +point.y;

                    var templateAlpha = (value-min)/(max-min);
                    templateAlpha = isNaN(templateAlpha) ? 1 : templateAlpha;

                    ctx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;

                    var gradient = ctx.createRadialGradient(x, y, radius*blur, x, y, radius);

                    var gradientConfig = this._gradientConfig;
                    for (var key in gradientConfig) {
                        gradient.addColorStop(+key, gradientConfig[key]);
                    }

                    ctx.fillStyle = gradient;

                    ctx.beginPath();

                    ctx.moveTo(x, y);

                    ctx.arc(x, y, radius, 0, Math.PI * 2, false);

                    ctx.fill();
                }
            },

            _updateGradient: function(config) {
                this._palette = _getColorPalette(config);
            },
            updateConfig: function(config) {
                if (config['gradient']) {
                    this._updateGradient(config);
                }
                this._setStyles(config);
            },
            setDimensions: function(width, height) {
                this._width = width;
                this._height = height;
                this.canvas.width = this.shadowCanvas.width = width;
                this.canvas.height = this.shadowCanvas.height = height;
            },
            _clear: function() {
                this.shadowCtx.clearRect(0, 0, this._width, this._height);
                this.ctx.clearRect(0, 0, this._width, this._height);
            },
            _setStyles: function(config) {
                this._blur = (config.blur === 0)?0:(config.blur || config.defaultBlur);

                this._gradientConfig = config.gradient || config.defaultGradient;

                if (config.backgroundColor) {
                    this.canvas.style.backgroundColor = config.backgroundColor;
                }

                this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;
                this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;


                this._opacity = (config.opacity || 0) * 255;
                this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;
                this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;
                this._useGradientOpacity = !!config.useGradientOpacity;
            },
            _drawAlpha: function(data) {
                var min = this._min = data.min;
                var max = this._max = data.max;
                var data = data.data || [];
                var dataLen = data.length;
                // on a point basis?
                var blur = 1 - this._blur;

                while(dataLen--) {

                    var point = data[dataLen];

                    var x = point.x;
                    var y = point.y;
                    var radius = point.radius;
                    // if value is bigger than max
                    // use max as value
                    var value = Math.min(point.value, max);
                    var rectX = x - radius;
                    var rectY = y - radius;
                    var shadowCtx = this.shadowCtx;

                    var tpl;
                    if (!this._templates[radius]) {
                        this._templates[radius] = tpl = _getPointTemplate(radius, blur);
                    } else {
                        tpl = this._templates[radius];
                    }
                    // value from minimum / value range
                    // => [0, 1]
                    var templateAlpha = (value-min)/(max-min);
                    // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData
                    shadowCtx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;

                    shadowCtx.drawImage(tpl, rectX, rectY);

                    // update renderBoundaries
                    if (rectX < this._renderBoundaries[0]) {
                        this._renderBoundaries[0] = rectX;
                    }
                    if (rectY < this._renderBoundaries[1]) {
                        this._renderBoundaries[1] = rectY;
                    }
                    if (rectX + 2*radius > this._renderBoundaries[2]) {
                        this._renderBoundaries[2] = rectX + 2*radius;
                    }
                    if (rectY + 2*radius > this._renderBoundaries[3]) {
                        this._renderBoundaries[3] = rectY + 2*radius;
                    }
                }
            },
            _colorize: function() {
                var x = this._renderBoundaries[0];
                var y = this._renderBoundaries[1];
                var width = this._renderBoundaries[2] - x;
                var height = this._renderBoundaries[3] - y;
                var maxWidth = this._width;
                var maxHeight = this._height;
                var opacity = this._opacity;
                var maxOpacity = this._maxOpacity;
                var minOpacity = this._minOpacity;
                var useGradientOpacity = this._useGradientOpacity;

                if (x < 0) {
                    x = 0;
                }
                if (y < 0) {
                    y = 0;
                }
                if (x + width > maxWidth) {
                    width = maxWidth - x;
                }
                if (y + height > maxHeight) {
                    height = maxHeight - y;
                }

                var img = this.shadowCtx.getImageData(x, y, width, height);
                var imgData = img.data;
                var len = imgData.length;
                var palette = this._palette;


                for (var i = 3; i < len; i+= 4) {
                    var alpha = imgData[i];
                    var offset = alpha * 4;


                    if (!offset) {
                        continue;
                    }

                    var finalAlpha;
                    if (opacity > 0) {
                        finalAlpha = opacity;
                    } else {
                        if (alpha < maxOpacity) {
                            if (alpha < minOpacity) {
                                finalAlpha = minOpacity;
                            } else {
                                finalAlpha = alpha;
                            }
                        } else {
                            finalAlpha = maxOpacity;
                        }
                    }

                    imgData[i-3] = palette[offset];
                    imgData[i-2] = palette[offset + 1];
                    imgData[i-1] = palette[offset + 2];
                    imgData[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;

                }

                img.data = imgData;
                this.ctx.putImageData(img, x, y);

                this._renderBoundaries = [1000, 1000, 0, 0];

            },
            getValueAt: function(point) {
                var value;
                var shadowCtx = this.shadowCtx;
                var img = shadowCtx.getImageData(point.x, point.y, 1, 1);
                var data = img.data[3];
                var max = this._max;
                var min = this._min;

                value = (Math.abs(max-min) * (data/255)) >> 0;

                return value;
            },
            getDataURL: function() {
                return this.canvas.toDataURL();
            }
        };


        return Canvas2dRenderer;
    })();


    var Renderer = (function RendererClosure() {

        var rendererFn = false;

        if (HeatmapConfig['defaultRenderer'] === 'canvas2d') {
            rendererFn = Canvas2dRenderer;
        }

        return rendererFn;
    })();


    var Util = {
        merge: function() {
            var merged = {};
            var argsLen = arguments.length;
            for (var i = 0; i < argsLen; i++) {
                var obj = arguments[i]
                for (var key in obj) {
                    merged[key] = obj[key];
                }
            }
            return merged;
        }
    };
// Heatmap Constructor
    var Heatmap = (function HeatmapClosure() {

        var Coordinator = (function CoordinatorClosure() {

            function Coordinator() {
                this.cStore = {};
            };

            Coordinator.prototype = {
                on: function(evtName, callback, scope) {
                    var cStore = this.cStore;

                    if (!cStore[evtName]) {
                        cStore[evtName] = [];
                    }
                    cStore[evtName].push((function(data) {
                        return callback.call(scope, data);
                    }));
                },
                emit: function(evtName, data) {
                    var cStore = this.cStore;
                    if (cStore[evtName]) {
                        var len = cStore[evtName].length;
                        for (var i=0; i<len; i++) {
                            var callback = cStore[evtName][i];
                            callback(data);
                        }
                    }
                }
            };

            return Coordinator;
        })();


        var _connect = function(scope) {
            var renderer = scope._renderer;
            var coordinator = scope._coordinator;
            var store = scope._store;

            coordinator.on('renderpartial', renderer.renderPartial, renderer);
            coordinator.on('renderall', renderer.renderAll, renderer);
            coordinator.on('extremachange', function(data) {
                scope._config.onExtremaChange &&
                scope._config.onExtremaChange({
                    min: data.min,
                    max: data.max,
                    gradient: scope._config['gradient'] || scope._config['defaultGradient']
                });
            });
            store.setCoordinator(coordinator);
        };


        function Heatmap() {
            var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});
            this._coordinator = new Coordinator();
            if (config['plugin']) {
                var pluginToLoad = config['plugin'];
                if (!HeatmapConfig.plugins[pluginToLoad]) {
                    throw new Error('Plugin \''+ pluginToLoad + '\' not found. Maybe it was not registered.');
                } else {
                    var plugin = HeatmapConfig.plugins[pluginToLoad];
                    // set plugin renderer and store
                    this._renderer = new plugin.renderer(config);
                    this._store = new plugin.store(config);
                }
            } else {
                this._renderer = new Renderer(config);
                this._store = new Store(config);
            }
            _connect(this);
        };

        // @TODO:
        // add API documentation
        Heatmap.prototype = {
            addData: function() {
                this._store.addData.apply(this._store, arguments);
                return this;
            },
            removeData: function() {
                this._store.removeData && this._store.removeData.apply(this._store, arguments);
                return this;
            },
            setData: function() {
                this._store.setData.apply(this._store, arguments);
                return this;
            },
            setDataMax: function() {
                this._store.setDataMax.apply(this._store, arguments);
                return this;
            },
            setDataMin: function() {
                this._store.setDataMin.apply(this._store, arguments);
                return this;
            },
            configure: function(config) {
                this._config = Util.merge(this._config, config);
                this._renderer.updateConfig(this._config);
                this._coordinator.emit('renderall', this._store._getInternalData());
                return this;
            },
            repaint: function() {
                this._coordinator.emit('renderall', this._store._getInternalData());
                return this;
            },
            getData: function() {
                return this._store.getData();
            },
            getDataURL: function() {
                return this._renderer.getDataURL();
            },
            getValueAt: function(point) {

                if (this._store.getValueAt) {
                    return this._store.getValueAt(point);
                } else  if (this._renderer.getValueAt) {
                    return this._renderer.getValueAt(point);
                } else {
                    return null;
                }
            }
        };

        return Heatmap;

    })();


// core
    var heatmapFactory = {
        create: function(config) {
            return new Heatmap(config);
        },
        register: function(pluginKey, plugin) {
            HeatmapConfig.plugins[pluginKey] = plugin;
        }
    };

    return heatmapFactory;
});

/*
 Leaflet 1.0.0-rc.1 (6ea195a), a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2015 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */
(function (window, document, undefined) {
    var L = {
        version: '1.0.0-rc.1'
    };

    function expose() {
        var oldL = window.L;

        L.noConflict = function () {
            window.L = oldL;
            return this;
        };

        window.L = L;
    }

// define Leaflet for Node module pattern loaders, including Browserify
    if (typeof module === 'object' && typeof module.exports === 'object') {
        module.exports = L;

// define Leaflet as an AMD module
    } else if (typeof define === 'function' && define.amd) {
        define(L);
    }

// define Leaflet as a global L variable, saving the original L to restore later if needed
    if (typeof window !== 'undefined') {
        expose();
    }



    /*
     * @namespace Util
     *
     * Various utility functions, used by Leaflet internally.
     */

    L.Util = {

        // @function extend(dest: Object, src?: Object): Object
        // Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.
        extend: function (dest) {
            var i, j, len, src;

            for (j = 1, len = arguments.length; j < len; j++) {
                src = arguments[j];
                for (i in src) {
                    dest[i] = src[i];
                }
            }
            return dest;
        },

        // @function create(proto: Object, properties?: Object): Object
        // Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)
        create: Object.create || (function () {
            function F() {}
            return function (proto) {
                F.prototype = proto;
                return new F();
            };
        })(),

        // @function bind(fn: Function, ): Function
        // Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).
        // Has a `L.bind()` shortcut.
        bind: function (fn, obj) {
            var slice = Array.prototype.slice;

            if (fn.bind) {
                return fn.bind.apply(fn, slice.call(arguments, 1));
            }

            var args = slice.call(arguments, 2);

            return function () {
                return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);
            };
        },

        // @function stamp(obj: Object): Number
        // Returns the unique ID of an object, assiging it one if it doesn't have it.
        stamp: function (obj) {
            /*eslint-disable */
            obj._leaflet_id = obj._leaflet_id || ++L.Util.lastId;
            return obj._leaflet_id;
            /*eslint-enable */
        },

        // @property lastId: Number
        // Last unique ID used by [`stamp()`](#util-stamp)
        lastId: 0,

        // @function throttle(fn: Function, time: Number, context: Object): Function
        // Returns a function which executes function `fn` with the given scope `context`
        // (so that the `this` keyword refers to `context` inside `fn`'s code). The arguments received by the bound function will be any arguments passed when binding the function, followed by any arguments passed when invoking the bound function. Has an `L.bind` shortcut.
        throttle: function (fn, time, context) {
            var lock, args, wrapperFn, later;

            later = function () {
                // reset lock and call if queued
                lock = false;
                if (args) {
                    wrapperFn.apply(context, args);
                    args = false;
                }
            };

            wrapperFn = function () {
                if (lock) {
                    // called too soon, queue to call later
                    args = arguments;

                } else {
                    // call and lock until later
                    fn.apply(context, arguments);
                    setTimeout(later, time);
                    lock = true;
                }
            };

            return wrapperFn;
        },

        // @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number
        // Returns the number `num` modulo `range` in such a way so it lies within
        // `range[0]` and `range[1]`. The returned value will be always smaller than
        // `range[1]` unless `includeMax` is set to `true`.
        wrapNum: function (x, range, includeMax) {
            var max = range[1],
                min = range[0],
                d = max - min;
            return x === max && includeMax ? x : ((x - min) % d + d) % d + min;
        },

        // @function falseFn(): Function
        // Returns a function which always returns `false`.
        falseFn: function () { return false; },

        // @function formatNum(num: Number, digits?: Number): Number
        // Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.
        formatNum: function (num, digits) {
            var pow = Math.pow(10, digits || 5);
            return Math.round(num * pow) / pow;
        },

        // @function trim(str: String): String
        // Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)
        trim: function (str) {
            return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');
        },

        // @function splitWords(str: String): String[]
        // Trims and splits the string on whitespace and returns the array of parts.
        splitWords: function (str) {
            return L.Util.trim(str).split(/\s+/);
        },

        // @function setOptions(obj: Object: options: Object): Object
        // Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.
        setOptions: function (obj, options) {
            if (!obj.hasOwnProperty('options')) {
                obj.options = obj.options ? L.Util.create(obj.options) : {};
            }
            for (var i in options) {
                obj.options[i] = options[i];
            }
            return obj.options;
        },

        // @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String
        // Converts an object into a parameter URL string, e.g. `{a: "foo", b: "bar"}`
        // translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will
        // be appended at the end. If `uppercase` is `true`, the parameter names will
        // be uppercased (e.g. `'?A=foo&B=bar'`)
        getParamString: function (obj, existingUrl, uppercase) {
            var params = [];
            for (var i in obj) {
                params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));
            }
            return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');
        },

        // @template (str: String, data: Object)
        // Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`
        // and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string
        // `('Hello foo, bar')`. You can also specify functions instead of strings for
        // data values  they will be evaluated passing `data` as an argument.
        template: function (str, data) {
            return str.replace(L.Util.templateRe, function (str, key) {
                var value = data[key];

                if (value === undefined) {
                    throw new Error('No value provided for variable ' + str);

                } else if (typeof value === 'function') {
                    value = value(data);
                }
                return value;
            });
        },

        templateRe: /\{ *([\w_\-]+) *\}/g,

        // @function isArray(obj): Boolean
        // Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)
        isArray: Array.isArray || function (obj) {
            return (Object.prototype.toString.call(obj) === '[object Array]');
        },

        // @function indexOf: Number
        // Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)
        indexOf: function (array, el) {
            for (var i = 0; i < array.length; i++) {
                if (array[i] === el) { return i; }
            }
            return -1;
        },

        // @property emptyImageUrl: String
        // Data URI string containing a base64-encoded empty GIF image.
        // Used as a hack to free memory from unused images on WebKit-powered
        // mobile devices (by setting image `src` to this string).
        emptyImageUrl: 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='
    };

    (function () {
        // inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/

        function getPrefixed(name) {
            return window['webkit' + name] || window['moz' + name] || window['ms' + name];
        }

        var lastTime = 0;

        // fallback for IE 7-8
        function timeoutDefer(fn) {
            var time = +new Date(),
                timeToCall = Math.max(0, 16 - (time - lastTime));

            lastTime = time + timeToCall;
            return window.setTimeout(fn, timeToCall);
        }

        var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer,
            cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||
                getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };


        // @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): requestId: Number
        // Schedules `fn` to be executed when the browser repaints. `fn` is bound to
        // `context` if given. When `immediate` is set, `fn` is called immediately if
        // the browser doesn't have native support for
        // [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),
        // otherwise it's delayed. Returns an id that can be used to cancel the request.
        L.Util.requestAnimFrame = function (fn, context, immediate) {
            if (immediate && requestFn === timeoutDefer) {
                fn.call(context);
            } else {
                return requestFn.call(window, L.bind(fn, context));
            }
        };

        // @function cancelAnimFrame(id: Number)
        // Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).
        L.Util.cancelAnimFrame = function (id) {
            if (id) {
                cancelFn.call(window, id);
            }
        };
    })();

// shortcuts for most used utility functions
    L.extend = L.Util.extend;
    L.bind = L.Util.bind;
    L.stamp = L.Util.stamp;
    L.setOptions = L.Util.setOptions;




// @class Class
// @aka L.Class

// @section
// @uninheritable

// Thanks to John Resig and Dean Edwards for inspiration!

    L.Class = function () {};

    L.Class.extend = function (props) {

        // @function extend(props: Object): Function
        // [Extends the current class](#class-inheritance) given the properties to be included.
        // Returns a Javascript function that is a class constructor (to be called with `new`).
        var NewClass = function () {

            // call the constructor
            if (this.initialize) {
                this.initialize.apply(this, arguments);
            }

            // call all constructor hooks
            this.callInitHooks();
        };

        var parentProto = NewClass.__super__ = this.prototype;

        var proto = L.Util.create(parentProto);
        proto.constructor = NewClass;

        NewClass.prototype = proto;

        // inherit parent's statics
        for (var i in this) {
            if (this.hasOwnProperty(i) && i !== 'prototype') {
                NewClass[i] = this[i];
            }
        }

        // mix static properties into the class
        if (props.statics) {
            L.extend(NewClass, props.statics);
            delete props.statics;
        }

        // mix includes into the prototype
        if (props.includes) {
            L.Util.extend.apply(null, [proto].concat(props.includes));
            delete props.includes;
        }

        // merge options
        if (proto.options) {
            props.options = L.Util.extend(L.Util.create(proto.options), props.options);
        }

        // mix given properties into the prototype
        L.extend(proto, props);

        proto._initHooks = [];

        // add method for calling all hooks
        proto.callInitHooks = function () {

            if (this._initHooksCalled) { return; }

            if (parentProto.callInitHooks) {
                parentProto.callInitHooks.call(this);
            }

            this._initHooksCalled = true;

            for (var i = 0, len = proto._initHooks.length; i < len; i++) {
                proto._initHooks[i].call(this);
            }
        };

        return NewClass;
    };


// @function include(properties: Object)
// [Includes a mixin](#class-includes) into the current class.
    L.Class.include = function (props) {
        L.extend(this.prototype, props);
        return this;
    };

// @function mergeOptions(options: Object)
// [Merges `options`](#class-options) into the defaults of the class.
    L.Class.mergeOptions = function (options) {
        L.extend(this.prototype.options, options);
        return this;
    };

// @function addInitHook(fn: Function)
// Adds a [constructor hook](#class-constructor-hooks) to the class.
    L.Class.addInitHook = function (fn) { // (Function) || (String, args...)
        var args = Array.prototype.slice.call(arguments, 1);

        var init = typeof fn === 'function' ? fn : function () {
            this[fn].apply(this, args);
        };

        this.prototype._initHooks = this.prototype._initHooks || [];
        this.prototype._initHooks.push(init);
        return this;
    };



    /*
     * @class Evented
     * @aka L.Evented
     * @inherits Class
     *
     * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).
     *
     * @example
     *
     * ```js
     * map.on('click', function(e) {
     * 	alert(e.latlng);
     * } );
     * ```
     *
     * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:
     *
     * ```js
     * function onClick(e) { ... }
     *
     * map.on('click', onClick);
     * map.off('click', onClick);
     * ```
     */


    L.Evented = L.Class.extend({

        /* @method on(type: String, fn: Function, context?: Object): this
         * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).
         *
         * @alternative
         * @method on(eventMap: Object): this
         * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`
         */
        on: function (types, fn, context) {

            // types can be a map of types/handlers
            if (typeof types === 'object') {
                for (var type in types) {
                    // we don't process space-separated events here for performance;
                    // it's a hot path since Layer uses the on(obj) syntax
                    this._on(type, types[type], fn);
                }

            } else {
                // types can be a string of space-separated words
                types = L.Util.splitWords(types);

                for (var i = 0, len = types.length; i < len; i++) {
                    this._on(types[i], fn, context);
                }
            }

            return this;
        },

        /* @method off(type: String, fn?: Function, context?: Object): this
         * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.
         *
         * @alternative
         * @method off(eventMap: Object): this
         * Removes a set of type/listener pairs.
         *
         * @alternative
         * @method off: this
         * Removes all listeners to all events on the object.
         */
        off: function (types, fn, context) {

            if (!types) {
                // clear all listeners if called without arguments
                delete this._events;

            } else if (typeof types === 'object') {
                for (var type in types) {
                    this._off(type, types[type], fn);
                }

            } else {
                types = L.Util.splitWords(types);

                for (var i = 0, len = types.length; i < len; i++) {
                    this._off(types[i], fn, context);
                }
            }

            return this;
        },

        // attach listener (without syntactic sugar now)
        _on: function (type, fn, context) {

            var events = this._events = this._events || {},
                contextId = context && context !== this && L.stamp(context);

            if (contextId) {
                // store listeners with custom context in a separate hash (if it has an id);
                // gives a major performance boost when firing and removing events (e.g. on map object)

                var indexKey = type + '_idx',
                    indexLenKey = type + '_len',
                    typeIndex = events[indexKey] = events[indexKey] || {},
                    id = L.stamp(fn) + '_' + contextId;

                if (!typeIndex[id]) {
                    typeIndex[id] = {fn: fn, ctx: context};

                    // keep track of the number of keys in the index to quickly check if it's empty
                    events[indexLenKey] = (events[indexLenKey] || 0) + 1;
                }

            } else {
                // individual layers mostly use "this" for context and don't fire listeners too often
                // so simple array makes the memory footprint better while not degrading performance

                events[type] = events[type] || [];
                events[type].push({fn: fn});
            }
        },

        _off: function (type, fn, context) {
            var events = this._events,
                indexKey = type + '_idx',
                indexLenKey = type + '_len';

            if (!events) { return; }

            if (!fn) {
                // clear all listeners for a type if function isn't specified
                delete events[type];
                delete events[indexKey];
                delete events[indexLenKey];
                return;
            }

            var contextId = context && context !== this && L.stamp(context),
                listeners, i, len, listener, id;

            if (contextId) {
                id = L.stamp(fn) + '_' + contextId;
                listeners = events[indexKey];

                if (listeners && listeners[id]) {
                    listener = listeners[id];
                    delete listeners[id];
                    events[indexLenKey]--;
                }

            } else {
                listeners = events[type];

                if (listeners) {
                    for (i = 0, len = listeners.length; i < len; i++) {
                        if (listeners[i].fn === fn) {
                            listener = listeners[i];
                            listeners.splice(i, 1);
                            break;
                        }
                    }
                }
            }

            // set the removed listener to noop so that's not called if remove happens in fire
            if (listener) {
                listener.fn = L.Util.falseFn;
            }
        },

        // @method fire(type: String, data?: Object, propagate?: Boolean): this
        // Fires an event of the specified type. You can optionally provide an data
        // object  the first argument of the listener function will contain its
        // properties. The event might can optionally be propagated to event parents.
        fire: function (type, data, propagate) {
            if (!this.listens(type, propagate)) { return this; }

            var event = L.Util.extend({}, data, {type: type, target: this}),
                events = this._events;

            if (events) {
                var typeIndex = events[type + '_idx'],
                    i, len, listeners, id;

                if (events[type]) {
                    // make sure adding/removing listeners inside other listeners won't cause infinite loop
                    listeners = events[type].slice();

                    for (i = 0, len = listeners.length; i < len; i++) {
                        listeners[i].fn.call(this, event);
                    }
                }

                // fire event for the context-indexed listeners as well
                for (id in typeIndex) {
                    typeIndex[id].fn.call(typeIndex[id].ctx, event);
                }
            }

            if (propagate) {
                // propagate the event to parents (set with addEventParent)
                this._propagateEvent(event);
            }

            return this;
        },

        // @method listens(type: String): Boolean
        // Returns `true` if a particular event type has any listeners attached to it.
        listens: function (type, propagate) {
            var events = this._events;

            if (events && (events[type] || events[type + '_len'])) { return true; }

            if (propagate) {
                // also check parents for listeners if event propagates
                for (var id in this._eventParents) {
                    if (this._eventParents[id].listens(type, propagate)) { return true; }
                }
            }
            return false;
        },

        // @method once(): this
        // Behaves as [`on()`](#evented-on), except the listener will only get fired once and then removed.
        once: function (types, fn, context) {

            if (typeof types === 'object') {
                for (var type in types) {
                    this.once(type, types[type], fn);
                }
                return this;
            }

            var handler = L.bind(function () {
                this
                    .off(types, fn, context)
                    .off(types, handler, context);
            }, this);

            // add a listener that's executed once and removed after that
            return this
                .on(types, fn, context)
                .on(types, handler, context);
        },

        // @method addEventParent(obj: Evented): this
        // Adds an event parent - an `Evented` that will receive propagated events
        addEventParent: function (obj) {
            this._eventParents = this._eventParents || {};
            this._eventParents[L.stamp(obj)] = obj;
            return this;
        },

        // @method removeEventParent(obj: Evented): this
        // Removes an event parent, so it will stop receiving propagated events
        removeEventParent: function (obj) {
            if (this._eventParents) {
                delete this._eventParents[L.stamp(obj)];
            }
            return this;
        },

        _propagateEvent: function (e) {
            for (var id in this._eventParents) {
                this._eventParents[id].fire(e.type, L.extend({layer: e.target}, e), true);
            }
        }
    });

    var proto = L.Evented.prototype;

// aliases; we should ditch those eventually

// @method addEventListener(): this
// Alias to [`on()`](#evented-on)
    proto.addEventListener = proto.on;

// @method removeEventListener(): this
// Alias to [`off()`](#evented-off)

// @method clearAllEventListeners(): this
// Alias to [`off()`](#evented-off)
    proto.removeEventListener = proto.clearAllEventListeners = proto.off;

// @method addOneTimeEventListener(): this
// Alias to [`once()`](#evented-once)
    proto.addOneTimeEventListener = proto.once;

// @method fireEvent(): this
// Alias to [`fire()`](#evented-fire)
    proto.fireEvent = proto.fire;

// @method hasEventListeners(): Boolean
// Alias to [`listens()`](#evented-listens)
    proto.hasEventListeners = proto.listens;

    L.Mixin = {Events: proto};



    /*
     * @namespace Browser
     * @aka L.Browser
     *
     * A namespace with static properties for browser/feature detection used by Leaflet internally.
     *
     * @example
     *
     * ```js
     * if (L.Browser.ielt9) {
     *   alert('Upgrade your browser, dude!');
     * }
     * ```
     */

    (function () {

        var ua = navigator.userAgent.toLowerCase(),
            doc = document.documentElement,

            ie = 'ActiveXObject' in window,

            webkit    = ua.indexOf('webkit') !== -1,
            phantomjs = ua.indexOf('phantom') !== -1,
            android23 = ua.search('android [23]') !== -1,
            chrome    = ua.indexOf('chrome') !== -1,
            gecko     = ua.indexOf('gecko') !== -1  && !webkit && !window.opera && !ie,

            mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,
            msPointer = !window.PointerEvent && window.MSPointerEvent,
            pointer = window.PointerEvent || msPointer,

            ie3d = ie && ('transition' in doc.style),
            webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,
            gecko3d = 'MozPerspective' in doc.style,
            opera12 = 'OTransition' in doc.style;

        var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||
            (window.DocumentTouch && document instanceof window.DocumentTouch));

        L.Browser = {

            // @property ie: Boolean
            // `true` for all Internet Explorer versions (not Edge).
            ie: ie,

            // @property ielt9: Boolean
            // `true` for Internet Explorer versions less than 9.
            ielt9: ie && !document.addEventListener,

            // @property edge: Boolean
            // `true` for the Edge web browser.
            edge: 'msLaunchUri' in navigator && !('documentMode' in document),

            // @property webkit: Boolean
            // `true` for webkit-based browsers like Chrome and Safari (including mobile versions).
            webkit: webkit,

            // @property gecko: Boolean
            // `true` for gecko-based browsers like Firefox.
            gecko: gecko,

            // @property android: Boolean
            // `true` for any browser running on an Android platform.
            android: ua.indexOf('android') !== -1,

            // @property android23: Boolean
            // `true` for browsers running on Android 2 or Android 3.
            android23: android23,

            // @property chrome: Boolean
            // `true` for the Chrome browser.
            chrome: chrome,

            // @property safari: Boolean
            // `true` for the Safari browser.
            safari: !chrome && ua.indexOf('safari') !== -1,


            // @property ie3d: Boolean
            // `true` for all Internet Explorer versions supporting CSS transforms.
            ie3d: ie3d,

            // @property webkit3d: Boolean
            // `true` for webkit-based browsers supporting CSS transforms.
            webkit3d: webkit3d,

            // @property gecko3d: Boolean
            // `true` for gecko-based browsers supporting CSS transforms.
            gecko3d: gecko3d,

            // @property opera12: Boolean
            // `true` for the Opera browser supporting CSS transforms (version 12 or later).
            opera12: opera12,

            // @property any3d: Boolean
            // `true` for all browsers supporting CSS transforms.
            any3d: !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs,


            // @property mobile: Boolean
            // `true` for all browsers running in a mobile device.
            mobile: mobile,

            // @property mobileWebkit: Boolean
            // `true` for all webkit-based browsers in a mobile device.
            mobileWebkit: mobile && webkit,

            // @property mobileWebkit3d: Boolean
            // `true` for all webkit-based browsers in a mobile device supporting CSS transforms.
            mobileWebkit3d: mobile && webkit3d,

            // @property mobileOpera: Boolean
            // `true` for the Opera browser in a mobile device.
            mobileOpera: mobile && window.opera,

            // @property mobileGecko: Boolean
            // `true` for gecko-based browsers running in a mobile device.
            mobileGecko: mobile && gecko,


            // @property touch: Boolean
            // `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).
            touch: !!touch,

            // @property msPointer: Boolean
            // `true` for browsers implementing the Microsoft touch events model (notably IE10).
            msPointer: !!msPointer,

            // @property pointer: Boolean
            // `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).
            pointer: !!pointer,


            // @property retina: Boolean
            // `true` for browsers on a high-resolution "retina" screen.
            retina: (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1
        };

    }());



    /*
     * @class Point
     * @aka L.Point
     *
     * Represents a point with `x` and `y` coordinates in pixels.
     *
     * @example
     *
     * ```js
     * var point = L.point(200, 300);
     * ```
     *
     * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:
     *
     * ```js
     * map.panBy([200, 300]);
     * map.panBy(L.point(200, 300));
     * ```
     */

    L.Point = function (x, y, round) {
        this.x = (round ? Math.round(x) : x);
        this.y = (round ? Math.round(y) : y);
    };

    L.Point.prototype = {

        // @method clone(): Point
        // Returns a copy of the current point.
        clone: function () {
            return new L.Point(this.x, this.y);
        },

        // @method add(otherPoint: Point): Point
        // Returns the result of addition of the current and the given points.
        add: function (point) {
            // non-destructive, returns a new point
            return this.clone()._add(L.point(point));
        },

        _add: function (point) {
            // destructive, used directly for performance in situations where it's safe to modify existing point
            this.x += point.x;
            this.y += point.y;
            return this;
        },

        // @method subtract(otherPoint: Point): Point
        // Returns the result of subtraction of the given point from the current.
        subtract: function (point) {
            return this.clone()._subtract(L.point(point));
        },

        _subtract: function (point) {
            this.x -= point.x;
            this.y -= point.y;
            return this;
        },

        // @method divideBy(num: Number): Point
        // Returns the result of division of the current point by the given number.
        divideBy: function (num) {
            return this.clone()._divideBy(num);
        },

        _divideBy: function (num) {
            this.x /= num;
            this.y /= num;
            return this;
        },

        // @method multiplyBy(num: Number): Point
        // Returns the result of multiplication of the current point by the given number.
        multiplyBy: function (num) {
            return this.clone()._multiplyBy(num);
        },

        _multiplyBy: function (num) {
            this.x *= num;
            this.y *= num;
            return this;
        },

        // @method scaleBy(scale: Point): Point
        // Multiply each coordinate of the current point by each coordinate of
        // `scale`. In linear algebra terms, multiply the point by the
        // [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)
        // defined by `scale`.
        scaleBy: function (point) {
            return new L.Point(this.x * point.x, this.y * point.y);
        },

        // @method unscaleBy(scale: Point): Point
        // Inverse of `scaleBy`. Divide each coordinate of the current point by
        // each coordinate of `scale`.
        unscaleBy: function (point) {
            return new L.Point(this.x / point.x, this.y / point.y);
        },

        // @method round(): Point
        // Returns a copy of the current point with rounded coordinates.
        round: function () {
            return this.clone()._round();
        },

        _round: function () {
            this.x = Math.round(this.x);
            this.y = Math.round(this.y);
            return this;
        },

        // @method floor(): Point
        // Returns a copy of the current point with floored coordinates (rounded down).
        floor: function () {
            return this.clone()._floor();
        },

        _floor: function () {
            this.x = Math.floor(this.x);
            this.y = Math.floor(this.y);
            return this;
        },

        // @method ceil(): Point
        // Returns a copy of the current point with ceiled coordinates (rounded up).
        ceil: function () {
            return this.clone()._ceil();
        },

        _ceil: function () {
            this.x = Math.ceil(this.x);
            this.y = Math.ceil(this.y);
            return this;
        },

        // @method distanceTo(otherPoint: Point): Number
        // Returns the cartesian distance between the current and the given points.
        distanceTo: function (point) {
            point = L.point(point);

            var x = point.x - this.x,
                y = point.y - this.y;

            return Math.sqrt(x * x + y * y);
        },

        // @method equals(otherPoint: Point): Boolean
        // Returns `true` if the given point has the same coordinates.
        equals: function (point) {
            point = L.point(point);

            return point.x === this.x &&
                point.y === this.y;
        },

        // @method contains(otherPoint: Point): Boolean
        // Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).
        contains: function (point) {
            point = L.point(point);

            return Math.abs(point.x) <= Math.abs(this.x) &&
                Math.abs(point.y) <= Math.abs(this.y);
        },

        // @method toString(): String
        // Returns a string representation of the point for debugging purposes.
        toString: function () {
            return 'Point(' +
                L.Util.formatNum(this.x) + ', ' +
                L.Util.formatNum(this.y) + ')';
        }
    };

// @factory L.point(x: Number, y: Number, round?: Boolean)
// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.

// @alternative
// @factory L.point(coords: Number[])
// Expects an array of the form `[x, y]` instead.
    L.point = function (x, y, round) {
        if (x instanceof L.Point) {
            return x;
        }
        if (L.Util.isArray(x)) {
            return new L.Point(x[0], x[1]);
        }
        if (x === undefined || x === null) {
            return x;
        }
        return new L.Point(x, y, round);
    };



    /*
     * @class Bounds
     * @aka L.Bounds
     *
     * Represents a rectangular area in pixel coordinates.
     *
     * @example
     *
     * ```js
     * var p1 = L.point(10, 10),
     * p2 = L.point(40, 60),
     * bounds = L.bounds(p1, p2);
     * ```
     *
     * All Leaflet methods that accept `Bounds` objects also accept them in a simple Array form (unless noted otherwise), so the bounds example above can be passed like this:
     *
     * ```js
     * otherBounds.intersects([[10, 10], [40, 60]]);
     * ```
     */

    L.Bounds = function (a, b) {
        if (!a) { return; }

        var points = b ? [a, b] : a;

        for (var i = 0, len = points.length; i < len; i++) {
            this.extend(points[i]);
        }
    };

    L.Bounds.prototype = {
        // @method extend(point: Point): this
        // Extends the bounds to contain the given point.
        extend: function (point) { // (Point)
            point = L.point(point);

            // @property min: Point
            // The top left corner of the rectangle.
            // @property max: Point
            // The bottom right corner of the rectangle.
            if (!this.min && !this.max) {
                this.min = point.clone();
                this.max = point.clone();
            } else {
                this.min.x = Math.min(point.x, this.min.x);
                this.max.x = Math.max(point.x, this.max.x);
                this.min.y = Math.min(point.y, this.min.y);
                this.max.y = Math.max(point.y, this.max.y);
            }
            return this;
        },

        // @method getCenter(round?: Boolean): Point
        // Returns the center point of the bounds.
        getCenter: function (round) {
            return new L.Point(
                (this.min.x + this.max.x) / 2,
                (this.min.y + this.max.y) / 2, round);
        },

        // @method getBottomLeft(): Point
        // Returns the bottom-left point of the bounds.
        getBottomLeft: function () {
            return new L.Point(this.min.x, this.max.y);
        },

        // @method getTopRight(): Point
        // Returns the top-right point of the bounds.
        getTopRight: function () { // -> Point
            return new L.Point(this.max.x, this.min.y);
        },

        // @method getSize(): Point
        // Returns the size of the given bounds
        getSize: function () {
            return this.max.subtract(this.min);
        },

        // @method contains(otherBounds: Bounds): Boolean
        // Returns `true` if the rectangle contains the given one.
        // @alternative
        // @method contains(point: Point): Boolean
        // Returns `true` if the rectangle contains the given poing.
        contains: function (obj) {
            var min, max;

            if (typeof obj[0] === 'number' || obj instanceof L.Point) {
                obj = L.point(obj);
            } else {
                obj = L.bounds(obj);
            }

            if (obj instanceof L.Bounds) {
                min = obj.min;
                max = obj.max;
            } else {
                min = max = obj;
            }

            return (min.x >= this.min.x) &&
                (max.x <= this.max.x) &&
                (min.y >= this.min.y) &&
                (max.y <= this.max.y);
        },

        // @method intersects(otherBounds: Bounds): Boolean
        // Returns `true` if the rectangle intersects the given bounds. Two bounds
        // intersect if they have at least one point in common.
        intersects: function (bounds) { // (Bounds) -> Boolean
            bounds = L.bounds(bounds);

            var min = this.min,
                max = this.max,
                min2 = bounds.min,
                max2 = bounds.max,
                xIntersects = (max2.x >= min.x) && (min2.x <= max.x),
                yIntersects = (max2.y >= min.y) && (min2.y <= max.y);

            return xIntersects && yIntersects;
        },

        // @method overlaps(otherBounds: Bounds): Boolean
        // Returns `true` if the rectangle overlaps the given bounds. Two bounds
        // overlap if their intersection is an area.
        overlaps: function (bounds) { // (Bounds) -> Boolean
            bounds = L.bounds(bounds);

            var min = this.min,
                max = this.max,
                min2 = bounds.min,
                max2 = bounds.max,
                xOverlaps = (max2.x > min.x) && (min2.x < max.x),
                yOverlaps = (max2.y > min.y) && (min2.y < max.y);

            return xOverlaps && yOverlaps;
        },

        isValid: function () {
            return !!(this.min && this.max);
        }
    };


// @factory L.bounds(topLeft: Point, bottomRight: Point)
// Creates a Bounds object from two coordinates (usually top-left and bottom-right corners).
// @alternative
// @factory L.bounds(points: Point[])
// Creates a Bounds object from the points it contains
    L.bounds = function (a, b) {
        if (!a || a instanceof L.Bounds) {
            return a;
        }
        return new L.Bounds(a, b);
    };



    /*
     * @class Transformation
     * @aka L.Transformation
     *
     * Represents an affine transformation: a set of coefficients `a`, `b`, `c`, `d`
     * for transforming a point of a form `(x, y)` into `(a*x + b, c*y + d)` and doing
     * the reverse. Used by Leaflet in its projections code.
     *
     * @example
     *
     * ```js
     * var transformation = new L.Transformation(2, 5, -1, 10),
     * 	p = L.point(1, 2),
     * 	p2 = transformation.transform(p), //  L.point(7, 8)
     * 	p3 = transformation.untransform(p2); //  L.point(1, 2)
     * ```
     */


// factory new L.Transformation(a: Number, b: Number, c: Number, d: Number)
// Creates a `Transformation` object with the given coefficients.
    L.Transformation = function (a, b, c, d) {
        this._a = a;
        this._b = b;
        this._c = c;
        this._d = d;
    };

    L.Transformation.prototype = {
        // @method transform(point: Point, scale?: Number)
        // Returns a transformed point, optionally multiplied by the given scale.
        // Only accepts real `L.Point` instances, not arrays.
        transform: function (point, scale) { // (Point, Number) -> Point
            return this._transform(point.clone(), scale);
        },

        // destructive transform (faster)
        _transform: function (point, scale) {
            scale = scale || 1;
            point.x = scale * (this._a * point.x + this._b);
            point.y = scale * (this._c * point.y + this._d);
            return point;
        },

        // @method untransform(point: Point, scale?: Number)
        // Returns the reverse transformation of the given point, optionally divided
        // by the given scale. Only accepts real `L.Point` instances, not arrays.
        untransform: function (point, scale) {
            scale = scale || 1;
            return new L.Point(
                (point.x / scale - this._b) / this._a,
                (point.y / scale - this._d) / this._c);
        }
    };



    /*
     * @namespace DomUtil
     *
     * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)
     * tree, used by Leaflet internally.
     *
     * Most functions expecting or returning a `HTMLElement` also work for
     * SVG elements. The only difference is that classes refer to CSS classes
     * in HTML and SVG classes in SVG.
     */

    L.DomUtil = {

        // @function get(id: String|HTMLElement): HTMLElement
        // Returns an element given its DOM id, or returns the element itself
        // if it was passed directly.
        get: function (id) {
            return typeof id === 'string' ? document.getElementById(id) : id;
        },

        // @function getStyle(el: HTMLElement, styleAttrib: String): String
        // Returns the value for a certain style attribute on an element,
        // including computed values or values set through CSS.
        getStyle: function (el, style) {

            var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);

            if ((!value || value === 'auto') && document.defaultView) {
                var css = document.defaultView.getComputedStyle(el, null);
                value = css ? css[style] : null;
            }

            return value === 'auto' ? null : value;
        },

        // @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement
        // Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.
        create: function (tagName, className, container) {

            var el = document.createElement(tagName);
            el.className = className;

            if (container) {
                container.appendChild(el);
            }

            return el;
        },

        // @function remove(el: HTMLElement)
        // Removes `el` from its parent element
        remove: function (el) {
            var parent = el.parentNode;
            if (parent) {
                parent.removeChild(el);
            }
        },

        // @function empty(el: HTMLElement)
        // Removes all of `el`'s children elements from `el`
        empty: function (el) {
            while (el.firstChild) {
                el.removeChild(el.firstChild);
            }
        },

        // @function toFront(el: HTMLElement)
        // Makes `el` the last children of its parent, so it renders in front of the other children.
        toFront: function (el) {
            el.parentNode.appendChild(el);
        },

        // @function toBack(el: HTMLElement)
        // Makes `el` the first children of its parent, so it renders back from the other children.
        toBack: function (el) {
            var parent = el.parentNode;
            parent.insertBefore(el, parent.firstChild);
        },

        // @function hasClass(el: HTMLElement, name: String): Boolean
        // Returns `true` if the element's class attribute contains `name`.
        hasClass: function (el, name) {
            if (el.classList !== undefined) {
                return el.classList.contains(name);
            }
            var className = L.DomUtil.getClass(el);
            return className.length > 0 && new RegExp('(^|\\s)' + name + '(\\s|$)').test(className);
        },

        // @function addClass(el: HTMLElement, name: String)
        // Adds `name` to the element's class attribute.
        addClass: function (el, name) {
            if (el.classList !== undefined) {
                var classes = L.Util.splitWords(name);
                for (var i = 0, len = classes.length; i < len; i++) {
                    el.classList.add(classes[i]);
                }
            } else if (!L.DomUtil.hasClass(el, name)) {
                var className = L.DomUtil.getClass(el);
                L.DomUtil.setClass(el, (className ? className + ' ' : '') + name);
            }
        },

        // @function removeClass(el: HTMLElement, name: String)
        // Removes `name` from the element's class attribute.
        removeClass: function (el, name) {
            if (el.classList !== undefined) {
                el.classList.remove(name);
            } else {
                L.DomUtil.setClass(el, L.Util.trim((' ' + L.DomUtil.getClass(el) + ' ').replace(' ' + name + ' ', ' ')));
            }
        },

        // @function setClass(el: HTMLElement, name: String)
        // Sets the element's class.
        setClass: function (el, name) {
            if (el.className.baseVal === undefined) {
                el.className = name;
            } else {
                // in case of SVG element
                el.className.baseVal = name;
            }
        },

        // @function getClass(el: HTMLElement): String
        // Returns the element's class.
        getClass: function (el) {
            return el.className.baseVal === undefined ? el.className : el.className.baseVal;
        },

        // @function setOpacity(el: HTMLElement, opacity: Number)
        // Set the opacity of an element (including old IE support).
        // `opacity` must be a number from `0` to `1`.
        setOpacity: function (el, value) {

            if ('opacity' in el.style) {
                el.style.opacity = value;

            } else if ('filter' in el.style) {
                L.DomUtil._setOpacityIE(el, value);
            }
        },

        _setOpacityIE: function (el, value) {
            var filter = false,
                filterName = 'DXImageTransform.Microsoft.Alpha';

            // filters collection throws an error if we try to retrieve a filter that doesn't exist
            try {
                filter = el.filters.item(filterName);
            } catch (e) {
                // don't set opacity to 1 if we haven't already set an opacity,
                // it isn't needed and breaks transparent pngs.
                if (value === 1) { return; }
            }

            value = Math.round(value * 100);

            if (filter) {
                filter.Enabled = (value !== 100);
                filter.Opacity = value;
            } else {
                el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';
            }
        },

        // @function testProp(props: String[]): String|false
        // Goes through the array of style names and returns the first name
        // that is a valid style name for an element. If no such name is found,
        // it returns false. Useful for vendor-prefixed styles like `transform`.
        testProp: function (props) {

            var style = document.documentElement.style;

            for (var i = 0; i < props.length; i++) {
                if (props[i] in style) {
                    return props[i];
                }
            }
            return false;
        },

        // @function setTransform(el: HTMLElement, offset: Point, scale?: Number)
        // Resets the 3D CSS transform of `el` so it is translated by `offset` pixels
        // and optionally scaled by `scale`. Does not have an effect if the
        // browser doesn't support 3D CSS transforms.
        setTransform: function (el, offset, scale) {
            var pos = offset || new L.Point(0, 0);

            el.style[L.DomUtil.TRANSFORM] =
                (L.Browser.ie3d ?
                'translate(' + pos.x + 'px,' + pos.y + 'px)' :
                'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +
                (scale ? ' scale(' + scale + ')' : '');
        },

        // @function setPosition(el: HTMLElement, position: Point)
        // Sets the position of `el` to coordinates specified by `position`,
        // using CSS translate or top/left positioning depending on the browser
        // (used by Leaflet internally to position its layers).
        setPosition: function (el, point) { // (HTMLElement, Point[, Boolean])

            /*eslint-disable */
            el._leaflet_pos = point;
            /*eslint-enable */

            if (L.Browser.any3d) {
                L.DomUtil.setTransform(el, point);
            } else {
                el.style.left = point.x + 'px';
                el.style.top = point.y + 'px';
            }
        },

        // @function getPosition(el: HTMLElement): Point
        // Returns the coordinates of an element previously positioned with setPosition.
        getPosition: function (el) {
            // this method is only used for elements previously positioned using setPosition,
            // so it's safe to cache the position for performance

            return el._leaflet_pos || new L.Point(0, 0);
        }
    };


    (function () {
        // prefix style property names

        // @property TRANSFORM: String
        // Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).
        L.DomUtil.TRANSFORM = L.DomUtil.testProp(
            ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);


        // webkitTransition comes first because some browser versions that drop vendor prefix don't do
        // the same for the transitionend event, in particular the Android 4.1 stock browser

        // @property TRANSITION: String
        // Vendor-prefixed transform style name.
        var transition = L.DomUtil.TRANSITION = L.DomUtil.testProp(
            ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);

        L.DomUtil.TRANSITION_END =
            transition === 'webkitTransition' || transition === 'OTransition' ? transition + 'End' : 'transitionend';

        // @function disableTextSelection()
        // Prevents the user from generating `selectstart` DOM events, usually generated
        // when the user drags the mouse through a page with text. Used internally
        // by Leaflet to override the behaviour of any click-and-drag interaction on
        // the map. Affects drag interactions on the whole document.

        // @function enableTextSelection()
        // Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).
        if ('onselectstart' in document) {
            L.DomUtil.disableTextSelection = function () {
                L.DomEvent.on(window, 'selectstart', L.DomEvent.preventDefault);
            };
            L.DomUtil.enableTextSelection = function () {
                L.DomEvent.off(window, 'selectstart', L.DomEvent.preventDefault);
            };

        } else {
            var userSelectProperty = L.DomUtil.testProp(
                ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);

            L.DomUtil.disableTextSelection = function () {
                if (userSelectProperty) {
                    var style = document.documentElement.style;
                    this._userSelect = style[userSelectProperty];
                    style[userSelectProperty] = 'none';
                }
            };
            L.DomUtil.enableTextSelection = function () {
                if (userSelectProperty) {
                    document.documentElement.style[userSelectProperty] = this._userSelect;
                    delete this._userSelect;
                }
            };
        }

        // @function disableImageDrag()
        // As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but
        // for `dragstart` DOM events, usually generated when the user drags an image.
        L.DomUtil.disableImageDrag = function () {
            L.DomEvent.on(window, 'dragstart', L.DomEvent.preventDefault);
        };

        // @function enableImageDrag()
        // Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).
        L.DomUtil.enableImageDrag = function () {
            L.DomEvent.off(window, 'dragstart', L.DomEvent.preventDefault);
        };

        // @function preventOutline(el: HTMLElement)
        // Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)
        // of the element `el` invisible. Used internally by Leaflet to prevent
        // focusable elements from displaying an outline when the user performs a
        // drag interaction on them.
        L.DomUtil.preventOutline = function (element) {
            while (element.tabIndex === -1) {
                element = element.parentNode;
            }
            if (!element || !element.style) { return; }
            L.DomUtil.restoreOutline();
            this._outlineElement = element;
            this._outlineStyle = element.style.outline;
            element.style.outline = 'none';
            L.DomEvent.on(window, 'keydown', L.DomUtil.restoreOutline, this);
        };

        // @function restoreOutline()
        // Cancels the effects of a previous [`L.DomUtil.preventOutline`]().
        L.DomUtil.restoreOutline = function () {
            if (!this._outlineElement) { return; }
            this._outlineElement.style.outline = this._outlineStyle;
            delete this._outlineElement;
            delete this._outlineStyle;
            L.DomEvent.off(window, 'keydown', L.DomUtil.restoreOutline, this);
        };
    })();



    /* @class LatLng
     * @aka L.LatLng
     *
     * Represents a geographical point with a certain latitude and longitude.
     *
     * @example
     *
     * ```
     * var latlng = L.latLng(50.5, 30.5);
     * ```
     *
     * All Leaflet methods that accept LatLng objects also accept them in a simple Array form and simple object form (unless noted otherwise), so these lines are equivalent:
     *
     * ```
     * map.panTo([50, 30]);
     * map.panTo({lon: 30, lat: 50});
     * map.panTo({lat: 50, lng: 30});
     * map.panTo(L.latLng(50, 30));
     * ```
     */

    L.LatLng = function (lat, lng, alt) {
        if (isNaN(lat) || isNaN(lng)) {
            throw new Error('Invalid LatLng object: (' + lat + ', ' + lng + ')');
        }

        // @property lat: Number
        // Latitude in degrees
        this.lat = +lat;

        // @property lng: Number
        // Longitude in degrees
        this.lng = +lng;

        // @property alt: Number
        // Altitude in meters (optional)
        if (alt !== undefined) {
            this.alt = +alt;
        }
    };

    L.LatLng.prototype = {
        // @method equals(otherLatLng: LatLng, maxMargin?: Number): Boolean
        // Returns `true` if the given `LatLng` point is at the same position (within a small margin of error). The margin of error can be overriden by setting `maxMargin` to a small number.
        equals: function (obj, maxMargin) {
            if (!obj) { return false; }

            obj = L.latLng(obj);

            var margin = Math.max(
                Math.abs(this.lat - obj.lat),
                Math.abs(this.lng - obj.lng));

            return margin <= (maxMargin === undefined ? 1.0E-9 : maxMargin);
        },

        // @method toString(): String
        // Returns a string representation of the point (for debugging purposes).
        toString: function (precision) {
            return 'LatLng(' +
                L.Util.formatNum(this.lat, precision) + ', ' +
                L.Util.formatNum(this.lng, precision) + ')';
        },

        // @method distanceTo(otherLatLng: LatLng): Number
        // Returns the distance (in meters) to the given `LatLng` calculated using the [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula).
        distanceTo: function (other) {
            return L.CRS.Earth.distance(this, L.latLng(other));
        },

        // @method wrap(): LatLng
        // Returns a new `LatLng` object with the longitude wrapped so it's always between -180 and +180 degrees.
        wrap: function () {
            return L.CRS.Earth.wrapLatLng(this);
        },

        // @method toBounds(sizeInMeters: Number): LatLngBounds
        // Returns a new `LatLngBounds` object in which each boundary is `sizeInMeters` meters apart from the `LatLng`.
        toBounds: function (sizeInMeters) {
            var latAccuracy = 180 * sizeInMeters / 40075017,
                lngAccuracy = latAccuracy / Math.cos((Math.PI / 180) * this.lat);

            return L.latLngBounds(
                [this.lat - latAccuracy, this.lng - lngAccuracy],
                [this.lat + latAccuracy, this.lng + lngAccuracy]);
        },

        clone: function () {
            return new L.LatLng(this.lat, this.lng, this.alt);
        }
    };



// @factory L.latLng(latitude: Number, longitude: Number, altitude?: Number): LatLng
// Creates an object representing a geographical point with the given latitude and longitude (and optionally altitude).

// @alternative
// @factory L.latLng(coords: Array): LatLng
// Expects an array of the form `[Number, Number]` or `[Number, Number, Number]` instead.

// @alternative
// @factory L.latLng(coords: Object): LatLng
// Expects an plain object of the form `{lat: Number, lng: Number}` or `{lat: Number, lng: Number, alt: Number}` instead.

    L.latLng = function (a, b, c) {
        if (a instanceof L.LatLng) {
            return a;
        }
        if (L.Util.isArray(a) && typeof a[0] !== 'object') {
            if (a.length === 3) {
                return new L.LatLng(a[0], a[1], a[2]);
            }
            if (a.length === 2) {
                return new L.LatLng(a[0], a[1]);
            }
            return null;
        }
        if (a === undefined || a === null) {
            return a;
        }
        if (typeof a === 'object' && 'lat' in a) {
            return new L.LatLng(a.lat, 'lng' in a ? a.lng : a.lon, a.alt);
        }
        if (b === undefined) {
            return null;
        }
        return new L.LatLng(a, b, c);
    };



    /*
     * @class LatLngBounds
     * @aka L.LatLngBounds
     *
     * Represents a rectangular geographical area on a map.
     *
     * @example
     *
     * ```js
     * var southWest = L.latLng(40.712, -74.227),
     * northEast = L.latLng(40.774, -74.125),
     * bounds = L.latLngBounds(southWest, northEast);
     * ```
     *
     * All Leaflet methods that accept LatLngBounds objects also accept them in a simple Array form (unless noted otherwise), so the bounds example above can be passed like this:
     *
     * ```js
     * map.fitBounds([
     * 	[40.712, -74.227],
     * 	[40.774, -74.125]
     * ]);
     * ```
     */

    L.LatLngBounds = function (southWest, northEast) { // (LatLng, LatLng) or (LatLng[])
        if (!southWest) { return; }

        var latlngs = northEast ? [southWest, northEast] : southWest;

        for (var i = 0, len = latlngs.length; i < len; i++) {
            this.extend(latlngs[i]);
        }
    };

    L.LatLngBounds.prototype = {

        // @method extend(latlng: LatLng): this
        // Extend the bounds to contain the given point

        // @alternative
        // @method extend(otherBounds: LatLngBounds): this
        // Extend the bounds to contain the given bounds
        extend: function (obj) {
            var sw = this._southWest,
                ne = this._northEast,
                sw2, ne2;

            if (obj instanceof L.LatLng) {
                sw2 = obj;
                ne2 = obj;

            } else if (obj instanceof L.LatLngBounds) {
                sw2 = obj._southWest;
                ne2 = obj._northEast;

                if (!sw2 || !ne2) { return this; }

            } else {
                return obj ? this.extend(L.latLng(obj) || L.latLngBounds(obj)) : this;
            }

            if (!sw && !ne) {
                this._southWest = new L.LatLng(sw2.lat, sw2.lng);
                this._northEast = new L.LatLng(ne2.lat, ne2.lng);
            } else {
                sw.lat = Math.min(sw2.lat, sw.lat);
                sw.lng = Math.min(sw2.lng, sw.lng);
                ne.lat = Math.max(ne2.lat, ne.lat);
                ne.lng = Math.max(ne2.lng, ne.lng);
            }

            return this;
        },

        // @method pad(bufferRatio: Number): LatLngBounds
        // Returns bigger bounds created by extending the current bounds by a given percentage in each direction.
        pad: function (bufferRatio) {
            var sw = this._southWest,
                ne = this._northEast,
                heightBuffer = Math.abs(sw.lat - ne.lat) * bufferRatio,
                widthBuffer = Math.abs(sw.lng - ne.lng) * bufferRatio;

            return new L.LatLngBounds(
                new L.LatLng(sw.lat - heightBuffer, sw.lng - widthBuffer),
                new L.LatLng(ne.lat + heightBuffer, ne.lng + widthBuffer));
        },

        // @method getCenter(): LatLng
        // Returns the center point of the bounds.
        getCenter: function () {
            return new L.LatLng(
                (this._southWest.lat + this._northEast.lat) / 2,
                (this._southWest.lng + this._northEast.lng) / 2);
        },

        // @method getSouthWest(): LatLng
        // Returns the south-west point of the bounds.
        getSouthWest: function () {
            return this._southWest;
        },

        // @method getNorthEast(): LatLng
        // Returns the north-east point of the bounds.
        getNorthEast: function () {
            return this._northEast;
        },

        // @method getNorthWest(): LatLng
        // Returns the north-west point of the bounds.
        getNorthWest: function () {
            return new L.LatLng(this.getNorth(), this.getWest());
        },

        // @method getSouthEast(): LatLng
        // Returns the south-east point of the bounds.
        getSouthEast: function () {
            return new L.LatLng(this.getSouth(), this.getEast());
        },

        // @method getWest(): Number
        // Returns the west longitude of the bounds
        getWest: function () {
            return this._southWest.lng;
        },

        // @method getSouth(): Number
        // Returns the south latitude of the bounds
        getSouth: function () {
            return this._southWest.lat;
        },

        // @method getEast(): Number
        // Returns the east longitude of the bounds
        getEast: function () {
            return this._northEast.lng;
        },

        // @method getNorth(): Number
        // Returns the north latitude of the bounds
        getNorth: function () {
            return this._northEast.lat;
        },

        // @method contains(otherBounds: LatLngBounds): Boolean
        // Returns `true` if the rectangle contains the given one.

        // @alternative
        // @method contains (latlng: LatLng): Boolean
        // Returns `true` if the rectangle contains the given point.
        contains: function (obj) { // (LatLngBounds) or (LatLng) -> Boolean
            if (typeof obj[0] === 'number' || obj instanceof L.LatLng) {
                obj = L.latLng(obj);
            } else {
                obj = L.latLngBounds(obj);
            }

            var sw = this._southWest,
                ne = this._northEast,
                sw2, ne2;

            if (obj instanceof L.LatLngBounds) {
                sw2 = obj.getSouthWest();
                ne2 = obj.getNorthEast();
            } else {
                sw2 = ne2 = obj;
            }

            return (sw2.lat >= sw.lat) && (ne2.lat <= ne.lat) &&
                (sw2.lng >= sw.lng) && (ne2.lng <= ne.lng);
        },

        // @method intersects(otherBounds: LatLngBounds): Boolean
        // Returns `true` if the rectangle intersects the given bounds. Two bounds intersect if they have at least one point in common.
        intersects: function (bounds) {
            bounds = L.latLngBounds(bounds);

            var sw = this._southWest,
                ne = this._northEast,
                sw2 = bounds.getSouthWest(),
                ne2 = bounds.getNorthEast(),

                latIntersects = (ne2.lat >= sw.lat) && (sw2.lat <= ne.lat),
                lngIntersects = (ne2.lng >= sw.lng) && (sw2.lng <= ne.lng);

            return latIntersects && lngIntersects;
        },

        // @method overlaps(otherBounds: Bounds): Boolean
        // Returns `true` if the rectangle overlaps the given bounds. Two bounds overlap if their intersection is an area.
        overlaps: function (bounds) {
            bounds = L.latLngBounds(bounds);

            var sw = this._southWest,
                ne = this._northEast,
                sw2 = bounds.getSouthWest(),
                ne2 = bounds.getNorthEast(),

                latOverlaps = (ne2.lat > sw.lat) && (sw2.lat < ne.lat),
                lngOverlaps = (ne2.lng > sw.lng) && (sw2.lng < ne.lng);

            return latOverlaps && lngOverlaps;
        },

        // @method toBBoxString(): String
        // Returns a string with bounding box coordinates in a 'southwest_lng,southwest_lat,northeast_lng,northeast_lat' format. Useful for sending requests to web services that return geo data.
        toBBoxString: function () {
            return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(',');
        },

        // @method equals(otherBounds: LatLngBounds): Boolean
        // Returns `true` if the rectangle is equivalent (within a small margin of error) to the given bounds.
        equals: function (bounds) {
            if (!bounds) { return false; }

            bounds = L.latLngBounds(bounds);

            return this._southWest.equals(bounds.getSouthWest()) &&
                this._northEast.equals(bounds.getNorthEast());
        },

        // @method isValid(): Boolean
        // Returns `true` if the bounds are properly initialized.
        isValid: function () {
            return !!(this._southWest && this._northEast);
        }
    };

// TODO International date line?

// @factory L.latLngBounds(southWest: LatLng, northEast: LatLng)
// Creates a `LatLngBounds` object by defining south-west and north-east corners of the rectangle.

// @alternative
// @factory L.latLngBounds(latlngs: LatLng[])
// Creates a `LatLngBounds` object defined by the geographical points it contains. Very useful for zooming the map to fit a particular set of locations with [`fitBounds`](#map-fitbounds).
    L.latLngBounds = function (a, b) {
        if (a instanceof L.LatLngBounds) {
            return a;
        }
        return new L.LatLngBounds(a, b);
    };



    /*
     * @namespace Projection
     * @section
     * Leaflet comes with a set of already defined Projections out of the box:
     *
     * @projection L.Projection.LonLat
     *
     * Equirectangular, or Plate Carree projection  the most simple projection,
     * mostly used by GIS enthusiasts. Directly maps `x` as longitude, and `y` as
     * latitude. Also suitable for flat worlds, e.g. game maps. Used by the
     * `EPSG:3395` and `Simple` CRS.
     */

    L.Projection = {};

    L.Projection.LonLat = {
        project: function (latlng) {
            return new L.Point(latlng.lng, latlng.lat);
        },

        unproject: function (point) {
            return new L.LatLng(point.y, point.x);
        },

        bounds: L.bounds([-180, -90], [180, 90])
    };



    /*
     * @namespace Projection
     * @projection L.Projection.SphericalMercator
     *
     * Spherical Mercator projection  the most common projection for online maps,
     * used by almost all free and commercial tile providers. Assumes that Earth is
     * a sphere. Used by the `EPSG:3857` CRS.
     */

    L.Projection.SphericalMercator = {

        R: 6378137,
        MAX_LATITUDE: 85.0511287798,

        project: function (latlng) {
            var d = Math.PI / 180,
                max = this.MAX_LATITUDE,
                lat = Math.max(Math.min(max, latlng.lat), -max),
                sin = Math.sin(lat * d);

            return new L.Point(
                this.R * latlng.lng * d,
                this.R * Math.log((1 + sin) / (1 - sin)) / 2);
        },

        unproject: function (point) {
            var d = 180 / Math.PI;

            return new L.LatLng(
                (2 * Math.atan(Math.exp(point.y / this.R)) - (Math.PI / 2)) * d,
                point.x * d / this.R);
        },

        bounds: (function () {
            var d = 6378137 * Math.PI;
            return L.bounds([-d, -d], [d, d]);
        })()
    };



    /*
     * @class CRS
     * @aka L.CRS
     * Abstract class that defines coordinate reference systems for projecting
     * geographical points into pixel (screen) coordinates and back (and to
     * coordinates in other units for WMS services). See
     * [spatial reference system](http://en.wikipedia.org/wiki/Coordinate_reference_system).
     *
     * Leaflet defines the most usual CRSs by default. If you want to use a
     * CRS not defined by default, take a look at the
     * [Proj4Leaflet](https://github.com/kartena/Proj4Leaflet) plugin.
     */

    L.CRS = {
        // @method latLngToPoint(latlng: LatLng, zoom: Number): Point
        // Projects geographical coordinates into pixel coordinates for a given zoom.
        latLngToPoint: function (latlng, zoom) {
            var projectedPoint = this.projection.project(latlng),
                scale = this.scale(zoom);

            return this.transformation._transform(projectedPoint, scale);
        },

        // @method pointToLatLng(point: Point, zoom: Number): LatLng
        // The inverse of `latLngToPoint`. Projects pixel coordinates on a given
        // zoom into geographical coordinates.
        pointToLatLng: function (point, zoom) {
            var scale = this.scale(zoom),
                untransformedPoint = this.transformation.untransform(point, scale);

            return this.projection.unproject(untransformedPoint);
        },

        // @method project(latlng: LatLng): Point
        // Projects geographical coordinates into coordinates in units accepted for
        // this CRS (e.g. meters for EPSG:3857, for passing it to WMS services).
        project: function (latlng) {
            return this.projection.project(latlng);
        },

        // @method unproject(point: Point): LatLng
        // Given a projected coordinate returns the corresponding LatLng.
        // The inverse of `project`.
        unproject: function (point) {
            return this.projection.unproject(point);
        },

        // @method scale(zoom: Number): Number
        // Returns the scale used when transforming projected coordinates into
        // pixel coordinates for a particular zoom. For example, it returns
        // `256 * 2^zoom` for Mercator-based CRS.
        scale: function (zoom) {
            return 256 * Math.pow(2, zoom);
        },

        // @method zoom(scale: Number): Number
        // Inverse of `scale()`, returns the zoom level corresponding to a scale
        // factor of `scale`.
        zoom: function (scale) {
            return Math.log(scale / 256) / Math.LN2;
        },

        // @method getProjectedBounds(zoom): Bounds
        // Returns the projection's bounds scaled and transformed for the provided `zoom`.
        getProjectedBounds: function (zoom) {
            if (this.infinite) { return null; }

            var b = this.projection.bounds,
                s = this.scale(zoom),
                min = this.transformation.transform(b.min, s),
                max = this.transformation.transform(b.max, s);

            return L.bounds(min, max);
        },

        // @property code: String
        // Standard code name of the CRS passed into WMS services (e.g. `'EPSG:3857'`)
        //
        // @property wrapLng: Number[]
        // An array of two numbers defining whether the longitude coordinate axis
        // wraps around a given range and how. Defaults to `[-180, 180]` in most
        // geographical CRSs.
        //
        // @property wrapLat: Number[]
        // Like `wrapLng`, but for the latitude axis.

        // wrapLng: [min, max],
        // wrapLat: [min, max],

        // @property infinite: Boolean = false
        // If true, the coordinate space will be unbounded (infinite in both axes)
        infinite: false,

        // @method wrapLatLng(latlng: LatLng): LatLng
        // Returns a `LatLng` where lat and lng has been wrapped according to the
        // CRS's `wrapLat` and `wrapLng` properties, if they are outside the CRS's bounds.
        wrapLatLng: function (latlng) {
            var lng = this.wrapLng ? L.Util.wrapNum(latlng.lng, this.wrapLng, true) : latlng.lng,
                lat = this.wrapLat ? L.Util.wrapNum(latlng.lat, this.wrapLat, true) : latlng.lat,
                alt = latlng.alt;

            return L.latLng(lat, lng, alt);
        }
    };



    /*
     * @namespace CRS
     * @crs L.CRS.Simple
     *
     * A simple CRS that maps longitude and latitude into `x` and `y` directly.
     * May be used for maps of flat surfaces (e.g. game maps). Note that the `y`
     * axis should still be inverted (going from bottom to top).
     */

    L.CRS.Simple = L.extend({}, L.CRS, {
        projection: L.Projection.LonLat,
        transformation: new L.Transformation(1, 0, -1, 0),

        scale: function (zoom) {
            return Math.pow(2, zoom);
        },

        zoom: function (scale) {
            return Math.log(scale) / Math.LN2;
        },

        distance: function (latlng1, latlng2) {
            var dx = latlng2.lng - latlng1.lng,
                dy = latlng2.lat - latlng1.lat;

            return Math.sqrt(dx * dx + dy * dy);
        },

        infinite: true
    });



    /*
     * @namespace CRS
     * @crs L.CRS.Earth
     *
     * Serves as the base for CRS that are global such that they cover the earth.
     * Can only be used as the base for other CRS and cannot be used directly,
     * since it does not have a `code`, `projection` or `transformation`.
     */

    L.CRS.Earth = L.extend({}, L.CRS, {
        wrapLng: [-180, 180],

        // Mean Earth Radius, as recommended for use by
        // the International Union of Geodesy and Geophysics,
        // see http://rosettacode.org/wiki/Haversine_formula
        R: 6371000,

        // distance between two geographical points using spherical law of cosines approximation
        distance: function (latlng1, latlng2) {
            var rad = Math.PI / 180,
                lat1 = latlng1.lat * rad,
                lat2 = latlng2.lat * rad,
                a = Math.sin(lat1) * Math.sin(lat2) +
                    Math.cos(lat1) * Math.cos(lat2) * Math.cos((latlng2.lng - latlng1.lng) * rad);

            return this.R * Math.acos(Math.min(a, 1));
        }
    });



    /*
     * @namespace CRS
     * @crs L.CRS.EPSG3857
     *
     * The most common CRS for online maps, used by almost all free and commercial
     * tile providers. Uses Spherical Mercator projection. Set in by default in
     * Map's `crs` option.
     */

    L.CRS.EPSG3857 = L.extend({}, L.CRS.Earth, {
        code: 'EPSG:3857',
        projection: L.Projection.SphericalMercator,

        transformation: (function () {
            var scale = 0.5 / (Math.PI * L.Projection.SphericalMercator.R);
            return new L.Transformation(scale, 0.5, -scale, 0.5);
        }())
    });

    L.CRS.EPSG900913 = L.extend({}, L.CRS.EPSG3857, {
        code: 'EPSG:900913'
    });



    /*
     * @namespace CRS
     * @crs L.CRS.EPSG4326
     *
     * A common CRS among GIS enthusiasts. Uses simple Equirectangular projection.
     */

    L.CRS.EPSG4326 = L.extend({}, L.CRS.Earth, {
        code: 'EPSG:4326',
        projection: L.Projection.LonLat,
        transformation: new L.Transformation(1 / 180, 1, -1 / 180, 0.5)
    });



    /*
     * @class Map
     * @aka L.Map
     * @inherits Evented
     *
     * The central class of the API  it is used to create a map on a page and manipulate it.
     *
     * @example
     *
     * ```js
     * // initialize the map on the "map" div with a given center and zoom
     * var map = L.map('map', {
     * 	center: [51.505, -0.09],
     * 	zoom: 13
     * });
     * ```
     *
     */

    L.Map = L.Evented.extend({

        options: {
            // @section Map State Options
            // @option crs: CRS = L.CRS.EPSG3857
            // The [Coordinate Reference System](#crs) to use. Don't change this if you're not
            // sure what it means.
            crs: L.CRS.EPSG3857,

            // @option center: LatLng = undefined
            // Initial geographic center of the map
            center: undefined,

            // @option zoom: Number = undefined
            // Initial map zoom level
            zoom: undefined,

            // @option minZoom: Number = undefined
            // Minimum zoom level of the map. Overrides any `minZoom` option set on map layers.
            minZoom: undefined,

            // @option maxZoom: Number = undefined
            // Maximum zoom level of the map. Overrides any `maxZoom` option set on map layers.
            maxZoom: undefined,

            // @option layers: Layer[] = []
            // Array of layers that will be added to the map initially
            layers: [],

            // @option maxBounds: LatLngBounds = null
            // When this option is set, the map restricts the view to the given
            // geographical bounds, bouncing the user back when he tries to pan
            // outside the view. To set the restriction dynamically, use
            // [`setMaxBounds`](#map-setmaxbounds) method.
            maxBounds: undefined,

            // @option renderer: Renderer = *
            // The default method for drawing vector layers on the map. `L.SVG`
            // or `L.Canvas` by default depending on browser support.
            renderer: undefined,


            // @section Animation Options
            // @option fadeAnimation: Boolean = true
            // Whether the tile fade animation is enabled. By default it's enabled
            // in all browsers that support CSS3 Transitions except Android.
            fadeAnimation: true,

            // @option markerZoomAnimation: Boolean = true
            // Whether markers animate their zoom with the zoom animation, if disabled
            // they will disappear for the length of the animation. By default it's
            // enabled in all browsers that support CSS3 Transitions except Android.
            markerZoomAnimation: true,

            // @option transform3DLimit: Number = 2^23
            // Defines the maximum size of a CSS translation transform. The default
            // value should not be changed unless a web browser positions layers in
            // the wrong place after doing a large `panBy`.
            transform3DLimit: 8388608, // Precision limit of a 32-bit float

            // @section Interaction Options
            // @option zoomSnap: Number = 1
            // Forces the map's zoom level to always be a multiple of this, particularly
            // right after a [`fitBounds()`](#map-fitbounds) or a pinch-zoom.
            // By default, the zoom level snaps to the nearest integer; lower values
            // (e.g. `0.5` or `0.1`) allow for greater granularity. A value of `0`
            // means the zoom level will not be snapped after `fitBounds` or a pinch-zoom.
            zoomSnap: 1,

            // @option zoomDelta: Number = 1
            // Controls how much the map's zoom level will change after a
            // [`zoomIn()`](#map-zoomin), [`zoomOut()`](#map-zoomout), pressing `+`
            // or `-` on the keyboard, or using the [zoom controls](#control-zoom).
            // Values smaller than `1` (e.g. `0.5`) allow for greater granularity.
            zoomDelta: 1,

            // @option trackResize: Boolean = true
            // Whether the map automatically handles browser window resize to update itself.
            trackResize: true
        },

        initialize: function (id, options) { // (HTMLElement or String, Object)
            options = L.setOptions(this, options);

            this._initContainer(id);
            this._initLayout();

            // hack for https://github.com/Leaflet/Leaflet/issues/1980
            this._onResize = L.bind(this._onResize, this);

            this._initEvents();

            if (options.maxBounds) {
                this.setMaxBounds(options.maxBounds);
            }

            if (options.zoom !== undefined) {
                this._zoom = this._limitZoom(options.zoom);
            }

            if (options.center && options.zoom !== undefined) {
                this.setView(L.latLng(options.center), options.zoom, {reset: true});
            }

            this._handlers = [];
            this._layers = {};
            this._zoomBoundLayers = {};
            this._sizeChanged = true;

            this.callInitHooks();

            this._addLayers(this.options.layers);
        },


        // @section Methods for modifying map state

        // @method setView(center: LatLnt, zoom: Number, options?: Zoom/Pan options): this
        // Sets the view of the map (geographical center and zoom) with the given
        // animation options.
        setView: function (center, zoom) {
            // replaced by animation-powered implementation in Map.PanAnimation.js
            zoom = zoom === undefined ? this.getZoom() : zoom;
            this._resetView(L.latLng(center), zoom);
            return this;
        },

        // @method setZoom(zoom: Number, options: Zoom/Pan options): this
        // Sets the zoom of the map.
        setZoom: function (zoom, options) {
            if (!this._loaded) {
                this._zoom = zoom;
                return this;
            }
            return this.setView(this.getCenter(), zoom, {zoom: options});
        },

        // @method zoomIn(delta?: Number, options?: Zoom options): this
        // Increases the zoom of the map by `delta` ([`zoomDelta`](#map-zoomdelta) by default).
        zoomIn: function (delta, options) {
            delta = delta || (L.Browser.any3d ? this.options.zoomDelta : 1);
            return this.setZoom(this._zoom + delta, options);
        },

        // @method zoomOut(delta?: Number, options?: Zoom options): this
        // Decreases the zoom of the map by `delta` ([`zoomDelta`](#map-zoomdelta) by default).
        zoomOut: function (delta, options) {
            delta = delta || (L.Browser.any3d ? this.options.zoomDelta : 1);
            return this.setZoom(this._zoom - delta, options);
        },

        // @method setZoomAround(latlng: LatLng, zoom: Number, options: Zoom options): this
        // Zooms the map while keeping a specified geographical point on the map
        // stationary (e.g. used internally for scroll zoom and double-click zoom).
        // @alternative
        // @method setZoomAround(offset: Point, zoom: Number, options: Zoom options): this
        // Zooms the map while keeping a specified pixel on the map (relative to the top-left corner) stationary.
        setZoomAround: function (latlng, zoom, options) {
            var scale = this.getZoomScale(zoom),
                viewHalf = this.getSize().divideBy(2),
                containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPoint(latlng),

                centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),
                newCenter = this.containerPointToLatLng(viewHalf.add(centerOffset));

            return this.setView(newCenter, zoom, {zoom: options});
        },

        _getBoundsCenterZoom: function (bounds, options) {

            options = options || {};
            bounds = bounds.getBounds ? bounds.getBounds() : L.latLngBounds(bounds);

            var paddingTL = L.point(options.paddingTopLeft || options.padding || [0, 0]),
                paddingBR = L.point(options.paddingBottomRight || options.padding || [0, 0]),

                zoom = this.getBoundsZoom(bounds, false, paddingTL.add(paddingBR));

            zoom = (typeof options.maxZoom === 'number') ? Math.min(options.maxZoom, zoom) : zoom;

            //shine:,.,.
            //:FR.,
            //VanChartMapPlotGlyph initGisLayerImage centerLng centerLat
            var center;

            var paddingOffset = paddingBR.subtract(paddingTL).divideBy(2);

            if(paddingOffset.x === 0 && paddingOffset.y === 0){

                var sw = bounds.getSouthWest(), ne = bounds.getNorthEast();

                center = new L.LatLng((sw.lat + ne.lat)/2, (sw.lng + ne.lng)/2)
            } else {

                var swPoint = this.project(bounds.getSouthWest(), zoom),
                    nePoint = this.project(bounds.getNorthEast(), zoom);

                center = this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset), zoom);
            }

            return {
                center: center,
                zoom: zoom
            };
        },

        // @method fitBounds(bounds: LatLngBounds, options: fitBounds options): this
        // Sets a map view that contains the given geographical bounds with the
        // maximum zoom level possible.
        fitBounds: function (bounds, options) {

            bounds = L.latLngBounds(bounds);

            if (!bounds.isValid()) {
                throw new Error('Bounds are not valid.');
            }

            var target = this._getBoundsCenterZoom(bounds, options);
            return this.setView(target.center, target.zoom, options);
        },

        // @method fitWorld(options?: fitBounds options): this
        // Sets a map view that mostly contains the whole world with the maximum
        // zoom level possible.
        fitWorld: function (options) {
            return this.fitBounds([[-90, -180], [90, 180]], options);
        },

        // @method panTo(latlng: LatLng, options?: Pan options): this
        // Pans the map to a given center.
        panTo: function (center, options) { // (LatLng)
            return this.setView(center, this._zoom, {pan: options});
        },

        // @method panBy(offset: Point): this
        // Pans the map by a given number of pixels (animated).
        panBy: function (offset) { // (Point)
            // replaced with animated panBy in Map.PanAnimation.js
            this.fire('movestart');

            this._rawPanBy(L.point(offset));

            this.fire('move');
            return this.fire('moveend');
        },

        // @method setMaxBounds(bounds: Bounds): this
        // Restricts the map view to the given bounds (see the [maxBounds](#map-maxbounds) option).
        setMaxBounds: function (bounds) {
            bounds = L.latLngBounds(bounds);

            if (!bounds) {
                return this.off('moveend', this._panInsideMaxBounds);
            } else if (this.options.maxBounds) {
                this.off('moveend', this._panInsideMaxBounds);
            }

            this.options.maxBounds = bounds;

            if (this._loaded) {
                this._panInsideMaxBounds();
            }

            return this.on('moveend', this._panInsideMaxBounds);
        },

        // @method setMinZoom(zoom: Number): this
        // Sets the lower limit for the available zoom levels (see the [minZoom](#map-minzoom) option).
        setMinZoom: function (zoom) {
            this.options.minZoom = zoom;

            if (this._loaded && this.getZoom() < this.options.minZoom) {
                return this.setZoom(zoom);
            }

            return this;
        },

        // @method setMaxZoom(zoom: Number): this
        // Sets the upper limit for the available zoom levels (see the [maxZoom](#map-maxzoom) option).
        setMaxZoom: function (zoom) {
            this.options.maxZoom = zoom;

            if (this._loaded && (this.getZoom() > this.options.maxZoom)) {
                return this.setZoom(zoom);
            }

            return this;
        },

        // @method panInsideBounds(bounds: LatLngBounds, options?: Pan options): this
        // Pans the map to the closest view that would lie inside the given bounds (if it's not already), controlling the animation using the options specific, if any.
        panInsideBounds: function (bounds, options) {
            this._enforcingBounds = true;
            var center = this.getCenter(),
                newCenter = this._limitCenter(center, this._zoom, L.latLngBounds(bounds));

            if (!center.equals(newCenter)) {
                this.panTo(newCenter, options);
            }

            this._enforcingBounds = false;
            return this;
        },

        // @method invalidateSize(options: Zoom/Pan options): this
        // Checks if the map container size changed and updates the map if so 
        // call it after you've changed the map size dynamically, also animating
        // pan by default. If `options.pan` is `false`, panning will not occur.
        // If `options.debounceMoveend` is `true`, it will delay `moveend` event so
        // that it doesn't happen often even if the method is called many
        // times in a row.

        // @alternative
        // @method invalidateSize(animate: Boolean): this
        // Checks if the map container size changed and updates the map if so 
        // call it after you've changed the map size dynamically, also animating
        // pan by default.
        invalidateSize: function (options) {
            if (!this._loaded) { return this; }

            options = L.extend({
                animate: false,
                pan: true
            }, options === true ? {animate: true} : options);

            var oldSize = this.getSize();
            this._sizeChanged = true;
            this._lastCenter = null;

            var newSize = this.getSize(),
                oldCenter = oldSize.divideBy(2).round(),
                newCenter = newSize.divideBy(2).round(),
                offset = oldCenter.subtract(newCenter);

            if (!offset.x && !offset.y) { return this; }

            if (options.animate && options.pan) {
                this.panBy(offset);

            } else {
                if (options.pan) {
                    this._rawPanBy(offset);
                }

                this.fire('move');

                if (options.debounceMoveend) {
                    clearTimeout(this._sizeTimer);
                    this._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);
                } else {
                    this.fire('moveend');
                }
            }

            // @section Map state change events
            // @event resize: Event
            // Fired when the map is resized.
            return this.fire('resize', {
                oldSize: oldSize,
                newSize: newSize
            });
        },

        // @section Methods for modifying map state
        // @method stop(): this
        // Stops the currently running `panTo` or `flyTo` animation, if any.
        stop: function () {
            this.setZoom(this._limitZoom(this._zoom));
            if (!this.options.zoomSnap) {
                this.fire('viewreset');
            }
            return this._stop();
        },


        // TODO handler.addTo
        // TODO Appropiate docs section?
        // @section Other Methods
        // @method addHandler(name: String, HandlerClass: Function): this
        // Adds a new `Handler` to the map, given its name and constructor function.
        addHandler: function (name, HandlerClass) {
            if (!HandlerClass) { return this; }

            var handler = this[name] = new HandlerClass(this);

            this._handlers.push(handler);

            if (this.options[name]) {
                handler.enable();
            }

            return this;
        },

        // @method remove(): this
        // Destroys the map and clears all related event listeners.
        remove: function () {

            this._initEvents(true);

            try {
                // throws error in IE6-8
                delete this._container._leaflet;
            } catch (e) {
                this._container._leaflet = undefined;
            }

            L.DomUtil.remove(this._mapPane);

            if (this._clearControlPos) {
                this._clearControlPos();
            }

            this._clearHandlers();

            if (this._loaded) {
                // @section Map state change events
                // @event unload: Event
                // Fired when the map is destroyed with [remove](#map-remove) method.
                this.fire('unload');
            }

            for (var i in this._layers) {
                this._layers[i].remove();
            }

            return this;
        },

        // @section Other Methods
        // @method createPane(name: String, container?: HTMLElement): HTMLElement
        // Creates a new map pane with the given name if it doesn't exist already,
        // then returns it. The pane is created as a children of `container`, or
        // as a children of the main map pane if not set.
        createPane: function (name, container) {
            var className = 'leaflet-pane' + (name ? ' leaflet-' + name.replace('Pane', '') + '-pane' : ''),
                pane = L.DomUtil.create('div', className, container || this._mapPane);

            if (name) {
                this._panes[name] = pane;
            }
            return pane;
        },

        // @section Methods for Getting Map State

        // @method getCenter(): LatLng
        // Returns the geographical center of the map view
        getCenter: function () {
            this._checkIfLoaded();

            if (this._lastCenter && !this._moved()) {
                return this._lastCenter;
            }
            return this.layerPointToLatLng(this._getCenterLayerPoint());
        },

        // @method getZoom(): Number
        // Returns the current zoom level of the map view
        getZoom: function () {
            return this._zoom;
        },

        // @method getBounds(): LatLngBounds
        // Returns the geographical bounds visible in the current map view
        getBounds: function () {
            var bounds = this.getPixelBounds(),
                sw = this.unproject(bounds.getBottomLeft()),
                ne = this.unproject(bounds.getTopRight());

            return new L.LatLngBounds(sw, ne);
        },

        // @method getMinZoom(): Number
        // Returns the minimum zoom level of the map (if set in the `minZoom` option of the map or of any layers), or `0` by default.
        getMinZoom: function () {
            return this.options.minZoom === undefined ? this._layersMinZoom || 0 : this.options.minZoom;
        },

        // @method getMaxZoom(): Number
        // Returns the maximum zoom level of the map (if set in the `maxZoom` option of the map or of any layers).
        getMaxZoom: function () {
            return this.options.maxZoom === undefined ?
                (this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :
                this.options.maxZoom;
        },

        // @method getBoundsZoom(bounds: LatLngBounds, inside?: Boolean): Number
        // Returns the maximum zoom level on which the given bounds fit to the map
        // view in its entirety. If `inside` (optional) is set to `true`, the method
        // instead returns the minimum zoom level on which the map view fits into
        // the given bounds in its entirety.
        getBoundsZoom: function (bounds, inside, padding) { // (LatLngBounds[, Boolean, Point]) -> Number
            bounds = L.latLngBounds(bounds);
            padding = L.point(padding || [0, 0]);

            var zoom = this.getZoom() || 0,
                min = this.getMinZoom(),
                max = this.getMaxZoom(),
                nw = bounds.getNorthWest(),
                se = bounds.getSouthEast(),
                size = this.getSize(),
                boundsSize = this.project(se, zoom).subtract(this.project(nw, zoom)).add(padding),
                snap = L.Browser.any3d ? this.options.zoomSnap : 1;

            var scale = Math.min(size.x / boundsSize.x, size.y / boundsSize.y);
            zoom = this.getScaleZoom(scale, zoom);

            if (snap) {
                zoom = Math.round(zoom / (snap / 100)) * (snap / 100); // don't jump if within 1% of a snap level
                zoom = inside ? Math.ceil(zoom / snap) * snap : Math.floor(zoom / snap) * snap;
            }

            return Math.max(min, Math.min(max, zoom));
        },

        // @method getSize(): Point
        // Returns the current size of the map container (in pixels).
        getSize: function () {
            if (!this._size || this._sizeChanged) {
                this._size = new L.Point(
                    VanUtils.getDomWidth(this._container), VanUtils.getDomHeight(this._container)
                );

                this._sizeChanged = false;
            }
            return this._size.clone();
        },

        // @method getPixelBounds(): Bounds
        // Returns the bounds of the current map view in projected pixel
        // coordinates (sometimes useful in layer and overlay implementations).
        getPixelBounds: function (center, zoom) {
            var topLeftPoint = this._getTopLeftPoint(center, zoom);
            return new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));
        },

        // TODO: Check semantics - isn't the pixel origin the 0,0 coord relative to
        // the map pane? "left point of the map layer" can be confusing, specially
        // since there can be negative offsets.
        // @method getPixelOrigin(): Point
        // Returns the projected pixel coordinates of the top left point of
        // the map layer (useful in custom layer and overlay implementations).
        getPixelOrigin: function () {
            this._checkIfLoaded();
            return this._pixelOrigin;
        },

        // @method getPixelWorldBounds(zoom?: Number): Bounds
        // Returns the world's bounds in pixel coordinates for zoom level `zoom`.
        // If `zoom` is omitted, the map's current zoom level is used.
        getPixelWorldBounds: function (zoom) {
            return this.options.crs.getProjectedBounds(zoom === undefined ? this.getZoom() : zoom);
        },

        // @section Other Methods

        // @method getPane(pane: String|HTMLElement): HTMLElement
        // Returns a map pane, given its name or its HTML element (its identity).
        getPane: function (pane) {
            return typeof pane === 'string' ? this._panes[pane] : pane;
        },

        // @method getPanes(): Object
        // Returns a plain object containing the names of all panes as keys and
        // the panes as values.
        getPanes: function () {
            return this._panes;
        },

        // @method getContainer: HTMLElement
        // Returns the HTML element that contains the map.
        getContainer: function () {
            return this._container;
        },


        // @section Conversion Methods

        // @method getZoomScale(toZoom: Number, fromZoom: Number): Number
        // Returns the scale factor to be applied to a map transition from zoom level
        // `fromZoom` to `toZoom`. Used internally to help with zoom animations.
        getZoomScale: function (toZoom, fromZoom) {
            // TODO replace with universal implementation after refactoring projections
            var crs = this.options.crs;
            fromZoom = fromZoom === undefined ? this._zoom : fromZoom;
            return crs.scale(toZoom) / crs.scale(fromZoom);
        },

        // @method getScaleZoom(scale: Number, fromZoom: Number): Number
        // Returns the zoom level that the map would end up at, if it is at `fromZoom`
        // level and everything is scaled by a factor of `scale`. Inverse of
        // [`getZoomScale`](#map-getZoomScale).
        getScaleZoom: function (scale, fromZoom) {
            var crs = this.options.crs;
            fromZoom = fromZoom === undefined ? this._zoom : fromZoom;
            return crs.zoom(scale * crs.scale(fromZoom));
        },

        // @method project(latlng: LatLng, zoom: Number): Point
        // Projects a geographical coordinate `LatLng` according to the projection
        // of the map's CRS, then scales it according to `zoom` and the CRS's
        // `Transformation`. The result is pixel coordinate relative to
        // the CRS origin.
        project: function (latlng, zoom) {
            zoom = zoom === undefined ? this._zoom : zoom;
            return this.options.crs.latLngToPoint(L.latLng(latlng), zoom);
        },

        // @method unproject(point: Point, zoom: Number): LatLng
        // Inverse of [`project`](#map-project).
        unproject: function (point, zoom) {
            zoom = zoom === undefined ? this._zoom : zoom;
            return this.options.crs.pointToLatLng(L.point(point), zoom);
        },

        // @method layerPointToLatLng(point: Point): LatLng
        // Given a pixel coordinate relative to the [origin pixel](#map-getpixelorigin),
        // returns the corresponding geographical coordinate (for the current zoom level).
        layerPointToLatLng: function (point) {
            var projectedPoint = L.point(point).add(this.getPixelOrigin());
            return this.unproject(projectedPoint);
        },

        // @method latLngToLayerPoint(latlng: LatLng): Point
        // Given a geographical coordinate, returns the corresponding pixel coordinate
        // relative to the [origin pixel](#map-getpixelorigin).
        latLngToLayerPoint: function (latlng) {
            var projectedPoint = this.project(L.latLng(latlng))._round();
            return projectedPoint._subtract(this.getPixelOrigin());
        },

        // @method wrapLatLng(latlng: LatLng): LatLng
        // Returns a `LatLng` where `lat` and `lng` has been wrapped according to the
        // map's CRS's `wrapLat` and `wrapLng` properties, if they are outside the
        // CRS's bounds.
        // By default this means longitude is wrapped around the dateline so its
        // value is between -180 and +180 degrees.
        wrapLatLng: function (latlng) {
            return this.options.crs.wrapLatLng(L.latLng(latlng));
        },

        // @method distance(latlng1: LatLng, latlng2: LatLng): Number
        // Returns the distance between two geographical coordinates according to
        // the map's CRS. By default this measures distance in meters.
        distance: function (latlng1, latlng2) {
            return this.options.crs.distance(L.latLng(latlng1), L.latLng(latlng2));
        },

        // @method containerPointToLayerPoint(point: Point): Point
        // Given a pixel coordinate relative to the map container, returns the corresponding
        // pixel coordinate relative to the [origin pixel](#map-getpixelorigin).
        containerPointToLayerPoint: function (point) { // (Point)
            return L.point(point).subtract(this._getMapPanePos());
        },

        // @method layerPointToContainerPoint(point: Point): Point
        // Given a pixel coordinate relative to the [origin pixel](#map-getpixelorigin),
        // returns the corresponding pixel coordinate relative to the map container.
        layerPointToContainerPoint: function (point) { // (Point)
            return L.point(point).add(this._getMapPanePos());
        },

        // @method containerPointToLatLng(point: Point): Point
        // Given a pixel coordinate relative to the map container, returns
        // the corresponding geographical coordinate (for the current zoom level).
        containerPointToLatLng: function (point) {
            var layerPoint = this.containerPointToLayerPoint(L.point(point));
            return this.layerPointToLatLng(layerPoint);
        },

        // @method latLngToContainerPoint(latlng: LatLng): Point
        // Given a geographical coordinate, returns the corresponding pixel coordinate
        // relative to the map container.
        latLngToContainerPoint: function (latlng) {
            return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));
        },

        // @method mouseEventToContainerPoint(ev: MouseEvent): Point
        // Given a MouseEvent object, returns the pixel coordinate relative to the
        // map container where the event took place.
        mouseEventToContainerPoint: function (e) {
            return L.DomEvent.getMousePosition(e, this._container);
        },

        // @method mouseEventToLayerPoint(ev: MouseEvent): Point
        // Given a MouseEvent object, returns the pixel coordinate relative to
        // the [origin pixel](#map-getpixelorigin) where the event took place.
        mouseEventToLayerPoint: function (e) {
            return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));
        },

        // @method mouseEventToLatLng(ev: MouseEvent): LatLng
        // Given a MouseEvent object, returns geographical coordinate where the
        // event took place.
        mouseEventToLatLng: function (e) { // (MouseEvent)
            return this.layerPointToLatLng(this.mouseEventToLayerPoint(e));
        },


        // map initialization methods

        _initContainer: function (id) {
            var container = this._container = L.DomUtil.get(id);

            if (!container) {
                throw new Error('Map container not found.');
            } else if (container._leaflet) {
                throw new Error('Map container is already initialized.');
            }

            L.DomEvent.addListener(container, 'scroll', this._onScroll, this);
            container._leaflet = true;
        },

        _initLayout: function () {
            var container = this._container;

            this._fadeAnimated = this.options.fadeAnimation && L.Browser.any3d;

            L.DomUtil.addClass(container, 'leaflet-container' +
                (L.Browser.touch ? ' leaflet-touch' : '') +
                (L.Browser.retina ? ' leaflet-retina' : '') +
                (L.Browser.ielt9 ? ' leaflet-oldie' : '') +
                (L.Browser.safari ? ' leaflet-safari' : '') +
                (this._fadeAnimated ? ' leaflet-fade-anim' : ''));

            var position = L.DomUtil.getStyle(container, 'position');

            if (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {
                container.style.position = 'relative';
            }

            this._initPanes();

            if (this._initControlPos) {
                this._initControlPos();
            }
        },

        _initPanes: function () {
            var panes = this._panes = {};
            this._paneRenderers = {};

            // @section
            //
            // Panes are DOM elements used to control the ordering of layers on the map. You
            // can access panes with [`map.getPane`](#map-getpane) or
            // [`map.getPanes`](#map-getpanes) methods. New panes can be created with the
            // [`map.createPane`](#map-createpane) method.
            //
            // Every map has the following default panes that differ only in zIndex.
            //
            // @pane mapPane: HTMLElement = 'auto'
            // Pane that contains all other map panes

            this._mapPane = this.createPane('mapPane', this._container);
            L.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));

            // @pane tilePane: HTMLElement = 2
            // Pane for tile layers
            this.createPane('tilePane');
            // @pane overlayPane: HTMLElement = 4
            // Pane for overlays like polylines and polygons
            this.createPane('shadowPane');
            // @pane shadowPane: HTMLElement = 5
            // Pane for overlay shadows (e.g. marker shadows)
            this.createPane('overlayPane');
            // @pane markerPane: HTMLElement = 6
            // Pane for marker icons
            this.createPane('markerPane');
            // @pane popupPane: HTMLElement = 7
            // Pane for popups.
            this.createPane('popupPane');

            if (!this.options.markerZoomAnimation) {
                L.DomUtil.addClass(panes.markerPane, 'leaflet-zoom-hide');
                L.DomUtil.addClass(panes.shadowPane, 'leaflet-zoom-hide');
            }
        },


        // private methods that modify map state

        // @section Map state change events
        _resetView: function (center, zoom) {
            L.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));

            var loading = !this._loaded;
            this._loaded = true;
            zoom = this._limitZoom(zoom);

            this.fire('viewprereset');

            var zoomChanged = this._zoom !== zoom;
            this
                ._moveStart(zoomChanged)
                ._move(center, zoom)
                ._moveEnd(zoomChanged);

            // @event viewreset: Event
            // Fired when the map needs to redraw its content (this usually happens
            // on map zoom or load). Very useful for creating custom overlays.
            this.fire('viewreset');

            // @event load: Event
            // Fired when the map is initialized (when its center and zoom are set
            // for the first time).
            if (loading) {
                this.fire('load');
            }
        },

        _moveStart: function (zoomChanged) {
            // @event zoomstart: Event
            // Fired when the map zoom is about to change (e.g. before zoom animation).
            // @event movestart: Event
            // Fired when the view of the map starts changing (e.g. user starts dragging the map).
            if (zoomChanged) {
                this.fire('zoomstart');
            }
            return this.fire('movestart');
        },

        _move: function (center, zoom, data) {
            if (zoom === undefined) {
                zoom = this._zoom;
            }
            var zoomChanged = this._zoom !== zoom;

            this._zoom = zoom;
            this._lastCenter = center;
            this._pixelOrigin = this._getNewPixelOrigin(center);

            // @event zoom: Event
            // Fired repeteadly during any change in zoom level, including zoom
            // and fly animations.
            if (zoomChanged || (data && data.pinch)) {	// Always fire 'zoom' if pinching because #3530
                this.fire('zoom', data);
            }

            // @event move: Event
            // Fired repeteadly during any movement of the map, including pan and
            // fly animations.
            return this.fire('move', data);
        },

        _moveEnd: function (zoomChanged) {
            // @event zoomend: Event
            // Fired when the map has changed, after any animations.
            if (zoomChanged) {
                this.fire('zoomend');
            }

            // @event moveend: Event
            // Fired when the center of the map stops changing (e.g. user stopped
            // dragging the map).
            return this.fire('moveend');
        },

        _stop: function () {
            L.Util.cancelAnimFrame(this._flyToFrame);
            if (this._panAnim) {
                this._panAnim.stop();
            }
            return this;
        },

        _rawPanBy: function (offset) {
            L.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));
        },

        _getZoomSpan: function () {
            return this.getMaxZoom() - this.getMinZoom();
        },

        _panInsideMaxBounds: function () {
            if (!this._enforcingBounds) {
                this.panInsideBounds(this.options.maxBounds);
            }
        },

        _checkIfLoaded: function () {
            if (!this._loaded) {
                throw new Error('Set map center and zoom first.');
            }
        },

        // DOM event handling

        // @section Interaction events
        _initEvents: function (remove) {
            if (!L.DomEvent) { return; }

            this._targets = {};
            this._targets[L.stamp(this._container)] = this;

            var onOff = remove ? 'off' : 'on';

            // @event click: MouseEvent
            // Fired when the user clicks (or taps) the map.
            // @event dblclick: MouseEvent
            // Fired when the user double-clicks (or double-taps) the map.
            // @event mousedown: MouseEvent
            // Fired when the user pushes the mouse button on the map.
            // @event mouseup: MouseEvent
            // Fired when the user releases the mouse button on the map.
            // @event mouseover: MouseEvent
            // Fired when the mouse enters the map.
            // @event mouseout: MouseEvent
            // Fired when the mouse leaves the map.
            // @event mousemove: MouseEvent
            // Fired while the mouse moves over the map.
            // @event contextmenu: MouseEvent
            // Fired when the user pushes the right mouse button on the map, prevents
            // default browser context menu from showing if there are listeners on
            // this event. Also fired on mobile when the user holds a single touch
            // for a second (also called long press).
            // @event keypress: Event
            // Fired when the user presses a key from the keyboard while the map is focused.
            L.DomEvent[onOff](this._container, 'click dblclick mousedown mouseup ' +
                'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);

            if (this.options.trackResize) {
                L.DomEvent[onOff](window, 'resize', this._onResize, this);
            }

            if (L.Browser.any3d && this.options.transform3DLimit) {
                this[onOff]('moveend', this._onMoveEnd);
            }
        },

        _onResize: function () {
            this._sizeChanged = true;

            L.Util.cancelAnimFrame(this._resizeRequest);
            this._resizeRequest = L.Util.requestAnimFrame(
                function () { this.invalidateSize({debounceMoveend: true}); }, this);
        },

        _onScroll: function () {
            this._container.scrollTop  = 0;
            this._container.scrollLeft = 0;
        },

        _onMoveEnd: function () {
            var pos = this._getMapPanePos();
            if (Math.max(Math.abs(pos.x), Math.abs(pos.y)) >= this.options.transform3DLimit) {
                // https://bugzilla.mozilla.org/show_bug.cgi?id=1203873 but Webkit also have
                // a pixel offset on very high values, see: http://jsfiddle.net/dg6r5hhb/
                this._resetView(this.getCenter(), this.getZoom());
            }
        },

        _findEventTargets: function (e, type) {
            var targets = [], vanchart = this.vanchart,
                target,
                isHover = type === 'mouseout' || type === 'mouseover',
                src = e.target || e.srcElement,
                dragging = false;

            //by position
            if(vanchart.isHeatMap()){
                var dataPoint = vanchart.handler._getCanvasClosestPoint(this.mouseEventToContainerPoint(e));
                if(dataPoint){
                    if(!dataPoint._events){
                        dataPoint.getEvents && dataPoint.on(dataPoint.getEvents(), dataPoint);
                    }
                    if(dataPoint.listens(type, true)){
                        targets.push(dataPoint);
                    }
                }else{
                    vanchart.hideTooltip();
                }
            }

            while (src) {
                target = this._targets[L.stamp(src)];
                if (target && (type === 'click' || type === 'preclick') && !e._simulated && this._draggableMoved(target)) {
                    // Prevent firing click after you just dragged an object.
                    dragging = true;
                    break;
                }
                if (target && target.listens(type, true)) {
                    if (isHover && !L.DomEvent._isExternalTarget(src, e)) { break; }
                    targets.push(target);
                    if (isHover) { break; }
                }
                if (src === this._container) { break; }
                src = src.parentNode;
            }
            if (!targets.length && !dragging && !isHover && L.DomEvent._isExternalTarget(src, e)) {
                targets = [this];
            }
            return targets;
        },

        _handleDOMEvent: function (e) {
            if (!this._loaded || L.DomEvent._skipped(e)) { return; }

            var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;

            if (e.type === 'click') {
                // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).
                // @event preclick: MouseEvent
                // Fired before mouse click on the map (sometimes useful when you
                // want something to happen on click before any existing click
                // handlers start running).
                var synth = L.Util.extend({}, e);
                synth.type = 'preclick';
                this._handleDOMEvent(synth);
            }

            if (type === 'mousedown') {
                // prevents outline when clicking on keyboard-focusable element
                L.DomUtil.preventOutline(e.target || e.srcElement);
            }

            this._fireDOMEvent(e, type);
        },

        _fireDOMEvent: function (e, type, targets) {

            if (e._stopped) { return; }

            // Find the layer the event is propagating from and its parents.
            targets = (targets || []).concat(this._findEventTargets(e, type));

            if (!targets.length) { return; }

            var target = targets[0];
            if (type === 'contextmenu' && target.listens(type, true)) {
                L.DomEvent.preventDefault(e);
            }

            var data = {
                originalEvent: e
            };

            if (e.type !== 'keypress') {
                var isMarker = target instanceof L.Marker;
                data.containerPoint = isMarker ?
                    this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);
                data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);
                data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);
            }

            for (var i = 0; i < targets.length; i++) {
                targets[i].fire(type, data, true);
                if (data.originalEvent._stopped ||
                    (targets[i].options.nonBubblingEvents && L.Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }
            }
        },

        _draggableMoved: function (obj) {
            obj = obj.options.draggable ? obj : this;
            return (obj.dragging && obj.dragging.moved()) || (this.boxZoom && this.boxZoom.moved());
        },

        _clearHandlers: function () {
            for (var i = 0, len = this._handlers.length; i < len; i++) {
                this._handlers[i].disable();
            }
        },

        // @section Other Methods

        // @method whenReady(fn: Function, context?: Object): this
        // Runs the given function `fn` when the map gets initialized with
        // a view (center and zoom) and at least one layer, or immediately
        // if it's already initialized, optionally passing a function context.
        whenReady: function (callback, context) {
            if (this._loaded) {
                callback.call(context || this, {target: this});
            } else {
                this.on('load', callback, context);
            }
            return this;
        },


        // private methods for getting map state

        _getMapPanePos: function () {
            return L.DomUtil.getPosition(this._mapPane) || new L.Point(0, 0);
        },

        _moved: function () {
            var pos = this._getMapPanePos();
            return pos && !pos.equals([0, 0]);
        },

        _getTopLeftPoint: function (center, zoom) {
            var pixelOrigin = center && zoom !== undefined ?
                this._getNewPixelOrigin(center, zoom) :
                this.getPixelOrigin();
            return pixelOrigin.subtract(this._getMapPanePos());
        },

        _getNewPixelOrigin: function (center, zoom) {
            var viewHalf = this.getSize()._divideBy(2);
            return this.project(center, zoom)._subtract(viewHalf)._add(this._getMapPanePos())._round();
        },

        _latLngToNewLayerPoint: function (latlng, zoom, center) {
            var topLeft = this._getNewPixelOrigin(center, zoom);
            return this.project(latlng, zoom)._subtract(topLeft);
        },

        // layer point of the current center
        _getCenterLayerPoint: function () {
            return this.containerPointToLayerPoint(this.getSize()._divideBy(2));
        },

        // offset of the specified place to the current center in pixels
        _getCenterOffset: function (latlng) {
            return this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());
        },

        // adjust center for view to get inside bounds
        _limitCenter: function (center, zoom, bounds) {

            if (!bounds) { return center; }

            var centerPoint = this.project(center, zoom),
                viewHalf = this.getSize().divideBy(2),
                viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),
                offset = this._getBoundsOffset(viewBounds, bounds, zoom);

            // If offset is less than a pixel, ignore.
            // This prevents unstable projections from getting into
            // an infinite loop of tiny offsets.
            if (offset.round().equals([0, 0])) {
                return center;
            }

            return this.unproject(centerPoint.add(offset), zoom);
        },

        // adjust offset for view to get inside bounds
        _limitOffset: function (offset, bounds) {
            if (!bounds) { return offset; }

            var viewBounds = this.getPixelBounds(),
                newBounds = new L.Bounds(viewBounds.min.add(offset), viewBounds.max.add(offset));

            return offset.add(this._getBoundsOffset(newBounds, bounds));
        },

        // returns offset needed for pxBounds to get inside maxBounds at a specified zoom
        _getBoundsOffset: function (pxBounds, maxBounds, zoom) {
            var projectedMaxBounds = L.bounds(
                this.project(maxBounds.getNorthEast(), zoom),
                this.project(maxBounds.getSouthWest(), zoom)
                ),
                minOffset = projectedMaxBounds.min.subtract(pxBounds.min),
                maxOffset = projectedMaxBounds.max.subtract(pxBounds.max),

                dx = this._rebound(minOffset.x, -maxOffset.x),
                dy = this._rebound(minOffset.y, -maxOffset.y);

            return new L.Point(dx, dy);
        },

        _rebound: function (left, right) {
            return left + right > 0 ?
            Math.round(left - right) / 2 :
            Math.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));
        },

        _limitZoom: function (zoom) {
            var min = this.getMinZoom(),
                max = this.getMaxZoom(),
                snap = L.Browser.any3d ? this.options.zoomSnap : 1;
            if (snap) {
                zoom = Math.round(zoom / snap) * snap;
            }
            return Math.max(min, Math.min(max, zoom));
        }
    });

// @section

// @factory L.map(id: String, options?: Map options)
// Instantiates a map object given the DOM ID of a `<div>` element
// and optionally an object literal with `Map options`.
//
// @alternative
// @factory L.map(el: HTMLElement, options?: Map options)
// Instantiates a map object given an instance of a `<div>` HTML element
// and optionally an object literal with `Map options`.
    L.map = function (id, options) {
        return new L.Map(id, options);
    };




    /*
     * @class Layer
     * @inherits Evented
     * @aka L.Layer
     * @aka ILayer
     *
     * A set of methods from the Layer base class that all Leaflet layers use.
     * Inherits all methods, options and events from `L.Evented`.
     *
     * @example
     *
     * ```js
     * var layer = L.Marker(latlng).addTo(map);
     * layer.addTo(map);
     * layer.remove();
     * ```
     *
     * @event add: Event
     * Fired after the layer is added to a map
     *
     * @event remove: Event
     * Fired after the layer is removed from a map
     */


    L.Layer = L.Evented.extend({

        // Classes extending `L.Layer` will inherit the following options:
        options: {
            // @option pane: String = 'overlayPane'
            // By default the layer will be added to the map's [overlay pane](#map-overlaypane). Overriding this option will cause the layer to be placed on another pane by default.
            pane: 'overlayPane',
            nonBubblingEvents: []  // Array of events that should not be bubbled to DOM parents (like the map)
        },

        /* @section
         * Classes extending `L.Layer` will inherit the following methods:
         *
         * @method addTo(map: Map): this
         * Adds the layer to the given map
         */
        addTo: function (map) {
            map.addLayer(this);
            return this;
        },

        // @method remove: this
        // Removes the layer from the map it is currently active on.
        remove: function () {
            return this.removeFrom(this._map || this._mapToAdd);
        },

        // @method removeFrom(map: Map): this
        // Removes the layer from the given map
        removeFrom: function (obj) {
            if (obj) {
                obj.removeLayer(this);
            }
            return this;
        },

        // @method getPane(name? : String): HTMLElement
        // Returns the `HTMLElement` representing the named pane on the map. If `name` is omitted, returns the pane for this layer.
        getPane: function (name) {
            return this._map.getPane(name ? (this.options[name] || name) : this.options.pane);
        },

        addInteractiveTarget: function (targetEl) {
            this._map._targets[L.stamp(targetEl)] = this;
            return this;
        },

        removeInteractiveTarget: function (targetEl) {
            delete this._map._targets[L.stamp(targetEl)];
            return this;
        },

        _layerAdd: function (e) {
            var map = e.target;

            // check in case layer gets added and then removed before the map is ready
            if (!map.hasLayer(this)) { return; }

            this._map = map;
            this._zoomAnimated = map._zoomAnimated;

            if (this.getEvents) {
                map.on(this.getEvents(), this);
            }

            this.onAdd(map);

            if (this.getAttribution && this._map.attributionControl) {
                this._map.attributionControl.addAttribution(this.getAttribution());
            }

            this.fire('add');
            map.fire('layeradd', {layer: this});
        }
    });

    /* @section Extension methods
     * @uninheritable
     *
     * Every layer should extend from `L.Layer` and (re-)implement the following methods.
     *
     * @method onAdd(map: Map): this
     * Should contain code that creates DOM elements for the layer, adds them to `map panes` where they should belong and puts listeners on relevant map events. Called on [`map.addLayer(layer)`](#map-addlayer).
     *
     * @method onRemove(map: Map): this
     * Should contain all clean up code that removes the layer's elements from the DOM and removes listeners previously added in [`onAdd`](#layer-onadd). Called on [`map.removeLayer(layer)`](#map-removelayer).
     *
     * @method getEvents(): Object
     * This optional method should return an object like `{ viewreset: this._reset }` for [`addEventListener`](#event-addeventlistener). These events will be automatically added and removed from the map with your layer.
     *
     * @method getAttribution(): String
     * This optional method should return a string containing HTML to be shown on the `Attribution control` whenever the layer is visible.
     *
     * @method beforeAdd(map: Map): this
     * Optional method. Called on [`map.addLayer(layer)`](#map-addlayer), before the layer is added to the map, before events are initialized, without waiting until the map is in a usable state. Use for early initialization only.
     */


    /* @namespace Map
     * @section Layer events
     *
     * @event layeradd: LayerEvent
     * Fired when a new layer is added to the map.
     *
     * @event layerremove: LayerEvent
     * Fired when some layer is removed from the map
     *
     * @section Methods for Layers and Controls
     */
    L.Map.include({
        // @method addLayer(layer: Layer): this
        // Adds the given layer to the map
        addLayer: function (layer) {
            var id = L.stamp(layer);
            if (this._layers[id]) { return layer; }
            this._layers[id] = layer;

            layer._mapToAdd = this;

            if (layer.beforeAdd) {
                layer.beforeAdd(this);
            }

            this.whenReady(layer._layerAdd, layer);

            return this;
        },

        // @method removeLayer(layer: Layer): this
        // Removes the given layer from the map.
        removeLayer: function (layer) {
            var id = L.stamp(layer);

            if (!this._layers[id]) { return this; }

            if (this._loaded) {
                layer.onRemove(this);
            }

            if (layer.getAttribution && this.attributionControl) {
                this.attributionControl.removeAttribution(layer.getAttribution());
            }

            if (layer.getEvents) {
                this.off(layer.getEvents(), layer);
            }

            delete this._layers[id];

            if (this._loaded) {
                this.fire('layerremove', {layer: layer});
                layer.fire('remove');
            }

            layer._map = layer._mapToAdd = null;

            return this;
        },

        // @method hasLayer(layer: Layer): Boolean
        // Returns `true` if the given layer is currently added to the map
        hasLayer: function (layer) {
            return !!layer && (L.stamp(layer) in this._layers);
        },

        /* @method eachLayer(fn: Function, context?: Object): this
         * Iterates over the layers of the map, optionally specifying context of the iterator function.
         * ```
         * map.eachLayer(function(layer){
         *     layer.bindPopup('Hello');
         * });
         * ```
         */
        eachLayer: function (method, context) {
            for (var i in this._layers) {
                method.call(context, this._layers[i]);
            }
            return this;
        },

        _addLayers: function (layers) {
            layers = layers ? (L.Util.isArray(layers) ? layers : [layers]) : [];

            for (var i = 0, len = layers.length; i < len; i++) {
                this.addLayer(layers[i]);
            }
        },

        _addZoomLimit: function (layer) {
            if (isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom)) {
                this._zoomBoundLayers[L.stamp(layer)] = layer;
                this._updateZoomLevels();
            }
        },

        _removeZoomLimit: function (layer) {
            var id = L.stamp(layer);

            if (this._zoomBoundLayers[id]) {
                delete this._zoomBoundLayers[id];
                this._updateZoomLevels();
            }
        },

        _updateZoomLevels: function () {
            var minZoom = Infinity,
                maxZoom = -Infinity,
                oldZoomSpan = this._getZoomSpan();

            for (var i in this._zoomBoundLayers) {
                var options = this._zoomBoundLayers[i].options;

                minZoom = options.minZoom === undefined ? minZoom : Math.min(minZoom, options.minZoom);
                maxZoom = options.maxZoom === undefined ? maxZoom : Math.max(maxZoom, options.maxZoom);
            }

            this._layersMaxZoom = maxZoom === -Infinity ? undefined : maxZoom;
            this._layersMinZoom = minZoom === Infinity ? undefined : minZoom;

            // @section Map state change events
            // @event zoomlevelschange: Event
            // Fired when the number of zoomlevels on the map is changed due
            // to adding or removing a layer.
            if (oldZoomSpan !== this._getZoomSpan()) {
                this.fire('zoomlevelschange');
            }
        }
    });



    /*
     * @namespace Projection
     * @projection L.Projection.Mercator
     *
     * Elliptical Mercator projection  more complex than Spherical Mercator. Takes into account that Earth is a geoid, not a perfect sphere. Used by the EPSG:3395 CRS.
     */

    L.Projection.Mercator = {
        R: 6378137,
        R_MINOR: 6356752.314245179,

        bounds: L.bounds([-20037508.34279, -15496570.73972], [20037508.34279, 18764656.23138]),

        project: function (latlng) {
            var d = Math.PI / 180,
                r = this.R,
                y = latlng.lat * d,
                tmp = this.R_MINOR / r,
                e = Math.sqrt(1 - tmp * tmp),
                con = e * Math.sin(y);

            var ts = Math.tan(Math.PI / 4 - y / 2) / Math.pow((1 - con) / (1 + con), e / 2);
            y = -r * Math.log(Math.max(ts, 1E-10));

            return new L.Point(latlng.lng * d * r, y);
        },

        unproject: function (point) {
            var d = 180 / Math.PI,
                r = this.R,
                tmp = this.R_MINOR / r,
                e = Math.sqrt(1 - tmp * tmp),
                ts = Math.exp(-point.y / r),
                phi = Math.PI / 2 - 2 * Math.atan(ts);

            for (var i = 0, dphi = 0.1, con; i < 15 && Math.abs(dphi) > 1e-7; i++) {
                con = e * Math.sin(phi);
                con = Math.pow((1 - con) / (1 + con), e / 2);
                dphi = Math.PI / 2 - 2 * Math.atan(ts * con) - phi;
                phi += dphi;
            }

            return new L.LatLng(phi * d, point.x * d / r);
        }
    };



    /*
     * @namespace CRS
     * @crs L.CRS.EPSG3395
     *
     * Rarely used by some commercial tile providers. Uses Elliptical Mercator projection.
     */

    L.CRS.EPSG3395 = L.extend({}, L.CRS.Earth, {
        code: 'EPSG:3395',
        projection: L.Projection.Mercator,

        transformation: (function () {
            var scale = 0.5 / (Math.PI * L.Projection.Mercator.R);
            return new L.Transformation(scale, 0.5, -scale, 0.5);
        }())
    });



    /*
     * @class GridLayer
     * @inherits Layer
     * @aka L.GridLayer
     *
     * Generic class for handling a tiled grid of HTML elements. This is the base class for all tile layers and replaces `TileLayer.Canvas`.
     * GridLayer can be extended to create a tiled grid of HTML Elements like `<canvas>`, `<img>` or `<div>`. GridLayer will handle creating and animating these DOM elements for you.
     *
     *
     * @section Synchronous usage
     * @example
     *
     * To create a custom layer, extend GridLayer and impliment the `createTile()` method, which will be passed a `Point` object with the `x`, `y`, and `z` (zoom level) coordinates to draw your tile.
     *
     * ```js
     * var CanvasLayer = L.GridLayer.extend({
     *     createTile: function(coords){
     *         // create a <canvas> element for drawing
     *         var tile = L.DomUtil.create('canvas', 'leaflet-tile');
     *
     *         // setup tile width and height according to the options
     *         var size = this.getTileSize();
     *         tile.width = size.x;
     *         tile.height = size.y;
     *
     *         // get a canvas context and draw something on it using coords.x, coords.y and coords.z
     *         var ctx = canvas.getContext('2d');
     *
     *         // return the tile so it can be rendered on screen
     *         return tile;
     *     }
     * });
     * ```
     *
     * @section Asynchrohous usage
     * @example
     *
     * Tile creation can also be asyncronous, this is useful when using a third-party drawing library. Once the tile is finsihed drawing it can be passed to the done() callback.
     *
     * ```js
     * var CanvasLayer = L.GridLayer.extend({
     *     createTile: function(coords, done){
     *         var error;
     *
     *         // create a <canvas> element for drawing
     *         var tile = L.DomUtil.create('canvas', 'leaflet-tile');
     *
     *         // setup tile width and height according to the options
     *         var size = this.getTileSize();
     *         tile.width = size.x;
     *         tile.height = size.y;
     *
     *         // draw something and pass the tile to the done() callback
     *         done(error, tile);
     *     }
     * });
     * ```
     *
     * @section
     */


    L.GridLayer = L.Layer.extend({

        options: {
            // @option tileSize: Number|Point = 256
            // Width and height of tiles in the grid. Use a number if width and height are equal, or `L.point(width, height)` otherwise.
            tileSize: 256,

            // @option opacity: Number = 1.0
            // Opacity of the tiles. Can be used in the `createTile()` function.
            opacity: 1,

            // @option updateWhenIdle: Boolean = depends
            // If `false`, new tiles are loaded during panning, otherwise only after it (for better performance). `true` by default on mobile browsers, otherwise `false`.
            updateWhenIdle: L.Browser.mobile,

            // @option updateInterval: Number = 200
            // Tiles will not update more than once every `updateInterval` milliseconds.
            updateInterval: 200,

            // @option attribution: String = null
            // String to be shown in the attribution control, describes the layer data, e.g. "? Mapbox".
            attribution: null,

            // @option zIndex: Number = 1
            // The explicit zIndex of the tile layer.
            zIndex: 1,

            // @option bounds: LatLngBounds = undefined
            // If set, tiles will only be loaded inside inside the set `LatLngBounds`.
            bounds: null,

            // @option minZoom: Number = 0
            // The minimum zoom level that tiles will be loaded at. By default the entire map.
            minZoom: 0,

            // @option maxZoom: Number = undefined
            // The maximum zoom level that tiles will be loaded at.
//		maxZoom: undefined,

            // @option noWrap: Boolean = false
            // Whether the layer is wrapped around the antimeridian. If `true`, the
            // GridLayer will only be displayed once at low zoom levels.
            noWrap: false,

            // @option pane: String = 'tilePane'
            // `Map pane` where the grid layer will be added.
            pane: 'tilePane'
        },

        initialize: function (options) {
            options = L.setOptions(this, options);
        },

        onAdd: function () {
            this._initContainer();

            this._levels = {};
            this._tiles = {};

            this._resetView();
            this._update();
        },

        beforeAdd: function (map) {
            map._addZoomLimit(this);
        },

        onRemove: function (map) {
            this._removeAllTiles();
            L.DomUtil.remove(this._container);
            map._removeZoomLimit(this);
            this._container = null;
            this._tileZoom = null;
        },

        // @method bringToFront: this
        // Brings the tile layer to the top of all tile layers.
        bringToFront: function () {
            if (this._map) {
                L.DomUtil.toFront(this._container);
                this._setAutoZIndex(Math.max);
            }
            return this;
        },

        // @method bringToBack: this
        // Brings the tile layer to the bottom of all tile layers.
        bringToBack: function () {
            if (this._map) {
                L.DomUtil.toBack(this._container);
                this._setAutoZIndex(Math.min);
            }
            return this;
        },

        // @method getAttribution: String
        // Used by the `attribution control`, returns the [attribution option](#gridlayer-attribution).
        getAttribution: function () {
            return this.options.attribution;
        },

        // @method getContainer: String
        // Returns the HTML element that contains the tiles for this layer.
        getContainer: function () {
            return this._container;
        },

        // @method setOpacity(opacity: Number): this
        // Changes the [opacity](#gridlayer-opacity) of the grid layer.
        setOpacity: function (opacity) {
            this.options.opacity = opacity;
            this._updateOpacity();
            return this;
        },

        // @method setZIndex(zIndex: Number): this
        // Changes the [zIndex](#gridlayer-zindex) of the grid layer.
        setZIndex: function (zIndex) {
            this.options.zIndex = zIndex;
            this._updateZIndex();

            return this;
        },

        // @method isLoading: Boolean
        // Returns `true` if any tile in the grid layer has not finished loading.
        isLoading: function () {
            return this._loading;
        },

        // @method redraw: this
        // Causes the layer to clear all the tiles and request them again.
        redraw: function () {
            if (this._map) {
                this._removeAllTiles();
                this._update();
            }
            return this;
        },

        getEvents: function () {
            var events = {
                viewprereset: this._invalidateAll,
                viewreset: this._resetView,
                zoom: this._resetView,
                moveend: this._onMoveEnd
            };

            if (!this.options.updateWhenIdle) {
                // update tiles on move, but not more often than once per given interval
                if (!this._onMove) {
                    this._onMove = L.Util.throttle(this._onMoveEnd, this.options.updateInterval, this);
                }

                events.move = this._onMove;
            }

            if (this._zoomAnimated) {
                events.zoomanim = this._animateZoom;
            }

            return events;
        },

        // @section Extension methods
        // Layers extending `GridLayer` shall reimplement the following method.
        // @method createTile(coords: Object, done?: Function): HTMLElement
        // Called only internally, must be overriden by classes extending `GridLayer`.
        // Returns the `HTMLElement` corresponding to the given `coords`. If the `done` callback
        // is specified, it must be called when the tile has finished loading and drawing.
        createTile: function () {
            return document.createElement('div');
        },

        // @section
        // @method getTileSize: Point
        // Normalizes the [tileSize option](#gridlayer-tilesize) into a point. Used by the `createTile()` method.
        getTileSize: function () {
            var s = this.options.tileSize;
            return s instanceof L.Point ? s : new L.Point(s, s);
        },

        _updateZIndex: function () {
            if (this._container && this.options.zIndex !== undefined && this.options.zIndex !== null) {
                this._container.style.zIndex = this.options.zIndex;
            }
        },

        _setAutoZIndex: function (compare) {
            // go through all other layers of the same pane, set zIndex to max + 1 (front) or min - 1 (back)

            var layers = this.getPane().children,
                edgeZIndex = -compare(-Infinity, Infinity); // -Infinity for max, Infinity for min

            for (var i = 0, len = layers.length, zIndex; i < len; i++) {

                zIndex = layers[i].style.zIndex;

                if (layers[i] !== this._container && zIndex) {
                    edgeZIndex = compare(edgeZIndex, +zIndex);
                }
            }

            if (isFinite(edgeZIndex)) {
                this.options.zIndex = edgeZIndex + compare(-1, 1);
                this._updateZIndex();
            }
        },

        _updateOpacity: function () {
            if (!this._map) { return; }

            // IE doesn't inherit filter opacity properly, so we're forced to set it on tiles
            if (L.Browser.ielt9) { return; }

            L.DomUtil.setOpacity(this._container, this.options.opacity);

            var now = +new Date(),
                nextFrame = false,
                willPrune = false;

            for (var key in this._tiles) {
                var tile = this._tiles[key];
                if (!tile.current || !tile.loaded) { continue; }

                var fade = Math.min(1, (now - tile.loaded) / 200);

                L.DomUtil.setOpacity(tile.el, fade);
                if (fade < 1) {
                    nextFrame = true;
                } else {
                    if (tile.active) { willPrune = true; }
                    tile.active = true;
                }
            }

            if (willPrune && !this._noPrune) { this._pruneTiles(); }

            if (nextFrame) {
                L.Util.cancelAnimFrame(this._fadeFrame);
                this._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);
            }
        },

        _initContainer: function () {
            if (this._container) { return; }

            this._container = L.DomUtil.create('div', 'leaflet-layer');
            this._updateZIndex();

            if (this.options.opacity < 1) {
                this._updateOpacity();
            }

            this.getPane().appendChild(this._container);
        },

        _updateLevels: function () {

            var zoom = this._tileZoom,
                maxZoom = this.options.maxZoom;

            if (zoom === undefined) { return undefined; }

            for (var z in this._levels) {
                if (this._levels[z].el.children.length || z === zoom) {
                    this._levels[z].el.style.zIndex = maxZoom - Math.abs(zoom - z);
                } else {
                    L.DomUtil.remove(this._levels[z].el);
                    this._removeTilesAtZoom(z);
                    delete this._levels[z];
                }
            }

            var level = this._levels[zoom],
                map = this._map;

            if (!level) {
                level = this._levels[zoom] = {};

                level.el = L.DomUtil.create('div', 'leaflet-tile-container leaflet-zoom-animated', this._container);
                level.el.style.zIndex = maxZoom;

                level.origin = map.project(map.unproject(map.getPixelOrigin()), zoom).round();
                level.zoom = zoom;

                this._setZoomTransform(level, map.getCenter(), map.getZoom());

                // force the browser to consider the newly added element for transition
                L.Util.falseFn(level.el.offsetWidth);
            }

            this._level = level;

            return level;
        },

        _pruneTiles: function () {
            if (!this._map) {
                return;
            }

            var key, tile;

            var zoom = this._map.getZoom();
            if (zoom > this.options.maxZoom ||
                zoom < this.options.minZoom) {
                this._removeAllTiles();
                return;
            }

            for (key in this._tiles) {
                tile = this._tiles[key];
                tile.retain = tile.current;
            }

            for (key in this._tiles) {
                tile = this._tiles[key];
                if (tile.current && !tile.active) {
                    var coords = tile.coords;
                    if (!this._retainParent(coords.x, coords.y, coords.z, coords.z - 5)) {
                        this._retainChildren(coords.x, coords.y, coords.z, coords.z + 2);
                    }
                }
            }

            for (key in this._tiles) {
                if (!this._tiles[key].retain) {
                    this._removeTile(key);
                }
            }
        },

        _removeTilesAtZoom: function (zoom) {
            for (var key in this._tiles) {
                if (this._tiles[key].coords.z !== zoom) {
                    continue;
                }
                this._removeTile(key);
            }
        },

        _removeAllTiles: function () {
            for (var key in this._tiles) {
                this._removeTile(key);
            }
        },

        _invalidateAll: function () {
            for (var z in this._levels) {
                L.DomUtil.remove(this._levels[z].el);
                delete this._levels[z];
            }
            this._removeAllTiles();

            this._tileZoom = null;
        },

        _retainParent: function (x, y, z, minZoom) {
            var x2 = Math.floor(x / 2),
                y2 = Math.floor(y / 2),
                z2 = z - 1,
                coords2 = new L.Point(+x2, +y2);
            coords2.z = +z2;

            var key = this._tileCoordsToKey(coords2),
                tile = this._tiles[key];

            if (tile && tile.active) {
                tile.retain = true;
                return true;

            } else if (tile && tile.loaded) {
                tile.retain = true;
            }

            if (z2 > minZoom) {
                return this._retainParent(x2, y2, z2, minZoom);
            }

            return false;
        },

        _retainChildren: function (x, y, z, maxZoom) {

            for (var i = 2 * x; i < 2 * x + 2; i++) {
                for (var j = 2 * y; j < 2 * y + 2; j++) {

                    var coords = new L.Point(i, j);
                    coords.z = z + 1;

                    var key = this._tileCoordsToKey(coords),
                        tile = this._tiles[key];

                    if (tile && tile.active) {
                        tile.retain = true;
                        continue;

                    } else if (tile && tile.loaded) {
                        tile.retain = true;
                    }

                    if (z + 1 < maxZoom) {
                        this._retainChildren(i, j, z + 1, maxZoom);
                    }
                }
            }
        },

        _resetView: function (e) {
            var animating = e && (e.pinch || e.flyTo);
            this._setView(this._map.getCenter(), this._map.getZoom(), animating, animating);
        },

        _animateZoom: function (e) {
            this._setView(e.center, e.zoom, true, e.noUpdate);
        },

        _setView: function (center, zoom, noPrune, noUpdate) {
            var tileZoom = Math.round(zoom);
            if ((this.options.maxZoom !== undefined && tileZoom > this.options.maxZoom) ||
                (this.options.minZoom !== undefined && tileZoom < this.options.minZoom)) {
                tileZoom = undefined;
            }

            var tileZoomChanged = (tileZoom !== this._tileZoom);

            if (!noUpdate || tileZoomChanged) {

                this._tileZoom = tileZoom;

                if (this._abortLoading) {
                    this._abortLoading();
                }

                this._updateLevels();
                this._resetGrid();

                if (tileZoom !== undefined) {
                    this._update(center);
                }

                if (!noPrune) {
                    this._pruneTiles();
                }

                // Flag to prevent _updateOpacity from pruning tiles during
                // a zoom anim or a pinch gesture
                this._noPrune = !!noPrune;
            }

            this._setZoomTransforms(center, zoom);
        },

        _setZoomTransforms: function (center, zoom) {
            for (var i in this._levels) {
                this._setZoomTransform(this._levels[i], center, zoom);
            }
        },

        _setZoomTransform: function (level, center, zoom) {
            var scale = this._map.getZoomScale(zoom, level.zoom),
                translate = level.origin.multiplyBy(scale)
                    .subtract(this._map._getNewPixelOrigin(center, zoom)).round();

            if (L.Browser.any3d) {
                L.DomUtil.setTransform(level.el, translate, scale);
            } else {
                L.DomUtil.setPosition(level.el, translate);
            }
        },

        _resetGrid: function () {
            var map = this._map,
                crs = map.options.crs,
                tileSize = this._tileSize = this.getTileSize(),
                tileZoom = this._tileZoom;

            var bounds = this._map.getPixelWorldBounds(this._tileZoom);
            if (bounds) {
                this._globalTileRange = this._pxBoundsToTileRange(bounds);
            }

            this._wrapX = crs.wrapLng && !this.options.noWrap && [
                    Math.floor(map.project([0, crs.wrapLng[0]], tileZoom).x / tileSize.x),
                    Math.ceil(map.project([0, crs.wrapLng[1]], tileZoom).x / tileSize.y)
                ];
            this._wrapY = crs.wrapLat && !this.options.noWrap && [
                    Math.floor(map.project([crs.wrapLat[0], 0], tileZoom).y / tileSize.x),
                    Math.ceil(map.project([crs.wrapLat[1], 0], tileZoom).y / tileSize.y)
                ];
        },

        _onMoveEnd: function () {
            if (!this._map || this._map._animatingZoom) { return; }

            this._resetView();
        },

        _getTiledPixelBounds: function (center) {
            var map = this._map,
                mapZoom = map._animatingZoom ? Math.max(map._animateToZoom, map.getZoom()) : map.getZoom(),
                scale = map.getZoomScale(mapZoom, this._tileZoom),
                pixelCenter = map.project(center, this._tileZoom).floor(),
                halfSize = map.getSize().divideBy(scale * 2);

            return new L.Bounds(pixelCenter.subtract(halfSize), pixelCenter.add(halfSize));
        },

        // Private method to load tiles in the grid's active zoom level according to map bounds
        _update: function (center) {
            var map = this._map;
            if (!map) { return; }
            var zoom = map.getZoom();

            if (center === undefined) { center = map.getCenter(); }
            if (this._tileZoom === undefined) { return; }	// if out of minzoom/maxzoom

            var pixelBounds = this._getTiledPixelBounds(center),
                tileRange = this._pxBoundsToTileRange(pixelBounds),
                tileCenter = tileRange.getCenter(),
                queue = [];

            for (var key in this._tiles) {
                this._tiles[key].current = false;
            }

            // _update just loads more tiles. If the tile zoom level differs too much
            // from the map's, let _setView reset levels and prune old tiles.
            if (Math.abs(zoom - this._tileZoom) > 1) { this._setView(center, zoom); return; }

            // create a queue of coordinates to load tiles from
            for (var j = tileRange.min.y; j <= tileRange.max.y; j++) {
                for (var i = tileRange.min.x; i <= tileRange.max.x; i++) {
                    var coords = new L.Point(i, j);
                    coords.z = this._tileZoom;

                    if (!this._isValidTile(coords)) { continue; }

                    var tile = this._tiles[this._tileCoordsToKey(coords)];
                    if (tile) {
                        tile.current = true;
                    } else {
                        queue.push(coords);
                    }
                }
            }

            // sort tile queue to load tiles in order of their distance to center
            queue.sort(function (a, b) {
                return a.distanceTo(tileCenter) - b.distanceTo(tileCenter);
            });

            if (queue.length !== 0) {
                // if its the first batch of tiles to load
                if (!this._loading) {
                    this._loading = true;
                    // @event loading: Event
                    // Fired when the grid layer starts loading tiles
                    this.fire('loading');
                }

                // create DOM fragment to append tiles in one batch
                var fragment = document.createDocumentFragment();

                for (i = 0; i < queue.length; i++) {
                    this._addTile(queue[i], fragment);
                }

                this._level.el.appendChild(fragment);
            }
        },

        _isValidTile: function (coords) {
            var crs = this._map.options.crs;

            if (!crs.infinite) {
                // don't load tile if it's out of bounds and not wrapped
                var bounds = this._globalTileRange;
                if ((!crs.wrapLng && (coords.x < bounds.min.x || coords.x > bounds.max.x)) ||
                    (!crs.wrapLat && (coords.y < bounds.min.y || coords.y > bounds.max.y))) { return false; }
            }

            if (!this.options.bounds) { return true; }

            // don't load tile if it doesn't intersect the bounds in options
            var tileBounds = this._tileCoordsToBounds(coords);
            return L.latLngBounds(this.options.bounds).overlaps(tileBounds);
        },

        _keyToBounds: function (key) {
            return this._tileCoordsToBounds(this._keyToTileCoords(key));
        },

        // converts tile coordinates to its geographical bounds
        _tileCoordsToBounds: function (coords) {

            var map = this._map,
                tileSize = this.getTileSize(),

                nwPoint = coords.scaleBy(tileSize),
                sePoint = nwPoint.add(tileSize),

                nw = map.wrapLatLng(map.unproject(nwPoint, coords.z)),
                se = map.wrapLatLng(map.unproject(sePoint, coords.z));

            return new L.LatLngBounds(nw, se);
        },

        // converts tile coordinates to key for the tile cache
        _tileCoordsToKey: function (coords) {
            return coords.x + ':' + coords.y + ':' + coords.z;
        },

        // converts tile cache key to coordinates
        _keyToTileCoords: function (key) {
            var k = key.split(':'),
                coords = new L.Point(+k[0], +k[1]);
            coords.z = +k[2];
            return coords;
        },

        _removeTile: function (key) {
            var tile = this._tiles[key];
            if (!tile) { return; }

            L.DomUtil.remove(tile.el);

            delete this._tiles[key];

            // @event tileunload: TileEvent
            // Fired when a tile is removed (e.g. when a tile goes off the screen).
            this.fire('tileunload', {
                tile: tile.el,
                coords: this._keyToTileCoords(key)
            });
        },

        _initTile: function (tile) {
            L.DomUtil.addClass(tile, 'leaflet-tile');

            var tileSize = this.getTileSize();
            tile.style.width = tileSize.x + 'px';
            tile.style.height = tileSize.y + 'px';

            tile.onselectstart = L.Util.falseFn;
            tile.onmousemove = L.Util.falseFn;

            // update opacity on tiles in IE7-8 because of filter inheritance problems
            if (L.Browser.ielt9 && this.options.opacity < 1) {
                L.DomUtil.setOpacity(tile, this.options.opacity);
            }

            // without this hack, tiles disappear after zoom on Chrome for Android
            // https://github.com/Leaflet/Leaflet/issues/2078
            if (L.Browser.android && !L.Browser.android23) {
                tile.style.WebkitBackfaceVisibility = 'hidden';
            }
        },

        _addTile: function (coords, container) {
            var tilePos = this._getTilePos(coords),
                key = this._tileCoordsToKey(coords);

            var tile = this.createTile(this._wrapCoords(coords), L.bind(this._tileReady, this, coords));

            this._initTile(tile);

            // if createTile is defined with a second argument ("done" callback),
            // we know that tile is async and will be ready later; otherwise
            if (this.createTile.length < 2) {
                // mark tile as ready, but delay one frame for opacity animation to happen
                L.Util.requestAnimFrame(L.bind(this._tileReady, this, coords, null, tile));
            }

            L.DomUtil.setPosition(tile, tilePos);

            // save tile in cache
            this._tiles[key] = {
                el: tile,
                coords: coords,
                current: true
            };

            container.appendChild(tile);
            // @event tileloadstart: TileEvent
            // Fired when a tile is requested and starts loading.
            this.fire('tileloadstart', {
                tile: tile,
                coords: coords
            });
        },

        _tileReady: function (coords, err, tile) {
            if (!this._map) { return; }

            if (err) {
                // @event tileerror: TileEvent
                // Fired when there is an error loading a tile.
                this.fire('tileerror', {
                    error: err,
                    tile: tile,
                    coords: coords
                });
            }

            var key = this._tileCoordsToKey(coords);

            tile = this._tiles[key];
            if (!tile) { return; }

            tile.loaded = +new Date();
            if (this._map._fadeAnimated) {
                L.DomUtil.setOpacity(tile.el, 0);
                L.Util.cancelAnimFrame(this._fadeFrame);
                this._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);
            } else {
                tile.active = true;
                this._pruneTiles();
            }

            L.DomUtil.addClass(tile.el, 'leaflet-tile-loaded');

            // @event tileload: TileEvent
            // Fired when a tile loads.
            this.fire('tileload', {
                tile: tile.el,
                coords: coords
            });

            if (this._noTilesToLoad()) {
                this._loading = false;
                // @event load: TileEvent
                // Fired when the grid layer loaded all visible tiles.
                this.fire('load');

                if (L.Browser.ielt9 || !this._map._fadeAnimated) {
                    L.Util.requestAnimFrame(this._pruneTiles, this);
                } else {
                    // Wait a bit more than 0.2 secs (the duration of the tile fade-in)
                    // to trigger a pruning.
                    setTimeout(L.bind(this._pruneTiles, this), 250);
                }
            }
        },

        _getTilePos: function (coords) {
            return coords.scaleBy(this.getTileSize()).subtract(this._level.origin);
        },

        _wrapCoords: function (coords) {
            var newCoords = new L.Point(
                this._wrapX ? L.Util.wrapNum(coords.x, this._wrapX) : coords.x,
                this._wrapY ? L.Util.wrapNum(coords.y, this._wrapY) : coords.y);
            newCoords.z = coords.z;
            return newCoords;
        },

        _pxBoundsToTileRange: function (bounds) {
            var tileSize = this.getTileSize();
            return new L.Bounds(
                bounds.min.unscaleBy(tileSize).floor(),
                bounds.max.unscaleBy(tileSize).ceil().subtract([1, 1]));
        },

        _noTilesToLoad: function () {
            for (var key in this._tiles) {
                if (!this._tiles[key].loaded) { return false; }
            }
            return true;
        }
    });

// @factory L.gridLayer(options?: GridLayer options)
// Creates a new instance of GridLayer with the supplied options.
    L.gridLayer = function (options) {
        return new L.GridLayer(options);
    };



    /*
     * @class TileLayer
     * @inherits GridLayer
     * @aka L.TileLayer
     * Used to load and display tile layers on the map. Extends `GridLayer`.
     *
     * @example
     *
     * ```js
     * L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png?{foo}', {foo: 'bar'}).addTo(map);
     * ```
     *
     * @section URL template
     * @example
     *
     * A string of the following form:
     *
     * ```
     * 'http://{s}.somedomain.com/blabla/{z}/{x}/{y}{r}.png'
     * ```
     *
     * `{s}` means one of the available subdomains (used sequentially to help with browser parallel requests per domain limitation; subdomain values are specified in options; `a`, `b` or `c` by default, can be omitted), `{z}`  zoom level, `{x}` and `{y}`  tile coordinates. `{r}` can be used to add @2x to the URL to load retina tiles.
     *
     * You can use custom keys in the template, which will be [evaluated](#util-template) from TileLayer options, like this:
     *
     * ```
     * L.tileLayer('http://{s}.somedomain.com/{foo}/{z}/{x}/{y}.png', {foo: 'bar'});
     * ```
     *
     * @section
     */


    L.TileLayer = L.GridLayer.extend({

        options: {
            // @option minZoom: Number = 0
            // Minimum zoom number.
            minZoom: 0,

            // @option maxZoom: Number = 18
            // Maximum zoom number.
            maxZoom: 18,

            // @option maxNativeZoom: Number = null
            // Maximum zoom number the tile source has available. If it is specified,
            // the tiles on all zoom levels higher than `maxNativeZoom` will be loaded
            // from `maxNativeZoom` level and auto-scaled.
            maxNativeZoom: null,

            // @option subdomains: String|String[] = 'abc'
            // Subdomains of the tile service. Can be passed in the form of one string (where each letter is a subdomain name) or an array of strings.
            subdomains: 'abc',

            // @option errorTileUrl: String = ''
            // URL to the tile image to show in place of the tile that failed to load.
            errorTileUrl: '',

            // @option zoomOffset: Number = 0
            // The zoom number used in tile URLs will be offset with this value.
            zoomOffset: 0,

            // @option tms: Boolean = false
            // If `true`, inverses Y axis numbering for tiles (turn this on for TMS services).
            tms: false,

            // @option zoomReverse: Boolean = false
            // If set to true, the zoom number used in tile URLs will be reversed (`maxZoom - zoom` instead of `zoom`)
            zoomReverse: false,

            // @option detectRetina: Boolean = false
            // If `true` and user is on a retina display, it will request four tiles of half the specified size and a bigger zoom level in place of one to utilize the high resolution.
            detectRetina: false,

            // @option crossOrigin: Boolean = false
            // If true, all tiles will have their crossOrigin attribute set to ''. This is needed if you want to access tile pixel data.
            crossOrigin: false
        },

        initialize: function (url, options) {

            this._url = url;

            options = L.setOptions(this, options);

            // detecting retina displays, adjusting tileSize and zoom levels
            if (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {

                options.tileSize = Math.floor(options.tileSize / 2);
                options.zoomOffset++;

                options.minZoom = Math.max(0, options.minZoom);
                options.maxZoom--;
            }

            if (typeof options.subdomains === 'string') {
                options.subdomains = options.subdomains.split('');
            }

            // for https://github.com/Leaflet/Leaflet/issues/137
            if (!L.Browser.android) {
                this.on('tileunload', this._onTileRemove);
            }
        },

        // @method setUrl(url: String, noRedraw?: Boolean): this
        // Updates the layer's URL template and redraws it (unless `noRedraw` is set to `true`).
        setUrl: function (url, noRedraw) {
            this._url = url;

            if (!noRedraw) {
                this.redraw();
            }
            return this;
        },

        // @method createTile(coords: Object, done?: Function): HTMLElement
        // Called only internally, overrides GridLayer's [`createTile()`](#gridlayer-createtile)
        // to return an `<img>` HTML element with the appropiate image URL given `coords`. The `done`
        // callback is called when the tile has been loaded.
        createTile: function (coords, done) {
            var tile = document.createElement('img');

            L.DomEvent.on(tile, 'load', L.bind(this._tileOnLoad, this, done, tile));
            L.DomEvent.on(tile, 'error', L.bind(this._tileOnError, this, done, tile));

            if (this.options.crossOrigin) {
                tile.crossOrigin = '';
            }

            /*
             Alt tag is set to empty string to keep screen readers from reading URL and for compliance reasons
             http://www.w3.org/TR/WCAG20-TECHS/H67
             */
            tile.alt = '';

            tile.src = this.getTileUrl(coords);

            return tile;
        },

        // @section Extension methods
        // @uninheritable
        // Layers extending `TileLayer` might reimplement the following method.
        // @method getTileUrl(coords: Object): String
        // Called only internally, returns the URL for a tile given its coordinates.
        // Classes extending `TileLayer` can override this function to provide custom tile URL naming schemes.
        getTileUrl: function (coords) {
            var data = {
                r: L.Browser.retina ? '@2x' : '',
                s: this._getSubdomain(coords),
                x: coords.x,
                y: coords.y,
                z: this._getZoomForUrl()
            };
            if (this._map && !this._map.options.crs.infinite) {
                var invertedY = this._globalTileRange.max.y - coords.y;
                if (this.options.tms) {
                    data['y'] = invertedY;
                }
                data['-y'] = invertedY;
            }

            return L.Util.template(this._url, L.extend(data, this.options));
        },

        _tileOnLoad: function (done, tile) {
            // For https://github.com/Leaflet/Leaflet/issues/3332
            if (L.Browser.ielt9) {
                setTimeout(L.bind(done, this, null, tile), 0);
            } else {
                done(null, tile);
            }
        },

        _tileOnError: function (done, tile, e) {
            var errorUrl = this.options.errorTileUrl;
            if (errorUrl) {
                tile.src = errorUrl;
            }
            done(e, tile);
        },

        getTileSize: function () {
            var map = this._map,
                tileSize = L.GridLayer.prototype.getTileSize.call(this),
                zoom = this._tileZoom + this.options.zoomOffset,
                zoomN = this.options.maxNativeZoom;

            // increase tile size when overscaling
            return zoomN !== null && zoom > zoomN ?
                tileSize.divideBy(map.getZoomScale(zoomN, zoom)).round() :
                tileSize;
        },

        _onTileRemove: function (e) {
            e.tile.onload = null;
        },

        _getZoomForUrl: function () {

            var options = this.options,
                zoom = this._tileZoom;

            if (options.zoomReverse) {
                zoom = options.maxZoom - zoom;
            }

            zoom += options.zoomOffset;

            return options.maxNativeZoom !== null ? Math.min(zoom, options.maxNativeZoom) : zoom;
        },

        _getSubdomain: function (tilePoint) {
            var index = Math.abs(tilePoint.x + tilePoint.y) % this.options.subdomains.length;
            return this.options.subdomains[index];
        },

        // stops loading all tiles in the background layer
        _abortLoading: function () {
            var i, tile;
            for (i in this._tiles) {
                if (this._tiles[i].coords.z !== this._tileZoom) {
                    tile = this._tiles[i].el;

                    tile.onload = L.Util.falseFn;
                    tile.onerror = L.Util.falseFn;

                    if (!tile.complete) {
                        tile.src = L.Util.emptyImageUrl;
                        L.DomUtil.remove(tile);
                    }
                }
            }
        }
    });


// @factory L.tilelayer(urlTemplate: String, options? TileLayer options)
// Instantiates a tile layer object given a `URL template` and optionally an options object.

    L.tileLayer = function (url, options) {
        return new L.TileLayer(url, options);
    };



    /*
     * @class TileLayer.WMS
     * @inherits TileLayer
     * @aka L.TileLayer.WMS
     * Used to display WMS services as tile layers on the map. Extends `TileLayer`.
     *
     * @example
     *
     * ```js
     * var nexrad = L.tileLayer.wms("http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
     * 	layers: 'nexrad-n0r-900913',
     * 	format: 'image/png',
     * 	transparent: true,
     * 	attribution: "Weather data ? 2012 IEM Nexrad"
     * });
     * ```
     */

    L.TileLayer.WMS = L.TileLayer.extend({

        // @section
        // @aka TileLayer.WMS options
        defaultWmsParams: {
            service: 'WMS',
            request: 'GetMap',

            // @option layers: String = ''
            // **(required)** Comma-separated list of WMS layers to show.
            layers: '',

            // @option styles: String = ''
            // Comma-separated list of WMS styles.
            styles: '',

            // @option format: String = 'image/jpeg'
            // WMS image format (use `'image/png'` for layers with transparency).
            format: 'image/jpeg',

            // @option transparent: Boolean = false
            // If `true`, the WMS service will return images with transparency.
            transparent: false,

            // @option version: String = '1.1.1'
            // Version of the WMS service to use
            version: '1.1.1'
        },

        options: {
            // @option crs: CRS = null
            // Coordinate Reference System to use for the WMS requests, defaults to
            // map CRS. Don't change this if you're not sure what it means.
            crs: null,

            // @option uppercase: Boolean = false
            // If `true`, WMS request parameter keys will be uppercase.
            uppercase: false
        },

        initialize: function (url, options) {

            this._url = url;

            var wmsParams = L.extend({}, this.defaultWmsParams);

            // all keys that are not TileLayer options go to WMS params
            for (var i in options) {
                if (!(i in this.options)) {
                    wmsParams[i] = options[i];
                }
            }

            options = L.setOptions(this, options);

            wmsParams.width = wmsParams.height = options.tileSize * (options.detectRetina && L.Browser.retina ? 2 : 1);

            this.wmsParams = wmsParams;
        },

        onAdd: function (map) {

            this._crs = this.options.crs || map.options.crs;
            this._wmsVersion = parseFloat(this.wmsParams.version);

            var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';
            this.wmsParams[projectionKey] = this._crs.code;

            L.TileLayer.prototype.onAdd.call(this, map);
        },

        getTileUrl: function (coords) {

            var tileBounds = this._tileCoordsToBounds(coords),
                nw = this._crs.project(tileBounds.getNorthWest()),
                se = this._crs.project(tileBounds.getSouthEast()),

                bbox = (this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?
                    [se.y, nw.x, nw.y, se.x] :
                    [nw.x, se.y, se.x, nw.y]).join(','),

                url = L.TileLayer.prototype.getTileUrl.call(this, coords);

            return url +
                L.Util.getParamString(this.wmsParams, url, this.options.uppercase) +
                (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;
        },

        // @method setParams(params: Object, noRedraw?: Boolean): this
        // Merges an object with the new parameters and re-requests tiles on the current screen (unless `noRedraw` was set to true).
        setParams: function (params, noRedraw) {

            L.extend(this.wmsParams, params);

            if (!noRedraw) {
                this.redraw();
            }

            return this;
        }
    });


// @factory L.tileLayer.wms(baseUrl: String, options: TileLayer.WMS options)
// Instantiates a WMS tile layer object given a base URL of the WMS service and a WMS parameters/options object.
    L.tileLayer.wms = function (url, options) {
        return new L.TileLayer.WMS(url, options);
    };

    L.HeatMapOverlay = L.Layer.extend({

        initialize: function (config) {
            this.cfg = config;
            this._el = L.DomUtil.create('div', 'leaflet-zoom-hide');
            this._el.style.zIndex = 201;
            this._data = [];
            this._max = 1;
            this._min = 0;
            this.cfg.container = this._el;
        },

        onAdd: function (map) {
            var size = map.getSize();

            this._map = map;

            this._width = size.x;
            this._height = size.y;

            this._el.style.width = size.x + 'px';
            this._el.style.height = size.y + 'px';
            this._el.style.position = 'absolute';

            this._origin = this._map.layerPointToLatLng(new L.Point(0, 0));

            map.getPanes().overlayPane.appendChild(this._el);

            if (!this._heatmap) {
                this._heatmap = h337.create(this.cfg);
            }

            // this resets the origin and redraws whenever
            // the zoom changed or the map has been moved
            map.on('moveend', this._reset, this);
            this._draw();
        },

        addTo: function (map) {
            map.addLayer(this);
            return this;
        },

        onRemove: function (map) {
            // remove layer's DOM elements and listeners
            map.getPanes().overlayPane.removeChild(this._el);

            map.off('moveend', this._reset, this);
        },
        _draw: function() {
            if (!this._map) { return; }

            var mapPane = this._map.getPanes().mapPane;
            var point = mapPane._leaflet_pos;

            // reposition the layer

            if(L.Browser.svg){
                this._el.style[L.HeatMapOverlay.CSS_TRANSFORM] = 'translate(' +
                    -Math.round(point.x) + 'px,' +
                    -Math.round(point.y) + 'px)';
            }else{
                this._el.style.left = -Math.round(point.x) + 'px';
                this._el.style.bottom = Math.round(point.y) + 'px';
            }

            this._update();
        },
        _update: function() {
            var bounds, zoom, scale;
            var generatedData = { max: this._max, min: this._min, data: [] };

            bounds = this._map.getBounds();
            zoom = this._map.getZoom();
            scale = Math.pow(2, zoom);

            if (this._data.length === 0) {
                if (this._heatmap) {
                    this._heatmap.setData(generatedData);
                }
                return;
            }


            var latLngPoints = [];
            var radiusMultiplier = this.cfg.scaleRadius ? scale : 1;
            var localMax = 0;
            var localMin = 0;
            var valueField = this.cfg.valueField;
            var len = this._data.length;

            while (len--) {
                var entry = this._data[len];
                var value = entry[valueField];
                var latlng = entry.latlng;


                // we don't wanna render points that are not even on the map ;-)
                if (!bounds.contains(latlng)) {
                    continue;
                }
                // local max is the maximum within current bounds
                localMax = Math.max(value, localMax);
                localMin = Math.min(value, localMin);

                var point = this._map.latLngToContainerPoint(latlng);
                var latlngPoint = { x: Math.round(point.x), y: Math.round(point.y) };
                latlngPoint[valueField] = value;

                var radius;

                if (entry.radius) {
                    radius = entry.radius * radiusMultiplier;
                } else {
                    radius = (this.cfg.radius || 2) * radiusMultiplier;
                }
                latlngPoint.radius = radius;
                latLngPoints.push(latlngPoint);
            }
            if (this.cfg.useLocalExtrema) {
                generatedData.max = localMax;
                generatedData.min = localMin;
            }

            generatedData.data = latLngPoints;

            this._heatmap.setData(generatedData);
        },
        setData: function(data) {
            this._max = data.max || this._max;
            this._min = data.min || this._min;
            var lnglatField = this.cfg.lnglatField || 'lnglat';
            var valueField = this.cfg.valueField || 'value';

            // transform data to latlngs
            var data = data.data;
            var len = data.length;
            var d = [];

            while (len--) {
                var entry = data[len];
                var latlng = new L.LatLng(entry[lnglatField][1], entry[lnglatField][0]);
                var dataObj = { latlng: latlng };
                dataObj[valueField] = entry[valueField];
                if (entry.radius) {
                    dataObj.radius = entry.radius;
                }
                d.push(dataObj);
            }
            this._data = d;

            this._draw();
        },
        // experimential... not ready.
        addData: function(pointOrArray) {
            if (pointOrArray.length > 0) {
                var len = pointOrArray.length;
                while(len--) {
                    this.addData(pointOrArray[len]);
                }
            } else {
                var lnglatField = this.cfg.lnglatField || 'lnglat';
                var valueField = this.cfg.valueField || 'value';
                var entry = pointOrArray;
                var latlng = new L.LatLng(entry[lnglatField][1], entry[lnglatField][0]);
                var dataObj = { latlng: latlng };

                dataObj[valueField] = entry[valueField];
                this._max = Math.max(this._max, dataObj[valueField]);
                this._min = Math.min(this._min, dataObj[valueField]);

                if (entry.radius) {
                    dataObj.radius = entry.radius;
                }
                this._data.push(dataObj);
                this._draw();
            }
        },
        _reset: function () {
            this._origin = this._map.layerPointToLatLng(new L.Point(0, 0));

            var size = this._map.getSize();
            if (this._width !== size.x || this._height !== size.y) {
                this._width  = size.x;
                this._height = size.y;

                this._el.style.width = this._width + 'px';
                this._el.style.height = this._height + 'px';

                this._heatmap._renderer.setDimensions(this._width, this._height);
            }
            this._draw();
        }
    });

    L.HeatMapOverlay.CSS_TRANSFORM = (function() {
        var div = document.createElement('div');
        var props = [
            'transform',
            'WebkitTransform',
            'MozTransform',
            'OTransform',
            'msTransform'
        ];

        for (var i = 0; i < props.length; i++) {
            var prop = props[i];
            if (div.style[prop] !== undefined) {
                return prop;
            }
        }
        return props[0];
    })();

    L.heatMapOverlay = function(config){
        return new L.HeatMapOverlay(config);
    };

    /*
     * @class ImageOverlay
     * @aka L.ImageOverlay
     * @inherits Layer
     *
     * Used to load and display a single image over specific bounds of the map. Extends `Layer`.
     *
     * @example
     *
     * ```js
     * var imageUrl = 'http://www.lib.utexas.edu/maps/historical/newark_nj_1922.jpg',
     * 	imageBounds = [[40.712216, -74.22655], [40.773941, -74.12544]];
     * L.imageOverlay(imageUrl, imageBounds).addTo(map);
     * ```
     */

    L.ImageOverlay = L.Layer.extend({

        options: {
            // @option opacity: Number = 1.0
            // The opacity of the image overlay.
            opacity: 1,

            // @option alt: String = ''
            // Text for the `alt` attribute of the image (useful for accessibility).
            alt: '',

            // @option interactive: Boolean = false
            // If `true`, the image overlay will emit mouse events when clicked or hovered.
            interactive: false,

            // @option attribution: String = null
            // An optional string containing HTML to be shown on the `Attribution control`
            attribution: null

            // @option crossOrigin: Boolean = false
            // If true, the image will have its crossOrigin attribute set to ''. This is needed if you want to access image pixel data.

            // crossOrigin: false,
        },

        initialize: function (url, bounds, options) { // (String, LatLngBounds, Object)
            this._url = url;
            this._bounds = L.latLngBounds(bounds);

            L.setOptions(this, options);
        },

        onAdd: function () {
            if (!this._image) {
                this._initImage();

                if (this.options.opacity < 1) {
                    this._updateOpacity();
                }
            }

            if (this.options.interactive) {
                L.DomUtil.addClass(this._image, 'leaflet-interactive');
                this.addInteractiveTarget(this._image);
            }

            this.getPane().appendChild(this._image);
            this._reset();
        },

        onRemove: function () {
            L.DomUtil.remove(this._image);
            if (this.options.interactive) {
                this.removeInteractiveTarget(this._image);
            }
        },

        // @method setOpacity(): this
        // Sets the opacity of the overlay.
        setOpacity: function (opacity) {
            this.options.opacity = opacity;

            if (this._image) {
                this._updateOpacity();
            }
            return this;
        },

        setStyle: function (styleOpts) {
            if (styleOpts.opacity) {
                this.setOpacity(styleOpts.opacity);
            }
            return this;
        },

        // @method bringToFront(): this
        // Brings the layer to the top of all overlays.
        bringToFront: function () {
            if (this._map) {
                L.DomUtil.toFront(this._image);
            }
            return this;
        },

        // @method bringToBack(): this
        // Brings the layer to the bottom of all overlays.
        bringToBack: function () {
            if (this._map) {
                L.DomUtil.toBack(this._image);
            }
            return this;
        },

        // @method setUrl(url: String): this
        // Changes the URL of the image.
        setUrl: function (url) {
            this._url = url;

            if (this._image) {
                this._image.src = url;
            }
            return this;
        },

        setBounds: function (bounds) {
            this._bounds = bounds;

            if (this._map) {
                this._reset();
            }
            return this;
        },

        getAttribution: function () {
            return this.options.attribution;
        },

        getEvents: function () {
            var events = {
                zoom: this._reset,
                viewreset: this._reset
            };

            if (this._zoomAnimated) {
                events.zoomanim = this._animateZoom;
            }

            return events;
        },

        getBounds: function () {
            return this._bounds;
        },

        getElement: function () {
            return this._image;
        },

        _initImage: function () {
            var img = this._image = L.DomUtil.create('img',
                'leaflet-image-layer ' + (this._zoomAnimated ? 'leaflet-zoom-animated' : ''));

            img.onselectstart = L.Util.falseFn;
            img.onmousemove = L.Util.falseFn;

            img.onload = L.bind(this.fire, this, 'load');

            if (this.options.crossOrigin) {
                img.crossOrigin = '';
            }

            img.src = this._url;
            img.alt = this.options.alt;
        },

        _animateZoom: function (e) {
            var scale = this._map.getZoomScale(e.zoom),
                offset = this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(), e.zoom, e.center);

            L.DomUtil.setTransform(this._image, offset, scale);
        },

        _reset: function () {
            var image = this._image,
                bounds = new L.Bounds(
                    this._map.latLngToLayerPoint(this._bounds.getNorthWest()),
                    this._map.latLngToLayerPoint(this._bounds.getSouthEast())),
                size = bounds.getSize();

            L.DomUtil.setPosition(image, bounds.min);

            image.style.width  = size.x + 'px';
            image.style.height = size.y + 'px';
        },

        _updateOpacity: function () {
            L.DomUtil.setOpacity(this._image, this.options.opacity);
        }
    });

// @factory L.imageOverlay(imageUrl: String, bounds: LatLngBounds, options?: ImageOverlay options)
// Instantiates an image overlay object given the URL of the image and the
// geographical bounds it is tied to.
    L.imageOverlay = function (url, bounds, options) {
        return new L.ImageOverlay(url, bounds, options);
    };



    /*
     * @class Icon
     * @aka L.Icon
     * @inherits Layer
     *
     * Represents an icon to provide when creating a marker.
     *
     * @example
     *
     * ```js
     * var myIcon = L.icon({
     *     iconUrl: 'my-icon.png',
     *     iconRetinaUrl: 'my-icon@2x.png',
     *     iconSize: [38, 95],
     *     iconAnchor: [22, 94],
     *     popupAnchor: [-3, -76],
     *     shadowUrl: 'my-icon-shadow.png',
     *     shadowRetinaUrl: 'my-icon-shadow@2x.png',
     *     shadowSize: [68, 95],
     *     shadowAnchor: [22, 94]
     * });
     *
     * L.marker([50.505, 30.57], {icon: myIcon}).addTo(map);
     * ```
     *
     * `L.Icon.Default` extends `L.Icon` and is the blue icon Leaflet uses for markers by default.
     *
     */

    L.Icon = L.Class.extend({

        /* @section
         * @aka Icon options
         *
         * @option iconUrl: String = null
         * **(required)** The URL to the icon image (absolute or relative to your script path).
         *
         * @option iconRetinaUrl: String = null
         * The URL to a retina sized version of the icon image (absolute or relative to your
         * script path). Used for Retina screen devices.
         *
         * @option iconSize: Point = null
         * Size of the icon image in pixels.
         *
         * @option iconAnchor: Point = null
         * The coordinates of the "tip" of the icon (relative to its top left corner). The icon
         * will be aligned so that this point is at the marker's geographical location. Centered
         * by default if size is specified, also can be set in CSS with negative margins.
         *
         * @option popupAnchor: Point = null
         * The coordinates of the point from which popups will "open", relative to the icon anchor.
         *
         * @option shadowUrl: String = null
         * The URL to the icon shadow image. If not specified, no shadow image will be created.
         *
         * @option shadowRetinaUrl: String = null
         *
         * @option shadowSize: Point = null
         * Size of the shadow image in pixels.
         *
         * @option shadowAnchor: Point = null
         * The coordinates of the "tip" of the shadow (relative to its top left corner) (the same
         * as iconAnchor if not specified).
         *
         * @option className: String = ''
         * A custom class name to assign to both icon and shadow images. Empty by default.
         */

        initialize: function (options) {
            L.setOptions(this, options);
        },

        // @method createIcon(oldIcon?: HTMLElement): HTMLElement
        // Called internally when the icon has to be shown, returns a `<img>` HTML element
        // styled according to the options.
        createIcon: function (oldIcon) {
            return this._createIcon('icon', oldIcon);
        },

        // @method createShadow(oldIcon?: HTMLElement): HTMLElement
        // As `createIcon`, but for the shadow beneath it.
        createShadow: function (oldIcon) {
            return this._createIcon('shadow', oldIcon);
        },

        _createIcon: function (name, oldIcon) {
            var src = this._getIconUrl(name);

            if (!src) {
                if (name === 'icon') {
                    throw new Error('iconUrl not set in Icon options (see the docs).');
                }
                return null;
            }

            var img = this._createImg(src, oldIcon && oldIcon.tagName === 'IMG' ? oldIcon : null);
            this._setIconStyles(img, name);

            return img;
        },

        _setIconStyles: function (img, name) {
            var options = this.options,
                size = L.point(options[name + 'Size']),
                anchor = L.point(name === 'shadow' && options.shadowAnchor || options.iconAnchor ||
                    size && size.divideBy(2, true));

            img.className = 'leaflet-marker-' + name + ' ' + (options.className || '');

            if (anchor) {
                img.style.marginLeft = (-anchor.x) + 'px';
                img.style.marginTop  = (-anchor.y) + 'px';
            }

            if (size) {
                img.style.width  = size.x + 'px';
                img.style.height = size.y + 'px';
            }
        },

        _createImg: function (src, el) {
            el = el || document.createElement('img');
            el.src = src;
            return el;
        },

        _getIconUrl: function (name) {
            return L.Browser.retina && this.options[name + 'RetinaUrl'] || this.options[name + 'Url'];
        }
    });


// @factory L.icon(options: Icon options)
// Creates an icon instance with the given options.
    L.icon = function (options) {
        return new L.Icon(options);
    };



    /*
     * L.Icon.Default is the blue marker icon used by default in Leaflet.
     */

    L.Icon.Default = L.Icon.extend({

        options: {
            iconSize:    [25, 41],
            iconAnchor:  [12, 41],
            popupAnchor: [1, -34],
            shadowSize:  [41, 41]
        },

        _getIconUrl: function (name) {
            var key = name + 'Url';

            if (this.options[key]) {
                return this.options[key];
            }

            var path = L.Icon.Default.imagePath;

            if (!path) {
                throw new Error('Couldn\'t autodetect L.Icon.Default.imagePath, set it manually.');
            }

            return path + '/marker-' + name + (L.Browser.retina && name === 'icon' ? '-2x' : '') + '.png';
        }
    });

    L.Icon.Default.imagePath = (function () {
        var scripts = document.getElementsByTagName('script'),
            leafletRe = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;

        var i, len, src, path;

        for (i = 0, len = scripts.length; i < len; i++) {
            src = scripts[i].src || '';

            if (src.match(leafletRe)) {
                path = src.split(leafletRe)[0];
                return (path ? path + '/' : '') + 'images';
            }
        }
    }());



    /*
     * @class Marker
     * @inherits Layer
     * @aka L.Marker
     * L.Marker is used to display clickable/draggable icons on the map. Extends `Layer`.
     *
     * @example
     *
     * ```js
     * L.marker([50.5, 30.5]).addTo(map);
     * ```
     */

    L.Marker = L.Layer.extend({

        options: {
            // @option icon: L.Icon = *
            // Icon class to use for rendering the marker. See [Icon documentation](#L.Icon) for details on how to customize the marker icon. Set to new `L.Icon.Default()` by default.
            icon: new L.Icon.Default(),

            // @option interactive: Boolean = true
            // If `false`, the marker will not emit mouse events and will act as a part of the underlying map.
            interactive: true,

            // @option draggable: Boolean = false
            // Whether the marker is draggable with mouse/touch or not.
            draggable: false,

            // @option keyboard: Boolean = true
            // Whether the marker can be tabbed to with a keyboard and clicked by pressing enter.
            keyboard: true,

            // @option title: String = ''
            // Text for the browser tooltip that appear on marker hover (no tooltip by default).
            title: '',

            // @option alt: String = ''
            // Text for the `alt` attribute of the icon image (useful for accessibility).
            alt: '',

            // @option zIndexOffset: Number = 0
            // By default, marker images zIndex is set automatically based on its latitude. Use this option if you want to put the marker on top of all others (or below), specifying a high value like `1000` (or high negative value, respectively).
            zIndexOffset: 0,

            // @option opacity: Number = 1.0
            // The opacity of the marker.
            opacity: 1,

            // @option riseOnHover: Boolean = false
            // If `true`, the marker will get on top of others when you hover the mouse over it.
            riseOnHover: false,

            // @option riseOffset: Number = 250
            // The z-index offset used for the `riseOnHover` feature.
            riseOffset: 250,

            // @option pane: String = 'markerPane'
            // `Map pane` where the markers icon will be added.
            pane: 'markerPane',

            // FIXME: shadowPane is no longer a valid option
            nonBubblingEvents: ['click', 'dblclick', 'mouseover', 'mouseout', 'contextmenu']
        },

        /* @section
         *
         * You can subscribe to the following events using [these methods](#evented-method).
         *
         * @event click: MouseEvent
         * Fired when the user clicks (or taps) the marker.
         *
         * @event dblclick: MouseEvent
         * Fired when the user double-clicks (or double-taps) the marker.
         *
         * @event mousedown: MouseEvent
         * Fired when the user pushes the mouse button on the marker.
         *
         * @event mouseover: MouseEvent
         * Fired when the mouse enters the marker.
         *
         * @event mouseout: MouseEvent
         * Fired when the mouse leaves the marker.
         *
         * @event contextmenu: MouseEvent
         * Fired when the user right-clicks on the marker.
         */



        /* @section
         *
         * In addition to [shared layer methods](#Layer) like `addTo()` and `remove()` and [popup methods](#Popup) like bindPopup() you can also use the following methods:
         */

        initialize: function (latlng, options, data) {
            L.setOptions(this, options);
            this._latlng = L.latLng(latlng);
            this._data = data;
        },

        onAdd: function (map) {
            this._zoomAnimated = this._zoomAnimated && map.options.markerZoomAnimation;

            this._initIcon();
            this.update();
        },

        onRemove: function () {
            if (this.dragging && this.dragging.enabled()) {
                this.options.draggable = true;
                this.dragging.removeHooks();
            }

            this._removeIcon();
            this._removeShadow();
        },

        getEvents: function () {
            var events = {
                zoom: this.update,
                viewreset: this.update
            };

            if (this._zoomAnimated) {
                events.zoomanim = this._animateZoom;
            }

            return events;
        },

        // @method getLatLng: LatLng
        // Returns the current geographical position of the marker.
        getLatLng: function () {
            return this._latlng;
        },

        // @method setLatLng(latlng: LatLng): this
        // Changes the marker position to the given point.
        setLatLng: function (latlng) {
            var oldLatLng = this._latlng;
            this._latlng = L.latLng(latlng);
            this.update();

            // @event move: Event
            // Fired when the marker is moved via [`setLatLng`](#marker-setlatlng) or by [dragging](#marker-dragging). Old and new coordinates are included in event arguments as `oldLatLng`, `latlng`.
            return this.fire('move', {oldLatLng: oldLatLng, latlng: this._latlng});
        },

        // @method setZIndexOffset(offset: Number): this
        // Changes the [zIndex offset](#marker-zindexoffset) of the marker.
        setZIndexOffset: function (offset) {
            this.options.zIndexOffset = offset;
            return this.update();
        },

        setStyle:function(style){

        },

        // @method setIcon(icon: Icon): this
        // Changes the marker icon.
        setIcon: function (icon) {

            this.options.icon = icon;

            if (this._map) {
                this._initIcon();
                this.update();
            }

            if (this._popup) {
                this.bindPopup(this._popup, this._popup.options);
            }

            return this;
        },

        getElement: function () {
            return this._icon;
        },

        update: function () {

            if (this._icon) {
                var pos = this._map.latLngToLayerPoint(this._latlng).round();
                this._setPos(pos);
            }

            return this;
        },

        _initIcon: function () {
            var options = this.options,
                classToAdd = 'leaflet-zoom-' + (this._zoomAnimated ? 'animated' : 'hide');

            var icon = options.icon.createIcon(this._icon),
                addIcon = false;

            // if we're not reusing the icon, remove the old one and init new one
            if (icon !== this._icon) {
                if (this._icon) {
                    this._removeIcon();
                }
                addIcon = true;

                if (options.title) {
                    icon.title = options.title;
                }
                if (options.alt) {
                    icon.alt = options.alt;
                }
            }

            L.DomUtil.addClass(icon, classToAdd);

            if (options.keyboard) {
                icon.tabIndex = '0';
            }

            this._icon = icon;

            if (options.riseOnHover) {
                this.on({
                    mouseover: this._bringToFront,
                    mouseout: this._resetZIndex
                });
            }

            var newShadow = options.icon.createShadow(this._shadow),
                addShadow = false;

            if (newShadow !== this._shadow) {
                this._removeShadow();
                addShadow = true;
            }

            if (newShadow) {
                L.DomUtil.addClass(newShadow, classToAdd);
            }
            this._shadow = newShadow;


            if (options.opacity < 1) {
                this._updateOpacity();
            }


            if (addIcon) {
                this.getPane().appendChild(this._icon);
            }
            this._initInteraction();
            if (newShadow && addShadow) {
                this.getPane('shadowPane').appendChild(this._shadow);
            }
        },

        _removeIcon: function () {
            if (this.options.riseOnHover) {
                this.off({
                    mouseover: this._bringToFront,
                    mouseout: this._resetZIndex
                });
            }

            L.DomUtil.remove(this._icon);
            this.removeInteractiveTarget(this._icon);

            this._icon = null;
        },

        _removeShadow: function () {
            if (this._shadow) {
                L.DomUtil.remove(this._shadow);
            }
            this._shadow = null;
        },

        _setPos: function (pos) {
            L.DomUtil.setPosition(this._icon, pos);

            if (this._shadow) {
                L.DomUtil.setPosition(this._shadow, pos);
            }

            this._zIndex = pos.y + this.options.zIndexOffset;

            this._resetZIndex();
        },

        _updateZIndex: function (offset) {
            this._icon.style.zIndex = this._zIndex + offset;
        },

        _animateZoom: function (opt) {
            var pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center).round();

            this._setPos(pos);
        },

        _initInteraction: function () {

            if (!this.options.interactive) { return; }

            L.DomUtil.addClass(this._icon, 'leaflet-interactive');

            this.addInteractiveTarget(this._icon);

            if (L.Handler.MarkerDrag) {
                var draggable = this.options.draggable;
                if (this.dragging) {
                    draggable = this.dragging.enabled();
                    this.dragging.disable();
                }

                this.dragging = new L.Handler.MarkerDrag(this);

                if (draggable) {
                    this.dragging.enable();
                }
            }
        },

        // @method setOpacity(opacity: Number): this
        // Changes the opacity of the marker.
        setOpacity: function (opacity) {
            this.options.opacity = opacity;
            if (this._map) {
                this._updateOpacity();
            }

            return this;
        },

        _updateOpacity: function () {
            var opacity = this.options.opacity;

            L.DomUtil.setOpacity(this._icon, opacity);

            if (this._shadow) {
                L.DomUtil.setOpacity(this._shadow, opacity);
            }
        },

        _bringToFront: function () {
            this._updateZIndex(this.options.riseOffset);
        },

        _resetZIndex: function () {
            this._updateZIndex(0);
        }
    });


// factory L.marker(latlng: LatLng, options? : Marker options)

// @factory L.marker(latlng: LatLng, options? : Marker options)
// Instantiates a Marker object given a geographical point and optionally an options object.
    L.marker = function (latlng, options, data) {
        return new L.Marker(latlng, options, data);
    };



    /*
     * @class DivIcon
     * @aka L.DivIcon
     * @inherits Icon
     *
     * Represents a lightweight icon for markers that uses a simple `<div>`
     * element instead of an image. Inherits from `Icon` but ignores the `iconUrl` and shadow options.
     *
     * @example
     * ```js
     * var myIcon = L.divIcon({className: 'my-div-icon'});
     * // you can set .my-div-icon styles in CSS
     *
     * L.marker([50.505, 30.57], {icon: myIcon}).addTo(map);
     * ```
     *
     * By default, it has a 'leaflet-div-icon' CSS class and is styled as a little white square with a shadow.
     */

    L.DivIcon = L.Icon.extend({
        options: {
            // @section
            // @aka DivIcon options
            iconSize: [12, 12], // also can be set through CSS

            // iconAnchor: (Point),
            // popupAnchor: (Point),

            // @option html: String = ''
            // Custom HTML code to put inside the div element, empty by default.
            html: false,

            // @option bgPos: Point = [0, 0]
            // Optional relative position of the background, in pixels
            bgPos: null,

            className: 'leaflet-div-icon'
        },

        createIcon: function (oldIcon) {
            var div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div'),
                options = this.options;

            div.innerHTML = options.html !== false ? options.html : '';

            if (options.bgPos) {
                var bgPos = L.point(options.bgPos);
                div.style.backgroundPosition = (-bgPos.x) + 'px ' + (-bgPos.y) + 'px';
            }
            this._setIconStyles(div, 'icon');

            return div;
        },

        createShadow: function () {
            return null;
        }
    });

// @factory L.divIcon(options: DivIcon options)
// Creates a `DivIcon` instance with the given options.
    L.divIcon = function (options) {
        return new L.DivIcon(options);
    };



    /*
     * @class Popup
     * @inherits Layer
     * @aka L.Popup
     * Used to open popups in certain places of the map. Use [Map.openPopup](#map-openpopup) to
     * open popups while making sure that only one popup is open at one time
     * (recommended for usability), or use [Map.addLayer](#map-addlayer) to open as many as you want.
     *
     * @example
     *
     * If you want to just bind a popup to marker click and then open it, it's really easy:
     *
     * ```js
     * marker.bindPopup(popupContent).openPopup();
     * ```
     * Path overlays like polylines also have a `bindPopup` method.
     * Here's a more complicated way to open a popup on a map:
     *
     * ```js
     * var popup = L.popup()
     * 	.setLatLng(latlng)
     * 	.setContent('<p>Hello world!<br />This is a nice popup.</p>')
     * 	.openOn(map);
     * ```
     */


    /* @namespace Map
     * @section Interaction Options
     * @option closePopupOnClick: Boolean = true
     * Set it to `false` if you don't want popups to close when user clicks the map.
     */
    L.Map.mergeOptions({
        closePopupOnClick: true
    });

// @namespace Popup
    L.Popup = L.Layer.extend({

        // @section
        // @aka Popup options
        options: {
            // @option maxWidth: Number = 300
            // Max width of the popup, in pixels.
            maxWidth: 300,

            // @option minWidth: Number = 50
            // Min width of the popup, in pixels.
            minWidth: 50,

            // @option maxHeight: Number = null
            // If set, creates a scrollable container of the given height
            // inside a popup if its content exceeds it.
            maxHeight: null,

            // @option autoPan: Boolean = true
            // Set it to `false` if you don't want the map to do panning animation
            // to fit the opened popup.
            autoPan: true,

            // @option autoPanPaddingTopLeft: Point = null
            // The margin between the popup and the top left corner of the map
            // view after autopanning was performed.
            autoPanPaddingTopLeft: null,

            // @option autoPanPaddingBottomRight: Point = null
            // The margin between the popup and the bottom right corner of the map
            // view after autopanning was performed.
            autoPanPaddingBottomRight: null,

            // @option autoPanPadding: Point = Point(5, 5)
            // Equivalent of setting both top left and bottom right autopan padding to the same value.
            autoPanPadding: [5, 5],

            // @option keepInView: Boolean = false
            // Set it to `true` if you want to prevent users from panning the popup
            // off of the screen while it is open.
            keepInView: false,

            // @option closeButton: Boolean = true
            // Controls the presence of a close button in the popup.
            closeButton: true,

            // @option offset: Point = Point(0, 7)
            // The offset of the popup position. Useful to control the anchor
            // of the popup when opening it on some overlays.
            offset: [0, 7],

            // @option autoClose: Boolean = true
            // Set it to `false` if you want to override the default behavior of
            // the popup closing when user clicks the map (set globally by
            // the Map's [closePopupOnClick](#map-closepopuponclick) option).
            autoClose: true,

            // @option zoomAnimation: Boolean = true
            // Whether to animate the popup on zoom. Disable it if you have
            // problems with Flash content inside popups.
            zoomAnimation: true,

            // @option className: String = ''
            // A custom CSS class name to assign to the popup.
            className: '',

            // @option pane: String = 'popupPane'
            // `Map pane` where the popup will be added.
            pane: 'popupPane'
        },

        initialize: function (options, source) {
            L.setOptions(this, options);

            this._source = source;
        },

        onAdd: function (map) {
            this._zoomAnimated = this._zoomAnimated && this.options.zoomAnimation;

            if (!this._container) {
                this._initLayout();
            }

            if (map._fadeAnimated) {
                L.DomUtil.setOpacity(this._container, 0);
            }

            clearTimeout(this._removeTimeout);
            this.getPane().appendChild(this._container);
            this.update();

            if (map._fadeAnimated) {
                L.DomUtil.setOpacity(this._container, 1);
            }

            // @namespace Map
            // @section Popup events
            // @event popupopen: PopupEvent
            // Fired when a popup is opened in the map
            map.fire('popupopen', {popup: this});

            if (this._source) {
                // @namespace Layer
                // @section Popup events
                // @event popupopen: PopupEvent
                // Fired when a popup bound to this layer is opened
                this._source.fire('popupopen', {popup: this}, true);
                this._source.on('preclick', L.DomEvent.stopPropagation);
            }
        },

        // @namespace Popup
        // @method openOn(map: Map): this
        // Adds the popup to the map and closes the previous one. The same as `map.openPopup(popup)`.
        openOn: function (map) {
            map.openPopup(this);
            return this;
        },

        onRemove: function (map) {
            if (map._fadeAnimated) {
                L.DomUtil.setOpacity(this._container, 0);
                this._removeTimeout = setTimeout(L.bind(L.DomUtil.remove, L.DomUtil, this._container), 200);
            } else {
                L.DomUtil.remove(this._container);
            }

            // @namespace Map
            // @section Popup events
            // @event popupclose: PopupEvent
            // Fired when a popup in the map is closed
            map.fire('popupclose', {popup: this});

            if (this._source) {
                // @namespace Layer
                // @section Popup events
                // @event popupclose: PopupEvent
                // Fired when a popup bound to this layer is closed
                // @namespace Popup
                this._source.fire('popupclose', {popup: this}, true);
                this._source.off('preclick', L.DomEvent.stopPropagation);
            }
        },

        // @namespace Popup
        // @method getLatLng: LatLng
        // Returns the geographical point of popup.
        getLatLng: function () {
            return this._latlng;
        },

        // @method setLatLng(latlng: LatLng): this
        // Sets the geographical point where the popup will open.
        setLatLng: function (latlng) {
            this._latlng = L.latLng(latlng);
            if (this._map) {
                this._updatePosition();
                this._adjustPan();
            }
            return this;
        },

        // @method getContent: String|HTMLElement
        // Returns the content of the popup.
        getContent: function () {
            return this._content;
        },

        // @method setContent(htmlContent: String|HTMLElement|Function): this
        // Sets the HTML content of the popup. If a function is passed the source layer will be passed to the function. The function should return a `String` or `HTMLElement` to be used in the popup.
        setContent: function (content) {
            this._content = content;
            this.update();
            return this;
        },

        // @method getElement: String|HTMLElement
        // Alias for [getContent()](#popup-getcontent)
        getElement: function () {
            return this._container;
        },

        // @method update: null
        // Updates the popup content, layout and position. Useful for updating the popup after something inside changed, e.g. image loaded.
        update: function () {
            if (!this._map) { return; }

            this._container.style.visibility = 'hidden';

            this._updateContent();
            this._updateLayout();
            this._updatePosition();

            this._container.style.visibility = '';

            this._adjustPan();
        },

        getEvents: function () {
            var events = {
                zoom: this._updatePosition,
                viewreset: this._updatePosition
            };

            if (this._zoomAnimated) {
                events.zoomanim = this._animateZoom;
            }
            if ('closeOnClick' in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) {
                events.preclick = this._close;
            }
            if (this.options.keepInView) {
                events.moveend = this._adjustPan;
            }
            return events;
        },

        // @method isOpen: Boolean
        // Returns `true` when the popup is visible on the map.
        isOpen: function () {
            return !!this._map && this._map.hasLayer(this);
        },

        // @method bringToFront: this
        // Brings this popup in front of other popups (in the same map pane).
        bringToFront: function () {
            if (this._map) {
                L.DomUtil.toFront(this._container);
            }
            return this;
        },

        // @method bringToBack: this
        // Brings this popup to the back of other popups (in the same map pane).
        bringToBack: function () {
            if (this._map) {
                L.DomUtil.toBack(this._container);
            }
            return this;
        },

        _close: function () {
            if (this._map) {
                this._map.closePopup(this);
            }
        },

        _initLayout: function () {
            var prefix = 'leaflet-popup',
                container = this._container = L.DomUtil.create('div',
                    prefix + ' ' + (this.options.className || '') +
                    ' leaflet-zoom-' + (this._zoomAnimated ? 'animated' : 'hide'));

            if (this.options.closeButton) {
                var closeButton = this._closeButton = L.DomUtil.create('a', prefix + '-close-button', container);
                closeButton.href = '#close';
                closeButton.innerHTML = '&#215;';

                L.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);
            }

            var wrapper = this._wrapper = L.DomUtil.create('div', prefix + '-content-wrapper', container);
            this._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);

            L.DomEvent
                .disableClickPropagation(wrapper)
                .disableScrollPropagation(this._contentNode)
                .on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);

            this._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);
            this._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);
        },

        _updateContent: function () {
            if (!this._content) { return; }

            var node = this._contentNode;
            var content = (typeof this._content === 'function') ? this._content(this._source || this) : this._content;

            if (typeof content === 'string') {
                node.innerHTML = content;
            } else {
                while (node.hasChildNodes()) {
                    node.removeChild(node.firstChild);
                }
                node.appendChild(content);
            }
            this.fire('contentupdate');
        },

        _updateLayout: function () {
            var container = this._contentNode,
                style = container.style;

            style.width = '';
            style.whiteSpace = 'nowrap';

            var width = container.offsetWidth;
            width = Math.min(width, this.options.maxWidth);
            width = Math.max(width, this.options.minWidth);

            style.width = (width + 1) + 'px';
            style.whiteSpace = '';

            style.height = '';

            var height = container.offsetHeight,
                maxHeight = this.options.maxHeight,
                scrolledClass = 'leaflet-popup-scrolled';

            if (maxHeight && height > maxHeight) {
                style.height = maxHeight + 'px';
                L.DomUtil.addClass(container, scrolledClass);
            } else {
                L.DomUtil.removeClass(container, scrolledClass);
            }

            this._containerWidth = this._container.offsetWidth;
        },

        _updatePosition: function () {
            if (!this._map) { return; }

            var pos = this._map.latLngToLayerPoint(this._latlng),
                offset = L.point(this.options.offset);

            if (this._zoomAnimated) {
                L.DomUtil.setPosition(this._container, pos);
            } else {
                offset = offset.add(pos);
            }

            var bottom = this._containerBottom = -offset.y,
                left = this._containerLeft = -Math.round(this._containerWidth / 2) + offset.x;

            // bottom position the popup in case the height of the popup changes (images loading etc)
            this._container.style.bottom = bottom + 'px';
            this._container.style.left = left + 'px';
        },

        _animateZoom: function (e) {
            var pos = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center);
            L.DomUtil.setPosition(this._container, pos);
        },

        _adjustPan: function () {
            if (!this.options.autoPan || (this._map._panAnim && this._map._panAnim._inProgress)) { return; }

            var map = this._map,
                containerHeight = this._container.offsetHeight,
                containerWidth = this._containerWidth,
                layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);

            if (this._zoomAnimated) {
                layerPos._add(L.DomUtil.getPosition(this._container));
            }

            var containerPos = map.layerPointToContainerPoint(layerPos),
                padding = L.point(this.options.autoPanPadding),
                paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),
                paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),
                size = map.getSize(),
                dx = 0,
                dy = 0;

            if (containerPos.x + containerWidth + paddingBR.x > size.x) { // right
                dx = containerPos.x + containerWidth - size.x + paddingBR.x;
            }
            if (containerPos.x - dx - paddingTL.x < 0) { // left
                dx = containerPos.x - paddingTL.x;
            }
            if (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom
                dy = containerPos.y + containerHeight - size.y + paddingBR.y;
            }
            if (containerPos.y - dy - paddingTL.y < 0) { // top
                dy = containerPos.y - paddingTL.y;
            }

            // @namespace Map
            // @section Popup events
            // @event autopanstart
            // Fired when the map starts autopanning when opening a popup.
            if (dx || dy) {
                map
                    .fire('autopanstart')
                    .panBy([dx, dy]);
            }
        },

        _onCloseButtonClick: function (e) {
            this._close();
            L.DomEvent.stop(e);
        }
    });

// @namespace Popup
// @factory L.popup(options?: Popup options, source?: Layer)
// Instantiates a Popup object given an optional `options` object that describes its appearance and location and an optional `source` object that is used to tag the popup with a reference to the Layer to which it refers.
    L.popup = function (options, source) {
        return new L.Popup(options, source);
    };


// @namespace Map
// @section Methods for Layers and Controls
    L.Map.include({
        // @method openPopup(popup: Popup): this
        // Opens the specified popup while closing the previously opened (to make sure only one is opened at one time for usability).
        // @alternative
        // @method openPopup(content: String|HTMLElement, latlng: LatLng, options?: Popup options): this
        // Creates a popup with the specified content and options and opens it in the given point on a map.
        openPopup: function (popup, latlng, options) {
            if (!(popup instanceof L.Popup)) {
                popup = new L.Popup(options).setContent(popup);
            }

            if (latlng) {
                popup.setLatLng(latlng);
            }

            if (this.hasLayer(popup)) {
                return this;
            }

            if (this._popup && this._popup.options.autoClose) {
                this.closePopup();
            }

            this._popup = popup;
            return this.addLayer(popup);
        },

        // @method closePopup(popup?: Popup): this
        // Closes the popup previously opened with [openPopup](#map-openpopup) (or the given one).
        closePopup: function (popup) {
            if (!popup || popup === this._popup) {
                popup = this._popup;
                this._popup = null;
            }
            if (popup) {
                this.removeLayer(popup);
            }
            return this;
        }
    });



    /*
     * @namespace Layer
     * @section Popup methods example
     *
     * All layers share a set of methods convenient for binding popups to it.
     *
     * ```js
     * var layer = L.Polygon(latlngs).bindPopup('Hi There!').addTo(map);
     * layer.openPopup();
     * layer.closePopup();
     * ```
     *
     * Popups will also be automatically opened when the layer is clicked on and closed when the layer is removed from the map or another popup is opened.
     */

// @section Popup methods
    L.Layer.include({

        // @method bindPopup(content: String|HTMLElement|Function|Popup, options?: Popup options): this
        // Binds a popup to the layer with the passed `content` and sets up the
        // neccessary event listeners. If a `Function` is passed it will receive
        // the layer as the first argument and should return a `String` or `HTMLElement`.
        bindPopup: function (content, options) {

            if (content instanceof L.Popup) {
                L.setOptions(content, options);
                this._popup = content;
                content._source = this;
            } else {
                if (!this._popup || options) {
                    this._popup = new L.Popup(options, this);
                }
                this._popup.setContent(content);
            }

            if (!this._popupHandlersAdded) {
                this.on({
                    click: this._openPopup,
                    remove: this.closePopup,
                    move: this._movePopup
                });
                this._popupHandlersAdded = true;
            }

            // save the originally passed offset
            this._originalPopupOffset = this._popup.options.offset;

            return this;
        },

        // @method unbindPopup(): this
        // Removes the popup previously bound with `bindPopup`.
        unbindPopup: function () {
            if (this._popup) {
                this.off({
                    click: this._openPopup,
                    remove: this.closePopup,
                    move: this._movePopup
                });
                this._popupHandlersAdded = false;
                this._popup = null;
            }
            return this;
        },

        // @method openPopup(latlng?: LatLng): this
        // Opens the bound popup at the specificed `latlng` or at the default popup anchor if no `latlng` is passed.
        openPopup: function (layer, latlng) {
            if (!(layer instanceof L.Layer)) {
                latlng = layer;
                layer = this;
            }

            if (layer instanceof L.FeatureGroup) {
                for (var id in this._layers) {
                    layer = this._layers[id];
                    break;
                }
            }

            if (!latlng) {
                latlng = layer.getCenter ? layer.getCenter() : layer.getLatLng();
            }

            if (this._popup && this._map) {
                // set the popup offset for this layer
                this._popup.options.offset = this._popupAnchor(layer);

                // set popup source to this layer
                this._popup._source = layer;

                // update the popup (content, layout, ect...)
                this._popup.update();

                // open the popup on the map
                this._map.openPopup(this._popup, latlng);
            }

            return this;
        },

        // @method closePopup(): this
        // Closes the popup bound to this layer if it is open.
        closePopup: function () {
            if (this._popup) {
                this._popup._close();
            }
            return this;
        },

        // @method closePopup(): this
        // Opens or closes the popup bound to this layer depending on its current state.
        togglePopup: function (target) {
            if (this._popup) {
                if (this._popup._map) {
                    this.closePopup();
                } else {
                    this.openPopup(target);
                }
            }
            return this;
        },

        // @method closePopup(): this
        // Returns `true` if the popup bound to this layer is currently open.
        isPopupOpen: function () {
            return this._popup.isOpen();
        },

        // @method setPopupContent(content: String|HTMLElement|Popup, options?: Popup options): this
        // Sets the content of the popup bound to this layer.
        setPopupContent: function (content) {
            if (this._popup) {
                this._popup.setContent(content);
            }
            return this;
        },

        // @method getPopup(): Popup
        // Returns the popup bound to this layer.
        getPopup: function () {
            return this._popup;
        },

        _openPopup: function (e) {
            var layer = e.layer || e.target;

            if (!this._popup) {
                return;
            }

            if (!this._map) {
                return;
            }

            // if this inherits from Path its a vector and we can just
            // open the popup at the new location
            if (layer instanceof L.Path) {
                this.openPopup(e.layer || e.target, e.latlng);
                return;
            }

            // otherwise treat it like a marker and figure out
            // if we should toggle it open/closed
            if (this._map.hasLayer(this._popup) && this._popup._source === layer) {
                this.closePopup();
            } else {
                this.openPopup(layer, e.latlng);
            }
        },

        _popupAnchor: function (layer) {
            // where shold we anchor the popup on this layer?
            var anchor = layer._getPopupAnchor ? layer._getPopupAnchor() : [0, 0];

            // add the users passed offset to that
            var offsetToAdd = this._originalPopupOffset || L.Popup.prototype.options.offset;

            // return the final point to anchor the popup
            return L.point(anchor).add(offsetToAdd);
        },

        _movePopup: function (e) {
            this._popup.setLatLng(e.latlng);
        }
    });



    /*
     * Popup extension to L.Marker, adding popup-related methods.
     */

    L.Marker.include({
        _getPopupAnchor: function () {
            return this.options.icon.options.popupAnchor || [0, 0];
        }
    });



    /*
     * @class LayerGroup
     * @aka L.LayerGroup
     * @inherits Layer
     *
     * Used to group several layers and handle them as one. If you add it to the map,
     * any layers added or removed from the group will be added/removed on the map as
     * well. Extends `Layer`.
     *
     * @example
     *
     * ```js
     * L.layerGroup([marker1, marker2])
     * 	.addLayer(polyline)
     * 	.addTo(map);
     * ```
     */

    L.LayerGroup = L.Layer.extend({

        initialize: function (layers) {
            this._layers = {};

            var i, len;

            if (layers) {
                for (i = 0, len = layers.length; i < len; i++) {
                    this.addLayer(layers[i]);
                }
            }
        },

        beforeAdd:function(map){
            this._renderer = map.getRenderer(this);
        },

        onAdd: function (map) {
            this._renderer._initGroup(this);
            this._renderer._addGroup(this);

            for (var i in this._layers) {
                map.addLayer(this._layers[i]);
            }
        },

        // @method addLayer(layer: Layer): this
        // Adds the given layer to the group.
        addLayer: function (layer) {
            var id = this.getLayerId(layer);

            this._layers[id] = layer;

            if (this._map) {
                layer._layerGroup = this;
                this._map.addLayer(layer);
            }

            return this;
        },

        // @method removeLayer(layer: Layer): this
        // Removes the given layer from the group.
        // @alternative
        // @method removeLayer(id: Number): this
        // Removes the layer with the given internal ID from the group.
        removeLayer: function (layer) {
            var id = layer in this._layers ? layer : this.getLayerId(layer);

            if (this._map && this._layers[id]) {
                this._map.removeLayer(this._layers[id]);
            }

            delete this._layers[id];

            return this;
        },

        // @method hasLayer(layer: Layer): Boolean
        // Returns `true` if the given layer is currently added to the group.
        hasLayer: function (layer) {
            return !!layer && (layer in this._layers || this.getLayerId(layer) in this._layers);
        },

        // @method clearLayers(): this
        // Removes all the layers from the group.
        clearLayers: function () {
            for (var i in this._layers) {
                this.removeLayer(this._layers[i]);
            }
            return this;
        },

        // @method invoke(methodName: string, ): this
        // Calls `methodName` on every layer contained in this group, passing any
        // additional parameters. Has no effect if the layers contained do not
        // implement `methodName`.
        invoke: function (methodName) {
            var args = Array.prototype.slice.call(arguments, 1),
                i, layer;

            for (i in this._layers) {
                layer = this._layers[i];

                if (layer[methodName]) {
                    layer[methodName].apply(layer, args);
                }
            }

            return this;
        },

        onRemove: function (map) {
            for (var i in this._layers) {
                map.removeLayer(this._layers[i]);
            }
        },

        // @method eachLayer(fn: Function, context?: Object): this
        // Iterates over the layers of the group, optionally specifying context of the iterator function.
        // ```js
        // group.eachLayer(function (layer) {
        // 	layer.bindPopup('Hello');
        // });
        // ```
        eachLayer: function (method, context) {
            for (var i in this._layers) {
                method.call(context, this._layers[i]);
            }
            return this;
        },

        // @method getLayer(id: Number): Layer
        // Returns the layer with the given internal ID.
        getLayer: function (id) {
            return this._layers[id];
        },

        // @method getLayers(): Layer[]
        // Returns an array of all the layers added to the group.
        getLayers: function () {
            var layers = [];

            for (var i in this._layers) {
                layers.push(this._layers[i]);
            }
            return layers;
        },

        // @method setZIndex(zIndex: Number): this
        // Calls `setZIndex` on every layer contained in this group, passing the z-index.
        setZIndex: function (zIndex) {
            return this.invoke('setZIndex', zIndex);
        },

        // @method getLayerId(layer: Layer): Number
        // Returns the internal ID for a layer
        getLayerId: function (layer) {
            return L.stamp(layer);
        }
    });


// @factory L.layerGroup(layers: Layer[])
// Create a layer group, optionally given an initial set of layers.
    L.layerGroup = function (layers) {
        return new L.LayerGroup(layers);
    };

    /*
     * @class FeatureGroup
     * @aka L.FeatureGroup
     * @inherits LayerGroup
     *
     * Extended `LayerGroup` that also has mouse events (propagated from members of the group) and a shared bindPopup method.
     *
     * @example
     *
     * ```js
     * L.featureGroup([marker1, marker2, polyline])
     * 	.bindPopup('Hello world!')
     * 	.on('click', function() { alert('Clicked on a group!'); })
     * 	.addTo(map);
     * ```
     */

    L.FeatureGroup = L.LayerGroup.extend({

        addLayer: function (layer) {
            if (this.hasLayer(layer)) {
                return this;
            }

            layer.addEventParent(this);

            L.LayerGroup.prototype.addLayer.call(this, layer);

            return this.fire('layeradd', {layer: layer});
        },

        removeLayer: function (layer) {
            if (!this.hasLayer(layer)) {
                return this;
            }
            if (layer in this._layers) {
                layer = this._layers[layer];
            }

            layer.removeEventParent(this);

            L.LayerGroup.prototype.removeLayer.call(this, layer);

            return this.fire('layerremove', {layer: layer});
        },

        // @method setStyle(style: Path options): this
        // Sets the given path options to each layer of the group that has a `setStyle` method.
        setStyle: function (style) {
            return this.invoke('setStyle', style);
        },

        // @method bringToFront(): this
        // Brings the layer group to the top of all other layers
        bringToFront: function () {
            return this.invoke('bringToFront');
        },

        // @method bringToBack(): this
        // Brings the layer group to the top of all other layers
        bringToBack: function () {
            return this.invoke('bringToBack');
        },

        // @method getBounds(): LatLngBounds
        // Returns the LatLngBounds of the Feature Group (created from bounds and coordinates of its children).
        getBounds: function () {
            var bounds = new L.LatLngBounds();

            for (var id in this._layers) {
                var layer = this._layers[id];
                bounds.extend(layer.getBounds ? layer.getBounds() : layer.getLatLng());
            }
            return bounds;
        }
    });

// @factory L.featureGroup(layers: Layer[])
// Create a feature group, optionally given an initial set of layers.
    L.featureGroup = function (layers) {
        return new L.FeatureGroup(layers);
    };



    /*
     * @class Renderer
     * @inherits Layer
     * @aka L.Renderer
     *
     * Base class for vector renderer implementations (`SVG`, `Canvas`). Handles the
     * DOM container of the renderer, its bounds, and its zoom animation.
     *
     * A `Renderer` works as an implicit layer group for all `Path`s - the renderer
     * itself can be added or removed to the map. All paths use a renderer, which can
     * be implicit (the map will decide the type of renderer and use it automatically)
     * or explicit (using the [`renderer`](#path-renderer) option of the path).
     *
     * Do not use this class directly, use `SVG` and `Canvas` instead.
     *
     */

    L.Renderer = L.Layer.extend({

        options: {
            // @option padding: Number = 0.1
            // How much to extend the clip area around the map view (relative to its size)
            // e.g. 0.1 would be 10% of map view in each direction
            padding: 0.1
        },

        initialize: function (options) {
            L.setOptions(this, options);
            L.stamp(this);
        },

        onAdd: function () {
            if (!this._container) {
                this._initContainer(); // defined by renderer implementations

                if (this._zoomAnimated) {
                    L.DomUtil.addClass(this._container, 'leaflet-zoom-animated');
                }
            }

            this.getPane().appendChild(this._container);
            this._update();
        },

        onRemove: function () {
            L.DomUtil.remove(this._container);
        },

        getEvents: function () {
            var events = {
                viewreset: this._reset,
                zoom: this._onZoom,
                moveend: this._update
            };
            if (this._zoomAnimated) {
                events.zoomanim = this._onAnimZoom;
            }
            return events;
        },

        _onAnimZoom: function (ev) {
            this._updateTransform(ev.center, ev.zoom);
        },

        _onZoom: function () {
            this._updateTransform(this._map.getCenter(), this._map.getZoom());
        },

        _updateTransform: function (center, zoom) {
            var scale = this._map.getZoomScale(zoom, this._zoom),
                position = L.DomUtil.getPosition(this._container),
                viewHalf = this._map.getSize().multiplyBy(0.5 + this.options.padding),
                currentCenterPoint = this._map.project(this._center, zoom),
                destCenterPoint = this._map.project(center, zoom),
                centerOffset = destCenterPoint.subtract(currentCenterPoint),

                topLeftOffset = viewHalf.multiplyBy(-scale).add(position).add(viewHalf).subtract(centerOffset);

            if (L.Browser.any3d) {
                L.DomUtil.setTransform(this._container, topLeftOffset, scale);
            } else if(L.Browser.svg){
                L.DomUtil.setPosition(this._container, topLeftOffset);
            }else {
                this._container.style.left = 0 + 'px';
                this._container.style.top = 0 + 'px';
            }
        },

        _reset: function () {
            this._update();
            this._updateTransform(this._center, this._zoom);
        },

        _update: function () {
            // update pixel bounds of renderer container (for positioning/sizing/clipping later)
            var p = this.options.padding,
                size = this._map.getSize(),
                min = this._map.containerPointToLayerPoint(size.multiplyBy(-p)).round();

            this._bounds = new L.Bounds(min, min.add(size.multiplyBy(1 + p * 2)).round());

            this._center = this._map.getCenter();
            this._zoom = this._map.getZoom();
        }
    });


    L.Map.include({
        // @namespace Map; @method getRenderer(layer: Path): Renderer
        // Returns the instance of `Renderer` that should be used to render the given
        // `Path`. It will ensure that the `renderer` options of the map and paths
        // are respected, and that the renderers do exist on the map.
        getRenderer: function (layer) {
            // @namespace Path; @option renderer: Renderer
            // Use this specific instance of `Renderer` for this path. Takes
            // precedence over the map's [default renderer](#map-renderer).
            var renderer = layer.options.renderer || this._getPaneRenderer(layer.options.pane) || this.options.renderer || this._renderer;

            if (!renderer) {
                // @namespace Map; @option preferCanvas: Boolean = false
                // Whether `Path`s should be rendered on a `Canvas` renderer.
                // By default, all `Path`s are rendered in a `SVG` renderer.
                renderer = this._renderer = (this.options.preferCanvas && L.canvas()) || L.svg();
            }

            if (!this.hasLayer(renderer)) {
                this.addLayer(renderer);
            }
            return renderer;
        },

        _getPaneRenderer: function (name) {
            if (name === 'overlayPane' || name === undefined) {
                return false;
            }

            var renderer = this._paneRenderers[name];
            if (renderer === undefined) {
                renderer = (L.SVG && L.svg({pane: name})) || (L.Canvas && L.canvas({pane: name}));
                this._paneRenderers[name] = renderer;
            }
            return renderer;
        }
    });



    /*
     * @class Path
     * @aka L.Path
     * @inherits Layer
     *
     * An abstract class that contains options and constants shared between vector
     * overlays (Polygon, Polyline, Circle). Do not use it directly. Extends `Layer`.
     */

    L.Path = L.Layer.extend({

        // @section
        // @aka Path options
        options: {
            // @option stroke: Boolean = true
            // Whether to draw stroke along the path. Set it to `false` to disable borders on polygons or circles.
            stroke: true,

            // @option color: String = '#3388ff'
            // Stroke color
            color: '#3388ff',

            // @option weight: Number = 3
            // Stroke width in pixels
            weight: 3,

            // @option opacity: Number = 1.0
            // Stroke opacity
            opacity: 1,

            // @option lineCap: String= 'round'
            // A string that defines [shape to be used at the end](https://developer.mozilla.org/docs/Web/SVG/Attribute/stroke-linecap) of the stroke.
            lineCap: 'round',

            // @option lineJoin: String = 'round'
            // A string that defines [shape to be used at the corners](https://developer.mozilla.org/docs/Web/SVG/Attribute/stroke-linejoin) of the stroke.
            lineJoin: 'round',

            // @option dashArray: String = null
            // A string that defines the stroke [dash pattern](https://developer.mozilla.org/docs/Web/SVG/Attribute/stroke-dasharray). Doesn't work on canvas-powered layers (e.g. Android 2).
            dashArray: null,

            // @option dashOffset: String = null
            // A string that defines the [distance into the dash pattern to start the dash](https://developer.mozilla.org/docs/Web/SVG/Attribute/stroke-dashoffset). Doesn't work on canvas-powered layers
            dashOffset: null,

            // @option fill: Boolean = depends
            // Whether to fill the path with color. Set it to `false` to disable filling on polygons or circles.
            fill: false,

            // @option fillColor: String = *
            // Fill color. Defaults to the value of the [`color`](#path-color) option
            fillColor: null,

            // @option fillOpacity: Number = 0.2
            // Fill opacity.
            fillOpacity: 0.2,

            // @option fillRule: String = 'evenodd'
            // A string that defines [how the inside of a shape](https://developer.mozilla.org/docs/Web/SVG/Attribute/fill-rule) is determined.
            fillRule: 'evenodd',

            // className: '',

            // @option interactive: Boolean = true
            // If `false`, the vector will not emit mouse events and will act as a part of the underlying map.
            interactive: true
        },

        beforeAdd: function (map) {
            // Renderer is set here because we need to call renderer.getEvents
            // before this.getEvents.
            this._renderer = map.getRenderer(this);
        },

        onAdd: function () {
            this._renderer._initPath(this);
            this._reset();
            this._renderer._addPath(this);
        },

        onRemove: function () {
            this._renderer._removePath(this);
        },

        getEvents: function () {
            return {
                zoomend: this._project,
                moveend: this._update,
                viewreset: this._reset
            };
        },

        // @method redraw(): this
        // Redraws the layer. Sometimes useful after you changed the coordinates that the path uses.
        redraw: function () {
            if (this._map) {
                this._renderer._updatePath(this);
            }
            return this;
        },

        // @method setStyle(style: Path options): this
        // Changes the appearance of a Path based on the options in the `Path options` object.
        setStyle: function (style) {
            L.setOptions(this, style);
            if (this._renderer) {
                this._renderer._updateStyle(this);
            }
            return this;
        },

        // @method bringToFront(): this
        // Brings the layer to the top of all path layers.
        bringToFront: function () {
            if (this._renderer) {
                this._renderer._bringToFront(this);
            }
            return this;
        },

        // @method bringToBack(): this
        // Brings the layer to the bottom of all path layers.
        bringToBack: function () {
            if (this._renderer) {
                this._renderer._bringToBack(this);
            }
            return this;
        },

        getElement: function () {
            return this._path;
        },

        _reset: function () {
            // defined in children classes
            this._project();
            this._update();
        },

        _clickTolerance: function () {
            // used when doing hit detection for Canvas layers
            return (this.options.stroke ? this.options.weight / 2 : 0) + (L.Browser.touch ? 10 : 0);
        }
    });



    /*
     * @namespace LineUtil
     *
     * Various utility functions for polyine points processing, used by Leaflet internally to make polylines lightning-fast.
     */

    L.LineUtil = {

        // Simplify polyline with vertex reduction and Douglas-Peucker simplification.
        // Improves rendering performance dramatically by lessening the number of points to draw.

        // @function simplify(points: Point[], tolerance: Number): Point[]
        // Dramatically reduces the number of points in a polyline while retaining
        // its shape and returns a new array of simplified points, using the
        // [Douglas-Peucker algorithm](http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm).
        // Used for a huge performance boost when processing/displaying Leaflet polylines for
        // each zoom level and also reducing visual noise. tolerance affects the amount of
        // simplification (lesser value means higher quality but slower and with more points).
        // Also released as a separated micro-library [Simplify.js](http://mourner.github.com/simplify-js/).
        simplify: function (points, tolerance) {
            if (!tolerance || !points.length) {
                return points.slice();
            }

            var sqTolerance = tolerance * tolerance;

            // stage 1: vertex reduction
            points = this._reducePoints(points, sqTolerance);

            // stage 2: Douglas-Peucker simplification
            points = this._simplifyDP(points, sqTolerance);

            return points;
        },

        // @function pointToSegmentDistance(p: Point, p1: Point, p2: Point): Number
        // Returns the distance between point `p` and segment `p1` to `p2`.
        pointToSegmentDistance:  function (p, p1, p2) {
            return Math.sqrt(this._sqClosestPointOnSegment(p, p1, p2, true));
        },

        // @function closestPointOnSegment(p: Point, p1: Point, p2: Point): Number
        // Returns the closest point from a point `p` on a segment `p1` to `p2`.
        closestPointOnSegment: function (p, p1, p2) {
            return this._sqClosestPointOnSegment(p, p1, p2);
        },

        // Douglas-Peucker simplification, see http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm
        _simplifyDP: function (points, sqTolerance) {

            var len = points.length,
                ArrayConstructor = typeof Uint8Array !== undefined + '' ? Uint8Array : Array,
                markers = new ArrayConstructor(len);

            markers[0] = markers[len - 1] = 1;

            this._simplifyDPStep(points, markers, sqTolerance, 0, len - 1);

            var i,
                newPoints = [];

            for (i = 0; i < len; i++) {
                if (markers[i]) {
                    newPoints.push(points[i]);
                }
            }

            return newPoints;
        },

        _simplifyDPStep: function (points, markers, sqTolerance, first, last) {

            var maxSqDist = 0,
                index, i, sqDist;

            for (i = first + 1; i <= last - 1; i++) {
                sqDist = this._sqClosestPointOnSegment(points[i], points[first], points[last], true);

                if (sqDist > maxSqDist) {
                    index = i;
                    maxSqDist = sqDist;
                }
            }

            if (maxSqDist > sqTolerance) {
                markers[index] = 1;

                this._simplifyDPStep(points, markers, sqTolerance, first, index);
                this._simplifyDPStep(points, markers, sqTolerance, index, last);
            }
        },

        // reduce points that are too close to each other to a single point
        _reducePoints: function (points, sqTolerance) {
            var reducedPoints = [points[0]];

            for (var i = 1, prev = 0, len = points.length; i < len; i++) {
                if (this._sqDist(points[i], points[prev]) > sqTolerance) {
                    reducedPoints.push(points[i]);
                    prev = i;
                }
            }
            if (prev < len - 1) {
                reducedPoints.push(points[len - 1]);
            }
            return reducedPoints;
        },


        // Clips the segment a to b by rectangular bounds with the
        // [Cohen-Sutherland algorithm](https://en.wikipedia.org/wiki/Cohen%E2%80%93Sutherland_algorithm)
        // (modifying the segment points directly!). Used by Leaflet to only show polyline
        // points that are on the screen or near, increasing performance.
        clipSegment: function (a, b, bounds, useLastCode, round) {
            var codeA = useLastCode ? this._lastCode : this._getBitCode(a, bounds),
                codeB = this._getBitCode(b, bounds),

                codeOut, p, newCode;

            // save 2nd code to avoid calculating it on the next segment
            this._lastCode = codeB;

            while (true) {
                // if a,b is inside the clip window (trivial accept)
                if (!(codeA | codeB)) { return [a, b]; }

                // if a,b is outside the clip window (trivial reject)
                if (codeA & codeB) { return false; }

                // other cases
                codeOut = codeA || codeB;
                p = this._getEdgeIntersection(a, b, codeOut, bounds, round);
                newCode = this._getBitCode(p, bounds);

                if (codeOut === codeA) {
                    a = p;
                    codeA = newCode;
                } else {
                    b = p;
                    codeB = newCode;
                }
            }
        },

        _getEdgeIntersection: function (a, b, code, bounds, round) {
            var dx = b.x - a.x,
                dy = b.y - a.y,
                min = bounds.min,
                max = bounds.max,
                x, y;

            if (code & 8) { // top
                x = a.x + dx * (max.y - a.y) / dy;
                y = max.y;

            } else if (code & 4) { // bottom
                x = a.x + dx * (min.y - a.y) / dy;
                y = min.y;

            } else if (code & 2) { // right
                x = max.x;
                y = a.y + dy * (max.x - a.x) / dx;

            } else if (code & 1) { // left
                x = min.x;
                y = a.y + dy * (min.x - a.x) / dx;
            }

            return new L.Point(x, y, round);
        },

        _getBitCode: function (p, bounds) {
            var code = 0;

            if (p.x < bounds.min.x) { // left
                code |= 1;
            } else if (p.x > bounds.max.x) { // right
                code |= 2;
            }

            if (p.y < bounds.min.y) { // bottom
                code |= 4;
            } else if (p.y > bounds.max.y) { // top
                code |= 8;
            }

            return code;
        },

        // square distance (to avoid unnecessary Math.sqrt calls)
        _sqDist: function (p1, p2) {
            var dx = p2.x - p1.x,
                dy = p2.y - p1.y;
            return dx * dx + dy * dy;
        },

        // return closest point on segment or distance to that point
        _sqClosestPointOnSegment: function (p, p1, p2, sqDist) {
            var x = p1.x,
                y = p1.y,
                dx = p2.x - x,
                dy = p2.y - y,
                dot = dx * dx + dy * dy,
                t;

            if (dot > 0) {
                t = ((p.x - x) * dx + (p.y - y) * dy) / dot;

                if (t > 1) {
                    x = p2.x;
                    y = p2.y;
                } else if (t > 0) {
                    x += dx * t;
                    y += dy * t;
                }
            }

            dx = p.x - x;
            dy = p.y - y;

            return sqDist ? dx * dx + dy * dy : new L.Point(x, y);
        }
    };

    L.text = function(latlng, options, data){
        return new L.Text(latlng, options, data);
    };

    L.Text = L.Layer.extend({

        initialize: function (latlng, options, data) {
            this._latlng = L.latLng(latlng);
            this.options = L.setOptions(this, options);
            this._data = data;
        },

        setStyle:function(){
            if(this._data.series){
                this._latlng = this._data.getLatLng(this.options.feature);
            }
            this.onRemove();
            this.onAdd();
        },

        beforeAdd: function (map) {
            this._renderer = map.getRenderer(this);
        },

        onAdd: function () {
            var useHtml = this._data.dataLabels.useHtml || !L.Browser.svg;

            //todo ,html
            if(this._map.vanchart.isHeatMap()){
                useHtml = true;
            }

            if(useHtml){
                this._text = document.createElement('div');
                this._text.style.position = 'absolute';
                this._text.style['pointer-events'] = 'none';
                this.getPane().appendChild(this._text);
            }else{
                this._renderer._initText(this);
                this._renderer._addText(this);
            }

            var labelContent = this._data.labelContent;
            var centerX = 0, startY = -this._data.labelDim.height/2;
            var chartType = this._data.series.type;
            if(chartType == 'scatter' || chartType == 'pointMap'){

                if(this._data.marker && !VanUtils.isImageMarker(this._data.marker.symbol)){
                    var radius = this._data.marker.radius || 4.5;
                    startY = -radius-this._data.labelDim.height;
                }else{
                    var iconHeight = this._data.marker ? this._data.marker.height : this._data.icon.iconSize[1];
                    startY = -iconHeight/2 -this._data.labelDim.height;
                }
            }

            for(var i = 0, count = labelContent.length; i < count; i++){
                var label = labelContent[i];

                var labelDim = label.dim;
                var labelText = label.text;
                var labelStyle = label.style;

                if(useHtml){
                    var div = document.createElement('div');
                    div.innerHTML = labelText;
                    div.style.zIndex = 1001;
                    div.style.position = 'absolute';
                    div.style.left = -labelDim.width/2 + 'px';
                    div.style.top = startY + 'px';
                    div.style.overflow = 'hidden';
                    div.style.whiteSpace = 'nowrap';

                    for(var fontStyle in labelStyle){
                        //ie789color16
                        if(fontStyle == 'color'){
                            div.style.color = ColorUtils.colorToHex(labelStyle.color);
                        }else {
                            div.style[fontStyle] = labelStyle[fontStyle];
                        }
                    }
                    this._text.appendChild(div);
                }else{
                    var span = d3.select(this._text).append('tspan')
                        .attr('x', centerX).attr('y', startY + labelDim.height/2)
                        .attr('dy', '.32em').attr("text-anchor", "middle")
                        .text(labelText);

                    VanUtils.setTextStyle(span, labelStyle);
                }
                startY += (labelDim.height + 2);
            }

            this._reset();
        },

        onRemove: function () {
            this._renderer._removeText(this);
        },

        getEvents: function () {
            return {
                zoomend: this._project,
                moveend: this._update,
                viewreset: this._reset
            };
        },

        _reset: function () {
            // defined in children classes
            this._project();
            this._update();
        },

        _project: function () {
            this._point = this._map.latLngToLayerPoint(this._latlng);
        },

        _update: function () {
            if (this._map) {
                if(this._text.tagName.toLowerCase() == 'div'){
                    this._text.style.left = this._point.x + 'px';
                    this._text.style.top = this._point.y + 'px';
                }else{
                    this._text.setAttribute("transform", 'translate(' + this._point.x + ',' + this._point.y + ')');
                }
            }
        }
    });


    L.scatterMarker = function (latlng, options, vanchartMap) {
        return new L.ScatterMarker(latlng, options, vanchartMap);
    };

    //pixel
    L.ScatterMarker = L.Path.extend({

        options:{
            markerType:'circle',
            radius:'4.5'
        },

        initialize: function (latlng, options, vanchartMap) {
            L.setOptions(this, options);
            this._latlng = L.latLng(latlng);
            this.vanchartMap = vanchartMap;
        },

        // @method getLatLng(): LatLng
        // Returns the current geographical position of the circle marker
        getLatLng: function () {
            return this._latlng;
        },

        _getMarkerPath:function(){
            var markerType = this.options.markerType;
            var r = this.options.radius;
            return VanUtils.getMarkerPath(markerType, r);
        },

        _project: function () {
            this._point = this._map.latLngToLayerPoint(this._latlng);
        },

        _update: function () {
            if (this._map) {
                this._updatePath();
            }
        },

        setStyle : function (options) {
            L.Path.prototype.setStyle.call(this, options);
            this.redraw();
            return this;
        },

        _updatePath: function () {
            var p = this._point;
            if(L.Browser.svg){
                this._path.setAttribute('d', this._getMarkerPath());
                this._path.setAttribute('transform', 'translate(' + p.x + ',' + p.y + ')');
            }else{
                this._container.style.left = p.x + 'px';
                this._container.style.top = p.y + 'px';
                this._path.v = this.vanchartMap.path2vml(this._getMarkerPath());
            }
        },

        _empty: function () {
            return this._radius && !this._renderer._bounds.intersects(this._pxBounds);
        }

    });


    /*
     * @class Polyline
     * @aka L.Polyline
     * @inherits Path
     *
     * A class for drawing polyline overlays on a map. Extends `Path`.
     *
     * @example
     *
     * ```js
     * // create a red polyline from an array of LatLng points
     * var latlngs = [
     * 	[-122.68, 45.51],
     * 	[-122.43, 37.77],
     * 	[-118.2, 34.04]
     * ];
     *
     * var polyline = L.polyline(latlngs, {color: 'red'}).addTo(map);
     *
     * // zoom the map to the polyline
     * map.fitBounds(polyline.getBounds());
     * ```
     *
     * You can also pass a multi-dimensional array to represent a `MultiPolyline` shape:
     *
     * ```js
     * // create a red polyline from an array of arrays of LatLng points
     * var latlngs = [
     * 	[[-122.68, 45.51],
     * 	 [-122.43, 37.77],
     * 	 [-118.2, 34.04]],
     * 	[[-73.91, 40.78],
     * 	 [-87.62, 41.83],
     * 	 [-96.72, 32.76]]
     * ];
     * ```
     */

    L.Polyline = L.Path.extend({

        options: {
            // @option smoothFactor: Number = 1.0
            // How much to simplify the polyline on each zoom level. More means
            // better performance and smoother look, and less means more accurate representation.
            smoothFactor: 1.0,

            // @option noClip: Boolean: false
            // Disable polyline clipping.
            noClip: false
        },

        initialize: function (latlngs, options) {
            L.setOptions(this, options);
            this._setLatLngs(latlngs);
        },

        // @method getLatLngs(): LatLng[]
        // Returns an array of the points in the path, or nested arrays of points in case of multi-polyline.
        getLatLngs: function () {
            return this._latlngs;
        },

        // @method setLatLngs(latlngs: LatLng[]): this
        // Replaces all the points in the polyline with the given array of geographical points.
        setLatLngs: function (latlngs) {
            this._setLatLngs(latlngs);
            return this.redraw();
        },

        // @method isEmpty(): Boolean
        // Returns `true` if the Polyline has no LatLngs.
        isEmpty: function () {
            return !this._latlngs.length;
        },

        closestLayerPoint: function (p) {
            var minDistance = Infinity,
                minPoint = null,
                closest = L.LineUtil._sqClosestPointOnSegment,
                p1, p2;

            for (var j = 0, jLen = this._parts.length; j < jLen; j++) {
                var points = this._parts[j];

                for (var i = 1, len = points.length; i < len; i++) {
                    p1 = points[i - 1];
                    p2 = points[i];

                    var sqDist = closest(p, p1, p2, true);

                    if (sqDist < minDistance) {
                        minDistance = sqDist;
                        minPoint = closest(p, p1, p2);
                    }
                }
            }
            if (minPoint) {
                minPoint.distance = Math.sqrt(minDistance);
            }
            return minPoint;
        },

        // @method getCenter(): LatLng
        // Returns the center ([centroid](http://en.wikipedia.org/wiki/Centroid)) of the polyline.
        getCenter: function () {
            var i, halfDist, segDist, dist, p1, p2, ratio,
                points = this._rings[0],
                len = points.length;

            if (!len) { return null; }

            // polyline centroid algorithm; only uses the first ring if there are multiple

            for (i = 0, halfDist = 0; i < len - 1; i++) {
                halfDist += points[i].distanceTo(points[i + 1]) / 2;
            }

            // The line is so small in the current view that all points are on the same pixel.
            if (halfDist === 0) {
                return this._map.layerPointToLatLng(points[0]);
            }

            for (i = 0, dist = 0; i < len - 1; i++) {
                p1 = points[i];
                p2 = points[i + 1];
                segDist = p1.distanceTo(p2);
                dist += segDist;

                if (dist > halfDist) {
                    ratio = (dist - halfDist) / segDist;
                    return this._map.layerPointToLatLng([
                        p2.x - ratio * (p2.x - p1.x),
                        p2.y - ratio * (p2.y - p1.y)
                    ]);
                }
            }
        },

        // @method getBounds(): LatLngBounds
        // Returns the `LatLngBounds` of the path.
        getBounds: function () {
            return this._bounds;
        },

        // @method addLatLng(latlng: LatLng, latlngs? LatLng[]): this
        // Adds a given point to the polyline. By default, adds to the first ring of
        // the polyline in case of a multi-polyline, but can be overridden by passing
        // a specific ring as a LatLng array (that you can earlier access with [`getLatLngs`](#polyline-getlatlngs)).
        addLatLng: function (latlng, latlngs) {
            latlngs = latlngs || this._defaultShape();
            latlng = L.latLng(latlng);
            latlngs.push(latlng);
            this._bounds.extend(latlng);
            return this.redraw();
        },

        _setLatLngs: function (latlngs) {
            this._bounds = new L.LatLngBounds();
            this._latlngs = this._convertLatLngs(latlngs);
        },

        _defaultShape: function () {
            return L.Polyline._flat(this._latlngs) ? this._latlngs : this._latlngs[0];
        },

        // recursively convert latlngs input into actual LatLng instances; calculate bounds along the way
        _convertLatLngs: function (latlngs) {
            var result = [],
                flat = L.Polyline._flat(latlngs);

            for (var i = 0, len = latlngs.length; i < len; i++) {
                if (flat) {
                    result[i] = L.latLng(latlngs[i]);
                    this._bounds.extend(result[i]);
                } else {
                    result[i] = this._convertLatLngs(latlngs[i]);
                }
            }

            return result;
        },

        _project: function () {
            var pxBounds = new L.Bounds();
            this._rings = [];
            this._projectLatlngs(this._latlngs, this._rings, pxBounds);

            var w = this._clickTolerance(),
                p = new L.Point(w, w);

            if (this._bounds.isValid() && pxBounds.isValid()) {
                pxBounds.min._subtract(p);
                pxBounds.max._add(p);
                this._pxBounds = pxBounds;
            }
        },

        // recursively turns latlngs into a set of rings with projected coordinates
        _projectLatlngs: function (latlngs, result, projectedBounds) {
            var flat = latlngs[0] instanceof L.LatLng,
                len = latlngs.length,
                i, ring;

            if (flat) {
                ring = [];
                for (i = 0; i < len; i++) {
                    ring[i] = this._map.latLngToLayerPoint(latlngs[i]);
                    projectedBounds.extend(ring[i]);
                }
                result.push(ring);
            } else {
                for (i = 0; i < len; i++) {
                    this._projectLatlngs(latlngs[i], result, projectedBounds);
                }
            }
        },

        // clip polyline by renderer bounds so that we have less to render for performance
        _clipPoints: function () {
            var bounds = this._renderer._bounds;

            this._parts = [];
            if (!this._pxBounds || !this._pxBounds.intersects(bounds)) {
                return;
            }

            if (this.options.noClip) {
                this._parts = this._rings;
                return;
            }

            var parts = this._parts,
                i, j, k, len, len2, segment, points;

            for (i = 0, k = 0, len = this._rings.length; i < len; i++) {
                points = this._rings[i];

                for (j = 0, len2 = points.length; j < len2 - 1; j++) {
                    segment = L.LineUtil.clipSegment(points[j], points[j + 1], bounds, j, true);

                    if (!segment) { continue; }

                    parts[k] = parts[k] || [];
                    parts[k].push(segment[0]);

                    // if segment goes out of screen, or it's the last one, it's the end of the line part
                    if ((segment[1] !== points[j + 1]) || (j === len2 - 2)) {
                        parts[k].push(segment[1]);
                        k++;
                    }
                }
            }
        },

        // simplify each clipped part of the polyline for performance
        _simplifyPoints: function () {
            var parts = this._parts,
                tolerance = this.options.smoothFactor;

            for (var i = 0, len = parts.length; i < len; i++) {
                parts[i] = L.LineUtil.simplify(parts[i], tolerance);
            }
        },

        _update: function () {
            if (!this._map) { return; }

            this._clipPoints();
            this._simplifyPoints();
            this._updatePath();
        },

        _updatePath: function () {
            this._renderer._updatePoly(this);
        }
    });

// @factory L.polyline(latlngs: LatLng[], options?: Path options)
// Instantiates a polyline object given an array of geographical points and
// optionally an options object. You can create a `Polyline` object with
// multiple separate lines (`MultiPolyline`) by passing an array of arrays
// of geographic points.
    L.polyline = function (latlngs, options) {
        return new L.Polyline(latlngs, options);
    };

    L.Polyline._flat = function (latlngs) {
        // true if it's a flat array of latlngs; false if nested
        return !L.Util.isArray(latlngs[0]) || (typeof latlngs[0][0] !== 'object' && typeof latlngs[0][0] !== 'undefined');
    };



    /*
     * @namespace PolyUtil
     * Various utility functions for polygon geometries.
     */

    L.PolyUtil = {};

    /* @function clipPolygon(points: Point[], bounds: Bounds, round?: Boolean): Point[]
     * Clips the polygon geometry defined by the given `points` by the given bounds (using the [Sutherland-Hodgeman algorithm](https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm)).
     * Used by Leaflet to only show polygon points that are on the screen or near, increasing
     * performance. Note that polygon points needs different algorithm for clipping
     * than polyline, so there's a seperate method for it.
     */
    L.PolyUtil.clipPolygon = function (points, bounds, round) {
        var clippedPoints,
            edges = [1, 4, 2, 8],
            i, j, k,
            a, b,
            len, edge, p,
            lu = L.LineUtil;

        for (i = 0, len = points.length; i < len; i++) {
            points[i]._code = lu._getBitCode(points[i], bounds);
        }

        // for each edge (left, bottom, right, top)
        for (k = 0; k < 4; k++) {
            edge = edges[k];
            clippedPoints = [];

            for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {
                a = points[i];
                b = points[j];

                // if a is inside the clip window
                if (!(a._code & edge)) {
                    // if b is outside the clip window (a->b goes out of screen)
                    if (b._code & edge) {
                        p = lu._getEdgeIntersection(b, a, edge, bounds, round);
                        p._code = lu._getBitCode(p, bounds);
                        clippedPoints.push(p);
                    }
                    clippedPoints.push(a);

                    // else if b is inside the clip window (a->b enters the screen)
                } else if (!(b._code & edge)) {
                    p = lu._getEdgeIntersection(b, a, edge, bounds, round);
                    p._code = lu._getBitCode(p, bounds);
                    clippedPoints.push(p);
                }
            }
            points = clippedPoints;
        }

        return points;
    };



    /*
     * @class Polygon
     * @aka L.Polygon
     * @inherits Polyline
     *
     * A class for drawing polygon overlays on a map. Extends `Polyline`.
     *
     * Note that points you pass when creating a polygon shouldn't have an additional last point equal to the first one  it's better to filter out such points.
     *
     *
     * @example
     *
     * ```js
     * // create a red polygon from an array of LatLng points
     * var latlngs = [[-111.03, 41],[-111.04, 45],[-104.05, 45],[-104.05, 41]];
     *
     * var polygon = L.polygon(latlngs, {color: 'red'}).addTo(map);
     *
     * // zoom the map to the polygon
     * map.fitBounds(polygon.getBounds());
     * ```
     *
     * You can also pass an array of arrays of latlngs, with the first array representing the outer shape and the other arrays representing holes in the outer shape:
     *
     * ```js
     * var latlngs = [
     *   [[-111.03, 41],[-111.04, 45],[-104.05, 45],[-104.05, 41]], // outer ring
     *   [[-108.58,37.29],[-108.58,40.71],[-102.50,40.71],[-102.50,37.29]] // hole
     * ];
     * ```
     *
     * Additionally, you can pass a multi-dimensional array to represent a MultiPolygon shape.
     *
     * ```js
     * var latlngs = [
     *   [ // first polygon
     *     [[-111.03, 41],[-111.04, 45],[-104.05, 45],[-104.05, 41]], // outer ring
     *     [[-108.58,37.29],[-108.58,40.71],[-102.50,40.71],[-102.50,37.29]] // hole
     *   ],
     *   [ // second polygon
     *     [[-109.05, 37],[-109.03, 41],[-102.05, 41],[-102.04, 37],[-109.05, 38]]
     *   ]
     * ];
     * ```
     */

    L.Polygon = L.Polyline.extend({

        options: {
            fill: true
        },

        isEmpty: function () {
            return !this._latlngs.length || !this._latlngs[0].length;
        },

        getCenter: function () {
            var i, j, p1, p2, f, area, x, y, center,
                points = this._rings[0],
                len = points.length;

            if (!len) { return null; }

            // polygon centroid algorithm; only uses the first ring if there are multiple

            area = x = y = 0;

            for (i = 0, j = len - 1; i < len; j = i++) {
                p1 = points[i];
                p2 = points[j];

                f = p1.y * p2.x - p2.y * p1.x;
                x += (p1.x + p2.x) * f;
                y += (p1.y + p2.y) * f;
                area += f * 3;
            }

            if (area === 0) {
                // Polygon is so small that all points are on same pixel.
                center = points[0];
            } else {
                center = [x / area, y / area];
            }
            return this._map.layerPointToLatLng(center);
        },

        _convertLatLngs: function (latlngs) {
            var result = L.Polyline.prototype._convertLatLngs.call(this, latlngs),
                len = result.length;

            // remove last point if it equals first one
            if (len >= 2 && result[0] instanceof L.LatLng && result[0].equals(result[len - 1])) {
                result.pop();
            }
            return result;
        },

        _setLatLngs: function (latlngs) {
            L.Polyline.prototype._setLatLngs.call(this, latlngs);
            if (L.Polyline._flat(this._latlngs)) {
                this._latlngs = [this._latlngs];
            }
        },

        _defaultShape: function () {
            return L.Polyline._flat(this._latlngs[0]) ? this._latlngs[0] : this._latlngs[0][0];
        },

        _clipPoints: function () {
            // polygons need a different clipping algorithm so we redefine that

            var bounds = this._renderer._bounds,
                w = this.options.weight,
                p = new L.Point(w, w);

            // increase clip padding by stroke width to avoid stroke on clip edges
            bounds = new L.Bounds(bounds.min.subtract(p), bounds.max.add(p));

            this._parts = [];
            if (!this._pxBounds || !this._pxBounds.intersects(bounds)) {
                return;
            }

            if (this.options.noClip) {
                this._parts = this._rings;
                return;
            }

            for (var i = 0, len = this._rings.length, clipped; i < len; i++) {
                clipped = L.PolyUtil.clipPolygon(this._rings[i], bounds, true);
                if (clipped.length) {
                    this._parts.push(clipped);
                }
            }
        },

        _updatePath: function () {
            this._renderer._updatePoly(this, true);
        }
    });


// @factory L.polygon(latlngs: LatLng[], options?: Polyline options)
    L.polygon = function (latlngs, options) {
        return new L.Polygon(latlngs, options);
    };



    /*
     * L.Rectangle extends Polygon and creates a rectangle when passed a LatLngBounds object.
     */

    /*
     * @class Rectangle
     * @aka L.Retangle
     * @inherits Polygon
     *
     * A class for drawing rectangle overlays on a map. Extends `Polygon`.
     *
     * @example
     *
     * ```js
     * // define rectangle geographical bounds
     * var bounds = [[54.559322, -5.767822], [56.1210604, -3.021240]];
     *
     * // create an orange rectangle
     * L.rectangle(bounds, {color: "#ff7800", weight: 1}).addTo(map);
     *
     * // zoom the map to the rectangle bounds
     * map.fitBounds(bounds);
     * ```
     *
     */


    L.Rectangle = L.Polygon.extend({
        initialize: function (latLngBounds, options) {
            L.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(latLngBounds), options);
        },

        // @method setBounds(latLngBounds: LatLngBounds): this
        // Redraws the rectangle with the passed bounds.
        setBounds: function (latLngBounds) {
            return this.setLatLngs(this._boundsToLatLngs(latLngBounds));
        },

        _boundsToLatLngs: function (latLngBounds) {
            latLngBounds = L.latLngBounds(latLngBounds);
            return [
                latLngBounds.getSouthWest(),
                latLngBounds.getNorthWest(),
                latLngBounds.getNorthEast(),
                latLngBounds.getSouthEast()
            ];
        }
    });


// @factory L.rectangle(latLngBounds: LatLngBounds, options?: Polyline options)
    L.rectangle = function (latLngBounds, options) {
        return new L.Rectangle(latLngBounds, options);
    };



    /*
     * @class CircleMarker
     * @aka L.CircleMarker
     * @inherits Path
     *
     * A circle of a fixed size with radius specified in pixels. Extends `Path`.
     */

    L.CircleMarker = L.Path.extend({

        options: {
            fill: true,

            // @option radius: Number = 10
            // Radius of the circle marker, in pixels
            radius: 10
        },

        initialize: function (latlng, options, data) {
            L.setOptions(this, options);
            this._latlng = L.latLng(latlng);
            this._radius = this.options.radius;
            this._data = data;
        },

        // @method setLatLng(latLng: LatLng): this
        // Sets the position of a circle marker to a new location.
        setLatLng: function (latlng) {
            this._latlng = L.latLng(latlng);
            this.redraw();
            return this.fire('move', {latlng: this._latlng});
        },

        // @method getLatLng(): LatLng
        // Returns the current geographical position of the circle marker
        getLatLng: function () {
            return this._latlng;
        },

        // @method setRadius(radius: Number): this
        // Sets the radius of a circle marker. Units are in pixels.
        setRadius: function (radius) {
            this.options.radius = this._radius = radius;
            return this.redraw();
        },

        // @method getRadius(): Number
        // Returns the current radius of the circle
        getRadius: function () {
            return this._radius;
        },

        setStyle:function(options){
            var radius = options && options.radius || this._radius;
            L.Path.prototype.setStyle.call(this, options);

            this.options.radius = this._radius = radius;

            if(this._data && this._data.series && this._data.series.animation && this._path){

                this._project();

                var layer = this, p = layer._point, r = layer._radius,
                    r2 = layer._radiusY || r,
                    arc = 'a' + r + ',' + r2 + ' 0 1,0 ';

                // drawing a circle with two half-arcs
                var d = layer._empty() ? 'M0 0' :
                'M' + (p.x - r) + ',' + p.y +
                arc + (r * 2) + ',0 ' +
                arc + (-r * 2) + ',0 ';

                d3.select(layer._path)
                    .transition().duration(500).ease('back-out')
                    .attr('d', d);

            }else if (this._map) {
                this._renderer._updatePath(this);
            }

            return this;
        },

        _project: function () {
            this._point = this._map.latLngToLayerPoint(this._latlng);
            this._updateBounds();
        },

        _updateBounds: function () {
            var r = this._radius,
                r2 = this._radiusY || r,
                w = this._clickTolerance(),
                p = [r + w, r2 + w];
            this._pxBounds = new L.Bounds(this._point.subtract(p), this._point.add(p));
        },

        _update: function () {
            if (this._map) {
                this._updatePath();
            }
        },

        _updatePath: function () {
            this._renderer._updateCircle(this);
        },

        _empty: function () {
            return this._radius && !this._renderer._bounds.intersects(this._pxBounds);
        }
    });


// @factory L.circleMarker(latlng: LatLng, options? CircleMarker options)
//
    L.circleMarker = function (latlng, options, data) {
        return new L.CircleMarker(latlng, options, data);
    };



    /*
     * @class Circle
     * @aka L.Circle
     * @inherits CircleMarker
     *
     * A class for drawing circle overlays on a map. Extends `CircleMarker`.
     *
     * It's an approximation and starts to diverge from a real circle closer to poles (due to projection distortion).
     *
     * @example
     *
     * ```js
     * L.circle([50.5, 30.5], 200).addTo(map);
     * ```
     */

    L.Circle = L.CircleMarker.extend({

        initialize: function (latlng, options, legacyOptions) {
            if (typeof options === 'number') {
                // Backwards compatibility with 0.7.x factory (latlng, radius, options?)
                options = L.extend({}, legacyOptions, {radius: options});
            }
            L.setOptions(this, options);
            this._latlng = L.latLng(latlng);

            if (isNaN(this.options.radius)) { throw new Error('Circle radius cannot be NaN'); }

            // @option radius: Number; Radius of the circle, in meters.
            this._mRadius = this.options.radius;
        },

        // @method setRadius(radius: Number): this
        // Sets the radius of a circle. Units are in meters.
        setRadius: function (radius) {
            this._mRadius = radius;
            return this.redraw();
        },

        // @method getRadius(): Number
        // Returns the current radius of a circle. Units are in meters.
        getRadius: function () {
            return this._mRadius;
        },

        // @method getBounds(): LatLngBounds
        // Returns the `LatLngBounds` of the path.
        getBounds: function () {
            var half = [this._radius, this._radiusY || this._radius];

            return new L.LatLngBounds(
                this._map.layerPointToLatLng(this._point.subtract(half)),
                this._map.layerPointToLatLng(this._point.add(half)));
        },

        setStyle: L.Path.prototype.setStyle,

        _project: function () {

            var lng = this._latlng.lng,
                lat = this._latlng.lat,
                map = this._map,
                crs = map.options.crs;

            if (crs.distance === L.CRS.Earth.distance) {
                var d = Math.PI / 180,
                    latR = (this._mRadius / L.CRS.Earth.R) / d,
                    top = map.project([lat + latR, lng]),
                    bottom = map.project([lat - latR, lng]),
                    p = top.add(bottom).divideBy(2),
                    lat2 = map.unproject(p).lat,
                    lngR = Math.acos((Math.cos(latR * d) - Math.sin(lat * d) * Math.sin(lat2 * d)) /
                            (Math.cos(lat * d) * Math.cos(lat2 * d))) / d;

                if (isNaN(lngR) || lngR === 0) {
                    lngR = latR / Math.cos(Math.PI / 180 * lat); // Fallback for edge case, #2425
                }

                this._point = p.subtract(map.getPixelOrigin());
                this._radius = isNaN(lngR) ? 0 : Math.max(Math.round(p.x - map.project([lat2, lng - lngR]).x), 1);
                this._radiusY = Math.max(Math.round(p.y - top.y), 1);

            } else {
                var latlng2 = crs.unproject(crs.project(this._latlng).subtract([this._mRadius, 0]));

                this._point = map.latLngToLayerPoint(this._latlng);
                this._radius = this._point.x - map.latLngToLayerPoint(latlng2).x;
            }

            this._updateBounds();
        }
    });

// @factory L.circle(latlng: LatLng, options?: Path options)
// Instantiates a circle object given a geographical point, and an options object
// which contains the circle radius.
// @alternative
// @factory L.circle(latlng: LatLng, radius: Number, options?: Path options)
// Obsolete way of instantiating a circle, for compatibility with 0.7.x code.
// Do not use in new applications or plugins.
    L.circle = function (latlng, options, legacyOptions) {
        return new L.Circle(latlng, options, legacyOptions);
    };



    /*
     * @class SVG
     * @inherits Renderer
     * @aka L.SVG
     *
     * Allows vector layers to be displayed with [SVG](https://developer.mozilla.org/docs/Web/SVG).
     * Inherits `Renderer`.
     *
     * Due to [technical limitations](http://caniuse.com/#search=svg), SVG is not
     * available in all web browsers, notably Android 2.x and 3.x.
     *
     * Although SVG is not available on IE7 and IE8, these browsers support
     * [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language)
     * (a now deprecated technology), and the SVG renderer will fall back to VML in
     * this case.
     *
     * @example
     *
     * Use SVG by default for all paths in the map:
     *
     * ```js
     * var map = L.map('map', {
     * 	renderer: L.svg();
     * });
     * ```
     *
     * Use a SVG renderer with extra padding for specific vector geometries:
     *
     * ```js
     * var map = L.map('map');
     * var myRenderer = L.svg({ padding: 0.5 });
     * var line = L.polyline( coordinates, { renderer: myRenderer } );
     * var circle = L.circle( center, { renderer: myRenderer } );
     * ```
     */

    L.SVG = L.Renderer.extend({

        getEvents: function () {
            var events = L.Renderer.prototype.getEvents.call(this);
            events.zoomstart = this._onZoomStart;
            return events;
        },

        _initContainer: function () {
            this._container = L.SVG.create('svg');

            // makes it possible to click through svg root; we'll reset it back in individual paths
            // this._container.setAttribute('pointer-events', 'none');

            this._rootGroup = L.SVG.create('g');
            this._container.appendChild(this._rootGroup);
        },

        _onZoomStart: function () {
            // Drag-then-pinch interactions might mess up the center and zoom.
            // In this case, the easiest way to prevent this is re-do the renderer
            //   bounds and padding when the zooming starts.
            this._update();
        },

        _update: function () {
            if (this._map._animatingZoom && this._bounds) { return; }

            L.Renderer.prototype._update.call(this);

            var b = this._bounds,
                size = b.getSize(),
                container = this._container;

            // set size of svg-container if changed
            if (!this._svgSize || !this._svgSize.equals(size)) {
                this._svgSize = size;
                container.setAttribute('width', size.x);
                container.setAttribute('height', size.y);
            }

            // movement: update container viewBox so that we don't have to change coordinates of individual layers
            L.DomUtil.setPosition(container, b.min);
            container.setAttribute('viewBox', [b.min.x, b.min.y, size.x, size.y].join(' '));
        },

        // methods below are called by vector layers implementations

        _initPath: function (layer) {
            var path = layer._path = L.SVG.create('path');

            // @namespace Path
            // @option className: string = null
            // Custom class name set on an element. Only for SVG renderer.
            if (layer.options.className) {
                L.DomUtil.addClass(path, layer.options.className);
            }

            if (layer.options.interactive) {
                L.DomUtil.addClass(path, 'leaflet-interactive');
            }

            this._updateStyle(layer);
        },

        _initGroup:function(layerGroup){
            layerGroup._g = L.SVG.create('g');
        },

        _addGroup:function(layerGroup){
            this._container.appendChild(layerGroup._g);
        },

        _initText:function(layer){
            layer._text = L.SVG.create('text');
            layer._text.style['pointer-events'] = 'none';
        },

        _addText:function(layer){
            var parent = (layer._layerGroup && layer._layerGroup._g) || this._rootGroup;
            parent.appendChild(layer._text);
        },

        _removeText:function(layer){
            L.DomUtil.remove(layer._text);
        },

        _addPath: function (layer) {
            var parent = (layer._layerGroup && layer._layerGroup._g) || this._rootGroup;
            parent.appendChild(layer._path);
            layer.addInteractiveTarget(layer._path);
        },

        _removePath: function (layer) {
            L.DomUtil.remove(layer._path);
            layer.removeInteractiveTarget(layer._path);
        },

        _updatePath: function (layer) {
            layer._project();
            layer._update();
        },

        _updateStyle: function (layer) {
            var path = layer._path,
                options = layer.options;

            if (!path) { return; }

            if (options.stroke) {
                path.setAttribute('stroke', options.color);
                path.setAttribute('stroke-opacity', options.opacity);
                path.setAttribute('stroke-width', options.weight);
                path.setAttribute('stroke-linecap', options.lineCap);
                path.setAttribute('stroke-linejoin', options.lineJoin);

                if (options.dashArray) {
                    path.setAttribute('stroke-dasharray', options.dashArray);
                } else {
                    path.removeAttribute('stroke-dasharray');
                }

                if (options.dashOffset) {
                    path.setAttribute('stroke-dashoffset', options.dashOffset);
                } else {
                    path.removeAttribute('stroke-dashoffset');
                }
            } else {
                path.setAttribute('stroke', 'none');
            }

            if (options.fill) {
                path.setAttribute('fill', options.fillColor || options.color);
                path.setAttribute('fill-opacity', options.fillOpacity);
                path.setAttribute('fill-rule', options.fillRule || 'evenodd');
            } else {
                path.setAttribute('fill', 'none');
            }

            path.setAttribute('filter', options.filter ? options.filter : 'none');
        },

        _updatePoly: function (layer, closed) {
            this._setPath(layer, L.SVG.pointsToPath(layer._parts, closed));
        },

        _updateCircle: function (layer) {
            var p = layer._point,
                r = isNaN(layer._radius) ? 0 : layer._radius,
                r2 = layer._radiusY || r,
                arc = 'a' + r + ',' + r2 + ' 0 1,0 ';

            // drawing a circle with two half-arcs
            var d = layer._empty() ? 'M0 0' :
            'M' + (p.x - r) + ',' + p.y +
            arc + (r * 2) + ',0 ' +
            arc + (-r * 2) + ',0 ';

            this._setPath(layer, d);
        },

        _setPath: function (layer, path) {
            layer._path.setAttribute('d', path);
        },

        // SVG does not have the concept of zIndex so we resort to changing the DOM order of elements
        _bringToFront: function (layer) {
            L.DomUtil.toFront(layer._path);
        },

        _bringToBack: function (layer) {
            L.DomUtil.toBack(layer._path);
        }
    });


// @namespace SVG; @section
// There are several static functions which can be called without instantiating L.SVG:
    L.extend(L.SVG, {
        // @function create(name: String): SVGElement
        // Returns a instance of [SVGElement](https://developer.mozilla.org/docs/Web/API/SVGElement),
        // corresponding to the class name passed. For example, using 'line' will return
        // an instance of [SVGLineElement](https://developer.mozilla.org/docs/Web/API/SVGLineElement).
        create: function (name) {
            return document.createElementNS('http://www.w3.org/2000/svg', name);
        },

        // @function pointsToPath(rings: [], closed: Boolean): String
        // Generates a SVG path string for multiple rings, with each ring turning
        // into "M..L..L.." instructions
        pointsToPath: function (rings, closed) {
            var str = '',
                i, j, len, len2, points, p;

            for (i = 0, len = rings.length; i < len; i++) {
                points = rings[i];

                for (j = 0, len2 = points.length; j < len2; j++) {
                    p = points[j];
                    str += (j ? 'L' : 'M') + p.x + ' ' + p.y;
                }

                // closes the ring for polygons; "x" is VML syntax
                str += closed ? (L.Browser.svg ? 'z' : 'x') : '';
            }

            // SVG complains about empty path strings
            return str || 'M0 0';
        }
    });

// @namespace Browser; @property svg: Boolean
// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).
    L.Browser.svg = !!(document.createElementNS && L.SVG.create('svg').createSVGRect);


// @namespace SVG
// @factory L.svg(options?: SVG options)
// Creates a SVG renderer with the given options.
    L.svg = function (options) {
        return L.Browser.svg || L.Browser.vml ? new L.SVG(options) : null;
    };



    /*
     * Thanks to Dmitry Baranovsky and his Raphael library for inspiration!
     */

    /*
     * @class SVG
     *
     * Although SVG is not available on IE7 and IE8, these browsers support [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language), and the SVG renderer will fall back to VML in this case.
     *
     * VML was deprecated in 2012, which means VML functionality exists only for backwards compatibility
     * with old versions of Internet Explorer.
     */

// @namespace Browser; @property vml: Boolean
// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).
    L.Browser.vml = !L.Browser.svg && (function () {
            try {
                var div = document.createElement('div');
                div.innerHTML = '<v:shape adj="1"/>';

                var shape = div.firstChild;
                shape.style.behavior = 'url(#default#VML)';

                return shape && (typeof shape.adj === 'object');

            } catch (e) {
                return false;
            }
        }());

// redefine some SVG methods to handle VML syntax which is similar but with some differences
    L.SVG.include(!L.Browser.vml ? {} : {

        _initContainer: function () {
            this._container = L.DomUtil.create('div', 'leaflet-vml-container');
            this._container.style.top = '0px';
            this._container.style.left = '0px';
            this._container.style.position = 'absolute';
        },

        _update: function () {
            if (this._map._animatingZoom) { return; }
            L.Renderer.prototype._update.call(this);
        },

        _initGroup:function(layerGroup){
            layerGroup._g = L.SVG.create('group');
            L.DomUtil.addClass(layerGroup._g, 'leaflet-vml-shape ');
            layerGroup._g.coordsize = '1 1';

        },

        _addGroup:function(layerGroup){
            this._container.appendChild(layerGroup._g);
        },

        _initText:function(layer){

        },

        _addText:function(layer){

        },

        _removeText:function(layer){
            L.DomUtil.remove(layer._text);
        },

        _initPath: function (layer) {
            var container = layer._container = L.SVG.create('shape');

            L.DomUtil.addClass(container, 'leaflet-vml-shape ' + (this.options.className || ''));

            container.coordsize = '1 1';

            layer._path = L.SVG.create('path');
            container.appendChild(layer._path);

            this._updateStyle(layer);
        },

        _addPath: function (layer) {
            var parent = (layer._layerGroup && layer._layerGroup._g) || this._container;
            var container = layer._container;
            parent.appendChild(container);

            if (layer.options.interactive) {
                layer.addInteractiveTarget(container);
            }
        },

        _removePath: function (layer) {
            var container = layer._container;
            L.DomUtil.remove(container);
            layer.removeInteractiveTarget(container);
        },

        _updateStyle: function (layer) {
            var stroke = layer._stroke,
                fill = layer._fill,
                options = layer.options,
                container = layer._container;

            container.stroked = !!options.stroke;
            container.filled = !!options.fill;

            if (options.stroke) {
                if (!stroke) {
                    stroke = layer._stroke = L.SVG.create('stroke');
                }
                container.appendChild(stroke);
                stroke.weight = options.weight + 'px';
                stroke.color = options.color;
                stroke.opacity = options.opacity;

                if (options.dashArray) {
                    stroke.dashStyle = L.Util.isArray(options.dashArray) ?
                        options.dashArray.join(' ') :
                        options.dashArray.replace(/( *, *)/g, ' ');
                } else {
                    stroke.dashStyle = '';
                }
                stroke.endcap = options.lineCap.replace('butt', 'flat');
                stroke.joinstyle = options.lineJoin;

            } else if (stroke) {
                container.removeChild(stroke);
                layer._stroke = null;
            }

            if (options.fill) {
                if (!fill) {
                    fill = layer._fill = L.SVG.create('fill');
                }
                container.appendChild(fill);
                fill.color = options.fillColor || options.color;
                fill.opacity = options.fillOpacity;

            } else if (fill) {
                container.removeChild(fill);
                layer._fill = null;
            }
        },

        _updateCircle: function (layer) {
            var p = layer._point.round(),
                r = Math.round(layer._radius),
                r2 = Math.round(layer._radiusY || r);

            this._setPath(layer, layer._empty() ? 'M0 0' :
            'AL ' + p.x + ',' + p.y + ' ' + r + ',' + r2 + ' 0,' + (65535 * 360));
        },

        _setPath: function (layer, path) {
            layer._path.v = path;
        },

        _bringToFront: function (layer) {
            L.DomUtil.toFront(layer._container);
        },

        _bringToBack: function (layer) {
            L.DomUtil.toBack(layer._container);
        }
    });

    if (L.Browser.vml) {
        L.SVG.create = (function () {
            try {
                document.namespaces.add('lvml', 'urn:schemas-microsoft-com:vml');
                return function (name) {
                    return document.createElement('<lvml:' + name + ' class="lvml">');
                };
            } catch (e) {
                return function (name) {
                    return document.createElement('<' + name + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">');
                };
            }
        })();
    }



    /*
     * @class Canvas
     * @inherits Renderer
     * @aka L.Canvas
     *
     * Allows vector layers to be displayed with [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).
     * Inherits `Renderer`.
     *
     * Due to [technical limitations](http://caniuse.com/#search=canvas), Canvas is not
     * available in all web browsers, notably IE8, and overlapping geometries might
     * not display properly in some edge cases.
     *
     * @example
     *
     * Use Canvas by default for all paths in the map:
     *
     * ```js
     * var map = L.map('map', {
     * 	renderer: L.canvas();
     * });
     * ```
     *
     * Use a Canvas renderer with extra padding for specific vector geometries:
     *
     * ```js
     * var map = L.map('map');
     * var myRenderer = L.canvas({ padding: 0.5 });
     * var line = L.polyline( coordinates, { renderer: myRenderer } );
     * var circle = L.circle( center, { renderer: myRenderer } );
     * ```
     */

    L.Canvas = L.Renderer.extend({

        onAdd: function () {
            L.Renderer.prototype.onAdd.call(this);

            this._layers = this._layers || {};

            // Redraw vectors since canvas is cleared upon removal,
            // in case of removing the renderer itself from the map.
            this._draw();
        },

        _initContainer: function () {
            var container = this._container = document.createElement('canvas');

            L.DomEvent
                .on(container, 'mousemove', L.Util.throttle(this._onMouseMove, 32, this), this)
                .on(container, 'click dblclick mousedown mouseup contextmenu', this._onClick, this)
                .on(container, 'mouseout', this._handleMouseOut, this);

            this._ctx = container.getContext('2d');
        },

        _update: function () {
            if (this._map._animatingZoom && this._bounds) { return; }

            this._drawnLayers = {};

            L.Renderer.prototype._update.call(this);

            var b = this._bounds,
                container = this._container,
                size = b.getSize(),
                m = L.Browser.retina ? 2 : 1;

            L.DomUtil.setPosition(container, b.min);

            // set canvas size (also clearing it); use double size on retina
            container.width = m * size.x;
            container.height = m * size.y;
            container.style.width = size.x + 'px';
            container.style.height = size.y + 'px';

            if (L.Browser.retina) {
                this._ctx.scale(2, 2);
            }

            // translate so we use the same path coordinates after canvas element moves
            this._ctx.translate(-b.min.x, -b.min.y);
        },

        _initPath: function (layer) {
            this._updateDashArray(layer);
            this._layers[L.stamp(layer)] = layer;
        },

        _addPath: L.Util.falseFn,

        _removePath: function (layer) {
            layer._removed = true;
            this._requestRedraw(layer);
        },

        _updatePath: function (layer) {
            this._redrawBounds = layer._pxBounds;
            this._draw(true);
            layer._project();
            layer._update();
            this._draw();
            this._redrawBounds = null;
        },

        _updateStyle: function (layer) {
            this._updateDashArray(layer);
            this._requestRedraw(layer);
        },

        _updateDashArray: function (layer) {
            if (layer.options.dashArray) {
                var parts = layer.options.dashArray.split(','),
                    dashArray = [],
                    i;
                for (i = 0; i < parts.length; i++) {
                    dashArray.push(Number(parts[i]));
                }
                layer.options._dashArray = dashArray;
            }
        },

        _requestRedraw: function (layer) {
            if (!this._map) { return; }

            var padding = (layer.options.weight || 0) + 1;
            this._redrawBounds = this._redrawBounds || new L.Bounds();
            this._redrawBounds.extend(layer._pxBounds.min.subtract([padding, padding]));
            this._redrawBounds.extend(layer._pxBounds.max.add([padding, padding]));

            this._redrawRequest = this._redrawRequest || L.Util.requestAnimFrame(this._redraw, this);
        },

        _redraw: function () {
            this._redrawRequest = null;

            this._draw(true); // clear layers in redraw bounds
            this._draw(); // draw layers

            this._redrawBounds = null;
        },

        _draw: function (clear) {
            this._clear = clear;
            var layer, bounds = this._redrawBounds;
            this._ctx.save();
            if (bounds) {
                this._ctx.beginPath();
                this._ctx.rect(bounds.min.x, bounds.min.y, bounds.max.x - bounds.min.x, bounds.max.y - bounds.min.y);
                this._ctx.clip();
            }

            for (var id in this._layers) {
                layer = this._layers[id];
                if (!bounds || layer._pxBounds.intersects(bounds)) {
                    layer._updatePath();
                }
                if (clear && layer._removed) {
                    delete layer._removed;
                    delete this._layers[id];
                }
            }
            this._ctx.restore();  // Restore state before clipping.
        },

        _updatePoly: function (layer, closed) {

            var i, j, len2, p,
                parts = layer._parts,
                len = parts.length,
                ctx = this._ctx;

            if (!len) { return; }

            this._drawnLayers[layer._leaflet_id] = layer;

            ctx.beginPath();

            if (ctx.setLineDash) {
                ctx.setLineDash(layer.options && layer.options._dashArray || []);
            }

            for (i = 0; i < len; i++) {
                for (j = 0, len2 = parts[i].length; j < len2; j++) {
                    p = parts[i][j];
                    ctx[j ? 'lineTo' : 'moveTo'](p.x, p.y);
                }
                if (closed) {
                    ctx.closePath();
                }
            }

            this._fillStroke(ctx, layer);

            // TODO optimization: 1 fill/stroke for all features with equal style instead of 1 for each feature
        },

        _updateCircle: function (layer) {

            if (layer._empty()) { return; }

            var p = layer._point,
                ctx = this._ctx,
                r = layer._radius,
                s = (layer._radiusY || r) / r;

            this._drawnLayers[layer._leaflet_id] = layer;

            if (s !== 1) {
                ctx.save();
                ctx.scale(1, s);
            }

            ctx.beginPath();
            ctx.arc(p.x, p.y / s, r, 0, Math.PI * 2, false);

            if (s !== 1) {
                ctx.restore();
            }

            this._fillStroke(ctx, layer);
        },

        _fillStroke: function (ctx, layer) {
            var clear = this._clear,
                options = layer.options;

            ctx.globalCompositeOperation = clear ? 'destination-out' : 'source-over';

            if (options.fill) {
                ctx.globalAlpha = clear ? 1 : options.fillOpacity;
                ctx.fillStyle = options.fillColor || options.color;
                ctx.fill(options.fillRule || 'evenodd');
            }

            if (options.stroke && options.weight !== 0) {
                ctx.globalAlpha = clear ? 1 : options.opacity;

                // if clearing shape, do it with the previously drawn line width
                layer._prevWeight = ctx.lineWidth = clear ? layer._prevWeight + 1 : options.weight;

                ctx.strokeStyle = options.color;
                ctx.lineCap = options.lineCap;
                ctx.lineJoin = options.lineJoin;
                ctx.stroke();
            }
        },

        // Canvas obviously doesn't have mouse events for individual drawn objects,
        // so we emulate that by calculating what's under the mouse on mousemove/click manually

        _onClick: function (e) {
            var point = this._map.mouseEventToLayerPoint(e), layers = [], layer;

            for (var id in this._layers) {
                layer = this._layers[id];
                if (layer.options.interactive && layer._containsPoint(point)) {
                    L.DomEvent._fakeStop(e);
                    layers.push(layer);
                }
            }
            if (layers.length)  {
                this._fireEvent(layers, e);
            }
        },

        _onMouseMove: function (e) {
            if (!this._map || this._map.dragging.moving() || this._map._animatingZoom) { return; }

            var point = this._map.mouseEventToLayerPoint(e);
            this._handleMouseOut(e, point);
            this._handleMouseHover(e, point);
        },


        _handleMouseOut: function (e, point) {
            var layer = this._hoveredLayer;
            if (layer && (e.type === 'mouseout' || !layer._containsPoint(point))) {
                // if we're leaving the layer, fire mouseout
                L.DomUtil.removeClass(this._container, 'leaflet-interactive');
                this._fireEvent([layer], e, 'mouseout');
                this._hoveredLayer = null;
            }
        },

        _handleMouseHover: function (e, point) {
            var id, layer;

            for (id in this._drawnLayers) {
                layer = this._drawnLayers[id];
                if (layer.options.interactive && layer._containsPoint(point)) {
                    L.DomUtil.addClass(this._container, 'leaflet-interactive'); // change cursor
                    this._fireEvent([layer], e, 'mouseover');
                    this._hoveredLayer = layer;
                }
            }

            if (this._hoveredLayer) {
                this._fireEvent([this._hoveredLayer], e);
            }
        },

        _fireEvent: function (layers, e, type) {
            this._map._fireDOMEvent(e, type || e.type, layers);
        },

        // TODO _bringToFront & _bringToBack, pretty tricky

        _bringToFront: L.Util.falseFn,
        _bringToBack: L.Util.falseFn
    });

// @namespace Browser; @property canvas: Boolean
// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).
    L.Browser.canvas = (function () {
        return !!document.createElement('canvas').getContext;
    }());

// @namespace Canvas
// @factory L.canvas(options?: Canvas options)
// Creates a Canvas renderer with the given options.
    L.canvas = function (options) {
        return L.Browser.canvas ? new L.Canvas(options) : null;
    };

    L.Polyline.prototype._containsPoint = function (p, closed) {
        var i, j, k, len, len2, part,
            w = this._clickTolerance();

        if (!this._pxBounds.contains(p)) { return false; }

        // hit detection for polylines
        for (i = 0, len = this._parts.length; i < len; i++) {
            part = this._parts[i];

            for (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {
                if (!closed && (j === 0)) { continue; }

                if (L.LineUtil.pointToSegmentDistance(p, part[k], part[j]) <= w) {
                    return true;
                }
            }
        }
        return false;
    };

    L.Polygon.prototype._containsPoint = function (p) {
        var inside = false,
            part, p1, p2, i, j, k, len, len2;

        if (!this._pxBounds.contains(p)) { return false; }

        // ray casting algorithm for detecting if point is in polygon
        for (i = 0, len = this._parts.length; i < len; i++) {
            part = this._parts[i];

            for (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {
                p1 = part[j];
                p2 = part[k];

                if (((p1.y > p.y) !== (p2.y > p.y)) && (p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {
                    inside = !inside;
                }
            }
        }

        // also check if it's on polygon stroke
        return inside || L.Polyline.prototype._containsPoint.call(this, p, true);
    };

    L.CircleMarker.prototype._containsPoint = function (p) {
        return p.distanceTo(this._point) <= this._radius + this._clickTolerance();
    };



    /*
     * @class GeoJSON
     * @aka L.GeoJSON
     * @inherits FeatureGroup
     *
     * Represents a GeoJSON object or an array of GeoJSON objects. Allows you to parse
     * GeoJSON data and display it on the map. Extends `FeatureGroup`.
     *
     * @example
     *
     * ```js
     * L.geoJson(data, {
     * 	style: function (feature) {
     * 		return {color: feature.properties.color};
     * 	}
     * }).bindPopup(function (layer) {
     * 	return layer.feature.properties.description;
     * }).addTo(map);
     * ```
     */

    L.GeoJSON = L.FeatureGroup.extend({

        /* @section
         * @aka GeoJSON options
         *
         * @option pointToLayer: Function = *
         * A `Function` defining how GeoJSON points spawn Leaflet layers. It is internally
         * called when data is added, passing the GeoJSON point feature and its `LatLng`.
         * The default is to spawn a default `Marker`:
         * ```js
         * function(geoJsonPoint, latlng) {
         * 	return L.marker(latlng);
         * }
         * ```
         *
         * @option style: Function = *
         * A `Function` defining the `Path options` for styling GeoJSON lines and polygons,
         * called internally when data is added.
         * The default value is to not override any defaults:
         * ```js
         * function (geoJsonFeature) {
         * 	return {}
         * }
         * ```
         *
         * @option onEachFeature: Function = *
         * A `Function` that will be called once for each created `Layer`, after it has
         * been created and styled. Useful for attaching events and popups to features.
         * The default is to do nothing with the newly created layers:
         * ```js
         * function (layer) {}
         * ```
         *
         * @option filter: Function = *
         * A `Function` that will be used to decide whether to show a feature or not.
         * The default is to show all features:
         * ```js
         * function (geoJsonFeature) {
         * 	return true;
         * }
         * ```
         *
         * @option coordsToLatLng: Function = *
         * A `Function` that will be used for converting GeoJSON coordinates to `LatLng`s.
         * The default is the `coordsToLatLng` static method.
         */

        initialize: function (geojson, options) {
            L.setOptions(this, options);

            this._layers = {};

            if (geojson) {
                this.addData(geojson);
            }
        },

        addData: function (geojson) {
            var features = L.Util.isArray(geojson) ? geojson : geojson.features,
                i, len, feature;

            if (features) {
                for (i = 0, len = features.length; i < len; i++) {
                    // only add this if geometry or geometries are set and not null
                    feature = features[i];
                    if (feature.geometries || feature.geometry || feature.features || feature.coordinates) {
                        this.addData(feature);
                    }
                }
                return this;
            }

            var options = this.options;

            if (options.filter && !options.filter(geojson)) { return this; }

            var layer = L.GeoJSON.geometryToLayer(geojson, options);
            if (!layer) {
                return this;
            }
            layer.feature = L.GeoJSON.asFeature(geojson);
            layer._data = layer.feature;

            layer.defaultOptions = layer.options;
            this.resetStyle(layer);

            if (options.onEachFeature) {
                options.onEachFeature(geojson, layer);
            }

            // return this.addLayer(layer);

            //json
            this.addLayer(layer);

            return layer;
        },

        resetStyle: function (layer) {
            // reset any custom styles
            layer.options = L.Util.extend({}, layer.defaultOptions);
            this._setLayerStyle(layer, this.options.style);
            return this;
        },

        setStyle: function (style) {
            return this.eachLayer(function (layer) {
                this._setLayerStyle(layer, style);
            }, this);
        },

        _setLayerStyle: function (layer, style) {
            if (typeof style === 'function') {
                style = style(layer.feature);
            }
            if (layer.setStyle) {
                layer.setStyle(style);
            }
        }
    });

// @section
// There are several static functions which can be called without instantiating L.GeoJSON:
    L.extend(L.GeoJSON, {
        // @function geometryToLayer(featureData: Object, options?: GeoJSON options): Layer
        // Creates a `Layer` from a given GeoJSON feature. Can use a custom
        // [`pointToLayer`](#geojson-pointtolayer) and/or [`coordsToLatLng`](#geojson-coordstolatlng)
        // functions if provided as options.
        geometryToLayer: function (geojson, options) {

            var geometry = geojson.type === 'Feature' ? geojson.geometry : geojson,
                coords = geometry ? geometry.coordinates : null,
                layers = [],
                pointToLayer = options && options.pointToLayer,
                coordsToLatLng = options && options.coordsToLatLng || this.coordsToLatLng,
                latlng, latlngs, i, len;

            if (!coords && !geometry) {
                return null;
            }

            switch (geometry.type) {
                case 'Point':
                    latlng = coordsToLatLng(coords);
                    return pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng);

                case 'MultiPoint':
                    for (i = 0, len = coords.length; i < len; i++) {
                        latlng = coordsToLatLng(coords[i]);
                        layers.push(pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng));
                    }
                    return new L.FeatureGroup(layers);

                case 'LineString':
                case 'MultiLineString':
                    latlngs = this.coordsToLatLngs(coords, geometry.type === 'LineString' ? 0 : 1, coordsToLatLng);
                    return new L.Polyline(latlngs, options);

                case 'Polygon':
                case 'MultiPolygon':
                    latlngs = this.coordsToLatLngs(coords, geometry.type === 'Polygon' ? 1 : 2, coordsToLatLng);
                    return new L.Polygon(latlngs, options);

                case 'GeometryCollection':
                    for (i = 0, len = geometry.geometries.length; i < len; i++) {
                        var layer = this.geometryToLayer({
                            geometry: geometry.geometries[i],
                            type: 'Feature',
                            properties: geojson.properties
                        }, options);

                        if (layer) {
                            layers.push(layer);
                        }
                    }
                    return new L.FeatureGroup(layers);

                default:
                    throw new Error('Invalid GeoJSON object.');
            }
        },

        // @function coordsToLatLng(coords: Array): LatLng
        // Creates a `LatLng` object from an array of 2 numbers (longitude, latitude)
        // or 3 numbers (longitude, latitude, altitude) used in GeoJSON for points.
        coordsToLatLng: function (coords) {
            return new L.LatLng(coords[1], coords[0], coords[2]);
        },

        // @function coordsToLatLngs(coords: Array, levelsDeep?: Number, coordsToLatLng?: Function): Array
        // Creates a multidimensional array of `LatLng`s from a GeoJSON coordinates array.
        // `levelsDeep` specifies the nesting level (0 is for an array of points, 1 for an array of arrays of points, etc., 0 by default).
        // Can use a custom [`coordsToLatLng`](#geojson-coordstolatlng) function.
        coordsToLatLngs: function (coords, levelsDeep, coordsToLatLng) {
            var latlngs = [];

            for (var i = 0, len = coords.length, latlng; i < len; i++) {
                latlng = levelsDeep ?
                    this.coordsToLatLngs(coords[i], levelsDeep - 1, coordsToLatLng) :
                    (coordsToLatLng || this.coordsToLatLng)(coords[i]);

                latlngs.push(latlng);
            }

            return latlngs;
        },

        // @function latLngToCoords(latlng: LatLng): Array
        // Reverse of [`coordsToLatLng`](#geojson-coordstolatlng)
        latLngToCoords: function (latlng) {
            return latlng.alt !== undefined ?
                [latlng.lng, latlng.lat, latlng.alt] :
                [latlng.lng, latlng.lat];
        },

        // @function latLngsToCoords(latlngs: Array, levelsDeep?: Number, closed?: Boolean): Array
        // Reverse of [`coordsToLatLngs`](#geojson-coordstolatlngs)
        // `closed` determines whether the first point should be appended to the end of the array to close the feature, only used when `levelsDeep` is 0. False by default.
        latLngsToCoords: function (latlngs, levelsDeep, closed) {
            var coords = [];

            for (var i = 0, len = latlngs.length; i < len; i++) {
                coords.push(levelsDeep ?
                    L.GeoJSON.latLngsToCoords(latlngs[i], levelsDeep - 1, closed) :
                    L.GeoJSON.latLngToCoords(latlngs[i]));
            }

            if (!levelsDeep && closed) {
                coords.push(coords[0]);
            }

            return coords;
        },

        getFeature: function (layer, newGeometry) {
            return layer.feature ?
                L.extend({}, layer.feature, {geometry: newGeometry}) :
                L.GeoJSON.asFeature(newGeometry);
        },

        // @function asFeature(geojson: Object): Object
        // Normalize GeoJSON geometries/features into GeoJSON features.
        asFeature: function (geojson) {
            if (geojson.type === 'Feature') {
                return geojson;
            }

            return {
                type: 'Feature',
                properties: {},
                geometry: geojson
            };
        }
    });

    var PointToGeoJSON = {
        toGeoJSON: function () {
            return L.GeoJSON.getFeature(this, {
                type: 'Point',
                coordinates: L.GeoJSON.latLngToCoords(this.getLatLng())
            });
        }
    };

    L.Marker.include(PointToGeoJSON);

// @namespace CircleMarker
// @method toGeoJSON(): Object
// Returns a [`GeoJSON`](http://en.wikipedia.org/wiki/GeoJSON) representation of the circle marker (as a GeoJSON `Point` Feature).
    L.Circle.include(PointToGeoJSON);
    L.CircleMarker.include(PointToGeoJSON);


// @namespace Polyline
// @method toGeoJSON(): Object
// Returns a [`GeoJSON`](http://en.wikipedia.org/wiki/GeoJSON) representation of the polyline (as a GeoJSON `LineString` or `MultiLineString` Feature).
    L.Polyline.prototype.toGeoJSON = function () {
        var multi = !L.Polyline._flat(this._latlngs);

        var coords = L.GeoJSON.latLngsToCoords(this._latlngs, multi ? 1 : 0);

        return L.GeoJSON.getFeature(this, {
            type: (multi ? 'Multi' : '') + 'LineString',
            coordinates: coords
        });
    };

// @namespace Polygon
// @method toGeoJSON(): Object
// Returns a [`GeoJSON`](http://en.wikipedia.org/wiki/GeoJSON) representation of the polygon (as a GeoJSON `Polygon` or `MultiPolygon` Feature).
    L.Polygon.prototype.toGeoJSON = function () {
        var holes = !L.Polyline._flat(this._latlngs),
            multi = holes && !L.Polyline._flat(this._latlngs[0]);

        var coords = L.GeoJSON.latLngsToCoords(this._latlngs, multi ? 2 : holes ? 1 : 0, true);

        if (!holes) {
            coords = [coords];
        }

        return L.GeoJSON.getFeature(this, {
            type: (multi ? 'Multi' : '') + 'Polygon',
            coordinates: coords
        });
    };


// @namespace LayerGroup
    L.LayerGroup.include({
        toMultiPoint: function () {
            var coords = [];

            this.eachLayer(function (layer) {
                coords.push(layer.toGeoJSON().geometry.coordinates);
            });

            return L.GeoJSON.getFeature(this, {
                type: 'MultiPoint',
                coordinates: coords
            });
        },

        // @method toGeoJSON(): Object
        // Returns a [`GeoJSON`](http://en.wikipedia.org/wiki/GeoJSON) representation of the layer group (as a GeoJSON `GeometryCollection`).
        toGeoJSON: function () {

            var type = this.feature && this.feature.geometry && this.feature.geometry.type;

            if (type === 'MultiPoint') {
                return this.toMultiPoint();
            }

            var isGeometryCollection = type === 'GeometryCollection',
                jsons = [];

            this.eachLayer(function (layer) {
                if (layer.toGeoJSON) {
                    var json = layer.toGeoJSON();
                    jsons.push(isGeometryCollection ? json.geometry : L.GeoJSON.asFeature(json));
                }
            });

            if (isGeometryCollection) {
                return L.GeoJSON.getFeature(this, {
                    geometries: jsons,
                    type: 'GeometryCollection'
                });
            }

            return {
                type: 'FeatureCollection',
                features: jsons
            };
        }
    });

// @namespace GeoJSON
// @factory L.geoJSON(geojson?: Object, options?: GeoJSON options)
// Creates a GeoJSON layer. Optionally accepts an object in
// [GeoJSON format](http://geojson.org/geojson-spec.html) to display on the map
// (you can alternatively add it later with `addData` method) and an `options` object.
    L.geoJSON = function (geojson, options) {
        return new L.GeoJSON(geojson, options);
    };
// Backward compatibility.
    L.geoJson = L.geoJSON;



    /*
     * @namespace DomEvent
     * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.
     */

// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.



    var eventsKey = '_leaflet_events';

    L.DomEvent = {

        // @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this
        // Adds a listener function (`fn`) to a particular DOM event type of the
        // element `el`. You can optionally specify the context of the listener
        // (object the `this` keyword will point to). You can also pass several
        // space-separated types (e.g. `'click dblclick'`).

        // @alternative
        // @function on(el: HTMLElement, eventMap: Object, context?: Object): this
        // Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`
        on: function (obj, types, fn, context) {

            if (typeof types === 'object') {
                for (var type in types) {
                    this._on(obj, type, types[type], fn);
                }
            } else {
                types = L.Util.splitWords(types);

                for (var i = 0, len = types.length; i < len; i++) {
                    this._on(obj, types[i], fn, context);
                }
            }

            return this;
        },

        // @function off(el: HTMLElement, types: String, fn: Function, context?: Object)
        // Removes a previously added listener function. If no function is specified,
        // it will remove all the listeners of that particular DOM event from the element.
        // Note that if you passed a custom context to on, you must pass the same
        // context to `off` in order to remove the listener.

        // @alternative
        // @function off(el: HTMLElement, types: eventMap: Object, context?: Object): this
        off: function (obj, types, fn, context) {

            if (typeof types === 'object') {
                for (var type in types) {
                    this._off(obj, type, types[type], fn);
                }
            } else {
                types = L.Util.splitWords(types);

                for (var i = 0, len = types.length; i < len; i++) {
                    this._off(obj, types[i], fn, context);
                }
            }

            return this;
        },

        _on: function (obj, type, fn, context) {
            var id = type + L.stamp(fn) + (context ? '_' + L.stamp(context) : '');

            if (obj[eventsKey] && obj[eventsKey][id]) { return this; }

            var handler = function (e) {
                return fn.call(context || obj, e || window.event);
            };

            var originalHandler = handler;

            if (L.Browser.pointer && type.indexOf('touch') === 0) {
                this.addPointerListener(obj, type, handler, id);

            } else if (L.Browser.touch && (type === 'dblclick') && this.addDoubleTapListener) {
                this.addDoubleTapListener(obj, handler, id);

            } else if ('addEventListener' in obj) {

                if (type === 'mousewheel') {
                    obj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);

                } else if ((type === 'mouseenter') || (type === 'mouseleave')) {
                    handler = function (e) {
                        e = e || window.event;
                        if (L.DomEvent._isExternalTarget(obj, e)) {
                            originalHandler(e);
                        }
                    };
                    obj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);

                } else {
                    if (type === 'click' && L.Browser.android) {
                        handler = function (e) {
                            return L.DomEvent._filterClick(e, originalHandler);
                        };
                    }
                    obj.addEventListener(type, handler, false);
                }

            } else if ('attachEvent' in obj) {
                obj.attachEvent('on' + type, handler);
            }

            obj[eventsKey] = obj[eventsKey] || {};
            obj[eventsKey][id] = handler;

            return this;
        },

        _off: function (obj, type, fn, context) {

            var id = type + L.stamp(fn) + (context ? '_' + L.stamp(context) : ''),
                handler = obj[eventsKey] && obj[eventsKey][id];

            if (!handler) { return this; }

            if (L.Browser.pointer && type.indexOf('touch') === 0) {
                this.removePointerListener(obj, type, id);

            } else if (L.Browser.touch && (type === 'dblclick') && this.removeDoubleTapListener) {
                this.removeDoubleTapListener(obj, id);

            } else if ('removeEventListener' in obj) {

                if (type === 'mousewheel') {
                    obj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);

                } else {
                    obj.removeEventListener(
                        type === 'mouseenter' ? 'mouseover' :
                            type === 'mouseleave' ? 'mouseout' : type, handler, false);
                }

            } else if ('detachEvent' in obj) {
                obj.detachEvent('on' + type, handler);
            }

            obj[eventsKey][id] = null;

            return this;
        },

        // @function stopPropagation(ev: DOMEvent): this
        // Stop the given event from propagation to parent elements. Used inside the listener functions:
        // ```js
        // L.DomEvent.on(div, 'click', function (ev) {
        // 	L.DomEvent.stopPropagation(ev);
        // });
        // ```
        stopPropagation: function (e) {

            if (e.stopPropagation) {
                e.stopPropagation();
            } else if (e.originalEvent) {  // In case of Leaflet event.
                e.originalEvent._stopped = true;
            } else {
                e.cancelBubble = true;
            }
            L.DomEvent._skipped(e);

            return this;
        },

        // @function disableScrollPropagation(el: HTMLElement): this
        // Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).
        disableScrollPropagation: function (el) {
            return L.DomEvent.on(el, 'mousewheel', L.DomEvent.stopPropagation);
        },

        // @function disableClickPropagation(el: HTMLElement): this
        // Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,
        // `'mousedown'` and `'touchstart'` events (plus browser variants).
        disableClickPropagation: function (el) {
            var stop = L.DomEvent.stopPropagation;

            L.DomEvent.on(el, L.Draggable.START.join(' '), stop);

            return L.DomEvent.on(el, {
                click: L.DomEvent._fakeStop,
                dblclick: stop
            });
        },

        // @function preventDefault(ev: DOMEvent): this
        // Prevents the default action of the DOM Event `ev` from happening (such as
        // following a link in the href of the a element, or doing a POST request
        // with page reload when a `<form>` is submitted).
        // Use it inside listener functions.
        preventDefault: function (e) {

            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = false;
            }
            return this;
        },

        // @function stop(ev): this
        // Does `stopPropagation` and `preventDefault` at the same time.
        stop: function (e) {
            return L.DomEvent
                .preventDefault(e)
                .stopPropagation(e);
        },

        // @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point
        // Gets normalized mouse position from a DOM event relative to the
        // `container` or to the whole page if not specified.
        getMousePosition: function (e, container) {
            if (!container) {
                return new L.Point(e.clientX, e.clientY);
            }

            var rect = container.getBoundingClientRect();

            return new L.Point(
                e.clientX - rect.left - container.clientLeft,
                e.clientY - rect.top - container.clientTop);
        },

        // @function getWheelDelta(ev: DOMEvent): Number
        // Gets normalized wheel delta from a mousewheel DOM event, in vertical
        // pixels scrolled (negative if scrolling down).
        // Events from pointing devices without precise scrolling are mapped to
        // a best guess of between 50-60 pixels.
        getWheelDelta: function (e) {
            return (e.deltaY && e.deltaMode === 0) ? -e.deltaY :        // Pixels
                (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 18 :   // Lines
                    (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 52 :   // Pages
                        (e.deltaX || e.deltaZ) ? 0 :	// Skip horizontal/depth wheel events
                            e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels
                                (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 18 : // Legacy Moz lines
                                    e.detail ? e.detail / -32765 * 52 : // Legacy Moz pages
                                        0;
        },

        _skipEvents: {},

        _fakeStop: function (e) {
            // fakes stopPropagation by setting a special event flag, checked/reset with L.DomEvent._skipped(e)
            L.DomEvent._skipEvents[e.type] = true;
        },

        _skipped: function (e) {
            var skipped = this._skipEvents[e.type];
            // reset when checking, as it's only used in map container and propagates outside of the map
            this._skipEvents[e.type] = false;
            return skipped;
        },

        // check if element really left/entered the event target (for mouseenter/mouseleave)
        _isExternalTarget: function (el, e) {

            var related = e.relatedTarget;

            if (!related) { return true; }

            try {
                while (related && (related !== el)) {
                    related = related.parentNode;
                }
            } catch (err) {
                return false;
            }
            return (related !== el);
        },

        // this is a horrible workaround for a bug in Android where a single touch triggers two click events
        _filterClick: function (e, handler) {
            var timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),
                elapsed = L.DomEvent._lastClick && (timeStamp - L.DomEvent._lastClick);

            // are they closer together than 500ms yet more than 100ms?
            // Android typically triggers them ~300ms apart while multiple listeners
            // on the same event should be triggered far faster;
            // or check if click is simulated on the element, and if it is, reject any non-simulated events

            if ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {
                L.DomEvent.stop(e);
                return;
            }
            L.DomEvent._lastClick = timeStamp;

            handler(e);
        }
    };

// @function addListener(): this
// Alias to [`L.DomEvent.on`](#domevent-on)
    L.DomEvent.addListener = L.DomEvent.on;

// @function removeListener(): this
// Alias to [`L.DomEvent.off`](#domevent-off)
    L.DomEvent.removeListener = L.DomEvent.off;



    /*
     * @class Draggable
     * @aka L.Draggable
     * @inherits Evented
     *
     * A class for making DOM elements draggable (including touch support).
     * Used internally for map and marker dragging. Only works for elements
     * that were positioned with [`L.DomUtil.setPosition`](#domutil-setposition).
     *
     * @example
     * ```js
     * var draggable = new L.Draggable(elementToDrag);
     * draggable.enable();
     * ```
     */

    L.Draggable = L.Evented.extend({

        options: {
            // @option clickTolerance: Number = 3
            // The max number of pixels a user can shift the mouse pointer during a click
            // for it to be considered a valid click (as opposed to a mouse drag).
            clickTolerance: 3
        },

        statics: {
            START: L.Browser.touch ? ['touchstart', 'mousedown'] : ['mousedown'],
            END: {
                mousedown: 'mouseup',
                touchstart: 'touchend',
                pointerdown: 'touchend',
                MSPointerDown: 'touchend'
            },
            MOVE: {
                mousedown: 'mousemove',
                touchstart: 'touchmove',
                pointerdown: 'touchmove',
                MSPointerDown: 'touchmove'
            }
        },

        // @constructor L.Draggable(el: HTMLElement, dragHandle?: HTMLElement, preventOutline: Boolean)
        // Creates a `Draggable` object for moving `el` when you start dragging the `dragHandle` element (equals `el` itself by default).
        initialize: function (element, dragStartTarget, preventOutline) {
            this._element = element;
            this._dragStartTarget = dragStartTarget || element;
            this._preventOutline = preventOutline;
        },

        // @method enable()
        // Enables the dragging ability
        enable: function () {
            if (this._enabled) { return; }

            L.DomEvent.on(this._dragStartTarget, L.Draggable.START.join(' '), this._onDown, this);

            this._enabled = true;
        },

        // @method disable()
        // Disables the dragging ability
        disable: function () {
            if (!this._enabled) { return; }

            L.DomEvent.off(this._dragStartTarget, L.Draggable.START.join(' '), this._onDown, this);

            this._enabled = false;
            this._moved = false;
        },

        _onDown: function (e) {

            var first = e.touches ? e.touches[0] : e;

            var vanchart = this.map.vanchart;
            if(vanchart && vanchart.components.rangeLegend){
                var rangeLegend = vanchart.components.rangeLegend;
                if(rangeLegend.options.visible){
                    if(VanUtils.containsPoint(rangeLegend.bounds, VanUtils.getMousePos(e, vanchart.dom))){
                        return;
                    }
                }
            }

            // Ignore simulated events, since we handle both touch and
            // mouse explicitly; otherwise we risk getting duplicates of
            // touch events, see #4315.
            if (e._simulated) { return; }

            this._moved = false;

            if (L.DomUtil.hasClass(this._element, 'leaflet-zoom-anim')) { return; }

            if (L.Draggable._dragging || e.shiftKey || ((e.which !== 1) && (e.button !== 1) && !e.touches) || !this._enabled) { return; }
            L.Draggable._dragging = true;  // Prevent dragging multiple objects at once.

            if (this._preventOutline) {
                L.DomUtil.preventOutline(this._element);
            }

            L.DomUtil.disableImageDrag();
            L.DomUtil.disableTextSelection();

            if (this._moving) { return; }

            // @event down: Event
            // Fired when a drag is about to start.
            this.fire('down');

            this._startPoint = new L.Point(first.clientX, first.clientY);
            this._startPos = this._newPos = L.DomUtil.getPosition(this._element);

            L.DomEvent
                .on(document, L.Draggable.MOVE[e.type], this._onMove, this)
                .on(document, L.Draggable.END[e.type], this._onUp, this);
        },

        _onMove: function (e) {
            // Ignore simulated events, since we handle both touch and
            // mouse explicitly; otherwise we risk getting duplicates of
            // touch events, see #4315.
            if (e._simulated) { return; }

            if (e.touches && e.touches.length > 1) {
                this._moved = true;
                return;
            }

            var first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),
                newPoint = new L.Point(first.clientX, first.clientY),
                offset = newPoint.subtract(this._startPoint);

            if (!offset.x && !offset.y) { return; }
            if (Math.abs(offset.x) + Math.abs(offset.y) < this.options.clickTolerance) { return; }

            L.DomEvent.preventDefault(e);

            if (!this._moved) {
                // @event dragstart: Event
                // Fired when a drag starts
                this.fire('dragstart');

                this._moved = true;
                this._startPos = L.DomUtil.getPosition(this._element).subtract(offset);

                L.DomUtil.addClass(document.body, 'leaflet-dragging');

                this._lastTarget = e.target || e.srcElement;
                // IE and Edge do not give the <use> element, so fetch it
                // if necessary
                if ((window.SVGElementInstance) && (this._lastTarget instanceof SVGElementInstance)) {
                    this._lastTarget = this._lastTarget.correspondingUseElement;
                }
                L.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');
            }

            this._newPos = this._startPos.add(offset);
            this._moving = true;

            L.Util.cancelAnimFrame(this._animRequest);
            this._lastEvent = e;
            this._animRequest = L.Util.requestAnimFrame(this._updatePosition, this, true);
        },

        _updatePosition: function () {
            var e = {originalEvent: this._lastEvent};

            // @event predrag: Event
            // Fired continuously during dragging *before* each corresponding
            // update of the element's position.
            this.fire('predrag', e);
            L.DomUtil.setPosition(this._element, this._newPos);

            // @event predrag: Event
            // Fired continuously during dragging.
            this.fire('drag', e);
        },

        _onUp: function (e) {
            // Ignore simulated events, since we handle both touch and
            // mouse explicitly; otherwise we risk getting duplicates of
            // touch events, see #4315.
            if (e._simulated) { return; }

            L.DomUtil.removeClass(document.body, 'leaflet-dragging');

            if (this._lastTarget) {
                L.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');
                this._lastTarget = null;
            }

            for (var i in L.Draggable.MOVE) {
                L.DomEvent
                    .off(document, L.Draggable.MOVE[i], this._onMove, this)
                    .off(document, L.Draggable.END[i], this._onUp, this);
            }

            L.DomUtil.enableImageDrag();
            L.DomUtil.enableTextSelection();

            if (this._moved && this._moving) {
                // ensure drag is not fired after dragend
                L.Util.cancelAnimFrame(this._animRequest);

                // @event dragend: Event
                // Fired when the drag ends.
                this.fire('dragend', {
                    distance: this._newPos.distanceTo(this._startPos)
                });
            }

            this._moving = false;
            L.Draggable._dragging = false;
        }
    });



    /*
     L.Handler is a base class for handler classes that are used internally to inject
     interaction features like dragging to classes like Map and Marker.
     */

// @class Handler
// @aka L.Handler
// Abstract class for map interaction handlers

    L.Handler = L.Class.extend({
        initialize: function (map) {
            this._map = map;
        },

        // @method enable()
        // Enables the handler
        enable: function () {
            if (this._enabled) { return; }

            this._enabled = true;
            this.addHooks();
        },

        // @method disable()
        // Disables the handler
        disable: function () {
            if (!this._enabled) { return; }

            this._enabled = false;
            this.removeHooks();
        },

        // @method enabled(): Boolean
        // Returns `true` if the handler is enabled
        enabled: function () {
            return !!this._enabled;
        }

        // @section Extension methods
        // Classes inheriting from `Handler` must implement the two following methods:
        // @method addHooks()
        // Called when the handler is enabled, should add event hooks.
        // @method removeHooks()
        // Called when the handler is disabled, should remove the event hooks added previously.
    });



    /*
     * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.
     */

// @namespace Map
// @section Interaction Options
    L.Map.mergeOptions({
        // @option dragging: Boolean = true
        // Whether the map be draggable with mouse/touch or not.
        dragging: true,

        // @section Panning Inertia Options
        // @option inertia: Boolean = *
        // If enabled, panning of the map will have an inertia effect where
        // the map builds momentum while dragging and continues moving in
        // the same direction for some time. Feels especially nice on touch
        // devices. Enabled by default unless running on old Android devices.
        inertia: !L.Browser.android23,

        // @option inertiaDeceleration: Number = 3000
        // The rate with which the inertial movement slows down, in pixels/second?.
        inertiaDeceleration: 3400, // px/s^2

        // @option inertiaMaxSpeed: Number = Infinity
        // Max speed of the inertial movement, in pixels/second.
        inertiaMaxSpeed: Infinity, // px/s

        // @option easeLinearity: Number = 0.2
        easeLinearity: 0.2,

        // TODO refactor, move to CRS
        // @option worldCopyJump: Boolean = false
        // With this option enabled, the map tracks when you pan to another "copy"
        // of the world and seamlessly jumps to the original one so that all overlays
        // like markers and vector layers are still visible.
        worldCopyJump: false,

        // @option maxBoundsViscosity: Number = 0.0
        // If `maxBounds` is set, this option will control how solid the bounds
        // are when dragging the map around. The default value of `0.0` allows the
        // user to drag outside the bounds at normal speed, higher values will
        // slow down map dragging outside bounds, and `1.0` makes the bounds fully
        // solid, preventing the user from dragging outside the bounds.
        maxBoundsViscosity: 0.0
    });

    L.Map.Drag = L.Handler.extend({
        addHooks: function () {
            if (!this._draggable) {
                var map = this._map;

                this._draggable = new L.Draggable(map._mapPane, map._container);

                this._draggable.map = map;

                this._draggable.on({
                    down: this._onDown,
                    dragstart: this._onDragStart,
                    drag: this._onDrag,
                    dragend: this._onDragEnd
                }, this);

                this._draggable.on('predrag', this._onPreDragLimit, this);
                if (map.options.worldCopyJump) {
                    this._draggable.on('predrag', this._onPreDragWrap, this);
                    map.on('zoomend', this._onZoomEnd, this);

                    map.whenReady(this._onZoomEnd, this);
                }
            }
            L.DomUtil.addClass(this._map._container, 'leaflet-grab');
            this._draggable.enable();
            this._positions = [];
            this._times = [];
        },

        removeHooks: function () {
            L.DomUtil.removeClass(this._map._container, 'leaflet-grab');
            this._draggable.disable();
        },

        moved: function () {
            return this._draggable && this._draggable._moved;
        },

        moving: function () {
            return this._draggable && this._draggable._moving;
        },

        _onDown: function () {
            this._map._stop();
        },

        _onDragStart: function () {
            var map = this._map;

            if (this._map.options.maxBounds && this._map.options.maxBoundsViscosity) {
                var bounds = L.latLngBounds(this._map.options.maxBounds);

                this._offsetLimit = L.bounds(
                    this._map.latLngToContainerPoint(bounds.getNorthWest()).multiplyBy(-1),
                    this._map.latLngToContainerPoint(bounds.getSouthEast()).multiplyBy(-1)
                        .add(this._map.getSize()));

                this._viscosity = Math.min(1.0, Math.max(0.0, this._map.options.maxBoundsViscosity));
            } else {
                this._offsetLimit = null;
            }

            map
                .fire('movestart')
                .fire('dragstart');

            if (map.options.inertia) {
                this._positions = [];
                this._times = [];
            }
        },

        _onDrag: function (e) {
            if (this._map.options.inertia) {
                var time = this._lastTime = +new Date(),
                    pos = this._lastPos = this._draggable._absPos || this._draggable._newPos;

                this._positions.push(pos);
                this._times.push(time);

                if (time - this._times[0] > 50) {
                    this._positions.shift();
                    this._times.shift();
                }
            }

            this._map
                .fire('move', e)
                .fire('drag', e);
        },

        _onZoomEnd: function () {
            var pxCenter = this._map.getSize().divideBy(2),
                pxWorldCenter = this._map.latLngToLayerPoint([0, 0]);

            this._initialWorldOffset = pxWorldCenter.subtract(pxCenter).x;
            this._worldWidth = this._map.getPixelWorldBounds().getSize().x;
        },

        _viscousLimit: function (value, threshold) {
            return value - (value - threshold) * this._viscosity;
        },

        _onPreDragLimit: function () {
            if (!this._viscosity || !this._offsetLimit) { return; }

            var offset = this._draggable._newPos.subtract(this._draggable._startPos);

            var limit = this._offsetLimit;
            if (offset.x < limit.min.x) { offset.x = this._viscousLimit(offset.x, limit.min.x); }
            if (offset.y < limit.min.y) { offset.y = this._viscousLimit(offset.y, limit.min.y); }
            if (offset.x > limit.max.x) { offset.x = this._viscousLimit(offset.x, limit.max.x); }
            if (offset.y > limit.max.y) { offset.y = this._viscousLimit(offset.y, limit.max.y); }

            this._draggable._newPos = this._draggable._startPos.add(offset);
        },

        _onPreDragWrap: function () {
            // TODO refactor to be able to adjust map pane position after zoom
            var worldWidth = this._worldWidth,
                halfWidth = Math.round(worldWidth / 2),
                dx = this._initialWorldOffset,
                x = this._draggable._newPos.x,
                newX1 = (x - halfWidth + dx) % worldWidth + halfWidth - dx,
                newX2 = (x + halfWidth + dx) % worldWidth - halfWidth - dx,
                newX = Math.abs(newX1 + dx) < Math.abs(newX2 + dx) ? newX1 : newX2;

            this._draggable._absPos = this._draggable._newPos.clone();
            this._draggable._newPos.x = newX;
        },

        _onDragEnd: function (e) {
            var map = this._map,
                options = map.options,

                noInertia = !options.inertia || this._times.length < 2;

            map.fire('dragend', e);

            if (noInertia) {
                map.fire('moveend');

            } else {

                var direction = this._lastPos.subtract(this._positions[0]),
                    duration = (this._lastTime - this._times[0]) / 1000,
                    ease = options.easeLinearity,

                    speedVector = direction.multiplyBy(ease / duration),
                    speed = speedVector.distanceTo([0, 0]),

                    limitedSpeed = Math.min(options.inertiaMaxSpeed, speed),
                    limitedSpeedVector = speedVector.multiplyBy(limitedSpeed / speed),

                    decelerationDuration = limitedSpeed / (options.inertiaDeceleration * ease),
                    offset = limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();

                if (!offset.x && !offset.y) {
                    map.fire('moveend');

                } else {
                    offset = map._limitOffset(offset, map.options.maxBounds);

                    L.Util.requestAnimFrame(function () {
                        map.panBy(offset, {
                            duration: decelerationDuration,
                            easeLinearity: ease,
                            noMoveStart: true,
                            animate: true
                        });
                    });
                }
            }
        }
    });

// @section Handlers
// @property dragging: Handler
// Map dragging handler (by both mouse and touch).
    L.Map.addInitHook('addHandler', 'dragging', L.Map.Drag);



    /*
     * L.Handler.DoubleClickZoom is used to handle double-click zoom on the map, enabled by default.
     */

// @namespace Map
// @section Interaction Options

    L.Map.mergeOptions({
        // @option doubleClickZoom: Boolean = true
        // Whether the map can be zoomed in by double clicking on it and
        // zoomed out by double clicking while holding shift. If passed
        // `'center'`, double-click zoom will zoom to the center of the
        //  view regardless of where the mouse was.
        doubleClickZoom: true
    });

    L.Map.DoubleClickZoom = L.Handler.extend({
        addHooks: function () {
            this._map.on('dblclick', this._onDoubleClick, this);
        },

        removeHooks: function () {
            this._map.off('dblclick', this._onDoubleClick, this);
        },

        _onDoubleClick: function (e) {
            var map = this._map,
                oldZoom = map.getZoom(),
                delta = map.options.zoomDelta,
                zoom = e.originalEvent.shiftKey ? oldZoom - delta : oldZoom + delta;

            if (map.options.doubleClickZoom === 'center') {
                map.setZoom(zoom);
            } else {
                map.setZoomAround(e.containerPoint, zoom);
            }
        }
    });

// @section Handlers
//
// Map properties include interaction handlers that allow you to control
// interaction behavior in runtime, enabling or disabling certain features such
// as dragging or touch zoom (see `Handler` methods). For example:
//
// ```js
// map.doubleClickZoom.disable();
// ```
//
// @property doubleClickZoom: Handler
// Double click zoom handler.
    L.Map.addInitHook('addHandler', 'doubleClickZoom', L.Map.DoubleClickZoom);



    /*
     * L.Handler.ScrollWheelZoom is used by L.Map to enable mouse scroll wheel zoom on the map.
     */

// @namespace Map
// @section Interaction Options
    L.Map.mergeOptions({
        // @section Mousewheel options
        // @option scrollWheelZoom: Boolean = true
        // Whether the map can be zoomed by using the mouse wheel. If passed `'center'`,
        // it will zoom to the center of the view regardless of where the mouse was.
        scrollWheelZoom: true,

        // @option wheelDebounceTime: Number = 40
        // Limits the rate at which a wheel can fire (in milliseconds). By default
        // user can't zoom via wheel more often than once per 40 ms.
        wheelDebounceTime: 40,

        // @option wheelPxPerZoomLevel: Number = 50
        // How many scroll pixels (as reported by [L.DomEvent.getWheelDelta](#domevent-getwheeldelta))
        // mean a change of one full zoom level. Smaller values will make wheel-zooming
        // faster (and vice versa).
        wheelPxPerZoomLevel: 50
    });

    L.Map.ScrollWheelZoom = L.Handler.extend({
        addHooks: function () {
            L.DomEvent.on(this._map._container, 'mousewheel', this._onWheelScroll, this);

            this._delta = 0;
        },

        removeHooks: function () {
            L.DomEvent.off(this._map._container, 'mousewheel', this._onWheelScroll, this);
        },

        _onWheelScroll: function (e) {
            var delta = L.DomEvent.getWheelDelta(e);

            var debounce = this._map.options.wheelDebounceTime;

            this._delta += delta;
            this._lastMousePos = this._map.mouseEventToContainerPoint(e);

            if (!this._startTime) {
                this._startTime = +new Date();
            }

            var left = Math.max(debounce - (+new Date() - this._startTime), 0);

            clearTimeout(this._timer);
            this._timer = setTimeout(L.bind(this._performZoom, this), left);

            L.DomEvent.stop(e);
        },

        _performZoom: function () {
            var map = this._map,
                zoom = map.getZoom(),
                snap = this._map.options.zoomSnap || 0;

            map._stop(); // stop panning and fly animations if any

            // map the delta with a sigmoid function to -4..4 range leaning on -1..1
            var d2 = this._delta / (this._map.options.wheelPxPerZoomLevel * 4),
                d3 = 4 * Math.log(2 / (1 + Math.exp(-Math.abs(d2)))) / Math.LN2,
                d4 = snap ? Math.ceil(d3 / snap) * snap : d3,
                delta = map._limitZoom(zoom + (this._delta > 0 ? d4 : -d4)) - zoom;

            this._delta = 0;
            this._startTime = null;

            if (!delta) { return; }

            if (map.options.scrollWheelZoom === 'center') {
                map.setZoom(zoom + delta);
            } else {
                map.setZoomAround(this._lastMousePos, zoom + delta);
            }
        }
    });

// @section Handlers
// @property scrollWheelZoom: Handler
// Scroll wheel zoom handler.
    L.Map.addInitHook('addHandler', 'scrollWheelZoom', L.Map.ScrollWheelZoom);



    /*
     * Extends the event handling code with double tap support for mobile browsers.
     */

    L.extend(L.DomEvent, {

        _touchstart: L.Browser.msPointer ? 'MSPointerDown' : L.Browser.pointer ? 'pointerdown' : 'touchstart',
        _touchend: L.Browser.msPointer ? 'MSPointerUp' : L.Browser.pointer ? 'pointerup' : 'touchend',

        // inspired by Zepto touch code by Thomas Fuchs
        addDoubleTapListener: function (obj, handler, id) {
            var last, touch,
                doubleTap = false,
                delay = 250;

            function onTouchStart(e) {
                var count;

                if (L.Browser.pointer) {
                    count = L.DomEvent._pointersCount;
                } else {
                    count = e.touches.length;
                }

                if (count > 1) { return; }

                var now = Date.now(),
                    delta = now - (last || now);

                touch = e.touches ? e.touches[0] : e;
                doubleTap = (delta > 0 && delta <= delay);
                last = now;
            }

            function onTouchEnd() {
                if (doubleTap && !touch.cancelBubble) {
                    if (L.Browser.pointer) {
                        // work around .type being readonly with MSPointer* events
                        var newTouch = {},
                            prop, i;

                        for (i in touch) {
                            prop = touch[i];
                            newTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;
                        }
                        touch = newTouch;
                    }
                    touch.type = 'dblclick';
                    handler(touch);
                    last = null;
                }
            }

            var pre = '_leaflet_',
                touchstart = this._touchstart,
                touchend = this._touchend;

            obj[pre + touchstart + id] = onTouchStart;
            obj[pre + touchend + id] = onTouchEnd;
            obj[pre + 'dblclick' + id] = handler;

            obj.addEventListener(touchstart, onTouchStart, false);
            obj.addEventListener(touchend, onTouchEnd, false);

            // On some platforms (notably, chrome on win10 + touchscreen + mouse),
            // the browser doesn't fire touchend/pointerup events but does fire
            // native dblclicks. See #4127.
            if (!L.Browser.edge) {
                obj.addEventListener('dblclick', handler, false);
            }

            return this;
        },

        removeDoubleTapListener: function (obj, id) {
            var pre = '_leaflet_',
                touchstart = obj[pre + this._touchstart + id],
                touchend = obj[pre + this._touchend + id],
                dblclick = obj[pre + 'dblclick' + id];

            obj.removeEventListener(this._touchstart, touchstart, false);
            obj.removeEventListener(this._touchend, touchend, false);
            if (!L.Browser.edge) {
                obj.removeEventListener('dblclick', dblclick, false);
            }

            return this;
        }
    });



    /*
     * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.
     */

    L.extend(L.DomEvent, {

        POINTER_DOWN:   L.Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',
        POINTER_MOVE:   L.Browser.msPointer ? 'MSPointerMove'   : 'pointermove',
        POINTER_UP:     L.Browser.msPointer ? 'MSPointerUp'     : 'pointerup',
        POINTER_CANCEL: L.Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',
        TAG_WHITE_LIST: ['INPUT', 'SELECT', 'OPTION'],

        _pointers: {},
        _pointersCount: 0,

        // Provides a touch events wrapper for (ms)pointer events.
        // ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890

        addPointerListener: function (obj, type, handler, id) {

            if (type === 'touchstart') {
                this._addPointerStart(obj, handler, id);

            } else if (type === 'touchmove') {
                this._addPointerMove(obj, handler, id);

            } else if (type === 'touchend') {
                this._addPointerEnd(obj, handler, id);
            }

            return this;
        },

        removePointerListener: function (obj, type, id) {
            var handler = obj['_leaflet_' + type + id];

            if (type === 'touchstart') {
                obj.removeEventListener(this.POINTER_DOWN, handler, false);

            } else if (type === 'touchmove') {
                obj.removeEventListener(this.POINTER_MOVE, handler, false);

            } else if (type === 'touchend') {
                obj.removeEventListener(this.POINTER_UP, handler, false);
                obj.removeEventListener(this.POINTER_CANCEL, handler, false);
            }

            return this;
        },

        _addPointerStart: function (obj, handler, id) {
            var onDown = L.bind(function (e) {
                if (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {
                    // In IE11, some touch events needs to fire for form controls, or
                    // the controls will stop working. We keep a whitelist of tag names that
                    // need these events. For other target tags, we prevent default on the event.
                    if (this.TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {
                        L.DomEvent.preventDefault(e);
                    } else {
                        return;
                    }
                }

                this._handlePointer(e, handler);
            }, this);

            obj['_leaflet_touchstart' + id] = onDown;
            obj.addEventListener(this.POINTER_DOWN, onDown, false);

            // need to keep track of what pointers and how many are active to provide e.touches emulation
            if (!this._pointerDocListener) {
                var pointerUp = L.bind(this._globalPointerUp, this);

                // we listen documentElement as any drags that end by moving the touch off the screen get fired there
                document.documentElement.addEventListener(this.POINTER_DOWN, L.bind(this._globalPointerDown, this), true);
                document.documentElement.addEventListener(this.POINTER_MOVE, L.bind(this._globalPointerMove, this), true);
                document.documentElement.addEventListener(this.POINTER_UP, pointerUp, true);
                document.documentElement.addEventListener(this.POINTER_CANCEL, pointerUp, true);

                this._pointerDocListener = true;
            }
        },

        _globalPointerDown: function (e) {
            this._pointers[e.pointerId] = e;
            this._pointersCount++;
        },

        _globalPointerMove: function (e) {
            if (this._pointers[e.pointerId]) {
                this._pointers[e.pointerId] = e;
            }
        },

        _globalPointerUp: function (e) {
            delete this._pointers[e.pointerId];
            this._pointersCount--;
        },

        _handlePointer: function (e, handler) {
            e.touches = [];
            for (var i in this._pointers) {
                e.touches.push(this._pointers[i]);
            }
            e.changedTouches = [e];

            handler(e);
        },

        _addPointerMove: function (obj, handler, id) {
            var onMove = L.bind(function (e) {
                // don't fire touch moves when mouse isn't down
                if ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }

                this._handlePointer(e, handler);
            }, this);

            obj['_leaflet_touchmove' + id] = onMove;
            obj.addEventListener(this.POINTER_MOVE, onMove, false);
        },

        _addPointerEnd: function (obj, handler, id) {
            var onUp = L.bind(function (e) {
                this._handlePointer(e, handler);
            }, this);

            obj['_leaflet_touchend' + id] = onUp;
            obj.addEventListener(this.POINTER_UP, onUp, false);
            obj.addEventListener(this.POINTER_CANCEL, onUp, false);
        }
    });



    /*
     * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.
     */

// @namespace Map
// @section Interaction Options
    L.Map.mergeOptions({
        // @section Touch interaction options
        // @option touchZoom: Boolean = *
        // Whether the map can be zoomed by touch-dragging with two fingers. If
        // passed `'center'`, it will zoom to the center of the view regardless of
        // where the touch events (fingers) were. Enabled for touch-capable web
        // browsers except for old Androids.
        touchZoom: L.Browser.touch && !L.Browser.android23,

        // @option bounceAtZoomLimits: Boolean = true
        // Set it to false if you don't want the map to zoom beyond min/max zoom
        // and then bounce back when pinch-zooming.
        bounceAtZoomLimits: true
    });

    L.Map.TouchZoom = L.Handler.extend({
        addHooks: function () {
            L.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);
        },

        removeHooks: function () {
            L.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);
        },

        _onTouchStart: function (e) {
            var map = this._map;
            if (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming) { return; }

            var p1 = map.mouseEventToContainerPoint(e.touches[0]),
                p2 = map.mouseEventToContainerPoint(e.touches[1]);

            this._centerPoint = map.getSize()._divideBy(2);
            this._startLatLng = map.containerPointToLatLng(this._centerPoint);
            if (map.options.touchZoom !== 'center') {
                this._pinchStartLatLng = map.containerPointToLatLng(p1.add(p2)._divideBy(2));
            }

            this._startDist = p1.distanceTo(p2);
            this._startZoom = map.getZoom();

            this._moved = false;
            this._zooming = true;

            map._stop();

            L.DomEvent
                .on(document, 'touchmove', this._onTouchMove, this)
                .on(document, 'touchend', this._onTouchEnd, this);

            L.DomEvent.preventDefault(e);
        },

        _onTouchMove: function (e) {
            if (!e.touches || e.touches.length !== 2 || !this._zooming) { return; }

            var map = this._map,
                p1 = map.mouseEventToContainerPoint(e.touches[0]),
                p2 = map.mouseEventToContainerPoint(e.touches[1]),
                scale = p1.distanceTo(p2) / this._startDist;


            this._zoom = map.getScaleZoom(scale, this._startZoom);

            if (!map.options.bounceAtZoomLimits && (
                (this._zoom < map.getMinZoom() && scale < 1) ||
                (this._zoom > map.getMaxZoom() && scale > 1))) {
                this._zoom = map._limitZoom(this._zoom);
            }

            if (map.options.touchZoom === 'center') {
                this._center = this._startLatLng;
                if (scale === 1) { return; }
            } else {
                // Get delta from pinch to center, so centerLatLng is delta applied to initial pinchLatLng
                var delta = p1._add(p2)._divideBy(2)._subtract(this._centerPoint);
                if (scale === 1 && delta.x === 0 && delta.y === 0) { return; }
                this._center = map.unproject(map.project(this._pinchStartLatLng, this._zoom).subtract(delta), this._zoom);
            }

            if (!this._moved) {
                map._moveStart(true);
                this._moved = true;
            }

            L.Util.cancelAnimFrame(this._animRequest);

            var moveFn = L.bind(map._move, map, this._center, this._zoom, {pinch: true, round: false});
            this._animRequest = L.Util.requestAnimFrame(moveFn, this, true);

            L.DomEvent.preventDefault(e);
        },

        _onTouchEnd: function () {
            if (!this._moved || !this._zooming) {
                this._zooming = false;
                return;
            }

            this._zooming = false;
            L.Util.cancelAnimFrame(this._animRequest);

            L.DomEvent
                .off(document, 'touchmove', this._onTouchMove)
                .off(document, 'touchend', this._onTouchEnd);

            // Pinch updates GridLayers' levels only when snapZoom is off, so snapZoom becomes noUpdate.
            if (this._map.options.zoomAnimation) {
                this._map._animateZoom(this._center, this._map._limitZoom(this._zoom), true, this._map.options.snapZoom);
            } else {
                this._map._resetView(this._center, this._map._limitZoom(this._zoom));
            }
        }
    });

// @section Handlers
// @property touchZoom: Handler
// Touch zoom handler.
    L.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);



    /*
     * L.Map.Tap is used to enable mobile hacks like quick taps and long hold.
     */

// @namespace Map
// @section Interaction Options
    L.Map.mergeOptions({
        // @section Touch interaction options
        // @option tap: Boolean = true
        // Enables mobile hacks for supporting instant taps (fixing 200ms click
        // delay on iOS/Android) and touch holds (fired as `contextmenu` events).
        tap: true,

        // @option tapTolerance: Number = 15
        // The max number of pixels a user can shift his finger during touch
        // for it to be considered a valid tap.
        tapTolerance: 15
    });

    L.Map.Tap = L.Handler.extend({
        addHooks: function () {
            L.DomEvent.on(this._map._container, 'touchstart', this._onDown, this);
        },

        removeHooks: function () {
            L.DomEvent.off(this._map._container, 'touchstart', this._onDown, this);
        },

        _onDown: function (e) {
            if (!e.touches) { return; }

            L.DomEvent.preventDefault(e);

            this._fireClick = true;

            // don't simulate click or track longpress if more than 1 touch
            if (e.touches.length > 1) {
                this._fireClick = false;
                clearTimeout(this._holdTimeout);
                return;
            }

            var first = e.touches[0],
                el = first.target;

            this._startPos = this._newPos = new L.Point(first.clientX, first.clientY);

            // if touching a link, highlight it
            if (el.tagName && el.tagName.toLowerCase() === 'a') {
                L.DomUtil.addClass(el, 'leaflet-active');
            }

            // simulate long hold but setting a timeout
            this._holdTimeout = setTimeout(L.bind(function () {
                if (this._isTapValid()) {
                    this._fireClick = false;
                    this._onUp();
                    this._simulateEvent('contextmenu', first);
                }
            }, this), 1000);

            this._simulateEvent('mousedown', first);

            L.DomEvent.on(document, {
                touchmove: this._onMove,
                touchend: this._onUp
            }, this);
        },

        _onUp: function (e) {
            clearTimeout(this._holdTimeout);

            L.DomEvent.off(document, {
                touchmove: this._onMove,
                touchend: this._onUp
            }, this);

            if (this._fireClick && e && e.changedTouches) {

                var first = e.changedTouches[0],
                    el = first.target;

                if (el && el.tagName && el.tagName.toLowerCase() === 'a') {
                    L.DomUtil.removeClass(el, 'leaflet-active');
                }

                this._simulateEvent('mouseup', first);

                // simulate click if the touch didn't move too much
                if (this._isTapValid()) {
                    this._simulateEvent('click', first);
                }
            }
        },

        _isTapValid: function () {
            return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance;
        },

        _onMove: function (e) {
            var first = e.touches[0];
            this._newPos = new L.Point(first.clientX, first.clientY);
            this._simulateEvent('mousemove', first);
        },

        _simulateEvent: function (type, e) {
            var simulatedEvent = document.createEvent('MouseEvents');

            simulatedEvent._simulated = true;
            e.target._simulatedClick = true;

            simulatedEvent.initMouseEvent(
                type, true, true, window, 1,
                e.screenX, e.screenY,
                e.clientX, e.clientY,
                false, false, false, false, 0, null);

            e.target.dispatchEvent(simulatedEvent);
        }
    });

// @section Handlers
// @property tap: Handler
// Mobile touch hacks (quick tap and touch hold) handler.
    if (L.Browser.touch && !L.Browser.pointer) {
        L.Map.addInitHook('addHandler', 'tap', L.Map.Tap);
    }



    /*
     * L.Handler.BoxZoom is used to add shift-drag zoom interaction to the map
     * (zoom to a selected bounding box), enabled by default.
     */

// @namespace Map
// @section Interaction Options
    L.Map.mergeOptions({
        // @option boxZoom: Boolean = true
        // Whether the map can be zoomed to a rectangular area specified by
        // dragging the mouse while pressing the shift key.
        boxZoom: true
    });

    L.Map.BoxZoom = L.Handler.extend({
        initialize: function (map) {
            this._map = map;
            this._container = map._container;
            this._pane = map._panes.overlayPane;
        },

        addHooks: function () {
            L.DomEvent.on(this._container, 'mousedown', this._onMouseDown, this);
        },

        removeHooks: function () {
            L.DomEvent.off(this._container, 'mousedown', this._onMouseDown, this);
        },

        moved: function () {
            return this._moved;
        },

        _resetState: function () {
            this._moved = false;
        },

        _onMouseDown: function (e) {
            if (!e.shiftKey || ((e.which !== 1) && (e.button !== 1))) { return false; }

            this._resetState();

            L.DomUtil.disableTextSelection();
            L.DomUtil.disableImageDrag();

            this._startPoint = this._map.mouseEventToContainerPoint(e);

            L.DomEvent.on(document, {
                contextmenu: L.DomEvent.stop,
                mousemove: this._onMouseMove,
                mouseup: this._onMouseUp,
                keydown: this._onKeyDown
            }, this);
        },

        _onMouseMove: function (e) {
            if (!this._moved) {
                this._moved = true;

                this._box = L.DomUtil.create('div', 'leaflet-zoom-box', this._container);
                L.DomUtil.addClass(this._container, 'leaflet-crosshair');

                this._map.fire('boxzoomstart');
            }

            this._point = this._map.mouseEventToContainerPoint(e);

            var bounds = new L.Bounds(this._point, this._startPoint),
                size = bounds.getSize();

            L.DomUtil.setPosition(this._box, bounds.min);

            this._box.style.width  = size.x + 'px';
            this._box.style.height = size.y + 'px';
        },

        _finish: function () {
            if (this._moved) {
                L.DomUtil.remove(this._box);
                L.DomUtil.removeClass(this._container, 'leaflet-crosshair');
            }

            L.DomUtil.enableTextSelection();
            L.DomUtil.enableImageDrag();

            L.DomEvent.off(document, {
                contextmenu: L.DomEvent.stop,
                mousemove: this._onMouseMove,
                mouseup: this._onMouseUp,
                keydown: this._onKeyDown
            }, this);
        },

        _onMouseUp: function (e) {
            if ((e.which !== 1) && (e.button !== 1)) { return; }

            this._finish();

            if (!this._moved) { return; }
            // Postpone to next JS tick so internal click event handling
            // still see it as "moved".
            setTimeout(L.bind(this._resetState, this), 0);

            var bounds = new L.LatLngBounds(
                this._map.containerPointToLatLng(this._startPoint),
                this._map.containerPointToLatLng(this._point));

            this._map
                .fitBounds(bounds)
                .fire('boxzoomend', {boxZoomBounds: bounds});
        },

        _onKeyDown: function (e) {
            if (e.keyCode === 27) {
                this._finish();
            }
        }
    });

// @section Handlers
// @property boxZoom: Handler
// Box (shift-drag with mouse) zoom handler.
    L.Map.addInitHook('addHandler', 'boxZoom', L.Map.BoxZoom);



    /*
     * L.Map.Keyboard is handling keyboard interaction with the map, enabled by default.
     */

// @namespace Map
// @section Keyboard Navigation Options
    L.Map.mergeOptions({
        // @option keyboard: Boolean = true
        // Makes the map focusable and allows users to navigate the map with keyboard
        // arrows and `+`/`-` keys.
        keyboard: true,

        // @option keyboardPanDelta: Number = 80
        // Amount of pixels to pan when pressing an arrow key.
        keyboardPanDelta: 80
    });

    L.Map.Keyboard = L.Handler.extend({

        keyCodes: {
            left:    [37],
            right:   [39],
            down:    [40],
            up:      [38],
            zoomIn:  [187, 107, 61, 171],
            zoomOut: [189, 109, 54, 173]
        },

        initialize: function (map) {
            this._map = map;

            this._setPanDelta(map.options.keyboardPanDelta);
            this._setZoomDelta(map.options.zoomDelta);
        },

        addHooks: function () {
            var container = this._map._container;

            // make the container focusable by tabbing
            if (container.tabIndex <= 0) {
                container.tabIndex = '0';
            }

            L.DomEvent.on(container, {
                focus: this._onFocus,
                blur: this._onBlur,
                mousedown: this._onMouseDown
            }, this);

            this._map.on({
                focus: this._addHooks,
                blur: this._removeHooks
            }, this);
        },

        removeHooks: function () {
            this._removeHooks();

            L.DomEvent.off(this._map._container, {
                focus: this._onFocus,
                blur: this._onBlur,
                mousedown: this._onMouseDown
            }, this);

            this._map.off({
                focus: this._addHooks,
                blur: this._removeHooks
            }, this);
        },

        _onMouseDown: function () {
            if (this._focused) { return; }

            var body = document.body,
                docEl = document.documentElement,
                top = body.scrollTop || docEl.scrollTop,
                left = body.scrollLeft || docEl.scrollLeft;

            this._map._container.focus();

            window.scrollTo(left, top);
        },

        _onFocus: function () {
            this._focused = true;
            this._map.fire('focus');
        },

        _onBlur: function () {
            this._focused = false;
            this._map.fire('blur');
        },

        _setPanDelta: function (panDelta) {
            var keys = this._panKeys = {},
                codes = this.keyCodes,
                i, len;

            for (i = 0, len = codes.left.length; i < len; i++) {
                keys[codes.left[i]] = [-1 * panDelta, 0];
            }
            for (i = 0, len = codes.right.length; i < len; i++) {
                keys[codes.right[i]] = [panDelta, 0];
            }
            for (i = 0, len = codes.down.length; i < len; i++) {
                keys[codes.down[i]] = [0, panDelta];
            }
            for (i = 0, len = codes.up.length; i < len; i++) {
                keys[codes.up[i]] = [0, -1 * panDelta];
            }
        },

        _setZoomDelta: function (zoomDelta) {
            var keys = this._zoomKeys = {},
                codes = this.keyCodes,
                i, len;

            for (i = 0, len = codes.zoomIn.length; i < len; i++) {
                keys[codes.zoomIn[i]] = zoomDelta;
            }
            for (i = 0, len = codes.zoomOut.length; i < len; i++) {
                keys[codes.zoomOut[i]] = -zoomDelta;
            }
        },

        _addHooks: function () {
            L.DomEvent.on(document, 'keydown', this._onKeyDown, this);
        },

        _removeHooks: function () {
            L.DomEvent.off(document, 'keydown', this._onKeyDown, this);
        },

        _onKeyDown: function (e) {
            if (e.altKey || e.ctrlKey || e.metaKey) { return; }

            var key = e.keyCode,
                map = this._map,
                offset;

            if (key in this._panKeys) {

                if (map._panAnim && map._panAnim._inProgress) { return; }

                offset = this._panKeys[key];
                if (e.shiftKey) {
                    offset = L.point(offset).multiplyBy(3);
                }

                map.panBy(offset);

                if (map.options.maxBounds) {
                    map.panInsideBounds(map.options.maxBounds);
                }

            } else if (key in this._zoomKeys) {
                map.setZoom(map.getZoom() + (e.shiftKey ? 3 : 1) * this._zoomKeys[key]);

            } else if (key === 27) {
                map.closePopup();

            } else {
                return;
            }

            L.DomEvent.stop(e);
        }
    });

// @section Handlers
// @section Handlers
// @property keyboard: Handler
// Keyboard navigation handler.
    L.Map.addInitHook('addHandler', 'keyboard', L.Map.Keyboard);



    /*
     * L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable.
     */


    /* @namespace Marker
     * @section Interaction handlers
     *
     * Interaction handlers are properties of a marker instance that allow you to control interaction behavior in runtime, enabling or disabling certain features such as dragging (see `Handler` methods). Example:
     *
     * ```js
     * marker.dragging.disable();
     * ```
     *
     * @property dragging: Handler
     * Marker dragging handler (by both mouse and touch).
     */

    L.Handler.MarkerDrag = L.Handler.extend({
        initialize: function (marker) {
            this._marker = marker;
        },

        addHooks: function () {
            var icon = this._marker._icon;

            if (!this._draggable) {
                this._draggable = new L.Draggable(icon, icon, true);
            }

            this._draggable.on({
                dragstart: this._onDragStart,
                drag: this._onDrag,
                dragend: this._onDragEnd
            }, this).enable();

            L.DomUtil.addClass(icon, 'leaflet-marker-draggable');
        },

        removeHooks: function () {
            this._draggable.off({
                dragstart: this._onDragStart,
                drag: this._onDrag,
                dragend: this._onDragEnd
            }, this).disable();

            if (this._marker._icon) {
                L.DomUtil.removeClass(this._marker._icon, 'leaflet-marker-draggable');
            }
        },

        moved: function () {
            return this._draggable && this._draggable._moved;
        },

        _onDragStart: function () {
            // @section Dragging events
            // @event dragstart: Event
            // Fired when the user starts dragging the marker.

            // @event movestart: Event
            // Fired when the marker starts moving (because of dragging).
            this._marker
                .closePopup()
                .fire('movestart')
                .fire('dragstart');
        },

        _onDrag: function (e) {
            var marker = this._marker,
                shadow = marker._shadow,
                iconPos = L.DomUtil.getPosition(marker._icon),
                latlng = marker._map.layerPointToLatLng(iconPos);

            // update shadow position
            if (shadow) {
                L.DomUtil.setPosition(shadow, iconPos);
            }

            marker._latlng = latlng;
            e.latlng = latlng;

            // @event drag: Event
            // Fired repeatedly while the user drags the marker.
            marker
                .fire('move', e)
                .fire('drag', e);
        },

        _onDragEnd: function (e) {
            // @event dragend: DragEndEvent
            // Fired when the user stops dragging the marker.

            // @event moveend: Event
            // Fired when the marker stops moving (because of dragging).
            this._marker
                .fire('moveend')
                .fire('dragend', e);
        }
    });



    /*
     * @class Control
     * @aka L.Control
     *
     * L.Control is a base class for implementing map controls. Handles positioning.
     * All other controls extend from this class.
     */

    L.Control = L.Class.extend({
        // @section
        // @aka Control options
        options: {
            // @option position: String = 'topright'
            // The position of the control (one of the map corners). Possible values are `'topleft'`,
            // `'topright'`, `'bottomleft'` or `'bottomright'`
            position: 'topright'
        },

        initialize: function (options) {
            L.setOptions(this, options);
        },

        /* @section
         * Classes extending L.Control will inherit the following methods:
         *
         * @method getPosition: string
         * Returns the position of the control.
         */
        getPosition: function () {
            return this.options.position;
        },

        // @method setPosition(position: string): this
        // Sets the position of the control.
        setPosition: function (position) {
            var map = this._map;

            if (map) {
                map.removeControl(this);
            }

            this.options.position = position;

            if (map) {
                map.addControl(this);
            }

            return this;
        },

        // @method getContainer: HTMLElement
        // Returns the HTMLElement that contains the control.
        getContainer: function () {
            return this._container;
        },

        // @method addTo(map: Map): this
        // Adds the control to the given map.
        addTo: function (map) {
            this.remove();
            this._map = map;

            var container = this._container = this.onAdd(map),
                pos = this.getPosition(),
                corner = map._controlCorners[pos];

            L.DomUtil.addClass(container, 'leaflet-control');

            if (pos.indexOf('bottom') !== -1) {
                corner.insertBefore(container, corner.firstChild);
            } else {
                corner.appendChild(container);
            }

            return this;
        },

        // @method remove: this
        // Removes the control from the map it is currently active on.
        remove: function () {
            if (!this._map) {
                return this;
            }

            L.DomUtil.remove(this._container);

            if (this.onRemove) {
                this.onRemove(this._map);
            }

            this._map = null;

            return this;
        },

        _refocusOnMap: function (e) {
            // if map exists and event is not a keyboard event
            if (this._map && e && e.screenX > 0 && e.screenY > 0) {
                this._map.getContainer().focus();
            }
        }
    });

    L.control = function (options) {
        return new L.Control(options);
    };


// adds control-related methods to L.Map

    L.Map.include({
        addControl: function (control) {
            control.addTo(this);
            return this;
        },

        removeControl: function (control) {
            control.remove();
            return this;
        },

        _initControlPos: function () {
            var corners = this._controlCorners = {},
                l = 'leaflet-',
                container = this._controlContainer =
                    L.DomUtil.create('div', l + 'control-container', this._container);

            function createCorner(vSide, hSide) {
                var className = l + vSide + ' ' + l + hSide;

                corners[vSide + hSide] = L.DomUtil.create('div', className, container);
            }

            createCorner('top', 'left');
            createCorner('top', 'right');
            createCorner('bottom', 'left');
            createCorner('bottom', 'right');
        },

        _clearControlPos: function () {
            L.DomUtil.remove(this._controlContainer);
        }
    });



    /*
     * @class Control.Zoom
     * @aka L.Control.Zoom
     * @inherits Control
     *
     * A basic zoom control with two buttons (zoom in and zoom out). It is put on the map by default unless you set its [`zoomControl` option](#map-zoomcontrol) to `false`. Extends `Control`.
     */

    L.Control.Zoom = L.Control.extend({
        // @section
        // @aka Control.Zoom options
        options: {
            position: 'topleft',

            // @option zoomInText: String = '+'
            // The text set on the 'zoom in' button.
            zoomInText: '+',

            // @option zoomInTitle: String = 'Zoom in'
            // The title set on the 'zoom in' button.
            zoomInTitle: 'Zoom in',

            // @option zoomOutText: String = '-'
            // The text set on the 'zoom out' button.
            zoomOutText: '-',

            // @option zoomOutTitle: String = 'Zoom out'
            // The title set on the 'zoom out' button.
            zoomOutTitle: 'Zoom out'
        },

        onAdd: function (map) {
            var zoomName = 'leaflet-control-zoom',
                container = L.DomUtil.create('div', zoomName + ' leaflet-bar'),
                options = this.options;

            this._zoomInButton  = this._createButton(options.zoomInText, options.zoomInTitle,
                zoomName + '-in',  container, this._zoomIn);
            this._zoomOutButton = this._createButton(options.zoomOutText, options.zoomOutTitle,
                zoomName + '-out', container, this._zoomOut);

            this._updateDisabled();
            map.on('zoomend zoomlevelschange', this._updateDisabled, this);

            return container;
        },

        onRemove: function (map) {
            map.off('zoomend zoomlevelschange', this._updateDisabled, this);
        },

        disable: function () {
            this._disabled = true;
            this._updateDisabled();
            return this;
        },

        enable: function () {
            this._disabled = false;
            this._updateDisabled();
            return this;
        },

        _zoomIn: function (e) {
            if (!this._disabled) {
                this._map.zoomIn(this._map.options.zoomDelta * (e.shiftKey ? 3 : 1));
            }
        },

        _zoomOut: function (e) {
            if (!this._disabled) {
                this._map.zoomOut(this._map.options.zoomDelta * (e.shiftKey ? 3 : 1));
            }
        },

        _createButton: function (html, title, className, container, fn) {
            var link = L.DomUtil.create('a', className, container);
            link.innerHTML = html;
            link.href = '#';
            link.title = title;

            L.DomEvent
                .on(link, 'mousedown dblclick', L.DomEvent.stopPropagation)
                .on(link, 'click', L.DomEvent.stop)
                .on(link, 'click', fn, this)
                .on(link, 'click', this._refocusOnMap, this);

            return link;
        },

        _updateDisabled: function () {
            var map = this._map,
                className = 'leaflet-disabled';

            L.DomUtil.removeClass(this._zoomInButton, className);
            L.DomUtil.removeClass(this._zoomOutButton, className);

            if (this._disabled || map._zoom === map.getMinZoom()) {
                L.DomUtil.addClass(this._zoomOutButton, className);
            }
            if (this._disabled || map._zoom === map.getMaxZoom()) {
                L.DomUtil.addClass(this._zoomInButton, className);
            }
        }
    });

// @namespace Map
// @section Control options
// @option zoomControl: Boolean = true
// Whether a [zoom control](#control-zoom) is added to the map by default.
    L.Map.mergeOptions({
        zoomControl: true
    });

    L.Map.addInitHook(function () {
        if (this.options.zoomControl) {
            this.zoomControl = new L.Control.Zoom();
            this.addControl(this.zoomControl);
        }
    });

// @namespace Control.Zoom
// @factory L.control.zoom(options: Control.Zoom options)
// Creates a zoom control
    L.control.zoom = function (options) {
        return new L.Control.Zoom(options);
    };



    /*
     * @class Control.Attribution
     * @aka L.Control.Attribution
     * @inherits Control
     *
     * The attribution control allows you to display attribution data in a small text box on a map. It is put on the map by default unless you set its [`attributionControl` option](#map-attributioncontrol) to `false`, and it fetches attribution texts from layers with the [`getAttribution` method](#layer-getattribution) automatically. Extends Control.
     */

    L.Control.Attribution = L.Control.extend({
        // @section
        // @aka Control.Attribution options
        options: {
        },

        initialize: function (options) {
            L.setOptions(this, options);

            this._attributions = {};
        },

        onAdd: function (map) {
            map.attributionControl = this;
            this._container = L.DomUtil.create('div', 'leaflet-control-attribution');
            if (L.DomEvent) {
                L.DomEvent.disableClickPropagation(this._container);
            }

            // TODO ugly, refactor
            for (var i in map._layers) {
                if (map._layers[i].getAttribution) {
                    this.addAttribution(map._layers[i].getAttribution());
                }
            }

            this._update();

            return this._container;
        },

        // @method setPrefix(prefix: String): this
        // Sets the text before the attributions.
        setPrefix: function (prefix) {
            this.options.prefix = prefix;
            this._update();
            return this;
        },

        // @method addAttribution(text: String): this
        // Adds an attribution text (e.g. `'Vector data &copy; Mapbox'`).
        addAttribution: function (text) {
            if (!text) { return this; }

            if (!this._attributions[text]) {
                this._attributions[text] = 0;
            }
            this._attributions[text]++;

            this._update();

            return this;
        },

        // @method removeAttribution(text: String): this
        // Removes an attribution text.
        removeAttribution: function (text) {
            if (!text) { return this; }

            if (this._attributions[text]) {
                this._attributions[text]--;
                this._update();
            }

            return this;
        },

        _update: function () {
            if (!this._map) { return; }

            var attribs = [];

            for (var i in this._attributions) {
                if (this._attributions[i]) {
                    attribs.push(i);
                }
            }

            var prefixAndAttribs = [];

            if (this.options.prefix) {
                prefixAndAttribs.push(this.options.prefix);
            }
            if (attribs.length) {
                prefixAndAttribs.push(attribs.join(', '));
            }

            this._container.innerHTML = prefixAndAttribs.join(' | ');
        }
    });

// @namespace Map
// @section Control options
// @option attributionControl: Boolean = true
// Whether a [attribution control](#control-attribution) is added to the map by default.
    L.Map.mergeOptions({
        attributionControl: true
    });

    L.Map.addInitHook(function () {
        if (this.options.attributionControl) {
            new L.Control.Attribution().addTo(this);
        }
    });

// @namespace Control.Attribution
// @factory L.control.attribution(options: Control.Attribution options)
// Creates an attribution control.
    L.control.attribution = function (options) {
        return new L.Control.Attribution(options);
    };



    /*
     * @class Control.Scale
     * @aka L.Control.Scale
     * @inherits Control
     *
     * A simple scale control that shows the scale of the current center of screen in metric (m/km) and imperial (mi/ft) systems. Extends `Control`.
     *
     * @example
     *
     * ```js
     * L.control.scale().addTo(map);
     * ```
     */

    L.Control.Scale = L.Control.extend({
        // @section
        // @aka Control.Scale options
        options: {
            position: 'bottomleft',

            // @option maxWidth: Number = 100
            // Maximum width of the control in pixels. The width is set dynamically to show round values (e.g. 100, 200, 500).
            maxWidth: 100,

            // @option metric: Boolean = True
            // Whether to show the metric scale line (m/km).
            metric: true,

            // @option imperial: Boolean = True
            // Whether to show the imperial scale line (mi/ft).
            imperial: true

            // @option updateWhenIdle: Boolean = false
            // If `true`, the control is updated on [`moveend`](#map-moveend), otherwise it's always up-to-date (updated on [`move`](#map-move)).
        },

        onAdd: function (map) {
            var className = 'leaflet-control-scale',
                container = L.DomUtil.create('div', className),
                options = this.options;

            this._addScales(options, className + '-line', container);

            map.on(options.updateWhenIdle ? 'moveend' : 'move', this._update, this);
            map.whenReady(this._update, this);

            return container;
        },

        onRemove: function (map) {
            map.off(this.options.updateWhenIdle ? 'moveend' : 'move', this._update, this);
        },

        _addScales: function (options, className, container) {
            if (options.metric) {
                this._mScale = L.DomUtil.create('div', className, container);
            }
            if (options.imperial) {
                this._iScale = L.DomUtil.create('div', className, container);
            }
        },

        _update: function () {
            var map = this._map,
                y = map.getSize().y / 2;

            var maxMeters = map.distance(
                map.containerPointToLatLng([0, y]),
                map.containerPointToLatLng([this.options.maxWidth, y]));

            this._updateScales(maxMeters);
        },

        _updateScales: function (maxMeters) {
            if (this.options.metric && maxMeters) {
                this._updateMetric(maxMeters);
            }
            if (this.options.imperial && maxMeters) {
                this._updateImperial(maxMeters);
            }
        },

        _updateMetric: function (maxMeters) {
            var meters = this._getRoundNum(maxMeters),
                label = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';

            this._updateScale(this._mScale, label, meters / maxMeters);
        },

        _updateImperial: function (maxMeters) {
            var maxFeet = maxMeters * 3.2808399,
                maxMiles, miles, feet;

            if (maxFeet > 5280) {
                maxMiles = maxFeet / 5280;
                miles = this._getRoundNum(maxMiles);
                this._updateScale(this._iScale, miles + ' mi', miles / maxMiles);

            } else {
                feet = this._getRoundNum(maxFeet);
                this._updateScale(this._iScale, feet + ' ft', feet / maxFeet);
            }
        },

        _updateScale: function (scale, text, ratio) {
            scale.style.width = Math.round(this.options.maxWidth * ratio) + 'px';
            scale.innerHTML = text;
        },

        _getRoundNum: function (num) {
            var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1),
                d = num / pow10;

            d = d >= 10 ? 10 :
                d >= 5 ? 5 :
                    d >= 3 ? 3 :
                        d >= 2 ? 2 : 1;

            return pow10 * d;
        }
    });


// @factory L.control.scale(options?: Control.Scale options)
// Creates an scale control with the given options.
    L.control.scale = function (options) {
        return new L.Control.Scale(options);
    };



    /*
     * @class Control.Layers
     * @aka L.Control.Layers
     * @inherits Control
     *
     * The layers control gives users the ability to switch between different base layers and switch overlays on/off (check out the [detailed example](http://leafletjs.com/examples/layers-control.html)). Extends `Control`.
     *
     * @example
     *
     * ```js
     * var baseLayers = {
     * 	"Mapbox": mapbox,
     * 	"OpenStreetMap": osm
     * };
     *
     * var overlays = {
     * 	"Marker": marker,
     * 	"Roads": roadsLayer
     * };
     *
     * L.control.layers(baseLayers, overlays).addTo(map);
     * ```
     *
     * The `baseLayers` and `overlays` parameters are object literals with layer names as keys and `Layer` objects as values:
     *
     * ```js
     * {
     *     "<someName1>": layer1,
     *     "<someName2>": layer2
     * }
     * ```
     *
     * The layer names can contain HTML, which allows you to add additional styling to the items:
     *
     * ```js
     * {"<img src='my-layer-icon' /> <span class='my-layer-item'>My Layer</span>": myLayer}
     * ```
     */


    L.Control.Layers = L.Control.extend({
        // @section
        // @aka Control.Layers options
        options: {
            // @option collapsed: Boolean = true
            // If `true`, the control will be collapsed into an icon and expanded on mouse hover or touch.
            collapsed: true,
            position: 'topright',

            // @option autoZIndex: Boolean = true
            // If `true`, the control will assign zIndexes in increasing order to all of its layers so that the order is preserved when switching them on/off.
            autoZIndex: true,

            // @option hideSingleBase: Boolean = false
            // If `true`, the base layers in the control will be hidden when there is only one.
            hideSingleBase: false
        },

        initialize: function (baseLayers, overlays, options) {
            L.setOptions(this, options);

            this._layers = [];
            this._lastZIndex = 0;
            this._handlingClick = false;

            for (var i in baseLayers) {
                this._addLayer(baseLayers[i], i);
            }

            for (i in overlays) {
                this._addLayer(overlays[i], i, true);
            }
        },

        onAdd: function (map) {
            this._initLayout();
            this._update();

            this._map = map;
            map.on('zoomend', this._checkDisabledLayers, this);

            return this._container;
        },

        onRemove: function () {
            this._map.off('zoomend', this._checkDisabledLayers, this);

            for (var id in this._layers) {
                this._layers[id].layer.off('add remove', this._onLayerChange, this);
            }
        },

        // @method addBaseLayer(layer: Layer, name: String): this
        // Adds a base layer (radio button entry) with the given name to the control.
        addBaseLayer: function (layer, name) {
            this._addLayer(layer, name);
            return (this._map) ? this._update() : this;
        },

        // @method addOverlay(layer: Layer, name: String): this
        // Adds an overlay (checkbox entry) with the given name to the control.
        addOverlay: function (layer, name) {
            this._addLayer(layer, name, true);
            return (this._map) ? this._update() : this;
        },

        // @method removeLayer(layer: Layer): this
        // Remove the given layer from the control.
        removeLayer: function (layer) {
            layer.off('add remove', this._onLayerChange, this);

            var obj = this._getLayer(L.stamp(layer));
            this._layers.splice(this._layers.indexOf(obj), 1);
            return (this._map) ? this._update() : this;
        },

        // @method expand(): this
        // Expand the control container if collapsed.
        expand: function () {
            L.DomUtil.addClass(this._container, 'leaflet-control-layers-expanded');
            this._form.style.height = null;
            var acceptableHeight = this._map.getSize().y - (this._container.offsetTop + 50);
            if (acceptableHeight < this._form.clientHeight) {
                L.DomUtil.addClass(this._form, 'leaflet-control-layers-scrollbar');
                this._form.style.height = acceptableHeight + 'px';
            } else {
                L.DomUtil.removeClass(this._form, 'leaflet-control-layers-scrollbar');
            }
            this._checkDisabledLayers();
            return this;
        },

        // @method collapse(): this
        // Collapse the control container if expanded.
        collapse: function () {
            L.DomUtil.removeClass(this._container, 'leaflet-control-layers-expanded');
            return this;
        },

        _initLayout: function () {
            var className = 'leaflet-control-layers',
                container = this._container = L.DomUtil.create('div', className);

            // makes this work on IE touch devices by stopping it from firing a mouseout event when the touch is released
            container.setAttribute('aria-haspopup', true);

            L.DomEvent.disableClickPropagation(container);
            if (!L.Browser.touch) {
                L.DomEvent.disableScrollPropagation(container);
            }

            var form = this._form = L.DomUtil.create('form', className + '-list');

            if (this.options.collapsed) {
                if (!L.Browser.android) {
                    L.DomEvent.on(container, {
                        mouseenter: this.expand,
                        mouseleave: this.collapse
                    }, this);
                }

                var link = this._layersLink = L.DomUtil.create('a', className + '-toggle', container);
                link.href = '#';
                link.title = 'Layers';

                if (L.Browser.touch) {
                    L.DomEvent
                        .on(link, 'click', L.DomEvent.stop)
                        .on(link, 'click', this.expand, this);
                } else {
                    L.DomEvent.on(link, 'focus', this.expand, this);
                }

                // work around for Firefox Android issue https://github.com/Leaflet/Leaflet/issues/2033
                L.DomEvent.on(form, 'click', function () {
                    setTimeout(L.bind(this._onInputClick, this), 0);
                }, this);

                this._map.on('click', this.collapse, this);
                // TODO keyboard accessibility
            } else {
                this.expand();
            }

            this._baseLayersList = L.DomUtil.create('div', className + '-base', form);
            this._separator = L.DomUtil.create('div', className + '-separator', form);
            this._overlaysList = L.DomUtil.create('div', className + '-overlays', form);

            container.appendChild(form);
        },

        _getLayer: function (id) {
            for (var i = 0; i <= this._layers.length; i++) {
                if (L.stamp(this._layers[i].layer) === id) {
                    return this._layers[i];
                }
            }
        },

        _addLayer: function (layer, name, overlay) {
            layer.on('add remove', this._onLayerChange, this);

            this._layers.push({
                layer: layer,
                name: name,
                overlay: overlay
            });

            if (this.options.autoZIndex && layer.setZIndex) {
                this._lastZIndex++;
                layer.setZIndex(this._lastZIndex);
            }
        },

        _update: function () {
            if (!this._container) { return this; }

            L.DomUtil.empty(this._baseLayersList);
            L.DomUtil.empty(this._overlaysList);

            var baseLayersPresent, overlaysPresent, i, obj, baseLayersCount = 0;

            for (i in this._layers) {
                obj = this._layers[i];
                this._addItem(obj);
                overlaysPresent = overlaysPresent || obj.overlay;
                baseLayersPresent = baseLayersPresent || !obj.overlay;
                baseLayersCount += !obj.overlay ? 1 : 0;
            }

            // Hide base layers section if there's only one layer.
            if (this.options.hideSingleBase) {
                baseLayersPresent = baseLayersPresent && baseLayersCount > 1;
                this._baseLayersList.style.display = baseLayersPresent ? '' : 'none';
            }

            this._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';

            return this;
        },

        _onLayerChange: function (e) {
            if (!this._handlingClick) {
                this._update();
            }

            var obj = this._getLayer(L.stamp(e.target));

            // @namespace Map
            // @section Layer events
            // @event baselayerchange: LayersControlEvent
            // Fired when the base layer is changed through the [layer control](#control-layers).
            // @event overlayadd: LayersControlEvent
            // Fired when an overlay is selected through the [layer control](#control-layers).
            // @event overlayremove: LayersControlEvent
            // Fired when an overlay is deselected through the [layer control](#control-layers).
            // @namespace Control.Layers
            var type = obj.overlay ?
                (e.type === 'add' ? 'overlayadd' : 'overlayremove') :
                (e.type === 'add' ? 'baselayerchange' : null);

            if (type) {
                this._map.fire(type, obj);
            }
        },

        // IE7 bugs out if you create a radio dynamically, so you have to do it this hacky way (see http://bit.ly/PqYLBe)
        _createRadioElement: function (name, checked) {

            var radioHtml = '<input type="radio" class="leaflet-control-layers-selector" name="' +
                name + '"' + (checked ? ' checked="checked"' : '') + '/>';

            var radioFragment = document.createElement('div');
            radioFragment.innerHTML = radioHtml;

            return radioFragment.firstChild;
        },

        _addItem: function (obj) {
            var label = document.createElement('label'),
                checked = this._map.hasLayer(obj.layer),
                input;

            if (obj.overlay) {
                input = document.createElement('input');
                input.type = 'checkbox';
                input.className = 'leaflet-control-layers-selector';
                input.defaultChecked = checked;
            } else {
                input = this._createRadioElement('leaflet-base-layers', checked);
            }

            input.layerId = L.stamp(obj.layer);

            L.DomEvent.on(input, 'click', this._onInputClick, this);

            var name = document.createElement('span');
            name.innerHTML = ' ' + obj.name;

            // Helps from preventing layer control flicker when checkboxes are disabled
            // https://github.com/Leaflet/Leaflet/issues/2771
            var holder = document.createElement('div');

            label.appendChild(holder);
            holder.appendChild(input);
            holder.appendChild(name);

            var container = obj.overlay ? this._overlaysList : this._baseLayersList;
            container.appendChild(label);

            this._checkDisabledLayers();
            return label;
        },

        _onInputClick: function () {
            var inputs = this._form.getElementsByTagName('input'),
                input, layer, hasLayer;
            var addedLayers = [],
                removedLayers = [];

            this._handlingClick = true;

            for (var i = inputs.length - 1; i >= 0; i--) {
                input = inputs[i];
                layer = this._getLayer(input.layerId).layer;
                hasLayer = this._map.hasLayer(layer);

                if (input.checked && !hasLayer) {
                    addedLayers.push(layer);

                } else if (!input.checked && hasLayer) {
                    removedLayers.push(layer);
                }
            }

            // Bugfix issue 2318: Should remove all old layers before readding new ones
            for (i = 0; i < removedLayers.length; i++) {
                this._map.removeLayer(removedLayers[i]);
            }
            for (i = 0; i < addedLayers.length; i++) {
                this._map.addLayer(addedLayers[i]);
            }

            this._handlingClick = false;

            this._refocusOnMap();
        },

        _checkDisabledLayers: function () {
            var inputs = this._form.getElementsByTagName('input'),
                input,
                layer,
                zoom = this._map.getZoom();

            for (var i = inputs.length - 1; i >= 0; i--) {
                input = inputs[i];
                layer = this._getLayer(input.layerId).layer;
                input.disabled = (layer.options.minZoom !== undefined && zoom < layer.options.minZoom) ||
                    (layer.options.maxZoom !== undefined && zoom > layer.options.maxZoom);

            }
        },

        _expand: function () {
            // Backward compatibility, remove me in 1.1.
            return this.expand();
        },

        _collapse: function () {
            // Backward compatibility, remove me in 1.1.
            return this.collapse();
        }

    });


// @factory L.control.layers(baselayers?: Object, overlays?: Object, options?: Control.Layers options)
// Creates an attribution control with the given layers. Base layers will be switched with radio buttons, while overlays will be switched with checkboxes. Note that all base layers should be passed in the base layers object, but only one should be added to the map during map instantiation.
    L.control.layers = function (baseLayers, overlays, options) {
        return new L.Control.Layers(baseLayers, overlays, options);
    };



    /*
     * @class PosAnimation
     * @aka L.PosAnimation
     * @inherits Evented
     * Used internally for panning animations, utilizing CSS3 Transitions for modern browsers and a timer fallback for IE6-9.
     *
     * @example
     * ```js
     * var fx = new L.PosAnimation();
     f x.run(el, [300, 500], 0.5);*
     * ```
     *
     * @constructor L.PosAnimation()
     * Creates a `PosAnimation` object.
     *
     */

    L.PosAnimation = L.Evented.extend({

        // @method run(el: HTMLElement, newPos: Point, duration?: Number, easeLinearity?: Number)
        // Run an animation of a given element to a new position, optionally setting
        // duration in seconds (`0.25` by default) and easing linearity factor (3rd
        // argument of the [cubic bezier curve](http://cubic-bezier.com/#0,0,.5,1),
        // `0.5` by default).
        run: function (el, newPos, duration, easeLinearity) {
            this.stop();

            this._el = el;
            this._inProgress = true;
            this._duration = duration || 0.25;
            this._easeOutPower = 1 / Math.max(easeLinearity || 0.5, 0.2);

            this._startPos = L.DomUtil.getPosition(el);
            this._offset = newPos.subtract(this._startPos);
            this._startTime = +new Date();

            // @event start: Event
            // Fired when the animation starts
            this.fire('start');

            this._animate();
        },

        // @method stop()
        // Stops the animation (if currently running).
        stop: function () {
            if (!this._inProgress) { return; }

            this._step(true);
            this._complete();
        },

        _animate: function () {
            // animation loop
            this._animId = L.Util.requestAnimFrame(this._animate, this);
            this._step();
        },

        _step: function (round) {
            var elapsed = (+new Date()) - this._startTime,
                duration = this._duration * 1000;

            if (elapsed < duration) {
                this._runFrame(this._easeOut(elapsed / duration), round);
            } else {
                this._runFrame(1);
                this._complete();
            }
        },

        _runFrame: function (progress, round) {
            var pos = this._startPos.add(this._offset.multiplyBy(progress));
            if (round) {
                pos._round();
            }
            L.DomUtil.setPosition(this._el, pos);

            // @event step: Event
            // Fired continuously during the animation.
            this.fire('step');
        },

        _complete: function () {
            L.Util.cancelAnimFrame(this._animId);

            this._inProgress = false;
            // @event end: Event
            // Fired when the animation ends.
            this.fire('end');
        },

        _easeOut: function (t) {
            return 1 - Math.pow(1 - t, this._easeOutPower);
        }
    });



    /*
     * Extends L.Map to handle panning animations.
     */

    L.Map.include({

        setView: function (center, zoom, options) {

            zoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);
            center = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);
            options = options || {};

            this._stop();

            if (this._loaded && !options.reset && options !== true) {

                if (options.animate !== undefined) {
                    options.zoom = L.extend({animate: options.animate}, options.zoom);
                    options.pan = L.extend({animate: options.animate, duration: options.duration}, options.pan);
                }

                // try animating pan or zoom
                var moved = (this._zoom !== zoom) ?
                this._tryAnimatedZoom && this._tryAnimatedZoom(center, zoom, options.zoom) :
                    this._tryAnimatedPan(center, options.pan);

                if (moved) {
                    // prevent resize handler call, the view will refresh after animation anyway
                    clearTimeout(this._sizeTimer);
                    return this;
                }
            }

            // animation didn't start, just reset the map view
            this._resetView(center, zoom);

            return this;
        },

        panBy: function (offset, options) {
            offset = L.point(offset).round();
            options = options || {};

            if (!offset.x && !offset.y) {
                return this.fire('moveend');
            }
            // If we pan too far, Chrome gets issues with tiles
            // and makes them disappear or appear in the wrong place (slightly offset) #2602
            if (options.animate !== true && !this.getSize().contains(offset)) {
                this._resetView(this.unproject(this.project(this.getCenter()).add(offset)), this.getZoom());
                return this;
            }

            if (!this._panAnim) {
                this._panAnim = new L.PosAnimation();

                this._panAnim.on({
                    'step': this._onPanTransitionStep,
                    'end': this._onPanTransitionEnd
                }, this);
            }

            // don't fire movestart if animating inertia
            if (!options.noMoveStart) {
                this.fire('movestart');
            }

            // animate pan unless animate: false specified
            if (options.animate !== false) {
                L.DomUtil.addClass(this._mapPane, 'leaflet-pan-anim');

                var newPos = this._getMapPanePos().subtract(offset).round();
                this._panAnim.run(this._mapPane, newPos, options.duration || 0.25, options.easeLinearity);
            } else {
                this._rawPanBy(offset);
                this.fire('move').fire('moveend');
            }

            return this;
        },

        _onPanTransitionStep: function () {
            this.fire('move');
        },

        _onPanTransitionEnd: function () {
            L.DomUtil.removeClass(this._mapPane, 'leaflet-pan-anim');
            this.fire('moveend');
        },

        _tryAnimatedPan: function (center, options) {
            // difference between the new and current centers in pixels
            var offset = this._getCenterOffset(center)._floor();

            // don't animate too far unless animate: true specified in options
            if ((options && options.animate) !== true && !this.getSize().contains(offset)) { return false; }

            this.panBy(offset, options);

            return true;
        }
    });



    /*
     * Extends L.Map to handle zoom animations.
     */

// @namespace Map
// @section Animation Options
    L.Map.mergeOptions({
        // @option zoomAnimation: Boolean = true
        // Whether the map zoom animation is enabled. By default it's enabled
        // in all browsers that support CSS3 Transitions except Android.
        zoomAnimation: true,

        // @option zoomAnimationThreshold: Number = 4
        // Won't animate zoom if the zoom difference exceeds this value.
        zoomAnimationThreshold: 4
    });

    var zoomAnimated = L.DomUtil.TRANSITION && L.Browser.any3d && !L.Browser.mobileOpera;

    if (zoomAnimated) {

        L.Map.addInitHook(function () {
            // don't animate on browsers without hardware-accelerated transitions or old Android/Opera
            this._zoomAnimated = this.options.zoomAnimation;

            // zoom transitions run with the same duration for all layers, so if one of transitionend events
            // happens after starting zoom animation (propagating to the map pane), we know that it ended globally
            if (this._zoomAnimated) {

                this._createAnimProxy();

                L.DomEvent.on(this._proxy, L.DomUtil.TRANSITION_END, this._catchTransitionEnd, this);
            }
        });
    }

    L.Map.include(!zoomAnimated ? {} : {

        _createAnimProxy: function () {

            var proxy = this._proxy = L.DomUtil.create('div', 'leaflet-proxy leaflet-zoom-animated');
            this._panes.mapPane.appendChild(proxy);

            this.on('zoomanim', function (e) {
                var prop = L.DomUtil.TRANSFORM,
                    transform = proxy.style[prop];

                L.DomUtil.setTransform(proxy, this.project(e.center, e.zoom), this.getZoomScale(e.zoom, 1));

                // workaround for case when transform is the same and so transitionend event is not fired
                if (transform === proxy.style[prop] && this._animatingZoom) {
                    this._onZoomTransitionEnd();
                }
            }, this);

            this.on('load moveend', function () {
                var c = this.getCenter(),
                    z = this.getZoom();
                L.DomUtil.setTransform(proxy, this.project(c, z), this.getZoomScale(z, 1));
            }, this);
        },

        _catchTransitionEnd: function (e) {
            if (this._animatingZoom && e.propertyName.indexOf('transform') >= 0) {
                this._onZoomTransitionEnd();
            }
        },

        _nothingToAnimate: function () {
            return !this._container.getElementsByClassName('leaflet-zoom-animated').length;
        },

        _tryAnimatedZoom: function (center, zoom, options) {

            if (this._animatingZoom) { return true; }

            options = options || {};

            // don't animate if disabled, not supported or zoom difference is too large
            if (!this._zoomAnimated || options.animate === false || this._nothingToAnimate() ||
                Math.abs(zoom - this._zoom) > this.options.zoomAnimationThreshold) { return false; }

            // offset is the pixel coords of the zoom origin relative to the current center
            var scale = this.getZoomScale(zoom),
                offset = this._getCenterOffset(center)._divideBy(1 - 1 / scale);

            // don't animate if the zoom origin isn't within one screen from the current center, unless forced
            if (options.animate !== true && !this.getSize().contains(offset)) { return false; }

            L.Util.requestAnimFrame(function () {
                this
                    ._moveStart(true)
                    ._animateZoom(center, zoom, true);
            }, this);

            return true;
        },

        _animateZoom: function (center, zoom, startAnim, noUpdate) {
            if (startAnim) {
                this._animatingZoom = true;

                // remember what center/zoom to set after animation
                this._animateToCenter = center;
                this._animateToZoom = zoom;

                L.DomUtil.addClass(this._mapPane, 'leaflet-zoom-anim');
            }

            // @event zoomanim: ZoomAnimEvent
            // Fired on every frame of a zoom animation
            this.fire('zoomanim', {
                center: center,
                zoom: zoom,
                noUpdate: noUpdate
            });

            // Work around webkit not firing 'transitionend', see https://github.com/Leaflet/Leaflet/issues/3689, 2693
            setTimeout(L.bind(this._onZoomTransitionEnd, this), 250);
        },

        _onZoomTransitionEnd: function () {
            if (!this._animatingZoom) { return; }

            L.DomUtil.removeClass(this._mapPane, 'leaflet-zoom-anim');

            this._animatingZoom = false;

            this._move(this._animateToCenter, this._animateToZoom);

            // This anim frame should prevent an obscure iOS webkit tile loading race condition.
            L.Util.requestAnimFrame(function () {
                this._moveEnd(true);
            }, this);
        }
    });



// @namespace Map
// @section Methods for modifying map state
    L.Map.include({

        // @method flyTo(latlng: LatLng, zoom?: Number, options?: Zoom/Pan options): this
        // Sets the view of the map (geographical center and zoom) performing a smooth
        // pan-zoom animation.
        flyTo: function (targetCenter, targetZoom, options) {

            options = options || {};
            if (options.animate === false || !L.Browser.any3d) {
                return this.setView(targetCenter, targetZoom, options);
            }

            this._stop();

            var from = this.project(this.getCenter()),
                to = this.project(targetCenter),
                size = this.getSize(),
                startZoom = this._zoom;

            targetCenter = L.latLng(targetCenter);
            targetZoom = targetZoom === undefined ? startZoom : targetZoom;

            var w0 = Math.max(size.x, size.y),
                w1 = w0 * this.getZoomScale(startZoom, targetZoom),
                u1 = (to.distanceTo(from)) || 1,
                rho = 1.42,
                rho2 = rho * rho;

            function r(i) {
                var s1 = i ? -1 : 1,
                    s2 = i ? w1 : w0,
                    t1 = w1 * w1 - w0 * w0 + s1 * rho2 * rho2 * u1 * u1,
                    b1 = 2 * s2 * rho2 * u1,
                    b = t1 / b1,
                    sq = Math.sqrt(b * b + 1) - b;

                // workaround for floating point precision bug when sq = 0, log = -Infinite,
                // thus triggering an infinite loop in flyTo
                var log = sq < 0.000000001 ? -18 : Math.log(sq);

                return log;
            }

            function sinh(n) { return (Math.exp(n) - Math.exp(-n)) / 2; }
            function cosh(n) { return (Math.exp(n) + Math.exp(-n)) / 2; }
            function tanh(n) { return sinh(n) / cosh(n); }

            var r0 = r(0);

            function w(s) { return w0 * (cosh(r0) / cosh(r0 + rho * s)); }
            function u(s) { return w0 * (cosh(r0) * tanh(r0 + rho * s) - sinh(r0)) / rho2; }

            function easeOut(t) { return 1 - Math.pow(1 - t, 1.5); }

            var start = Date.now(),
                S = (r(1) - r0) / rho,
                duration = options.duration ? 1000 * options.duration : 1000 * S * 0.8;

            function frame() {
                var t = (Date.now() - start) / duration,
                    s = easeOut(t) * S;

                if (t <= 1) {
                    this._flyToFrame = L.Util.requestAnimFrame(frame, this);

                    this._move(
                        this.unproject(from.add(to.subtract(from).multiplyBy(u(s) / u1)), startZoom),
                        this.getScaleZoom(w0 / w(s), startZoom),
                        {flyTo: true});

                } else {
                    this
                        ._move(targetCenter, targetZoom)
                        ._moveEnd(true);
                }
            }

            this._moveStart(true);

            frame.call(this);
            return this;
        },

        // @method flyToBounds(bounds: LatLngBounds, options?: fitBounds options): this
        // Sets the view of the map with a smooth animation like [`flyTo`](#map-flyto),
        // but takes a bounds parameter like [`fitBounds`](#map-fitbounds).
        flyToBounds: function (bounds, options) {
            var target = this._getBoundsCenterZoom(bounds, options);
            return this.flyTo(target.center, target.zoom, options);
        }
    });



    /*
     * Provides L.Map with convenient shortcuts for using browser geolocation features.
     */

// @namespace Map

    L.Map.include({
        // @section Geolocation methods
        _defaultLocateOptions: {
            timeout: 10000,
            watch: false
            // setView: false
            // maxZoom: <Number>
            // maximumAge: 0
            // enableHighAccuracy: false
        },

        // @method locate(options?: Locate options): this
        // Tries to locate the user using the Geolocation API, firing a `locationfound`
        // event with location data on success or a `locationerror` event on failure,
        // and optionally sets the map view to the user's location with respect to
        // detection accuracy (or to the world view if geolocation failed).
        // See `Locate options` for more details.
        locate: function (options) {

            options = this._locateOptions = L.extend({}, this._defaultLocateOptions, options);

            if (!('geolocation' in navigator)) {
                this._handleGeolocationError({
                    code: 0,
                    message: 'Geolocation not supported.'
                });
                return this;
            }

            var onResponse = L.bind(this._handleGeolocationResponse, this),
                onError = L.bind(this._handleGeolocationError, this);

            if (options.watch) {
                this._locationWatchId =
                    navigator.geolocation.watchPosition(onResponse, onError, options);
            } else {
                navigator.geolocation.getCurrentPosition(onResponse, onError, options);
            }
            return this;
        },

        // @method stopLocate(): this
        // Stops watching location previously initiated by `map.locate({watch: true})`
        // and aborts resetting the map view if map.locate was called with
        // `{setView: true}`.
        stopLocate: function () {
            if (navigator.geolocation && navigator.geolocation.clearWatch) {
                navigator.geolocation.clearWatch(this._locationWatchId);
            }
            if (this._locateOptions) {
                this._locateOptions.setView = false;
            }
            return this;
        },

        _handleGeolocationError: function (error) {
            var c = error.code,
                message = error.message ||
                    (c === 1 ? 'permission denied' :
                        (c === 2 ? 'position unavailable' : 'timeout'));

            if (this._locateOptions.setView && !this._loaded) {
                this.fitWorld();
            }

            // @section Location events
            // @event locationerror: ErrorEvent
            // Fired when geolocation (using the [`locate`](#map-locate) method) failed.
            this.fire('locationerror', {
                code: c,
                message: 'Geolocation error: ' + message + '.'
            });
        },

        _handleGeolocationResponse: function (pos) {
            var lat = pos.coords.latitude,
                lng = pos.coords.longitude,
                latlng = new L.LatLng(lat, lng),
                bounds = latlng.toBounds(pos.coords.accuracy),
                options = this._locateOptions;

            if (options.setView) {
                var zoom = this.getBoundsZoom(bounds);
                this.setView(latlng, options.maxZoom ? Math.min(zoom, options.maxZoom) : zoom);
            }

            var data = {
                latlng: latlng,
                bounds: bounds,
                timestamp: pos.timestamp
            };

            for (var i in pos.coords) {
                if (typeof pos.coords[i] === 'number') {
                    data[i] = pos.coords[i];
                }
            }

            // @event locationfound: LocationEvent
            // Fired when geolocation (using the [`locate`](#map-locate) method)
            // went successfully.
            this.fire('locationfound', data);
        }
    });
}(window, document));
!function() {
    var d3 = {
        version: "3.5.5"
    };
    var d3_arraySlice = [].slice, d3_array = function(list) {
        return d3_arraySlice.call(list);
    };
    var d3_document = this.document;
    function d3_documentElement(node) {
        return node && (node.ownerDocument || node.document || node).documentElement;
    }
    function d3_window(node) {
        return node && (node.ownerDocument && node.ownerDocument.defaultView || node.document && node || node.defaultView);
    }
    if (d3_document) {
        try {
            d3_array(d3_document.documentElement.childNodes)[0].nodeType;
        } catch (e) {
            d3_array = function(list) {
                var i = list.length, array = new Array(i);
                while (i--) array[i] = list[i];
                return array;
            };
        }
    }
    if (!Date.now) Date.now = function() {
        return +new Date();
    };
    if (d3_document) {
        try {
            d3_document.createElement("DIV").style.setProperty("opacity", 0, "");
        } catch (error) {
            var d3_element_prototype = this.Element.prototype, d3_element_setAttribute = d3_element_prototype.setAttribute, d3_element_setAttributeNS = d3_element_prototype.setAttributeNS, d3_style_prototype = this.CSSStyleDeclaration.prototype, d3_style_setProperty = d3_style_prototype.setProperty;
            d3_element_prototype.setAttribute = function(name, value) {
                d3_element_setAttribute.call(this, name, value + "");
            };
            d3_element_prototype.setAttributeNS = function(space, local, value) {
                d3_element_setAttributeNS.call(this, space, local, value + "");
            };
            d3_style_prototype.setProperty = function(name, value, priority) {
                d3_style_setProperty.call(this, name, value + "", priority);
            };
        }
    }
    d3.ascending = d3_ascending;
    function d3_ascending(a, b) {
        return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
    }
    d3.descending = function(a, b) {
        return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;
    };
    d3.min = function(array, f) {
        var i = -1, n = array.length, a, b;
        if (arguments.length === 1) {
            while (++i < n) if ((b = array[i]) != null && b >= b) {
                a = b;
                break;
            }
            while (++i < n) if ((b = array[i]) != null && a > b) a = b;
        } else {
            while (++i < n) if ((b = f.call(array, array[i], i)) != null && b >= b) {
                a = b;
                break;
            }
            while (++i < n) if ((b = f.call(array, array[i], i)) != null && a > b) a = b;
        }
        return a;
    };
    d3.max = function(array, f) {
        var i = -1, n = array.length, a, b;
        if (arguments.length === 1) {
            while (++i < n) if ((b = array[i]) != null && b >= b) {
                a = b;
                break;
            }
            while (++i < n) if ((b = array[i]) != null && b > a) a = b;
        } else {
            while (++i < n) if ((b = f.call(array, array[i], i)) != null && b >= b) {
                a = b;
                break;
            }
            while (++i < n) if ((b = f.call(array, array[i], i)) != null && b > a) a = b;
        }
        return a;
    };
    d3.extent = function(array, f) {
        var i = -1, n = array.length, a, b, c;
        if (arguments.length === 1) {
            while (++i < n) if ((b = array[i]) != null && b >= b) {
                a = c = b;
                break;
            }
            while (++i < n) if ((b = array[i]) != null) {
                if (a > b) a = b;
                if (c < b) c = b;
            }
        } else {
            while (++i < n) if ((b = f.call(array, array[i], i)) != null && b >= b) {
                a = c = b;
                break;
            }
            while (++i < n) if ((b = f.call(array, array[i], i)) != null) {
                if (a > b) a = b;
                if (c < b) c = b;
            }
        }
        return [ a, c ];
    };
    function d3_number(x) {
        return x === null ? NaN : +x;
    }
    function d3_numeric(x) {
        return !isNaN(x);
    }
    d3.sum = function(array, f) {
        var s = 0, n = array.length, a, i = -1;
        if (arguments.length === 1) {
            while (++i < n) if (d3_numeric(a = +array[i])) s += a;
        } else {
            while (++i < n) if (d3_numeric(a = +f.call(array, array[i], i))) s += a;
        }
        return s;
    };
    d3.mean = function(array, f) {
        var s = 0, n = array.length, a, i = -1, j = n;
        if (arguments.length === 1) {
            while (++i < n) if (d3_numeric(a = d3_number(array[i]))) s += a; else --j;
        } else {
            while (++i < n) if (d3_numeric(a = d3_number(f.call(array, array[i], i)))) s += a; else --j;
        }
        if (j) return s / j;
    };
    d3.quantile = function(values, p) {
        var H = (values.length - 1) * p + 1, h = Math.floor(H), v = +values[h - 1], e = H - h;
        return e ? v + e * (values[h] - v) : v;
    };
    d3.median = function(array, f) {
        var numbers = [], n = array.length, a, i = -1;
        if (arguments.length === 1) {
            while (++i < n) if (d3_numeric(a = d3_number(array[i]))) numbers.push(a);
        } else {
            while (++i < n) if (d3_numeric(a = d3_number(f.call(array, array[i], i)))) numbers.push(a);
        }
        if (numbers.length) return d3.quantile(numbers.sort(d3_ascending), .5);
    };
    d3.variance = function(array, f) {
        var n = array.length, m = 0, a, d, s = 0, i = -1, j = 0;
        if (arguments.length === 1) {
            while (++i < n) {
                if (d3_numeric(a = d3_number(array[i]))) {
                    d = a - m;
                    m += d / ++j;
                    s += d * (a - m);
                }
            }
        } else {
            while (++i < n) {
                if (d3_numeric(a = d3_number(f.call(array, array[i], i)))) {
                    d = a - m;
                    m += d / ++j;
                    s += d * (a - m);
                }
            }
        }
        if (j > 1) return s / (j - 1);
    };
    d3.deviation = function() {
        var v = d3.variance.apply(this, arguments);
        return v ? Math.sqrt(v) : v;
    };
    function d3_bisector(compare) {
        return {
            left: function(a, x, lo, hi) {
                if (arguments.length < 3) lo = 0;
                if (arguments.length < 4) hi = a.length;
                while (lo < hi) {
                    var mid = lo + hi >>> 1;
                    if (compare(a[mid], x) < 0) lo = mid + 1; else hi = mid;
                }
                return lo;
            },
            right: function(a, x, lo, hi) {
                if (arguments.length < 3) lo = 0;
                if (arguments.length < 4) hi = a.length;
                while (lo < hi) {
                    var mid = lo + hi >>> 1;
                    if (compare(a[mid], x) > 0) hi = mid; else lo = mid + 1;
                }
                return lo;
            }
        };
    }
    var d3_bisect = d3_bisector(d3_ascending);
    d3.bisectLeft = d3_bisect.left;
    d3.bisect = d3.bisectRight = d3_bisect.right;
    d3.bisector = function(f) {
        return d3_bisector(f.length === 1 ? function(d, x) {
            return d3_ascending(f(d), x);
        } : f);
    };
    d3.shuffle = function(array, i0, i1) {
        if ((m = arguments.length) < 3) {
            i1 = array.length;
            if (m < 2) i0 = 0;
        }
        var m = i1 - i0, t, i;
        while (m) {
            i = Math.random() * m-- | 0;
            t = array[m + i0], array[m + i0] = array[i + i0], array[i + i0] = t;
        }
        return array;
    };
    d3.permute = function(array, indexes) {
        var i = indexes.length, permutes = new Array(i);
        while (i--) permutes[i] = array[indexes[i]];
        return permutes;
    };
    d3.pairs = function(array) {
        var i = 0, n = array.length - 1, p0, p1 = array[0], pairs = new Array(n < 0 ? 0 : n);
        while (i < n) pairs[i] = [ p0 = p1, p1 = array[++i] ];
        return pairs;
    };
    d3.zip = function() {
        if (!(n = arguments.length)) return [];
        for (var i = -1, m = d3.min(arguments, d3_zipLength), zips = new Array(m); ++i < m; ) {
            for (var j = -1, n, zip = zips[i] = new Array(n); ++j < n; ) {
                zip[j] = arguments[j][i];
            }
        }
        return zips;
    };
    function d3_zipLength(d) {
        return d.length;
    }
    d3.transpose = function(matrix) {
        return d3.zip.apply(d3, matrix);
    };
    d3.keys = function(map) {
        var keys = [];
        for (var key in map) keys.push(key);
        return keys;
    };
    d3.values = function(map) {
        var values = [];
        for (var key in map) values.push(map[key]);
        return values;
    };
    d3.entries = function(map) {
        var entries = [];
        for (var key in map) entries.push({
            key: key,
            value: map[key]
        });
        return entries;
    };
    d3.merge = function(arrays) {
        var n = arrays.length, m, i = -1, j = 0, merged, array;
        while (++i < n) j += arrays[i].length;
        merged = new Array(j);
        while (--n >= 0) {
            array = arrays[n];
            m = array.length;
            while (--m >= 0) {
                merged[--j] = array[m];
            }
        }
        return merged;
    };
    var abs = Math.abs;
    d3.range = function(start, stop, step) {
        if (arguments.length < 3) {
            step = 1;
            if (arguments.length < 2) {
                stop = start;
                start = 0;
            }
        }
        if ((stop - start) / step === Infinity) throw new Error("infinite range");
        var range = [], k = d3_range_integerScale(abs(step)), i = -1, j;
        start *= k, stop *= k, step *= k;
        if (step < 0) while ((j = start + step * ++i) > stop) range.push(j / k); else while ((j = start + step * ++i) < stop) range.push(j / k);
        return range;
    };
    function d3_range_integerScale(x) {
        var k = 1;
        while (x * k % 1) k *= 10;
        return k;
    }
    function d3_class(ctor, properties) {
        for (var key in properties) {
            Object.defineProperty(ctor.prototype, key, {
                value: properties[key],
                enumerable: false
            });
        }
    }
    d3.map = function(object, f) {
        var map = new d3_Map();
        if (object instanceof d3_Map) {
            object.forEach(function(key, value) {
                map.set(key, value);
            });
        } else if (Array.isArray(object)) {
            var i = -1, n = object.length, o;
            if (arguments.length === 1) while (++i < n) map.set(i, object[i]); else while (++i < n) map.set(f.call(object, o = object[i], i), o);
        } else {
            for (var key in object) map.set(key, object[key]);
        }
        return map;
    };
    function d3_Map() {
        this._ = Object.create(null);
    }
    var d3_map_proto = "__proto__", d3_map_zero = "\x00";
    d3_class(d3_Map, {
        has: d3_map_has,
        get: function(key) {
            return this._[d3_map_escape(key)];
        },
        set: function(key, value) {
            return this._[d3_map_escape(key)] = value;
        },
        remove: d3_map_remove,
        keys: d3_map_keys,
        values: function() {
            var values = [];
            for (var key in this._) values.push(this._[key]);
            return values;
        },
        entries: function() {
            var entries = [];
            for (var key in this._) entries.push({
                key: d3_map_unescape(key),
                value: this._[key]
            });
            return entries;
        },
        size: d3_map_size,
        empty: d3_map_empty,
        forEach: function(f) {
            for (var key in this._) f.call(this, d3_map_unescape(key), this._[key]);
        }
    });
    function d3_map_escape(key) {
        return (key += "") === d3_map_proto || key[0] === d3_map_zero ? d3_map_zero + key : key;
    }
    function d3_map_unescape(key) {
        return (key += "")[0] === d3_map_zero ? key.slice(1) : key;
    }
    function d3_map_has(key) {
        return d3_map_escape(key) in this._;
    }
    function d3_map_remove(key) {
        return (key = d3_map_escape(key)) in this._ && delete this._[key];
    }
    function d3_map_keys() {
        var keys = [];
        for (var key in this._) keys.push(d3_map_unescape(key));
        return keys;
    }
    function d3_map_size() {
        var size = 0;
        for (var key in this._) ++size;
        return size;
    }
    function d3_map_empty() {
        for (var key in this._) return false;
        return true;
    }
    d3.nest = function() {
        var nest = {}, keys = [], sortKeys = [], sortValues, rollup;
        function map(mapType, array, depth) {
            if (depth >= keys.length) return rollup ? rollup.call(nest, array) : sortValues ? array.sort(sortValues) : array;
            var i = -1, n = array.length, key = keys[depth++], keyValue, object, setter, valuesByKey = new d3_Map(), values;
            while (++i < n) {
                if (values = valuesByKey.get(keyValue = key(object = array[i]))) {
                    values.push(object);
                } else {
                    valuesByKey.set(keyValue, [ object ]);
                }
            }
            if (mapType) {
                object = mapType();
                setter = function(keyValue, values) {
                    object.set(keyValue, map(mapType, values, depth));
                };
            } else {
                object = {};
                setter = function(keyValue, values) {
                    object[keyValue] = map(mapType, values, depth);
                };
            }
            valuesByKey.forEach(setter);
            return object;
        }
        function entries(map, depth) {
            if (depth >= keys.length) return map;
            var array = [], sortKey = sortKeys[depth++];
            map.forEach(function(key, keyMap) {
                array.push({
                    key: key,
                    values: entries(keyMap, depth)
                });
            });
            return sortKey ? array.sort(function(a, b) {
                return sortKey(a.key, b.key);
            }) : array;
        }
        nest.map = function(array, mapType) {
            return map(mapType, array, 0);
        };
        nest.entries = function(array) {
            return entries(map(d3.map, array, 0), 0);
        };
        nest.key = function(d) {
            keys.push(d);
            return nest;
        };
        nest.sortKeys = function(order) {
            sortKeys[keys.length - 1] = order;
            return nest;
        };
        nest.sortValues = function(order) {
            sortValues = order;
            return nest;
        };
        nest.rollup = function(f) {
            rollup = f;
            return nest;
        };
        return nest;
    };
    d3.set = function(array) {
        var set = new d3_Set();
        if (array) for (var i = 0, n = array.length; i < n; ++i) set.add(array[i]);
        return set;
    };
    function d3_Set() {
        this._ = Object.create(null);
    }
    d3_class(d3_Set, {
        has: d3_map_has,
        add: function(key) {
            this._[d3_map_escape(key += "")] = true;
            return key;
        },
        remove: d3_map_remove,
        values: d3_map_keys,
        size: d3_map_size,
        empty: d3_map_empty,
        forEach: function(f) {
            for (var key in this._) f.call(this, d3_map_unescape(key));
        }
    });
    d3.behavior = {};
    function d3_identity(d) {
        return d;
    }
    d3.rebind = function(target, source) {
        var i = 1, n = arguments.length, method;
        while (++i < n) target[method = arguments[i]] = d3_rebind(target, source, source[method]);
        return target;
    };
    function d3_rebind(target, source, method) {
        return function() {
            var value = method.apply(source, arguments);
            return value === source ? target : value;
        };
    }
    function d3_vendorSymbol(object, name) {
        if (name in object) return name;
        name = name.charAt(0).toUpperCase() + name.slice(1);
        for (var i = 0, n = d3_vendorPrefixes.length; i < n; ++i) {
            var prefixName = d3_vendorPrefixes[i] + name;
            if (prefixName in object) return prefixName;
        }
    }
    var d3_vendorPrefixes = [ "webkit", "ms", "moz", "Moz", "o", "O" ];
    function d3_noop() {}
    d3.dispatch = function() {
        var dispatch = new d3_dispatch(), i = -1, n = arguments.length;
        while (++i < n) dispatch[arguments[i]] = d3_dispatch_event(dispatch);
        return dispatch;
    };
    function d3_dispatch() {}
    d3_dispatch.prototype.on = function(type, listener) {
        var i = type.indexOf("."), name = "";
        if (i >= 0) {
            name = type.slice(i + 1);
            type = type.slice(0, i);
        }
        if (type) return arguments.length < 2 ? this[type].on(name) : this[type].on(name, listener);
        if (arguments.length === 2) {
            if (listener == null) for (type in this) {
                if (this.hasOwnProperty(type)) this[type].on(name, null);
            }
            return this;
        }
    };
    function d3_dispatch_event(dispatch) {
        var listeners = [], listenerByName = new d3_Map();
        function event() {
            var z = listeners, i = -1, n = z.length, l;
            while (++i < n) if (l = z[i].on) l.apply(this, arguments);
            return dispatch;
        }
        event.on = function(name, listener) {
            var l = listenerByName.get(name), i;
            if (arguments.length < 2) return l && l.on;
            if (l) {
                l.on = null;
                listeners = listeners.slice(0, i = listeners.indexOf(l)).concat(listeners.slice(i + 1));
                listenerByName.remove(name);
            }
            if (listener) listeners.push(listenerByName.set(name, {
                on: listener
            }));
            return dispatch;
        };
        return event;
    }
    d3.event = null;
    function d3_eventPreventDefault() {
        d3.event.preventDefault();
    }
    function d3_eventSource() {
        var e = d3.event, s;
        while (s = e.sourceEvent) e = s;
        return e;
    }
    function d3_eventDispatch(target) {
        var dispatch = new d3_dispatch(), i = 0, n = arguments.length;
        while (++i < n) dispatch[arguments[i]] = d3_dispatch_event(dispatch);
        dispatch.of = function(thiz, argumentz) {
            return function(e1) {
                try {
                    var e0 = e1.sourceEvent = d3.event;
                    e1.target = target;
                    d3.event = e1;
                    dispatch[e1.type].apply(thiz, argumentz);
                } finally {
                    d3.event = e0;
                }
            };
        };
        return dispatch;
    }
    d3.requote = function(s) {
        return s.replace(d3_requote_re, "\\$&");
    };
    var d3_requote_re = /[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;
    var d3_subclass = {}.__proto__ ? function(object, prototype) {
        object.__proto__ = prototype;
    } : function(object, prototype) {
        for (var property in prototype) object[property] = prototype[property];
    };
    function d3_selection(groups) {
        d3_subclass(groups, d3_selectionPrototype);
        return groups;
    }
    var d3_select = function(s, n) {
        return n.querySelector(s);
    }, d3_selectAll = function(s, n) {
        return n.querySelectorAll(s);
    }, d3_selectMatches = function(n, s) {
        var d3_selectMatcher = n.matches || n[d3_vendorSymbol(n, "matchesSelector")];
        d3_selectMatches = function(n, s) {
            return d3_selectMatcher.call(n, s);
        };
        return d3_selectMatches(n, s);
    };
    if (typeof Sizzle === "function") {
        d3_select = function(s, n) {
            return Sizzle(s, n)[0] || null;
        };
        d3_selectAll = Sizzle;
        d3_selectMatches = Sizzle.matchesSelector;
    }
    d3.selection = function() {
        return d3.select(d3_document.documentElement);
    };
    var d3_selectionPrototype = d3.selection.prototype = [];
    d3_selectionPrototype.select = function(selector) {
        var subgroups = [], subgroup, subnode, group, node;
        selector = d3_selection_selector(selector);
        for (var j = -1, m = this.length; ++j < m; ) {
            subgroups.push(subgroup = []);
            subgroup.parentNode = (group = this[j]).parentNode;
            for (var i = -1, n = group.length; ++i < n; ) {
                if (node = group[i]) {
                    subgroup.push(subnode = selector.call(node, node.__data__, i, j));
                    if (subnode && "__data__" in node) subnode.__data__ = node.__data__;
                } else {
                    subgroup.push(null);
                }
            }
        }
        return d3_selection(subgroups);
    };
    function d3_selection_selector(selector) {
        return typeof selector === "function" ? selector : function() {
            return d3_select(selector, this);
        };
    }
    d3_selectionPrototype.selectAll = function(selector) {
        var subgroups = [], subgroup, node;
        selector = d3_selection_selectorAll(selector);
        for (var j = -1, m = this.length; ++j < m; ) {
            for (var group = this[j], i = -1, n = group.length; ++i < n; ) {
                if (node = group[i]) {
                    subgroups.push(subgroup = d3_array(selector.call(node, node.__data__, i, j)));
                    subgroup.parentNode = node;
                }
            }
        }
        return d3_selection(subgroups);
    };
    function d3_selection_selectorAll(selector) {
        return typeof selector === "function" ? selector : function() {
            return d3_selectAll(selector, this);
        };
    }
    var d3_nsPrefix = {
        svg: "http://www.w3.org/2000/svg",
        xhtml: "http://www.w3.org/1999/xhtml",
        xlink: "http://www.w3.org/1999/xlink",
        xml: "http://www.w3.org/XML/1998/namespace",
        xmlns: "http://www.w3.org/2000/xmlns/"
    };
    d3.ns = {
        prefix: d3_nsPrefix,
        qualify: function(name) {
            var i = name.indexOf(":"), prefix = name;
            if (i >= 0) {
                prefix = name.slice(0, i);
                name = name.slice(i + 1);
            }
            return d3_nsPrefix.hasOwnProperty(prefix) ? {
                space: d3_nsPrefix[prefix],
                local: name
            } : name;
        }
    };
    d3_selectionPrototype.attr = function(name, value) {
        if (arguments.length < 2) {
            if (typeof name === "string") {
                var node = this.node();
                name = d3.ns.qualify(name);
                return name.local ? node.getAttributeNS(name.space, name.local) : node.getAttribute(name);
            }
            for (value in name) this.each(d3_selection_attr(value, name[value]));
            return this;
        }
        return this.each(d3_selection_attr(name, value));
    };
    function d3_selection_attr(name, value) {
        name = d3.ns.qualify(name);
        function attrNull() {
            this.removeAttribute(name);
        }
        function attrNullNS() {
            this.removeAttributeNS(name.space, name.local);
        }
        function attrConstant() {
            this.setAttribute(name, value);
        }
        function attrConstantNS() {
            this.setAttributeNS(name.space, name.local, value);
        }
        function attrFunction() {
            var x = value.apply(this, arguments);
            if (x == null) this.removeAttribute(name); else this.setAttribute(name, x);
        }
        function attrFunctionNS() {
            var x = value.apply(this, arguments);
            if (x == null) this.removeAttributeNS(name.space, name.local); else this.setAttributeNS(name.space, name.local, x);
        }
        return value == null ? name.local ? attrNullNS : attrNull : typeof value === "function" ? name.local ? attrFunctionNS : attrFunction : name.local ? attrConstantNS : attrConstant;
    }
    function d3_collapse(s) {
        return s.trim().replace(/\s+/g, " ");
    }
    d3_selectionPrototype.classed = function(name, value) {
        if (arguments.length < 2) {
            if (typeof name === "string") {
                var node = this.node(), n = (name = d3_selection_classes(name)).length, i = -1;
                if (value = node.classList) {
                    while (++i < n) if (!value.contains(name[i])) return false;
                } else {
                    value = node.getAttribute("class");
                    while (++i < n) if (!d3_selection_classedRe(name[i]).test(value)) return false;
                }
                return true;
            }
            for (value in name) this.each(d3_selection_classed(value, name[value]));
            return this;
        }
        return this.each(d3_selection_classed(name, value));
    };
    function d3_selection_classedRe(name) {
        return new RegExp("(?:^|\\s+)" + d3.requote(name) + "(?:\\s+|$)", "g");
    }
    function d3_selection_classes(name) {
        return (name + "").trim().split(/^|\s+/);
    }
    function d3_selection_classed(name, value) {
        name = d3_selection_classes(name).map(d3_selection_classedName);
        var n = name.length;
        function classedConstant() {
            var i = -1;
            while (++i < n) name[i](this, value);
        }
        function classedFunction() {
            var i = -1, x = value.apply(this, arguments);
            while (++i < n) name[i](this, x);
        }
        return typeof value === "function" ? classedFunction : classedConstant;
    }
    function d3_selection_classedName(name) {
        var re = d3_selection_classedRe(name);
        return function(node, value) {
            if (c = node.classList) return value ? c.add(name) : c.remove(name);
            var c = node.getAttribute("class") || "";
            if (value) {
                re.lastIndex = 0;
                if (!re.test(c)) node.setAttribute("class", d3_collapse(c + " " + name));
            } else {
                node.setAttribute("class", d3_collapse(c.replace(re, " ")));
            }
        };
    }
    d3_selectionPrototype.style = function(name, value, priority) {
        var n = arguments.length;
        if (n < 3) {
            if (typeof name !== "string") {
                if (n < 2) value = "";
                for (priority in name) this.each(d3_selection_style(priority, name[priority], value));
                return this;
            }
            if (n < 2) {
                var node = this.node();
                return d3_window(node).getComputedStyle(node, null).getPropertyValue(name);
            }
            priority = "";
        }
        return this.each(d3_selection_style(name, value, priority));
    };
    function d3_selection_style(name, value, priority) {
        function styleNull() {
            this.style.removeProperty(name);
        }
        function styleConstant() {
            this.style.setProperty(name, value, priority);
        }
        function styleFunction() {
            var x = value.apply(this, arguments);
            if (x == null) this.style.removeProperty(name); else this.style.setProperty(name, x, priority);
        }
        return value == null ? styleNull : typeof value === "function" ? styleFunction : styleConstant;
    }
    d3_selectionPrototype.property = function(name, value) {
        if (arguments.length < 2) {
            if (typeof name === "string") return this.node()[name];
            for (value in name) this.each(d3_selection_property(value, name[value]));
            return this;
        }
        return this.each(d3_selection_property(name, value));
    };
    function d3_selection_property(name, value) {
        function propertyNull() {
            delete this[name];
        }
        function propertyConstant() {
            this[name] = value;
        }
        function propertyFunction() {
            var x = value.apply(this, arguments);
            if (x == null) delete this[name]; else this[name] = x;
        }
        return value == null ? propertyNull : typeof value === "function" ? propertyFunction : propertyConstant;
    }
    d3_selectionPrototype.text = function(value) {
        return arguments.length ? this.each(typeof value === "function" ? function() {
            var v = value.apply(this, arguments);
            this.textContent = v == null ? "" : v;
        } : value == null ? function() {
            this.textContent = "";
        } : function() {
            this.textContent = value;
        }) : this.node().textContent;
    };
    d3_selectionPrototype.html = function(value) {
        return arguments.length ? this.each(typeof value === "function" ? function() {
            var v = value.apply(this, arguments);
            this.innerHTML = v == null ? "" : v;
        } : value == null ? function() {
            this.innerHTML = "";
        } : function() {
            this.innerHTML = value;
        }) : this.node().innerHTML;
    };
    d3_selectionPrototype.append = function(name) {
        name = d3_selection_creator(name);
        return this.select(function() {
            return this.appendChild(name.apply(this, arguments));
        });
    };
    function d3_selection_creator(name) {
        function create() {
            var document = this.ownerDocument, namespace = this.namespaceURI;
            return namespace ? document.createElementNS(namespace, name) : document.createElement(name);
        }
        function createNS() {
            return this.ownerDocument.createElementNS(name.space, name.local);
        }
        return typeof name === "function" ? name : (name = d3.ns.qualify(name)).local ? createNS : create;
    }
    d3_selectionPrototype.insert = function(name, before) {
        name = d3_selection_creator(name);
        before = d3_selection_selector(before);
        return this.select(function() {
            return this.insertBefore(name.apply(this, arguments), before.apply(this, arguments) || null);
        });
    };
    d3_selectionPrototype.remove = function() {
        return this.each(d3_selectionRemove);
    };
    function d3_selectionRemove() {
        var parent = this.parentNode;
        if (parent) parent.removeChild(this);
    }
    d3_selectionPrototype.data = function(value, key) {
        var i = -1, n = this.length, group, node;
        if (!arguments.length) {
            value = new Array(n = (group = this[0]).length);
            while (++i < n) {
                if (node = group[i]) {
                    value[i] = node.__data__;
                }
            }
            return value;
        }
        function bind(group, groupData) {
            var i, n = group.length, m = groupData.length, n0 = Math.min(n, m), updateNodes = new Array(m), enterNodes = new Array(m), exitNodes = new Array(n), node, nodeData;
            if (key) {
                var nodeByKeyValue = new d3_Map(), keyValues = new Array(n), keyValue;
                for (i = -1; ++i < n; ) {
                    if (nodeByKeyValue.has(keyValue = key.call(node = group[i], node.__data__, i))) {
                        exitNodes[i] = node;
                    } else {
                        nodeByKeyValue.set(keyValue, node);
                    }
                    keyValues[i] = keyValue;
                }
                for (i = -1; ++i < m; ) {
                    if (!(node = nodeByKeyValue.get(keyValue = key.call(groupData, nodeData = groupData[i], i)))) {
                        enterNodes[i] = d3_selection_dataNode(nodeData);
                    } else if (node !== true) {
                        updateNodes[i] = node;
                        node.__data__ = nodeData;
                    }
                    nodeByKeyValue.set(keyValue, true);
                }
                for (i = -1; ++i < n; ) {
                    if (nodeByKeyValue.get(keyValues[i]) !== true) {
                        exitNodes[i] = group[i];
                    }
                }
            } else {
                for (i = -1; ++i < n0; ) {
                    node = group[i];
                    nodeData = groupData[i];
                    if (node) {
                        node.__data__ = nodeData;
                        updateNodes[i] = node;
                    } else {
                        enterNodes[i] = d3_selection_dataNode(nodeData);
                    }
                }
                for (;i < m; ++i) {
                    enterNodes[i] = d3_selection_dataNode(groupData[i]);
                }
                for (;i < n; ++i) {
                    exitNodes[i] = group[i];
                }
            }
            enterNodes.update = updateNodes;
            enterNodes.parentNode = updateNodes.parentNode = exitNodes.parentNode = group.parentNode;
            enter.push(enterNodes);
            update.push(updateNodes);
            exit.push(exitNodes);
        }
        var enter = d3_selection_enter([]), update = d3_selection([]), exit = d3_selection([]);
        if (typeof value === "function") {
            while (++i < n) {
                bind(group = this[i], value.call(group, group.parentNode.__data__, i));
            }
        } else {
            while (++i < n) {
                bind(group = this[i], value);
            }
        }
        update.enter = function() {
            return enter;
        };
        update.exit = function() {
            return exit;
        };
        return update;
    };
    function d3_selection_dataNode(data) {
        return {
            __data__: data
        };
    }
    d3_selectionPrototype.datum = function(value) {
        return arguments.length ? this.property("__data__", value) : this.property("__data__");
    };
    d3_selectionPrototype.filter = function(filter) {
        var subgroups = [], subgroup, group, node;
        if (typeof filter !== "function") filter = d3_selection_filter(filter);
        for (var j = 0, m = this.length; j < m; j++) {
            subgroups.push(subgroup = []);
            subgroup.parentNode = (group = this[j]).parentNode;
            for (var i = 0, n = group.length; i < n; i++) {
                if ((node = group[i]) && filter.call(node, node.__data__, i, j)) {
                    subgroup.push(node);
                }
            }
        }
        return d3_selection(subgroups);
    };
    function d3_selection_filter(selector) {
        return function() {
            return d3_selectMatches(this, selector);
        };
    }
    d3_selectionPrototype.order = function() {
        for (var j = -1, m = this.length; ++j < m; ) {
            for (var group = this[j], i = group.length - 1, next = group[i], node; --i >= 0; ) {
                if (node = group[i]) {
                    if (next && next !== node.nextSibling) next.parentNode.insertBefore(node, next);
                    next = node;
                }
            }
        }
        return this;
    };
    d3_selectionPrototype.sort = function(comparator) {
        comparator = d3_selection_sortComparator.apply(this, arguments);
        for (var j = -1, m = this.length; ++j < m; ) this[j].sort(comparator);
        return this.order();
    };
    function d3_selection_sortComparator(comparator) {
        if (!arguments.length) comparator = d3_ascending;
        return function(a, b) {
            return a && b ? comparator(a.__data__, b.__data__) : !a - !b;
        };
    }
    d3_selectionPrototype.each = function(callback) {
        return d3_selection_each(this, function(node, i, j) {
            callback.call(node, node.__data__, i, j);
        });
    };
    function d3_selection_each(groups, callback) {
        for (var j = 0, m = groups.length; j < m; j++) {
            for (var group = groups[j], i = 0, n = group.length, node; i < n; i++) {
                if (node = group[i]) callback(node, i, j);
            }
        }
        return groups;
    }
    d3_selectionPrototype.call = function(callback) {
        var args = d3_array(arguments);
        callback.apply(args[0] = this, args);
        return this;
    };
    d3_selectionPrototype.empty = function() {
        return !this.node();
    };
    d3_selectionPrototype.node = function() {
        for (var j = 0, m = this.length; j < m; j++) {
            for (var group = this[j], i = 0, n = group.length; i < n; i++) {
                var node = group[i];
                if (node) return node;
            }
        }
        return null;
    };
    d3_selectionPrototype.size = function() {
        var n = 0;
        d3_selection_each(this, function() {
            ++n;
        });
        return n;
    };
    function d3_selection_enter(selection) {
        d3_subclass(selection, d3_selection_enterPrototype);
        return selection;
    }
    var d3_selection_enterPrototype = [];
    d3.selection.enter = d3_selection_enter;
    d3.selection.enter.prototype = d3_selection_enterPrototype;
    d3_selection_enterPrototype.append = d3_selectionPrototype.append;
    d3_selection_enterPrototype.empty = d3_selectionPrototype.empty;
    d3_selection_enterPrototype.node = d3_selectionPrototype.node;
    d3_selection_enterPrototype.call = d3_selectionPrototype.call;
    d3_selection_enterPrototype.size = d3_selectionPrototype.size;
    d3_selection_enterPrototype.select = function(selector) {
        var subgroups = [], subgroup, subnode, upgroup, group, node;
        for (var j = -1, m = this.length; ++j < m; ) {
            upgroup = (group = this[j]).update;
            subgroups.push(subgroup = []);
            subgroup.parentNode = group.parentNode;
            for (var i = -1, n = group.length; ++i < n; ) {
                if (node = group[i]) {
                    subgroup.push(upgroup[i] = subnode = selector.call(group.parentNode, node.__data__, i, j));
                    subnode.__data__ = node.__data__;
                } else {
                    subgroup.push(null);
                }
            }
        }
        return d3_selection(subgroups);
    };
    d3_selection_enterPrototype.insert = function(name, before) {
        if (arguments.length < 2) before = d3_selection_enterInsertBefore(this);
        return d3_selectionPrototype.insert.call(this, name, before);
    };
    function d3_selection_enterInsertBefore(enter) {
        var i0, j0;
        return function(d, i, j) {
            var group = enter[j].update, n = group.length, node;
            if (j != j0) j0 = j, i0 = 0;
            if (i >= i0) i0 = i + 1;
            while (!(node = group[i0]) && ++i0 < n) ;
            return node;
        };
    }
    d3.select = function(node) {
        var group;
        if (typeof node === "string") {
            group = [ d3_select(node, d3_document) ];
            group.parentNode = d3_document.documentElement;
        } else {
            group = [ node ];
            group.parentNode = d3_documentElement(node);
        }
        return d3_selection([ group ]);
    };
    d3.selectAll = function(nodes) {
        var group;
        if (typeof nodes === "string") {
            group = d3_array(d3_selectAll(nodes, d3_document));
            group.parentNode = d3_document.documentElement;
        } else {
            group = nodes;
            group.parentNode = null;
        }
        return d3_selection([ group ]);
    };
    d3_selectionPrototype.on = function(type, listener, capture) {
        var n = arguments.length;
        if (n < 3) {
            if (typeof type !== "string") {
                if (n < 2) listener = false;
                for (capture in type) this.each(d3_selection_on(capture, type[capture], listener));
                return this;
            }
            if (n < 2) return (n = this.node()["__on" + type]) && n._;
            capture = false;
        }
        return this.each(d3_selection_on(type, listener, capture));
    };
    function d3_selection_on(type, listener, capture) {
        var name = "__on" + type, i = type.indexOf("."), wrap = d3_selection_onListener;
        if (i > 0) type = type.slice(0, i);
        var filter = d3_selection_onFilters.get(type);
        if (filter) type = filter, wrap = d3_selection_onFilter;
        function onRemove() {
            var l = this[name];
            if (l) {
                this.removeEventListener(type, l, l.$);
                delete this[name];
            }
        }
        function onAdd() {
            var l = wrap(listener, d3_array(arguments));
            onRemove.call(this);
            this.addEventListener(type, this[name] = l, l.$ = capture);
            l._ = listener;
        }
        function removeAll() {
            var re = new RegExp("^__on([^.]+)" + d3.requote(type) + "$"), match;
            for (var name in this) {
                if (match = name.match(re)) {
                    var l = this[name];
                    this.removeEventListener(match[1], l, l.$);
                    delete this[name];
                }
            }
        }
        return i ? listener ? onAdd : onRemove : listener ? d3_noop : removeAll;
    }
    var d3_selection_onFilters = d3.map({
        mouseenter: "mouseover",
        mouseleave: "mouseout"
    });
    if (d3_document) {
        d3_selection_onFilters.forEach(function(k) {
            if ("on" + k in d3_document) d3_selection_onFilters.remove(k);
        });
    }
    function d3_selection_onListener(listener, argumentz) {
        return function(e) {
            var o = d3.event;
            d3.event = e;
            argumentz[0] = this.__data__;
            try {
                listener.apply(this, argumentz);
            } finally {
                d3.event = o;
            }
        };
    }
    function d3_selection_onFilter(listener, argumentz) {
        var l = d3_selection_onListener(listener, argumentz);
        return function(e) {
            var target = this, related = e.relatedTarget;
            if (!related || related !== target && !(related.compareDocumentPosition(target) & 8)) {
                l.call(target, e);
            }
        };
    }
    var d3_event_dragSelect, d3_event_dragId = 0;
    function d3_event_dragSuppress(node) {
        var name = ".dragsuppress-" + ++d3_event_dragId, click = "click" + name, w = d3.select(d3_window(node)).on("touchmove" + name, d3_eventPreventDefault).on("dragstart" + name, d3_eventPreventDefault).on("selectstart" + name, d3_eventPreventDefault);
        if (d3_event_dragSelect == null) {
            d3_event_dragSelect = "onselectstart" in node ? false : d3_vendorSymbol(node.style, "userSelect");
        }
        if (d3_event_dragSelect) {
            var style = d3_documentElement(node).style, select = style[d3_event_dragSelect];
            style[d3_event_dragSelect] = "none";
        }
        return function(suppressClick) {
            w.on(name, null);
            if (d3_event_dragSelect) style[d3_event_dragSelect] = select;
            if (suppressClick) {
                var off = function() {
                    w.on(click, null);
                };
                w.on(click, function() {
                    d3_eventPreventDefault();
                    off();
                }, true);
                setTimeout(off, 0);
            }
        };
    }
    d3.mouse = function(container) {
        return d3_mousePoint(container, d3_eventSource());
    };
    var d3_mouse_bug44083 = this.navigator && /WebKit/.test(this.navigator.userAgent) ? -1 : 0;
    function d3_mousePoint(container, e) {
        if (e.changedTouches) e = e.changedTouches[0];
        var svg = container.ownerSVGElement || container;
        if (svg.createSVGPoint) {
            var point = svg.createSVGPoint();
            if (d3_mouse_bug44083 < 0) {
                var window = d3_window(container);
                if (window.scrollX || window.scrollY) {
                    svg = d3.select("body").append("svg").style({
                        position: "absolute",
                        top: 0,
                        left: 0,
                        margin: 0,
                        padding: 0,
                        border: "none"
                    }, "important");
                    var ctm = svg[0][0].getScreenCTM();
                    d3_mouse_bug44083 = !(ctm.f || ctm.e);
                    svg.remove();
                }
            }
            if (d3_mouse_bug44083) point.x = e.pageX, point.y = e.pageY; else point.x = e.clientX,
                point.y = e.clientY;
            point = point.matrixTransform(container.getScreenCTM().inverse());
            return [ point.x, point.y ];
        }
        var rect = container.getBoundingClientRect();
        return [ e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop ];
    }
    d3.touch = function(container, touches, identifier) {
        if (arguments.length < 3) identifier = touches, touches = d3_eventSource().changedTouches;
        if (touches) for (var i = 0, n = touches.length, touch; i < n; ++i) {
            if ((touch = touches[i]).identifier === identifier) {
                return d3_mousePoint(container, touch);
            }
        }
    };
    d3.behavior.drag = function() {
        var event = d3_eventDispatch(drag, "drag", "dragstart", "dragend"), origin = null, mousedown = dragstart(d3_noop, d3.mouse, d3_window, "mousemove", "mouseup"), touchstart = dragstart(d3_behavior_dragTouchId, d3.touch, d3_identity, "touchmove", "touchend");
        function drag() {
            this.on("mousedown.drag", mousedown).on("touchstart.drag", touchstart);
        }
        function dragstart(id, position, subject, move, end) {
            return function() {
                var that = this, target = d3.event.target, parent = that.parentNode, dispatch = event.of(that, arguments), dragged = 0, dragId = id(), dragName = ".drag" + (dragId == null ? "" : "-" + dragId), dragOffset, dragSubject = d3.select(subject(target)).on(move + dragName, moved).on(end + dragName, ended), dragRestore = d3_event_dragSuppress(target), position0 = position(parent, dragId);
                if (origin) {
                    dragOffset = origin.apply(that, arguments);
                    dragOffset = [ dragOffset.x - position0[0], dragOffset.y - position0[1] ];
                } else {
                    dragOffset = [ 0, 0 ];
                }
                dispatch({
                    type: "dragstart"
                });
                function moved() {
                    var position1 = position(parent, dragId), dx, dy;
                    if (!position1) return;
                    dx = position1[0] - position0[0];
                    dy = position1[1] - position0[1];
                    dragged |= dx | dy;
                    position0 = position1;
                    dispatch({
                        type: "drag",
                        x: position1[0] + dragOffset[0],
                        y: position1[1] + dragOffset[1],
                        dx: dx,
                        dy: dy
                    });
                }
                function ended() {
                    if (!position(parent, dragId)) return;
                    dragSubject.on(move + dragName, null).on(end + dragName, null);
                    dragRestore(dragged && d3.event.target === target);
                    dispatch({
                        type: "dragend"
                    });
                }
            };
        }
        drag.origin = function(x) {
            if (!arguments.length) return origin;
            origin = x;
            return drag;
        };
        return d3.rebind(drag, event, "on");
    };
    function d3_behavior_dragTouchId() {
        return d3.event.changedTouches[0].identifier;
    }
    d3.touches = function(container, touches) {
        if (arguments.length < 2) touches = d3_eventSource().touches;
        return touches ? d3_array(touches).map(function(touch) {
            var point = d3_mousePoint(container, touch);
            point.identifier = touch.identifier;
            return point;
        }) : [];
    };
    var  = 1e-6, 2 =  * ,  = Math.PI,  = 2 * ,  =  - , half =  / 2, d3_radians =  / 180, d3_degrees = 180 / ;
    function d3_sgn(x) {
        return x > 0 ? 1 : x < 0 ? -1 : 0;
    }
    function d3_cross2d(a, b, c) {
        return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]);
    }
    function d3_acos(x) {
        return x > 1 ? 0 : x < -1 ?  : Math.acos(x);
    }
    function d3_asin(x) {
        return x > 1 ? half : x < -1 ? -half : Math.asin(x);
    }
    function d3_sinh(x) {
        return ((x = Math.exp(x)) - 1 / x) / 2;
    }
    function d3_cosh(x) {
        return ((x = Math.exp(x)) + 1 / x) / 2;
    }
    function d3_tanh(x) {
        return ((x = Math.exp(2 * x)) - 1) / (x + 1);
    }
    function d3_haversin(x) {
        return (x = Math.sin(x / 2)) * x;
    }
    var  = Math.SQRT2, 2 = 2, 4 = 4;
    d3.interpolateZoom = function(p0, p1) {
        var ux0 = p0[0], uy0 = p0[1], w0 = p0[2], ux1 = p1[0], uy1 = p1[1], w1 = p1[2];
        var dx = ux1 - ux0, dy = uy1 - uy0, d2 = dx * dx + dy * dy, d1 = Math.sqrt(d2), b0 = (w1 * w1 - w0 * w0 + 4 * d2) / (2 * w0 * 2 * d1), b1 = (w1 * w1 - w0 * w0 - 4 * d2) / (2 * w1 * 2 * d1), r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0), r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1), dr = r1 - r0, S = (dr || Math.log(w1 / w0)) / ;
        function interpolate(t) {
            var s = t * S;
            if (dr) {
                var coshr0 = d3_cosh(r0), u = w0 / (2 * d1) * (coshr0 * d3_tanh( * s + r0) - d3_sinh(r0));
                return [ ux0 + u * dx, uy0 + u * dy, w0 * coshr0 / d3_cosh( * s + r0) ];
            }
            return [ ux0 + t * dx, uy0 + t * dy, w0 * Math.exp( * s) ];
        }
        interpolate.duration = S * 1e3;
        return interpolate;
    };
    d3.behavior.zoom = function() {
        var view = {
            x: 0,
            y: 0,
            k: 1
        }, translate0, center0, center, size = [ 960, 500 ], scaleExtent = d3_behavior_zoomInfinity, duration = 250, zooming = 0, mousedown = "mousedown.zoom", mousemove = "mousemove.zoom", mouseup = "mouseup.zoom", mousewheelTimer, touchstart = "touchstart.zoom", touchtime, event = d3_eventDispatch(zoom, "zoomstart", "zoom", "zoomend"), x0, x1, y0, y1;
        if (!d3_behavior_zoomWheel) {
            d3_behavior_zoomWheel = "onwheel" in d3_document ? (d3_behavior_zoomDelta = function() {
                return -d3.event.deltaY * (d3.event.deltaMode ? 120 : 1);
            }, "wheel") : "onmousewheel" in d3_document ? (d3_behavior_zoomDelta = function() {
                return d3.event.wheelDelta;
            }, "mousewheel") : (d3_behavior_zoomDelta = function() {
                return -d3.event.detail;
            }, "MozMousePixelScroll");
        }
        function zoom(g) {
            g.on(mousedown, mousedowned).on(d3_behavior_zoomWheel + ".zoom", mousewheeled).on("dblclick.zoom", dblclicked).on(touchstart, touchstarted);
        }
        zoom.event = function(g) {
            g.each(function() {
                var dispatch = event.of(this, arguments), view1 = view;
                if (d3_transitionInheritId) {
                    d3.select(this).transition().each("start.zoom", function() {
                        view = this.__chart__ || {
                                x: 0,
                                y: 0,
                                k: 1
                            };
                        zoomstarted(dispatch);
                    }).tween("zoom:zoom", function() {
                        var dx = size[0], dy = size[1], cx = center0 ? center0[0] : dx / 2, cy = center0 ? center0[1] : dy / 2, i = d3.interpolateZoom([ (cx - view.x) / view.k, (cy - view.y) / view.k, dx / view.k ], [ (cx - view1.x) / view1.k, (cy - view1.y) / view1.k, dx / view1.k ]);
                        return function(t) {
                            var l = i(t), k = dx / l[2];
                            this.__chart__ = view = {
                                x: cx - l[0] * k,
                                y: cy - l[1] * k,
                                k: k
                            };
                            zoomed(dispatch);
                        };
                    }).each("interrupt.zoom", function() {
                        zoomended(dispatch);
                    }).each("end.zoom", function() {
                        zoomended(dispatch);
                    });
                } else {
                    this.__chart__ = view;
                    zoomstarted(dispatch);
                    zoomed(dispatch);
                    zoomended(dispatch);
                }
            });
        };
        zoom.translate = function(_) {
            if (!arguments.length) return [ view.x, view.y ];
            view = {
                x: +_[0],
                y: +_[1],
                k: view.k
            };
            rescale();
            return zoom;
        };
        zoom.scale = function(_) {
            if (!arguments.length) return view.k;
            view = {
                x: view.x,
                y: view.y,
                k: +_
            };
            rescale();
            return zoom;
        };
        zoom.scaleExtent = function(_) {
            if (!arguments.length) return scaleExtent;
            scaleExtent = _ == null ? d3_behavior_zoomInfinity : [ +_[0], +_[1] ];
            return zoom;
        };
        zoom.center = function(_) {
            if (!arguments.length) return center;
            center = _ && [ +_[0], +_[1] ];
            return zoom;
        };
        zoom.size = function(_) {
            if (!arguments.length) return size;
            size = _ && [ +_[0], +_[1] ];
            return zoom;
        };
        zoom.duration = function(_) {
            if (!arguments.length) return duration;
            duration = +_;
            return zoom;
        };
        zoom.x = function(z) {
            if (!arguments.length) return x1;
            x1 = z;
            x0 = z.copy();
            view = {
                x: 0,
                y: 0,
                k: 1
            };
            return zoom;
        };
        zoom.y = function(z) {
            if (!arguments.length) return y1;
            y1 = z;
            y0 = z.copy();
            view = {
                x: 0,
                y: 0,
                k: 1
            };
            return zoom;
        };
        function location(p) {
            return [ (p[0] - view.x) / view.k, (p[1] - view.y) / view.k ];
        }
        function point(l) {
            return [ l[0] * view.k + view.x, l[1] * view.k + view.y ];
        }
        function scaleTo(s) {
            view.k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], s));
        }
        function translateTo(p, l) {
            l = point(l);
            view.x += p[0] - l[0];
            view.y += p[1] - l[1];
        }
        function zoomTo(that, p, l, k) {
            that.__chart__ = {
                x: view.x,
                y: view.y,
                k: view.k
            };
            scaleTo(Math.pow(2, k));
            translateTo(center0 = p, l);
            that = d3.select(that);
            if (duration > 0) that = that.transition().duration(duration);
            that.call(zoom.event);
        }
        function rescale() {
            if (x1) x1.domain(x0.range().map(function(x) {
                return (x - view.x) / view.k;
            }).map(x0.invert));
            if (y1) y1.domain(y0.range().map(function(y) {
                return (y - view.y) / view.k;
            }).map(y0.invert));
        }
        function zoomstarted(dispatch) {
            if (!zooming++) dispatch({
                type: "zoomstart"
            });
        }
        function zoomed(dispatch) {
            rescale();
            dispatch({
                type: "zoom",
                scale: view.k,
                translate: [ view.x, view.y ]
            });
        }
        function zoomended(dispatch) {
            if (!--zooming) dispatch({
                type: "zoomend"
            });
            center0 = null;
        }
        function mousedowned() {
            var that = this, target = d3.event.target, dispatch = event.of(that, arguments), dragged = 0, subject = d3.select(d3_window(that)).on(mousemove, moved).on(mouseup, ended), location0 = location(d3.mouse(that)), dragRestore = d3_event_dragSuppress(that);
            d3_selection_interrupt.call(that);
            zoomstarted(dispatch);
            function moved() {
                dragged = 1;
                translateTo(d3.mouse(that), location0);
                zoomed(dispatch);
            }
            function ended() {
                subject.on(mousemove, null).on(mouseup, null);
                dragRestore(dragged && d3.event.target === target);
                zoomended(dispatch);
            }
        }
        function touchstarted() {
            var that = this, dispatch = event.of(that, arguments), locations0 = {}, distance0 = 0, scale0, zoomName = ".zoom-" + d3.event.changedTouches[0].identifier, touchmove = "touchmove" + zoomName, touchend = "touchend" + zoomName, targets = [], subject = d3.select(that), dragRestore = d3_event_dragSuppress(that);
            started();
            zoomstarted(dispatch);
            subject.on(mousedown, null).on(touchstart, started);
            function relocate() {
                var touches = d3.touches(that);
                scale0 = view.k;
                touches.forEach(function(t) {
                    if (t.identifier in locations0) locations0[t.identifier] = location(t);
                });
                return touches;
            }
            function started() {
                var target = d3.event.target;
                d3.select(target).on(touchmove, moved).on(touchend, ended);
                targets.push(target);
                var changed = d3.event.changedTouches;
                for (var i = 0, n = changed.length; i < n; ++i) {
                    locations0[changed[i].identifier] = null;
                }
                var touches = relocate(), now = Date.now();
                if (touches.length === 1) {
                    if (now - touchtime < 500) {
                        var p = touches[0];
                        zoomTo(that, p, locations0[p.identifier], Math.floor(Math.log(view.k) / Math.LN2) + 1);
                        d3_eventPreventDefault();
                    }
                    touchtime = now;
                } else if (touches.length > 1) {
                    var p = touches[0], q = touches[1], dx = p[0] - q[0], dy = p[1] - q[1];
                    distance0 = dx * dx + dy * dy;
                }
            }
            function moved() {
                var touches = d3.touches(that), p0, l0, p1, l1;
                d3_selection_interrupt.call(that);
                for (var i = 0, n = touches.length; i < n; ++i, l1 = null) {
                    p1 = touches[i];
                    if (l1 = locations0[p1.identifier]) {
                        if (l0) break;
                        p0 = p1, l0 = l1;
                    }
                }
                if (l1) {
                    var distance1 = (distance1 = p1[0] - p0[0]) * distance1 + (distance1 = p1[1] - p0[1]) * distance1, scale1 = distance0 && Math.sqrt(distance1 / distance0);
                    p0 = [ (p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2 ];
                    l0 = [ (l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2 ];
                    scaleTo(scale1 * scale0);
                }
                touchtime = null;
                translateTo(p0, l0);
                zoomed(dispatch);
            }
            function ended() {
                if (d3.event.touches.length) {
                    var changed = d3.event.changedTouches;
                    for (var i = 0, n = changed.length; i < n; ++i) {
                        delete locations0[changed[i].identifier];
                    }
                    for (var identifier in locations0) {
                        return void relocate();
                    }
                }
                d3.selectAll(targets).on(zoomName, null);
                subject.on(mousedown, mousedowned).on(touchstart, touchstarted);
                dragRestore();
                zoomended(dispatch);
            }
        }
        function mousewheeled() {
            var dispatch = event.of(this, arguments);
            if (mousewheelTimer) clearTimeout(mousewheelTimer); else translate0 = location(center0 = center || d3.mouse(this)),
                d3_selection_interrupt.call(this), zoomstarted(dispatch);
            mousewheelTimer = setTimeout(function() {
                mousewheelTimer = null;
                zoomended(dispatch);
            }, 50);
            d3_eventPreventDefault();
            scaleTo(Math.pow(2, d3_behavior_zoomDelta() * .002) * view.k);
            translateTo(center0, translate0);
            zoomed(dispatch);
        }
        function dblclicked() {
            var p = d3.mouse(this), k = Math.log(view.k) / Math.LN2;
            zoomTo(this, p, location(p), d3.event.shiftKey ? Math.ceil(k) - 1 : Math.floor(k) + 1);
        }
        return d3.rebind(zoom, event, "on");
    };
    var d3_behavior_zoomInfinity = [ 0, Infinity ], d3_behavior_zoomDelta, d3_behavior_zoomWheel;
    d3.color = d3_color;
    function d3_color() {}
    d3_color.prototype.toString = function() {
        return this.rgb() + "";
    };
    d3.hsl = d3_hsl;
    function d3_hsl(h, s, l) {
        return this instanceof d3_hsl ? void (this.h = +h, this.s = +s, this.l = +l) : arguments.length < 2 ? h instanceof d3_hsl ? new d3_hsl(h.h, h.s, h.l) : d3_rgb_parse("" + h, d3_rgb_hsl, d3_hsl) : new d3_hsl(h, s, l);
    }
    var d3_hslPrototype = d3_hsl.prototype = new d3_color();
    d3_hslPrototype.brighter = function(k) {
        k = Math.pow(.7, arguments.length ? k : 1);
        return new d3_hsl(this.h, this.s, this.l / k);
    };
    d3_hslPrototype.darker = function(k) {
        k = Math.pow(.7, arguments.length ? k : 1);
        return new d3_hsl(this.h, this.s, k * this.l);
    };
    d3_hslPrototype.rgb = function() {
        return d3_hsl_rgb(this.h, this.s, this.l);
    };
    function d3_hsl_rgb(h, s, l) {
        var m1, m2;
        h = isNaN(h) ? 0 : (h %= 360) < 0 ? h + 360 : h;
        s = isNaN(s) ? 0 : s < 0 ? 0 : s > 1 ? 1 : s;
        l = l < 0 ? 0 : l > 1 ? 1 : l;
        m2 = l <= .5 ? l * (1 + s) : l + s - l * s;
        m1 = 2 * l - m2;
        function v(h) {
            if (h > 360) h -= 360; else if (h < 0) h += 360;
            if (h < 60) return m1 + (m2 - m1) * h / 60;
            if (h < 180) return m2;
            if (h < 240) return m1 + (m2 - m1) * (240 - h) / 60;
            return m1;
        }
        function vv(h) {
            return Math.round(v(h) * 255);
        }
        return new d3_rgb(vv(h + 120), vv(h), vv(h - 120));
    }
    d3.hcl = d3_hcl;
    function d3_hcl(h, c, l) {
        return this instanceof d3_hcl ? void (this.h = +h, this.c = +c, this.l = +l) : arguments.length < 2 ? h instanceof d3_hcl ? new d3_hcl(h.h, h.c, h.l) : h instanceof d3_lab ? d3_lab_hcl(h.l, h.a, h.b) : d3_lab_hcl((h = d3_rgb_lab((h = d3.rgb(h)).r, h.g, h.b)).l, h.a, h.b) : new d3_hcl(h, c, l);
    }
    var d3_hclPrototype = d3_hcl.prototype = new d3_color();
    d3_hclPrototype.brighter = function(k) {
        return new d3_hcl(this.h, this.c, Math.min(100, this.l + d3_lab_K * (arguments.length ? k : 1)));
    };
    d3_hclPrototype.darker = function(k) {
        return new d3_hcl(this.h, this.c, Math.max(0, this.l - d3_lab_K * (arguments.length ? k : 1)));
    };
    d3_hclPrototype.rgb = function() {
        return d3_hcl_lab(this.h, this.c, this.l).rgb();
    };
    function d3_hcl_lab(h, c, l) {
        if (isNaN(h)) h = 0;
        if (isNaN(c)) c = 0;
        return new d3_lab(l, Math.cos(h *= d3_radians) * c, Math.sin(h) * c);
    }
    d3.lab = d3_lab;
    function d3_lab(l, a, b) {
        return this instanceof d3_lab ? void (this.l = +l, this.a = +a, this.b = +b) : arguments.length < 2 ? l instanceof d3_lab ? new d3_lab(l.l, l.a, l.b) : l instanceof d3_hcl ? d3_hcl_lab(l.h, l.c, l.l) : d3_rgb_lab((l = d3_rgb(l)).r, l.g, l.b) : new d3_lab(l, a, b);
    }
    var d3_lab_K = 18;
    var d3_lab_X = .95047, d3_lab_Y = 1, d3_lab_Z = 1.08883;
    var d3_labPrototype = d3_lab.prototype = new d3_color();
    d3_labPrototype.brighter = function(k) {
        return new d3_lab(Math.min(100, this.l + d3_lab_K * (arguments.length ? k : 1)), this.a, this.b);
    };
    d3_labPrototype.darker = function(k) {
        return new d3_lab(Math.max(0, this.l - d3_lab_K * (arguments.length ? k : 1)), this.a, this.b);
    };
    d3_labPrototype.rgb = function() {
        return d3_lab_rgb(this.l, this.a, this.b);
    };
    function d3_lab_rgb(l, a, b) {
        var y = (l + 16) / 116, x = y + a / 500, z = y - b / 200;
        x = d3_lab_xyz(x) * d3_lab_X;
        y = d3_lab_xyz(y) * d3_lab_Y;
        z = d3_lab_xyz(z) * d3_lab_Z;
        return new d3_rgb(d3_xyz_rgb(3.2404542 * x - 1.5371385 * y - .4985314 * z), d3_xyz_rgb(-.969266 * x + 1.8760108 * y + .041556 * z), d3_xyz_rgb(.0556434 * x - .2040259 * y + 1.0572252 * z));
    }
    function d3_lab_hcl(l, a, b) {
        return l > 0 ? new d3_hcl(Math.atan2(b, a) * d3_degrees, Math.sqrt(a * a + b * b), l) : new d3_hcl(NaN, NaN, l);
    }
    function d3_lab_xyz(x) {
        return x > .206893034 ? x * x * x : (x - 4 / 29) / 7.787037;
    }
    function d3_xyz_lab(x) {
        return x > .008856 ? Math.pow(x, 1 / 3) : 7.787037 * x + 4 / 29;
    }
    function d3_xyz_rgb(r) {
        return Math.round(255 * (r <= .00304 ? 12.92 * r : 1.055 * Math.pow(r, 1 / 2.4) - .055));
    }
    d3.rgb = d3_rgb;
    function d3_rgb(r, g, b) {
        return this instanceof d3_rgb ? void (this.r = ~~r, this.g = ~~g, this.b = ~~b) : arguments.length < 2 ? r instanceof d3_rgb ? new d3_rgb(r.r, r.g, r.b) : d3_rgb_parse("" + r, d3_rgb, d3_hsl_rgb) : new d3_rgb(r, g, b);
    }
    function d3_rgbNumber(value) {
        return new d3_rgb(value >> 16, value >> 8 & 255, value & 255);
    }
    function d3_rgbString(value) {
        return d3_rgbNumber(value) + "";
    }
    var d3_rgbPrototype = d3_rgb.prototype = new d3_color();
    d3_rgbPrototype.brighter = function(k) {
        k = Math.pow(.7, arguments.length ? k : 1);
        var r = this.r, g = this.g, b = this.b, i = 30;
        if (!r && !g && !b) return new d3_rgb(i, i, i);
        if (r && r < i) r = i;
        if (g && g < i) g = i;
        if (b && b < i) b = i;
        return new d3_rgb(Math.min(255, r / k), Math.min(255, g / k), Math.min(255, b / k));
    };
    d3_rgbPrototype.darker = function(k) {
        k = Math.pow(.7, arguments.length ? k : 1);
        return new d3_rgb(k * this.r, k * this.g, k * this.b);
    };
    d3_rgbPrototype.hsl = function() {
        return d3_rgb_hsl(this.r, this.g, this.b);
    };
    d3_rgbPrototype.toString = function() {
        return "#" + d3_rgb_hex(this.r) + d3_rgb_hex(this.g) + d3_rgb_hex(this.b);
    };
    function d3_rgb_hex(v) {
        return v < 16 ? "0" + Math.max(0, v).toString(16) : Math.min(255, v).toString(16);
    }
    function d3_rgb_parse(format, rgb, hsl) {
        var r = 0, g = 0, b = 0, m1, m2, color;
        m1 = /([a-z]+)\((.*)\)/i.exec(format);
        if (m1) {
            m2 = m1[2].split(",");
            switch (m1[1]) {
                case "hsl":
                {
                    return hsl(parseFloat(m2[0]), parseFloat(m2[1]) / 100, parseFloat(m2[2]) / 100);
                }

                case "rgb":
                {
                    return rgb(d3_rgb_parseNumber(m2[0]), d3_rgb_parseNumber(m2[1]), d3_rgb_parseNumber(m2[2]));
                }
            }
        }
        if (color = d3_rgb_names.get(format.toLowerCase())) {
            return rgb(color.r, color.g, color.b);
        }
        if (format != null && format.charAt(0) === "#" && !isNaN(color = parseInt(format.slice(1), 16))) {
            if (format.length === 4) {
                r = (color & 3840) >> 4;
                r = r >> 4 | r;
                g = color & 240;
                g = g >> 4 | g;
                b = color & 15;
                b = b << 4 | b;
            } else if (format.length === 7) {
                r = (color & 16711680) >> 16;
                g = (color & 65280) >> 8;
                b = color & 255;
            }
        }
        return rgb(r, g, b);
    }
    function d3_rgb_hsl(r, g, b) {
        var min = Math.min(r /= 255, g /= 255, b /= 255), max = Math.max(r, g, b), d = max - min, h, s, l = (max + min) / 2;
        if (d) {
            s = l < .5 ? d / (max + min) : d / (2 - max - min);
            if (r == max) h = (g - b) / d + (g < b ? 6 : 0); else if (g == max) h = (b - r) / d + 2; else h = (r - g) / d + 4;
            h *= 60;
        } else {
            h = NaN;
            s = l > 0 && l < 1 ? 0 : h;
        }
        return new d3_hsl(h, s, l);
    }
    function d3_rgb_lab(r, g, b) {
        r = d3_rgb_xyz(r);
        g = d3_rgb_xyz(g);
        b = d3_rgb_xyz(b);
        var x = d3_xyz_lab((.4124564 * r + .3575761 * g + .1804375 * b) / d3_lab_X), y = d3_xyz_lab((.2126729 * r + .7151522 * g + .072175 * b) / d3_lab_Y), z = d3_xyz_lab((.0193339 * r + .119192 * g + .9503041 * b) / d3_lab_Z);
        return d3_lab(116 * y - 16, 500 * (x - y), 200 * (y - z));
    }
    function d3_rgb_xyz(r) {
        return (r /= 255) <= .04045 ? r / 12.92 : Math.pow((r + .055) / 1.055, 2.4);
    }
    function d3_rgb_parseNumber(c) {
        var f = parseFloat(c);
        return c.charAt(c.length - 1) === "%" ? Math.round(f * 2.55) : f;
    }
    var d3_rgb_names = d3.map({
        aliceblue: 15792383,
        antiquewhite: 16444375,
        aqua: 65535,
        aquamarine: 8388564,
        azure: 15794175,
        beige: 16119260,
        bisque: 16770244,
        black: 0,
        blanchedalmond: 16772045,
        blue: 255,
        blueviolet: 9055202,
        brown: 10824234,
        burlywood: 14596231,
        cadetblue: 6266528,
        chartreuse: 8388352,
        chocolate: 13789470,
        coral: 16744272,
        cornflowerblue: 6591981,
        cornsilk: 16775388,
        crimson: 14423100,
        cyan: 65535,
        darkblue: 139,
        darkcyan: 35723,
        darkgoldenrod: 12092939,
        darkgray: 11119017,
        darkgreen: 25600,
        darkgrey: 11119017,
        darkkhaki: 12433259,
        darkmagenta: 9109643,
        darkolivegreen: 5597999,
        darkorange: 16747520,
        darkorchid: 10040012,
        darkred: 9109504,
        darksalmon: 15308410,
        darkseagreen: 9419919,
        darkslateblue: 4734347,
        darkslategray: 3100495,
        darkslategrey: 3100495,
        darkturquoise: 52945,
        darkviolet: 9699539,
        deeppink: 16716947,
        deepskyblue: 49151,
        dimgray: 6908265,
        dimgrey: 6908265,
        dodgerblue: 2003199,
        firebrick: 11674146,
        floralwhite: 16775920,
        forestgreen: 2263842,
        fuchsia: 16711935,
        gainsboro: 14474460,
        ghostwhite: 16316671,
        gold: 16766720,
        goldenrod: 14329120,
        gray: 8421504,
        green: 32768,
        greenyellow: 11403055,
        grey: 8421504,
        honeydew: 15794160,
        hotpink: 16738740,
        indianred: 13458524,
        indigo: 4915330,
        ivory: 16777200,
        khaki: 15787660,
        lavender: 15132410,
        lavenderblush: 16773365,
        lawngreen: 8190976,
        lemonchiffon: 16775885,
        lightblue: 11393254,
        lightcoral: 15761536,
        lightcyan: 14745599,
        lightgoldenrodyellow: 16448210,
        lightgray: 13882323,
        lightgreen: 9498256,
        lightgrey: 13882323,
        lightpink: 16758465,
        lightsalmon: 16752762,
        lightseagreen: 2142890,
        lightskyblue: 8900346,
        lightslategray: 7833753,
        lightslategrey: 7833753,
        lightsteelblue: 11584734,
        lightyellow: 16777184,
        lime: 65280,
        limegreen: 3329330,
        linen: 16445670,
        magenta: 16711935,
        maroon: 8388608,
        mediumaquamarine: 6737322,
        mediumblue: 205,
        mediumorchid: 12211667,
        mediumpurple: 9662683,
        mediumseagreen: 3978097,
        mediumslateblue: 8087790,
        mediumspringgreen: 64154,
        mediumturquoise: 4772300,
        mediumvioletred: 13047173,
        midnightblue: 1644912,
        mintcream: 16121850,
        mistyrose: 16770273,
        moccasin: 16770229,
        navajowhite: 16768685,
        navy: 128,
        oldlace: 16643558,
        olive: 8421376,
        olivedrab: 7048739,
        orange: 16753920,
        orangered: 16729344,
        orchid: 14315734,
        palegoldenrod: 15657130,
        palegreen: 10025880,
        paleturquoise: 11529966,
        palevioletred: 14381203,
        papayawhip: 16773077,
        peachpuff: 16767673,
        peru: 13468991,
        pink: 16761035,
        plum: 14524637,
        powderblue: 11591910,
        purple: 8388736,
        rebeccapurple: 6697881,
        red: 16711680,
        rosybrown: 12357519,
        royalblue: 4286945,
        saddlebrown: 9127187,
        salmon: 16416882,
        sandybrown: 16032864,
        seagreen: 3050327,
        seashell: 16774638,
        sienna: 10506797,
        silver: 12632256,
        skyblue: 8900331,
        slateblue: 6970061,
        slategray: 7372944,
        slategrey: 7372944,
        snow: 16775930,
        springgreen: 65407,
        steelblue: 4620980,
        tan: 13808780,
        teal: 32896,
        thistle: 14204888,
        tomato: 16737095,
        turquoise: 4251856,
        violet: 15631086,
        wheat: 16113331,
        white: 16777215,
        whitesmoke: 16119285,
        yellow: 16776960,
        yellowgreen: 10145074
    });
    d3_rgb_names.forEach(function(key, value) {
        d3_rgb_names.set(key, d3_rgbNumber(value));
    });
    function d3_functor(v) {
        return typeof v === "function" ? v : function() {
            return v;
        };
    }
    d3.functor = d3_functor;
    d3.xhr = d3_xhrType(d3_identity);
    function d3_xhrType(response) {
        return function(url, mimeType, callback) {
            if (arguments.length === 2 && typeof mimeType === "function") callback = mimeType,
                mimeType = null;
            return d3_xhr(url, mimeType, response, callback);
        };
    }
    function d3_xhr(url, mimeType, response, callback) {
        var xhr = {}, dispatch = d3.dispatch("beforesend", "progress", "load", "error"), headers = {}, request = new XMLHttpRequest(), responseType = null;
        if (this.XDomainRequest && !("withCredentials" in request) && /^(http(s)?:)?\/\//.test(url)) request = new XDomainRequest();
        "onload" in request ? request.onload = request.onerror = respond : request.onreadystatechange = function() {
            request.readyState > 3 && respond();
        };
        function respond() {
            var status = request.status, result;
            if (!status && d3_xhrHasResponse(request) || status >= 200 && status < 300 || status === 304) {
                try {
                    result = response.call(xhr, request);
                } catch (e) {
                    dispatch.error.call(xhr, e);
                    return;
                }
                dispatch.load.call(xhr, result);
            } else {
                dispatch.error.call(xhr, request);
            }
        }
        request.onprogress = function(event) {
            var o = d3.event;
            d3.event = event;
            try {
                dispatch.progress.call(xhr, request);
            } finally {
                d3.event = o;
            }
        };
        xhr.header = function(name, value) {
            name = (name + "").toLowerCase();
            if (arguments.length < 2) return headers[name];
            if (value == null) delete headers[name]; else headers[name] = value + "";
            return xhr;
        };
        xhr.mimeType = function(value) {
            if (!arguments.length) return mimeType;
            mimeType = value == null ? null : value + "";
            return xhr;
        };
        xhr.responseType = function(value) {
            if (!arguments.length) return responseType;
            responseType = value;
            return xhr;
        };
        xhr.response = function(value) {
            response = value;
            return xhr;
        };
        [ "get", "post" ].forEach(function(method) {
            xhr[method] = function() {
                return xhr.send.apply(xhr, [ method ].concat(d3_array(arguments)));
            };
        });
        xhr.send = function(method, data, callback) {
            if (arguments.length === 2 && typeof data === "function") callback = data, data = null;
            request.open(method, url, false);
            if (mimeType != null && !("accept" in headers)) headers["accept"] = mimeType + ",*/*";
            if (request.setRequestHeader) for (var name in headers) request.setRequestHeader(name, headers[name]);
            if (mimeType != null && request.overrideMimeType) request.overrideMimeType(mimeType);
            if (responseType != null) request.responseType = responseType;
            if (callback != null) xhr.on("error", callback).on("load", function(request) {
                callback(null, request);
            });
            dispatch.beforesend.call(xhr, request);
            request.send(data == null ? null : data);
            return xhr;
        };
        xhr.abort = function() {
            request.abort();
            return xhr;
        };
        d3.rebind(xhr, dispatch, "on");
        return callback == null ? xhr : xhr.get(d3_xhr_fixCallback(callback));
    }
    function d3_xhr_fixCallback(callback) {
        return callback.length === 1 ? function(error, request) {
            callback(error == null ? request : null);
        } : callback;
    }
    function d3_xhrHasResponse(request) {
        var type = request.responseType;
        return type && type !== "text" ? request.response : request.responseText;
    }
    d3.dsv = function(delimiter, mimeType) {
        var reFormat = new RegExp('["' + delimiter + "\n]"), delimiterCode = delimiter.charCodeAt(0);
        function dsv(url, row, callback) {
            if (arguments.length < 3) callback = row, row = null;
            var xhr = d3_xhr(url, mimeType, row == null ? response : typedResponse(row), callback);
            xhr.row = function(_) {
                return arguments.length ? xhr.response((row = _) == null ? response : typedResponse(_)) : row;
            };
            return xhr;
        }
        function response(request) {
            return dsv.parse(request.responseText);
        }
        function typedResponse(f) {
            return function(request) {
                return dsv.parse(request.responseText, f);
            };
        }
        dsv.parse = function(text, f) {
            var o;
            return dsv.parseRows(text, function(row, i) {
                if (o) return o(row, i - 1);
                var a = new Function("d", "return {" + row.map(function(name, i) {
                        return JSON.stringify(name) + ": d[" + i + "]";
                    }).join(",") + "}");
                o = f ? function(row, i) {
                    return f(a(row), i);
                } : a;
            });
        };
        dsv.parseRows = function(text, f) {
            var EOL = {}, EOF = {}, rows = [], N = text.length, I = 0, n = 0, t, eol;
            function token() {
                if (I >= N) return EOF;
                if (eol) return eol = false, EOL;
                var j = I;
                if (text.charCodeAt(j) === 34) {
                    var i = j;
                    while (i++ < N) {
                        if (text.charCodeAt(i) === 34) {
                            if (text.charCodeAt(i + 1) !== 34) break;
                            ++i;
                        }
                    }
                    I = i + 2;
                    var c = text.charCodeAt(i + 1);
                    if (c === 13) {
                        eol = true;
                        if (text.charCodeAt(i + 2) === 10) ++I;
                    } else if (c === 10) {
                        eol = true;
                    }
                    return text.slice(j + 1, i).replace(/""/g, '"');
                }
                while (I < N) {
                    var c = text.charCodeAt(I++), k = 1;
                    if (c === 10) eol = true; else if (c === 13) {
                        eol = true;
                        if (text.charCodeAt(I) === 10) ++I, ++k;
                    } else if (c !== delimiterCode) continue;
                    return text.slice(j, I - k);
                }
                return text.slice(j);
            }
            while ((t = token()) !== EOF) {
                var a = [];
                while (t !== EOL && t !== EOF) {
                    a.push(t);
                    t = token();
                }
                if (f && (a = f(a, n++)) == null) continue;
                rows.push(a);
            }
            return rows;
        };
        dsv.format = function(rows) {
            if (Array.isArray(rows[0])) return dsv.formatRows(rows);
            var fieldSet = new d3_Set(), fields = [];
            rows.forEach(function(row) {
                for (var field in row) {
                    if (!fieldSet.has(field)) {
                        fields.push(fieldSet.add(field));
                    }
                }
            });
            return [ fields.map(formatValue).join(delimiter) ].concat(rows.map(function(row) {
                return fields.map(function(field) {
                    return formatValue(row[field]);
                }).join(delimiter);
            })).join("\n");
        };
        dsv.formatRows = function(rows) {
            return rows.map(formatRow).join("\n");
        };
        function formatRow(row) {
            return row.map(formatValue).join(delimiter);
        }
        function formatValue(text) {
            return reFormat.test(text) ? '"' + text.replace(/\"/g, '""') + '"' : text;
        }
        return dsv;
    };
    d3.csv = d3.dsv(",", "text/csv");
    d3.tsv = d3.dsv("	", "text/tab-separated-values");
    var d3_timer_queueHead, d3_timer_queueTail, d3_timer_interval, d3_timer_timeout, d3_timer_active, d3_timer_frame = this[d3_vendorSymbol(this, "requestAnimationFrame")] || function(callback) {
            setTimeout(callback, 17);
        };
    d3.timer = function(callback, delay, then) {
        var n = arguments.length;
        if (n < 2) delay = 0;
        if (n < 3) then = Date.now();
        var time = then + delay, timer = {
            c: callback,
            t: time,
            f: false,
            n: null
        };
        if (d3_timer_queueTail) d3_timer_queueTail.n = timer; else d3_timer_queueHead = timer;
        d3_timer_queueTail = timer;
        if (!d3_timer_interval) {
            d3_timer_timeout = clearTimeout(d3_timer_timeout);
            d3_timer_interval = 1;
            d3_timer_frame(d3_timer_step);
        }
    };
    function d3_timer_step() {
        var now = d3_timer_mark(), delay = d3_timer_sweep() - now;
        if (delay > 24) {
            if (isFinite(delay)) {
                clearTimeout(d3_timer_timeout);
                d3_timer_timeout = setTimeout(d3_timer_step, delay);
            }
            d3_timer_interval = 0;
        } else {
            d3_timer_interval = 1;
            d3_timer_frame(d3_timer_step);
        }
    }
    d3.timer.flush = function() {
        d3_timer_mark();
        d3_timer_sweep();
    };
    function d3_timer_mark() {
        var now = Date.now();
        d3_timer_active = d3_timer_queueHead;
        while (d3_timer_active) {
            if (now >= d3_timer_active.t) d3_timer_active.f = d3_timer_active.c(now - d3_timer_active.t);
            d3_timer_active = d3_timer_active.n;
        }
        return now;
    }
    function d3_timer_sweep() {
        var t0, t1 = d3_timer_queueHead, time = Infinity;
        while (t1) {
            if (t1.f) {
                t1 = t0 ? t0.n = t1.n : d3_timer_queueHead = t1.n;
            } else {
                if (t1.t < time) time = t1.t;
                t1 = (t0 = t1).n;
            }
        }
        d3_timer_queueTail = t0;
        return time;
    }
    function d3_format_precision(x, p) {
        return p - (x ? Math.ceil(Math.log(x) / Math.LN10) : 1);
    }
    d3.round = function(x, n) {
        return n ? Math.round(x * (n = Math.pow(10, n))) / n : Math.round(x);
    };
    var d3_formatPrefixes = [ "y", "z", "a", "f", "p", "n", "?", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y" ].map(d3_formatPrefix);
    d3.formatPrefix = function(value, precision) {
        var i = 0;
        if (value) {
            if (value < 0) value *= -1;
            if (precision) value = d3.round(value, d3_format_precision(value, precision));
            i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10);
            i = Math.max(-24, Math.min(24, Math.floor((i - 1) / 3) * 3));
        }
        return d3_formatPrefixes[8 + i / 3];
    };
    function d3_formatPrefix(d, i) {
        var k = Math.pow(10, abs(8 - i) * 3);
        return {
            scale: i > 8 ? function(d) {
                return d / k;
            } : function(d) {
                return d * k;
            },
            symbol: d
        };
    }
    function d3_locale_numberFormat(locale) {
        var locale_decimal = locale.decimal, locale_thousands = locale.thousands, locale_grouping = locale.grouping, locale_currency = locale.currency, formatGroup = locale_grouping && locale_thousands ? function(value, width) {
            var i = value.length, t = [], j = 0, g = locale_grouping[0], length = 0;
            while (i > 0 && g > 0) {
                if (length + g + 1 > width) g = Math.max(1, width - length);
                t.push(value.substring(i -= g, i + g));
                if ((length += g + 1) > width) break;
                g = locale_grouping[j = (j + 1) % locale_grouping.length];
            }
            return t.reverse().join(locale_thousands);
        } : d3_identity;
        return function(specifier) {
            var match = d3_format_re.exec(specifier), fill = match[1] || " ", align = match[2] || ">", sign = match[3] || "-", symbol = match[4] || "", zfill = match[5], width = +match[6], comma = match[7], precision = match[8], type = match[9], scale = 1, prefix = "", suffix = "", integer = false, exponent = true;
            if (precision) precision = +precision.substring(1);
            if (zfill || fill === "0" && align === "=") {
                zfill = fill = "0";
                align = "=";
            }
            switch (type) {
                case "n":
                    comma = true;
                    type = "g";
                    break;

                case "%":
                    scale = 100;
                    suffix = "%";
                    type = "f";
                    break;

                case "p":
                    scale = 100;
                    suffix = "%";
                    type = "r";
                    break;

                case "b":
                case "o":
                case "x":
                case "X":
                    if (symbol === "#") prefix = "0" + type.toLowerCase();

                case "c":
                    exponent = false;

                case "d":
                    integer = true;
                    precision = 0;
                    break;

                case "s":
                    scale = -1;
                    type = "r";
                    break;
            }
            if (symbol === "$") prefix = locale_currency[0], suffix = locale_currency[1];
            if (type == "r" && !precision) type = "g";
            if (precision != null) {
                if (type == "g") precision = Math.max(1, Math.min(21, precision)); else if (type == "e" || type == "f") precision = Math.max(0, Math.min(20, precision));
            }
            type = d3_format_types.get(type) || d3_format_typeDefault;
            var zcomma = zfill && comma;
            return function(value) {
                var fullSuffix = suffix;
                if (integer && value % 1) return "";
                var negative = value < 0 || value === 0 && 1 / value < 0 ? (value = -value, "-") : sign === "-" ? "" : sign;
                if (scale < 0) {
                    var unit = d3.formatPrefix(value, precision);
                    value = unit.scale(value);
                    fullSuffix = unit.symbol + suffix;
                } else {
                    value *= scale;
                }
                value = type(value, precision);
                var i = value.lastIndexOf("."), before, after;
                if (i < 0) {
                    var j = exponent ? value.lastIndexOf("e") : -1;
                    if (j < 0) before = value, after = ""; else before = value.substring(0, j), after = value.substring(j);
                } else {
                    before = value.substring(0, i);
                    after = locale_decimal + value.substring(i + 1);
                }
                if (!zfill && comma) before = formatGroup(before, Infinity);
                var length = prefix.length + before.length + after.length + (zcomma ? 0 : negative.length), padding = length < width ? new Array(length = width - length + 1).join(fill) : "";
                if (zcomma) before = formatGroup(padding + before, padding.length ? width - after.length : Infinity);
                negative += prefix;
                value = before + after;
                return (align === "<" ? negative + value + padding : align === ">" ? padding + negative + value : align === "^" ? padding.substring(0, length >>= 1) + negative + value + padding.substring(length) : negative + (zcomma ? value : padding + value)) + fullSuffix;
            };
        };
    }
    var d3_format_re = /(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;
    var d3_format_types = d3.map({
        b: function(x) {
            return x.toString(2);
        },
        c: function(x) {
            return String.fromCharCode(x);
        },
        o: function(x) {
            return x.toString(8);
        },
        x: function(x) {
            return x.toString(16);
        },
        X: function(x) {
            return x.toString(16).toUpperCase();
        },
        g: function(x, p) {
            return x.toPrecision(p);
        },
        e: function(x, p) {
            return x.toExponential(p);
        },
        f: function(x, p) {
            return x.toFixed(p);
        },
        r: function(x, p) {
            return (x = d3.round(x, d3_format_precision(x, p))).toFixed(Math.max(0, Math.min(20, d3_format_precision(x * (1 + 1e-15), p))));
        }
    });
    function d3_format_typeDefault(x) {
        return x + "";
    }
    var d3_time = d3.time = {}, d3_date = Date;
    function d3_date_utc() {
        this._ = new Date(arguments.length > 1 ? Date.UTC.apply(this, arguments) : arguments[0]);
    }
    d3_date_utc.prototype = {
        getDate: function() {
            return this._.getUTCDate();
        },
        getDay: function() {
            return this._.getUTCDay();
        },
        getFullYear: function() {
            return this._.getUTCFullYear();
        },
        getHours: function() {
            return this._.getUTCHours();
        },
        getMilliseconds: function() {
            return this._.getUTCMilliseconds();
        },
        getMinutes: function() {
            return this._.getUTCMinutes();
        },
        getMonth: function() {
            return this._.getUTCMonth();
        },
        getSeconds: function() {
            return this._.getUTCSeconds();
        },
        getTime: function() {
            return this._.getTime();
        },
        getTimezoneOffset: function() {
            return 0;
        },
        valueOf: function() {
            return this._.valueOf();
        },
        setDate: function() {
            d3_time_prototype.setUTCDate.apply(this._, arguments);
        },
        setDay: function() {
            d3_time_prototype.setUTCDay.apply(this._, arguments);
        },
        setFullYear: function() {
            d3_time_prototype.setUTCFullYear.apply(this._, arguments);
        },
        setHours: function() {
            d3_time_prototype.setUTCHours.apply(this._, arguments);
        },
        setMilliseconds: function() {
            d3_time_prototype.setUTCMilliseconds.apply(this._, arguments);
        },
        setMinutes: function() {
            d3_time_prototype.setUTCMinutes.apply(this._, arguments);
        },
        setMonth: function() {
            d3_time_prototype.setUTCMonth.apply(this._, arguments);
        },
        setSeconds: function() {
            d3_time_prototype.setUTCSeconds.apply(this._, arguments);
        },
        setTime: function() {
            d3_time_prototype.setTime.apply(this._, arguments);
        }
    };
    var d3_time_prototype = Date.prototype;
    function d3_time_interval(local, step, number) {
        function round(date) {
            var d0 = local(date), d1 = offset(d0, 1);
            return date - d0 < d1 - date ? d0 : d1;
        }
        function ceil(date) {
            step(date = local(new d3_date(date - 1)), 1);
            return date;
        }
        function offset(date, k) {
            step(date = new d3_date(+date), k);
            return date;
        }
        function range(t0, t1, dt) {
            var time = ceil(t0), times = [];
            if (dt > 1) {
                while (time < t1) {
                    if (!(number(time) % dt)) times.push(new Date(+time));
                    step(time, 1);
                }
            } else {
                while (time < t1) times.push(new Date(+time)), step(time, 1);
            }
            return times;
        }
        function range_utc(t0, t1, dt) {
            try {
                d3_date = d3_date_utc;
                var utc = new d3_date_utc();
                utc._ = t0;
                return range(utc, t1, dt);
            } finally {
                d3_date = Date;
            }
        }
        local.floor = local;
        local.round = round;
        local.ceil = ceil;
        local.offset = offset;
        local.range = range;
        var utc = local.utc = d3_time_interval_utc(local);
        utc.floor = utc;
        utc.round = d3_time_interval_utc(round);
        utc.ceil = d3_time_interval_utc(ceil);
        utc.offset = d3_time_interval_utc(offset);
        utc.range = range_utc;
        return local;
    }
    function d3_time_interval_utc(method) {
        return function(date, k) {
            try {
                d3_date = d3_date_utc;
                var utc = new d3_date_utc();
                utc._ = date;
                return method(utc, k)._;
            } finally {
                d3_date = Date;
            }
        };
    }
    d3_time.year = d3_time_interval(function(date) {
        date = d3_time.day(date);
        date.setMonth(0, 1);
        return date;
    }, function(date, offset) {
        date.setFullYear(date.getFullYear() + offset);
    }, function(date) {
        return date.getFullYear();
    });
    d3_time.years = d3_time.year.range;
    d3_time.years.utc = d3_time.year.utc.range;
    d3_time.day = d3_time_interval(function(date) {
        var day = new d3_date(2e3, 0);
        day.setFullYear(date.getFullYear(), date.getMonth(), date.getDate());
        return day;
    }, function(date, offset) {
        date.setDate(date.getDate() + offset);
    }, function(date) {
        return date.getDate() - 1;
    });
    d3_time.days = d3_time.day.range;
    d3_time.days.utc = d3_time.day.utc.range;
    d3_time.dayOfYear = function(date) {
        var year = d3_time.year(date);
        return Math.floor((date - year - (date.getTimezoneOffset() - year.getTimezoneOffset()) * 6e4) / 864e5);
    };
    [ "sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday" ].forEach(function(day, i) {
        i = 7 - i;
        var interval = d3_time[day] = d3_time_interval(function(date) {
            (date = d3_time.day(date)).setDate(date.getDate() - (date.getDay() + i) % 7);
            return date;
        }, function(date, offset) {
            date.setDate(date.getDate() + Math.floor(offset) * 7);
        }, function(date) {
            var day = d3_time.year(date).getDay();
            return Math.floor((d3_time.dayOfYear(date) + (day + i) % 7) / 7) - (day !== i);
        });
        d3_time[day + "s"] = interval.range;
        d3_time[day + "s"].utc = interval.utc.range;
        d3_time[day + "OfYear"] = function(date) {
            var day = d3_time.year(date).getDay();
            return Math.floor((d3_time.dayOfYear(date) + (day + i) % 7) / 7);
        };
    });
    d3_time.week = d3_time.sunday;
    d3_time.weeks = d3_time.sunday.range;
    d3_time.weeks.utc = d3_time.sunday.utc.range;
    d3_time.weekOfYear = d3_time.sundayOfYear;
    function d3_locale_timeFormat(locale) {
        var locale_dateTime = locale.dateTime, locale_date = locale.date, locale_time = locale.time, locale_periods = locale.periods, locale_days = locale.days, locale_shortDays = locale.shortDays, locale_months = locale.months, locale_shortMonths = locale.shortMonths;
        function d3_time_format(template) {
            var n = template.length;
            function format(date) {
                var string = [], i = -1, j = 0, c, p, f;
                while (++i < n) {
                    if (template.charCodeAt(i) === 37) {
                        string.push(template.slice(j, i));
                        if ((p = d3_time_formatPads[c = template.charAt(++i)]) != null) c = template.charAt(++i);
                        if (f = d3_time_formats[c]) c = f(date, p == null ? c === "e" ? " " : "0" : p);
                        string.push(c);
                        j = i + 1;
                    }
                }
                string.push(template.slice(j, i));
                return string.join("");
            }
            format.parse = function(string) {
                var d = {
                    y: 1900,
                    m: 0,
                    d: 1,
                    H: 0,
                    M: 0,
                    S: 0,
                    L: 0,
                    Z: null
                }, i = d3_time_parse(d, template, string, 0);
                if (i != string.length) return null;
                if ("p" in d) d.H = d.H % 12 + d.p * 12;
                var localZ = d.Z != null && d3_date !== d3_date_utc, date = new (localZ ? d3_date_utc : d3_date)();
                if ("j" in d) date.setFullYear(d.y, 0, d.j); else if ("w" in d && ("W" in d || "U" in d)) {
                    date.setFullYear(d.y, 0, 1);
                    date.setFullYear(d.y, 0, "W" in d ? (d.w + 6) % 7 + d.W * 7 - (date.getDay() + 5) % 7 : d.w + d.U * 7 - (date.getDay() + 6) % 7);
                } else date.setFullYear(d.y, d.m, d.d);
                date.setHours(d.H + (d.Z / 100 | 0), d.M + d.Z % 100, d.S, d.L);
                return localZ ? date._ : date;
            };
            format.toString = function() {
                return template;
            };
            return format;
        }
        function d3_time_parse(date, template, string, j) {
            var c, p, t, i = 0, n = template.length, m = string.length;
            while (i < n) {
                if (j >= m) return -1;
                c = template.charCodeAt(i++);
                if (c === 37) {
                    t = template.charAt(i++);
                    p = d3_time_parsers[t in d3_time_formatPads ? template.charAt(i++) : t];
                    if (!p || (j = p(date, string, j)) < 0) return -1;
                } else if (c != string.charCodeAt(j++)) {
                    return -1;
                }
            }
            return j;
        }
        d3_time_format.utc = function(template) {
            var local = d3_time_format(template);
            function format(date) {
                try {
                    d3_date = d3_date_utc;
                    var utc = new d3_date();
                    utc._ = date;
                    return local(utc);
                } finally {
                    d3_date = Date;
                }
            }
            format.parse = function(string) {
                try {
                    d3_date = d3_date_utc;
                    var date = local.parse(string);
                    return date && date._;
                } finally {
                    d3_date = Date;
                }
            };
            format.toString = local.toString;
            return format;
        };
        d3_time_format.multi = d3_time_format.utc.multi = d3_time_formatMulti;
        var d3_time_periodLookup = d3.map(), d3_time_dayRe = d3_time_formatRe(locale_days), d3_time_dayLookup = d3_time_formatLookup(locale_days), d3_time_dayAbbrevRe = d3_time_formatRe(locale_shortDays), d3_time_dayAbbrevLookup = d3_time_formatLookup(locale_shortDays), d3_time_monthRe = d3_time_formatRe(locale_months), d3_time_monthLookup = d3_time_formatLookup(locale_months), d3_time_monthAbbrevRe = d3_time_formatRe(locale_shortMonths), d3_time_monthAbbrevLookup = d3_time_formatLookup(locale_shortMonths);
        locale_periods.forEach(function(p, i) {
            d3_time_periodLookup.set(p.toLowerCase(), i);
        });
        var d3_time_formats = {
            a: function(d) {
                return locale_shortDays[d.getDay()];
            },
            A: function(d) {
                return locale_days[d.getDay()];
            },
            b: function(d) {
                return locale_shortMonths[d.getMonth()];
            },
            B: function(d) {
                return locale_months[d.getMonth()];
            },
            c: d3_time_format(locale_dateTime),
            d: function(d, p) {
                return d3_time_formatPad(d.getDate(), p, 2);
            },
            e: function(d, p) {
                return d3_time_formatPad(d.getDate(), p, 2);
            },
            H: function(d, p) {
                return d3_time_formatPad(d.getHours(), p, 2);
            },
            I: function(d, p) {
                return d3_time_formatPad(d.getHours() % 12 || 12, p, 2);
            },
            j: function(d, p) {
                return d3_time_formatPad(1 + d3_time.dayOfYear(d), p, 3);
            },
            L: function(d, p) {
                return d3_time_formatPad(d.getMilliseconds(), p, 3);
            },
            m: function(d, p) {
                return d3_time_formatPad(d.getMonth() + 1, p, 2);
            },
            M: function(d, p) {
                return d3_time_formatPad(d.getMinutes(), p, 2);
            },
            p: function(d) {
                return locale_periods[+(d.getHours() >= 12)];
            },
            S: function(d, p) {
                return d3_time_formatPad(d.getSeconds(), p, 2);
            },
            U: function(d, p) {
                return d3_time_formatPad(d3_time.sundayOfYear(d), p, 2);
            },
            w: function(d) {
                return d.getDay();
            },
            W: function(d, p) {
                return d3_time_formatPad(d3_time.mondayOfYear(d), p, 2);
            },
            x: d3_time_format(locale_date),
            X: d3_time_format(locale_time),
            y: function(d, p) {
                return d3_time_formatPad(d.getFullYear() % 100, p, 2);
            },
            Y: function(d, p) {
                return d3_time_formatPad(d.getFullYear() % 1e4, p, 4);
            },
            Z: d3_time_zone,
            "%": function() {
                return "%";
            }
        };
        var d3_time_parsers = {
            a: d3_time_parseWeekdayAbbrev,
            A: d3_time_parseWeekday,
            b: d3_time_parseMonthAbbrev,
            B: d3_time_parseMonth,
            c: d3_time_parseLocaleFull,
            d: d3_time_parseDay,
            e: d3_time_parseDay,
            H: d3_time_parseHour24,
            I: d3_time_parseHour24,
            j: d3_time_parseDayOfYear,
            L: d3_time_parseMilliseconds,
            m: d3_time_parseMonthNumber,
            M: d3_time_parseMinutes,
            p: d3_time_parseAmPm,
            S: d3_time_parseSeconds,
            U: d3_time_parseWeekNumberSunday,
            w: d3_time_parseWeekdayNumber,
            W: d3_time_parseWeekNumberMonday,
            x: d3_time_parseLocaleDate,
            X: d3_time_parseLocaleTime,
            y: d3_time_parseYear,
            Y: d3_time_parseFullYear,
            Z: d3_time_parseZone,
            "%": d3_time_parseLiteralPercent
        };
        function d3_time_parseWeekdayAbbrev(date, string, i) {
            d3_time_dayAbbrevRe.lastIndex = 0;
            var n = d3_time_dayAbbrevRe.exec(string.slice(i));
            return n ? (date.w = d3_time_dayAbbrevLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
        }
        function d3_time_parseWeekday(date, string, i) {
            d3_time_dayRe.lastIndex = 0;
            var n = d3_time_dayRe.exec(string.slice(i));
            return n ? (date.w = d3_time_dayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
        }
        function d3_time_parseMonthAbbrev(date, string, i) {
            d3_time_monthAbbrevRe.lastIndex = 0;
            var n = d3_time_monthAbbrevRe.exec(string.slice(i));
            return n ? (date.m = d3_time_monthAbbrevLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
        }
        function d3_time_parseMonth(date, string, i) {
            d3_time_monthRe.lastIndex = 0;
            var n = d3_time_monthRe.exec(string.slice(i));
            return n ? (date.m = d3_time_monthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
        }
        function d3_time_parseLocaleFull(date, string, i) {
            return d3_time_parse(date, d3_time_formats.c.toString(), string, i);
        }
        function d3_time_parseLocaleDate(date, string, i) {
            return d3_time_parse(date, d3_time_formats.x.toString(), string, i);
        }
        function d3_time_parseLocaleTime(date, string, i) {
            return d3_time_parse(date, d3_time_formats.X.toString(), string, i);
        }
        function d3_time_parseAmPm(date, string, i) {
            var n = d3_time_periodLookup.get(string.slice(i, i += 2).toLowerCase());
            return n == null ? -1 : (date.p = n, i);
        }
        return d3_time_format;
    }
    var d3_time_formatPads = {
        "-": "",
        _: " ",
        "0": "0"
    }, d3_time_numberRe = /^\s*\d+/, d3_time_percentRe = /^%/;
    function d3_time_formatPad(value, fill, width) {
        var sign = value < 0 ? "-" : "", string = (sign ? -value : value) + "", length = string.length;
        return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);
    }
    function d3_time_formatRe(names) {
        return new RegExp("^(?:" + names.map(d3.requote).join("|") + ")", "i");
    }
    function d3_time_formatLookup(names) {
        var map = new d3_Map(), i = -1, n = names.length;
        while (++i < n) map.set(names[i].toLowerCase(), i);
        return map;
    }
    function d3_time_parseWeekdayNumber(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 1));
        return n ? (date.w = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseWeekNumberSunday(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i));
        return n ? (date.U = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseWeekNumberMonday(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i));
        return n ? (date.W = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseFullYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 4));
        return n ? (date.y = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.y = d3_time_expandYear(+n[0]), i + n[0].length) : -1;
    }
    function d3_time_parseZone(date, string, i) {
        return /^[+-]\d{4}$/.test(string = string.slice(i, i + 5)) ? (date.Z = -string,
        i + 5) : -1;
    }
    function d3_time_expandYear(d) {
        return d + (d > 68 ? 1900 : 2e3);
    }
    function d3_time_parseMonthNumber(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.m = n[0] - 1, i + n[0].length) : -1;
    }
    function d3_time_parseDay(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.d = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseDayOfYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 3));
        return n ? (date.j = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseHour24(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.H = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseMinutes(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.M = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseSeconds(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 2));
        return n ? (date.S = +n[0], i + n[0].length) : -1;
    }
    function d3_time_parseMilliseconds(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.slice(i, i + 3));
        return n ? (date.L = +n[0], i + n[0].length) : -1;
    }
    function d3_time_zone(d) {
        var z = d.getTimezoneOffset(), zs = z > 0 ? "-" : "+", zh = abs(z) / 60 | 0, zm = abs(z) % 60;
        return zs + d3_time_formatPad(zh, "0", 2) + d3_time_formatPad(zm, "0", 2);
    }
    function d3_time_parseLiteralPercent(date, string, i) {
        d3_time_percentRe.lastIndex = 0;
        var n = d3_time_percentRe.exec(string.slice(i, i + 1));
        return n ? i + n[0].length : -1;
    }
    function d3_time_formatMulti(formats) {
        var n = formats.length, i = -1;
        while (++i < n) formats[i][0] = this(formats[i][0]);
        return function(date) {
            var i = 0, f = formats[i];
            while (!f[1](date)) f = formats[++i];
            return f[0](date);
        };
    }
    d3.locale = function(locale) {
        return {
            numberFormat: d3_locale_numberFormat(locale),
            timeFormat: d3_locale_timeFormat(locale)
        };
    };
    var d3_locale_enUS = d3.locale({
        decimal: ".",
        thousands: ",",
        grouping: [ 3 ],
        currency: [ "$", "" ],
        dateTime: "%a %b %e %X %Y",
        date: "%m/%d/%Y",
        time: "%H:%M:%S",
        periods: [ "AM", "PM" ],
        days: [ "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday" ],
        shortDays: [ "Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat" ],
        months: [ "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December" ],
        shortMonths: [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ]
    });
    d3.format = d3_locale_enUS.numberFormat;
    d3.geo = {};
    function d3_adder() {}
    d3_adder.prototype = {
        s: 0,
        t: 0,
        add: function(y) {
            d3_adderSum(y, this.t, d3_adderTemp);
            d3_adderSum(d3_adderTemp.s, this.s, this);
            if (this.s) this.t += d3_adderTemp.t; else this.s = d3_adderTemp.t;
        },
        reset: function() {
            this.s = this.t = 0;
        },
        valueOf: function() {
            return this.s;
        }
    };
    var d3_adderTemp = new d3_adder();
    function d3_adderSum(a, b, o) {
        var x = o.s = a + b, bv = x - a, av = x - bv;
        o.t = a - av + (b - bv);
    }
    d3.geo.stream = function(object, listener) {
        if (object && d3_geo_streamObjectType.hasOwnProperty(object.type)) {
            d3_geo_streamObjectType[object.type](object, listener);
        } else {
            d3_geo_streamGeometry(object, listener);
        }
    };
    function d3_geo_streamGeometry(geometry, listener) {
        if (geometry && d3_geo_streamGeometryType.hasOwnProperty(geometry.type)) {
            d3_geo_streamGeometryType[geometry.type](geometry, listener);
        }
    }
    var d3_geo_streamObjectType = {
        Feature: function(feature, listener) {
            d3_geo_streamGeometry(feature.geometry, listener);
        },
        FeatureCollection: function(object, listener) {
            var features = object.features, i = -1, n = features.length;
            while (++i < n) d3_geo_streamGeometry(features[i].geometry, listener);
        }
    };
    var d3_geo_streamGeometryType = {
        Sphere: function(object, listener) {
            listener.sphere();
        },
        Point: function(object, listener) {
            object = object.coordinates;
            listener.point(object[0], object[1], object[2]);
        },
        MultiPoint: function(object, listener) {
            var coordinates = object.coordinates, i = -1, n = coordinates.length;
            while (++i < n) object = coordinates[i], listener.point(object[0], object[1], object[2]);
        },
        LineString: function(object, listener) {
            d3_geo_streamLine(object.coordinates, listener, 0);
        },
        MultiLineString: function(object, listener) {
            var coordinates = object.coordinates, i = -1, n = coordinates.length;
            while (++i < n) d3_geo_streamLine(coordinates[i], listener, 0);
        },
        Polygon: function(object, listener) {
            d3_geo_streamPolygon(object.coordinates, listener);
        },
        MultiPolygon: function(object, listener) {
            var coordinates = object.coordinates, i = -1, n = coordinates.length;
            while (++i < n) d3_geo_streamPolygon(coordinates[i], listener);
        },
        GeometryCollection: function(object, listener) {
            var geometries = object.geometries, i = -1, n = geometries.length;
            while (++i < n) d3_geo_streamGeometry(geometries[i], listener);
        }
    };
    function d3_geo_streamLine(coordinates, listener, closed) {
        var i = -1, n = coordinates.length - closed, coordinate;
        listener.lineStart();
        while (++i < n) coordinate = coordinates[i], listener.point(coordinate[0], coordinate[1], coordinate[2]);
        listener.lineEnd();
    }
    function d3_geo_streamPolygon(coordinates, listener) {
        var i = -1, n = coordinates.length;
        listener.polygonStart();
        while (++i < n) d3_geo_streamLine(coordinates[i], listener, 1);
        listener.polygonEnd();
    }
    d3.geo.area = function(object) {
        d3_geo_areaSum = 0;
        d3.geo.stream(object, d3_geo_area);
        return d3_geo_areaSum;
    };
    var d3_geo_areaSum, d3_geo_areaRingSum = new d3_adder();
    var d3_geo_area = {
        sphere: function() {
            d3_geo_areaSum += 4 * ;
        },
        point: d3_noop,
        lineStart: d3_noop,
        lineEnd: d3_noop,
        polygonStart: function() {
            d3_geo_areaRingSum.reset();
            d3_geo_area.lineStart = d3_geo_areaRingStart;
        },
        polygonEnd: function() {
            var area = 2 * d3_geo_areaRingSum;
            d3_geo_areaSum += area < 0 ? 4 *  + area : area;
            d3_geo_area.lineStart = d3_geo_area.lineEnd = d3_geo_area.point = d3_noop;
        }
    };
    function d3_geo_areaRingStart() {
        var 00, 00, 0, cos0, sin0;
        d3_geo_area.point = function(, ) {
            d3_geo_area.point = nextPoint;
            0 = (00 = ) * d3_radians, cos0 = Math.cos( = (00 = ) * d3_radians / 2 +  / 4),
                sin0 = Math.sin();
        };
        function nextPoint(, ) {
             *= d3_radians;
             =  * d3_radians / 2 +  / 4;
            var d =  - 0, sd = d >= 0 ? 1 : -1, ad = sd * d, cos = Math.cos(), sin = Math.sin(), k = sin0 * sin, u = cos0 * cos + k * Math.cos(ad), v = k * sd * Math.sin(ad);
            d3_geo_areaRingSum.add(Math.atan2(v, u));
            0 = , cos0 = cos, sin0 = sin;
        }
        d3_geo_area.lineEnd = function() {
            nextPoint(00, 00);
        };
    }
    function d3_geo_cartesian(spherical) {
        var  = spherical[0],  = spherical[1], cos = Math.cos();
        return [ cos * Math.cos(), cos * Math.sin(), Math.sin() ];
    }
    function d3_geo_cartesianDot(a, b) {
        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
    }
    function d3_geo_cartesianCross(a, b) {
        return [ a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0] ];
    }
    function d3_geo_cartesianAdd(a, b) {
        a[0] += b[0];
        a[1] += b[1];
        a[2] += b[2];
    }
    function d3_geo_cartesianScale(vector, k) {
        return [ vector[0] * k, vector[1] * k, vector[2] * k ];
    }
    function d3_geo_cartesianNormalize(d) {
        var l = Math.sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);
        d[0] /= l;
        d[1] /= l;
        d[2] /= l;
    }
    function d3_geo_spherical(cartesian) {
        return [ Math.atan2(cartesian[1], cartesian[0]), d3_asin(cartesian[2]) ];
    }
    function d3_geo_sphericalEqual(a, b) {
        return abs(a[0] - b[0]) <  && abs(a[1] - b[1]) < ;
    }
    d3.geo.bounds = function() {
        var 0, 0, 1, 1, _, __, __, p0, dSum, ranges, range;
        var bound = {
            point: point,
            lineStart: lineStart,
            lineEnd: lineEnd,
            polygonStart: function() {
                bound.point = ringPoint;
                bound.lineStart = ringStart;
                bound.lineEnd = ringEnd;
                dSum = 0;
                d3_geo_area.polygonStart();
            },
            polygonEnd: function() {
                d3_geo_area.polygonEnd();
                bound.point = point;
                bound.lineStart = lineStart;
                bound.lineEnd = lineEnd;
                range[0] = 0, range[1] = 1;
            }
        };
        function point(, ) {
            ranges.push(range = [ 0 = , 1 =  ]);
            if ( < 0) 0 = ;
            if ( > 1) 1 = ;
        }
        function linePoint(, ) {
            var p = d3_geo_cartesian([  * d3_radians,  * d3_radians ]);
            if (p0) {
                var normal = d3_geo_cartesianCross(p0, p), equatorial = [ normal[1], -normal[0], 0 ], inflection = d3_geo_cartesianCross(equatorial, normal);
                d3_geo_cartesianNormalize(inflection);
                inflection = d3_geo_spherical(inflection);
                var d =  - _, s = d > 0 ? 1 : -1, i = inflection[0] * d3_degrees * s, antimeridian = abs(d) > 180;
                if (antimeridian ^ (s * _ < i && i < s * )) {
                    var i = inflection[1] * d3_degrees;
                    if (i > 1) 1 = i;
                } else if (i = (i + 360) % 360 - 180, antimeridian ^ (s * _ < i && i < s * )) {
                    var i = -inflection[1] * d3_degrees;
                    if (i < 0) 0 = i;
                } else {
                    if ( < 0) 0 = ;
                    if ( > 1) 1 = ;
                }
                if (antimeridian) {
                    if ( < _) {
                        if (angle(0, ) > angle(0, 1)) 1 = ;
                    } else {
                        if (angle(, 1) > angle(0, 1)) 0 = ;
                    }
                } else {
                    if (1 >= 0) {
                        if ( < 0) 0 = ;
                        if ( > 1) 1 = ;
                    } else {
                        if ( > _) {
                            if (angle(0, ) > angle(0, 1)) 1 = ;
                        } else {
                            if (angle(, 1) > angle(0, 1)) 0 = ;
                        }
                    }
                }
            } else {
                point(, );
            }
            p0 = p, _ = ;
        }
        function lineStart() {
            bound.point = linePoint;
        }
        function lineEnd() {
            range[0] = 0, range[1] = 1;
            bound.point = point;
            p0 = null;
        }
        function ringPoint(, ) {
            if (p0) {
                var d =  - _;
                dSum += abs(d) > 180 ? d + (d > 0 ? 360 : -360) : d;
            } else __ = , __ = ;
            d3_geo_area.point(, );
            linePoint(, );
        }
        function ringStart() {
            d3_geo_area.lineStart();
        }
        function ringEnd() {
            ringPoint(__, __);
            d3_geo_area.lineEnd();
            if (abs(dSum) > ) 0 = -(1 = 180);
            range[0] = 0, range[1] = 1;
            p0 = null;
        }
        function angle(0, 1) {
            return (1 -= 0) < 0 ? 1 + 360 : 1;
        }
        function compareRanges(a, b) {
            return a[0] - b[0];
        }
        function withinRange(x, range) {
            return range[0] <= range[1] ? range[0] <= x && x <= range[1] : x < range[0] || range[1] < x;
        }
        return function(feature) {
            1 = 1 = -(0 = 0 = Infinity);
            ranges = [];
            d3.geo.stream(feature, bound);
            var n = ranges.length;
            if (n) {
                ranges.sort(compareRanges);
                for (var i = 1, a = ranges[0], b, merged = [ a ]; i < n; ++i) {
                    b = ranges[i];
                    if (withinRange(b[0], a) || withinRange(b[1], a)) {
                        if (angle(a[0], b[1]) > angle(a[0], a[1])) a[1] = b[1];
                        if (angle(b[0], a[1]) > angle(a[0], a[1])) a[0] = b[0];
                    } else {
                        merged.push(a = b);
                    }
                }
                var best = -Infinity, d;
                for (var n = merged.length - 1, i = 0, a = merged[n], b; i <= n; a = b, ++i) {
                    b = merged[i];
                    if ((d = angle(a[1], b[0])) > best) best = d, 0 = b[0], 1 = a[1];
                }
            }
            ranges = range = null;
            return 0 === Infinity || 0 === Infinity ? [ [ NaN, NaN ], [ NaN, NaN ] ] : [ [ 0, 0 ], [ 1, 1 ] ];
        };
    }();
    d3.geo.centroid = function(object) {
        d3_geo_centroidW0 = d3_geo_centroidW1 = d3_geo_centroidX0 = d3_geo_centroidY0 = d3_geo_centroidZ0 = d3_geo_centroidX1 = d3_geo_centroidY1 = d3_geo_centroidZ1 = d3_geo_centroidX2 = d3_geo_centroidY2 = d3_geo_centroidZ2 = 0;
        d3.geo.stream(object, d3_geo_centroid);
        var x = d3_geo_centroidX2, y = d3_geo_centroidY2, z = d3_geo_centroidZ2, m = x * x + y * y + z * z;
        if (m < 2) {
            x = d3_geo_centroidX1, y = d3_geo_centroidY1, z = d3_geo_centroidZ1;
            if (d3_geo_centroidW1 < ) x = d3_geo_centroidX0, y = d3_geo_centroidY0, z = d3_geo_centroidZ0;
            m = x * x + y * y + z * z;
            if (m < 2) return [ NaN, NaN ];
        }
        return [ Math.atan2(y, x) * d3_degrees, d3_asin(z / Math.sqrt(m)) * d3_degrees ];
    };
    var d3_geo_centroidW0, d3_geo_centroidW1, d3_geo_centroidX0, d3_geo_centroidY0, d3_geo_centroidZ0, d3_geo_centroidX1, d3_geo_centroidY1, d3_geo_centroidZ1, d3_geo_centroidX2, d3_geo_centroidY2, d3_geo_centroidZ2;
    var d3_geo_centroid = {
        sphere: d3_noop,
        point: d3_geo_centroidPoint,
        lineStart: d3_geo_centroidLineStart,
        lineEnd: d3_geo_centroidLineEnd,
        polygonStart: function() {
            d3_geo_centroid.lineStart = d3_geo_centroidRingStart;
        },
        polygonEnd: function() {
            d3_geo_centroid.lineStart = d3_geo_centroidLineStart;
        }
    };
    function d3_geo_centroidPoint(, ) {
         *= d3_radians;
        var cos = Math.cos( *= d3_radians);
        d3_geo_centroidPointXYZ(cos * Math.cos(), cos * Math.sin(), Math.sin());
    }
    function d3_geo_centroidPointXYZ(x, y, z) {
        ++d3_geo_centroidW0;
        d3_geo_centroidX0 += (x - d3_geo_centroidX0) / d3_geo_centroidW0;
        d3_geo_centroidY0 += (y - d3_geo_centroidY0) / d3_geo_centroidW0;
        d3_geo_centroidZ0 += (z - d3_geo_centroidZ0) / d3_geo_centroidW0;
    }
    function d3_geo_centroidLineStart() {
        var x0, y0, z0;
        d3_geo_centroid.point = function(, ) {
             *= d3_radians;
            var cos = Math.cos( *= d3_radians);
            x0 = cos * Math.cos();
            y0 = cos * Math.sin();
            z0 = Math.sin();
            d3_geo_centroid.point = nextPoint;
            d3_geo_centroidPointXYZ(x0, y0, z0);
        };
        function nextPoint(, ) {
             *= d3_radians;
            var cos = Math.cos( *= d3_radians), x = cos * Math.cos(), y = cos * Math.sin(), z = Math.sin(), w = Math.atan2(Math.sqrt((w = y0 * z - z0 * y) * w + (w = z0 * x - x0 * z) * w + (w = x0 * y - y0 * x) * w), x0 * x + y0 * y + z0 * z);
            d3_geo_centroidW1 += w;
            d3_geo_centroidX1 += w * (x0 + (x0 = x));
            d3_geo_centroidY1 += w * (y0 + (y0 = y));
            d3_geo_centroidZ1 += w * (z0 + (z0 = z));
            d3_geo_centroidPointXYZ(x0, y0, z0);
        }
    }
    function d3_geo_centroidLineEnd() {
        d3_geo_centroid.point = d3_geo_centroidPoint;
    }
    function d3_geo_centroidRingStart() {
        var 00, 00, x0, y0, z0;
        d3_geo_centroid.point = function(, ) {
            00 = , 00 = ;
            d3_geo_centroid.point = nextPoint;
             *= d3_radians;
            var cos = Math.cos( *= d3_radians);
            x0 = cos * Math.cos();
            y0 = cos * Math.sin();
            z0 = Math.sin();
            d3_geo_centroidPointXYZ(x0, y0, z0);
        };
        d3_geo_centroid.lineEnd = function() {
            nextPoint(00, 00);
            d3_geo_centroid.lineEnd = d3_geo_centroidLineEnd;
            d3_geo_centroid.point = d3_geo_centroidPoint;
        };
        function nextPoint(, ) {
             *= d3_radians;
            var cos = Math.cos( *= d3_radians), x = cos * Math.cos(), y = cos * Math.sin(), z = Math.sin(), cx = y0 * z - z0 * y, cy = z0 * x - x0 * z, cz = x0 * y - y0 * x, m = Math.sqrt(cx * cx + cy * cy + cz * cz), u = x0 * x + y0 * y + z0 * z, v = m && -d3_acos(u) / m, w = Math.atan2(m, u);
            d3_geo_centroidX2 += v * cx;
            d3_geo_centroidY2 += v * cy;
            d3_geo_centroidZ2 += v * cz;
            d3_geo_centroidW1 += w;
            d3_geo_centroidX1 += w * (x0 + (x0 = x));
            d3_geo_centroidY1 += w * (y0 + (y0 = y));
            d3_geo_centroidZ1 += w * (z0 + (z0 = z));
            d3_geo_centroidPointXYZ(x0, y0, z0);
        }
    }
    function d3_geo_compose(a, b) {
        function compose(x, y) {
            return x = a(x, y), b(x[0], x[1]);
        }
        if (a.invert && b.invert) compose.invert = function(x, y) {
            return x = b.invert(x, y), x && a.invert(x[0], x[1]);
        };
        return compose;
    }
    function d3_true() {
        return true;
    }
    function d3_geo_clipPolygon(segments, compare, clipStartInside, interpolate, listener) {
        var subject = [], clip = [];
        segments.forEach(function(segment) {
            if ((n = segment.length - 1) <= 0) return;
            var n, p0 = segment[0], p1 = segment[n];
            if (d3_geo_sphericalEqual(p0, p1)) {
                listener.lineStart();
                for (var i = 0; i < n; ++i) listener.point((p0 = segment[i])[0], p0[1]);
                listener.lineEnd();
                return;
            }
            var a = new d3_geo_clipPolygonIntersection(p0, segment, null, true), b = new d3_geo_clipPolygonIntersection(p0, null, a, false);
            a.o = b;
            subject.push(a);
            clip.push(b);
            a = new d3_geo_clipPolygonIntersection(p1, segment, null, false);
            b = new d3_geo_clipPolygonIntersection(p1, null, a, true);
            a.o = b;
            subject.push(a);
            clip.push(b);
        });
        clip.sort(compare);
        d3_geo_clipPolygonLinkCircular(subject);
        d3_geo_clipPolygonLinkCircular(clip);
        if (!subject.length) return;
        for (var i = 0, entry = clipStartInside, n = clip.length; i < n; ++i) {
            clip[i].e = entry = !entry;
        }
        var start = subject[0], points, point;
        while (1) {
            var current = start, isSubject = true;
            while (current.v) if ((current = current.n) === start) return;
            points = current.z;
            listener.lineStart();
            do {
                current.v = current.o.v = true;
                if (current.e) {
                    if (isSubject) {
                        for (var i = 0, n = points.length; i < n; ++i) listener.point((point = points[i])[0], point[1]);
                    } else {
                        interpolate(current.x, current.n.x, 1, listener);
                    }
                    current = current.n;
                } else {
                    if (isSubject) {
                        points = current.p.z;
                        for (var i = points.length - 1; i >= 0; --i) listener.point((point = points[i])[0], point[1]);
                    } else {
                        interpolate(current.x, current.p.x, -1, listener);
                    }
                    current = current.p;
                }
                current = current.o;
                points = current.z;
                isSubject = !isSubject;
            } while (!current.v);
            listener.lineEnd();
        }
    }
    function d3_geo_clipPolygonLinkCircular(array) {
        if (!(n = array.length)) return;
        var n, i = 0, a = array[0], b;
        while (++i < n) {
            a.n = b = array[i];
            b.p = a;
            a = b;
        }
        a.n = b = array[0];
        b.p = a;
    }
    function d3_geo_clipPolygonIntersection(point, points, other, entry) {
        this.x = point;
        this.z = points;
        this.o = other;
        this.e = entry;
        this.v = false;
        this.n = this.p = null;
    }
    function d3_geo_clip(pointVisible, clipLine, interpolate, clipStart) {
        return function(rotate, listener) {
            var line = clipLine(listener), rotatedClipStart = rotate.invert(clipStart[0], clipStart[1]);
            var clip = {
                point: point,
                lineStart: lineStart,
                lineEnd: lineEnd,
                polygonStart: function() {
                    clip.point = pointRing;
                    clip.lineStart = ringStart;
                    clip.lineEnd = ringEnd;
                    segments = [];
                    polygon = [];
                },
                polygonEnd: function() {
                    clip.point = point;
                    clip.lineStart = lineStart;
                    clip.lineEnd = lineEnd;
                    segments = d3.merge(segments);
                    var clipStartInside = d3_geo_pointInPolygon(rotatedClipStart, polygon);
                    if (segments.length) {
                        if (!polygonStarted) listener.polygonStart(), polygonStarted = true;
                        d3_geo_clipPolygon(segments, d3_geo_clipSort, clipStartInside, interpolate, listener);
                    } else if (clipStartInside) {
                        if (!polygonStarted) listener.polygonStart(), polygonStarted = true;
                        listener.lineStart();
                        interpolate(null, null, 1, listener);
                        listener.lineEnd();
                    }
                    if (polygonStarted) listener.polygonEnd(), polygonStarted = false;
                    segments = polygon = null;
                },
                sphere: function() {
                    listener.polygonStart();
                    listener.lineStart();
                    interpolate(null, null, 1, listener);
                    listener.lineEnd();
                    listener.polygonEnd();
                }
            };
            function point(, ) {
                var point = rotate(, );
                if (pointVisible( = point[0],  = point[1])) listener.point(, );
            }
            function pointLine(, ) {
                var point = rotate(, );
                line.point(point[0], point[1]);
            }
            function lineStart() {
                clip.point = pointLine;
                line.lineStart();
            }
            function lineEnd() {
                clip.point = point;
                line.lineEnd();
            }
            var segments;
            var buffer = d3_geo_clipBufferListener(), ringListener = clipLine(buffer), polygonStarted = false, polygon, ring;
            function pointRing(, ) {
                ring.push([ ,  ]);
                var point = rotate(, );
                ringListener.point(point[0], point[1]);
            }
            function ringStart() {
                ringListener.lineStart();
                ring = [];
            }
            function ringEnd() {
                pointRing(ring[0][0], ring[0][1]);
                ringListener.lineEnd();
                var clean = ringListener.clean(), ringSegments = buffer.buffer(), segment, n = ringSegments.length;
                ring.pop();
                polygon.push(ring);
                ring = null;
                if (!n) return;
                if (clean & 1) {
                    segment = ringSegments[0];
                    var n = segment.length - 1, i = -1, point;
                    if (n > 0) {
                        if (!polygonStarted) listener.polygonStart(), polygonStarted = true;
                        listener.lineStart();
                        while (++i < n) listener.point((point = segment[i])[0], point[1]);
                        listener.lineEnd();
                    }
                    return;
                }
                if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));
                segments.push(ringSegments.filter(d3_geo_clipSegmentLength1));
            }
            return clip;
        };
    }
    function d3_geo_clipSegmentLength1(segment) {
        return segment.length > 1;
    }
    function d3_geo_clipBufferListener() {
        var lines = [], line;
        return {
            lineStart: function() {
                lines.push(line = []);
            },
            point: function(, ) {
                line.push([ ,  ]);
            },
            lineEnd: d3_noop,
            buffer: function() {
                var buffer = lines;
                lines = [];
                line = null;
                return buffer;
            },
            rejoin: function() {
                if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));
            }
        };
    }
    function d3_geo_clipSort(a, b) {
        return ((a = a.x)[0] < 0 ? a[1] - half -  : half - a[1]) - ((b = b.x)[0] < 0 ? b[1] - half -  : half - b[1]);
    }
    var d3_geo_clipAntimeridian = d3_geo_clip(d3_true, d3_geo_clipAntimeridianLine, d3_geo_clipAntimeridianInterpolate, [ -, - / 2 ]);
    function d3_geo_clipAntimeridianLine(listener) {
        var 0 = NaN, 0 = NaN, s0 = NaN, clean;
        return {
            lineStart: function() {
                listener.lineStart();
                clean = 1;
            },
            point: function(1, 1) {
                var s1 = 1 > 0 ?  : -, d = abs(1 - 0);
                if (abs(d - ) < ) {
                    listener.point(0, 0 = (0 + 1) / 2 > 0 ? half : -half);
                    listener.point(s0, 0);
                    listener.lineEnd();
                    listener.lineStart();
                    listener.point(s1, 0);
                    listener.point(1, 0);
                    clean = 0;
                } else if (s0 !== s1 && d >= ) {
                    if (abs(0 - s0) < ) 0 -= s0 * ;
                    if (abs(1 - s1) < ) 1 -= s1 * ;
                    0 = d3_geo_clipAntimeridianIntersect(0, 0, 1, 1);
                    listener.point(s0, 0);
                    listener.lineEnd();
                    listener.lineStart();
                    listener.point(s1, 0);
                    clean = 0;
                }
                listener.point(0 = 1, 0 = 1);
                s0 = s1;
            },
            lineEnd: function() {
                listener.lineEnd();
                0 = 0 = NaN;
            },
            clean: function() {
                return 2 - clean;
            }
        };
    }
    function d3_geo_clipAntimeridianIntersect(0, 0, 1, 1) {
        var cos0, cos1, sin0_1 = Math.sin(0 - 1);
        return abs(sin0_1) >  ? Math.atan((Math.sin(0) * (cos1 = Math.cos(1)) * Math.sin(1) - Math.sin(1) * (cos0 = Math.cos(0)) * Math.sin(0)) / (cos0 * cos1 * sin0_1)) : (0 + 1) / 2;
    }
    function d3_geo_clipAntimeridianInterpolate(from, to, direction, listener) {
        var ;
        if (from == null) {
             = direction * half;
            listener.point(-, );
            listener.point(0, );
            listener.point(, );
            listener.point(, 0);
            listener.point(, -);
            listener.point(0, -);
            listener.point(-, -);
            listener.point(-, 0);
            listener.point(-, );
        } else if (abs(from[0] - to[0]) > ) {
            var s = from[0] < to[0] ?  : -;
             = direction * s / 2;
            listener.point(-s, );
            listener.point(0, );
            listener.point(s, );
        } else {
            listener.point(to[0], to[1]);
        }
    }
    function d3_geo_pointInPolygon(point, polygon) {
        var meridian = point[0], parallel = point[1], meridianNormal = [ Math.sin(meridian), -Math.cos(meridian), 0 ], polarAngle = 0, winding = 0;
        d3_geo_areaRingSum.reset();
        for (var i = 0, n = polygon.length; i < n; ++i) {
            var ring = polygon[i], m = ring.length;
            if (!m) continue;
            var point0 = ring[0], 0 = point0[0], 0 = point0[1] / 2 +  / 4, sin0 = Math.sin(0), cos0 = Math.cos(0), j = 1;
            while (true) {
                if (j === m) j = 0;
                point = ring[j];
                var  = point[0],  = point[1] / 2 +  / 4, sin = Math.sin(), cos = Math.cos(), d =  - 0, sd = d >= 0 ? 1 : -1, ad = sd * d, antimeridian = ad > , k = sin0 * sin;
                d3_geo_areaRingSum.add(Math.atan2(k * sd * Math.sin(ad), cos0 * cos + k * Math.cos(ad)));
                polarAngle += antimeridian ? d + sd *  : d;
                if (antimeridian ^ 0 >= meridian ^  >= meridian) {
                    var arc = d3_geo_cartesianCross(d3_geo_cartesian(point0), d3_geo_cartesian(point));
                    d3_geo_cartesianNormalize(arc);
                    var intersection = d3_geo_cartesianCross(meridianNormal, arc);
                    d3_geo_cartesianNormalize(intersection);
                    var arc = (antimeridian ^ d >= 0 ? -1 : 1) * d3_asin(intersection[2]);
                    if (parallel > arc || parallel === arc && (arc[0] || arc[1])) {
                        winding += antimeridian ^ d >= 0 ? 1 : -1;
                    }
                }
                if (!j++) break;
                0 = , sin0 = sin, cos0 = cos, point0 = point;
            }
        }
        return (polarAngle < - || polarAngle <  && d3_geo_areaRingSum < 0) ^ winding & 1;
    }
    function d3_geo_clipCircle(radius) {
        var cr = Math.cos(radius), smallRadius = cr > 0, notHemisphere = abs(cr) > , interpolate = d3_geo_circleInterpolate(radius, 6 * d3_radians);
        return d3_geo_clip(visible, clipLine, interpolate, smallRadius ? [ 0, -radius ] : [ -, radius -  ]);
        function visible(, ) {
            return Math.cos() * Math.cos() > cr;
        }
        function clipLine(listener) {
            var point0, c0, v0, v00, clean;
            return {
                lineStart: function() {
                    v00 = v0 = false;
                    clean = 1;
                },
                point: function(, ) {
                    var point1 = [ ,  ], point2, v = visible(, ), c = smallRadius ? v ? 0 : code(, ) : v ? code( + ( < 0 ?  : -), ) : 0;
                    if (!point0 && (v00 = v0 = v)) listener.lineStart();
                    if (v !== v0) {
                        point2 = intersect(point0, point1);
                        if (d3_geo_sphericalEqual(point0, point2) || d3_geo_sphericalEqual(point1, point2)) {
                            point1[0] += ;
                            point1[1] += ;
                            v = visible(point1[0], point1[1]);
                        }
                    }
                    if (v !== v0) {
                        clean = 0;
                        if (v) {
                            listener.lineStart();
                            point2 = intersect(point1, point0);
                            listener.point(point2[0], point2[1]);
                        } else {
                            point2 = intersect(point0, point1);
                            listener.point(point2[0], point2[1]);
                            listener.lineEnd();
                        }
                        point0 = point2;
                    } else if (notHemisphere && point0 && smallRadius ^ v) {
                        var t;
                        if (!(c & c0) && (t = intersect(point1, point0, true))) {
                            clean = 0;
                            if (smallRadius) {
                                listener.lineStart();
                                listener.point(t[0][0], t[0][1]);
                                listener.point(t[1][0], t[1][1]);
                                listener.lineEnd();
                            } else {
                                listener.point(t[1][0], t[1][1]);
                                listener.lineEnd();
                                listener.lineStart();
                                listener.point(t[0][0], t[0][1]);
                            }
                        }
                    }
                    if (v && (!point0 || !d3_geo_sphericalEqual(point0, point1))) {
                        listener.point(point1[0], point1[1]);
                    }
                    point0 = point1, v0 = v, c0 = c;
                },
                lineEnd: function() {
                    if (v0) listener.lineEnd();
                    point0 = null;
                },
                clean: function() {
                    return clean | (v00 && v0) << 1;
                }
            };
        }
        function intersect(a, b, two) {
            var pa = d3_geo_cartesian(a), pb = d3_geo_cartesian(b);
            var n1 = [ 1, 0, 0 ], n2 = d3_geo_cartesianCross(pa, pb), n2n2 = d3_geo_cartesianDot(n2, n2), n1n2 = n2[0], determinant = n2n2 - n1n2 * n1n2;
            if (!determinant) return !two && a;
            var c1 = cr * n2n2 / determinant, c2 = -cr * n1n2 / determinant, n1xn2 = d3_geo_cartesianCross(n1, n2), A = d3_geo_cartesianScale(n1, c1), B = d3_geo_cartesianScale(n2, c2);
            d3_geo_cartesianAdd(A, B);
            var u = n1xn2, w = d3_geo_cartesianDot(A, u), uu = d3_geo_cartesianDot(u, u), t2 = w * w - uu * (d3_geo_cartesianDot(A, A) - 1);
            if (t2 < 0) return;
            var t = Math.sqrt(t2), q = d3_geo_cartesianScale(u, (-w - t) / uu);
            d3_geo_cartesianAdd(q, A);
            q = d3_geo_spherical(q);
            if (!two) return q;
            var 0 = a[0], 1 = b[0], 0 = a[1], 1 = b[1], z;
            if (1 < 0) z = 0, 0 = 1, 1 = z;
            var  = 1 - 0, polar = abs( - ) < , meridian = polar ||  < ;
            if (!polar && 1 < 0) z = 0, 0 = 1, 1 = z;
            if (meridian ? polar ? 0 + 1 > 0 ^ q[1] < (abs(q[0] - 0) <  ? 0 : 1) : 0 <= q[1] && q[1] <= 1 :  >  ^ (0 <= q[0] && q[0] <= 1)) {
                var q1 = d3_geo_cartesianScale(u, (-w + t) / uu);
                d3_geo_cartesianAdd(q1, A);
                return [ q, d3_geo_spherical(q1) ];
            }
        }
        function code(, ) {
            var r = smallRadius ? radius :  - radius, code = 0;
            if ( < -r) code |= 1; else if ( > r) code |= 2;
            if ( < -r) code |= 4; else if ( > r) code |= 8;
            return code;
        }
    }
    function d3_geom_clipLine(x0, y0, x1, y1) {
        return function(line) {
            var a = line.a, b = line.b, ax = a.x, ay = a.y, bx = b.x, by = b.y, t0 = 0, t1 = 1, dx = bx - ax, dy = by - ay, r;
            r = x0 - ax;
            if (!dx && r > 0) return;
            r /= dx;
            if (dx < 0) {
                if (r < t0) return;
                if (r < t1) t1 = r;
            } else if (dx > 0) {
                if (r > t1) return;
                if (r > t0) t0 = r;
            }
            r = x1 - ax;
            if (!dx && r < 0) return;
            r /= dx;
            if (dx < 0) {
                if (r > t1) return;
                if (r > t0) t0 = r;
            } else if (dx > 0) {
                if (r < t0) return;
                if (r < t1) t1 = r;
            }
            r = y0 - ay;
            if (!dy && r > 0) return;
            r /= dy;
            if (dy < 0) {
                if (r < t0) return;
                if (r < t1) t1 = r;
            } else if (dy > 0) {
                if (r > t1) return;
                if (r > t0) t0 = r;
            }
            r = y1 - ay;
            if (!dy && r < 0) return;
            r /= dy;
            if (dy < 0) {
                if (r > t1) return;
                if (r > t0) t0 = r;
            } else if (dy > 0) {
                if (r < t0) return;
                if (r < t1) t1 = r;
            }
            if (t0 > 0) line.a = {
                x: ax + t0 * dx,
                y: ay + t0 * dy
            };
            if (t1 < 1) line.b = {
                x: ax + t1 * dx,
                y: ay + t1 * dy
            };
            return line;
        };
    }
    var d3_geo_clipExtentMAX = 1e9;
    d3.geo.clipExtent = function() {
        var x0, y0, x1, y1, stream, clip, clipExtent = {
            stream: function(output) {
                if (stream) stream.valid = false;
                stream = clip(output);
                stream.valid = true;
                return stream;
            },
            extent: function(_) {
                if (!arguments.length) return [ [ x0, y0 ], [ x1, y1 ] ];
                clip = d3_geo_clipExtent(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]);
                if (stream) stream.valid = false, stream = null;
                return clipExtent;
            }
        };
        return clipExtent.extent([ [ 0, 0 ], [ 960, 500 ] ]);
    };
    function d3_geo_clipExtent(x0, y0, x1, y1) {
        return function(listener) {
            var listener_ = listener, bufferListener = d3_geo_clipBufferListener(), clipLine = d3_geom_clipLine(x0, y0, x1, y1), segments, polygon, ring;
            var clip = {
                point: point,
                lineStart: lineStart,
                lineEnd: lineEnd,
                polygonStart: function() {
                    listener = bufferListener;
                    segments = [];
                    polygon = [];
                    clean = true;
                },
                polygonEnd: function() {
                    listener = listener_;
                    segments = d3.merge(segments);
                    var clipStartInside = insidePolygon([ x0, y1 ]), inside = clean && clipStartInside, visible = segments.length;
                    if (inside || visible) {
                        listener.polygonStart();
                        if (inside) {
                            listener.lineStart();
                            interpolate(null, null, 1, listener);
                            listener.lineEnd();
                        }
                        if (visible) {
                            d3_geo_clipPolygon(segments, compare, clipStartInside, interpolate, listener);
                        }
                        listener.polygonEnd();
                    }
                    segments = polygon = ring = null;
                }
            };
            function insidePolygon(p) {
                var wn = 0, n = polygon.length, y = p[1];
                for (var i = 0; i < n; ++i) {
                    for (var j = 1, v = polygon[i], m = v.length, a = v[0], b; j < m; ++j) {
                        b = v[j];
                        if (a[1] <= y) {
                            if (b[1] > y && d3_cross2d(a, b, p) > 0) ++wn;
                        } else {
                            if (b[1] <= y && d3_cross2d(a, b, p) < 0) --wn;
                        }
                        a = b;
                    }
                }
                return wn !== 0;
            }
            function interpolate(from, to, direction, listener) {
                var a = 0, a1 = 0;
                if (from == null || (a = corner(from, direction)) !== (a1 = corner(to, direction)) || comparePoints(from, to) < 0 ^ direction > 0) {
                    do {
                        listener.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);
                    } while ((a = (a + direction + 4) % 4) !== a1);
                } else {
                    listener.point(to[0], to[1]);
                }
            }
            function pointVisible(x, y) {
                return x0 <= x && x <= x1 && y0 <= y && y <= y1;
            }
            function point(x, y) {
                if (pointVisible(x, y)) listener.point(x, y);
            }
            var x__, y__, v__, x_, y_, v_, first, clean;
            function lineStart() {
                clip.point = linePoint;
                if (polygon) polygon.push(ring = []);
                first = true;
                v_ = false;
                x_ = y_ = NaN;
            }
            function lineEnd() {
                if (segments) {
                    linePoint(x__, y__);
                    if (v__ && v_) bufferListener.rejoin();
                    segments.push(bufferListener.buffer());
                }
                clip.point = point;
                if (v_) listener.lineEnd();
            }
            function linePoint(x, y) {
                x = Math.max(-d3_geo_clipExtentMAX, Math.min(d3_geo_clipExtentMAX, x));
                y = Math.max(-d3_geo_clipExtentMAX, Math.min(d3_geo_clipExtentMAX, y));
                var v = pointVisible(x, y);
                if (polygon) ring.push([ x, y ]);
                if (first) {
                    x__ = x, y__ = y, v__ = v;
                    first = false;
                    if (v) {
                        listener.lineStart();
                        listener.point(x, y);
                    }
                } else {
                    if (v && v_) listener.point(x, y); else {
                        var l = {
                            a: {
                                x: x_,
                                y: y_
                            },
                            b: {
                                x: x,
                                y: y
                            }
                        };
                        if (clipLine(l)) {
                            if (!v_) {
                                listener.lineStart();
                                listener.point(l.a.x, l.a.y);
                            }
                            listener.point(l.b.x, l.b.y);
                            if (!v) listener.lineEnd();
                            clean = false;
                        } else if (v) {
                            listener.lineStart();
                            listener.point(x, y);
                            clean = false;
                        }
                    }
                }
                x_ = x, y_ = y, v_ = v;
            }
            return clip;
        };
        function corner(p, direction) {
            return abs(p[0] - x0) <  ? direction > 0 ? 0 : 3 : abs(p[0] - x1) <  ? direction > 0 ? 2 : 1 : abs(p[1] - y0) <  ? direction > 0 ? 1 : 0 : direction > 0 ? 3 : 2;
        }
        function compare(a, b) {
            return comparePoints(a.x, b.x);
        }
        function comparePoints(a, b) {
            var ca = corner(a, 1), cb = corner(b, 1);
            return ca !== cb ? ca - cb : ca === 0 ? b[1] - a[1] : ca === 1 ? a[0] - b[0] : ca === 2 ? a[1] - b[1] : b[0] - a[0];
        }
    }
    function d3_geo_conic(projectAt) {
        var 0 = 0, 1 =  / 3, m = d3_geo_projectionMutator(projectAt), p = m(0, 1);
        p.parallels = function(_) {
            if (!arguments.length) return [ 0 /  * 180, 1 /  * 180 ];
            return m(0 = _[0] *  / 180, 1 = _[1] *  / 180);
        };
        return p;
    }
    function d3_geo_conicEqualArea(0, 1) {
        var sin0 = Math.sin(0), n = (sin0 + Math.sin(1)) / 2, C = 1 + sin0 * (2 * n - sin0), 0 = Math.sqrt(C) / n;
        function forward(, ) {
            var  = Math.sqrt(C - 2 * n * Math.sin()) / n;
            return [  * Math.sin( *= n), 0 -  * Math.cos() ];
        }
        forward.invert = function(x, y) {
            var 0_y = 0 - y;
            return [ Math.atan2(x, 0_y) / n, d3_asin((C - (x * x + 0_y * 0_y) * n * n) / (2 * n)) ];
        };
        return forward;
    }
    (d3.geo.conicEqualArea = function() {
        return d3_geo_conic(d3_geo_conicEqualArea);
    }).raw = d3_geo_conicEqualArea;
    d3.geo.albers = function() {
        return d3.geo.conicEqualArea().rotate([ 96, 0 ]).center([ -.6, 38.7 ]).parallels([ 29.5, 45.5 ]).scale(1070);
    };
    d3.geo.albersUsa = function() {
        var lower48 = d3.geo.albers();
        var alaska = d3.geo.conicEqualArea().rotate([ 154, 0 ]).center([ -2, 58.5 ]).parallels([ 55, 65 ]);
        var hawaii = d3.geo.conicEqualArea().rotate([ 157, 0 ]).center([ -3, 19.9 ]).parallels([ 8, 18 ]);
        var point, pointStream = {
            point: function(x, y) {
                point = [ x, y ];
            }
        }, lower48Point, alaskaPoint, hawaiiPoint;
        function albersUsa(coordinates) {
            var x = coordinates[0], y = coordinates[1];
            point = null;
            (lower48Point(x, y), point) || (alaskaPoint(x, y), point) || hawaiiPoint(x, y);
            return point;
        }
        albersUsa.invert = function(coordinates) {
            var k = lower48.scale(), t = lower48.translate(), x = (coordinates[0] - t[0]) / k, y = (coordinates[1] - t[1]) / k;
            return (y >= .12 && y < .234 && x >= -.425 && x < -.214 ? alaska : y >= .166 && y < .234 && x >= -.214 && x < -.115 ? hawaii : lower48).invert(coordinates);
        };
        albersUsa.stream = function(stream) {
            var lower48Stream = lower48.stream(stream), alaskaStream = alaska.stream(stream), hawaiiStream = hawaii.stream(stream);
            return {
                point: function(x, y) {
                    lower48Stream.point(x, y);
                    alaskaStream.point(x, y);
                    hawaiiStream.point(x, y);
                },
                sphere: function() {
                    lower48Stream.sphere();
                    alaskaStream.sphere();
                    hawaiiStream.sphere();
                },
                lineStart: function() {
                    lower48Stream.lineStart();
                    alaskaStream.lineStart();
                    hawaiiStream.lineStart();
                },
                lineEnd: function() {
                    lower48Stream.lineEnd();
                    alaskaStream.lineEnd();
                    hawaiiStream.lineEnd();
                },
                polygonStart: function() {
                    lower48Stream.polygonStart();
                    alaskaStream.polygonStart();
                    hawaiiStream.polygonStart();
                },
                polygonEnd: function() {
                    lower48Stream.polygonEnd();
                    alaskaStream.polygonEnd();
                    hawaiiStream.polygonEnd();
                }
            };
        };
        albersUsa.precision = function(_) {
            if (!arguments.length) return lower48.precision();
            lower48.precision(_);
            alaska.precision(_);
            hawaii.precision(_);
            return albersUsa;
        };
        albersUsa.scale = function(_) {
            if (!arguments.length) return lower48.scale();
            lower48.scale(_);
            alaska.scale(_ * .35);
            hawaii.scale(_);
            return albersUsa.translate(lower48.translate());
        };
        albersUsa.translate = function(_) {
            if (!arguments.length) return lower48.translate();
            var k = lower48.scale(), x = +_[0], y = +_[1];
            lower48Point = lower48.translate(_).clipExtent([ [ x - .455 * k, y - .238 * k ], [ x + .455 * k, y + .238 * k ] ]).stream(pointStream).point;
            alaskaPoint = alaska.translate([ x - .307 * k, y + .201 * k ]).clipExtent([ [ x - .425 * k + , y + .12 * k +  ], [ x - .214 * k - , y + .234 * k -  ] ]).stream(pointStream).point;
            hawaiiPoint = hawaii.translate([ x - .205 * k, y + .212 * k ]).clipExtent([ [ x - .214 * k + , y + .166 * k +  ], [ x - .115 * k - , y + .234 * k -  ] ]).stream(pointStream).point;
            return albersUsa;
        };
        return albersUsa.scale(1070);
    };
    var d3_geo_pathAreaSum, d3_geo_pathAreaPolygon, d3_geo_pathArea = {
        point: d3_noop,
        lineStart: d3_noop,
        lineEnd: d3_noop,
        polygonStart: function() {
            d3_geo_pathAreaPolygon = 0;
            d3_geo_pathArea.lineStart = d3_geo_pathAreaRingStart;
        },
        polygonEnd: function() {
            d3_geo_pathArea.lineStart = d3_geo_pathArea.lineEnd = d3_geo_pathArea.point = d3_noop;
            d3_geo_pathAreaSum += abs(d3_geo_pathAreaPolygon / 2);
        }
    };
    function d3_geo_pathAreaRingStart() {
        var x00, y00, x0, y0;
        d3_geo_pathArea.point = function(x, y) {
            d3_geo_pathArea.point = nextPoint;
            x00 = x0 = x, y00 = y0 = y;
        };
        function nextPoint(x, y) {
            d3_geo_pathAreaPolygon += y0 * x - x0 * y;
            x0 = x, y0 = y;
        }
        d3_geo_pathArea.lineEnd = function() {
            nextPoint(x00, y00);
        };
    }
    var d3_geo_pathBoundsX0, d3_geo_pathBoundsY0, d3_geo_pathBoundsX1, d3_geo_pathBoundsY1;
    var d3_geo_pathBounds = {
        point: d3_geo_pathBoundsPoint,
        lineStart: d3_noop,
        lineEnd: d3_noop,
        polygonStart: d3_noop,
        polygonEnd: d3_noop
    };
    function d3_geo_pathBoundsPoint(x, y) {
        if (x < d3_geo_pathBoundsX0) d3_geo_pathBoundsX0 = x;
        if (x > d3_geo_pathBoundsX1) d3_geo_pathBoundsX1 = x;
        if (y < d3_geo_pathBoundsY0) d3_geo_pathBoundsY0 = y;
        if (y > d3_geo_pathBoundsY1) d3_geo_pathBoundsY1 = y;
    }
    function d3_geo_pathBuffer() {
        var pointCircle = d3_geo_pathBufferCircle(4.5), buffer = [];
        var stream = {
            point: point,
            lineStart: function() {
                stream.point = pointLineStart;
            },
            lineEnd: lineEnd,
            polygonStart: function() {
                stream.lineEnd = lineEndPolygon;
            },
            polygonEnd: function() {
                stream.lineEnd = lineEnd;
                stream.point = point;
            },
            pointRadius: function(_) {
                pointCircle = d3_geo_pathBufferCircle(_);
                return stream;
            },
            result: function() {
                if (buffer.length) {
                    var result = buffer.join("");
                    buffer = [];
                    return result;
                }
            }
        };
        function point(x, y) {
            buffer.push("M", x, ",", y, pointCircle);
        }
        function pointLineStart(x, y) {
            buffer.push("M", x, ",", y);
            stream.point = pointLine;
        }
        function pointLine(x, y) {
            buffer.push("L", x, ",", y);
        }
        function lineEnd() {
            stream.point = point;
        }
        function lineEndPolygon() {
            buffer.push("Z");
        }
        return stream;
    }
    function d3_geo_pathBufferCircle(radius) {
        return "m0," + radius + "a" + radius + "," + radius + " 0 1,1 0," + -2 * radius + "a" + radius + "," + radius + " 0 1,1 0," + 2 * radius + "z";
    }
    var d3_geo_pathCentroid = {
        point: d3_geo_pathCentroidPoint,
        lineStart: d3_geo_pathCentroidLineStart,
        lineEnd: d3_geo_pathCentroidLineEnd,
        polygonStart: function() {
            d3_geo_pathCentroid.lineStart = d3_geo_pathCentroidRingStart;
        },
        polygonEnd: function() {
            d3_geo_pathCentroid.point = d3_geo_pathCentroidPoint;
            d3_geo_pathCentroid.lineStart = d3_geo_pathCentroidLineStart;
            d3_geo_pathCentroid.lineEnd = d3_geo_pathCentroidLineEnd;
        }
    };
    function d3_geo_pathCentroidPoint(x, y) {
        d3_geo_centroidX0 += x;
        d3_geo_centroidY0 += y;
        ++d3_geo_centroidZ0;
    }
    function d3_geo_pathCentroidLineStart() {
        var x0, y0;
        d3_geo_pathCentroid.point = function(x, y) {
            d3_geo_pathCentroid.point = nextPoint;
            d3_geo_pathCentroidPoint(x0 = x, y0 = y);
        };
        function nextPoint(x, y) {
            var dx = x - x0, dy = y - y0, z = Math.sqrt(dx * dx + dy * dy);
            d3_geo_centroidX1 += z * (x0 + x) / 2;
            d3_geo_centroidY1 += z * (y0 + y) / 2;
            d3_geo_centroidZ1 += z;
            d3_geo_pathCentroidPoint(x0 = x, y0 = y);
        }
    }
    function d3_geo_pathCentroidLineEnd() {
        d3_geo_pathCentroid.point = d3_geo_pathCentroidPoint;
    }
    function d3_geo_pathCentroidRingStart() {
        var x00, y00, x0, y0;
        d3_geo_pathCentroid.point = function(x, y) {
            d3_geo_pathCentroid.point = nextPoint;
            d3_geo_pathCentroidPoint(x00 = x0 = x, y00 = y0 = y);
        };
        function nextPoint(x, y) {
            var dx = x - x0, dy = y - y0, z = Math.sqrt(dx * dx + dy * dy);
            d3_geo_centroidX1 += z * (x0 + x) / 2;
            d3_geo_centroidY1 += z * (y0 + y) / 2;
            d3_geo_centroidZ1 += z;
            z = y0 * x - x0 * y;
            d3_geo_centroidX2 += z * (x0 + x);
            d3_geo_centroidY2 += z * (y0 + y);
            d3_geo_centroidZ2 += z * 3;
            d3_geo_pathCentroidPoint(x0 = x, y0 = y);
        }
        d3_geo_pathCentroid.lineEnd = function() {
            nextPoint(x00, y00);
        };
    }
    function d3_geo_pathContext(context) {
        var pointRadius = 4.5;
        var stream = {
            point: point,
            lineStart: function() {
                stream.point = pointLineStart;
            },
            lineEnd: lineEnd,
            polygonStart: function() {
                stream.lineEnd = lineEndPolygon;
            },
            polygonEnd: function() {
                stream.lineEnd = lineEnd;
                stream.point = point;
            },
            pointRadius: function(_) {
                pointRadius = _;
                return stream;
            },
            result: d3_noop
        };
        function point(x, y) {
            context.moveTo(x + pointRadius, y);
            context.arc(x, y, pointRadius, 0, );
        }
        function pointLineStart(x, y) {
            context.moveTo(x, y);
            stream.point = pointLine;
        }
        function pointLine(x, y) {
            context.lineTo(x, y);
        }
        function lineEnd() {
            stream.point = point;
        }
        function lineEndPolygon() {
            context.closePath();
        }
        return stream;
    }
    function d3_geo_resample(project) {
        var 2 = .5, cosMinDistance = Math.cos(30 * d3_radians), maxDepth = 16;
        function resample(stream) {
            return (maxDepth ? resampleRecursive : resampleNone)(stream);
        }
        function resampleNone(stream) {
            return d3_geo_transformPoint(stream, function(x, y) {
                x = project(x, y);
                stream.point(x[0], x[1]);
            });
        }
        function resampleRecursive(stream) {
            var 00, 00, x00, y00, a00, b00, c00, 0, x0, y0, a0, b0, c0;
            var resample = {
                point: point,
                lineStart: lineStart,
                lineEnd: lineEnd,
                polygonStart: function() {
                    stream.polygonStart();
                    resample.lineStart = ringStart;
                },
                polygonEnd: function() {
                    stream.polygonEnd();
                    resample.lineStart = lineStart;
                }
            };
            function point(x, y) {
                x = project(x, y);
                stream.point(x[0], x[1]);
            }
            function lineStart() {
                x0 = NaN;
                resample.point = linePoint;
                stream.lineStart();
            }
            function linePoint(, ) {
                var c = d3_geo_cartesian([ ,  ]), p = project(, );
                resampleLineTo(x0, y0, 0, a0, b0, c0, x0 = p[0], y0 = p[1], 0 = , a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);
                stream.point(x0, y0);
            }
            function lineEnd() {
                resample.point = point;
                stream.lineEnd();
            }
            function ringStart() {
                lineStart();
                resample.point = ringPoint;
                resample.lineEnd = ringEnd;
            }
            function ringPoint(, ) {
                linePoint(00 = , 00 = ), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;
                resample.point = linePoint;
            }
            function ringEnd() {
                resampleLineTo(x0, y0, 0, a0, b0, c0, x00, y00, 00, a00, b00, c00, maxDepth, stream);
                resample.lineEnd = lineEnd;
                lineEnd();
            }
            return resample;
        }
        function resampleLineTo(x0, y0, 0, a0, b0, c0, x1, y1, 1, a1, b1, c1, depth, stream) {
            var dx = x1 - x0, dy = y1 - y0, d2 = dx * dx + dy * dy;
            if (d2 > 4 * 2 && depth--) {
                var a = a0 + a1, b = b0 + b1, c = c0 + c1, m = Math.sqrt(a * a + b * b + c * c), 2 = Math.asin(c /= m), 2 = abs(abs(c) - 1) <  || abs(0 - 1) <  ? (0 + 1) / 2 : Math.atan2(b, a), p = project(2, 2), x2 = p[0], y2 = p[1], dx2 = x2 - x0, dy2 = y2 - y0, dz = dy * dx2 - dx * dy2;
                if (dz * dz / d2 > 2 || abs((dx * dx2 + dy * dy2) / d2 - .5) > .3 || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) {
                    resampleLineTo(x0, y0, 0, a0, b0, c0, x2, y2, 2, a /= m, b /= m, c, depth, stream);
                    stream.point(x2, y2);
                    resampleLineTo(x2, y2, 2, a, b, c, x1, y1, 1, a1, b1, c1, depth, stream);
                }
            }
        }
        resample.precision = function(_) {
            if (!arguments.length) return Math.sqrt(2);
            maxDepth = (2 = _ * _) > 0 && 16;
            return resample;
        };
        return resample;
    }
    d3.geo.path = function() {
        var pointRadius = 4.5, projection, context, projectStream, contextStream, cacheStream;
        function path(object) {
            if (object) {
                if (typeof pointRadius === "function") contextStream.pointRadius(+pointRadius.apply(this, arguments));
                if (!cacheStream || !cacheStream.valid) cacheStream = projectStream(contextStream);
                d3.geo.stream(object, cacheStream);
            }
            return contextStream.result();
        }
        path.area = function(object) {
            d3_geo_pathAreaSum = 0;
            d3.geo.stream(object, projectStream(d3_geo_pathArea));
            return d3_geo_pathAreaSum;
        };
        path.centroid = function(object) {
            d3_geo_centroidX0 = d3_geo_centroidY0 = d3_geo_centroidZ0 = d3_geo_centroidX1 = d3_geo_centroidY1 = d3_geo_centroidZ1 = d3_geo_centroidX2 = d3_geo_centroidY2 = d3_geo_centroidZ2 = 0;
            d3.geo.stream(object, projectStream(d3_geo_pathCentroid));
            return d3_geo_centroidZ2 ? [ d3_geo_centroidX2 / d3_geo_centroidZ2, d3_geo_centroidY2 / d3_geo_centroidZ2 ] : d3_geo_centroidZ1 ? [ d3_geo_centroidX1 / d3_geo_centroidZ1, d3_geo_centroidY1 / d3_geo_centroidZ1 ] : d3_geo_centroidZ0 ? [ d3_geo_centroidX0 / d3_geo_centroidZ0, d3_geo_centroidY0 / d3_geo_centroidZ0 ] : [ NaN, NaN ];
        };
        path.bounds = function(object) {
            d3_geo_pathBoundsX1 = d3_geo_pathBoundsY1 = -(d3_geo_pathBoundsX0 = d3_geo_pathBoundsY0 = Infinity);
            d3.geo.stream(object, projectStream(d3_geo_pathBounds));
            return [ [ d3_geo_pathBoundsX0, d3_geo_pathBoundsY0 ], [ d3_geo_pathBoundsX1, d3_geo_pathBoundsY1 ] ];
        };
        path.projection = function(_) {
            if (!arguments.length) return projection;
            projectStream = (projection = _) ? _.stream || d3_geo_pathProjectStream(_) : d3_identity;
            return reset();
        };
        path.context = function(_) {
            if (!arguments.length) return context;
            contextStream = (context = _) == null ? new d3_geo_pathBuffer() : new d3_geo_pathContext(_);
            if (typeof pointRadius !== "function") contextStream.pointRadius(pointRadius);
            return reset();
        };
        path.pointRadius = function(_) {
            if (!arguments.length) return pointRadius;
            pointRadius = typeof _ === "function" ? _ : (contextStream.pointRadius(+_), +_);
            return path;
        };
        function reset() {
            cacheStream = null;
            return path;
        }
        return path.projection(d3.geo.albersUsa()).context(null);
    };
    function d3_geo_pathProjectStream(project) {
        var resample = d3_geo_resample(function(x, y) {
            return project([ x * d3_degrees, y * d3_degrees ]);
        });
        return function(stream) {
            return d3_geo_projectionRadians(resample(stream));
        };
    }
    d3.geo.transform = function(methods) {
        return {
            stream: function(stream) {
                var transform = new d3_geo_transform(stream);
                for (var k in methods) transform[k] = methods[k];
                return transform;
            }
        };
    };
    function d3_geo_transform(stream) {
        this.stream = stream;
    }
    d3_geo_transform.prototype = {
        point: function(x, y) {
            this.stream.point(x, y);
        },
        sphere: function() {
            this.stream.sphere();
        },
        lineStart: function() {
            this.stream.lineStart();
        },
        lineEnd: function() {
            this.stream.lineEnd();
        },
        polygonStart: function() {
            this.stream.polygonStart();
        },
        polygonEnd: function() {
            this.stream.polygonEnd();
        }
    };
    function d3_geo_transformPoint(stream, point) {
        return {
            point: point,
            sphere: function() {
                stream.sphere();
            },
            lineStart: function() {
                stream.lineStart();
            },
            lineEnd: function() {
                stream.lineEnd();
            },
            polygonStart: function() {
                stream.polygonStart();
            },
            polygonEnd: function() {
                stream.polygonEnd();
            }
        };
    }
    d3.geo.projection = d3_geo_projection;
    d3.geo.projectionMutator = d3_geo_projectionMutator;
    function d3_geo_projection(project) {
        return d3_geo_projectionMutator(function() {
            return project;
        })();
    }
    function d3_geo_projectionMutator(projectAt) {
        var project, rotate, projectRotate, projectResample = d3_geo_resample(function(x, y) {
            x = project(x, y);
            return [ x[0] * k + x, y - x[1] * k ];
        }), k = 150, x = 480, y = 250,  = 0,  = 0,  = 0,  = 0,  = 0, x, y, preclip = d3_geo_clipAntimeridian, postclip = d3_identity, clipAngle = null, clipExtent = null, stream;
        function projection(point) {
            point = projectRotate(point[0] * d3_radians, point[1] * d3_radians);
            return [ point[0] * k + x, y - point[1] * k ];
        }
        function invert(point) {
            point = projectRotate.invert((point[0] - x) / k, (y - point[1]) / k);
            return point && [ point[0] * d3_degrees, point[1] * d3_degrees ];
        }
        projection.stream = function(output) {
            if (stream) stream.valid = false;
            stream = d3_geo_projectionRadians(preclip(rotate, projectResample(postclip(output))));
            stream.valid = true;
            return stream;
        };
        projection.clipAngle = function(_) {
            if (!arguments.length) return clipAngle;
            preclip = _ == null ? (clipAngle = _, d3_geo_clipAntimeridian) : d3_geo_clipCircle((clipAngle = +_) * d3_radians);
            return invalidate();
        };
        projection.clipExtent = function(_) {
            if (!arguments.length) return clipExtent;
            clipExtent = _;
            postclip = _ ? d3_geo_clipExtent(_[0][0], _[0][1], _[1][0], _[1][1]) : d3_identity;
            return invalidate();
        };
        projection.scale = function(_) {
            if (!arguments.length) return k;
            k = +_;
            return reset();
        };
        projection.translate = function(_) {
            if (!arguments.length) return [ x, y ];
            x = +_[0];
            y = +_[1];
            return reset();
        };
        projection.center = function(_) {
            if (!arguments.length) return [  * d3_degrees,  * d3_degrees ];
             = _[0] % 360 * d3_radians;
             = _[1] % 360 * d3_radians;
            return reset();
        };
        projection.rotate = function(_) {
            if (!arguments.length) return [  * d3_degrees,  * d3_degrees,  * d3_degrees ];
             = _[0] % 360 * d3_radians;
             = _[1] % 360 * d3_radians;
             = _.length > 2 ? _[2] % 360 * d3_radians : 0;
            return reset();
        };
        d3.rebind(projection, projectResample, "precision");
        function reset() {
            projectRotate = d3_geo_compose(rotate = d3_geo_rotation(, , ), project);
            var center = project(, );
            x = x - center[0] * k;
            y = y + center[1] * k;
            return invalidate();
        }
        function invalidate() {
            if (stream) stream.valid = false, stream = null;
            return projection;
        }
        return function() {
            project = projectAt.apply(this, arguments);
            projection.invert = project.invert && invert;
            return reset();
        };
    }
    function d3_geo_projectionRadians(stream) {
        return d3_geo_transformPoint(stream, function(x, y) {
            stream.point(x * d3_radians, y * d3_radians);
        });
    }
    function d3_geo_equirectangular(, ) {
        return [ ,  ];
    }
    (d3.geo.equirectangular = function() {
        return d3_geo_projection(d3_geo_equirectangular);
    }).raw = d3_geo_equirectangular.invert = d3_geo_equirectangular;
    d3.geo.rotation = function(rotate) {
        rotate = d3_geo_rotation(rotate[0] % 360 * d3_radians, rotate[1] * d3_radians, rotate.length > 2 ? rotate[2] * d3_radians : 0);
        function forward(coordinates) {
            coordinates = rotate(coordinates[0] * d3_radians, coordinates[1] * d3_radians);
            return coordinates[0] *= d3_degrees, coordinates[1] *= d3_degrees, coordinates;
        }
        forward.invert = function(coordinates) {
            coordinates = rotate.invert(coordinates[0] * d3_radians, coordinates[1] * d3_radians);
            return coordinates[0] *= d3_degrees, coordinates[1] *= d3_degrees, coordinates;
        };
        return forward;
    };
    function d3_geo_identityRotation(, ) {
        return [  >  ?  -  :  < - ?  +  : ,  ];
    }
    d3_geo_identityRotation.invert = d3_geo_equirectangular;
    function d3_geo_rotation(, , ) {
        return  ?  ||  ? d3_geo_compose(d3_geo_rotation(), d3_geo_rotation(, )) : d3_geo_rotation() :  ||  ? d3_geo_rotation(, ) : d3_geo_identityRotation;
    }
    function d3_geo_forwardRotation() {
        return function(, ) {
            return  += , [  >  ?  -  :  < - ?  +  : ,  ];
        };
    }
    function d3_geo_rotation() {
        var rotation = d3_geo_forwardRotation();
        rotation.invert = d3_geo_forwardRotation(-);
        return rotation;
    }
    function d3_geo_rotation(, ) {
        var cos = Math.cos(), sin = Math.sin(), cos = Math.cos(), sin = Math.sin();
        function rotation(, ) {
            var cos = Math.cos(), x = Math.cos() * cos, y = Math.sin() * cos, z = Math.sin(), k = z * cos + x * sin;
            return [ Math.atan2(y * cos - k * sin, x * cos - z * sin), d3_asin(k * cos + y * sin) ];
        }
        rotation.invert = function(, ) {
            var cos = Math.cos(), x = Math.cos() * cos, y = Math.sin() * cos, z = Math.sin(), k = z * cos - y * sin;
            return [ Math.atan2(y * cos + z * sin, x * cos + k * sin), d3_asin(k * cos - x * sin) ];
        };
        return rotation;
    }
    d3.geo.circle = function() {
        var origin = [ 0, 0 ], angle, precision = 6, interpolate;
        function circle() {
            var center = typeof origin === "function" ? origin.apply(this, arguments) : origin, rotate = d3_geo_rotation(-center[0] * d3_radians, -center[1] * d3_radians, 0).invert, ring = [];
            interpolate(null, null, 1, {
                point: function(x, y) {
                    ring.push(x = rotate(x, y));
                    x[0] *= d3_degrees, x[1] *= d3_degrees;
                }
            });
            return {
                type: "Polygon",
                coordinates: [ ring ]
            };
        }
        circle.origin = function(x) {
            if (!arguments.length) return origin;
            origin = x;
            return circle;
        };
        circle.angle = function(x) {
            if (!arguments.length) return angle;
            interpolate = d3_geo_circleInterpolate((angle = +x) * d3_radians, precision * d3_radians);
            return circle;
        };
        circle.precision = function(_) {
            if (!arguments.length) return precision;
            interpolate = d3_geo_circleInterpolate(angle * d3_radians, (precision = +_) * d3_radians);
            return circle;
        };
        return circle.angle(90);
    };
    function d3_geo_circleInterpolate(radius, precision) {
        var cr = Math.cos(radius), sr = Math.sin(radius);
        return function(from, to, direction, listener) {
            var step = direction * precision;
            if (from != null) {
                from = d3_geo_circleAngle(cr, from);
                to = d3_geo_circleAngle(cr, to);
                if (direction > 0 ? from < to : from > to) from += direction * ;
            } else {
                from = radius + direction * ;
                to = radius - .5 * step;
            }
            for (var point, t = from; direction > 0 ? t > to : t < to; t -= step) {
                listener.point((point = d3_geo_spherical([ cr, -sr * Math.cos(t), -sr * Math.sin(t) ]))[0], point[1]);
            }
        };
    }
    function d3_geo_circleAngle(cr, point) {
        var a = d3_geo_cartesian(point);
        a[0] -= cr;
        d3_geo_cartesianNormalize(a);
        var angle = d3_acos(-a[1]);
        return ((-a[2] < 0 ? -angle : angle) + 2 * Math.PI - ) % (2 * Math.PI);
    }
    d3.geo.distance = function(a, b) {
        var  = (b[0] - a[0]) * d3_radians, 0 = a[1] * d3_radians, 1 = b[1] * d3_radians, sin = Math.sin(), cos = Math.cos(), sin0 = Math.sin(0), cos0 = Math.cos(0), sin1 = Math.sin(1), cos1 = Math.cos(1), t;
        return Math.atan2(Math.sqrt((t = cos1 * sin) * t + (t = cos0 * sin1 - sin0 * cos1 * cos) * t), sin0 * sin1 + cos0 * cos1 * cos);
    };
    d3.geo.graticule = function() {
        var x1, x0, X1, X0, y1, y0, Y1, Y0, dx = 10, dy = dx, DX = 90, DY = 360, x, y, X, Y, precision = 2.5;
        function graticule() {
            return {
                type: "MultiLineString",
                coordinates: lines()
            };
        }
        function lines() {
            return d3.range(Math.ceil(X0 / DX) * DX, X1, DX).map(X).concat(d3.range(Math.ceil(Y0 / DY) * DY, Y1, DY).map(Y)).concat(d3.range(Math.ceil(x0 / dx) * dx, x1, dx).filter(function(x) {
                return abs(x % DX) > ;
            }).map(x)).concat(d3.range(Math.ceil(y0 / dy) * dy, y1, dy).filter(function(y) {
                return abs(y % DY) > ;
            }).map(y));
        }
        graticule.lines = function() {
            return lines().map(function(coordinates) {
                return {
                    type: "LineString",
                    coordinates: coordinates
                };
            });
        };
        graticule.outline = function() {
            return {
                type: "Polygon",
                coordinates: [ X(X0).concat(Y(Y1).slice(1), X(X1).reverse().slice(1), Y(Y0).reverse().slice(1)) ]
            };
        };
        graticule.extent = function(_) {
            if (!arguments.length) return graticule.minorExtent();
            return graticule.majorExtent(_).minorExtent(_);
        };
        graticule.majorExtent = function(_) {
            if (!arguments.length) return [ [ X0, Y0 ], [ X1, Y1 ] ];
            X0 = +_[0][0], X1 = +_[1][0];
            Y0 = +_[0][1], Y1 = +_[1][1];
            if (X0 > X1) _ = X0, X0 = X1, X1 = _;
            if (Y0 > Y1) _ = Y0, Y0 = Y1, Y1 = _;
            return graticule.precision(precision);
        };
        graticule.minorExtent = function(_) {
            if (!arguments.length) return [ [ x0, y0 ], [ x1, y1 ] ];
            x0 = +_[0][0], x1 = +_[1][0];
            y0 = +_[0][1], y1 = +_[1][1];
            if (x0 > x1) _ = x0, x0 = x1, x1 = _;
            if (y0 > y1) _ = y0, y0 = y1, y1 = _;
            return graticule.precision(precision);
        };
        graticule.step = function(_) {
            if (!arguments.length) return graticule.minorStep();
            return graticule.majorStep(_).minorStep(_);
        };
        graticule.majorStep = function(_) {
            if (!arguments.length) return [ DX, DY ];
            DX = +_[0], DY = +_[1];
            return graticule;
        };
        graticule.minorStep = function(_) {
            if (!arguments.length) return [ dx, dy ];
            dx = +_[0], dy = +_[1];
            return graticule;
        };
        graticule.precision = function(_) {
            if (!arguments.length) return precision;
            precision = +_;
            x = d3_geo_graticuleX(y0, y1, 90);
            y = d3_geo_graticuleY(x0, x1, precision);
            X = d3_geo_graticuleX(Y0, Y1, 90);
            Y = d3_geo_graticuleY(X0, X1, precision);
            return graticule;
        };
        return graticule.majorExtent([ [ -180, -90 +  ], [ 180, 90 -  ] ]).minorExtent([ [ -180, -80 -  ], [ 180, 80 +  ] ]);
    };
    function d3_geo_graticuleX(y0, y1, dy) {
        var y = d3.range(y0, y1 - , dy).concat(y1);
        return function(x) {
            return y.map(function(y) {
                return [ x, y ];
            });
        };
    }
    function d3_geo_graticuleY(x0, x1, dx) {
        var x = d3.range(x0, x1 - , dx).concat(x1);
        return function(y) {
            return x.map(function(x) {
                return [ x, y ];
            });
        };
    }
    function d3_source(d) {
        return d.source;
    }
    function d3_target(d) {
        return d.target;
    }
    d3.geo.greatArc = function() {
        var source = d3_source, source_, target = d3_target, target_;
        function greatArc() {
            return {
                type: "LineString",
                coordinates: [ source_ || source.apply(this, arguments), target_ || target.apply(this, arguments) ]
            };
        }
        greatArc.distance = function() {
            return d3.geo.distance(source_ || source.apply(this, arguments), target_ || target.apply(this, arguments));
        };
        greatArc.source = function(_) {
            if (!arguments.length) return source;
            source = _, source_ = typeof _ === "function" ? null : _;
            return greatArc;
        };
        greatArc.target = function(_) {
            if (!arguments.length) return target;
            target = _, target_ = typeof _ === "function" ? null : _;
            return greatArc;
        };
        greatArc.precision = function() {
            return arguments.length ? greatArc : 0;
        };
        return greatArc;
    };
    d3.geo.interpolate = function(source, target) {
        return d3_geo_interpolate(source[0] * d3_radians, source[1] * d3_radians, target[0] * d3_radians, target[1] * d3_radians);
    };
    function d3_geo_interpolate(x0, y0, x1, y1) {
        var cy0 = Math.cos(y0), sy0 = Math.sin(y0), cy1 = Math.cos(y1), sy1 = Math.sin(y1), kx0 = cy0 * Math.cos(x0), ky0 = cy0 * Math.sin(x0), kx1 = cy1 * Math.cos(x1), ky1 = cy1 * Math.sin(x1), d = 2 * Math.asin(Math.sqrt(d3_haversin(y1 - y0) + cy0 * cy1 * d3_haversin(x1 - x0))), k = 1 / Math.sin(d);
        var interpolate = d ? function(t) {
            var B = Math.sin(t *= d) * k, A = Math.sin(d - t) * k, x = A * kx0 + B * kx1, y = A * ky0 + B * ky1, z = A * sy0 + B * sy1;
            return [ Math.atan2(y, x) * d3_degrees, Math.atan2(z, Math.sqrt(x * x + y * y)) * d3_degrees ];
        } : function() {
            return [ x0 * d3_degrees, y0 * d3_degrees ];
        };
        interpolate.distance = d;
        return interpolate;
    }
    d3.geo.length = function(object) {
        d3_geo_lengthSum = 0;
        d3.geo.stream(object, d3_geo_length);
        return d3_geo_lengthSum;
    };
    var d3_geo_lengthSum;
    var d3_geo_length = {
        sphere: d3_noop,
        point: d3_noop,
        lineStart: d3_geo_lengthLineStart,
        lineEnd: d3_noop,
        polygonStart: d3_noop,
        polygonEnd: d3_noop
    };
    function d3_geo_lengthLineStart() {
        var 0, sin0, cos0;
        d3_geo_length.point = function(, ) {
            0 =  * d3_radians, sin0 = Math.sin( *= d3_radians), cos0 = Math.cos();
            d3_geo_length.point = nextPoint;
        };
        d3_geo_length.lineEnd = function() {
            d3_geo_length.point = d3_geo_length.lineEnd = d3_noop;
        };
        function nextPoint(, ) {
            var sin = Math.sin( *= d3_radians), cos = Math.cos(), t = abs(( *= d3_radians) - 0), cos = Math.cos(t);
            d3_geo_lengthSum += Math.atan2(Math.sqrt((t = cos * Math.sin(t)) * t + (t = cos0 * sin - sin0 * cos * cos) * t), sin0 * sin + cos0 * cos * cos);
            0 = , sin0 = sin, cos0 = cos;
        }
    }
    function d3_geo_azimuthal(scale, angle) {
        function azimuthal(, ) {
            var cos = Math.cos(), cos = Math.cos(), k = scale(cos * cos);
            return [ k * cos * Math.sin(), k * Math.sin() ];
        }
        azimuthal.invert = function(x, y) {
            var  = Math.sqrt(x * x + y * y), c = angle(), sinc = Math.sin(c), cosc = Math.cos(c);
            return [ Math.atan2(x * sinc,  * cosc), Math.asin( && y * sinc / ) ];
        };
        return azimuthal;
    }
    var d3_geo_azimuthalEqualArea = d3_geo_azimuthal(function(coscos) {
        return Math.sqrt(2 / (1 + coscos));
    }, function() {
        return 2 * Math.asin( / 2);
    });
    (d3.geo.azimuthalEqualArea = function() {
        return d3_geo_projection(d3_geo_azimuthalEqualArea);
    }).raw = d3_geo_azimuthalEqualArea;
    var d3_geo_azimuthalEquidistant = d3_geo_azimuthal(function(coscos) {
        var c = Math.acos(coscos);
        return c && c / Math.sin(c);
    }, d3_identity);
    (d3.geo.azimuthalEquidistant = function() {
        return d3_geo_projection(d3_geo_azimuthalEquidistant);
    }).raw = d3_geo_azimuthalEquidistant;
    function d3_geo_conicConformal(0, 1) {
        var cos0 = Math.cos(0), t = function() {
            return Math.tan( / 4 +  / 2);
        }, n = 0 === 1 ? Math.sin(0) : Math.log(cos0 / Math.cos(1)) / Math.log(t(1) / t(0)), F = cos0 * Math.pow(t(0), n) / n;
        if (!n) return d3_geo_mercator;
        function forward(, ) {
            if (F > 0) {
                if ( < -half + )  = -half + ;
            } else {
                if ( > half - )  = half - ;
            }
            var  = F / Math.pow(t(), n);
            return [  * Math.sin(n * ), F -  * Math.cos(n * ) ];
        }
        forward.invert = function(x, y) {
            var 0_y = F - y,  = d3_sgn(n) * Math.sqrt(x * x + 0_y * 0_y);
            return [ Math.atan2(x, 0_y) / n, 2 * Math.atan(Math.pow(F / , 1 / n)) - half ];
        };
        return forward;
    }
    (d3.geo.conicConformal = function() {
        return d3_geo_conic(d3_geo_conicConformal);
    }).raw = d3_geo_conicConformal;
    function d3_geo_conicEquidistant(0, 1) {
        var cos0 = Math.cos(0), n = 0 === 1 ? Math.sin(0) : (cos0 - Math.cos(1)) / (1 - 0), G = cos0 / n + 0;
        if (abs(n) < ) return d3_geo_equirectangular;
        function forward(, ) {
            var  = G - ;
            return [  * Math.sin(n * ), G -  * Math.cos(n * ) ];
        }
        forward.invert = function(x, y) {
            var 0_y = G - y;
            return [ Math.atan2(x, 0_y) / n, G - d3_sgn(n) * Math.sqrt(x * x + 0_y * 0_y) ];
        };
        return forward;
    }
    (d3.geo.conicEquidistant = function() {
        return d3_geo_conic(d3_geo_conicEquidistant);
    }).raw = d3_geo_conicEquidistant;
    var d3_geo_gnomonic = d3_geo_azimuthal(function(coscos) {
        return 1 / coscos;
    }, Math.atan);
    (d3.geo.gnomonic = function() {
        return d3_geo_projection(d3_geo_gnomonic);
    }).raw = d3_geo_gnomonic;
    function d3_geo_mercator(, ) {
        return [ , Math.log(Math.tan( / 4 +  / 2)) ];
    }
    d3_geo_mercator.invert = function(x, y) {
        return [ x, 2 * Math.atan(Math.exp(y)) - half ];
    };
    function d3_geo_mercatorProjection(project) {
        var m = d3_geo_projection(project), scale = m.scale, translate = m.translate, clipExtent = m.clipExtent, clipAuto;
        m.scale = function() {
            var v = scale.apply(m, arguments);
            return v === m ? clipAuto ? m.clipExtent(null) : m : v;
        };
        m.translate = function() {
            var v = translate.apply(m, arguments);
            return v === m ? clipAuto ? m.clipExtent(null) : m : v;
        };
        m.clipExtent = function(_) {
            var v = clipExtent.apply(m, arguments);
            if (v === m) {
                if (clipAuto = _ == null) {
                    var k =  * scale(), t = translate();
                    clipExtent([ [ t[0] - k, t[1] - k ], [ t[0] + k, t[1] + k ] ]);
                }
            } else if (clipAuto) {
                v = null;
            }
            return v;
        };
        return m.clipExtent(null);
    }
    (d3.geo.mercator = function() {
        return d3_geo_mercatorProjection(d3_geo_mercator);
    }).raw = d3_geo_mercator;
    var d3_geo_orthographic = d3_geo_azimuthal(function() {
        return 1;
    }, Math.asin);
    (d3.geo.orthographic = function() {
        return d3_geo_projection(d3_geo_orthographic);
    }).raw = d3_geo_orthographic;
    var d3_geo_stereographic = d3_geo_azimuthal(function(coscos) {
        return 1 / (1 + coscos);
    }, function() {
        return 2 * Math.atan();
    });
    (d3.geo.stereographic = function() {
        return d3_geo_projection(d3_geo_stereographic);
    }).raw = d3_geo_stereographic;
    function d3_geo_transverseMercator(, ) {
        return [ Math.log(Math.tan( / 4 +  / 2)), - ];
    }
    d3_geo_transverseMercator.invert = function(x, y) {
        return [ -y, 2 * Math.atan(Math.exp(x)) - half ];
    };
    (d3.geo.transverseMercator = function() {
        var projection = d3_geo_mercatorProjection(d3_geo_transverseMercator), center = projection.center, rotate = projection.rotate;
        projection.center = function(_) {
            return _ ? center([ -_[1], _[0] ]) : (_ = center(), [ _[1], -_[0] ]);
        };
        projection.rotate = function(_) {
            return _ ? rotate([ _[0], _[1], _.length > 2 ? _[2] + 90 : 90 ]) : (_ = rotate(),
                [ _[0], _[1], _[2] - 90 ]);
        };
        return rotate([ 0, 0, 90 ]);
    }).raw = d3_geo_transverseMercator;
    d3.geom = {};
    function d3_geom_pointX(d) {
        return d[0];
    }
    function d3_geom_pointY(d) {
        return d[1];
    }
    d3.geom.hull = function(vertices) {
        var x = d3_geom_pointX, y = d3_geom_pointY;
        if (arguments.length) return hull(vertices);
        function hull(data) {
            if (data.length < 3) return [];
            var fx = d3_functor(x), fy = d3_functor(y), i, n = data.length, points = [], flippedPoints = [];
            for (i = 0; i < n; i++) {
                points.push([ +fx.call(this, data[i], i), +fy.call(this, data[i], i), i ]);
            }
            points.sort(d3_geom_hullOrder);
            for (i = 0; i < n; i++) flippedPoints.push([ points[i][0], -points[i][1] ]);
            var upper = d3_geom_hullUpper(points), lower = d3_geom_hullUpper(flippedPoints);
            var skipLeft = lower[0] === upper[0], skipRight = lower[lower.length - 1] === upper[upper.length - 1], polygon = [];
            for (i = upper.length - 1; i >= 0; --i) polygon.push(data[points[upper[i]][2]]);
            for (i = +skipLeft; i < lower.length - skipRight; ++i) polygon.push(data[points[lower[i]][2]]);
            return polygon;
        }
        hull.x = function(_) {
            return arguments.length ? (x = _, hull) : x;
        };
        hull.y = function(_) {
            return arguments.length ? (y = _, hull) : y;
        };
        return hull;
    };
    function d3_geom_hullUpper(points) {
        var n = points.length, hull = [ 0, 1 ], hs = 2;
        for (var i = 2; i < n; i++) {
            while (hs > 1 && d3_cross2d(points[hull[hs - 2]], points[hull[hs - 1]], points[i]) <= 0) --hs;
            hull[hs++] = i;
        }
        return hull.slice(0, hs);
    }
    function d3_geom_hullOrder(a, b) {
        return a[0] - b[0] || a[1] - b[1];
    }
    d3.geom.polygon = function(coordinates) {
        d3_subclass(coordinates, d3_geom_polygonPrototype);
        return coordinates;
    };
    var d3_geom_polygonPrototype = d3.geom.polygon.prototype = [];
    d3_geom_polygonPrototype.area = function() {
        var i = -1, n = this.length, a, b = this[n - 1], area = 0;
        while (++i < n) {
            a = b;
            b = this[i];
            area += a[1] * b[0] - a[0] * b[1];
        }
        return area * .5;
    };
    d3_geom_polygonPrototype.centroid = function(k) {
        var i = -1, n = this.length, x = 0, y = 0, a, b = this[n - 1], c;
        if (!arguments.length) k = -1 / (6 * this.area());
        while (++i < n) {
            a = b;
            b = this[i];
            c = a[0] * b[1] - b[0] * a[1];
            x += (a[0] + b[0]) * c;
            y += (a[1] + b[1]) * c;
        }
        return [ x * k, y * k ];
    };
    d3_geom_polygonPrototype.clip = function(subject) {
        var input, closed = d3_geom_polygonClosed(subject), i = -1, n = this.length - d3_geom_polygonClosed(this), j, m, a = this[n - 1], b, c, d;
        while (++i < n) {
            input = subject.slice();
            subject.length = 0;
            b = this[i];
            c = input[(m = input.length - closed) - 1];
            j = -1;
            while (++j < m) {
                d = input[j];
                if (d3_geom_polygonInside(d, a, b)) {
                    if (!d3_geom_polygonInside(c, a, b)) {
                        subject.push(d3_geom_polygonIntersect(c, d, a, b));
                    }
                    subject.push(d);
                } else if (d3_geom_polygonInside(c, a, b)) {
                    subject.push(d3_geom_polygonIntersect(c, d, a, b));
                }
                c = d;
            }
            if (closed) subject.push(subject[0]);
            a = b;
        }
        return subject;
    };
    function d3_geom_polygonInside(p, a, b) {
        return (b[0] - a[0]) * (p[1] - a[1]) < (b[1] - a[1]) * (p[0] - a[0]);
    }
    function d3_geom_polygonIntersect(c, d, a, b) {
        var x1 = c[0], x3 = a[0], x21 = d[0] - x1, x43 = b[0] - x3, y1 = c[1], y3 = a[1], y21 = d[1] - y1, y43 = b[1] - y3, ua = (x43 * (y1 - y3) - y43 * (x1 - x3)) / (y43 * x21 - x43 * y21);
        return [ x1 + ua * x21, y1 + ua * y21 ];
    }
    function d3_geom_polygonClosed(coordinates) {
        var a = coordinates[0], b = coordinates[coordinates.length - 1];
        return !(a[0] - b[0] || a[1] - b[1]);
    }
    var d3_geom_voronoiEdges, d3_geom_voronoiCells, d3_geom_voronoiBeaches, d3_geom_voronoiBeachPool = [], d3_geom_voronoiFirstCircle, d3_geom_voronoiCircles, d3_geom_voronoiCirclePool = [];
    function d3_geom_voronoiBeach() {
        d3_geom_voronoiRedBlackNode(this);
        this.edge = this.site = this.circle = null;
    }
    function d3_geom_voronoiCreateBeach(site) {
        var beach = d3_geom_voronoiBeachPool.pop() || new d3_geom_voronoiBeach();
        beach.site = site;
        return beach;
    }
    function d3_geom_voronoiDetachBeach(beach) {
        d3_geom_voronoiDetachCircle(beach);
        d3_geom_voronoiBeaches.remove(beach);
        d3_geom_voronoiBeachPool.push(beach);
        d3_geom_voronoiRedBlackNode(beach);
    }
    function d3_geom_voronoiRemoveBeach(beach) {
        var circle = beach.circle, x = circle.x, y = circle.cy, vertex = {
            x: x,
            y: y
        }, previous = beach.P, next = beach.N, disappearing = [ beach ];
        d3_geom_voronoiDetachBeach(beach);
        var lArc = previous;
        while (lArc.circle && abs(x - lArc.circle.x) <  && abs(y - lArc.circle.cy) < ) {
            previous = lArc.P;
            disappearing.unshift(lArc);
            d3_geom_voronoiDetachBeach(lArc);
            lArc = previous;
        }
        disappearing.unshift(lArc);
        d3_geom_voronoiDetachCircle(lArc);
        var rArc = next;
        while (rArc.circle && abs(x - rArc.circle.x) <  && abs(y - rArc.circle.cy) < ) {
            next = rArc.N;
            disappearing.push(rArc);
            d3_geom_voronoiDetachBeach(rArc);
            rArc = next;
        }
        disappearing.push(rArc);
        d3_geom_voronoiDetachCircle(rArc);
        var nArcs = disappearing.length, iArc;
        for (iArc = 1; iArc < nArcs; ++iArc) {
            rArc = disappearing[iArc];
            lArc = disappearing[iArc - 1];
            d3_geom_voronoiSetEdgeEnd(rArc.edge, lArc.site, rArc.site, vertex);
        }
        lArc = disappearing[0];
        rArc = disappearing[nArcs - 1];
        rArc.edge = d3_geom_voronoiCreateEdge(lArc.site, rArc.site, null, vertex);
        d3_geom_voronoiAttachCircle(lArc);
        d3_geom_voronoiAttachCircle(rArc);
    }
    function d3_geom_voronoiAddBeach(site) {
        var x = site.x, directrix = site.y, lArc, rArc, dxl, dxr, node = d3_geom_voronoiBeaches._;
        while (node) {
            dxl = d3_geom_voronoiLeftBreakPoint(node, directrix) - x;
            if (dxl > ) node = node.L; else {
                dxr = x - d3_geom_voronoiRightBreakPoint(node, directrix);
                if (dxr > ) {
                    if (!node.R) {
                        lArc = node;
                        break;
                    }
                    node = node.R;
                } else {
                    if (dxl > -) {
                        lArc = node.P;
                        rArc = node;
                    } else if (dxr > -) {
                        lArc = node;
                        rArc = node.N;
                    } else {
                        lArc = rArc = node;
                    }
                    break;
                }
            }
        }
        var newArc = d3_geom_voronoiCreateBeach(site);
        d3_geom_voronoiBeaches.insert(lArc, newArc);
        if (!lArc && !rArc) return;
        if (lArc === rArc) {
            d3_geom_voronoiDetachCircle(lArc);
            rArc = d3_geom_voronoiCreateBeach(lArc.site);
            d3_geom_voronoiBeaches.insert(newArc, rArc);
            newArc.edge = rArc.edge = d3_geom_voronoiCreateEdge(lArc.site, newArc.site);
            d3_geom_voronoiAttachCircle(lArc);
            d3_geom_voronoiAttachCircle(rArc);
            return;
        }
        if (!rArc) {
            newArc.edge = d3_geom_voronoiCreateEdge(lArc.site, newArc.site);
            return;
        }
        d3_geom_voronoiDetachCircle(lArc);
        d3_geom_voronoiDetachCircle(rArc);
        var lSite = lArc.site, ax = lSite.x, ay = lSite.y, bx = site.x - ax, by = site.y - ay, rSite = rArc.site, cx = rSite.x - ax, cy = rSite.y - ay, d = 2 * (bx * cy - by * cx), hb = bx * bx + by * by, hc = cx * cx + cy * cy, vertex = {
            x: (cy * hb - by * hc) / d + ax,
            y: (bx * hc - cx * hb) / d + ay
        };
        d3_geom_voronoiSetEdgeEnd(rArc.edge, lSite, rSite, vertex);
        newArc.edge = d3_geom_voronoiCreateEdge(lSite, site, null, vertex);
        rArc.edge = d3_geom_voronoiCreateEdge(site, rSite, null, vertex);
        d3_geom_voronoiAttachCircle(lArc);
        d3_geom_voronoiAttachCircle(rArc);
    }
    function d3_geom_voronoiLeftBreakPoint(arc, directrix) {
        var site = arc.site, rfocx = site.x, rfocy = site.y, pby2 = rfocy - directrix;
        if (!pby2) return rfocx;
        var lArc = arc.P;
        if (!lArc) return -Infinity;
        site = lArc.site;
        var lfocx = site.x, lfocy = site.y, plby2 = lfocy - directrix;
        if (!plby2) return lfocx;
        var hl = lfocx - rfocx, aby2 = 1 / pby2 - 1 / plby2, b = hl / plby2;
        if (aby2) return (-b + Math.sqrt(b * b - 2 * aby2 * (hl * hl / (-2 * plby2) - lfocy + plby2 / 2 + rfocy - pby2 / 2))) / aby2 + rfocx;
        return (rfocx + lfocx) / 2;
    }
    function d3_geom_voronoiRightBreakPoint(arc, directrix) {
        var rArc = arc.N;
        if (rArc) return d3_geom_voronoiLeftBreakPoint(rArc, directrix);
        var site = arc.site;
        return site.y === directrix ? site.x : Infinity;
    }
    function d3_geom_voronoiCell(site) {
        this.site = site;
        this.edges = [];
    }
    d3_geom_voronoiCell.prototype.prepare = function() {
        var halfEdges = this.edges, iHalfEdge = halfEdges.length, edge;
        while (iHalfEdge--) {
            edge = halfEdges[iHalfEdge].edge;
            if (!edge.b || !edge.a) halfEdges.splice(iHalfEdge, 1);
        }
        halfEdges.sort(d3_geom_voronoiHalfEdgeOrder);
        return halfEdges.length;
    };
    function d3_geom_voronoiCloseCells(extent) {
        var x0 = extent[0][0], x1 = extent[1][0], y0 = extent[0][1], y1 = extent[1][1], x2, y2, x3, y3, cells = d3_geom_voronoiCells, iCell = cells.length, cell, iHalfEdge, halfEdges, nHalfEdges, start, end;
        while (iCell--) {
            cell = cells[iCell];
            if (!cell || !cell.prepare()) continue;
            halfEdges = cell.edges;
            nHalfEdges = halfEdges.length;
            iHalfEdge = 0;
            while (iHalfEdge < nHalfEdges) {
                end = halfEdges[iHalfEdge].end(), x3 = end.x, y3 = end.y;
                start = halfEdges[++iHalfEdge % nHalfEdges].start(), x2 = start.x, y2 = start.y;
                if (abs(x3 - x2) >  || abs(y3 - y2) > ) {
                    halfEdges.splice(iHalfEdge, 0, new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(cell.site, end, abs(x3 - x0) <  && y1 - y3 >  ? {
                        x: x0,
                        y: abs(x2 - x0) <  ? y2 : y1
                    } : abs(y3 - y1) <  && x1 - x3 >  ? {
                        x: abs(y2 - y1) <  ? x2 : x1,
                        y: y1
                    } : abs(x3 - x1) <  && y3 - y0 >  ? {
                        x: x1,
                        y: abs(x2 - x1) <  ? y2 : y0
                    } : abs(y3 - y0) <  && x3 - x0 >  ? {
                        x: abs(y2 - y0) <  ? x2 : x0,
                        y: y0
                    } : null), cell.site, null));
                    ++nHalfEdges;
                }
            }
        }
    }
    function d3_geom_voronoiHalfEdgeOrder(a, b) {
        return b.angle - a.angle;
    }
    function d3_geom_voronoiCircle() {
        d3_geom_voronoiRedBlackNode(this);
        this.x = this.y = this.arc = this.site = this.cy = null;
    }
    function d3_geom_voronoiAttachCircle(arc) {
        var lArc = arc.P, rArc = arc.N;
        if (!lArc || !rArc) return;
        var lSite = lArc.site, cSite = arc.site, rSite = rArc.site;
        if (lSite === rSite) return;
        var bx = cSite.x, by = cSite.y, ax = lSite.x - bx, ay = lSite.y - by, cx = rSite.x - bx, cy = rSite.y - by;
        var d = 2 * (ax * cy - ay * cx);
        if (d >= -2) return;
        var ha = ax * ax + ay * ay, hc = cx * cx + cy * cy, x = (cy * ha - ay * hc) / d, y = (ax * hc - cx * ha) / d, cy = y + by;
        var circle = d3_geom_voronoiCirclePool.pop() || new d3_geom_voronoiCircle();
        circle.arc = arc;
        circle.site = cSite;
        circle.x = x + bx;
        circle.y = cy + Math.sqrt(x * x + y * y);
        circle.cy = cy;
        arc.circle = circle;
        var before = null, node = d3_geom_voronoiCircles._;
        while (node) {
            if (circle.y < node.y || circle.y === node.y && circle.x <= node.x) {
                if (node.L) node = node.L; else {
                    before = node.P;
                    break;
                }
            } else {
                if (node.R) node = node.R; else {
                    before = node;
                    break;
                }
            }
        }
        d3_geom_voronoiCircles.insert(before, circle);
        if (!before) d3_geom_voronoiFirstCircle = circle;
    }
    function d3_geom_voronoiDetachCircle(arc) {
        var circle = arc.circle;
        if (circle) {
            if (!circle.P) d3_geom_voronoiFirstCircle = circle.N;
            d3_geom_voronoiCircles.remove(circle);
            d3_geom_voronoiCirclePool.push(circle);
            d3_geom_voronoiRedBlackNode(circle);
            arc.circle = null;
        }
    }
    function d3_geom_voronoiClipEdges(extent) {
        var edges = d3_geom_voronoiEdges, clip = d3_geom_clipLine(extent[0][0], extent[0][1], extent[1][0], extent[1][1]), i = edges.length, e;
        while (i--) {
            e = edges[i];
            if (!d3_geom_voronoiConnectEdge(e, extent) || !clip(e) || abs(e.a.x - e.b.x) <  && abs(e.a.y - e.b.y) < ) {
                e.a = e.b = null;
                edges.splice(i, 1);
            }
        }
    }
    function d3_geom_voronoiConnectEdge(edge, extent) {
        var vb = edge.b;
        if (vb) return true;
        var va = edge.a, x0 = extent[0][0], x1 = extent[1][0], y0 = extent[0][1], y1 = extent[1][1], lSite = edge.l, rSite = edge.r, lx = lSite.x, ly = lSite.y, rx = rSite.x, ry = rSite.y, fx = (lx + rx) / 2, fy = (ly + ry) / 2, fm, fb;
        if (ry === ly) {
            if (fx < x0 || fx >= x1) return;
            if (lx > rx) {
                if (!va) va = {
                    x: fx,
                    y: y0
                }; else if (va.y >= y1) return;
                vb = {
                    x: fx,
                    y: y1
                };
            } else {
                if (!va) va = {
                    x: fx,
                    y: y1
                }; else if (va.y < y0) return;
                vb = {
                    x: fx,
                    y: y0
                };
            }
        } else {
            fm = (lx - rx) / (ry - ly);
            fb = fy - fm * fx;
            if (fm < -1 || fm > 1) {
                if (lx > rx) {
                    if (!va) va = {
                        x: (y0 - fb) / fm,
                        y: y0
                    }; else if (va.y >= y1) return;
                    vb = {
                        x: (y1 - fb) / fm,
                        y: y1
                    };
                } else {
                    if (!va) va = {
                        x: (y1 - fb) / fm,
                        y: y1
                    }; else if (va.y < y0) return;
                    vb = {
                        x: (y0 - fb) / fm,
                        y: y0
                    };
                }
            } else {
                if (ly < ry) {
                    if (!va) va = {
                        x: x0,
                        y: fm * x0 + fb
                    }; else if (va.x >= x1) return;
                    vb = {
                        x: x1,
                        y: fm * x1 + fb
                    };
                } else {
                    if (!va) va = {
                        x: x1,
                        y: fm * x1 + fb
                    }; else if (va.x < x0) return;
                    vb = {
                        x: x0,
                        y: fm * x0 + fb
                    };
                }
            }
        }
        edge.a = va;
        edge.b = vb;
        return true;
    }
    function d3_geom_voronoiEdge(lSite, rSite) {
        this.l = lSite;
        this.r = rSite;
        this.a = this.b = null;
    }
    function d3_geom_voronoiCreateEdge(lSite, rSite, va, vb) {
        var edge = new d3_geom_voronoiEdge(lSite, rSite);
        d3_geom_voronoiEdges.push(edge);
        if (va) d3_geom_voronoiSetEdgeEnd(edge, lSite, rSite, va);
        if (vb) d3_geom_voronoiSetEdgeEnd(edge, rSite, lSite, vb);
        d3_geom_voronoiCells[lSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge, lSite, rSite));
        d3_geom_voronoiCells[rSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge, rSite, lSite));
        return edge;
    }
    function d3_geom_voronoiCreateBorderEdge(lSite, va, vb) {
        var edge = new d3_geom_voronoiEdge(lSite, null);
        edge.a = va;
        edge.b = vb;
        d3_geom_voronoiEdges.push(edge);
        return edge;
    }
    function d3_geom_voronoiSetEdgeEnd(edge, lSite, rSite, vertex) {
        if (!edge.a && !edge.b) {
            edge.a = vertex;
            edge.l = lSite;
            edge.r = rSite;
        } else if (edge.l === rSite) {
            edge.b = vertex;
        } else {
            edge.a = vertex;
        }
    }
    function d3_geom_voronoiHalfEdge(edge, lSite, rSite) {
        var va = edge.a, vb = edge.b;
        this.edge = edge;
        this.site = lSite;
        this.angle = rSite ? Math.atan2(rSite.y - lSite.y, rSite.x - lSite.x) : edge.l === lSite ? Math.atan2(vb.x - va.x, va.y - vb.y) : Math.atan2(va.x - vb.x, vb.y - va.y);
    }
    d3_geom_voronoiHalfEdge.prototype = {
        start: function() {
            return this.edge.l === this.site ? this.edge.a : this.edge.b;
        },
        end: function() {
            return this.edge.l === this.site ? this.edge.b : this.edge.a;
        }
    };
    function d3_geom_voronoiRedBlackTree() {
        this._ = null;
    }
    function d3_geom_voronoiRedBlackNode(node) {
        node.U = node.C = node.L = node.R = node.P = node.N = null;
    }
    d3_geom_voronoiRedBlackTree.prototype = {
        insert: function(after, node) {
            var parent, grandpa, uncle;
            if (after) {
                node.P = after;
                node.N = after.N;
                if (after.N) after.N.P = node;
                after.N = node;
                if (after.R) {
                    after = after.R;
                    while (after.L) after = after.L;
                    after.L = node;
                } else {
                    after.R = node;
                }
                parent = after;
            } else if (this._) {
                after = d3_geom_voronoiRedBlackFirst(this._);
                node.P = null;
                node.N = after;
                after.P = after.L = node;
                parent = after;
            } else {
                node.P = node.N = null;
                this._ = node;
                parent = null;
            }
            node.L = node.R = null;
            node.U = parent;
            node.C = true;
            after = node;
            while (parent && parent.C) {
                grandpa = parent.U;
                if (parent === grandpa.L) {
                    uncle = grandpa.R;
                    if (uncle && uncle.C) {
                        parent.C = uncle.C = false;
                        grandpa.C = true;
                        after = grandpa;
                    } else {
                        if (after === parent.R) {
                            d3_geom_voronoiRedBlackRotateLeft(this, parent);
                            after = parent;
                            parent = after.U;
                        }
                        parent.C = false;
                        grandpa.C = true;
                        d3_geom_voronoiRedBlackRotateRight(this, grandpa);
                    }
                } else {
                    uncle = grandpa.L;
                    if (uncle && uncle.C) {
                        parent.C = uncle.C = false;
                        grandpa.C = true;
                        after = grandpa;
                    } else {
                        if (after === parent.L) {
                            d3_geom_voronoiRedBlackRotateRight(this, parent);
                            after = parent;
                            parent = after.U;
                        }
                        parent.C = false;
                        grandpa.C = true;
                        d3_geom_voronoiRedBlackRotateLeft(this, grandpa);
                    }
                }
                parent = after.U;
            }
            this._.C = false;
        },
        remove: function(node) {
            if (node.N) node.N.P = node.P;
            if (node.P) node.P.N = node.N;
            node.N = node.P = null;
            var parent = node.U, sibling, left = node.L, right = node.R, next, red;
            if (!left) next = right; else if (!right) next = left; else next = d3_geom_voronoiRedBlackFirst(right);
            if (parent) {
                if (parent.L === node) parent.L = next; else parent.R = next;
            } else {
                this._ = next;
            }
            if (left && right) {
                red = next.C;
                next.C = node.C;
                next.L = left;
                left.U = next;
                if (next !== right) {
                    parent = next.U;
                    next.U = node.U;
                    node = next.R;
                    parent.L = node;
                    next.R = right;
                    right.U = next;
                } else {
                    next.U = parent;
                    parent = next;
                    node = next.R;
                }
            } else {
                red = node.C;
                node = next;
            }
            if (node) node.U = parent;
            if (red) return;
            if (node && node.C) {
                node.C = false;
                return;
            }
            do {
                if (node === this._) break;
                if (node === parent.L) {
                    sibling = parent.R;
                    if (sibling.C) {
                        sibling.C = false;
                        parent.C = true;
                        d3_geom_voronoiRedBlackRotateLeft(this, parent);
                        sibling = parent.R;
                    }
                    if (sibling.L && sibling.L.C || sibling.R && sibling.R.C) {
                        if (!sibling.R || !sibling.R.C) {
                            sibling.L.C = false;
                            sibling.C = true;
                            d3_geom_voronoiRedBlackRotateRight(this, sibling);
                            sibling = parent.R;
                        }
                        sibling.C = parent.C;
                        parent.C = sibling.R.C = false;
                        d3_geom_voronoiRedBlackRotateLeft(this, parent);
                        node = this._;
                        break;
                    }
                } else {
                    sibling = parent.L;
                    if (sibling.C) {
                        sibling.C = false;
                        parent.C = true;
                        d3_geom_voronoiRedBlackRotateRight(this, parent);
                        sibling = parent.L;
                    }
                    if (sibling.L && sibling.L.C || sibling.R && sibling.R.C) {
                        if (!sibling.L || !sibling.L.C) {
                            sibling.R.C = false;
                            sibling.C = true;
                            d3_geom_voronoiRedBlackRotateLeft(this, sibling);
                            sibling = parent.L;
                        }
                        sibling.C = parent.C;
                        parent.C = sibling.L.C = false;
                        d3_geom_voronoiRedBlackRotateRight(this, parent);
                        node = this._;
                        break;
                    }
                }
                sibling.C = true;
                node = parent;
                parent = parent.U;
            } while (!node.C);
            if (node) node.C = false;
        }
    };
    function d3_geom_voronoiRedBlackRotateLeft(tree, node) {
        var p = node, q = node.R, parent = p.U;
        if (parent) {
            if (parent.L === p) parent.L = q; else parent.R = q;
        } else {
            tree._ = q;
        }
        q.U = parent;
        p.U = q;
        p.R = q.L;
        if (p.R) p.R.U = p;
        q.L = p;
    }
    function d3_geom_voronoiRedBlackRotateRight(tree, node) {
        var p = node, q = node.L, parent = p.U;
        if (parent) {
            if (parent.L === p) parent.L = q; else parent.R = q;
        } else {
            tree._ = q;
        }
        q.U = parent;
        p.U = q;
        p.L = q.R;
        if (p.L) p.L.U = p;
        q.R = p;
    }
    function d3_geom_voronoiRedBlackFirst(node) {
        while (node.L) node = node.L;
        return node;
    }
    function d3_geom_voronoi(sites, bbox) {
        var site = sites.sort(d3_geom_voronoiVertexOrder).pop(), x0, y0, circle;
        d3_geom_voronoiEdges = [];
        d3_geom_voronoiCells = new Array(sites.length);
        d3_geom_voronoiBeaches = new d3_geom_voronoiRedBlackTree();
        d3_geom_voronoiCircles = new d3_geom_voronoiRedBlackTree();
        while (true) {
            circle = d3_geom_voronoiFirstCircle;
            if (site && (!circle || site.y < circle.y || site.y === circle.y && site.x < circle.x)) {
                if (site.x !== x0 || site.y !== y0) {
                    d3_geom_voronoiCells[site.i] = new d3_geom_voronoiCell(site);
                    d3_geom_voronoiAddBeach(site);
                    x0 = site.x, y0 = site.y;
                }
                site = sites.pop();
            } else if (circle) {
                d3_geom_voronoiRemoveBeach(circle.arc);
            } else {
                break;
            }
        }
        if (bbox) d3_geom_voronoiClipEdges(bbox), d3_geom_voronoiCloseCells(bbox);
        var diagram = {
            cells: d3_geom_voronoiCells,
            edges: d3_geom_voronoiEdges
        };
        d3_geom_voronoiBeaches = d3_geom_voronoiCircles = d3_geom_voronoiEdges = d3_geom_voronoiCells = null;
        return diagram;
    }
    function d3_geom_voronoiVertexOrder(a, b) {
        return b.y - a.y || b.x - a.x;
    }
    d3.geom.voronoi = function(points) {
        var x = d3_geom_pointX, y = d3_geom_pointY, fx = x, fy = y, clipExtent = d3_geom_voronoiClipExtent;
        if (points) return voronoi(points);
        function voronoi(data) {
            var polygons = new Array(data.length), x0 = clipExtent[0][0], y0 = clipExtent[0][1], x1 = clipExtent[1][0], y1 = clipExtent[1][1];
            d3_geom_voronoi(sites(data), clipExtent).cells.forEach(function(cell, i) {
                var edges = cell.edges, site = cell.site, polygon = polygons[i] = edges.length ? edges.map(function(e) {
                    var s = e.start();
                    return [ s.x, s.y ];
                }) : site.x >= x0 && site.x <= x1 && site.y >= y0 && site.y <= y1 ? [ [ x0, y1 ], [ x1, y1 ], [ x1, y0 ], [ x0, y0 ] ] : [];
                polygon.point = data[i];
            });
            return polygons;
        }
        function sites(data) {
            return data.map(function(d, i) {
                return {
                    x: Math.round(fx(d, i) / ) * ,
                    y: Math.round(fy(d, i) / ) * ,
                    i: i
                };
            });
        }
        voronoi.links = function(data) {
            return d3_geom_voronoi(sites(data)).edges.filter(function(edge) {
                return edge.l && edge.r;
            }).map(function(edge) {
                return {
                    source: data[edge.l.i],
                    target: data[edge.r.i]
                };
            });
        };
        voronoi.triangles = function(data) {
            var triangles = [];
            d3_geom_voronoi(sites(data)).cells.forEach(function(cell, i) {
                var site = cell.site, edges = cell.edges.sort(d3_geom_voronoiHalfEdgeOrder), j = -1, m = edges.length, e0, s0, e1 = edges[m - 1].edge, s1 = e1.l === site ? e1.r : e1.l;
                while (++j < m) {
                    e0 = e1;
                    s0 = s1;
                    e1 = edges[j].edge;
                    s1 = e1.l === site ? e1.r : e1.l;
                    if (i < s0.i && i < s1.i && d3_geom_voronoiTriangleArea(site, s0, s1) < 0) {
                        triangles.push([ data[i], data[s0.i], data[s1.i] ]);
                    }
                }
            });
            return triangles;
        };
        voronoi.x = function(_) {
            return arguments.length ? (fx = d3_functor(x = _), voronoi) : x;
        };
        voronoi.y = function(_) {
            return arguments.length ? (fy = d3_functor(y = _), voronoi) : y;
        };
        voronoi.clipExtent = function(_) {
            if (!arguments.length) return clipExtent === d3_geom_voronoiClipExtent ? null : clipExtent;
            clipExtent = _ == null ? d3_geom_voronoiClipExtent : _;
            return voronoi;
        };
        voronoi.size = function(_) {
            if (!arguments.length) return clipExtent === d3_geom_voronoiClipExtent ? null : clipExtent && clipExtent[1];
            return voronoi.clipExtent(_ && [ [ 0, 0 ], _ ]);
        };
        return voronoi;
    };
    var d3_geom_voronoiClipExtent = [ [ -1e6, -1e6 ], [ 1e6, 1e6 ] ];
    function d3_geom_voronoiTriangleArea(a, b, c) {
        return (a.x - c.x) * (b.y - a.y) - (a.x - b.x) * (c.y - a.y);
    }
    d3.geom.delaunay = function(vertices) {
        return d3.geom.voronoi().triangles(vertices);
    };
    d3.geom.quadtree = function(points, x1, y1, x2, y2) {
        var x = d3_geom_pointX, y = d3_geom_pointY, compat;
        if (compat = arguments.length) {
            x = d3_geom_quadtreeCompatX;
            y = d3_geom_quadtreeCompatY;
            if (compat === 3) {
                y2 = y1;
                x2 = x1;
                y1 = x1 = 0;
            }
            return quadtree(points);
        }
        function quadtree(data) {
            var d, fx = d3_functor(x), fy = d3_functor(y), xs, ys, i, n, x1_, y1_, x2_, y2_;
            if (x1 != null) {
                x1_ = x1, y1_ = y1, x2_ = x2, y2_ = y2;
            } else {
                x2_ = y2_ = -(x1_ = y1_ = Infinity);
                xs = [], ys = [];
                n = data.length;
                if (compat) for (i = 0; i < n; ++i) {
                    d = data[i];
                    if (d.x < x1_) x1_ = d.x;
                    if (d.y < y1_) y1_ = d.y;
                    if (d.x > x2_) x2_ = d.x;
                    if (d.y > y2_) y2_ = d.y;
                    xs.push(d.x);
                    ys.push(d.y);
                } else for (i = 0; i < n; ++i) {
                    var x_ = +fx(d = data[i], i), y_ = +fy(d, i);
                    if (x_ < x1_) x1_ = x_;
                    if (y_ < y1_) y1_ = y_;
                    if (x_ > x2_) x2_ = x_;
                    if (y_ > y2_) y2_ = y_;
                    xs.push(x_);
                    ys.push(y_);
                }
            }
            var dx = x2_ - x1_, dy = y2_ - y1_;
            if (dx > dy) y2_ = y1_ + dx; else x2_ = x1_ + dy;
            function insert(n, d, x, y, x1, y1, x2, y2) {
                if (isNaN(x) || isNaN(y)) return;
                if (n.leaf) {
                    var nx = n.x, ny = n.y;
                    if (nx != null) {
                        if (abs(nx - x) + abs(ny - y) < .01) {
                            insertChild(n, d, x, y, x1, y1, x2, y2);
                        } else {
                            var nPoint = n.point;
                            n.x = n.y = n.point = null;
                            insertChild(n, nPoint, nx, ny, x1, y1, x2, y2);
                            insertChild(n, d, x, y, x1, y1, x2, y2);
                        }
                    } else {
                        n.x = x, n.y = y, n.point = d;
                    }
                } else {
                    insertChild(n, d, x, y, x1, y1, x2, y2);
                }
            }
            function insertChild(n, d, x, y, x1, y1, x2, y2) {
                var xm = (x1 + x2) * .5, ym = (y1 + y2) * .5, right = x >= xm, below = y >= ym, i = below << 1 | right;
                n.leaf = false;
                n = n.nodes[i] || (n.nodes[i] = d3_geom_quadtreeNode());
                if (right) x1 = xm; else x2 = xm;
                if (below) y1 = ym; else y2 = ym;
                insert(n, d, x, y, x1, y1, x2, y2);
            }
            var root = d3_geom_quadtreeNode();
            root.add = function(d) {
                insert(root, d, +fx(d, ++i), +fy(d, i), x1_, y1_, x2_, y2_);
            };
            root.visit = function(f) {
                d3_geom_quadtreeVisit(f, root, x1_, y1_, x2_, y2_);
            };
            root.find = function(point) {
                return d3_geom_quadtreeFind(root, point[0], point[1], x1_, y1_, x2_, y2_);
            };
            i = -1;
            if (x1 == null) {
                while (++i < n) {
                    insert(root, data[i], xs[i], ys[i], x1_, y1_, x2_, y2_);
                }
                --i;
            } else data.forEach(root.add);
            xs = ys = data = d = null;
            return root;
        }
        quadtree.x = function(_) {
            return arguments.length ? (x = _, quadtree) : x;
        };
        quadtree.y = function(_) {
            return arguments.length ? (y = _, quadtree) : y;
        };
        quadtree.extent = function(_) {
            if (!arguments.length) return x1 == null ? null : [ [ x1, y1 ], [ x2, y2 ] ];
            if (_ == null) x1 = y1 = x2 = y2 = null; else x1 = +_[0][0], y1 = +_[0][1], x2 = +_[1][0],
                y2 = +_[1][1];
            return quadtree;
        };
        quadtree.size = function(_) {
            if (!arguments.length) return x1 == null ? null : [ x2 - x1, y2 - y1 ];
            if (_ == null) x1 = y1 = x2 = y2 = null; else x1 = y1 = 0, x2 = +_[0], y2 = +_[1];
            return quadtree;
        };
        return quadtree;
    };
    function d3_geom_quadtreeCompatX(d) {
        return d.x;
    }
    function d3_geom_quadtreeCompatY(d) {
        return d.y;
    }
    function d3_geom_quadtreeNode() {
        return {
            leaf: true,
            nodes: [],
            point: null,
            x: null,
            y: null
        };
    }
    function d3_geom_quadtreeVisit(f, node, x1, y1, x2, y2) {
        if (!f(node, x1, y1, x2, y2)) {
            var sx = (x1 + x2) * .5, sy = (y1 + y2) * .5, children = node.nodes;
            if (children[0]) d3_geom_quadtreeVisit(f, children[0], x1, y1, sx, sy);
            if (children[1]) d3_geom_quadtreeVisit(f, children[1], sx, y1, x2, sy);
            if (children[2]) d3_geom_quadtreeVisit(f, children[2], x1, sy, sx, y2);
            if (children[3]) d3_geom_quadtreeVisit(f, children[3], sx, sy, x2, y2);
        }
    }
    function d3_geom_quadtreeFind(root, x, y, x0, y0, x3, y3) {
        var minDistance2 = Infinity, closestPoint;
        (function find(node, x1, y1, x2, y2) {
            if (x1 > x3 || y1 > y3 || x2 < x0 || y2 < y0) return;
            if (point = node.point) {
                var point, dx = x - node.x, dy = y - node.y, distance2 = dx * dx + dy * dy;
                if (distance2 < minDistance2) {
                    var distance = Math.sqrt(minDistance2 = distance2);
                    x0 = x - distance, y0 = y - distance;
                    x3 = x + distance, y3 = y + distance;
                    closestPoint = point;
                }
            }
            var children = node.nodes, xm = (x1 + x2) * .5, ym = (y1 + y2) * .5, right = x >= xm, below = y >= ym;
            for (var i = below << 1 | right, j = i + 4; i < j; ++i) {
                if (node = children[i & 3]) switch (i & 3) {
                    case 0:
                        find(node, x1, y1, xm, ym);
                        break;

                    case 1:
                        find(node, xm, y1, x2, ym);
                        break;

                    case 2:
                        find(node, x1, ym, xm, y2);
                        break;

                    case 3:
                        find(node, xm, ym, x2, y2);
                        break;
                }
            }
        })(root, x0, y0, x3, y3);
        return closestPoint;
    }
    d3.interpolateRgb = d3_interpolateRgb;
    function d3_interpolateRgb(a, b) {
        a = d3.rgb(a);
        b = d3.rgb(b);
        var ar = a.r, ag = a.g, ab = a.b, br = b.r - ar, bg = b.g - ag, bb = b.b - ab;
        return function(t) {
            return "#" + d3_rgb_hex(Math.round(ar + br * t)) + d3_rgb_hex(Math.round(ag + bg * t)) + d3_rgb_hex(Math.round(ab + bb * t));
        };
    }
    d3.interpolateObject = d3_interpolateObject;
    function d3_interpolateObject(a, b) {
        var i = {}, c = {}, k;
        for (k in a) {
            if (k in b) {
                i[k] = d3_interpolate(a[k], b[k]);
            } else {
                c[k] = a[k];
            }
        }
        for (k in b) {
            if (!(k in a)) {
                c[k] = b[k];
            }
        }
        return function(t) {
            for (k in i) c[k] = i[k](t);
            return c;
        };
    }
    d3.interpolateNumber = d3_interpolateNumber;
    function d3_interpolateNumber(a, b) {
        a = +a, b = +b;
        return function(t) {
            return a * (1 - t) + b * t;
        };
    }
    d3.interpolateString = d3_interpolateString;
    function d3_interpolateString(a, b) {
        var bi = d3_interpolate_numberA.lastIndex = d3_interpolate_numberB.lastIndex = 0, am, bm, bs, i = -1, s = [], q = [];
        a = a + "", b = b + "";
        while ((am = d3_interpolate_numberA.exec(a)) && (bm = d3_interpolate_numberB.exec(b))) {
            if ((bs = bm.index) > bi) {
                bs = b.slice(bi, bs);
                if (s[i]) s[i] += bs; else s[++i] = bs;
            }
            if ((am = am[0]) === (bm = bm[0])) {
                if (s[i]) s[i] += bm; else s[++i] = bm;
            } else {
                s[++i] = null;
                q.push({
                    i: i,
                    x: d3_interpolateNumber(am, bm)
                });
            }
            bi = d3_interpolate_numberB.lastIndex;
        }
        if (bi < b.length) {
            bs = b.slice(bi);
            if (s[i]) s[i] += bs; else s[++i] = bs;
        }
        return s.length < 2 ? q[0] ? (b = q[0].x, function(t) {
            return b(t) + "";
        }) : function() {
            return b;
        } : (b = q.length, function(t) {
            for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);
            return s.join("");
        });
    }
    var d3_interpolate_numberA = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, d3_interpolate_numberB = new RegExp(d3_interpolate_numberA.source, "g");
    d3.interpolate = d3_interpolate;
    function d3_interpolate(a, b) {
        var i = d3.interpolators.length, f;
        while (--i >= 0 && !(f = d3.interpolators[i](a, b))) ;
        return f;
    }
    d3.interpolators = [ function(a, b) {
        var t = typeof b;
        return (t === "string" ? d3_rgb_names.has(b) || /^(#|rgb\(|hsl\()/.test(b) ? d3_interpolateRgb : d3_interpolateString : b instanceof d3_color ? d3_interpolateRgb : Array.isArray(b) ? d3_interpolateArray : t === "object" && isNaN(b) ? d3_interpolateObject : d3_interpolateNumber)(a, b);
    } ];
    d3.interpolateArray = d3_interpolateArray;
    function d3_interpolateArray(a, b) {
        var x = [], c = [], na = a.length, nb = b.length, n0 = Math.min(a.length, b.length), i;
        for (i = 0; i < n0; ++i) x.push(d3_interpolate(a[i], b[i]));
        for (;i < na; ++i) c[i] = a[i];
        for (;i < nb; ++i) c[i] = b[i];
        return function(t) {
            for (i = 0; i < n0; ++i) c[i] = x[i](t);
            return c;
        };
    }
    var d3_ease_default = function() {
        return d3_identity;
    };
    var d3_ease = d3.map({
        linear: d3_ease_default,
        poly: d3_ease_poly,
        quad: function() {
            return d3_ease_quad;
        },
        cubic: function() {
            return d3_ease_cubic;
        },
        sin: function() {
            return d3_ease_sin;
        },
        exp: function() {
            return d3_ease_exp;
        },
        circle: function() {
            return d3_ease_circle;
        },
        elastic: d3_ease_elastic,
        back: d3_ease_back,
        bounce: function() {
            return d3_ease_bounce;
        }
    });
    var d3_ease_mode = d3.map({
        "in": d3_identity,
        out: d3_ease_reverse,
        "in-out": d3_ease_reflect,
        "out-in": function(f) {
            return d3_ease_reflect(d3_ease_reverse(f));
        }
    });
    d3.ease = function(name) {
        var i = name.indexOf("-"), t = i >= 0 ? name.slice(0, i) : name, m = i >= 0 ? name.slice(i + 1) : "in";
        t = d3_ease.get(t) || d3_ease_default;
        m = d3_ease_mode.get(m) || d3_identity;
        return d3_ease_clamp(m(t.apply(null, d3_arraySlice.call(arguments, 1))));
    };
    function d3_ease_clamp(f) {
        return function(t) {
            return t <= 0 ? 0 : t >= 1 ? 1 : f(t);
        };
    }
    function d3_ease_reverse(f) {
        return function(t) {
            return 1 - f(1 - t);
        };
    }
    function d3_ease_reflect(f) {
        return function(t) {
            return .5 * (t < .5 ? f(2 * t) : 2 - f(2 - 2 * t));
        };
    }
    function d3_ease_quad(t) {
        return t * t;
    }
    function d3_ease_cubic(t) {
        return t * t * t;
    }
    function d3_ease_cubicInOut(t) {
        if (t <= 0) return 0;
        if (t >= 1) return 1;
        var t2 = t * t, t3 = t2 * t;
        return 4 * (t < .5 ? t3 : 3 * (t - t2) + t3 - .75);
    }
    function d3_ease_poly(e) {
        return function(t) {
            return Math.pow(t, e);
        };
    }
    function d3_ease_sin(t) {
        return 1 - Math.cos(t * half);
    }
    function d3_ease_exp(t) {
        return Math.pow(2, 10 * (t - 1));
    }
    function d3_ease_circle(t) {
        return 1 - Math.sqrt(1 - t * t);
    }
    function d3_ease_elastic(a, p) {
        var s;
        if (arguments.length < 2) p = .45;
        if (arguments.length) s = p /  * Math.asin(1 / a); else a = 1, s = p / 4;
        return function(t) {
            return 1 + a * Math.pow(2, -10 * t) * Math.sin((t - s) *  / p);
        };
    }
    function d3_ease_back(s) {
        if (!s) s = 1.70158;
        return function(t) {
            return t * t * ((s + 1) * t - s);
        };
    }
    function d3_ease_bounce(t) {
        return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
    }
    d3.interpolateHcl = d3_interpolateHcl;
    function d3_interpolateHcl(a, b) {
        a = d3.hcl(a);
        b = d3.hcl(b);
        var ah = a.h, ac = a.c, al = a.l, bh = b.h - ah, bc = b.c - ac, bl = b.l - al;
        if (isNaN(bc)) bc = 0, ac = isNaN(ac) ? b.c : ac;
        if (isNaN(bh)) bh = 0, ah = isNaN(ah) ? b.h : ah; else if (bh > 180) bh -= 360; else if (bh < -180) bh += 360;
        return function(t) {
            return d3_hcl_lab(ah + bh * t, ac + bc * t, al + bl * t) + "";
        };
    }
    d3.interpolateHsl = d3_interpolateHsl;
    function d3_interpolateHsl(a, b) {
        a = d3.hsl(a);
        b = d3.hsl(b);
        var ah = a.h, as = a.s, al = a.l, bh = b.h - ah, bs = b.s - as, bl = b.l - al;
        if (isNaN(bs)) bs = 0, as = isNaN(as) ? b.s : as;
        if (isNaN(bh)) bh = 0, ah = isNaN(ah) ? b.h : ah; else if (bh > 180) bh -= 360; else if (bh < -180) bh += 360;
        return function(t) {
            return d3_hsl_rgb(ah + bh * t, as + bs * t, al + bl * t) + "";
        };
    }
    d3.interpolateLab = d3_interpolateLab;
    function d3_interpolateLab(a, b) {
        a = d3.lab(a);
        b = d3.lab(b);
        var al = a.l, aa = a.a, ab = a.b, bl = b.l - al, ba = b.a - aa, bb = b.b - ab;
        return function(t) {
            return d3_lab_rgb(al + bl * t, aa + ba * t, ab + bb * t) + "";
        };
    }
    d3.interpolateRound = d3_interpolateRound;
    function d3_interpolateRound(a, b) {
        b -= a;
        return function(t) {
            return Math.round(a + b * t);
        };
    }
    d3.transform = function(string) {
        var g = d3_document.createElementNS(d3.ns.prefix.svg, "g");
        return (d3.transform = function(string) {
            if (string != null) {
                g.setAttribute("transform", string);
                var t = g.transform.baseVal.consolidate();
            }
            return new d3_transform(t ? t.matrix : d3_transformIdentity);
        })(string);
    };
    function d3_transform(m) {
        var r0 = [ m.a, m.b ], r1 = [ m.c, m.d ], kx = d3_transformNormalize(r0), kz = d3_transformDot(r0, r1), ky = d3_transformNormalize(d3_transformCombine(r1, r0, -kz)) || 0;
        if (r0[0] * r1[1] < r1[0] * r0[1]) {
            r0[0] *= -1;
            r0[1] *= -1;
            kx *= -1;
            kz *= -1;
        }
        this.rotate = (kx ? Math.atan2(r0[1], r0[0]) : Math.atan2(-r1[0], r1[1])) * d3_degrees;
        this.translate = [ m.e, m.f ];
        this.scale = [ kx, ky ];
        this.skew = ky ? Math.atan2(kz, ky) * d3_degrees : 0;
    }
    d3_transform.prototype.toString = function() {
        return "translate(" + this.translate + ")rotate(" + this.rotate + ")skewX(" + this.skew + ")scale(" + this.scale + ")";
    };
    function d3_transformDot(a, b) {
        return a[0] * b[0] + a[1] * b[1];
    }
    function d3_transformNormalize(a) {
        var k = Math.sqrt(d3_transformDot(a, a));
        if (k) {
            a[0] /= k;
            a[1] /= k;
        }
        return k;
    }
    function d3_transformCombine(a, b, k) {
        a[0] += k * b[0];
        a[1] += k * b[1];
        return a;
    }
    var d3_transformIdentity = {
        a: 1,
        b: 0,
        c: 0,
        d: 1,
        e: 0,
        f: 0
    };
    d3.interpolateTransform = d3_interpolateTransform;
    function d3_interpolateTransform(a, b) {
        var s = [], q = [], n, A = d3.transform(a), B = d3.transform(b), ta = A.translate, tb = B.translate, ra = A.rotate, rb = B.rotate, wa = A.skew, wb = B.skew, ka = A.scale, kb = B.scale;
        if (ta[0] != tb[0] || ta[1] != tb[1]) {
            s.push("translate(", null, ",", null, ")");
            q.push({
                i: 1,
                x: d3_interpolateNumber(ta[0], tb[0])
            }, {
                i: 3,
                x: d3_interpolateNumber(ta[1], tb[1])
            });
        } else if (tb[0] || tb[1]) {
            s.push("translate(" + tb + ")");
        } else {
            s.push("");
        }
        if (ra != rb) {
            if (ra - rb > 180) rb += 360; else if (rb - ra > 180) ra += 360;
            q.push({
                i: s.push(s.pop() + "rotate(", null, ")") - 2,
                x: d3_interpolateNumber(ra, rb)
            });
        } else if (rb) {
            s.push(s.pop() + "rotate(" + rb + ")");
        }
        if (wa != wb) {
            q.push({
                i: s.push(s.pop() + "skewX(", null, ")") - 2,
                x: d3_interpolateNumber(wa, wb)
            });
        } else if (wb) {
            s.push(s.pop() + "skewX(" + wb + ")");
        }
        if (ka[0] != kb[0] || ka[1] != kb[1]) {
            n = s.push(s.pop() + "scale(", null, ",", null, ")");
            q.push({
                i: n - 4,
                x: d3_interpolateNumber(ka[0], kb[0])
            }, {
                i: n - 2,
                x: d3_interpolateNumber(ka[1], kb[1])
            });
        } else if (kb[0] != 1 || kb[1] != 1) {
            s.push(s.pop() + "scale(" + kb + ")");
        }
        n = q.length;
        return function(t) {
            var i = -1, o;
            while (++i < n) s[(o = q[i]).i] = o.x(t);
            return s.join("");
        };
    }
    function d3_uninterpolateNumber(a, b) {
        b = (b -= a = +a) || 1 / b;
        return function(x) {
            return (x - a) / b;
        };
    }
    function d3_uninterpolateClamp(a, b) {
        b = (b -= a = +a) || 1 / b;
        return function(x) {
            return Math.max(0, Math.min(1, (x - a) / b));
        };
    }
    d3.layout = {};
    d3.layout.bundle = function() {
        return function(links) {
            var paths = [], i = -1, n = links.length;
            while (++i < n) paths.push(d3_layout_bundlePath(links[i]));
            return paths;
        };
    };
    function d3_layout_bundlePath(link) {
        var start = link.source, end = link.target, lca = d3_layout_bundleLeastCommonAncestor(start, end), points = [ start ];
        while (start !== lca) {
            start = start.parent;
            points.push(start);
        }
        var k = points.length;
        while (end !== lca) {
            points.splice(k, 0, end);
            end = end.parent;
        }
        return points;
    }
    function d3_layout_bundleAncestors(node) {
        var ancestors = [], parent = node.parent;
        while (parent != null) {
            ancestors.push(node);
            node = parent;
            parent = parent.parent;
        }
        ancestors.push(node);
        return ancestors;
    }
    function d3_layout_bundleLeastCommonAncestor(a, b) {
        if (a === b) return a;
        var aNodes = d3_layout_bundleAncestors(a), bNodes = d3_layout_bundleAncestors(b), aNode = aNodes.pop(), bNode = bNodes.pop(), sharedNode = null;
        while (aNode === bNode) {
            sharedNode = aNode;
            aNode = aNodes.pop();
            bNode = bNodes.pop();
        }
        return sharedNode;
    }
    d3.layout.chord = function() {
        var chord = {}, chords, groups, matrix, n, padding = 0, sortGroups, sortSubgroups, sortChords;
        function relayout() {
            var subgroups = {}, groupSums = [], groupIndex = d3.range(n), subgroupIndex = [], k, x, x0, i, j;
            chords = [];
            groups = [];
            k = 0, i = -1;
            while (++i < n) {
                x = 0, j = -1;
                while (++j < n) {
                    x += matrix[i][j];
                }
                groupSums.push(x);
                subgroupIndex.push(d3.range(n));
                k += x;
            }
            if (sortGroups) {
                groupIndex.sort(function(a, b) {
                    return sortGroups(groupSums[a], groupSums[b]);
                });
            }
            if (sortSubgroups) {
                subgroupIndex.forEach(function(d, i) {
                    d.sort(function(a, b) {
                        return sortSubgroups(matrix[i][a], matrix[i][b]);
                    });
                });
            }
            k = ( - padding * n) / k;
            x = 0, i = -1;
            while (++i < n) {
                x0 = x, j = -1;
                while (++j < n) {
                    var di = groupIndex[i], dj = subgroupIndex[di][j], v = matrix[di][dj], a0 = x, a1 = x += v * k;
                    subgroups[di + "-" + dj] = {
                        index: di,
                        subindex: dj,
                        startAngle: a0,
                        endAngle: a1,
                        value: v
                    };
                }
                groups[di] = {
                    index: di,
                    startAngle: x0,
                    endAngle: x,
                    value: (x - x0) / k
                };
                x += padding;
            }
            i = -1;
            while (++i < n) {
                j = i - 1;
                while (++j < n) {
                    var source = subgroups[i + "-" + j], target = subgroups[j + "-" + i];
                    if (source.value || target.value) {
                        chords.push(source.value < target.value ? {
                            source: target,
                            target: source
                        } : {
                            source: source,
                            target: target
                        });
                    }
                }
            }
            if (sortChords) resort();
        }
        function resort() {
            chords.sort(function(a, b) {
                return sortChords((a.source.value + a.target.value) / 2, (b.source.value + b.target.value) / 2);
            });
        }
        chord.matrix = function(x) {
            if (!arguments.length) return matrix;
            n = (matrix = x) && matrix.length;
            chords = groups = null;
            return chord;
        };
        chord.padding = function(x) {
            if (!arguments.length) return padding;
            padding = x;
            chords = groups = null;
            return chord;
        };
        chord.sortGroups = function(x) {
            if (!arguments.length) return sortGroups;
            sortGroups = x;
            chords = groups = null;
            return chord;
        };
        chord.sortSubgroups = function(x) {
            if (!arguments.length) return sortSubgroups;
            sortSubgroups = x;
            chords = null;
            return chord;
        };
        chord.sortChords = function(x) {
            if (!arguments.length) return sortChords;
            sortChords = x;
            if (chords) resort();
            return chord;
        };
        chord.chords = function() {
            if (!chords) relayout();
            return chords;
        };
        chord.groups = function() {
            if (!groups) relayout();
            return groups;
        };
        return chord;
    };
    d3.layout.force = function() {
        var force = {}, event = d3.dispatch("start", "tick", "end"), size = [ 1, 1 ], drag, alpha, friction = .9, linkDistance = d3_layout_forceLinkDistance, linkStrength = d3_layout_forceLinkStrength, charge = -30, chargeDistance2 = d3_layout_forceChargeDistance2, gravity = .1, theta2 = .64, nodes = [], links = [], distances, strengths, charges;
        function repulse(node) {
            return function(quad, x1, _, x2) {
                if (quad.point !== node) {
                    var dx = quad.cx - node.x, dy = quad.cy - node.y, dw = x2 - x1, dn = dx * dx + dy * dy;
                    if (dw * dw / theta2 < dn) {
                        if (dn < chargeDistance2) {
                            var k = quad.charge / dn;
                            node.px -= dx * k;
                            node.py -= dy * k;
                        }
                        return true;
                    }
                    if (quad.point && dn && dn < chargeDistance2) {
                        var k = quad.pointCharge / dn;
                        node.px -= dx * k;
                        node.py -= dy * k;
                    }
                }
                return !quad.charge;
            };
        }
        force.tick = function() {
            if ((alpha *= .99) < .005) {
                event.end({
                    type: "end",
                    alpha: alpha = 0
                });
                return true;
            }
            var n = nodes.length, m = links.length, q, i, o, s, t, l, k, x, y;
            for (i = 0; i < m; ++i) {
                o = links[i];
                s = o.source;
                t = o.target;
                x = t.x - s.x;
                y = t.y - s.y;
                if (l = x * x + y * y) {
                    l = alpha * strengths[i] * ((l = Math.sqrt(l)) - distances[i]) / l;
                    x *= l;
                    y *= l;
                    t.x -= x * (k = s.weight / (t.weight + s.weight));
                    t.y -= y * k;
                    s.x += x * (k = 1 - k);
                    s.y += y * k;
                }
            }
            if (k = alpha * gravity) {
                x = size[0] / 2;
                y = size[1] / 2;
                i = -1;
                if (k) while (++i < n) {
                    o = nodes[i];
                    o.x += (x - o.x) * k;
                    o.y += (y - o.y) * k;
                }
            }
            if (charge) {
                d3_layout_forceAccumulate(q = d3.geom.quadtree(nodes), alpha, charges);
                i = -1;
                while (++i < n) {
                    if (!(o = nodes[i]).fixed) {
                        q.visit(repulse(o));
                    }
                }
            }
            i = -1;
            while (++i < n) {
                o = nodes[i];
                if (o.fixed) {
                    o.x = o.px;
                    o.y = o.py;
                } else {
                    o.x -= (o.px - (o.px = o.x)) * friction;
                    o.y -= (o.py - (o.py = o.y)) * friction;
                }
            }
            event.tick({
                type: "tick",
                alpha: alpha
            });
        };
        force.nodes = function(x) {
            if (!arguments.length) return nodes;
            nodes = x;
            return force;
        };
        force.links = function(x) {
            if (!arguments.length) return links;
            links = x;
            return force;
        };
        force.size = function(x) {
            if (!arguments.length) return size;
            size = x;
            return force;
        };
        force.linkDistance = function(x) {
            if (!arguments.length) return linkDistance;
            linkDistance = typeof x === "function" ? x : +x;
            return force;
        };
        force.distance = force.linkDistance;
        force.linkStrength = function(x) {
            if (!arguments.length) return linkStrength;
            linkStrength = typeof x === "function" ? x : +x;
            return force;
        };
        force.friction = function(x) {
            if (!arguments.length) return friction;
            friction = +x;
            return force;
        };
        force.charge = function(x) {
            if (!arguments.length) return charge;
            charge = typeof x === "function" ? x : +x;
            return force;
        };
        force.chargeDistance = function(x) {
            if (!arguments.length) return Math.sqrt(chargeDistance2);
            chargeDistance2 = x * x;
            return force;
        };
        force.gravity = function(x) {
            if (!arguments.length) return gravity;
            gravity = +x;
            return force;
        };
        force.theta = function(x) {
            if (!arguments.length) return Math.sqrt(theta2);
            theta2 = x * x;
            return force;
        };
        force.alpha = function(x) {
            if (!arguments.length) return alpha;
            x = +x;
            if (alpha) {
                if (x > 0) alpha = x; else alpha = 0;
            } else if (x > 0) {
                event.start({
                    type: "start",
                    alpha: alpha = x
                });
                d3.timer(force.tick);
            }
            return force;
        };
        force.start = function() {
            var i, n = nodes.length, m = links.length, w = size[0], h = size[1], neighbors, o;
            for (i = 0; i < n; ++i) {
                (o = nodes[i]).index = i;
                o.weight = 0;
            }
            for (i = 0; i < m; ++i) {
                o = links[i];
                if (typeof o.source == "number") o.source = nodes[o.source];
                if (typeof o.target == "number") o.target = nodes[o.target];
                ++o.source.weight;
                ++o.target.weight;
            }
            for (i = 0; i < n; ++i) {
                o = nodes[i];
                if (isNaN(o.x)) o.x = position("x", w);
                if (isNaN(o.y)) o.y = position("y", h);
                if (isNaN(o.px)) o.px = o.x;
                if (isNaN(o.py)) o.py = o.y;
            }
            distances = [];
            if (typeof linkDistance === "function") for (i = 0; i < m; ++i) distances[i] = +linkDistance.call(this, links[i], i); else for (i = 0; i < m; ++i) distances[i] = linkDistance;
            strengths = [];
            if (typeof linkStrength === "function") for (i = 0; i < m; ++i) strengths[i] = +linkStrength.call(this, links[i], i); else for (i = 0; i < m; ++i) strengths[i] = linkStrength;
            charges = [];
            if (typeof charge === "function") for (i = 0; i < n; ++i) charges[i] = +charge.call(this, nodes[i], i); else for (i = 0; i < n; ++i) charges[i] = charge;
            function position(dimension, size) {
                if (!neighbors) {
                    neighbors = new Array(n);
                    for (j = 0; j < n; ++j) {
                        neighbors[j] = [];
                    }
                    for (j = 0; j < m; ++j) {
                        var o = links[j];
                        neighbors[o.source.index].push(o.target);
                        neighbors[o.target.index].push(o.source);
                    }
                }
                var candidates = neighbors[i], j = -1, l = candidates.length, x;
                while (++j < l) if (!isNaN(x = candidates[j][dimension])) return x;
                return Math.random() * size;
            }
            return force.resume();
        };
        force.resume = function() {
            return force.alpha(.1);
        };
        force.stop = function() {
            return force.alpha(0);
        };
        force.drag = function() {
            if (!drag) drag = d3.behavior.drag().origin(d3_identity).on("dragstart.force", d3_layout_forceDragstart).on("drag.force", dragmove).on("dragend.force", d3_layout_forceDragend);
            if (!arguments.length) return drag;
            this.on("mouseover.force", d3_layout_forceMouseover).on("mouseout.force", d3_layout_forceMouseout).call(drag);
        };
        function dragmove(d) {
            d.px = d3.event.x, d.py = d3.event.y;
            force.resume();
        }
        return d3.rebind(force, event, "on");
    };
    function d3_layout_forceDragstart(d) {
        d.fixed |= 2;
    }
    function d3_layout_forceDragend(d) {
        d.fixed &= ~6;
    }
    function d3_layout_forceMouseover(d) {
        d.fixed |= 4;
        d.px = d.x, d.py = d.y;
    }
    function d3_layout_forceMouseout(d) {
        d.fixed &= ~4;
    }
    function d3_layout_forceAccumulate(quad, alpha, charges) {
        var cx = 0, cy = 0;
        quad.charge = 0;
        if (!quad.leaf) {
            var nodes = quad.nodes, n = nodes.length, i = -1, c;
            while (++i < n) {
                c = nodes[i];
                if (c == null) continue;
                d3_layout_forceAccumulate(c, alpha, charges);
                quad.charge += c.charge;
                cx += c.charge * c.cx;
                cy += c.charge * c.cy;
            }
        }
        if (quad.point) {
            if (!quad.leaf) {
                quad.point.x += Math.random() - .5;
                quad.point.y += Math.random() - .5;
            }
            var k = alpha * charges[quad.point.index];
            quad.charge += quad.pointCharge = k;
            cx += k * quad.point.x;
            cy += k * quad.point.y;
        }
        quad.cx = cx / quad.charge;
        quad.cy = cy / quad.charge;
    }
    var d3_layout_forceLinkDistance = 20, d3_layout_forceLinkStrength = 1, d3_layout_forceChargeDistance2 = Infinity;
    d3.layout.hierarchy = function() {
        var sort = d3_layout_hierarchySort, children = d3_layout_hierarchyChildren, value = d3_layout_hierarchyValue;
        function hierarchy(root) {
            var stack = [ root ], nodes = [], node;
            root.depth = 0;
            while ((node = stack.pop()) != null) {
                nodes.push(node);
                if ((childs = children.call(hierarchy, node, node.depth)) && (n = childs.length)) {
                    var n, childs, child;
                    while (--n >= 0) {
                        stack.push(child = childs[n]);
                        child.parent = node;
                        child.depth = node.depth + 1;
                    }
                    if (value) node.value = 0;
                    node.children = childs;
                } else {
                    if (value) node.value = +value.call(hierarchy, node, node.depth) || 0;
                    delete node.children;
                }
            }
            d3_layout_hierarchyVisitAfter(root, function(node) {
                var childs, parent;
                if (sort && (childs = node.children)) childs.sort(sort);
                if (value && (parent = node.parent)) parent.value += node.value;
            });
            return nodes;
        }
        hierarchy.sort = function(x) {
            if (!arguments.length) return sort;
            sort = x;
            return hierarchy;
        };
        hierarchy.children = function(x) {
            if (!arguments.length) return children;
            children = x;
            return hierarchy;
        };
        hierarchy.value = function(x) {
            if (!arguments.length) return value;
            value = x;
            return hierarchy;
        };
        hierarchy.revalue = function(root) {
            if (value) {
                d3_layout_hierarchyVisitBefore(root, function(node) {
                    if (node.children) node.value = 0;
                });
                d3_layout_hierarchyVisitAfter(root, function(node) {
                    var parent;
                    if (!node.children) node.value = +value.call(hierarchy, node, node.depth) || 0;
                    if (parent = node.parent) parent.value += node.value;
                });
            }
            return root;
        };
        return hierarchy;
    };
    function d3_layout_hierarchyRebind(object, hierarchy) {
        d3.rebind(object, hierarchy, "sort", "children", "value");
        object.nodes = object;
        object.links = d3_layout_hierarchyLinks;
        return object;
    }
    function d3_layout_hierarchyVisitBefore(node, callback) {
        var nodes = [ node ];
        while ((node = nodes.pop()) != null) {
            callback(node);
            if ((children = node.children) && (n = children.length)) {
                var n, children;
                while (--n >= 0) nodes.push(children[n]);
            }
        }
    }
    function d3_layout_hierarchyVisitAfter(node, callback) {
        var nodes = [ node ], nodes2 = [];
        while ((node = nodes.pop()) != null) {
            nodes2.push(node);
            if ((children = node.children) && (n = children.length)) {
                var i = -1, n, children;
                while (++i < n) nodes.push(children[i]);
            }
        }
        while ((node = nodes2.pop()) != null) {
            callback(node);
        }
    }
    function d3_layout_hierarchyChildren(d) {
        return d.children;
    }
    function d3_layout_hierarchyValue(d) {
        return d.value;
    }
    function d3_layout_hierarchySort(a, b) {
        return b.value - a.value;
    }
    function d3_layout_hierarchyLinks(nodes) {
        return d3.merge(nodes.map(function(parent) {
            return (parent.children || []).map(function(child) {
                return {
                    source: parent,
                    target: child
                };
            });
        }));
    }
    d3.layout.partition = function() {
        var hierarchy = d3.layout.hierarchy(), size = [ 1, 1 ];
        function position(node, x, dx, dy) {
            var children = node.children;
            node.x = x;
            node.y = node.depth * dy;
            node.dx = dx;
            node.dy = dy;
            if (children && (n = children.length)) {
                var i = -1, n, c, d;
                dx = node.value ? dx / node.value : 0;
                while (++i < n) {
                    position(c = children[i], x, d = c.value * dx, dy);
                    x += d;
                }
            }
        }
        function depth(node) {
            var children = node.children, d = 0;
            if (children && (n = children.length)) {
                var i = -1, n;
                while (++i < n) d = Math.max(d, depth(children[i]));
            }
            return 1 + d;
        }
        function partition(d, i) {
            var nodes = hierarchy.call(this, d, i);
            position(nodes[0], 0, size[0], size[1] / depth(nodes[0]));
            return nodes;
        }
        partition.size = function(x) {
            if (!arguments.length) return size;
            size = x;
            return partition;
        };
        return d3_layout_hierarchyRebind(partition, hierarchy);
    };
    d3.layout.pie = function() {
        var value = Number, sort = d3_layout_pieSortByValue, startAngle = 0, endAngle = , padAngle = 0;
        function pie(data) {
            var n = data.length, values = data.map(function(d, i) {
                return +value.call(pie, d, i);
            }), a = +(typeof startAngle === "function" ? startAngle.apply(this, arguments) : startAngle), da = (typeof endAngle === "function" ? endAngle.apply(this, arguments) : endAngle) - a, p = Math.min(Math.abs(da) / n, +(typeof padAngle === "function" ? padAngle.apply(this, arguments) : padAngle)), pa = p * (da < 0 ? -1 : 1), k = (da - n * pa) / d3.sum(values), index = d3.range(n), arcs = [], v;
            if (sort != null) index.sort(sort === d3_layout_pieSortByValue ? function(i, j) {
                return values[j] - values[i];
            } : function(i, j) {
                return sort(data[i], data[j]);
            });
            index.forEach(function(i) {
                arcs[i] = {
                    data: data[i],
                    value: v = values[i],
                    startAngle: a,
                    endAngle: a += v * k + pa,
                    padAngle: p
                };
            });
            return arcs;
        }
        pie.value = function(_) {
            if (!arguments.length) return value;
            value = _;
            return pie;
        };
        pie.sort = function(_) {
            if (!arguments.length) return sort;
            sort = _;
            return pie;
        };
        pie.startAngle = function(_) {
            if (!arguments.length) return startAngle;
            startAngle = _;
            return pie;
        };
        pie.endAngle = function(_) {
            if (!arguments.length) return endAngle;
            endAngle = _;
            return pie;
        };
        pie.padAngle = function(_) {
            if (!arguments.length) return padAngle;
            padAngle = _;
            return pie;
        };
        return pie;
    };
    var d3_layout_pieSortByValue = {};
    d3.layout.stack = function() {
        var values = d3_identity, order = d3_layout_stackOrderDefault, offset = d3_layout_stackOffsetZero, out = d3_layout_stackOut, x = d3_layout_stackX, y = d3_layout_stackY;
        function stack(data, index) {
            if (!(n = data.length)) return data;
            var series = data.map(function(d, i) {
                return values.call(stack, d, i);
            });
            var points = series.map(function(d) {
                return d.map(function(v, i) {
                    return [ x.call(stack, v, i), y.call(stack, v, i) ];
                });
            });
            var orders = order.call(stack, points, index);
            series = d3.permute(series, orders);
            points = d3.permute(points, orders);
            var offsets = offset.call(stack, points, index);
            var m = series[0].length, n, i, j, o;
            for (j = 0; j < m; ++j) {
                out.call(stack, series[0][j], o = offsets[j], points[0][j][1]);
                for (i = 1; i < n; ++i) {
                    out.call(stack, series[i][j], o += points[i - 1][j][1], points[i][j][1]);
                }
            }
            return data;
        }
        stack.values = function(x) {
            if (!arguments.length) return values;
            values = x;
            return stack;
        };
        stack.order = function(x) {
            if (!arguments.length) return order;
            order = typeof x === "function" ? x : d3_layout_stackOrders.get(x) || d3_layout_stackOrderDefault;
            return stack;
        };
        stack.offset = function(x) {
            if (!arguments.length) return offset;
            offset = typeof x === "function" ? x : d3_layout_stackOffsets.get(x) || d3_layout_stackOffsetZero;
            return stack;
        };
        stack.x = function(z) {
            if (!arguments.length) return x;
            x = z;
            return stack;
        };
        stack.y = function(z) {
            if (!arguments.length) return y;
            y = z;
            return stack;
        };
        stack.out = function(z) {
            if (!arguments.length) return out;
            out = z;
            return stack;
        };
        return stack;
    };
    function d3_layout_stackX(d) {
        return d.x;
    }
    function d3_layout_stackY(d) {
        return d.y;
    }
    function d3_layout_stackOut(d, y0, y) {
        d.y0 = y0;
        d.y = y;
    }
    var d3_layout_stackOrders = d3.map({
        "inside-out": function(data) {
            var n = data.length, i, j, max = data.map(d3_layout_stackMaxIndex), sums = data.map(d3_layout_stackReduceSum), index = d3.range(n).sort(function(a, b) {
                return max[a] - max[b];
            }), top = 0, bottom = 0, tops = [], bottoms = [];
            for (i = 0; i < n; ++i) {
                j = index[i];
                if (top < bottom) {
                    top += sums[j];
                    tops.push(j);
                } else {
                    bottom += sums[j];
                    bottoms.push(j);
                }
            }
            return bottoms.reverse().concat(tops);
        },
        reverse: function(data) {
            return d3.range(data.length).reverse();
        },
        "default": d3_layout_stackOrderDefault
    });
    var d3_layout_stackOffsets = d3.map({
        silhouette: function(data) {
            var n = data.length, m = data[0].length, sums = [], max = 0, i, j, o, y0 = [];
            for (j = 0; j < m; ++j) {
                for (i = 0, o = 0; i < n; i++) o += data[i][j][1];
                if (o > max) max = o;
                sums.push(o);
            }
            for (j = 0; j < m; ++j) {
                y0[j] = (max - sums[j]) / 2;
            }
            return y0;
        },
        wiggle: function(data) {
            var n = data.length, x = data[0], m = x.length, i, j, k, s1, s2, s3, dx, o, o0, y0 = [];
            y0[0] = o = o0 = 0;
            for (j = 1; j < m; ++j) {
                for (i = 0, s1 = 0; i < n; ++i) s1 += data[i][j][1];
                for (i = 0, s2 = 0, dx = x[j][0] - x[j - 1][0]; i < n; ++i) {
                    for (k = 0, s3 = (data[i][j][1] - data[i][j - 1][1]) / (2 * dx); k < i; ++k) {
                        s3 += (data[k][j][1] - data[k][j - 1][1]) / dx;
                    }
                    s2 += s3 * data[i][j][1];
                }
                y0[j] = o -= s1 ? s2 / s1 * dx : 0;
                if (o < o0) o0 = o;
            }
            for (j = 0; j < m; ++j) y0[j] -= o0;
            return y0;
        },
        expand: function(data) {
            var n = data.length, m = data[0].length, k = 1 / n, i, j, o, y0 = [];
            for (j = 0; j < m; ++j) {
                for (i = 0, o = 0; i < n; i++) o += data[i][j][1];
                if (o) for (i = 0; i < n; i++) data[i][j][1] /= o; else for (i = 0; i < n; i++) data[i][j][1] = k;
            }
            for (j = 0; j < m; ++j) y0[j] = 0;
            return y0;
        },
        zero: d3_layout_stackOffsetZero
    });
    function d3_layout_stackOrderDefault(data) {
        return d3.range(data.length);
    }
    function d3_layout_stackOffsetZero(data) {
        var j = -1, m = data[0].length, y0 = [];
        while (++j < m) y0[j] = 0;
        return y0;
    }
    function d3_layout_stackMaxIndex(array) {
        var i = 1, j = 0, v = array[0][1], k, n = array.length;
        for (;i < n; ++i) {
            if ((k = array[i][1]) > v) {
                j = i;
                v = k;
            }
        }
        return j;
    }
    function d3_layout_stackReduceSum(d) {
        return d.reduce(d3_layout_stackSum, 0);
    }
    function d3_layout_stackSum(p, d) {
        return p + d[1];
    }
    d3.layout.histogram = function() {
        var frequency = true, valuer = Number, ranger = d3_layout_histogramRange, binner = d3_layout_histogramBinSturges;
        function histogram(data, i) {
            var bins = [], values = data.map(valuer, this), range = ranger.call(this, values, i), thresholds = binner.call(this, range, values, i), bin, i = -1, n = values.length, m = thresholds.length - 1, k = frequency ? 1 : 1 / n, x;
            while (++i < m) {
                bin = bins[i] = [];
                bin.dx = thresholds[i + 1] - (bin.x = thresholds[i]);
                bin.y = 0;
            }
            if (m > 0) {
                i = -1;
                while (++i < n) {
                    x = values[i];
                    if (x >= range[0] && x <= range[1]) {
                        bin = bins[d3.bisect(thresholds, x, 1, m) - 1];
                        bin.y += k;
                        bin.push(data[i]);
                    }
                }
            }
            return bins;
        }
        histogram.value = function(x) {
            if (!arguments.length) return valuer;
            valuer = x;
            return histogram;
        };
        histogram.range = function(x) {
            if (!arguments.length) return ranger;
            ranger = d3_functor(x);
            return histogram;
        };
        histogram.bins = function(x) {
            if (!arguments.length) return binner;
            binner = typeof x === "number" ? function(range) {
                return d3_layout_histogramBinFixed(range, x);
            } : d3_functor(x);
            return histogram;
        };
        histogram.frequency = function(x) {
            if (!arguments.length) return frequency;
            frequency = !!x;
            return histogram;
        };
        return histogram;
    };
    function d3_layout_histogramBinSturges(range, values) {
        return d3_layout_histogramBinFixed(range, Math.ceil(Math.log(values.length) / Math.LN2 + 1));
    }
    function d3_layout_histogramBinFixed(range, n) {
        var x = -1, b = +range[0], m = (range[1] - b) / n, f = [];
        while (++x <= n) f[x] = m * x + b;
        return f;
    }
    function d3_layout_histogramRange(values) {
        return [ d3.min(values), d3.max(values) ];
    }
    d3.layout.pack = function() {
        var hierarchy = d3.layout.hierarchy().sort(d3_layout_packSort), padding = 0, size = [ 1, 1 ], radius;
        function pack(d, i) {
            var nodes = hierarchy.call(this, d, i), root = nodes[0], w = size[0], h = size[1], r = radius == null ? Math.sqrt : typeof radius === "function" ? radius : function() {
                return radius;
            };
            root.x = root.y = 0;
            d3_layout_hierarchyVisitAfter(root, function(d) {
                d.r = +r(d.value);
            });
            d3_layout_hierarchyVisitAfter(root, d3_layout_packSiblings);
            if (padding) {
                var dr = padding * (radius ? 1 : Math.max(2 * root.r / w, 2 * root.r / h)) / 2;
                d3_layout_hierarchyVisitAfter(root, function(d) {
                    d.r += dr;
                });
                d3_layout_hierarchyVisitAfter(root, d3_layout_packSiblings);
                d3_layout_hierarchyVisitAfter(root, function(d) {
                    d.r -= dr;
                });
            }
            d3_layout_packTransform(root, w / 2, h / 2, radius ? 1 : 1 / Math.max(2 * root.r / w, 2 * root.r / h));
            return nodes;
        }
        pack.size = function(_) {
            if (!arguments.length) return size;
            size = _;
            return pack;
        };
        pack.radius = function(_) {
            if (!arguments.length) return radius;
            radius = _ == null || typeof _ === "function" ? _ : +_;
            return pack;
        };
        pack.padding = function(_) {
            if (!arguments.length) return padding;
            padding = +_;
            return pack;
        };
        return d3_layout_hierarchyRebind(pack, hierarchy);
    };
    function d3_layout_packSort(a, b) {
        return a.value - b.value;
    }
    function d3_layout_packInsert(a, b) {
        var c = a._pack_next;
        a._pack_next = b;
        b._pack_prev = a;
        b._pack_next = c;
        c._pack_prev = b;
    }
    function d3_layout_packSplice(a, b) {
        a._pack_next = b;
        b._pack_prev = a;
    }
    function d3_layout_packIntersects(a, b) {
        var dx = b.x - a.x, dy = b.y - a.y, dr = a.r + b.r;
        return .999 * dr * dr > dx * dx + dy * dy;
    }
    function d3_layout_packSiblings(node) {
        if (!(nodes = node.children) || !(n = nodes.length)) return;
        var nodes, xMin = Infinity, xMax = -Infinity, yMin = Infinity, yMax = -Infinity, a, b, c, i, j, k, n;
        function bound(node) {
            xMin = Math.min(node.x - node.r, xMin);
            xMax = Math.max(node.x + node.r, xMax);
            yMin = Math.min(node.y - node.r, yMin);
            yMax = Math.max(node.y + node.r, yMax);
        }
        nodes.forEach(d3_layout_packLink);
        a = nodes[0];
        a.x = -a.r;
        a.y = 0;
        bound(a);
        if (n > 1) {
            b = nodes[1];
            b.x = b.r;
            b.y = 0;
            bound(b);
            if (n > 2) {
                c = nodes[2];
                d3_layout_packPlace(a, b, c);
                bound(c);
                d3_layout_packInsert(a, c);
                a._pack_prev = c;
                d3_layout_packInsert(c, b);
                b = a._pack_next;
                for (i = 3; i < n; i++) {
                    d3_layout_packPlace(a, b, c = nodes[i]);
                    var isect = 0, s1 = 1, s2 = 1;
                    for (j = b._pack_next; j !== b; j = j._pack_next, s1++) {
                        if (d3_layout_packIntersects(j, c)) {
                            isect = 1;
                            break;
                        }
                    }
                    if (isect == 1) {
                        for (k = a._pack_prev; k !== j._pack_prev; k = k._pack_prev, s2++) {
                            if (d3_layout_packIntersects(k, c)) {
                                break;
                            }
                        }
                    }
                    if (isect) {
                        if (s1 < s2 || s1 == s2 && b.r < a.r) d3_layout_packSplice(a, b = j); else d3_layout_packSplice(a = k, b);
                        i--;
                    } else {
                        d3_layout_packInsert(a, c);
                        b = c;
                        bound(c);
                    }
                }
            }
        }
        var cx = (xMin + xMax) / 2, cy = (yMin + yMax) / 2, cr = 0;
        for (i = 0; i < n; i++) {
            c = nodes[i];
            c.x -= cx;
            c.y -= cy;
            cr = Math.max(cr, c.r + Math.sqrt(c.x * c.x + c.y * c.y));
        }
        node.r = cr;
        nodes.forEach(d3_layout_packUnlink);
    }
    function d3_layout_packLink(node) {
        node._pack_next = node._pack_prev = node;
    }
    function d3_layout_packUnlink(node) {
        delete node._pack_next;
        delete node._pack_prev;
    }
    function d3_layout_packTransform(node, x, y, k) {
        var children = node.children;
        node.x = x += k * node.x;
        node.y = y += k * node.y;
        node.r *= k;
        if (children) {
            var i = -1, n = children.length;
            while (++i < n) d3_layout_packTransform(children[i], x, y, k);
        }
    }
    function d3_layout_packPlace(a, b, c) {
        var db = a.r + c.r, dx = b.x - a.x, dy = b.y - a.y;
        if (db && (dx || dy)) {
            var da = b.r + c.r, dc = dx * dx + dy * dy;
            da *= da;
            db *= db;
            var x = .5 + (db - da) / (2 * dc), y = Math.sqrt(Math.max(0, 2 * da * (db + dc) - (db -= dc) * db - da * da)) / (2 * dc);
            c.x = a.x + x * dx + y * dy;
            c.y = a.y + x * dy - y * dx;
        } else {
            c.x = a.x + db;
            c.y = a.y;
        }
    }
    d3.layout.tree = function() {
        var hierarchy = d3.layout.hierarchy().sort(null).value(null), separation = d3_layout_treeSeparation, size = [ 1, 1 ], nodeSize = null;
        function tree(d, i) {
            var nodes = hierarchy.call(this, d, i), root0 = nodes[0], root1 = wrapTree(root0);
            d3_layout_hierarchyVisitAfter(root1, firstWalk), root1.parent.m = -root1.z;
            d3_layout_hierarchyVisitBefore(root1, secondWalk);
            if (nodeSize) d3_layout_hierarchyVisitBefore(root0, sizeNode); else {
                var left = root0, right = root0, bottom = root0;
                d3_layout_hierarchyVisitBefore(root0, function(node) {
                    if (node.x < left.x) left = node;
                    if (node.x > right.x) right = node;
                    if (node.depth > bottom.depth) bottom = node;
                });
                var tx = separation(left, right) / 2 - left.x, kx = size[0] / (right.x + separation(right, left) / 2 + tx), ky = size[1] / (bottom.depth || 1);
                d3_layout_hierarchyVisitBefore(root0, function(node) {
                    node.x = (node.x + tx) * kx;
                    node.y = node.depth * ky;
                });
            }
            return nodes;
        }
        function wrapTree(root0) {
            var root1 = {
                A: null,
                children: [ root0 ]
            }, queue = [ root1 ], node1;
            while ((node1 = queue.pop()) != null) {
                for (var children = node1.children, child, i = 0, n = children.length; i < n; ++i) {
                    queue.push((children[i] = child = {
                        _: children[i],
                        parent: node1,
                        children: (child = children[i].children) && child.slice() || [],
                        A: null,
                        a: null,
                        z: 0,
                        m: 0,
                        c: 0,
                        s: 0,
                        t: null,
                        i: i
                    }).a = child);
                }
            }
            return root1.children[0];
        }
        function firstWalk(v) {
            var children = v.children, siblings = v.parent.children, w = v.i ? siblings[v.i - 1] : null;
            if (children.length) {
                d3_layout_treeShift(v);
                var midpoint = (children[0].z + children[children.length - 1].z) / 2;
                if (w) {
                    v.z = w.z + separation(v._, w._);
                    v.m = v.z - midpoint;
                } else {
                    v.z = midpoint;
                }
            } else if (w) {
                v.z = w.z + separation(v._, w._);
            }
            v.parent.A = apportion(v, w, v.parent.A || siblings[0]);
        }
        function secondWalk(v) {
            v._.x = v.z + v.parent.m;
            v.m += v.parent.m;
        }
        function apportion(v, w, ancestor) {
            if (w) {
                var vip = v, vop = v, vim = w, vom = vip.parent.children[0], sip = vip.m, sop = vop.m, sim = vim.m, som = vom.m, shift;
                while (vim = d3_layout_treeRight(vim), vip = d3_layout_treeLeft(vip), vim && vip) {
                    vom = d3_layout_treeLeft(vom);
                    vop = d3_layout_treeRight(vop);
                    vop.a = v;
                    shift = vim.z + sim - vip.z - sip + separation(vim._, vip._);
                    if (shift > 0) {
                        d3_layout_treeMove(d3_layout_treeAncestor(vim, v, ancestor), v, shift);
                        sip += shift;
                        sop += shift;
                    }
                    sim += vim.m;
                    sip += vip.m;
                    som += vom.m;
                    sop += vop.m;
                }
                if (vim && !d3_layout_treeRight(vop)) {
                    vop.t = vim;
                    vop.m += sim - sop;
                }
                if (vip && !d3_layout_treeLeft(vom)) {
                    vom.t = vip;
                    vom.m += sip - som;
                    ancestor = v;
                }
            }
            return ancestor;
        }
        function sizeNode(node) {
            node.x *= size[0];
            node.y = node.depth * size[1];
        }
        tree.separation = function(x) {
            if (!arguments.length) return separation;
            separation = x;
            return tree;
        };
        tree.size = function(x) {
            if (!arguments.length) return nodeSize ? null : size;
            nodeSize = (size = x) == null ? sizeNode : null;
            return tree;
        };
        tree.nodeSize = function(x) {
            if (!arguments.length) return nodeSize ? size : null;
            nodeSize = (size = x) == null ? null : sizeNode;
            return tree;
        };
        return d3_layout_hierarchyRebind(tree, hierarchy);
    };
    function d3_layout_treeSeparation(a, b) {
        return a.parent == b.parent ? 1 : 2;
    }
    function d3_layout_treeLeft(v) {
        var children = v.children;
        return children.length ? children[0] : v.t;
    }
    function d3_layout_treeRight(v) {
        var children = v.children, n;
        return (n = children.length) ? children[n - 1] : v.t;
    }
    function d3_layout_treeMove(wm, wp, shift) {
        var change = shift / (wp.i - wm.i);
        wp.c -= change;
        wp.s += shift;
        wm.c += change;
        wp.z += shift;
        wp.m += shift;
    }
    function d3_layout_treeShift(v) {
        var shift = 0, change = 0, children = v.children, i = children.length, w;
        while (--i >= 0) {
            w = children[i];
            w.z += shift;
            w.m += shift;
            shift += w.s + (change += w.c);
        }
    }
    function d3_layout_treeAncestor(vim, v, ancestor) {
        return vim.a.parent === v.parent ? vim.a : ancestor;
    }
    d3.layout.cluster = function() {
        var hierarchy = d3.layout.hierarchy().sort(null).value(null), separation = d3_layout_treeSeparation, size = [ 1, 1 ], nodeSize = false;
        function cluster(d, i) {
            var nodes = hierarchy.call(this, d, i), root = nodes[0], previousNode, x = 0;
            d3_layout_hierarchyVisitAfter(root, function(node) {
                var children = node.children;
                if (children && children.length) {
                    node.x = d3_layout_clusterX(children);
                    node.y = d3_layout_clusterY(children);
                } else {
                    node.x = previousNode ? x += separation(node, previousNode) : 0;
                    node.y = 0;
                    previousNode = node;
                }
            });
            var left = d3_layout_clusterLeft(root), right = d3_layout_clusterRight(root), x0 = left.x - separation(left, right) / 2, x1 = right.x + separation(right, left) / 2;
            d3_layout_hierarchyVisitAfter(root, nodeSize ? function(node) {
                node.x = (node.x - root.x) * size[0];
                node.y = (root.y - node.y) * size[1];
            } : function(node) {
                node.x = (node.x - x0) / (x1 - x0) * size[0];
                node.y = (1 - (root.y ? node.y / root.y : 1)) * size[1];
            });
            return nodes;
        }
        cluster.separation = function(x) {
            if (!arguments.length) return separation;
            separation = x;
            return cluster;
        };
        cluster.size = function(x) {
            if (!arguments.length) return nodeSize ? null : size;
            nodeSize = (size = x) == null;
            return cluster;
        };
        cluster.nodeSize = function(x) {
            if (!arguments.length) return nodeSize ? size : null;
            nodeSize = (size = x) != null;
            return cluster;
        };
        return d3_layout_hierarchyRebind(cluster, hierarchy);
    };
    function d3_layout_clusterY(children) {
        return 1 + d3.max(children, function(child) {
                return child.y;
            });
    }
    function d3_layout_clusterX(children) {
        return children.reduce(function(x, child) {
                return x + child.x;
            }, 0) / children.length;
    }
    function d3_layout_clusterLeft(node) {
        var children = node.children;
        return children && children.length ? d3_layout_clusterLeft(children[0]) : node;
    }
    function d3_layout_clusterRight(node) {
        var children = node.children, n;
        return children && (n = children.length) ? d3_layout_clusterRight(children[n - 1]) : node;
    }
    d3.layout.treemap = function() {
        var hierarchy = d3.layout.hierarchy(), round = Math.round, size = [ 1, 1 ], padding = null, pad = d3_layout_treemapPadNull, sticky = false, stickies, mode = "squarify", ratio = .5 * (1 + Math.sqrt(5));
        function scale(children, k) {
            var i = -1, n = children.length, child, area;
            while (++i < n) {
                area = (child = children[i]).value * (k < 0 ? 0 : k);
                child.area = isNaN(area) || area <= 0 ? 0 : area;
            }
        }
        function squarify(node) {
            var children = node.children;
            if (children && children.length) {
                var rect = pad(node), row = [], remaining = children.slice(), child, best = Infinity, score, u = mode === "slice" ? rect.dx : mode === "dice" ? rect.dy : mode === "slice-dice" ? node.depth & 1 ? rect.dy : rect.dx : Math.min(rect.dx, rect.dy), n;
                scale(remaining, rect.dx * rect.dy / node.value);
                row.area = 0;
                while ((n = remaining.length) > 0) {
                    row.push(child = remaining[n - 1]);
                    row.area += child.area;
                    if (mode !== "squarify" || (score = worst(row, u)) <= best) {
                        remaining.pop();
                        best = score;
                    } else {
                        row.area -= row.pop().area;
                        position(row, u, rect, false);
                        u = Math.min(rect.dx, rect.dy);
                        row.length = row.area = 0;
                        best = Infinity;
                    }
                }
                if (row.length) {
                    position(row, u, rect, true);
                    row.length = row.area = 0;
                }
                children.forEach(squarify);
            }
        }
        function stickify(node) {
            var children = node.children;
            if (children && children.length) {
                var rect = pad(node), remaining = children.slice(), child, row = [];
                scale(remaining, rect.dx * rect.dy / node.value);
                row.area = 0;
                while (child = remaining.pop()) {
                    row.push(child);
                    row.area += child.area;
                    if (child.z != null) {
                        position(row, child.z ? rect.dx : rect.dy, rect, !remaining.length);
                        row.length = row.area = 0;
                    }
                }
                children.forEach(stickify);
            }
        }
        function worst(row, u) {
            var s = row.area, r, rmax = 0, rmin = Infinity, i = -1, n = row.length;
            while (++i < n) {
                if (!(r = row[i].area)) continue;
                if (r < rmin) rmin = r;
                if (r > rmax) rmax = r;
            }
            s *= s;
            u *= u;
            return s ? Math.max(u * rmax * ratio / s, s / (u * rmin * ratio)) : Infinity;
        }
        function position(row, u, rect, flush) {
            var i = -1, n = row.length, x = rect.x, y = rect.y, v = u ? round(row.area / u) : 0, o;
            if (u == rect.dx) {
                if (flush || v > rect.dy) v = rect.dy;
                while (++i < n) {
                    o = row[i];
                    o.x = x;
                    o.y = y;
                    o.dy = v;
                    x += o.dx = Math.min(rect.x + rect.dx - x, v ? round(o.area / v) : 0);
                }
                o.z = true;
                o.dx += rect.x + rect.dx - x;
                rect.y += v;
                rect.dy -= v;
            } else {
                if (flush || v > rect.dx) v = rect.dx;
                while (++i < n) {
                    o = row[i];
                    o.x = x;
                    o.y = y;
                    o.dx = v;
                    y += o.dy = Math.min(rect.y + rect.dy - y, v ? round(o.area / v) : 0);
                }
                o.z = false;
                o.dy += rect.y + rect.dy - y;
                rect.x += v;
                rect.dx -= v;
            }
        }
        function treemap(d) {
            var nodes = stickies || hierarchy(d), root = nodes[0];
            root.x = 0;
            root.y = 0;
            root.dx = size[0];
            root.dy = size[1];
            if (stickies) hierarchy.revalue(root);
            scale([ root ], root.dx * root.dy / root.value);
            (stickies ? stickify : squarify)(root);
            if (sticky) stickies = nodes;
            return nodes;
        }
        treemap.size = function(x) {
            if (!arguments.length) return size;
            size = x;
            return treemap;
        };
        treemap.padding = function(x) {
            if (!arguments.length) return padding;
            function padFunction(node) {
                var p = x.call(treemap, node, node.depth);
                return p == null ? d3_layout_treemapPadNull(node) : d3_layout_treemapPad(node, typeof p === "number" ? [ p, p, p, p ] : p);
            }
            function padConstant(node) {
                return d3_layout_treemapPad(node, x);
            }
            var type;
            pad = (padding = x) == null ? d3_layout_treemapPadNull : (type = typeof x) === "function" ? padFunction : type === "number" ? (x = [ x, x, x, x ],
                padConstant) : padConstant;
            return treemap;
        };
        treemap.round = function(x) {
            if (!arguments.length) return round != Number;
            round = x ? Math.round : Number;
            return treemap;
        };
        treemap.sticky = function(x) {
            if (!arguments.length) return sticky;
            sticky = x;
            stickies = null;
            return treemap;
        };
        treemap.ratio = function(x) {
            if (!arguments.length) return ratio;
            ratio = x;
            return treemap;
        };
        treemap.mode = function(x) {
            if (!arguments.length) return mode;
            mode = x + "";
            return treemap;
        };
        return d3_layout_hierarchyRebind(treemap, hierarchy);
    };
    function d3_layout_treemapPadNull(node) {
        return {
            x: node.x,
            y: node.y,
            dx: node.dx,
            dy: node.dy
        };
    }
    function d3_layout_treemapPad(node, padding) {
        var x = node.x + padding[3], y = node.y + padding[0], dx = node.dx - padding[1] - padding[3], dy = node.dy - padding[0] - padding[2];
        if (dx < 0) {
            x += dx / 2;
            dx = 0;
        }
        if (dy < 0) {
            y += dy / 2;
            dy = 0;
        }
        return {
            x: x,
            y: y,
            dx: dx,
            dy: dy
        };
    }
    d3.random = {
        normal: function(base, sigma) {
            var n = arguments.length;
            if (n < 2) sigma = 1;
            if (n < 1) base = 0;
            return function() {
                var x, y, r;
                do {
                    x = Math.random() * 2 - 1;
                    y = Math.random() * 2 - 1;
                    r = x * x + y * y;
                } while (!r || r > 1);
                return base + sigma * x * Math.sqrt(-2 * Math.log(r) / r);
            };
        },
        logNormal: function() {
            var random = d3.random.normal.apply(d3, arguments);
            return function() {
                return Math.exp(random());
            };
        },
        bates: function(m) {
            var random = d3.random.irwinHall(m);
            return function() {
                return random() / m;
            };
        },
        irwinHall: function(m) {
            return function() {
                for (var s = 0, j = 0; j < m; j++) s += Math.random();
                return s;
            };
        }
    };
    d3.scale = {};
    function d3_scaleExtent(domain) {
        var start = domain[0], stop = domain[domain.length - 1];
        return start < stop ? [ start, stop ] : [ stop, start ];
    }
    function d3_scaleRange(scale) {
        return scale.rangeExtent ? scale.rangeExtent() : d3_scaleExtent(scale.range());
    }
    function d3_scale_bilinear(domain, range, uninterpolate, interpolate) {
        var u = uninterpolate(domain[0], domain[1]), i = interpolate(range[0], range[1]);
        return function(x) {
            return i(u(x));
        };
    }
    function d3_scale_nice(domain, nice) {
        var i0 = 0, i1 = domain.length - 1, x0 = domain[i0], x1 = domain[i1], dx;
        if (x1 < x0) {
            dx = i0, i0 = i1, i1 = dx;
            dx = x0, x0 = x1, x1 = dx;
        }
        domain[i0] = nice.floor(x0);
        domain[i1] = nice.ceil(x1);
        return domain;
    }
    function d3_scale_niceStep(step) {
        return step ? {
            floor: function(x) {
                return Math.floor(x / step) * step;
            },
            ceil: function(x) {
                return Math.ceil(x / step) * step;
            }
        } : d3_scale_niceIdentity;
    }
    var d3_scale_niceIdentity = {
        floor: d3_identity,
        ceil: d3_identity
    };
    function d3_scale_polylinear(domain, range, uninterpolate, interpolate) {
        var u = [], i = [], j = 0, k = Math.min(domain.length, range.length) - 1;
        if (domain[k] < domain[0]) {
            domain = domain.slice().reverse();
            range = range.slice().reverse();
        }
        while (++j <= k) {
            u.push(uninterpolate(domain[j - 1], domain[j]));
            i.push(interpolate(range[j - 1], range[j]));
        }
        return function(x) {
            var j = d3.bisect(domain, x, 1, k) - 1;
            return i[j](u[j](x));
        };
    }
    d3.scale.linear = function() {
        return d3_scale_linear([ 0, 1 ], [ 0, 1 ], d3_interpolate, false);
    };
    function d3_scale_linear(domain, range, interpolate, clamp) {
        var output, input;
        function rescale() {
            var linear = Math.min(domain.length, range.length) > 2 ? d3_scale_polylinear : d3_scale_bilinear, uninterpolate = clamp ? d3_uninterpolateClamp : d3_uninterpolateNumber;
            output = linear(domain, range, uninterpolate, interpolate);
            input = linear(range, domain, uninterpolate, d3_interpolate);
            return scale;
        }
        function scale(x) {
            return output(x);
        }
        scale.invert = function(y) {
            return input(y);
        };
        scale.domain = function(x) {
            if (!arguments.length) return domain;
            domain = x.map(Number);
            return rescale();
        };
        scale.range = function(x) {
            if (!arguments.length) return range;
            range = x;
            return rescale();
        };
        scale.rangeRound = function(x) {
            return scale.range(x).interpolate(d3_interpolateRound);
        };
        scale.clamp = function(x) {
            if (!arguments.length) return clamp;
            clamp = x;
            return rescale();
        };
        scale.interpolate = function(x) {
            if (!arguments.length) return interpolate;
            interpolate = x;
            return rescale();
        };
        scale.ticks = function(m) {
            return d3_scale_linearTicks(domain, m);
        };
        scale.tickFormat = function(m, format) {
            return d3_scale_linearTickFormat(domain, m, format);
        };
        scale.nice = function(m) {
            d3_scale_linearNice(domain, m);
            return rescale();
        };
        scale.copy = function() {
            return d3_scale_linear(domain, range, interpolate, clamp);
        };
        return rescale();
    }
    function d3_scale_linearRebind(scale, linear) {
        return d3.rebind(scale, linear, "range", "rangeRound", "interpolate", "clamp");
    }
    function d3_scale_linearNice(domain, m) {
        return d3_scale_nice(domain, d3_scale_niceStep(d3_scale_linearTickRange(domain, m)[2]));
    }
    function d3_scale_linearTickRange(domain, m) {
        if (m == null) m = 10;
        var extent = d3_scaleExtent(domain), span = extent[1] - extent[0], step = Math.pow(10, Math.floor(Math.log(span / m) / Math.LN10)), err = m / span * step;
        if (err <= .15) step *= 10; else if (err <= .35) step *= 5; else if (err <= .75) step *= 2;
        extent[0] = Math.ceil(extent[0] / step) * step;
        extent[1] = Math.floor(extent[1] / step) * step + step * .5;
        extent[2] = step;
        return extent;
    }
    function d3_scale_linearTicks(domain, m) {
        return d3.range.apply(d3, d3_scale_linearTickRange(domain, m));
    }
    function d3_scale_linearTickFormat(domain, m, format) {
        var range = d3_scale_linearTickRange(domain, m);
        if (format) {
            var match = d3_format_re.exec(format);
            match.shift();
            if (match[8] === "s") {
                var prefix = d3.formatPrefix(Math.max(abs(range[0]), abs(range[1])));
                if (!match[7]) match[7] = "." + d3_scale_linearPrecision(prefix.scale(range[2]));
                match[8] = "f";
                format = d3.format(match.join(""));
                return function(d) {
                    return format(prefix.scale(d)) + prefix.symbol;
                };
            }
            if (!match[7]) match[7] = "." + d3_scale_linearFormatPrecision(match[8], range);
            format = match.join("");
        } else {
            format = ",." + d3_scale_linearPrecision(range[2]) + "f";
        }
        return d3.format(format);
    }
    var d3_scale_linearFormatSignificant = {
        s: 1,
        g: 1,
        p: 1,
        r: 1,
        e: 1
    };
    function d3_scale_linearPrecision(value) {
        return -Math.floor(Math.log(value) / Math.LN10 + .01);
    }
    function d3_scale_linearFormatPrecision(type, range) {
        var p = d3_scale_linearPrecision(range[2]);
        return type in d3_scale_linearFormatSignificant ? Math.abs(p - d3_scale_linearPrecision(Math.max(abs(range[0]), abs(range[1])))) + +(type !== "e") : p - (type === "%") * 2;
    }
    d3.scale.log = function() {
        return d3_scale_log(d3.scale.linear().domain([ 0, 1 ]), 10, true, [ 1, 10 ]);
    };
    function d3_scale_log(linear, base, positive, domain) {
        function log(x) {
            return (positive ? Math.log(x < 0 ? 0 : x) : -Math.log(x > 0 ? 0 : -x)) / Math.log(base);
        }
        function pow(x) {
            return positive ? Math.pow(base, x) : -Math.pow(base, -x);
        }
        function scale(x) {
            return linear(log(x));
        }
        scale.invert = function(x) {
            return pow(linear.invert(x));
        };
        scale.domain = function(x) {
            if (!arguments.length) return domain;
            positive = x[0] >= 0;
            linear.domain((domain = x.map(Number)).map(log));
            return scale;
        };
        scale.base = function(_) {
            if (!arguments.length) return base;
            base = +_;
            linear.domain(domain.map(log));
            return scale;
        };
        scale.nice = function() {
            var niced = d3_scale_nice(domain.map(log), positive ? Math : d3_scale_logNiceNegative);
            linear.domain(niced);
            domain = niced.map(pow);
            return scale;
        };
        scale.ticks = function() {
            var extent = d3_scaleExtent(domain), ticks = [], u = extent[0], v = extent[1], i = Math.floor(log(u)), j = Math.ceil(log(v)), n = base % 1 ? 2 : base;
            if (isFinite(j - i)) {
                if (positive) {
                    for (;i < j; i++) for (var k = 1; k < n; k++) ticks.push(pow(i) * k);
                    ticks.push(pow(i));
                } else {
                    ticks.push(pow(i));
                    for (;i++ < j; ) for (var k = n - 1; k > 0; k--) ticks.push(pow(i) * k);
                }
                for (i = 0; ticks[i] < u; i++) {}
                for (j = ticks.length; ticks[j - 1] > v; j--) {}
                ticks = ticks.slice(i, j);
            }
            return ticks;
        };
        scale.tickFormat = function(n, format) {
            if (!arguments.length) return d3_scale_logFormat;
            if (arguments.length < 2) format = d3_scale_logFormat; else if (typeof format !== "function") format = d3.format(format);
            var k = Math.max(.1, n / scale.ticks().length), f = positive ? (e = 1e-12, Math.ceil) : (e = -1e-12,
                Math.floor), e;
            return function(d) {
                return d / pow(f(log(d) + e)) <= k ? format(d) : "";
            };
        };
        scale.copy = function() {
            return d3_scale_log(linear.copy(), base, positive, domain);
        };
        return d3_scale_linearRebind(scale, linear);
    }
    var d3_scale_logFormat = d3.format(".0e"), d3_scale_logNiceNegative = {
        floor: function(x) {
            return -Math.ceil(-x);
        },
        ceil: function(x) {
            return -Math.floor(-x);
        }
    };
    d3.scale.pow = function() {
        return d3_scale_pow(d3.scale.linear(), 1, [ 0, 1 ]);
    };
    function d3_scale_pow(linear, exponent, domain) {
        var powp = d3_scale_powPow(exponent), powb = d3_scale_powPow(1 / exponent);
        function scale(x) {
            return linear(powp(x));
        }
        scale.invert = function(x) {
            return powb(linear.invert(x));
        };
        scale.domain = function(x) {
            if (!arguments.length) return domain;
            linear.domain((domain = x.map(Number)).map(powp));
            return scale;
        };
        scale.ticks = function(m) {
            return d3_scale_linearTicks(domain, m);
        };
        scale.tickFormat = function(m, format) {
            return d3_scale_linearTickFormat(domain, m, format);
        };
        scale.nice = function(m) {
            return scale.domain(d3_scale_linearNice(domain, m));
        };
        scale.exponent = function(x) {
            if (!arguments.length) return exponent;
            powp = d3_scale_powPow(exponent = x);
            powb = d3_scale_powPow(1 / exponent);
            linear.domain(domain.map(powp));
            return scale;
        };
        scale.copy = function() {
            return d3_scale_pow(linear.copy(), exponent, domain);
        };
        return d3_scale_linearRebind(scale, linear);
    }
    function d3_scale_powPow(e) {
        return function(x) {
            return x < 0 ? -Math.pow(-x, e) : Math.pow(x, e);
        };
    }
    d3.scale.sqrt = function() {
        return d3.scale.pow().exponent(.5);
    };
    d3.scale.ordinal = function() {
        return d3_scale_ordinal([], {
            t: "range",
            a: [ [] ]
        });
    };
    function d3_scale_ordinal(domain, ranger) {
        var index, range, rangeBand;
        function scale(x) {
            return range[((index.get(x) || (ranger.t === "range" ? index.set(x, domain.push(x)) : NaN)) - 1) % range.length];
        }
        function steps(start, step) {
            return d3.range(domain.length).map(function(i) {
                return start + step * i;
            });
        }
        scale.domain = function(x) {
            if (!arguments.length) return domain;
            domain = [];
            index = new d3_Map();
            var i = -1, n = x.length, xi;
            while (++i < n) if (!index.has(xi = x[i])) index.set(xi, domain.push(xi));
            return scale[ranger.t].apply(scale, ranger.a);
        };
        scale.range = function(x) {
            if (!arguments.length) return range;
            range = x;
            rangeBand = 0;
            ranger = {
                t: "range",
                a: arguments
            };
            return scale;
        };
        scale.rangePoints = function(x, padding) {
            if (arguments.length < 2) padding = 0;
            var start = x[0], stop = x[1], step = domain.length < 2 ? (start = (start + stop) / 2,
                0) : (stop - start) / (domain.length - 1 + padding);
            range = steps(start + step * padding / 2, step);
            rangeBand = 0;
            ranger = {
                t: "rangePoints",
                a: arguments
            };
            return scale;
        };
        scale.rangeRoundPoints = function(x, padding) {
            if (arguments.length < 2) padding = 0;
            var start = x[0], stop = x[1], step = domain.length < 2 ? (start = stop = Math.round((start + stop) / 2),
                0) : (stop - start) / (domain.length - 1 + padding) | 0;
            range = steps(start + Math.round(step * padding / 2 + (stop - start - (domain.length - 1 + padding) * step) / 2), step);
            rangeBand = 0;
            ranger = {
                t: "rangeRoundPoints",
                a: arguments
            };
            return scale;
        };
        scale.rangeBands = function(x, padding, outerPadding) {
            if (arguments.length < 2) padding = 0;
            if (arguments.length < 3) outerPadding = padding;
            var reverse = x[1] < x[0], start = x[reverse - 0], stop = x[1 - reverse], step = (stop - start) / (domain.length - padding + 2 * outerPadding);
            range = steps(start + step * outerPadding, step);
            if (reverse) range.reverse();
            rangeBand = step * (1 - padding);
            ranger = {
                t: "rangeBands",
                a: arguments
            };
            return scale;
        };
        scale.rangeRoundBands = function(x, padding, outerPadding) {
            if (arguments.length < 2) padding = 0;
            if (arguments.length < 3) outerPadding = padding;
            var reverse = x[1] < x[0], start = x[reverse - 0], stop = x[1 - reverse], step = Math.floor((stop - start) / (domain.length - padding + 2 * outerPadding));
            range = steps(start + Math.round((stop - start - (domain.length - padding) * step) / 2), step);
            if (reverse) range.reverse();
            rangeBand = Math.round(step * (1 - padding));
            ranger = {
                t: "rangeRoundBands",
                a: arguments
            };
            return scale;
        };
        scale.rangeBand = function() {
            return rangeBand;
        };
        scale.rangeExtent = function() {
            return d3_scaleExtent(ranger.a[0]);
        };
        scale.copy = function() {
            return d3_scale_ordinal(domain, ranger);
        };
        return scale.domain(domain);
    }
    d3.scale.category10 = function() {
        return d3.scale.ordinal().range(d3_category10);
    };
    d3.scale.category20 = function() {
        return d3.scale.ordinal().range(d3_category20);
    };
    d3.scale.category20b = function() {
        return d3.scale.ordinal().range(d3_category20b);
    };
    d3.scale.category20c = function() {
        return d3.scale.ordinal().range(d3_category20c);
    };
    var d3_category10 = [ 2062260, 16744206, 2924588, 14034728, 9725885, 9197131, 14907330, 8355711, 12369186, 1556175 ].map(d3_rgbString);
    var d3_category20 = [ 2062260, 11454440, 16744206, 16759672, 2924588, 10018698, 14034728, 16750742, 9725885, 12955861, 9197131, 12885140, 14907330, 16234194, 8355711, 13092807, 12369186, 14408589, 1556175, 10410725 ].map(d3_rgbString);
    var d3_category20b = [ 3750777, 5395619, 7040719, 10264286, 6519097, 9216594, 11915115, 13556636, 9202993, 12426809, 15186514, 15190932, 8666169, 11356490, 14049643, 15177372, 8077683, 10834324, 13528509, 14589654 ].map(d3_rgbString);
    var d3_category20c = [ 3244733, 7057110, 10406625, 13032431, 15095053, 16616764, 16625259, 16634018, 3253076, 7652470, 10607003, 13101504, 7695281, 10394312, 12369372, 14342891, 6513507, 9868950, 12434877, 14277081 ].map(d3_rgbString);
    d3.scale.quantile = function() {
        return d3_scale_quantile([], []);
    };
    function d3_scale_quantile(domain, range) {
        var thresholds;
        function rescale() {
            var k = 0, q = range.length;
            thresholds = [];
            while (++k < q) thresholds[k - 1] = d3.quantile(domain, k / q);
            return scale;
        }
        function scale(x) {
            if (!isNaN(x = +x)) return range[d3.bisect(thresholds, x)];
        }
        scale.domain = function(x) {
            if (!arguments.length) return domain;
            domain = x.map(d3_number).filter(d3_numeric).sort(d3_ascending);
            return rescale();
        };
        scale.range = function(x) {
            if (!arguments.length) return range;
            range = x;
            return rescale();
        };
        scale.quantiles = function() {
            return thresholds;
        };
        scale.invertExtent = function(y) {
            y = range.indexOf(y);
            return y < 0 ? [ NaN, NaN ] : [ y > 0 ? thresholds[y - 1] : domain[0], y < thresholds.length ? thresholds[y] : domain[domain.length - 1] ];
        };
        scale.copy = function() {
            return d3_scale_quantile(domain, range);
        };
        return rescale();
    }
    d3.scale.quantize = function() {
        return d3_scale_quantize(0, 1, [ 0, 1 ]);
    };
    function d3_scale_quantize(x0, x1, range) {
        var kx, i;
        function scale(x) {
            return range[Math.max(0, Math.min(i, Math.floor(kx * (x - x0))))];
        }
        function rescale() {
            kx = range.length / (x1 - x0);
            i = range.length - 1;
            return scale;
        }
        scale.domain = function(x) {
            if (!arguments.length) return [ x0, x1 ];
            x0 = +x[0];
            x1 = +x[x.length - 1];
            return rescale();
        };
        scale.range = function(x) {
            if (!arguments.length) return range;
            range = x;
            return rescale();
        };
        scale.invertExtent = function(y) {
            y = range.indexOf(y);
            y = y < 0 ? NaN : y / kx + x0;
            return [ y, y + 1 / kx ];
        };
        scale.copy = function() {
            return d3_scale_quantize(x0, x1, range);
        };
        return rescale();
    }
    d3.scale.threshold = function() {
        return d3_scale_threshold([ .5 ], [ 0, 1 ]);
    };
    function d3_scale_threshold(domain, range) {
        function scale(x) {
            if (x <= x) return range[d3.bisect(domain, x)];
        }
        scale.domain = function(_) {
            if (!arguments.length) return domain;
            domain = _;
            return scale;
        };
        scale.range = function(_) {
            if (!arguments.length) return range;
            range = _;
            return scale;
        };
        scale.invertExtent = function(y) {
            y = range.indexOf(y);
            return [ domain[y - 1], domain[y] ];
        };
        scale.copy = function() {
            return d3_scale_threshold(domain, range);
        };
        return scale;
    }
    d3.scale.identity = function() {
        return d3_scale_identity([ 0, 1 ]);
    };
    function d3_scale_identity(domain) {
        function identity(x) {
            return +x;
        }
        identity.invert = identity;
        identity.domain = identity.range = function(x) {
            if (!arguments.length) return domain;
            domain = x.map(identity);
            return identity;
        };
        identity.ticks = function(m) {
            return d3_scale_linearTicks(domain, m);
        };
        identity.tickFormat = function(m, format) {
            return d3_scale_linearTickFormat(domain, m, format);
        };
        identity.copy = function() {
            return d3_scale_identity(domain);
        };
        return identity;
    }
    d3.svg = {};
    function d3_zero() {
        return 0;
    }
    d3.svg.arc = function() {
        var toCenter = true;
        var closePath = true;
        var innerRadius = d3_svg_arcInnerRadius, outerRadius = d3_svg_arcOuterRadius, cornerRadius = d3_zero, padRadius = d3_svg_arcAuto, startAngle = d3_svg_arcStartAngle, endAngle = d3_svg_arcEndAngle, padAngle = d3_svg_arcPadAngle;
        function arc() {
            var r0 = Math.max(0, +innerRadius.apply(this, arguments)), r1 = Math.max(0, +outerRadius.apply(this, arguments)), a0 = startAngle.apply(this, arguments) - half, a1 = endAngle.apply(this, arguments) - half, da = Math.abs(a1 - a0), cw = a0 > a1 ? 0 : 1;
            if (r1 < r0) rc = r1, r1 = r0, r0 = rc;
            if (da >= ) return circleSegment(r1, cw) + (r0 ? circleSegment(r0, 1 - cw) : "") + "Z";
            var rc, cr, rp, ap, p0 = 0, p1 = 0, x0, y0, x1, y1, x2, y2, x3, y3, path = [];
            if (ap = (+padAngle.apply(this, arguments) || 0) / 2) {
                rp = padRadius === d3_svg_arcAuto ? Math.sqrt(r0 * r0 + r1 * r1) : +padRadius.apply(this, arguments);
                if (!cw) p1 *= -1;
                if (r1) p1 = d3_asin(rp / r1 * Math.sin(ap));
                if (r0) p0 = d3_asin(rp / r0 * Math.sin(ap));
            }
            if (r1) {
                x0 = r1 * Math.cos(a0 + p1);
                y0 = r1 * Math.sin(a0 + p1);
                x1 = r1 * Math.cos(a1 - p1);
                y1 = r1 * Math.sin(a1 - p1);
                var l1 = Math.abs(a1 - a0 - 2 * p1) <=  ? 0 : 1;
                if (p1 && d3_svg_arcSweep(x0, y0, x1, y1) === cw ^ l1) {
                    var h1 = (a0 + a1) / 2;
                    x0 = r1 * Math.cos(h1);
                    y0 = r1 * Math.sin(h1);
                    x1 = y1 = null;
                }
            } else {
                x0 = y0 = 0;
            }
            if (r0) {
                x2 = r0 * Math.cos(a1 - p0);
                y2 = r0 * Math.sin(a1 - p0);
                x3 = r0 * Math.cos(a0 + p0);
                y3 = r0 * Math.sin(a0 + p0);
                var l0 = Math.abs(a0 - a1 + 2 * p0) <=  ? 0 : 1;
                if (p0 && d3_svg_arcSweep(x2, y2, x3, y3) === 1 - cw ^ l0) {
                    var h0 = (a0 + a1) / 2;
                    x2 = r0 * Math.cos(h0);
                    y2 = r0 * Math.sin(h0);
                    x3 = y3 = null;
                }
            } else {
                x2 = y2 = 0;
            }
            if ((rc = Math.min(Math.abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments))) > .001) {
                cr = r0 < r1 ^ cw ? 0 : 1;
                var oc = x3 == null ? [ x2, y2 ] : x1 == null ? [ x0, y0 ] : d3_geom_polygonIntersect([ x0, y0 ], [ x3, y3 ], [ x1, y1 ], [ x2, y2 ]), ax = x0 - oc[0], ay = y0 - oc[1], bx = x1 - oc[0], by = y1 - oc[1], kc = 1 / Math.sin(Math.acos((ax * bx + ay * by) / (Math.sqrt(ax * ax + ay * ay) * Math.sqrt(bx * bx + by * by))) / 2), lc = Math.sqrt(oc[0] * oc[0] + oc[1] * oc[1]);
                if (x1 != null) {
                    var rc1 = Math.min(rc, (r1 - lc) / (kc + 1)), t30 = d3_svg_arcCornerTangents(x3 == null ? [ x2, y2 ] : [ x3, y3 ], [ x0, y0 ], r1, rc1, cw), t12 = d3_svg_arcCornerTangents([ x1, y1 ], [ x2, y2 ], r1, rc1, cw);
                    if (rc === rc1) {
                        path.push("M", t30[0], "A", rc1, ",", rc1, " 0 0,", cr, " ", t30[1], "A", r1, ",", r1, " 0 ", 1 - cw ^ d3_svg_arcSweep(t30[1][0], t30[1][1], t12[1][0], t12[1][1]), ",", cw, " ", t12[1], "A", rc1, ",", rc1, " 0 0,", cr, " ", t12[0]);
                    } else {
                        path.push("M", t30[0], "A", rc1, ",", rc1, " 0 1,", cr, " ", t12[0]);
                    }
                } else {
                    path.push("M", x0, ",", y0);
                }
                if (x3 != null) {
                    var rc0 = Math.min(rc, (r0 - lc) / (kc - 1)), t03 = d3_svg_arcCornerTangents([ x0, y0 ], [ x3, y3 ], r0, -rc0, cw), t21 = d3_svg_arcCornerTangents([ x2, y2 ], x1 == null ? [ x0, y0 ] : [ x1, y1 ], r0, -rc0, cw);
                    if (rc === rc0) {
                        path.push("L", t21[0], "A", rc0, ",", rc0, " 0 0,", cr, " ", t21[1], "A", r0, ",", r0, " 0 ", cw ^ d3_svg_arcSweep(t21[1][0], t21[1][1], t03[1][0], t03[1][1]), ",", 1 - cw, " ", t03[1], "A", rc0, ",", rc0, " 0 0,", cr, " ", t03[0]);
                    } else {
                        path.push("L", t21[0], "A", rc0, ",", rc0, " 0 0,", cr, " ", t03[0]);
                    }
                } else if(toCenter){
                    path.push("L", x2, ",", y2);
                }
            } else {
                path.push("M", x0, ",", y0);
                if (x1 != null) path.push("A", r1, ",", r1, " 0 ", l1, ",", cw, " ", x1, ",", y1);
                if (toCenter) path.push("L", x2, ",", y2);
                if (x3 != null) path.push("A", r0, ",", r0, " 0 ", l0, ",", 1 - cw, " ", x3, ",", y3);
            }
            if(closePath) path.push("Z");
            return path.join("");
        }
        function circleSegment(r1, cw) {
            return "M0," + r1 + "A" + r1 + "," + r1 + " 0 1," + cw + " 0," + -r1 + "A" + r1 + "," + r1 + " 0 1," + cw + " 0," + r1;
        }

        arc.toCenter = function(v){
            if (!arguments.length) return toCenter;
            toCenter = !!v;
            return arc;
        };

        arc.closePath = function(v){
            if (!arguments.length) return closePath;
            closePath = !!v;
            return arc;
        },

            arc.innerRadius = function(v) {
                if (!arguments.length) return innerRadius;
                innerRadius = d3_functor(v);
                return arc;
            };
        arc.outerRadius = function(v) {
            if (!arguments.length) return outerRadius;
            outerRadius = d3_functor(v);
            return arc;
        };
        arc.cornerRadius = function(v) {
            if (!arguments.length) return cornerRadius;
            cornerRadius = d3_functor(v);
            return arc;
        };
        arc.padRadius = function(v) {
            if (!arguments.length) return padRadius;
            padRadius = v == d3_svg_arcAuto ? d3_svg_arcAuto : d3_functor(v);
            return arc;
        };
        arc.startAngle = function(v) {
            if (!arguments.length) return startAngle;
            startAngle = d3_functor(v);
            return arc;
        };
        arc.endAngle = function(v) {
            if (!arguments.length) return endAngle;
            endAngle = d3_functor(v);
            return arc;
        };
        arc.padAngle = function(v) {
            if (!arguments.length) return padAngle;
            padAngle = d3_functor(v);
            return arc;
        };
        arc.centroid = function() {
            var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2, a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - half;
            return [ Math.cos(a) * r, Math.sin(a) * r ];
        };
        return arc;
    };
    var d3_svg_arcAuto = "auto";
    function d3_svg_arcInnerRadius(d) {
        return d.innerRadius;
    }
    function d3_svg_arcOuterRadius(d) {
        return d.outerRadius;
    }
    function d3_svg_arcStartAngle(d) {
        return d.startAngle;
    }
    function d3_svg_arcEndAngle(d) {
        return d.endAngle;
    }
    function d3_svg_arcPadAngle(d) {
        return d && d.padAngle;
    }
    function d3_svg_arcSweep(x0, y0, x1, y1) {
        return (x0 - x1) * y0 - (y0 - y1) * x0 > 0 ? 0 : 1;
    }
    function d3_svg_arcCornerTangents(p0, p1, r1, rc, cw) {
        var x01 = p0[0] - p1[0], y01 = p0[1] - p1[1], lo = (cw ? rc : -rc) / Math.sqrt(x01 * x01 + y01 * y01), ox = lo * y01, oy = -lo * x01, x1 = p0[0] + ox, y1 = p0[1] + oy, x2 = p1[0] + ox, y2 = p1[1] + oy, x3 = (x1 + x2) / 2, y3 = (y1 + y2) / 2, dx = x2 - x1, dy = y2 - y1, d2 = dx * dx + dy * dy, r = r1 - rc, D = x1 * y2 - x2 * y1, d = (dy < 0 ? -1 : 1) * Math.sqrt(r * r * d2 - D * D), cx0 = (D * dy - dx * d) / d2, cy0 = (-D * dx - dy * d) / d2, cx1 = (D * dy + dx * d) / d2, cy1 = (-D * dx + dy * d) / d2, dx0 = cx0 - x3, dy0 = cy0 - y3, dx1 = cx1 - x3, dy1 = cy1 - y3;
        if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;
        return [ [ cx0 - ox, cy0 - oy ], [ cx0 * r1 / r, cy0 * r1 / r ] ];
    }
    function d3_svg_line(projection) {
        var x = d3_geom_pointX, y = d3_geom_pointY, defined = d3_true, interpolate = d3_svg_lineLinear, interpolateKey = interpolate.key, tension = .7;
        function line(data) {
            var segments = [], points = [], i = -1, n = data.length, d, fx = d3_functor(x), fy = d3_functor(y);
            function segment() {
                segments.push("M", interpolate(projection(points), tension));
            }
            while (++i < n) {
                if (defined.call(this, d = data[i], i)) {
                    points.push([ +fx.call(this, d, i), +fy.call(this, d, i) ]);
                } else if (points.length) {
                    segment();
                    points = [];
                }
            }
            if (points.length) segment();
            return segments.length ? segments.join("") : null;
        }
        line.x = function(_) {
            if (!arguments.length) return x;
            x = _;
            return line;
        };
        line.y = function(_) {
            if (!arguments.length) return y;
            y = _;
            return line;
        };
        line.defined = function(_) {
            if (!arguments.length) return defined;
            defined = _;
            return line;
        };
        line.interpolate = function(_) {
            if (!arguments.length) return interpolateKey;
            if (typeof _ === "function") interpolateKey = interpolate = _; else interpolateKey = (interpolate = d3_svg_lineInterpolators.get(_) || d3_svg_lineLinear).key;
            return line;
        };
        line.tension = function(_) {
            if (!arguments.length) return tension;
            tension = _;
            return line;
        };
        return line;
    }
    d3.svg.line = function() {
        return d3_svg_line(d3_identity);
    };
    var d3_svg_lineInterpolators = d3.map({
        linear: d3_svg_lineLinear,
        "linear-closed": d3_svg_lineLinearClosed,
        step: d3_svg_lineStep,
        "step-before": d3_svg_lineStepBefore,
        "step-after": d3_svg_lineStepAfter,
        basis: d3_svg_lineBasis,
        "basis-open": d3_svg_lineBasisOpen,
        "basis-closed": d3_svg_lineBasisClosed,
        bundle: d3_svg_lineBundle,
        cardinal: d3_svg_lineCardinal,
        "cardinal-open": d3_svg_lineCardinalOpen,
        "cardinal-closed": d3_svg_lineCardinalClosed,
        monotone: d3_svg_lineMonotone
    });
    d3_svg_lineInterpolators.forEach(function(key, value) {
        value.key = key;
        value.closed = /-closed$/.test(key);
    });
    function d3_svg_lineLinear(points) {
        return points.join("L");
    }
    function d3_svg_lineLinearClosed(points) {
        return d3_svg_lineLinear(points) + "Z";
    }
    function d3_svg_lineStep(points) {
        var i = 0, n = points.length, p = points[0], path = [ p[0], ",", p[1] ];
        while (++i < n) path.push("H", (p[0] + (p = points[i])[0]) / 2, "V", p[1]);
        if (n > 1) path.push("H", p[0]);
        return path.join("");
    }
    function d3_svg_lineStepBefore(points) {
        var i = 0, n = points.length, p = points[0], path = [ p[0], ",", p[1] ];
        while (++i < n) path.push("V", (p = points[i])[1], "H", p[0]);
        return path.join("");
    }
    function d3_svg_lineStepAfter(points) {
        var i = 0, n = points.length, p = points[0], path = [ p[0], ",", p[1] ];
        while (++i < n) path.push("H", (p = points[i])[0], "V", p[1]);
        return path.join("");
    }
    function d3_svg_lineCardinalOpen(points, tension) {
        return points.length < 4 ? d3_svg_lineLinear(points) : points[1] + d3_svg_lineHermite(points.slice(1, -1), d3_svg_lineCardinalTangents(points, tension));
    }
    function d3_svg_lineCardinalClosed(points, tension) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite((points.push(points[0]),
            points), d3_svg_lineCardinalTangents([ points[points.length - 2] ].concat(points, [ points[1] ]), tension));
    }
    function d3_svg_lineCardinal(points, tension) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite(points, d3_svg_lineCardinalTangents(points, tension));
    }
    function d3_svg_lineHermite(points, tangents) {
        if (tangents.length < 1 || points.length != tangents.length && points.length != tangents.length + 2) {
            return d3_svg_lineLinear(points);
        }
        var quad = points.length != tangents.length, path = "", p0 = points[0], p = points[1], t0 = tangents[0], t = t0, pi = 1;
        if (quad) {
            path += "Q" + (p[0] - t0[0] * 2 / 3) + "," + (p[1] - t0[1] * 2 / 3) + "," + p[0] + "," + p[1];
            p0 = points[1];
            pi = 2;
        }
        if (tangents.length > 1) {
            t = tangents[1];
            p = points[pi];
            pi++;
            path += "C" + (p0[0] + t0[0]) + "," + (p0[1] + t0[1]) + "," + (p[0] - t[0]) + "," + (p[1] - t[1]) + "," + p[0] + "," + p[1];
            for (var i = 2; i < tangents.length; i++, pi++) {
                p = points[pi];
                t = tangents[i];
                path += "S" + (p[0] - t[0]) + "," + (p[1] - t[1]) + "," + p[0] + "," + p[1];
            }
        }
        if (quad) {
            var lp = points[pi];
            path += "Q" + (p[0] + t[0] * 2 / 3) + "," + (p[1] + t[1] * 2 / 3) + "," + lp[0] + "," + lp[1];
        }
        return path;
    }
    function d3_svg_lineCardinalTangents(points, tension) {
        var tangents = [], a = (1 - tension) / 2, p0, p1 = points[0], p2 = points[1], i = 1, n = points.length;
        while (++i < n) {
            p0 = p1;
            p1 = p2;
            p2 = points[i];
            tangents.push([ a * (p2[0] - p0[0]), a * (p2[1] - p0[1]) ]);
        }
        return tangents;
    }
    function d3_svg_lineBasis(points) {
        if (points.length < 3) return d3_svg_lineLinear(points);
        var i = 1, n = points.length, pi = points[0], x0 = pi[0], y0 = pi[1], px = [ x0, x0, x0, (pi = points[1])[0] ], py = [ y0, y0, y0, pi[1] ], path = [ x0, ",", y0, "L", d3_svg_lineDot4(d3_svg_lineBasisBezier3, px), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, py) ];
        points.push(points[n - 1]);
        while (++i <= n) {
            pi = points[i];
            px.shift();
            px.push(pi[0]);
            py.shift();
            py.push(pi[1]);
            d3_svg_lineBasisBezier(path, px, py);
        }
        points.pop();
        path.push("L", pi);
        return path.join("");
    }
    function d3_svg_lineBasisOpen(points) {
        if (points.length < 4) return d3_svg_lineLinear(points);
        var path = [], i = -1, n = points.length, pi, px = [ 0 ], py = [ 0 ];
        while (++i < 3) {
            pi = points[i];
            px.push(pi[0]);
            py.push(pi[1]);
        }
        path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3, px) + "," + d3_svg_lineDot4(d3_svg_lineBasisBezier3, py));
        --i;
        while (++i < n) {
            pi = points[i];
            px.shift();
            px.push(pi[0]);
            py.shift();
            py.push(pi[1]);
            d3_svg_lineBasisBezier(path, px, py);
        }
        return path.join("");
    }
    function d3_svg_lineBasisClosed(points) {
        var path, i = -1, n = points.length, m = n + 4, pi, px = [], py = [];
        while (++i < 4) {
            pi = points[i % n];
            px.push(pi[0]);
            py.push(pi[1]);
        }
        path = [ d3_svg_lineDot4(d3_svg_lineBasisBezier3, px), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, py) ];
        --i;
        while (++i < m) {
            pi = points[i % n];
            px.shift();
            px.push(pi[0]);
            py.shift();
            py.push(pi[1]);
            d3_svg_lineBasisBezier(path, px, py);
        }
        return path.join("");
    }
    function d3_svg_lineBundle(points, tension) {
        var n = points.length - 1;
        if (n) {
            var x0 = points[0][0], y0 = points[0][1], dx = points[n][0] - x0, dy = points[n][1] - y0, i = -1, p, t;
            while (++i <= n) {
                p = points[i];
                t = i / n;
                p[0] = tension * p[0] + (1 - tension) * (x0 + t * dx);
                p[1] = tension * p[1] + (1 - tension) * (y0 + t * dy);
            }
        }
        return d3_svg_lineBasis(points);
    }
    function d3_svg_lineDot4(a, b) {
        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];
    }
    var d3_svg_lineBasisBezier1 = [ 0, 2 / 3, 1 / 3, 0 ], d3_svg_lineBasisBezier2 = [ 0, 1 / 3, 2 / 3, 0 ], d3_svg_lineBasisBezier3 = [ 0, 1 / 6, 2 / 3, 1 / 6 ];
    function d3_svg_lineBasisBezier(path, x, y) {
        path.push("C", d3_svg_lineDot4(d3_svg_lineBasisBezier1, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier1, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, y));
    }
    function d3_svg_lineSlope(p0, p1) {
        return (p1[1] - p0[1]) / (p1[0] - p0[0]);
    }
    function d3_svg_lineFiniteDifferences(points) {
        var i = 0, j = points.length - 1, m = [], p0 = points[0], p1 = points[1], d = m[0] = d3_svg_lineSlope(p0, p1);
        while (++i < j) {
            m[i] = (d + (d = d3_svg_lineSlope(p0 = p1, p1 = points[i + 1]))) / 2;
        }
        m[i] = d;
        return m;
    }
    function d3_svg_lineMonotoneTangents(points) {
        var tangents = [], d, a, b, s, m = d3_svg_lineFiniteDifferences(points), i = -1, j = points.length - 1;
        while (++i < j) {
            d = d3_svg_lineSlope(points[i], points[i + 1]);
            if (abs(d) < ) {
                m[i] = m[i + 1] = 0;
            } else {
                a = m[i] / d;
                b = m[i + 1] / d;
                s = a * a + b * b;
                if (s > 9) {
                    s = d * 3 / Math.sqrt(s);
                    m[i] = s * a;
                    m[i + 1] = s * b;
                }
            }
        }
        i = -1;
        while (++i <= j) {
            s = (points[Math.min(j, i + 1)][0] - points[Math.max(0, i - 1)][0]) / (6 * (1 + m[i] * m[i]));
            tangents.push([ s || 0, m[i] * s || 0 ]);
        }
        return tangents;
    }
    function d3_svg_lineMonotone(points) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite(points, d3_svg_lineMonotoneTangents(points));
    }
    d3.svg.line.radial = function() {
        var line = d3_svg_line(d3_svg_lineRadial);
        line.radius = line.x, delete line.x;
        line.angle = line.y, delete line.y;
        return line;
    };
    function d3_svg_lineRadial(points) {
        var point, i = -1, n = points.length, r, a;
        while (++i < n) {
            point = points[i];
            r = point[0];
            a = point[1] - half;
            point[0] = r * Math.cos(a);
            point[1] = r * Math.sin(a);
        }
        return points;
    }
    function d3_svg_area(projection) {
        var x0 = d3_geom_pointX, x1 = d3_geom_pointX, y0 = 0, y1 = d3_geom_pointY, defined = d3_true, interpolate = d3_svg_lineLinear, interpolateKey = interpolate.key, interpolateReverse = interpolate, L = "L", tension = .7;
        function area(data) {
            var segments = [], points0 = [], points1 = [], i = -1, n = data.length, d, fx0 = d3_functor(x0), fy0 = d3_functor(y0), fx1 = x0 === x1 ? function() {
                return x;
            } : d3_functor(x1), fy1 = y0 === y1 ? function() {
                return y;
            } : d3_functor(y1), x, y;
            function segment() {
                segments.push("M", interpolate(projection(points1), tension), L, interpolateReverse(projection(points0.reverse()), tension), "Z");
            }
            while (++i < n) {
                if (defined.call(this, d = data[i], i)) {
                    points0.push([ x = +fx0.call(this, d, i), y = +fy0.call(this, d, i) ]);
                    points1.push([ +fx1.call(this, d, i), +fy1.call(this, d, i) ]);
                } else if (points0.length) {
                    segment();
                    points0 = [];
                    points1 = [];
                }
            }
            if (points0.length) segment();
            return segments.length ? segments.join("") : null;
        }
        area.x = function(_) {
            if (!arguments.length) return x1;
            x0 = x1 = _;
            return area;
        };
        area.x0 = function(_) {
            if (!arguments.length) return x0;
            x0 = _;
            return area;
        };
        area.x1 = function(_) {
            if (!arguments.length) return x1;
            x1 = _;
            return area;
        };
        area.y = function(_) {
            if (!arguments.length) return y1;
            y0 = y1 = _;
            return area;
        };
        area.y0 = function(_) {
            if (!arguments.length) return y0;
            y0 = _;
            return area;
        };
        area.y1 = function(_) {
            if (!arguments.length) return y1;
            y1 = _;
            return area;
        };
        area.defined = function(_) {
            if (!arguments.length) return defined;
            defined = _;
            return area;
        };
        area.interpolate = function(_) {
            if (!arguments.length) return interpolateKey;
            if (typeof _ === "function") interpolateKey = interpolate = _; else interpolateKey = (interpolate = d3_svg_lineInterpolators.get(_) || d3_svg_lineLinear).key;
            interpolateReverse = interpolate.reverse || interpolate;
            L = interpolate.closed ? "M" : "L";
            return area;
        };
        area.tension = function(_) {
            if (!arguments.length) return tension;
            tension = _;
            return area;
        };
        return area;
    }
    d3_svg_lineStepBefore.reverse = d3_svg_lineStepAfter;
    d3_svg_lineStepAfter.reverse = d3_svg_lineStepBefore;
    d3.svg.area = function() {
        return d3_svg_area(d3_identity);
    };
    d3.svg.area.radial = function() {
        var area = d3_svg_area(d3_svg_lineRadial);
        area.radius = area.x, delete area.x;
        area.innerRadius = area.x0, delete area.x0;
        area.outerRadius = area.x1, delete area.x1;
        area.angle = area.y, delete area.y;
        area.startAngle = area.y0, delete area.y0;
        area.endAngle = area.y1, delete area.y1;
        return area;
    };
    d3.svg.chord = function() {
        var source = d3_source, target = d3_target, radius = d3_svg_chordRadius, startAngle = d3_svg_arcStartAngle, endAngle = d3_svg_arcEndAngle;
        function chord(d, i) {
            var s = subgroup(this, source, d, i), t = subgroup(this, target, d, i);
            return "M" + s.p0 + arc(s.r, s.p1, s.a1 - s.a0) + (equals(s, t) ? curve(s.r, s.p1, s.r, s.p0) : curve(s.r, s.p1, t.r, t.p0) + arc(t.r, t.p1, t.a1 - t.a0) + curve(t.r, t.p1, s.r, s.p0)) + "Z";
        }
        function subgroup(self, f, d, i) {
            var subgroup = f.call(self, d, i), r = radius.call(self, subgroup, i), a0 = startAngle.call(self, subgroup, i) - half, a1 = endAngle.call(self, subgroup, i) - half;
            return {
                r: r,
                a0: a0,
                a1: a1,
                p0: [ r * Math.cos(a0), r * Math.sin(a0) ],
                p1: [ r * Math.cos(a1), r * Math.sin(a1) ]
            };
        }
        function equals(a, b) {
            return a.a0 == b.a0 && a.a1 == b.a1;
        }
        function arc(r, p, a) {
            return "A" + r + "," + r + " 0 " + +(a > ) + ",1 " + p;
        }
        function curve(r0, p0, r1, p1) {
            return "Q 0,0 " + p1;
        }
        chord.radius = function(v) {
            if (!arguments.length) return radius;
            radius = d3_functor(v);
            return chord;
        };
        chord.source = function(v) {
            if (!arguments.length) return source;
            source = d3_functor(v);
            return chord;
        };
        chord.target = function(v) {
            if (!arguments.length) return target;
            target = d3_functor(v);
            return chord;
        };
        chord.startAngle = function(v) {
            if (!arguments.length) return startAngle;
            startAngle = d3_functor(v);
            return chord;
        };
        chord.endAngle = function(v) {
            if (!arguments.length) return endAngle;
            endAngle = d3_functor(v);
            return chord;
        };
        return chord;
    };
    function d3_svg_chordRadius(d) {
        return d.radius;
    }
    d3.svg.diagonal = function() {
        var source = d3_source, target = d3_target, projection = d3_svg_diagonalProjection;
        function diagonal(d, i) {
            var p0 = source.call(this, d, i), p3 = target.call(this, d, i), m = (p0.y + p3.y) / 2, p = [ p0, {
                x: p0.x,
                y: m
            }, {
                x: p3.x,
                y: m
            }, p3 ];
            p = p.map(projection);
            return "M" + p[0] + "C" + p[1] + " " + p[2] + " " + p[3];
        }
        diagonal.source = function(x) {
            if (!arguments.length) return source;
            source = d3_functor(x);
            return diagonal;
        };
        diagonal.target = function(x) {
            if (!arguments.length) return target;
            target = d3_functor(x);
            return diagonal;
        };
        diagonal.projection = function(x) {
            if (!arguments.length) return projection;
            projection = x;
            return diagonal;
        };
        return diagonal;
    };
    function d3_svg_diagonalProjection(d) {
        return [ d.x, d.y ];
    }
    d3.svg.diagonal.radial = function() {
        var diagonal = d3.svg.diagonal(), projection = d3_svg_diagonalProjection, projection_ = diagonal.projection;
        diagonal.projection = function(x) {
            return arguments.length ? projection_(d3_svg_diagonalRadialProjection(projection = x)) : projection;
        };
        return diagonal;
    };
    function d3_svg_diagonalRadialProjection(projection) {
        return function() {
            var d = projection.apply(this, arguments), r = d[0], a = d[1] - half;
            return [ r * Math.cos(a), r * Math.sin(a) ];
        };
    }
    d3.svg.symbol = function() {
        var type = d3_svg_symbolType, size = d3_svg_symbolSize;
        function symbol(d, i) {
            return (d3_svg_symbols.get(type.call(this, d, i)) || d3_svg_symbolCircle)(size.call(this, d, i));
        }
        symbol.type = function(x) {
            if (!arguments.length) return type;
            type = d3_functor(x);
            return symbol;
        };
        symbol.size = function(x) {
            if (!arguments.length) return size;
            size = d3_functor(x);
            return symbol;
        };
        return symbol;
    };
    function d3_svg_symbolSize() {
        return 64;
    }
    function d3_svg_symbolType() {
        return "circle";
    }
    function d3_svg_symbolCircle(size) {
        var r = Math.sqrt(size / );
        return "M0," + r + "A" + r + "," + r + " 0 1,1 0," + -r + "A" + r + "," + r + " 0 1,1 0," + r + "Z";
    }
    var d3_svg_symbols = d3.map({
        circle: d3_svg_symbolCircle,
        cross: function(size) {
            var r = Math.sqrt(size / 5) / 2;
            return "M" + -3 * r + "," + -r + "H" + -r + "V" + -3 * r + "H" + r + "V" + -r + "H" + 3 * r + "V" + r + "H" + r + "V" + 3 * r + "H" + -r + "V" + r + "H" + -3 * r + "Z";
        },
        diamond: function(size) {
            var ry = Math.sqrt(size / (2 * d3_svg_symbolTan30)), rx = ry * d3_svg_symbolTan30;
            return "M0," + -ry + "L" + rx + ",0" + " 0," + ry + " " + -rx + ",0" + "Z";
        },
        square: function(size) {
            var r = Math.sqrt(size) / 2;
            return "M" + -r + "," + -r + "L" + r + "," + -r + " " + r + "," + r + " " + -r + "," + r + "Z";
        },
        "triangle-down": function(size) {
            var rx = Math.sqrt(size / d3_svg_symbolSqrt3), ry = rx * d3_svg_symbolSqrt3 / 2;
            return "M0," + ry + "L" + rx + "," + -ry + " " + -rx + "," + -ry + "Z";
        },
        "triangle-up": function(size) {
            var rx = Math.sqrt(size / d3_svg_symbolSqrt3), ry = rx * d3_svg_symbolSqrt3 / 2;
            return "M0," + -ry + "L" + rx + "," + ry + " " + -rx + "," + ry + "Z";
        }
    });
    d3.svg.symbolTypes = d3_svg_symbols.keys();
    var d3_svg_symbolSqrt3 = Math.sqrt(3), d3_svg_symbolTan30 = Math.tan(30 * d3_radians);
    d3_selectionPrototype.transition = function(name) {
        var id = d3_transitionInheritId || ++d3_transitionId, ns = d3_transitionNamespace(name), subgroups = [], subgroup, node, transition = d3_transitionInherit || {
                time: Date.now(),
                ease: d3_ease_cubicInOut,
                delay: 0,
                duration: 250
            };
        for (var j = -1, m = this.length; ++j < m; ) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = -1, n = group.length; ++i < n; ) {
                if (node = group[i]) d3_transitionNode(node, i, ns, id, transition);
                subgroup.push(node);
            }
        }
        return d3_transition(subgroups, ns, id);
    };
    d3_selectionPrototype.interrupt = function(name) {
        return this.each(name == null ? d3_selection_interrupt : d3_selection_interruptNS(d3_transitionNamespace(name)));
    };
    var d3_selection_interrupt = d3_selection_interruptNS(d3_transitionNamespace());
    function d3_selection_interruptNS(ns) {
        return function() {
            var lock, active;
            if ((lock = this[ns]) && (active = lock[lock.active])) {
                if (--lock.count) delete lock[lock.active]; else delete this[ns];
                lock.active += .5;
                active.event && active.event.interrupt.call(this, this.__data__, active.index);
            }
        };
    }
    function d3_transition(groups, ns, id) {
        d3_subclass(groups, d3_transitionPrototype);
        groups.namespace = ns;
        groups.id = id;
        return groups;
    }
    var d3_transitionPrototype = [], d3_transitionId = 0, d3_transitionInheritId, d3_transitionInherit;
    d3_transitionPrototype.call = d3_selectionPrototype.call;
    d3_transitionPrototype.empty = d3_selectionPrototype.empty;
    d3_transitionPrototype.node = d3_selectionPrototype.node;
    d3_transitionPrototype.size = d3_selectionPrototype.size;
    d3.transition = function(selection, name) {
        return selection && selection.transition ? d3_transitionInheritId ? selection.transition(name) : selection : d3.selection().transition(selection);
    };
    d3.transition.prototype = d3_transitionPrototype;
    d3_transitionPrototype.select = function(selector) {
        var id = this.id, ns = this.namespace, subgroups = [], subgroup, subnode, node;
        selector = d3_selection_selector(selector);
        for (var j = -1, m = this.length; ++j < m; ) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = -1, n = group.length; ++i < n; ) {
                if ((node = group[i]) && (subnode = selector.call(node, node.__data__, i, j))) {
                    if ("__data__" in node) subnode.__data__ = node.__data__;
                    d3_transitionNode(subnode, i, ns, id, node[ns][id]);
                    subgroup.push(subnode);
                } else {
                    subgroup.push(null);
                }
            }
        }
        return d3_transition(subgroups, ns, id);
    };
    d3_transitionPrototype.selectAll = function(selector) {
        var id = this.id, ns = this.namespace, subgroups = [], subgroup, subnodes, node, subnode, transition;
        selector = d3_selection_selectorAll(selector);
        for (var j = -1, m = this.length; ++j < m; ) {
            for (var group = this[j], i = -1, n = group.length; ++i < n; ) {
                if (node = group[i]) {
                    transition = node[ns][id];
                    subnodes = selector.call(node, node.__data__, i, j);
                    subgroups.push(subgroup = []);
                    for (var k = -1, o = subnodes.length; ++k < o; ) {
                        if (subnode = subnodes[k]) d3_transitionNode(subnode, k, ns, id, transition);
                        subgroup.push(subnode);
                    }
                }
            }
        }
        return d3_transition(subgroups, ns, id);
    };
    d3_transitionPrototype.filter = function(filter) {
        var subgroups = [], subgroup, group, node;
        if (typeof filter !== "function") filter = d3_selection_filter(filter);
        for (var j = 0, m = this.length; j < m; j++) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = 0, n = group.length; i < n; i++) {
                if ((node = group[i]) && filter.call(node, node.__data__, i, j)) {
                    subgroup.push(node);
                }
            }
        }
        return d3_transition(subgroups, this.namespace, this.id);
    };
    d3_transitionPrototype.tween = function(name, tween) {
        var id = this.id, ns = this.namespace;
        if (arguments.length < 2) return this.node()[ns][id].tween.get(name);
        return d3_selection_each(this, tween == null ? function(node) {
            node[ns][id].tween.remove(name);
        } : function(node) {
            node[ns][id].tween.set(name, tween);
        });
    };
    function d3_transition_tween(groups, name, value, tween) {
        var id = groups.id, ns = groups.namespace;
        return d3_selection_each(groups, typeof value === "function" ? function(node, i, j) {
            node[ns][id].tween.set(name, tween(value.call(node, node.__data__, i, j)));
        } : (value = tween(value), function(node) {
            node[ns][id].tween.set(name, value);
        }));
    }
    d3_transitionPrototype.attr = function(nameNS, value) {
        if (arguments.length < 2) {
            for (value in nameNS) this.attr(value, nameNS[value]);
            return this;
        }
        var interpolate = nameNS == "transform" ? d3_interpolateTransform : d3_interpolate, name = d3.ns.qualify(nameNS);
        function attrNull() {
            this.removeAttribute(name);
        }
        function attrNullNS() {
            this.removeAttributeNS(name.space, name.local);
        }
        function attrTween(b) {
            return b == null ? attrNull : (b += "", function() {
                var a = this.getAttribute(name), i;
                return a !== b && (i = interpolate(a, b), function(t) {
                        this.setAttribute(name, i(t));
                    });
            });
        }
        function attrTweenNS(b) {
            return b == null ? attrNullNS : (b += "", function() {
                var a = this.getAttributeNS(name.space, name.local), i;
                return a !== b && (i = interpolate(a, b), function(t) {
                        this.setAttributeNS(name.space, name.local, i(t));
                    });
            });
        }
        return d3_transition_tween(this, "attr." + nameNS, value, name.local ? attrTweenNS : attrTween);
    };
    d3_transitionPrototype.attrTween = function(nameNS, tween) {
        var name = d3.ns.qualify(nameNS);
        function attrTween(d, i) {
            var f = tween.call(this, d, i, this.getAttribute(name));
            return f && function(t) {
                    this.setAttribute(name, f(t));
                };
        }
        function attrTweenNS(d, i) {
            var f = tween.call(this, d, i, this.getAttributeNS(name.space, name.local));
            return f && function(t) {
                    this.setAttributeNS(name.space, name.local, f(t));
                };
        }
        return this.tween("attr." + nameNS, name.local ? attrTweenNS : attrTween);
    };
    d3_transitionPrototype.style = function(name, value, priority) {
        var n = arguments.length;
        if (n < 3) {
            if (typeof name !== "string") {
                if (n < 2) value = "";
                for (priority in name) this.style(priority, name[priority], value);
                return this;
            }
            priority = "";
        }
        function styleNull() {
            this.style.removeProperty(name);
        }
        function styleString(b) {
            return b == null ? styleNull : (b += "", function() {
                var a = d3_window(this).getComputedStyle(this, null).getPropertyValue(name), i;
                return a !== b && (i = d3_interpolate(a, b), function(t) {
                        this.style.setProperty(name, i(t), priority);
                    });
            });
        }
        return d3_transition_tween(this, "style." + name, value, styleString);
    };
    d3_transitionPrototype.styleTween = function(name, tween, priority) {
        if (arguments.length < 3) priority = "";
        function styleTween(d, i) {
            var f = tween.call(this, d, i, d3_window(this).getComputedStyle(this, null).getPropertyValue(name));
            return f && function(t) {
                    this.style.setProperty(name, f(t), priority);
                };
        }
        return this.tween("style." + name, styleTween);
    };
    d3_transitionPrototype.text = function(value) {
        return d3_transition_tween(this, "text", value, d3_transition_text);
    };
    function d3_transition_text(b) {
        if (b == null) b = "";
        return function() {
            this.textContent = b;
        };
    }
    d3_transitionPrototype.remove = function() {
        var ns = this.namespace;
        return this.each("end.transition", function() {
            var p;
            if (this[ns].count < 2 && (p = this.parentNode)) p.removeChild(this);
        });
    };
    d3_transitionPrototype.ease = function(value) {
        var id = this.id, ns = this.namespace;
        if (arguments.length < 1) return this.node()[ns][id].ease;
        if (typeof value !== "function") value = d3.ease.apply(d3, arguments);
        return d3_selection_each(this, function(node) {
            node[ns][id].ease = value;
        });
    };
    d3_transitionPrototype.delay = function(value) {
        var id = this.id, ns = this.namespace;
        if (arguments.length < 1) return this.node()[ns][id].delay;
        return d3_selection_each(this, typeof value === "function" ? function(node, i, j) {
            node[ns][id].delay = +value.call(node, node.__data__, i, j);
        } : (value = +value, function(node) {
            node[ns][id].delay = value;
        }));
    };
    d3_transitionPrototype.duration = function(value) {
        var id = this.id, ns = this.namespace;
        if (arguments.length < 1) return this.node()[ns][id].duration;
        return d3_selection_each(this, typeof value === "function" ? function(node, i, j) {
            node[ns][id].duration = Math.max(1, value.call(node, node.__data__, i, j));
        } : (value = Math.max(1, value), function(node) {
            node[ns][id].duration = value;
        }));
    };
    d3_transitionPrototype.each = function(type, listener) {
        var id = this.id, ns = this.namespace;
        if (arguments.length < 2) {
            var inherit = d3_transitionInherit, inheritId = d3_transitionInheritId;
            try {
                d3_transitionInheritId = id;
                d3_selection_each(this, function(node, i, j) {
                    d3_transitionInherit = node[ns][id];
                    type.call(node, node.__data__, i, j);
                });
            } finally {
                d3_transitionInherit = inherit;
                d3_transitionInheritId = inheritId;
            }
        } else {
            d3_selection_each(this, function(node) {
                var transition = node[ns][id];
                (transition.event || (transition.event = d3.dispatch("start", "end", "interrupt"))).on(type, listener);
            });
        }
        return this;
    };
    d3_transitionPrototype.transition = function() {
        var id0 = this.id, id1 = ++d3_transitionId, ns = this.namespace, subgroups = [], subgroup, group, node, transition;
        for (var j = 0, m = this.length; j < m; j++) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = 0, n = group.length; i < n; i++) {
                if (node = group[i]) {
                    transition = node[ns][id0];
                    d3_transitionNode(node, i, ns, id1, {
                        time: transition.time,
                        ease: transition.ease,
                        delay: transition.delay + transition.duration,
                        duration: transition.duration
                    });
                }
                subgroup.push(node);
            }
        }
        return d3_transition(subgroups, ns, id1);
    };
    function d3_transitionNamespace(name) {
        return name == null ? "__transition__" : "__transition_" + name + "__";
    }
    function d3_transitionNode(node, i, ns, id, inherit) {
        var lock = node[ns] || (node[ns] = {
                active: 0,
                count: 0
            }), transition = lock[id];
        if (!transition) {
            var time = inherit.time;
            transition = lock[id] = {
                tween: new d3_Map(),
                time: time,
                delay: inherit.delay,
                duration: inherit.duration,
                ease: inherit.ease,
                index: i
            };
            inherit = null;
            ++lock.count;
            d3.timer(function(elapsed) {
                var delay = transition.delay, duration, ease, timer = d3_timer_active, tweened = [];
                timer.t = delay + time;
                if (delay <= elapsed) return start(elapsed - delay);
                timer.c = start;
                function start(elapsed) {
                    if (lock.active > id) return stop();
                    var active = lock[lock.active];
                    if (active) {
                        --lock.count;
                        delete lock[lock.active];
                        active.event && active.event.interrupt.call(node, node.__data__, active.index);
                    }
                    lock.active = id;
                    transition.event && transition.event.start.call(node, node.__data__, i);
                    transition.tween.forEach(function(key, value) {
                        if (value = value.call(node, node.__data__, i)) {
                            tweened.push(value);
                        }
                    });
                    ease = transition.ease;
                    duration = transition.duration;
                    d3.timer(function() {
                        timer.c = tick(elapsed || 1) ? d3_true : tick;
                        return 1;
                    }, 0, time);
                }
                function tick(elapsed) {
                    if (lock.active !== id) return 1;
                    var t = elapsed / duration, e = ease(t), n = tweened.length;
                    while (n > 0) {
                        tweened[--n].call(node, e);
                    }
                    if (t >= 1) {
                        transition.event && transition.event.end.call(node, node.__data__, i);
                        return stop();
                    }
                }
                function stop() {
                    if (--lock.count) delete lock[id]; else delete node[ns];
                    return 1;
                }
            }, 0, time);
        }
    }
    d3.svg.axis = function() {
        var scale = d3.scale.linear(), orient = d3_svg_axisDefaultOrient, innerTickSize = 6, outerTickSize = 6, tickPadding = 3, tickArguments_ = [ 10 ], tickValues = null, tickFormat_;
        function axis(g) {
            g.each(function() {
                var g = d3.select(this);
                var scale0 = this.__chart__ || scale, scale1 = this.__chart__ = scale.copy();
                var ticks = tickValues == null ? scale1.ticks ? scale1.ticks.apply(scale1, tickArguments_) : scale1.domain() : tickValues, tickFormat = tickFormat_ == null ? scale1.tickFormat ? scale1.tickFormat.apply(scale1, tickArguments_) : d3_identity : tickFormat_, tick = g.selectAll(".tick").data(ticks, scale1), tickEnter = tick.enter().insert("g", ".domain").attr("class", "tick").style("opacity", ), tickExit = d3.transition(tick.exit()).style("opacity", ).remove(), tickUpdate = d3.transition(tick.order()).style("opacity", 1), tickSpacing = Math.max(innerTickSize, 0) + tickPadding, tickTransform;
                var range = d3_scaleRange(scale1), path = g.selectAll(".domain").data([ 0 ]), pathUpdate = (path.enter().append("path").attr("class", "domain"),
                    d3.transition(path));
                tickEnter.append("line");
                tickEnter.append("text");
                var lineEnter = tickEnter.select("line"), lineUpdate = tickUpdate.select("line"), text = tick.select("text").text(tickFormat), textEnter = tickEnter.select("text"), textUpdate = tickUpdate.select("text"), sign = orient === "top" || orient === "left" ? -1 : 1, x1, x2, y1, y2;
                if (orient === "bottom" || orient === "top") {
                    tickTransform = d3_svg_axisX, x1 = "x", y1 = "y", x2 = "x2", y2 = "y2";
                    text.attr("dy", sign < 0 ? "0em" : ".71em").style("text-anchor", "middle");
                    pathUpdate.attr("d", "M" + range[0] + "," + sign * outerTickSize + "V0H" + range[1] + "V" + sign * outerTickSize);
                } else {
                    tickTransform = d3_svg_axisY, x1 = "y", y1 = "x", x2 = "y2", y2 = "x2";
                    text.attr("dy", ".32em").style("text-anchor", sign < 0 ? "end" : "start");
                    pathUpdate.attr("d", "M" + sign * outerTickSize + "," + range[0] + "H0V" + range[1] + "H" + sign * outerTickSize);
                }
                lineEnter.attr(y2, sign * innerTickSize);
                textEnter.attr(y1, sign * tickSpacing);
                lineUpdate.attr(x2, 0).attr(y2, sign * innerTickSize);
                textUpdate.attr(x1, 0).attr(y1, sign * tickSpacing);
                if (scale1.rangeBand) {
                    var x = scale1, dx = x.rangeBand() / 2;
                    scale0 = scale1 = function(d) {
                        return x(d) + dx;
                    };
                } else if (scale0.rangeBand) {
                    scale0 = scale1;
                } else {
                    tickExit.call(tickTransform, scale1, scale0);
                }
                tickEnter.call(tickTransform, scale0, scale1);
                tickUpdate.call(tickTransform, scale1, scale1);
            });
        }
        axis.scale = function(x) {
            if (!arguments.length) return scale;
            scale = x;
            return axis;
        };
        axis.orient = function(x) {
            if (!arguments.length) return orient;
            orient = x in d3_svg_axisOrients ? x + "" : d3_svg_axisDefaultOrient;
            return axis;
        };
        axis.ticks = function() {
            if (!arguments.length) return tickArguments_;
            tickArguments_ = arguments;
            return axis;
        };
        axis.tickValues = function(x) {
            if (!arguments.length) return tickValues;
            tickValues = x;
            return axis;
        };
        axis.tickFormat = function(x) {
            if (!arguments.length) return tickFormat_;
            tickFormat_ = x;
            return axis;
        };
        axis.tickSize = function(x) {
            var n = arguments.length;
            if (!n) return innerTickSize;
            innerTickSize = +x;
            outerTickSize = +arguments[n - 1];
            return axis;
        };
        axis.innerTickSize = function(x) {
            if (!arguments.length) return innerTickSize;
            innerTickSize = +x;
            return axis;
        };
        axis.outerTickSize = function(x) {
            if (!arguments.length) return outerTickSize;
            outerTickSize = +x;
            return axis;
        };
        axis.tickPadding = function(x) {
            if (!arguments.length) return tickPadding;
            tickPadding = +x;
            return axis;
        };
        axis.tickSubdivide = function() {
            return arguments.length && axis;
        };
        return axis;
    };
    var d3_svg_axisDefaultOrient = "bottom", d3_svg_axisOrients = {
        top: 1,
        right: 1,
        bottom: 1,
        left: 1
    };
    function d3_svg_axisX(selection, x0, x1) {
        selection.attr("transform", function(d) {
            var v0 = x0(d);
            return "translate(" + (isFinite(v0) ? v0 : x1(d)) + ",0)";
        });
    }
    function d3_svg_axisY(selection, y0, y1) {
        selection.attr("transform", function(d) {
            var v0 = y0(d);
            return "translate(0," + (isFinite(v0) ? v0 : y1(d)) + ")";
        });
    }
    d3.svg.brush = function() {
        var event = d3_eventDispatch(brush, "brushstart", "brush", "brushend"), x = null, y = null, xExtent = [ 0, 0 ], yExtent = [ 0, 0 ], xExtentDomain, yExtentDomain, xClamp = true, yClamp = true, resizes = d3_svg_brushResizes[0];
        function brush(g) {
            g.each(function() {
                var g = d3.select(this).style("pointer-events", "all").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)").on("mousedown.brush", brushstart).on("touchstart.brush", brushstart);
                var background = g.selectAll(".background").data([ 0 ]);
                background.enter().append("rect").attr("class", "background").style("visibility", "hidden").style("cursor", "crosshair");
                g.selectAll(".extent").data([ 0 ]).enter().append("rect").attr("class", "extent").style("cursor", "move");
                var resize = g.selectAll(".resize").data(resizes, d3_identity);
                resize.exit().remove();
                resize.enter().append("g").attr("class", function(d) {
                    return "resize " + d;
                }).style("cursor", function(d) {
                    return d3_svg_brushCursor[d];
                }).append("rect").attr("x", function(d) {
                    return /[ew]$/.test(d) ? -3 : null;
                }).attr("y", function(d) {
                    return /^[ns]/.test(d) ? -3 : null;
                }).attr("width", 6).attr("height", 6).style("visibility", "hidden");
                resize.style("display", brush.empty() ? "none" : null);
                var gUpdate = d3.transition(g), backgroundUpdate = d3.transition(background), range;
                if (x) {
                    range = d3_scaleRange(x);
                    backgroundUpdate.attr("x", range[0]).attr("width", range[1] - range[0]);
                    redrawX(gUpdate);
                }
                if (y) {
                    range = d3_scaleRange(y);
                    backgroundUpdate.attr("y", range[0]).attr("height", range[1] - range[0]);
                    redrawY(gUpdate);
                }
                redraw(gUpdate);
            });
        }
        brush.event = function(g) {
            g.each(function() {
                var event_ = event.of(this, arguments), extent1 = {
                    x: xExtent,
                    y: yExtent,
                    i: xExtentDomain,
                    j: yExtentDomain
                }, extent0 = this.__chart__ || extent1;
                this.__chart__ = extent1;
                if (d3_transitionInheritId) {
                    d3.select(this).transition().each("start.brush", function() {
                        xExtentDomain = extent0.i;
                        yExtentDomain = extent0.j;
                        xExtent = extent0.x;
                        yExtent = extent0.y;
                        event_({
                            type: "brushstart"
                        });
                    }).tween("brush:brush", function() {
                        var xi = d3_interpolateArray(xExtent, extent1.x), yi = d3_interpolateArray(yExtent, extent1.y);
                        xExtentDomain = yExtentDomain = null;
                        return function(t) {
                            xExtent = extent1.x = xi(t);
                            yExtent = extent1.y = yi(t);
                            event_({
                                type: "brush",
                                mode: "resize"
                            });
                        };
                    }).each("end.brush", function() {
                        xExtentDomain = extent1.i;
                        yExtentDomain = extent1.j;
                        event_({
                            type: "brush",
                            mode: "resize"
                        });
                        event_({
                            type: "brushend"
                        });
                    });
                } else {
                    event_({
                        type: "brushstart"
                    });
                    event_({
                        type: "brush",
                        mode: "resize"
                    });
                    event_({
                        type: "brushend"
                    });
                }
            });
        };
        function redraw(g) {
            g.selectAll(".resize").attr("transform", function(d) {
                return "translate(" + xExtent[+/e$/.test(d)] + "," + yExtent[+/^s/.test(d)] + ")";
            });
        }
        function redrawX(g) {
            g.select(".extent").attr("x", xExtent[0]);
            g.selectAll(".extent,.n>rect,.s>rect").attr("width", xExtent[1] - xExtent[0]);
        }
        function redrawY(g) {
            g.select(".extent").attr("y", yExtent[0]);
            g.selectAll(".extent,.e>rect,.w>rect").attr("height", yExtent[1] - yExtent[0]);
        }
        function brushstart() {
            var target = this, eventTarget = d3.select(d3.event.target), event_ = event.of(target, arguments), g = d3.select(target), resizing = eventTarget.datum(), resizingX = !/^(n|s)$/.test(resizing) && x, resizingY = !/^(e|w)$/.test(resizing) && y, dragging = eventTarget.classed("extent"), dragRestore = d3_event_dragSuppress(target), center, origin = d3.mouse(target), offset;
            var w = d3.select(d3_window(target)).on("keydown.brush", keydown).on("keyup.brush", keyup);
            if (d3.event.changedTouches) {
                w.on("touchmove.brush", brushmove).on("touchend.brush", brushend);
            } else {
                w.on("mousemove.brush", brushmove).on("mouseup.brush", brushend);
            }
            g.interrupt().selectAll("*").interrupt();
            if (dragging) {
                origin[0] = xExtent[0] - origin[0];
                origin[1] = yExtent[0] - origin[1];
            } else if (resizing) {
                var ex = +/w$/.test(resizing), ey = +/^n/.test(resizing);
                offset = [ xExtent[1 - ex] - origin[0], yExtent[1 - ey] - origin[1] ];
                origin[0] = xExtent[ex];
                origin[1] = yExtent[ey];
            } else if (d3.event.altKey) center = origin.slice();
            g.style("pointer-events", "none").selectAll(".resize").style("display", null);
            d3.select("body").style("cursor", eventTarget.style("cursor"));
            event_({
                type: "brushstart"
            });
            brushmove();
            function keydown() {
                if (d3.event.keyCode == 32) {
                    if (!dragging) {
                        center = null;
                        origin[0] -= xExtent[1];
                        origin[1] -= yExtent[1];
                        dragging = 2;
                    }
                    d3_eventPreventDefault();
                }
            }
            function keyup() {
                if (d3.event.keyCode == 32 && dragging == 2) {
                    origin[0] += xExtent[1];
                    origin[1] += yExtent[1];
                    dragging = 0;
                    d3_eventPreventDefault();
                }
            }
            function brushmove() {
                var point = d3.mouse(target), moved = false;
                if (offset) {
                    point[0] += offset[0];
                    point[1] += offset[1];
                }
                if (!dragging) {
                    if (d3.event.altKey) {
                        if (!center) center = [ (xExtent[0] + xExtent[1]) / 2, (yExtent[0] + yExtent[1]) / 2 ];
                        origin[0] = xExtent[+(point[0] < center[0])];
                        origin[1] = yExtent[+(point[1] < center[1])];
                    } else center = null;
                }
                if (resizingX && move1(point, x, 0)) {
                    redrawX(g);
                    moved = true;
                }
                if (resizingY && move1(point, y, 1)) {
                    redrawY(g);
                    moved = true;
                }
                if (moved) {
                    redraw(g);
                    event_({
                        type: "brush",
                        mode: dragging ? "move" : "resize"
                    });
                }
            }
            function move1(point, scale, i) {
                var range = d3_scaleRange(scale), r0 = range[0], r1 = range[1], position = origin[i], extent = i ? yExtent : xExtent, size = extent[1] - extent[0], min, max;
                if (dragging) {
                    r0 -= position;
                    r1 -= size + position;
                }
                min = (i ? yClamp : xClamp) ? Math.max(r0, Math.min(r1, point[i])) : point[i];
                if (dragging) {
                    max = (min += position) + size;
                } else {
                    if (center) position = Math.max(r0, Math.min(r1, 2 * center[i] - min));
                    if (position < min) {
                        max = min;
                        min = position;
                    } else {
                        max = position;
                    }
                }
                if (extent[0] != min || extent[1] != max) {
                    if (i) yExtentDomain = null; else xExtentDomain = null;
                    extent[0] = min;
                    extent[1] = max;
                    return true;
                }
            }
            function brushend() {
                brushmove();
                g.style("pointer-events", "all").selectAll(".resize").style("display", brush.empty() ? "none" : null);
                d3.select("body").style("cursor", null);
                w.on("mousemove.brush", null).on("mouseup.brush", null).on("touchmove.brush", null).on("touchend.brush", null).on("keydown.brush", null).on("keyup.brush", null);
                dragRestore();
                event_({
                    type: "brushend"
                });
            }
        }
        brush.x = function(z) {
            if (!arguments.length) return x;
            x = z;
            resizes = d3_svg_brushResizes[!x << 1 | !y];
            return brush;
        };
        brush.y = function(z) {
            if (!arguments.length) return y;
            y = z;
            resizes = d3_svg_brushResizes[!x << 1 | !y];
            return brush;
        };
        brush.clamp = function(z) {
            if (!arguments.length) return x && y ? [ xClamp, yClamp ] : x ? xClamp : y ? yClamp : null;
            if (x && y) xClamp = !!z[0], yClamp = !!z[1]; else if (x) xClamp = !!z; else if (y) yClamp = !!z;
            return brush;
        };
        brush.extent = function(z) {
            var x0, x1, y0, y1, t;
            if (!arguments.length) {
                if (x) {
                    if (xExtentDomain) {
                        x0 = xExtentDomain[0], x1 = xExtentDomain[1];
                    } else {
                        x0 = xExtent[0], x1 = xExtent[1];
                        if (x.invert) x0 = x.invert(x0), x1 = x.invert(x1);
                        if (x1 < x0) t = x0, x0 = x1, x1 = t;
                    }
                }
                if (y) {
                    if (yExtentDomain) {
                        y0 = yExtentDomain[0], y1 = yExtentDomain[1];
                    } else {
                        y0 = yExtent[0], y1 = yExtent[1];
                        if (y.invert) y0 = y.invert(y0), y1 = y.invert(y1);
                        if (y1 < y0) t = y0, y0 = y1, y1 = t;
                    }
                }
                return x && y ? [ [ x0, y0 ], [ x1, y1 ] ] : x ? [ x0, x1 ] : y && [ y0, y1 ];
            }
            if (x) {
                x0 = z[0], x1 = z[1];
                if (y) x0 = x0[0], x1 = x1[0];
                xExtentDomain = [ x0, x1 ];
                if (x.invert) x0 = x(x0), x1 = x(x1);
                if (x1 < x0) t = x0, x0 = x1, x1 = t;
                if (x0 != xExtent[0] || x1 != xExtent[1]) xExtent = [ x0, x1 ];
            }
            if (y) {
                y0 = z[0], y1 = z[1];
                if (x) y0 = y0[1], y1 = y1[1];
                yExtentDomain = [ y0, y1 ];
                if (y.invert) y0 = y(y0), y1 = y(y1);
                if (y1 < y0) t = y0, y0 = y1, y1 = t;
                if (y0 != yExtent[0] || y1 != yExtent[1]) yExtent = [ y0, y1 ];
            }
            return brush;
        };
        brush.clear = function() {
            if (!brush.empty()) {
                xExtent = [ 0, 0 ], yExtent = [ 0, 0 ];
                xExtentDomain = yExtentDomain = null;
            }
            return brush;
        };
        brush.empty = function() {
            return !!x && xExtent[0] == xExtent[1] || !!y && yExtent[0] == yExtent[1];
        };
        return d3.rebind(brush, event, "on");
    };
    var d3_svg_brushCursor = {
        n: "ns-resize",
        e: "ew-resize",
        s: "ns-resize",
        w: "ew-resize",
        nw: "nwse-resize",
        ne: "nesw-resize",
        se: "nwse-resize",
        sw: "nesw-resize"
    };
    var d3_svg_brushResizes = [ [ "n", "e", "s", "w", "nw", "ne", "se", "sw" ], [ "e", "w" ], [ "n", "s" ], [] ];
    var d3_time_format = d3_time.format = d3_locale_enUS.timeFormat;
    var d3_time_formatUtc = d3_time_format.utc;
    var d3_time_formatIso = d3_time_formatUtc("%Y-%m-%dT%H:%M:%S.%LZ");
    d3_time_format.iso = Date.prototype.toISOString && +new Date("2000-01-01T00:00:00.000Z") ? d3_time_formatIsoNative : d3_time_formatIso;
    function d3_time_formatIsoNative(date) {
        return date.toISOString();
    }
    d3_time_formatIsoNative.parse = function(string) {
        var date = new Date(string);
        return isNaN(date) ? null : date;
    };
    d3_time_formatIsoNative.toString = d3_time_formatIso.toString;
    d3_time.second = d3_time_interval(function(date) {
        return new d3_date(Math.floor(date / 1e3) * 1e3);
    }, function(date, offset) {
        date.setTime(date.getTime() + Math.floor(offset) * 1e3);
    }, function(date) {
        return date.getSeconds();
    });
    d3_time.seconds = d3_time.second.range;
    d3_time.seconds.utc = d3_time.second.utc.range;
    d3_time.minute = d3_time_interval(function(date) {
        return new d3_date(Math.floor(date / 6e4) * 6e4);
    }, function(date, offset) {
        date.setTime(date.getTime() + Math.floor(offset) * 6e4);
    }, function(date) {
        return date.getMinutes();
    });
    d3_time.minutes = d3_time.minute.range;
    d3_time.minutes.utc = d3_time.minute.utc.range;
    d3_time.hour = d3_time_interval(function(date) {
        var timezone = date.getTimezoneOffset() / 60;
        return new d3_date((Math.floor(date / 36e5 - timezone) + timezone) * 36e5);
    }, function(date, offset) {
        date.setTime(date.getTime() + Math.floor(offset) * 36e5);
    }, function(date) {
        return date.getHours();
    });
    d3_time.hours = d3_time.hour.range;
    d3_time.hours.utc = d3_time.hour.utc.range;
    d3_time.month = d3_time_interval(function(date) {
        date = d3_time.day(date);
        date.setDate(1);
        return date;
    }, function(date, offset) {
        date.setMonth(date.getMonth() + offset);
    }, function(date) {
        return date.getMonth();
    });
    d3_time.months = d3_time.month.range;
    d3_time.months.utc = d3_time.month.utc.range;
    function d3_time_scale(linear, methods, format) {
        function scale(x) {
            return linear(x);
        }
        scale.invert = function(x) {
            return d3_time_scaleDate(linear.invert(x));
        };
        scale.domain = function(x) {
            if (!arguments.length) return linear.domain().map(d3_time_scaleDate);
            linear.domain(x);
            return scale;
        };
        function tickMethod(extent, count) {
            var span = extent[1] - extent[0], target = span / count, i = d3.bisect(d3_time_scaleSteps, target);
            return i == d3_time_scaleSteps.length ? [ methods.year, d3_scale_linearTickRange(extent.map(function(d) {
                return d / 31536e6;
            }), count)[2] ] : !i ? [ d3_time_scaleMilliseconds, d3_scale_linearTickRange(extent, count)[2] ] : methods[target / d3_time_scaleSteps[i - 1] < d3_time_scaleSteps[i] / target ? i - 1 : i];
        }
        scale.nice = function(interval, skip) {
            var domain = scale.domain(), extent = d3_scaleExtent(domain), method = interval == null ? tickMethod(extent, 10) : typeof interval === "number" && tickMethod(extent, interval);
            if (method) interval = method[0], skip = method[1];
            function skipped(date) {
                return !isNaN(date) && !interval.range(date, d3_time_scaleDate(+date + 1), skip).length;
            }
            return scale.domain(d3_scale_nice(domain, skip > 1 ? {
                floor: function(date) {
                    while (skipped(date = interval.floor(date))) date = d3_time_scaleDate(date - 1);
                    return date;
                },
                ceil: function(date) {
                    while (skipped(date = interval.ceil(date))) date = d3_time_scaleDate(+date + 1);
                    return date;
                }
            } : interval));
        };
        scale.ticks = function(interval, skip) {
            var extent = d3_scaleExtent(scale.domain()), method = interval == null ? tickMethod(extent, 10) : typeof interval === "number" ? tickMethod(extent, interval) : !interval.range && [ {
                range: interval
            }, skip ];
            if (method) interval = method[0], skip = method[1];
            return interval.range(extent[0], d3_time_scaleDate(+extent[1] + 1), skip < 1 ? 1 : skip);
        };
        scale.tickFormat = function() {
            return format;
        };
        scale.copy = function() {
            return d3_time_scale(linear.copy(), methods, format);
        };
        return d3_scale_linearRebind(scale, linear);
    }
    function d3_time_scaleDate(t) {
        return new Date(t);
    }
    var d3_time_scaleSteps = [ 1e3, 5e3, 15e3, 3e4, 6e4, 3e5, 9e5, 18e5, 36e5, 108e5, 216e5, 432e5, 864e5, 1728e5, 6048e5, 2592e6, 7776e6, 31536e6 ];
    var d3_time_scaleLocalMethods = [ [ d3_time.second, 1 ], [ d3_time.second, 5 ], [ d3_time.second, 15 ], [ d3_time.second, 30 ], [ d3_time.minute, 1 ], [ d3_time.minute, 5 ], [ d3_time.minute, 15 ], [ d3_time.minute, 30 ], [ d3_time.hour, 1 ], [ d3_time.hour, 3 ], [ d3_time.hour, 6 ], [ d3_time.hour, 12 ], [ d3_time.day, 1 ], [ d3_time.day, 2 ], [ d3_time.week, 1 ], [ d3_time.month, 1 ], [ d3_time.month, 3 ], [ d3_time.year, 1 ] ];
    var d3_time_scaleLocalFormat = d3_time_format.multi([ [ ".%L", function(d) {
        return d.getMilliseconds();
    } ], [ ":%S", function(d) {
        return d.getSeconds();
    } ], [ "%I:%M", function(d) {
        return d.getMinutes();
    } ], [ "%I %p", function(d) {
        return d.getHours();
    } ], [ "%a %d", function(d) {
        return d.getDay() && d.getDate() != 1;
    } ], [ "%b %d", function(d) {
        return d.getDate() != 1;
    } ], [ "%B", function(d) {
        return d.getMonth();
    } ], [ "%Y", d3_true ] ]);
    var d3_time_scaleMilliseconds = {
        range: function(start, stop, step) {
            return d3.range(Math.ceil(start / step) * step, +stop, step).map(d3_time_scaleDate);
        },
        floor: d3_identity,
        ceil: d3_identity
    };
    d3_time_scaleLocalMethods.year = d3_time.year;
    d3_time.scale = function() {
        return d3_time_scale(d3.scale.linear(), d3_time_scaleLocalMethods, d3_time_scaleLocalFormat);
    };
    var d3_time_scaleUtcMethods = d3_time_scaleLocalMethods.map(function(m) {
        return [ m[0].utc, m[1] ];
    });
    var d3_time_scaleUtcFormat = d3_time_formatUtc.multi([ [ ".%L", function(d) {
        return d.getUTCMilliseconds();
    } ], [ ":%S", function(d) {
        return d.getUTCSeconds();
    } ], [ "%I:%M", function(d) {
        return d.getUTCMinutes();
    } ], [ "%I %p", function(d) {
        return d.getUTCHours();
    } ], [ "%a %d", function(d) {
        return d.getUTCDay() && d.getUTCDate() != 1;
    } ], [ "%b %d", function(d) {
        return d.getUTCDate() != 1;
    } ], [ "%B", function(d) {
        return d.getUTCMonth();
    } ], [ "%Y", d3_true ] ]);
    d3_time_scaleUtcMethods.year = d3_time.year.utc;
    d3_time.scale.utc = function() {
        return d3_time_scale(d3.scale.linear(), d3_time_scaleUtcMethods, d3_time_scaleUtcFormat);
    };
    d3.text = d3_xhrType(function(request) {
        return request.responseText;
    });
    d3.json = function(url, callback) {
        return d3_xhr(url, "application/json", d3_json, callback);
    };
    function d3_json(request) {
        return JSON.parse(request.responseText);
    }
    d3.html = function(url, callback) {
        return d3_xhr(url, "text/html", d3_html, callback);
    };
    function d3_html(request) {
        var range = d3_document.createRange();
        range.selectNode(d3_document.body);
        return range.createContextualFragment(request.responseText);
    }
    d3.xml = d3_xhrType(function(request) {
        return request.responseXML;
    });

    var cloudRadians = Math.PI / 180,
        cw = 1 << 11 >> 5,
        ch = 1 << 11;

    d3.layout.cloud = function() {

        var size = [256, 256],
            text = cloudText,
            font = cloudFont,
            fontSize = cloudFontSize,
            fontStyle = cloudFontNormal,
            fontWeight = cloudFontNormal,
            rotate = cloudRotate,
            padding = cloudPadding,
            spiral = archimedeanSpiral,
            path = null,
            simpleLayout = false,
            textDimFun = null,
            words = [],
            timeInterval = Infinity,
            event = d3.dispatch("word", "end"),
            timer = null,
            random = Math.random,
            cloud = {},
            canvas = cloudCanvas;

        cloud.canvas = function(_) {
            return arguments.length ? (canvas = functor(_), cloud) : canvas;
        };

        cloud.start = function() {
            var contextAndRatio = getContext(canvas()),
                board = imageShape() ? imageDataArray(contextAndRatio, stepInterval)
                    : (simpleLayout ? [] :zeroArray((size[0] >> 5) * size[1])),
                bounds = null,
                n = words.length,
                i = -1,
                tags = [],
                data = words.map(function(d, i) {
                    d.text = text.call(this, d, i);
                    d.font = font.call(this, d, i);
                    d.style = fontStyle.call(this, d, i);
                    d.weight = fontWeight.call(this, d, i);
                    d.rotate = rotate.call(this, d, i);
                    d.size = ~~fontSize.call(this, d, i);
                    d.padding = padding.call(this, d, i);
                    return d;
                }).sort(function(a, b) { return b.size - a.size; });

            if(!imageShape()) {
                stepInterval();
            }

            function stepInterval(temp){
                if(simpleLayout){
                    simpleStep(temp)
                } else {

                    if (timer) {
                        clearInterval(timer);
                    }
                    timer = setInterval(step, 0);
                    step(temp);
                }
            }


            return cloud;

            function step(temp) {
                board = temp ? temp : board;
                var start = Date.now();
                while (Date.now() - start < timeInterval && ++i < n && timer) {
                    var d = data[i];
                    d.x = (size[0] * (random() + .5)) >> 1;
                    d.y = (size[1] * (random() + .5)) >> 1;
                    cloudSprite(contextAndRatio, d, data, i, simpleLayout);

                    function oncePlace() {
                        if (d.hasText && place(board, d, bounds)) {
                            tags.push(d);
                            event.word(d);
                            if (bounds) {cloudBounds(bounds, d);}
                            else {bounds = [{x: d.x + d.x0, y: d.y + d.y0}, {x: d.x + d.x1, y: d.y + d.y1}];}
                            // Temporary hack
                            d.x -= size[0] >> 1;
                            d.y -= size[1] >> 1;
                            return true;
                        }
                        return false;
                    }

                    if(!oncePlace()){//
                        oncePlace();
                    }
                }
                if (i >= n) {
                    cloud.stop();
                    event.end(tags, bounds);
                }
            }

            //ie8 simpleLayout
            function simpleStep(temp) {
                while (++i < n) {
                    var d = data[i];
                    d.x = (size[0] * (random() + .5)) >> 1;
                    d.y = (size[1] * (random() + .5)) >> 1;

                    var dim = textDimFun(d.text, {'fontSize':d.size + 'px', 'fontFamily':d.fontFamily});
                    d.height = dim.height;
                    d.y0 = -d.height >> 1;
                    d.y1 = -d.y0;
                    d.width = dim.width;
                    d.x0 = -d.width >> 1;
                    d.x1 = -d.x0;
                    if (place(board, d, bounds)) {
                        tags.push(d);
                        event.word(d);
                        if (bounds) {
                            bounds.push({x:d.x, y:d.y, x0:d.x0, y0:d.y0, x1:d.x1, y1:d.y1});
                        } else {
                            bounds = [{x:d.x, y:d.y, x0:d.x0, y0:d.y0, x1:d.x1, y1:d.y1}];
                        }
                        d.x -= size[0] >> 1;
                        d.y -= size[1] >> 1;
                        d.x -= d.width >> 1;
                        d.y -= d.height >> 1;
                    }
                }
                if (i >= n) {
                    cloud.stop();
                    event.end(tags, bounds);
                }
            }
        };

        cloud.stop = function() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            return cloud;
        };

        function imageShape() {
            return path && !simpleLayout;
        }

        function imageDataArray(contextAndRatio, complete) {

            var c = contextAndRatio.context,
                ratio = contextAndRatio.ratio;

            var width = (size[0] >> 5)/ratio, height = size[1]/ratio;
            c.clearRect(0, 0, width, height);

            var img = new Image();
            img.src = path;
            img.onload = function(){
                c.drawImage(img, 0, 0, width, height);
                var data = c.getImageData(0, 0, width, height).data;

                c.clearRect(0, 0, width, height);

                var len = data.length, board = [];
                for(var i = 0; i < len; i+=4){
                    board[i/4] = data[i+3] ? 0 : 1;
                }

                complete(board);

            };
        }

        function getContext(canvas) {
            canvas.width = canvas.height = 1;

            var context = canvas.getContext("2d");

            var ratio = simpleLayout ? 1 : Math.sqrt(context.getImageData(0, 0, 1, 1).data.length >> 2);
            canvas.width = (cw << 5) / ratio;
            canvas.height = ch / ratio;

            context.fillStyle = context.strokeStyle = "red";
            context.textAlign = "center";

            return {context: context, ratio: ratio};
        }

        function collideRectsArray(a, array) {
            var minx_a = a.x + a.x0, maxx_a = a.x + a.x1, miny_a = a.y + a.y0, maxy_a = a.y + a.y1;
            for(var i = 0,len = array.length;i<len;i++){
                var b = array[i];
                var minx_b = b.x + b.x0, maxx_b = b.x + b.x1, miny_b = b.y + b.y0, maxy_b = b.y + b.y1;
                var minx = Math.max(minx_a, minx_b),
                    maxx = Math.min(maxx_a, maxx_b),
                    miny = Math.max(miny_a, miny_b),
                    maxy = Math.min(maxy_a, maxy_b);
                if(minx < maxx && miny < maxy){
                    return true;
                }
            }

            return false;
        }

        function place(board, tag, bounds) {
            var perimeter = [{x: 0, y: 0}, {x: size[0], y: size[1]}],
                startX = tag.x,
                startY = tag.y,
                maxDelta = Math.sqrt(size[0] * size[0] + size[1] * size[1]),
                s = spiral(size),
                dt = random() < .5 ? 1 : -1,
                t = -dt,
                dxdy,
                dx,
                dy;

            while (dxdy = s(t += dt)) {
                dx = ~~dxdy[0];
                dy = ~~dxdy[1];

                if (Math.min(Math.abs(dx), Math.abs(dy)) >= maxDelta) {break;}

                tag.x = startX + dx;
                tag.y = startY + dy;

                if (tag.x + tag.x0 < 0 || tag.y + tag.y0 < 0 ||
                    tag.x + tag.x1 > size[0] || tag.y + tag.y1 > size[1]) {continue;}

                if(simpleLayout){
                    if(!bounds || !collideRectsArray(tag, bounds)){
                        return true;
                    }
                }
                // TODO only check for collisions within current bounds.
                //cloudCollide
                else if ((!bounds && !path) || !cloudCollide(tag, board, size[0])) {
                    if (!bounds || collideRects(tag, bounds)) {
                        var sprite = tag.sprite,
                            w = tag.width >> 5,
                            sw = size[0] >> 5,
                            lx = tag.x - (w << 4),
                            sx = lx & 0x7f,
                            msx = 32 - sx,
                            h = tag.y1 - tag.y0,
                            x = (tag.y + tag.y0) * sw + (lx >> 5),
                            last;
                        for (var j = 0; j < h; j++) {
                            last = 0;
                            for (var i = 0; i <= w; i++) {
                                board[x + i] |= (last << msx) | (i < w ? (last = sprite[j * w + i]) >>> sx : 0);
                            }
                            x += sw;
                        }
                        delete tag.sprite;
                        return true;
                    }
                }
            }
            return false;
        }

        cloud.timeInterval = function(_) {
            return arguments.length ? (timeInterval = _ == null ? Infinity : _, cloud) : timeInterval;
        };

        cloud.words = function(_) {
            return arguments.length ? (words = _, cloud) : words;
        };

        cloud.path = function (_) {
            return arguments.length ? (path = _, cloud) : path;
        };

        cloud.simpleLayout = function (_) {
            return arguments.length ? (simpleLayout = _, cloud) : simpleLayout;
        };

        cloud.textDimFun = function (_) {
            return arguments.length ? (textDimFun = _, cloud) : textDimFun;
        };

        cloud.size = function(_) {
            return arguments.length ? (size = [+_[0], +_[1]], cloud) : size;
        };

        cloud.font = function(_) {
            return arguments.length ? (font = functor(_), cloud) : font;
        };

        cloud.fontStyle = function(_) {
            return arguments.length ? (fontStyle = functor(_), cloud) : fontStyle;
        };

        cloud.fontWeight = function(_) {
            return arguments.length ? (fontWeight = functor(_), cloud) : fontWeight;
        };

        cloud.rotate = function(_) {
            return arguments.length ? (rotate = functor(_), cloud) : rotate;
        };

        cloud.text = function(_) {
            return arguments.length ? (text = functor(_), cloud) : text;
        };

        cloud.spiral = function(_) {
            return arguments.length ? (spiral = spirals[_] || _, cloud) : spiral;
        };

        cloud.fontSize = function(_) {
            return arguments.length ? (fontSize = functor(_), cloud) : fontSize;
        };

        cloud.padding = function(_) {
            return arguments.length ? (padding = functor(_), cloud) : padding;
        };

        cloud.random = function(_) {
            return arguments.length ? (random = _, cloud) : random;
        };

        cloud.on = function() {
            var value = event.on.apply(event, arguments);
            return value === event ? cloud : value;
        };

        return cloud;
    };

    function cloudText(d) {
        return d.text;
    }

    function cloudFont() {
        return "serif";
    }

    function cloudFontNormal() {
        return "normal";
    }

    function cloudFontSize(d) {
        return Math.sqrt(d.value);
    }

    function cloudRotate() {
        return (~~(Math.random() * 6) - 3) * 30;
    }

    function cloudPadding() {
        return 1;
    }

// Fetches a monochrome sprite bitmap for the specified text.
// Load in batches for speed.
    function cloudSprite(contextAndRatio, d, data, di, simpleLayout) {
        if (d.sprite) {return;}
        var c = contextAndRatio.context,
            ratio = contextAndRatio.ratio;

        c.clearRect(0, 0, (cw << 5) / ratio, ch / ratio);
        var x = 0,
            y = 0,
            maxh = 0,
            n = data.length;
        --di;
        while (++di < n) {
            d = data[di];
            c.save();
            c.font = d.style + " " + d.weight + " " + ~~((d.size + 1) / ratio) + "px " + d.font;
            var w = c.measureText(d.text + "m").width * ratio,
                h = d.size << 1;
            if (d.rotate) {
                var sr = Math.sin(d.rotate * cloudRadians),
                    cr = Math.cos(d.rotate * cloudRadians),
                    wcr = w * cr,
                    wsr = w * sr,
                    hcr = h * cr,
                    hsr = h * sr;
                w = (Math.max(Math.abs(wcr + hsr), Math.abs(wcr - hsr)) + 0x1f) >> 5 << 5;
                h = ~~Math.max(Math.abs(wsr + hcr), Math.abs(wsr - hcr));
            } else {
                w = (w + 0x1f) >> 5 << 5;
            }
            if (h > maxh) {maxh = h;}
            if (x + w >= (cw << 5)) {
                x = 0;
                y += maxh;
                maxh = 0;
            }
            if (y + h >= ch && !simpleLayout) {break;}
            c.translate((x + (w >> 1)) / ratio, (y + (h >> 1)) / ratio);
            if (d.rotate) {c.rotate(d.rotate * cloudRadians);}
            c.fillText(d.text, 0, 0);
            if (d.padding && !simpleLayout) {c.lineWidth = 2 * d.padding, c.strokeText(d.text, 0, 0);}
            c.restore();
            d.width = w;
            d.height = h;
            d.xoff = x;
            d.yoff = y;
            d.x1 = w >> 1;
            d.y1 = h >> 1;
            d.x0 = -d.x1;
            d.y0 = -d.y1;
            d.hasText = true;
            x += w;
        }
        if(simpleLayout){return}
        var pixels = c.getImageData(0, 0, (cw << 5) / ratio, ch / ratio).data,
            sprite = [];
        while (--di >= 0) {
            d = data[di];
            if (!d.hasText) {continue;}
            var w = d.width,
                w32 = w >> 5,
                h = d.y1 - d.y0;
            // Zero the buffer
            for (var i = 0; i < h * w32; i++) {sprite[i] = 0;}
            x = d.xoff;
            if (x == null) {return;}
            y = d.yoff;
            var seen = 0,
                seenRow = -1;
            for (var j = 0; j < h; j++) {
                for (var i = 0; i < w; i++) {
                    var k = w32 * j + (i >> 5),
                        m = pixels[((y + j) * (cw << 5) + (x + i)) << 2] ? 1 << (31 - (i % 32)) : 0;
                    sprite[k] |= m;
                    seen |= m;
                }
                if (seen) {seenRow = j;}
                else {
                    d.y0++;
                    h--;
                    j--;
                    y++;
                }
            }
            d.y1 = d.y0 + seenRow;
            d.sprite = sprite.slice(0, (d.y1 - d.y0) * w32);
        }
    }

// Use mask-based collision detection.
    function cloudCollide(tag, board, sw) {
        sw >>= 5;
        var sprite = tag.sprite,
            w = tag.width >> 5,
            lx = tag.x - (w << 4),
            sx = lx & 0x7f,
            msx = 32 - sx,
            h = tag.y1 - tag.y0,
            x = (tag.y + tag.y0) * sw + (lx >> 5),
            last;
        for (var j = 0; j < h; j++) {
            last = 0;
            for (var i = 0; i <= w; i++) {
                if (((last << msx) | (i < w ? (last = sprite[j * w + i]) >>> sx : 0))
                    & board[x + i]) {return true;}
            }
            x += sw;
        }
        return false;
    }

    function cloudBounds(bounds, d) {
        var b0 = bounds[0],
            b1 = bounds[1];
        if (d.x + d.x0 < b0.x) {b0.x = d.x + d.x0;}
        if (d.y + d.y0 < b0.y) {b0.y = d.y + d.y0;}
        if (d.x + d.x1 > b1.x) {b1.x = d.x + d.x1;}
        if (d.y + d.y1 > b1.y) {b1.y = d.y + d.y1;}
    }

    function collideRects(a, b) {
        return a.x + a.x1 > b[0].x && a.x + a.x0 < b[1].x && a.y + a.y1 > b[0].y && a.y + a.y0 < b[1].y;
    }

    function archimedeanSpiral(size) {
        var e = size[0] / size[1];
        return function(t) {
            return [e * (t *= .1) * Math.cos(t), t * Math.sin(t)];
        };
    }

    function rectangularSpiral(size) {
        var dy = 4,
            dx = dy * size[0] / size[1],
            x = 0,
            y = 0;
        return function(t) {
            var sign = t < 0 ? -1 : 1;
            // See triangular numbers: T_n = n * (n + 1) / 2.
            switch ((Math.sqrt(1 + 4 * sign * t) - sign) & 3) {
                case 0:  x += dx; break;
                case 1:  y += dy; break;
                case 2:  x -= dx; break;
                default: y -= dy; break;
            }
            return [x, y];
        };
    }

// TODO reuse arrays?
    function zeroArray(n) {
        var a = [],
            i = -1;
        while (++i < n) {a[i] = 0;}
        return a;
    }

    function cloudCanvas() {
        var canvas = document.createElement("canvas");

        window.G_vmlCanvasManager && G_vmlCanvasManager.initElement(canvas);

        return canvas;
    }

    function functor(d) {
        return typeof d === "function" ? d : function() { return d; };
    }

    var spirals = {
        archimedean: archimedeanSpiral,
        rectangular: rectangularSpiral
    };

    if (typeof define === "function" && define.amd) define(d3); else if (typeof module === "object" && module.exports) module.exports = d3;
    this.d3 = d3;
}();
/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */

//Copyright (c) 2013, Baidu Inc.
//    All rights reserved.
//
//    Redistribution and use of this software in source and binary forms, with or
//    without modification, are permitted provided that the following conditions
//are met:
//
//    Redistributions of source code must retain the above copyright notice, this
//list of conditions and the following disclaimer.
//
//    Redistributions in binary form must reproduce the above copyright notice,
//    this list of conditions and the following disclaimer in the documentation
//and/or other materials provided with the distribution.
//
//    Neither the name of Baidu Inc. nor the names of its contributors may be used
//to endorse or promote products derived from this software without specific
//prior written permission of Baidu Inc.
//
//    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
//AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
//IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
//DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
//ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
//(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
//LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
//ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
//(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
//SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

// document.body.appendChild(c);

//
//Copyright (c) 2014 Ga?tan Renaudeau
//
//Permission is hereby granted, free of charge, to any person
//obtaining a copy of this software and associated documentation
//files (the "Software"), to deal in the Software without
//restriction, including without limitation the rights to use,
//    copy, modify, merge, publish, distribute, sublicense, and/or sell
//copies of the Software, and to permit persons to whom the
//Software is furnished to do so, subject to the following
//conditions:
//
//    The above copyright notice and this permission notice shall be
//included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
//    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
//OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
//HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
//    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
//FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
//OTHER DEALINGS IN THE SOFTWARE.

!function(t,e){"function"==typeof define&&define.amd?define([],e):t.VanCharts=e()}(this,function(){var t,e,i;!function(n){function r(t,e){return x.call(t,e)}function a(t,e){var i,n,r,a,o,s,l,h,u,c,d,f=e&&e.split("/"),p=y.map,g=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(t=t.split("/"),o=t.length-1,y.nodeIdCompat&&b.test(t[o])&&(t[o]=t[o].replace(b,"")),t=f.slice(0,f.length-1).concat(t),u=0;u<t.length;u+=1)if(d=t[u],"."===d)t.splice(u,1),u-=1;else if(".."===d){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||g)&&p){for(i=t.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),f)for(c=f.length;c>0;c-=1)if(r=p[f.slice(0,c).join("/")],r&&(r=r[n])){a=r,s=u;break}if(a)break;!l&&g&&g[n]&&(l=g[n],h=u)}!a&&l&&(a=l,s=h),a&&(i.splice(0,s,a),t=i.join("/"))}return t}function o(t,e){return function(){var i=T.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),f.apply(n,i.concat([t,e]))}}function s(t){return function(e){return a(e,t)}}function l(t){return function(e){m[t]=e}}function h(t){if(r(v,t)){var e=v[t];delete v[t],_[t]=!0,d.apply(n,e)}if(!r(m,t)&&!r(_,t))throw new Error("No "+t);return m[t]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function c(t){return function(){return y&&y.config&&y.config[t]||{}}}var d,f,p,g,m={},v={},y={},_={},x=Object.prototype.hasOwnProperty,T=[].slice,b=/\.js$/;p=function(t,e){var i,n=u(t),r=n[0];return t=n[1],r&&(r=a(r,e),i=h(r)),r?t=i&&i.normalize?i.normalize(t,s(e)):a(t,e):(t=a(t,e),n=u(t),r=n[0],t=n[1],r&&(i=h(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},g={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:c(t)}}},d=function(t,e,i,a){var s,u,c,d,f,y,x=[],T=typeof i;if(a=a||t,"undefined"===T||"function"===T){for(e=!e.length&&i.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(d=p(e[f],a),u=d.f,"require"===u)x[f]=g.require(t);else if("exports"===u)x[f]=g.exports(t),y=!0;else if("module"===u)s=x[f]=g.module(t);else if(r(m,u)||r(v,u)||r(_,u))x[f]=h(u);else{if(!d.p)throw new Error(t+" missing "+u);d.p.load(d.n,o(a,!0),l(u),{}),x[f]=m[u]}c=i?i.apply(m[t],x):void 0,t&&(s&&s.exports!==n&&s.exports!==m[t]?m[t]=s.exports:c===n&&y||(m[t]=c))}else t&&(m[t]=i)},t=e=f=function(t,e,i,r,a){if("string"==typeof t)return g[t]?g[t](e):h(p(t,e).f);if(!t.splice){if(y=t,y.deps&&f(y.deps,y.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=a),r?d(n,t,e,i):setTimeout(function(){d(n,t,e,i)},4),f},f.config=function(t){return f(t)},t._defined=m,i=function(t,e,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(i=e,e=[]),r(m,t)||r(v,t)||(v[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),function(t,e,n,r){"use strict";function a(t,e,i){return setTimeout(u(t,i),e)}function o(t,e,i){return Array.isArray(t)?(s(t,i[e],i),!0):!1}function s(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==r)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function l(e,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=t.console&&(t.console.warn||t.console.log);return a&&a.call(t.console,r,n),e.apply(this,arguments)}}function h(t,e,i){var n,r=e.prototype;n=t.prototype=Object.create(r),n.constructor=t,n._super=r,i&&dt(n,i)}function u(t,e){return function(){return t.apply(e,arguments)}}function c(t,e){return typeof t==gt?t.apply(e?e[0]||r:r,e):t}function d(t,e){return t===r?e:t}function f(t,e,i){s(v(e),function(e){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)})}function p(t,e,i){s(v(e),function(e){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i)})}function g(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function v(t){return t.trim().split(/\s+/g)}function y(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function _(t){return Array.prototype.slice.call(t,0)}function x(t,e,i){for(var n=[],r=[],a=0;a<t.length;){var o=e?t[a][e]:t[a];y(r,o)<0&&n.push(t[a]),r[a]=o,a++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function T(t,e){for(var i,n,a=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<ft.length;){if(i=ft[o],n=i?i+a:e,n in t)return n;o++}return r}function b(){return At++}function A(e){var i=e.ownerDocument||e;return i.defaultView||i.parentWindow||t}function L(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){c(t.options.enable,[t])&&i.handler(e)},this.init()}function C(t){var e,i=t.options.inputClass;return new(e=i?i:Pt?H:Mt?z:Ct?W:N)(t,P)}function P(t,e,i){var n=i.pointers.length,r=i.changedPointers.length,a=e&Rt&&n-r===0,o=e&(Dt|Gt)&&n-r===0;i.isFirst=!!a,i.isFinal=!!o,a&&(t.session={}),i.eventType=e,M(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function M(t,e){var i=t.session,n=e.pointers,r=n.length;i.firstInput||(i.firstInput=O(e)),r>1&&!i.firstMultiple?i.firstMultiple=O(e):1===r&&(i.firstMultiple=!1);var a=i.firstInput,o=i.firstMultiple,s=o?o.center:a.center,l=e.center=S(n);e.timeStamp=xt(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=D(s,l),e.distance=B(s,l),E(i,e),e.offsetDirection=R(e.deltaX,e.deltaY);var h=k(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=h.x,e.overallVelocityY=h.y,e.overallVelocity=_t(h.x)>_t(h.y)?h.x:h.y,e.scale=o?I(o.pointers,n):1,e.rotation=o?G(o.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,w(i,e);var u=t.element;g(e.srcEvent.target,u)&&(u=e.srcEvent.target),e.target=u}function E(t,e){var i=e.center,n=t.offsetDelta||{},r=t.prevDelta||{},a=t.prevInput||{};(e.eventType===Rt||a.eventType===Dt)&&(r=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=r.x+(i.x-n.x),e.deltaY=r.y+(i.y-n.y)}function w(t,e){var i,n,a,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=Gt&&(l>kt||s.velocity===r)){var h=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,c=k(l,h,u);n=c.x,a=c.y,i=_t(c.x)>_t(c.y)?c.x:c.y,o=R(h,u),t.lastInterval=e}else i=s.velocity,n=s.velocityX,a=s.velocityY,o=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=a,e.direction=o}function O(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:yt(t.pointers[i].clientX),clientY:yt(t.pointers[i].clientY)},i++;return{timeStamp:xt(),pointers:e,center:S(e),deltaX:t.deltaX,deltaY:t.deltaY}}function S(t){var e=t.length;if(1===e)return{x:yt(t[0].clientX),y:yt(t[0].clientY)};for(var i=0,n=0,r=0;e>r;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:yt(i/e),y:yt(n/e)}}function k(t,e,i){return{x:e/t||0,y:i/t||0}}function R(t,e){return t===e?It:_t(t)>=_t(e)?0>t?Nt:Ht:0>e?Ft:Ut}function B(t,e,i){i||(i=Xt);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function D(t,e,i){i||(i=Xt);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}function G(t,e){return D(e[1],e[0],Yt)+D(t[1],t[0],Yt)}function I(t,e){return B(e[0],e[1],Yt)/B(t[0],t[1],Yt)}function N(){this.evEl=Qt,this.evWin=Zt,this.pressed=!1,L.apply(this,arguments)}function H(){this.evEl=$t,this.evWin=te,L.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function F(){this.evTarget=ie,this.evWin=ne,this.started=!1,L.apply(this,arguments)}function U(t,e){var i=_(t.touches),n=_(t.changedTouches);return e&(Dt|Gt)&&(i=x(i.concat(n),"identifier",!0)),[i,n]}function z(){this.evTarget=ae,this.targetIds={},L.apply(this,arguments)}function V(t,e){var i=_(t.touches),n=this.targetIds;if(e&(Rt|Bt)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,a,o=_(t.changedTouches),s=[],l=this.target;if(a=i.filter(function(t){return g(t.target,l)}),e===Rt)for(r=0;r<a.length;)n[a[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&s.push(o[r]),e&(Dt|Gt)&&delete n[o[r].identifier],r++;return s.length?[x(a.concat(s),"identifier",!0),s]:void 0}function W(){L.apply(this,arguments);var t=u(this.handler,this);this.touch=new z(this.manager,t),this.mouse=new N(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function X(t,e){t&Rt?(this.primaryTouch=e.changedPointers[0].identifier,Y.call(this,e)):t&(Dt|Gt)&&Y.call(this,e)}function Y(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches,r=function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)};setTimeout(r,oe)}}function q(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],a=Math.abs(e-r.x),o=Math.abs(i-r.y);if(se>=a&&se>=o)return!0}return!1}function Q(t,e){this.manager=t,this.set(e)}function Z(t){if(m(t,fe))return fe;var e=m(t,pe),i=m(t,ge);return e&&i?de:e||i?e?pe:ge:m(t,de)?de:ce}function K(){if(!he)return!1;var e={},i=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=i?t.CSS.supports("touch-action",n):!0}),e}function j(t){this.options=dt({},this.defaults,t||{}),this.id=b(),this.manager=null,this.options.enable=d(this.options.enable,!0),this.state=ve,this.simultaneous={},this.requireFail=[]}function J(t){return t&be?"cancel":t&xe?"end":t&_e?"move":t&ye?"start":""}function $(t){return t==Ut?"down":t==Ft?"up":t==Nt?"left":t==Ht?"right":""}function tt(t,e){var i=e.manager;return i?i.get(t):t}function et(){j.apply(this,arguments)}function it(){et.apply(this,arguments),this.pX=null,this.pY=null}function nt(){et.apply(this,arguments)}function rt(){j.apply(this,arguments),this._timer=null,this._input=null}function at(){et.apply(this,arguments)}function ot(){et.apply(this,arguments)}function st(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function lt(t,e){return e=e||{},e.recognizers=d(e.recognizers,lt.defaults.preset),new ht(t,e)}function ht(t,e){this.options=dt({},lt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=C(this),this.touchAction=new Q(this,this.options.touchAction),ut(this,!0),s(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ut(t,e){var i=t.element;if(i.style){var n;s(t.options.cssProps,function(r,a){n=T(i.style,a),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={})}}function ct(t,i){var n=e.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var dt,ft=["","webkit","Moz","MS","ms","o"],pt=e.createElement("div"),gt="function",mt=function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},vt=!t.SVGSVGElement,yt=Math.round,_t=Math.abs,xt=Date.now;dt="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==r&&null!==n)for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])}return e}:Object.assign;var Tt=l(function(t,e,i){for(var n=Object.keys(e),a=0;a<n.length;)(!i||i&&t[n[a]]===r)&&(t[n[a]]=e[n[a]]),a++;return t},"extend","Use `assign`."),bt=l(function(t,e){return Tt(t,e,!0)},"merge","Use `assign`."),At=1,Lt=/mobile|tablet|ip(ad|hone|od)|android/i,Ct="ontouchstart"in t,Pt=T(t,"PointerEvent")!==r,Mt=Ct&&Lt.test(navigator.userAgent),Et="touch",wt="pen",Ot="mouse",St="kinect",kt=25,Rt=1,Bt=2,Dt=4,Gt=8,It=1,Nt=2,Ht=4,Ft=8,Ut=16,zt=Nt|Ht,Vt=Ft|Ut,Wt=zt|Vt,Xt=["x","y"],Yt=["clientX","clientY"];L.prototype={handler:function(){},init:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(A(this.element),this.evWin,this.domHandler)}};var qt={mousedown:Rt,mousemove:Bt,mouseup:Dt},Qt="mousedown mousemove mouseout mouseover",Zt="mousemove mouseup";vt&&(Qt="mousedown mousemove mouseout mouseover mouseup",Zt="mousemove"),h(N,L,{handler:function(t){var e={pointers:[t],changedPointers:[t],pointerType:Ot,srcEvent:t},i=qt[t.type],n=vt?1===t.button:0===t.button;if(i&Rt&&n&&(this.pressed=!0),i&Bt&&(vt?!this.pressed:1!==t.which)&&(i=Dt),this.pressed)i&Dt&&(this.pressed=!1),this.callback(this.manager,i,e);else{var r=this.manager.handlers[t.type]&&this.manager.handlers[t.type].slice();if(r&&r.length)for(var a=0;a<r.length;)r[a](e),a++}}});var Kt={pointerdown:Rt,pointermove:Bt,pointerup:Dt,pointercancel:Gt,pointerout:Gt},jt={2:Et,3:wt,4:Ot,5:St},Jt="mousemove mouseout mouseover",$t="pointerdown",te="pointermove pointerup pointercancel "+Jt;t.MSPointerEvent&&!t.PointerEvent&&($t="MSPointerDown "+Jt,te="MSPointerMove MSPointerUp MSPointerCancel"),h(H,L,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),r=Kt[n],a=jt[t.pointerType]||t.pointerType,o=a==Et,s=y(e,t.pointerId,"pointerId");r&Rt&&(0===t.button||o)?0>s&&(e.push(t),s=e.length-1):r&(Dt|Gt)&&(i=!0);var l={pointers:e,changedPointers:[t],pointerType:a,srcEvent:t};if(0>s){if(-1!=Jt.indexOf(t.type)){var h=this.manager.handlers[t.type]&&this.manager.handlers[t.type].slice();if(h&&h.length)for(var u=0;u<h.length;)h[u](l),u++}}else e[s]=t,this.callback(this.manager,r,l),i&&e.splice(s,1)}});var ee={touchstart:Rt,touchmove:Bt,touchend:Dt,touchcancel:Gt},ie="touchstart",ne="touchstart touchmove touchend touchcancel";h(F,L,{handler:function(t){var e=ee[t.type];if(e===Rt&&(this.started=!0),this.started){var i=U.call(this,t,e);e&(Dt|Gt)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Et,srcEvent:t})}}});var re={touchstart:Rt,touchmove:Bt,touchend:Dt,touchcancel:Gt},ae="touchstart touchmove touchend touchcancel";h(z,L,{handler:function(t){var e=re[t.type],i=V.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Et,srcEvent:t})}});var oe=2500,se=25;h(W,L,{handler:function(t,e,i){var n=i.pointerType==Et,r=i.pointerType==Ot;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)X.call(this,e,i);else if(r&&q.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var le=T(pt.style,"touchAction"),he=le!==r,ue="compute",ce="auto",de="manipulation",fe="none",pe="pan-x",ge="pan-y",me=K();Q.prototype={set:function(t){t==ue&&(t=this.compute()),he&&this.manager.element.style&&me[t]&&(this.manager.element.style[le]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return s(this.manager.recognizers,function(e){c(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Z(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection,n=this.manager.options._handler,r=n&&n.preventDefault(t)&&!n.vanchart.isForceBubble();if(r||this.manager.session.prevented)return void mt(e);var a=this.actions,o=m(a,fe)&&!me[fe],s=m(a,ge)&&!me[ge],l=m(a,pe)&&!me[pe];if(o){var h=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(h&&u&&c)return}return l&&s?void 0:o||s&&i&zt||l&&i&Vt?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,mt(t)}};var ve=1,ye=2,_e=4,xe=8,Te=xe,be=16,Ae=32;j.prototype={defaults:{},set:function(t){return dt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=tt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=tt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=tt(t,this),-1===y(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=tt(t,this);var e=y(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(e,t)}var i=this,n=this.state;xe>n&&e(i.options.event+J(n)),e(i.options.event),t.additionalEvent&&e(t.additionalEvent),n>=xe&&e(i.options.event+J(n))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=Ae)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Ae|ve)))return!1;t++}return!0},recognize:function(t){var e=dt({},t);return c(this.options.enable,[this,e])?(this.state&(Te|be|Ae)&&(this.state=ve),this.state=this.process(e),void(this.state&(ye|_e|xe|be)&&this.tryEmit(e))):(this.reset(),void(this.state=Ae))},process:function(t){},getTouchAction:function(){},reset:function(){}},h(et,j,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(ye|_e),r=this.attrTest(t);return n&&(i&Gt||!r)?e|be:n||r?i&Dt?e|xe:e&ye?e|_e:ye:Ae}}),h(it,et,{defaults:{event:"pan",threshold:10,pointers:1,direction:Wt},getTouchAction:function(){var t=this.options.direction,e=[];return t&zt&&e.push(ge),t&Vt&&e.push(pe),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,a=t.deltaX,o=t.deltaY,s=this.manager.options._handler,l=s&&s.preventDefault(t);return r&e.direction||(e.direction&zt?(r=0===a?It:0>a?Nt:Ht,i=a!=this.pX,n=Math.abs(t.deltaX)):(r=0===o?It:0>o?Ft:Ut,i=o!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,l&&i&&n>e.threshold&&r&e.direction},attrTest:function(t){return et.prototype.attrTest.call(this,t)&&(this.state&ye||!(this.state&ye)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=$(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),h(nt,et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[fe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ye)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),h(rt,j,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ce]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Dt|Gt)&&!r)this.reset();else if(t.eventType&Rt)this.reset(),this._timer=a(function(){this.state=Te,this.tryEmit()},e.time,this);else if(t.eventType&Dt)return Te;return Ae},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Te&&(t&&t.eventType&Dt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=xt(),this.manager.emit(this.options.event,this._input)))}}),h(at,et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[fe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ye)}}),h(ot,et,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:zt|Vt,pointers:1},getTouchAction:function(){return it.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(zt|Vt)?e=t.overallVelocity:i&zt?e=t.overallVelocityX:i&Vt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&_t(e)>this.options.velocity&&t.eventType&Dt},emit:function(t){var e=$(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),h(st,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[de]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&Rt&&0===this.count)return this.failTimeout();if(n&&r&&i){if(t.eventType!=Dt)return this.failTimeout();var o=this.pTime?t.timeStamp-this.pTime<e.interval:!0,s=!this.pCenter||B(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t;var l=this.count%e.taps;if(0===l)return this.hasRequireFailures()?(this._timer=a(function(){this.state=Te,this.tryEmit()},e.interval,this),ye):Te}return Ae},failTimeout:function(){return this._timer=a(function(){this.state=Ae},this.options.interval,this),Ae},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Te&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),lt.VERSION="2.0.7",lt.defaults={domEvents:!1,touchAction:ue,enable:!0,inputTarget:null,inputClass:null,preset:[[at,{enable:!1}],[nt,{enable:!1},["rotate"]],[ot,{direction:zt}],[it,{direction:zt},["swipe"]],[st],[st,{event:"doubletap",taps:2},["tap"]],[rt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Le=1,Ce=2;ht.prototype={set:function(t){return dt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?Ce:Le},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Te)&&(r=e.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],e.stopped===Ce||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&i.state&(ye|_e|xe)&&(r=e.curRecognizer=i),a++}},get:function(t){if(t instanceof j)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=y(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==r&&e!==r){var i=this.handlers;return s(v(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==r){var i=this.handlers;return s(v(t),function(t){e?i[t]&&i[t].splice(y(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&ct(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){mt(e.srcEvent)};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&ut(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},dt(lt,{INPUT_START:Rt,INPUT_MOVE:Bt,INPUT_END:Dt,INPUT_CANCEL:Gt,STATE_POSSIBLE:ve,STATE_BEGAN:ye,STATE_CHANGED:_e,STATE_ENDED:xe,STATE_RECOGNIZED:Te,STATE_CANCELLED:be,STATE_FAILED:Ae,DIRECTION_NONE:It,DIRECTION_LEFT:Nt,DIRECTION_RIGHT:Ht,DIRECTION_UP:Ft,DIRECTION_DOWN:Ut,DIRECTION_HORIZONTAL:zt,DIRECTION_VERTICAL:Vt,DIRECTION_ALL:Wt,Manager:ht,Input:L,TouchAction:Q,TouchInput:z,MouseInput:N,PointerEventInput:H,TouchMouseInput:W,SingleTouchInput:F,Recognizer:j,AttrRecognizer:et,Tap:st,Pan:it,Swipe:ot,Pinch:nt,Rotate:at,Press:rt,on:f,off:p,each:s,merge:bt,extend:Tt,assign:dt,inherit:h,bindFn:u,prefixed:T});var Pe="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};Pe.Hammer=lt,"function"==typeof i&&i.amd?i("hammer",[],function(){return lt}):"undefined"!=typeof module&&module.exports?module.exports=lt:t[n]=lt}(window,document,"Hammer"),i("utils/ColorUtils",[],function(){function t(t){return String(t).replace(/\s+/g,"")}function e(t,e){return t<=e[0]?t=e[0]:t>=e[1]&&(t=e[1]),t}function i(t,e){if("function"!=typeof e)throw new TypeError;for(var i=t?t.length:0,n=0;i>n;n++)t[n]=e(t[n]);return t}function n(n){if(y[n]&&(n=y[n]),_[n])return _[n].slice();if(n=t(n),/^#[\da-f]{3}$/i.test(n)){n=parseInt(n.slice(1),16);var r=(3840&n)<<8,a=(240&n)<<4,o=15&n;n="#"+((1<<24)+(r<<4)+r+(a<<4)+a+(o<<4)+o).toString(16).slice(1)}var s,l,h,r=n.match(x),u=[];if(r[2])s=r[2].replace("#","").split(""),h=[s[0]+s[1],s[2]+s[3],s[4]+s[5]],u=i(h,function(t){return e(parseInt(t,16),[0,255])});else if(r[4]){var c=r[4].split(",");l=c[3],h=c.slice(0,3),u=i(h,function(t){return t=Math.floor(t.indexOf("%")>0?2.55*parseInt(t,0):t),e(t,[0,255])}),"undefined"!=typeof l&&u.push(e(parseFloat(l),[0,1]))}return 3===u.length&&u.push(1),_[n]=u.slice(),u}function r(t,n){if(n=n||"rgb",t&&(3===t.length||4===t.length)){if(t=i(t,function(t){return t>1?Math.ceil(t):t}),n.indexOf("hex")>-1)return"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1);if(n.indexOf("hs")>-1){var r=i(t.slice(1,3),function(t){return t+"%"});t[1]=r[0],t[2]=r[1]}return n.indexOf("a")>-1?(3===t.length&&t.push(1),t[3]=e(t[3],[0,1]),n+"("+t.slice(0,4).join(", ")+")"):n+"("+t.slice(0,3).join(", ")+")"}}function a(t){for(var i=n(t),a=[],o=0;3>o;o++){var s=i[o];128>=s?a.push(e(s-(255-s)*(255-2*s)/(2*s),[0,255])):a.push(e(s+s*(2*s-255)/(2*(255-s)),[0,255]))}var l=[];for(o=0;3>o;o++)l.push(Math.round(.65*i[o]+.35*a[o]));return r(l,"rgb")}function o(t,e){var i=n(t);i.length=3;for(var a=0;3>a;a++)i[a]=parseInt(i[a]/e,10);return r(i,"rgb")}function s(t){var e=n(t);e.length=3;for(var i=0;2>i;i++)e[i]=parseInt(.95*e[i],10);return r(e,"rgb")}function l(t,e){var i=n(t);return i[3]=e,r(i,"rgba")}function h(t,e,i,a){var o=n(t),s=d(o[0],o[1],o[2]);s[0]+=e,s[1]+=i,s[2]+=a;var l=u(s[0],s[1],s[2]);return r(l,"rgb")}function u(t,e,i){e=Math.min(1,Math.max(0,e)),i=Math.min(1,Math.max(0,i));var n=0,r=0,a=0;if(0===e)n=r=a=255*i+.5;else{var o=6*(t-Math.floor(t)),s=o-Math.floor(o),l=i*(1-e),h=i*(1-e*s),u=i*(1-e*(1-s));switch(Math.floor(o)){case 0:n=255*i+.5,r=255*u+.5,a=255*l+.5;break;case 1:n=255*h+.5,r=255*i+.5,a=255*l+.5;break;case 2:n=255*l+.5,r=255*i+.5,a=255*u+.5;break;case 3:n=255*l+.5,r=255*h+.5,a=255*i+.5;break;case 4:n=255*u+.5,r=255*l+.5,a=255*i+.5;break;case 5:n=255*i+.5,r=255*l+.5,a=255*h+.5}}var c=[];return c.push(Math.floor(n)),c.push(Math.floor(r)),c.push(Math.floor(a)),c}function c(t,e){t=t||"blue",e=e||1;for(var i=n(t),a=d(i[0],i[1],i[2]),o=[],s=a[0],l=a[1],h=a[2],c=0;e>c;c++){var f=l*(1-c/e),p=h+c*(1-h)/e;o.push(r(u(s,f,p)))}return o}function d(t,e,i){var n,r,a,o=[3],s=t>e?t:e;i>s&&(s=i);var l=e>t?t:e;if(l>i&&(l=i),a=s/255,r=0!==s?(s-l)/s:0,0===r)n=0;else{var h=(s-t)/(s-l),u=(s-e)/(s-l),c=(s-i)/(s-l);n=t==s?c-u:e==s?2+h-c:4+u-h,n/=6,0>n&&(n+=1)}return o[0]=n,o[1]=r,o[2]=a,o}function f(t){return t&&"string"==typeof t&&-1!=t.indexOf("rgba")?n(t)[3]:1}function p(t){return t&&"string"==typeof t&&-1!=t.indexOf("rgba")?f(t):void 0}function g(t){return m(t).hex}function m(t){var e,i,a,o,s=r(n(t),"rgba"),l=/rgba?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,([.\d]+))?\)/,h=s.replace(/\s+/g,"").match(l);return e=(+h[1]).toString(16),e=1===e.length?"0"+e:e,i=(+h[2]).toString(16),i=1===i.length?"0"+i:i,a=(+h[3]).toString(16),a=1===a.length?"0"+a:a,o=+(h[5]?h[5]:1),{hex:"#"+e+i+a,alpha:o}}function v(t,i){if(null==t)return{hex:t,alpha:i};null==i&&(i=1),i=e(parseFloat(i),[0,1]);var n=m(t);return null!=n.alpha&&(i*=n.alpha),{hex:n.hex,alpha:i}}var y={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#0ff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000",blanchedalmond:"#ffebcd",blue:"#00f",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#f0f",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#0f0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#f0f",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#f00",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#fff",whitesmoke:"#f5f5f5",yellow:"#ff0",yellowgreen:"#9acd32"},_={},x=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,T={toColor:r,hsb2rgb:u,rgb2hsb:d,createColorsWithHsb:c,getRGBAColorArray:n,mixColorWithHSB:h,getHighLightColor:a,getColorWithDivider:o,mixColorWithAlpha:l,getColorOpacity:f,getColorOpacityWithoutDefault:p,colorToHex:g,colorToHexAlpha:m,getClickColor:s,getStandardColorAndOpacity:v};return window.ColorUtils=T,T}),i("Constants",[],function(){return{BLANK_VALUE_PERCENTAGE:"\xa0\xa0",INSTANCES_KEY:"vancharts_index_",SELECT_ANIMATION:"select",CHART_HIDE:"vancharts-chart-hide",EXPORT_HIDE:"vancharts-export-hide",GEO:"geographic_co_sys",PLANE:"plane_co_sys",BUTTON:"button",CAROUSEL:"carousel",BAR_CHART:"bar",COLUMN_CHART:"column",LINE_CHART:"line",AREA_CHART:"area",PIE_CHART:"pie",MULTIPIE_CHART:"multiPie",TREEMAP_CHART:"treeMap",SCATTER_CHART:"scatter",BUBBLE_CHART:"bubble",FORCE_BUBBLE_CHART:"forceBubble",GAUGE_CHART:"gauge",POINTER_GAUGE:"pointer",
    SLOT_GAUGE:"slot",THERMOMETER_GAUGE:"thermometer",RING_GAUGE:"ring",RADAR_CHART:"radar",POINT_MAP:"pointMap",AREA_MAP:"areaMap",HEAT_MAP:"heatMap",LINE_MAP:"lineMap",FUNNEL_CHART:"funnel",WORD_CLOUD_CHART:"wordCloud",VANCHART:"vanchart",FULL_SCREEN_ICON:"fullScreen",EXPORT_ICON:"toImage",SORT:"sort",MENU_ICON:"vancharts-icon-menu",REFRESH_ICON:"vancharts-icon-refresh",AXIS_GROUP:"vanchart-axis-group",BOTTOM:"bottom",TOP:"top",LEFT:"left",RIGHT:"right",RIGHT_TOP:"right-top",LEFT_TO_RIGHT:"left-to-right",RIGHT_TO_LEFT:"right-to-right",BOTTOM_TO_TOP:"bottom-to-top",TOP_TO_BOTTOM:"top-to-botttom",DISORDER:"disorder",DESCENDING:"descending",ASCENDING:"ascending",CIRCLE:"circle",SQUARE:"square",DIAMOND:"diamond",TRIANGLE:"triangle",CIRCLE_HOLLOW:"circle_hollow",SQUARE_HOLLOW:"square_hollow",DIAMOND_HOLLOW:"diamond_hollow",TRIANGLE_HOLLOW:"triangle_hollow",NORMAL_ICON:"normal-legend-icon",PIE_ICON:"pie-legend-icon",DONUT_ICON:"donut-legend-icon",BUBBLE_ICON:"bubble-legend-icon",SCATTER_ICON:"scatter-legend-icon",TREEMAP_ICON:"treeMap-legend-icon",DASH_TYPE:{Solid:"0,0",Dash:"8,6"},SAME_ARC:"sameArc",DIFFERENT_ARC:"differentArc",OUTSIDE:"outside",INSIDE:"inside",CENTER:"center",STYLE_GRADUAL:"gradual",HORIZONTAL_LAYOUT:"horizontal",VERTICAL_LAYOUT:"vertical",POLYGON_RADAR:"polygon",CIRCLE_RADAR:"circle",SIZE_BY_AREA:"area",SIZE_BY_WIDTH:"width",GRADUAL_LIGHTER:"lighter",GRADUAL_DARKER:"darker",STATE_TO_DROP:"to-drop",STATE_DROPPED:"dropped",STATE_TO_SHOW:"to-show",STATE_SHOW:"show",EXPONENTIAL:"exponential",LINEAR:"linear",LOGARITHMIC:"logarithmic",POLYNOMIAL:"polynomial"}}),i("utils/BaseUtils",["require","./ColorUtils","../Constants","VanCharts"],function(t){function e(){if(null==Yt.isMS&&(Yt.isMS="Microsoft Internet Explorer"===navigator.appName||navigator.appVersion.indexOf("Trident")>-1||"Netscape"===navigator.appName&&navigator.appVersion.indexOf("Edge")>-1,Yt.transPrefix="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"",Gt=document.createElement("div"),document.body.appendChild(Gt),B())){var t=document.createElement("canvas");Nt=t.getContext("2d"),It=document.createElementNS("http://www.w3.org/2000/svg","svg"),document.body.appendChild(It);var e=document.createElementNS("http://www.w3.org/2000/svg","text");It.appendChild(e),It._textNode=e,It.style.visibility="hidden"}}function i(t){Yt.scale=Yt.scale||t||1}function n(){for(var t,e=arguments.length,i=0;e>i;i++)if(t=arguments[i],"undefined"!=typeof t&&null!==t)return t;return null}function r(t){return"[object Array]"===Object.prototype.toString.apply(t)}function a(t,e){e=T(e);for(var i in e)t.style(i,e[i])}function o(t,e,i){if(null==t)return{width:0,height:0};if(i)return l(t,e);if(!B())return l(t,e,!1);var n=Pt(e.fontSize);return!e["writing-mode"]&&n>=12?{width:u(t,n+"px",e),height:d(e)}:h(t,e)}function s(t,e,i){var n=g({"white-space":"normal",whiteSpace:"normal","word-wrap":"break-word",wordWrap:"break-word"},e);return l(t,n,i)}function l(t,e,i){Gt.style.cssText="",Gt.style.visibility="hidden",Gt.style.whiteSpace="nowrap",Gt.style.position="absolute",Gt.style.display="";for(var n in e)"function"!=typeof e[n]&&"color"!=n&&(Gt.style[n]=e[n]);i===!1?Gt.textContent?Gt.textContent=t:Gt.innerText=t:Gt.innerHTML=t;var r=Gt.offsetWidth||0,a=Gt.offsetHeight||0,o={width:r,height:a};return Gt.style.display="none",o}function h(t,e){It.style.display="";var i=It._textNode;i.textContent=t,i.style.cssText="";for(var n in e)"function"!=typeof e[n]&&"color"!=n&&(i.style[n]=e[n]);var r=i.getBBox(),a={width:r.width,height:r.height};return It.style.display="none",a}function u(t,e,i){var n=i.fontStyle||"",r=i.fontWeight||"",a=i.fontFamily||"",o="italic"===n?5:0;return Nt.font=n+" "+r+" "+e+" "+a,Nt.measureText(t).width+o||0}function c(t,e){var i=[];if(e.backgroundColor)if("string"==typeof e.backgroundColor)if(B())i.push("background-Color:"+e.backgroundColor);else{var n=Ht.colorToHexAlpha(e.backgroundColor);i.push("background-Color:"+n.hex),i.push("filter:alpha(opacity="+100*n.alpha+")")}else if("object"==typeof e.backgroundColor){var r=e.backgroundColor,a=Ht.colorToHex(r.startColor),o=Ht.colorToHex(r.endColor),s="left",l="left top",h="right top",u=1;r.x1==r.x2&&(s="top",l="left top",h="left bottom",u=0),i.push("background: -ms-linear-gradient("+s+", "+a+", "+o+")"),i.push("background-image: -moz-linear-gradient("+s+", "+a+", "+o+")"),i.push("background-image: -webkit-gradient(linear, "+l+", "+h+", color-stop(0, "+a+"), color-stop(1, "+o+"))"),i.push("filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="+a+", endColorstr="+o+", GradientType="+u+")")}e.backgroundImage&&(i.push("background-image:url("+e.backgroundImage+")"),i.push("background-size:100% 100%")),null!=e.borderWidth&&(i.push("border-style:solid"),i.push("border-width:"+e.borderWidth+"px")),null!=e.borderColor&&i.push("border-color:"+e.borderColor),null!=e.borderRadius&&(i.push("border-radius:"+e.borderRadius+"px"),i.push("-moz-border-radius:"+e.borderRadius+"px"),i.push("-webkit-border-radius:"+e.borderRadius+"px"),i.push("-o-border-radius:"+e.borderRadius+"px")),e.shadow&&i.push("box-shadow:1px 1px 2px rgba(0,0,0,0.2)"),t.style.cssText+=i.join(";")+";"}function d(t){var e=t.fontSize||"0.75rem";return Pt(e)}function f(t){return t._vanchart_id=t._vanchart_id||"vancharts"+ ++Ut,t._vanchart_id}function p(){return!1}function g(t){var e,i,n,r;for(i=1,n=arguments.length;n>i;i++){r=arguments[i];for(e in r)t[e]=r[e]}return t}function m(t,e){var i=[];i.push("transform:rotate("+e+"deg)"),i.push("-ms-transform:rotate("+e+"deg)"),i.push("-webkit-transform:rotate("+e+"deg)"),i.push("-moz-transform:rotate("+e+"deg)"),i.push("-o-transform:rotate("+e+"deg)");var n=Math.cos(I(e)),r=Math.sin(I(e));if(!B()){var a=e?["progid:DXImageTransform.Microsoft.Matrix(M11=",n,", M12=",-r,", M21=",r,", M22=",n,", sizingMethod='auto expand')"].join(""):"none";i.push("filter:"+a)}t.style.cssText+=i.join(";")+";"}function v(t,e,i,n){if(!t)return[];t+="",n=n||0,i-=2*n;for(var r=[],a=0,s=t.length;s>a;){for(var l=a;o(t.substring(l,a+1),e,!1).width<i&&(a++,!(a>=s)););if(l==a)return["..."];r.push(t.substring(l,a))}return r}function y(t,e,i,n){var r=o(t,e,i);return _(r,n)}function _(t,e){var i=Math.abs(I(e||0)),n=t.width*Math.cos(i)+t.height*Math.sin(i),r=t.width*Math.sin(i)+t.height*Math.cos(i);return{width:n,height:r}}function x(t){if("object"==typeof t&&null!==t){var e=t;if(r(t)){e=[];for(var i=0,n=t.length;n>i;i++)e[i]=x(t[i])}else{e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=x(t[a]))}return e}return t}function T(t){var e={};for(var i in t)if(Xt[i]&&(e[Xt[i]]=t[i]),"color"==i&&(e.color=t[i]),"fontSize"==i){var n=t[i];-1!=n.indexOf("pt")&&(n=4*parseFloat(n)/3,e["font-size"]=n+"px")}return e}function b(t){if(!(t instanceof Array))return[t,t,t,t];switch(t.length+""){case"4":return t;case"3":return[t[0],t[1],t[2],t[1]];case"2":return[t[0],t[1],t[0],t[1]];case"1":return[t[0],t[0],t[0],t[0]];case"0":return[0,0,0,0]}}function A(t,e){return e%2===0?Math.round(t):Math.round(t-.5)+.5}function L(){var t,e,i,n,r;return 2===arguments.length?(t=arguments[0].x,e=arguments[0].y,i=arguments[0].width,n=arguments[0].height,r=arguments[1]):(t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4]),r=r||0,t=A(t,r),e=A(e,r),i=Math.round(i),n=Math.round(n),{x:t,y:e,width:i,height:n}}function C(t,e){var i=[];if(t&&t.length)for(var n=0,r=t.length;r>n;n++)i.push(t[n]);if(e&&e.length)for(var n=0,r=e.length;r>n;n++)i.push(e[n]);return i}function P(t){t&&t.parentNode&&t.parentNode.appendChild(t)}function M(t){t&&t.parentNode&&t.parentNode.insertBefore(t,t.parentNode.firstChild)}function E(t){t.ownerSVGElement.appendChild(t)}function w(t){t.ownerSVGElement.appendChild(t,t.ownerSVGElement.firstChild)}function O(t,e){return t.x<=e.x&&t.y<=e.y&&t.x+t.width>=e.x+e.width&&t.y+t.height>=e.y+e.height}function S(t,e){if(!t||!e)return!1;var i=Math.max(t.x,e.x),n=Math.max(t.y,e.y),r=Math.min(t.x+t.width,e.x+e.width),a=Math.min(t.y+t.height,e.y+e.height);return r>=i&&a>=n}function k(t,e){return!O(t,e)&&!S(t,e)}function R(t,e){var i=n(e.x||e[0]),r=n(e.y||e[1]);return t.x<i&&t.x+t.width>i&&t.y<r&&t.y+t.height>r}function B(){return!!window.SVGSVGElement}function D(t,e,i){var n=Math.min(t,e),r=Math.max(t,e),a=r-n;return((i-n)%a+a)%a+n}function G(t,e){return Math.min(Math.max(t,e[0]),e[1])}function I(t){return Math.PI*(t/180)}function N(t){return 180*t/Math.PI}function H(t){return null==t||void 0==t?null:"string"==typeof t?new Function("return "+t)():t}function x(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array){for(var e=[],i=0,n=t.length;n>i;++i)e[i]=x(t[i]);return e}if(t instanceof String)return t+"";if(t instanceof Object){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=x(t[r]));return e}}function F(t){var e=""===t||null===t||void 0===t;return e}function U(t){return void 0==t||null==t}function z(e,i){var n,r,a=e.options,o=t("VanCharts");try{r=window.top.document,n=window.top}catch(s){n=window,r=n.document}var l=r.body,h=7998;if(null==i)for(var u,c=-1,d=document.body.children.length;++c<d;)u=document.body.children[c],"none"!==(u.style.display||"").toLowerCase()&&(h=Math.max(h,u.style.zIndex));else h=i-1;var f=r.createElement("div");f.style.cssText="position: fixed;top:0;left:0;width:100%;height:100%;z-index:"+(h+1)+";",B()?f.style.background="rgba(0,0,0,0.3)":(f.style.background="#000000",f.style.filter="alpha(opacity=30)"),l.appendChild(f);var p=r.createElement("div");p.style.cssText="position: fixed;top:5%;left:10%;width:80%;height:90%;z-index:"+(h+2)+";background:#ffffff;box-shadow:0px 4px 50px rgba(0,0,0,0.5);";try{p.style.setExpression("top","( ignoreMe = document.body.scrollTop + this.previousSibling.clientHeight * 0.05) + 'px' "),f.style.setExpression("top","( ignoreMe = document.body.scrollTop ) + 'px' "),p.style.position="absolute",f.style.position="absolute"}catch(s){}l.appendChild(p);var g=o.init(p);g.fullScreenFather=e,g.setOptions(a),e.set({enable:!1}),e.fullScreenChart=g,p.boxDiv=f,f.onclick=function(){V(p,e)},p.onclick=function(t){t=t||n.event,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}}function V(t,e){var i=t.parentNode;i&&(i.removeChild(t),t.boxDiv&&i.removeChild(t.boxDiv)),e.set({enable:!0}),e.fullScreenChart=null}function W(){return window.ActiveXObject||"ActiveXObject"in window?!0:!1}function X(t){return null==t}function Y(t){return!X(t)}function q(t,e){if(!t.length)return-1;for(var i=0,n=t.length;n>i;i++)if(t[i]==e)return i;return-1}function Q(){var t=0,e=0,i=0,r=0;if(2===arguments.length){var a=arguments[0],o=arguments[1];t=n(a.x,a[0]),e=n(a.y,a[1]),i=n(o.width,o[0]),r=n(o.height,o[1])}else 4===arguments.length&&(t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3]);return{x:t,y:e,width:i,height:r}}function Z(t,e){var i=n(t.x,t[0]),r=n(t.y,t[1]),a=n(e.x,e[0]),o=n(e.y,e[1]),s=i-a,l=r-o;return Math.sqrt(s*s+l*l)}function K(t){return t.width<=0||t.height<=0}function j(t,e){return Math.log(e)/Math.log(t)}function J(t){var e=0;if(t>0&&1>t)for(;1>t;)t=nt(t,10),e--;else if(t>=10)for(;t>=10;)t=it(t,10),e++;return e}function $(t,e){return t?(t+="",-1!=t.indexOf("%")&&(t=parseFloat(t)*e/100),parseFloat(t)):0}function tt(t){var e=(t+"").match(Vt);return e?(e[1]?e[1].length:0)+(+e[2]||0):0}function et(t,e){if(t%1===0&&e%1===0)return t+e;var i=tt(t),n=tt(e),r=Math.pow(10,Math.max(i,n));return(Math.round(t*r)+Math.round(e*r))/r}function it(t,e){if(t%1===0&&e%1===0)return t/e;var i=t+"",n=e+"",r=-tt(t);r+=tt(e);var a=i.replace(Wt,""),o=n.replace(Wt,"");return r>0?a/o*Math.pow(10,r):a/o/Math.pow(10,-r)}function nt(t,e){if(t%1===0&&e%1===0)return t*e;var i=t+"",n=e+"",r=tt(t);return r+=tt(e),i.replace(Wt,"")*n.replace(Wt,"")/Math.pow(10,r)}function rt(t){if(t.length)return[].slice.call(t);var e=[];for(var i in t)e.push(t[i]);return e}function at(t){"string"==typeof t&&(t=new Date(Date.parse(t.replace(/-|\./g,"/"))));var e=new Date("1970/01/01");return"number"==typeof t?t:t.getTime()-e.getTime()}function ot(t){var e=new Date("1970/01/01");return t=t||0,new Date(t+e.getTime())}function st(t){var e=t;return"string"==typeof e?e=new Date(Date.parse(e.replace(/-|\./g,"/"))):"number"==typeof e&&(e=new Date(e)),e}function lt(t){var e=n(t.x,t[0]),i=n(t.y,t[1]);return"translate("+e+","+i+")"}function ht(t){var e=n(t.x,t[0]),i=n(t.y,t[1]),r=n(t.z,t[2],0);return"translate3d("+e+"px,"+i+"px,"+r+"px)"}function ut(t){var e=Ft.CIRCLE+Ft.SQUARE+Ft.DIAMOND+Ft.TRIANGLE+Ft.CIRCLE_HOLLOW+Ft.SQUARE_HOLLOW+Ft.DIAMOND_HOLLOW+Ft.TRIANGLE_HOLLOW;return-1==e.indexOf(t)&&Y(t)}function ct(t){return X(t.symbol)}function dt(t){var e=[Ft.CIRCLE,Ft.CIRCLE_HOLLOW,Ft.SQUARE,Ft.SQUARE_HOLLOW,Ft.DIAMOND,Ft.DIAMOND_HOLLOW,Ft.TRIANGLE,Ft.TRIANGLE_HOLLOW];return e[t%e.length]}function ft(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener&&t.addEventListener(e,i,!1)}function pt(t){return t=t.trim?t.trim():t.replace(/^\s+|\s+$/g,""),t.split(/\s+/)}function gt(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.attachEvent&&t.detachEvent("on"+e,i)}function mt(t){return Math.abs(t)<1e-6?0:t}function vt(t){var e=t.currentStyle||document.defaultView.getComputedStyle(t);return((t.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10)).toFixed(0)-0}function yt(t){var e=t.currentStyle||document.defaultView.getComputedStyle(t);return((t.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)).toFixed(0)-0}function _t(t,e){var i=t.originalEvent||t;i=i.touches?i.touches.length?i.touches[0]:i.changedTouches[0]:i;var n,r,a=document.documentElement,o=e.getBoundingClientRect(),s=o.top+(window.pageYOffset||a.scrollTop)-(a.clientTop||0),l=o.left+(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0);return void 0==i.pageX?(n=Math.max(i.x,i.clientX-l),r=i.y):(n=i.pageX-l,r=i.pageY-s),[n,r]}function xt(){var t=window.document;return t&&void 0!==t.documentElement.ontouchstart}function Tt(t,e){return[t*Math.sin(e),-t*Math.cos(e)]}function bt(t,e){return(2*Math.PI-(Math.atan2(e,t)-Math.PI/2))%(2*Math.PI)}function At(t,e,i){t>e&&(t=0,e=100);var n=e-t,r=J(n),a=Math.pow(10,r);0>=r?(t=nt(t,Math.pow(10,1-r)),t=it(Math.floor(t),Math.pow(10,1-r))):t=Math.floor(t/a)*a;for(var o=it(i,10)*a,s=0;n>s;)s=et(o,s);for(var l=it(s,i);e>t+l*i;)s=et(o,s),l=it(s,i);return s=it(s,i),e=et(t,nt(s,i)),[t,e,s]}function Lt(t,e){if(window.FR){for(var i=0,n=t.length;n>i;i++)if(t[i]==e)return i;return-1}return t.indexOf(e)}function Ct(t){return/[\u4E00-\u9FA5]/.test(t)}function Pt(t){return-1!=t.indexOf("rem")?(t=parseFloat(t),t*=Et()):-1!=t.indexOf("pt")?t=4*parseFloat(t)/3:t.indexOf("px")&&(t=parseFloat(t)),t}function Mt(t){var e=isNaN(Yt.scale)?1:Yt.scale;return Math.round(Pt(t)*e)}function Et(){if(X(Yt.defaultFontSize)){var t=document.documentElement.currentStyle||document.defaultView.getComputedStyle(document.documentElement);Yt.defaultFontSize=wt(t.fontSize)}return Yt.defaultFontSize}function wt(t){return-1!=t.indexOf("px")?parseFloat(t):-1!=t.indexOf("pt")?4*parseFloat(t)/3:void 0}function Ot(t){if(t){var e=t.fontSize;B()?(e=isNaN(parseFloat(e))?"0.75rem":e,-1!=e.indexOf("rem")?e=16*parseFloat(e):-1!=e.indexOf("pt")&&(e=4*parseFloat(e)/3),t.fontSize=parseFloat(e)/16+"rem"):e&&-1!=e.indexOf("rem")&&(t.fontSize=16*parseFloat(e)+"px")}return t}function St(t){var e=document.createElement("a"),i=document.createElement("img");e.style.display="none",e.appendChild(i),i.setAttribute("src",t),document.body.appendChild(e),e.setAttribute("target","_blank"),e.setAttribute("href",t),e.setAttribute("download","export.png"),e.click()}function kt(t){return Gt.style.cssText="visibility: hidden;",Gt.innerHTML=t,Gt.textContent?Gt.textContent:Gt.innerText}function Rt(t,e,i,n,r){var a=Math.asin(r),o=Math.abs(t-i),s=Math.abs(e-n),l=Math.sqrt(o*o+s*s)/2,h=t>i?-1:1,u=h*l/Math.tan(a),c=Math.atan((e-n)/(i-t)),d=u*Math.sin(c),f=u*Math.cos(c),p=(t+i)/2,g=(e+n)/2,m=p+d,v=g+f,y=t-m,_=e-v,x=i-m,T=n-v,b=Bt(Math.atan2(_,y)),A=Bt(Math.atan2(T,x));return b>A&&(A+=zt),[m,v,l/r,b,A]}function Bt(t){return t%=zt,0>t&&(t+=zt),t}function Dt(t,e){switch(t){case Ft.CIRCLE:case Ft.CIRCLE_HOLLOW:return d3.svg.arc().outerRadius(e)({startAngle:0,endAngle:2*Math.PI});case Ft.SQUARE:case Ft.SQUARE_HOLLOW:var i=-e+","+-e,n=e+","+-e,r=e+","+e,a=-e+","+e;return"M"+i+"L"+n+"L"+r+"L"+a+"Z";case Ft.DIAMOND:case Ft.DIAMOND_HOLLOW:e=2*e/Math.sqrt(2);var o=-e+",0",s="0,"+-e,l=e+",0",h="0,"+e;return"M"+o+"L"+s+"L"+l+"L"+h+"Z";case Ft.TRIANGLE:case Ft.TRIANGLE_HOLLOW:var o=-e+","+e/Math.sqrt(3),s="0,"+-(2*Math.sqrt(3)/3)*e,l=e+","+e/Math.sqrt(3);return"M"+o+"L"+s+"L"+l+"Z"}}var Gt,It,Nt,Ht=t("./ColorUtils"),Ft=t("../Constants"),Ut=0,zt=2*Math.PI,Vt=/(?:\d+)(?:\.(\d+))?(?:[eE]-(\d+))?/,Wt=/\.|[eE]-\d+/g,Xt={color:"fill",font:"font",fontFamily:"font-family",fontSize:"font-size",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",letterSpacing:"letter-spacing",lineHeight:"line-height",quotes:"quotes",textAlign:"text-align",textDecoration:"text-decoration",textIndent:"text-indent",textShadow:"text-shadow",textTransform:"text-transform",whiteSpace:"white-space",wordSpacing:"word-spacing",padding:"padding"},Yt={initConst:e,initPaddingScale:i,toPng:St,getMousePos:_t,getDomWidth:vt,getDomHeight:yt,makeTranslate:lt,makeTranslate3d:ht,clone:x,date2int:at,int2date:ot,object2date:st,log:j,getOrder:J,getPercentValue:$,accAdd:et,accDiv:it,accMul:nt,dealFloatPrecision:mt,isEmpty:F,isEmptyBounds:K,objectToArray:rt,pick:n,isNull:U,getTextDimension:o,getTextHeight:d,splitText:v,getTextDimensionWithRotation:y,getTextDimRotated:_,isArray:r,indexInArray:q,cssNormalization:T,reformCssArray:b,rectSubPixelOpt:L,lineSubPixelOpt:A,addArray:C,toFront:P,toBack:M,toFrontOfAll:E,toBackOfAll:w,containsRect:O,rectangleOverlapped:S,outsideRect:k,containsPoint:R,isSupportSVG:B,setTextStyle:a,domRotate:m,makeValueInRange:D,getValueInDomain:G,toRadian:I,toDegree:N,getFormatterFunction:H,showLightBox:z,hideLightBox:V,isIE:W,hasTouch:xt,hasNotDefined:X,hasDefined:Y,distance:Z,makeBounds:Q,isImageMarker:ut,isNullMarker:ct,getDefaultMarkerSymbol:dt,addEvent:ft,removeEvent:gt,getArcPoint:Tt,getTextWrapDimension:s,stamp:f,splitWords:pt,falseFn:p,extend:g,setDomBackground:c,getArcByPoint:bt,calculateAutoMinMaxAndGap:At,arrayIndexOf:Lt,hasChn:Ct,convertREMtoPX:Pt,paddingConvertWithScale:Mt,getDefaultFontSize:Et,convertToREMUseDefault16PX:Ot,getPlainText:kt,computeArc:Rt,normalRadian:Bt,getMarkerPath:Dt,TOOLTIP_CATEGORY_STYLE:'<span style="font-size:'+(B()?"1rem":"16px")+';font-family:Verdana;color:white;">',TOOLTIP_SERIES_STYLE:'<span style="font-size:'+(B()?"0.875rem":"14px")+';font-family:Verdana;color:white">',TOOLTIP_VALUE_STYLE:'<span style="font-size:'+(B()?"0.875rem":"14px")+';font-family:Verdana;font-weight:bold;color:white">'};return window.VanUtils=Yt,Yt}),i("utils/QueryUtils",["require","./BaseUtils"],function(t){function e(t,e){if(t&&e){e=e.split(".");for(var i=0,n=e.length;n>i;i++)if(t=t[e[i]],void 0==t)return;return t}}function i(t,e){if(t&&t.length&&e)for(var i=0;i<t.length;i++){var n=t[i]&&t[i][e];if(void 0!=n)return n}}function n(t,e,i){for(var r in e)if(e.hasOwnProperty(r)){var a=t[r];"object"==typeof a?n(t[r],e[r],i):!i&&r in t||(t[r]=e[r])}return t}t("./BaseUtils");return{queryList:i,query:e,merge:n}}),i("utils/Class",["require","./QueryUtils"],function(t){function e(){}var i=t("./QueryUtils");return e.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=e.__super__=this.prototype,r=Object.create(n);r.constructor=e,e.prototype=r;for(var a in this)this.hasOwnProperty(a)&&"prototype"!==a&&(e[a]=this[a]);return i.merge(r,t,!0),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;e>t;t++)r._initHooks[t].call(this)}},e},e.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},e}),i("ComponentLibrary",[],function(){function t(t){return n[t]}function e(t,e){n[t]=e}function i(){return n}var n=Object.create(null),r=["tooltip","tools","geo","title","dTools","rangeLegend","legend","zoom","dataSheet","xAxis","yAxis","polar","angleAxis","radiusAxis","gaugeAxis","value","category","datetime"];return{TOOLTIP_COMPONENT:"tooltip",TOOLBAR_COMPONENT:"tools",GEO_COMPONENT:"geo",DRILL_TOOLS:"dTools",TITLE_COMPONENT:"title",RANGE_LEGEND_COMPONENT:"rangeLegend",INTERVAL_RANGE_LEGEND:"intervalRangeLegend",GradientRangeLegend:"gradientRangeLegend",LEGEND_COMPONENT:"legend",DATA_SHEET_COMPONENT:"dataSheet",ZOOM_COMPONENT:"zoom",X_AXIS_COMPONENT:"xAxis",Y_AXIS_COMPONENT:"yAxis",POLAR_COMPONENT:"polar",RADIUS_AXIS_COMPONENT:"radiusAxis",ANGLE_AXIS_COMPONENT:"angleAxis",GAUGE_AXIS_COMPONENT:"gaugeAxis",VALUE_AXIS_COMPONENT:"value",CATEGORY_AXIS_COMPONENT:"category",DATE_AXIS_COMPONENT:"datetime",ComponentsOrder:r,getRegisteredComponents:i,get:t,register:e}}),i("utils/BoundsManager",["require","./BaseUtils"],function(t){function e(){this.addedBounds=[]}var i=t("./BaseUtils");return e.prototype={constructor:e,addBounds:function(t){this.addedBounds.push(t)},isOverlapped:function(t){for(var e=0,n=this.addedBounds.length;n>e;e++)if(i.rectangleOverlapped(t,this.addedBounds[e]))return!0;return!1},isEmpty:function(){return 0==this.addedBounds.length}},e}),i("VanChartLayout",["require","./Constants","./utils/BaseUtils","./ComponentLibrary","./utils/BoundsManager"],function(t){function e(t){r(t),a(t.seriesOfType(f.WORD_CLOUD_CHART)),o(t,t.seriesOfType(f.BUBBLE_CHART),f.BUBBLE_CHART),o(t,t.seriesOfType(f.SCATTER_CHART),f.SCATTER_CHART),s(t.seriesOfType(f.BUBBLE_CHART)),s(t.seriesOfType(f.FORCE_BUBBLE_CHART))}function i(t){for(var e=new m,i=0,n=t.series.length;n>i;i++){var r=t.series[i];r.visible&&(r.doLayout(),r._calculateLabelPos(e))}}function n(t){e(t),u(t)}function r(t){for(var e={},i=t.series,n=0,r=i.length;r>n;n++){var a=i[n],o=a.type;if(!a.isTreeSeries()&&o!=f.WORD_CLOUD_CHART)if(a.isSeriesAccumulated())if(a._calculatePercentage)a._calculatePercentage();else{var s=a.getTargetKey();h(a.points,s),l(a.points,s)}else a.visible&&a.points.map(function(t){var i=[o,a.stack,t.category].join("-");e[i]||(e[i]=[]),e[i].push(t)})}for(var u in e){var c=e[u],s=c[0].series.getTargetKey();h(c,s),l(c,s)}for(var n=0,r=i.length;r>n;n++){var d=i[n];d.points.forEach(function(t){d.calculateLabelInfo(t)})}}function a(t){if(t&&t.length){var e=[];t.forEach(function(t){e=e.concat(t.points)}),h(e,t[0].getTargetKey())}}function o(t,e,i){if(t.isSupportAnimation()){var n,r;if(i==f.BUBBLE_CHART)r="swing",n=function(t,e){return e.radius-t.radius};else if(i==f.SCATTER_CHART){var a=t.isInverted();r="exp-in-out",n=function(t,e){return a?t.posY-e.posY:t.posX-e.posX}}var o=[];e.forEach(function(t){o=o.concat(t.points)}),o.sort(n);var s=o.length;s>0&&o.forEach(function(t,e){t.delayTime=800*d3.ease(r)(e/s)})}}function s(t){t.forEach(function(t){if(t.points.length>0){for(var e=Number.MAX_VALUE,i=-e,n=t.type==f.BUBBLE_CHART,r=0,a=t.points.length;a>r;r++){var o=t.points[r];if(!o.isNull){var s=t.getPointValue4MinMax(o);if(n&&!o.displayNegative&&o.getTargetValue()<0)continue;i=Math.max(i,s),e=Math.min(e,s)}}t.seriesMinValue=e,t.seriesMaxValue=i}}),t.forEach(function(t){t._calculateBubbleRadius()})}function l(t,e){if(t&&t.length)for(var i=t[0].series,n=i.stackByPercent,r=i.stack||n,a=i.getStackAxis(),o=a&&a.isLog()?1:0,s=0,l=0,h=0,u=t.length;u>h;h++){var c=t[h];if(r){var d=n?c.percentage:c.getTargetValue();d>=o?(c[e+"0"]=s,s+=d):(c[e+"0"]=l,l+=d)}else c[e+"0"]=0}}function h(t,e){var i=0;t.filter(function(t){return!t.isNull&&t.visible}).forEach(function(t){i+=Math.abs(t[e])}),i=i>0?i:1,t.forEach(function(t){var e=t.series,n=e.getTargetKey(),r=e[e.getBaseAxisType()],a=!e.stack&&r&&r.type!=g.CATEGORY_AXIS_COMPONENT;t.percentage=a?1:Math.abs(t[n])/i})}function u(t){t.bounds=t._getDefaultBounds(),g.ComponentsOrder.map(function(e){e in t.components&&t.components[e].doLayout()},this),t.plotBounds=t.bounds,[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].updateAxisClip()}),d(t),[g.Y_AXIS_COMPONENT,g.DATA_SHEET_COMPONENT,g.X_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].updateAxisSizeAndBounds()});var e=!1;[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT].forEach(function(i){e=t.components[i]&&t.components[i].adjustDomain4Radius()||e}),[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT,g.DATA_SHEET_COMPONENT,g.ZOOM_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].fixBoundsByPlot()}),[g.X_AXIS_COMPONENT,g.Y_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].dealOnZero()}),e&&c(t),i(t)}function c(t){t.bounds=p.makeBounds(t.plotBounds,t.plotBounds),t.clipPool={},t.axisSize={left:0,right:0,bottom:0,top:0},[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT,g.DATA_SHEET_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].reCalculateSize()}),[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].updateAxisClip()}),d(t),[g.Y_AXIS_COMPONENT,g.DATA_SHEET_COMPONENT,g.X_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].updateAxisSizeAndBounds()}),[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT,g.ZOOM_COMPONENT,g.DATA_SHEET_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].fixBoundsByPlot()}),[g.X_AXIS_COMPONENT,g.Y_AXIS_COMPONENT].forEach(function(e){t.components[e]&&t.components[e].dealOnZero()})}function d(t){var e=t.getChartBounds(),i=t.getPlotBounds(),n=i.x,r=i.y,a=i.width,o=i.height,s=Math.max(t.clipPool[f.LEFT]||0,n),l=Math.max(t.clipPool[f.RIGHT]||0,e.width-(n+a)),h=Math.max(t.clipPool[f.TOP]||0,r),u=Math.max(t.clipPool[f.BOTTOM]||0,e.height-(r+o));i={x:s,y:h,width:e.width-s-l,height:e.height-h-u},t.setPlotBounds(i)}var f=t("./Constants"),p=t("./utils/BaseUtils"),g=t("./ComponentLibrary"),m=t("./utils/BoundsManager");[g.Y_AXIS_COMPONENT,g.X_AXIS_COMPONENT,g.DATA_SHEET_COMPONENT,g.ZOOM_COMPONENT];return{PLANE_SYSTEM_LAYOUT:n,reLayoutPlotBounds:c,calculateSeriesMinMaxValue:s,calculateSeries:e,calculateSeriesShapes:i,fixCoordinateSystem:u}}),i("ChartLibrary",["require","./Constants"],function(t){function e(t){return r[t]}function i(t,e){r[t]=e}function n(){return r}var r={};t("./Constants");return{getRegisteredCharts:n,get:e,register:i}}),i("dom/Evented",["require","../utils/QueryUtils","../utils/BaseUtils","../utils/Class"],function(t){var e=(t("../utils/QueryUtils"),t("../utils/BaseUtils")),i=t("../utils/Class"),n=i.extend({on:function(t,i,n){if("object"==typeof t)for(var r in t)this._on(r,t[r],i);else{t=e.splitWords(t);for(var a=0,o=t.length;o>a;a++)this._on(t[a],i,n)}return this},off:function(t,i,n){if(t)if("object"==typeof t)for(var r in t)this._off(r,t[r],i);else{t=e.splitWords(t);for(var a=0,o=t.length;o>a;a++)this._off(t[a],i,n)}else delete this._events;return this},_on:function(t,i,n){if(i){var r=this._events=this._events||{},a=n&&n!==this&&e.stamp(n);if(a){var o=t+"_idx",s=t+"_len",l=r[o]=r[o]||{},h=e.stamp(i)+"_"+a;l[h]||(l[h]={fn:i,ctx:n},r[s]=(r[s]||0)+1)}else r[t]=r[t]||[],r[t].push({fn:i})}},_off:function(t,i,n){if(i){var r=this._events,a=t+"_idx",o=t+"_len";if(r){if(!i)return delete r[t],delete r[a],void delete r[o];var s,l,h,u,c,d=n&&n!==this&&e.stamp(n);if(d)c=e.stamp(i)+"_"+d,s=r[a],s&&s[c]&&(u=s[c],delete s[c],r[o]--);else if(s=r[t])for(l=0,h=s.length;h>l;l++)if(s[l].fn===i){u=s[l],s.splice(l,1);break}u&&(u.fn=e.falseFn)}}},fire:function(t,i,n){if(!this.listens(t,n))return this;var r=e.extend({},i,{type:t,target:this}),a=this._events;if(a){var o,s,l,h,u=a[t+"_idx"];if(a[t])for(l=a[t].slice(),o=0,s=l.length;s>o;o++)l[o].fn.call(this,r);for(h in u)u[h].fn.call(u[h].ctx,r)}return n&&this._propagateEvent(r),this},listens:function(t,e){var i=this._events;if(i&&(i[t]||i[t+"_len"]))return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e.extend({layer:t.target},t),!0)}});return n}),i("HammerHandler",["require","./utils/BaseUtils","./Constants","./dom/Evented","./ComponentLibrary"],function(t){var e,i=t("./utils/BaseUtils"),n=t("./Constants"),r=t("./dom/Evented"),a=t("./ComponentLibrary"),o=4e3,s=r.extend({initialize:function(t,n){function r(r){var s=r.srcEvent,h=r.type||s.type,u=s.target||s.srcElement;r.containerPoint=i.getMousePos(s,n);var c="panstart"==h||"panmove"==h||"panend"==h;a?"press"==h?l.pressed=!0:"panstart"!=h&&"panmove"!=h&&(l.pressed=!1):l.pressed=!0;var d;if(c&&l.panTarget)d=l.panTarget;else{for(;u&&((d=l._findTargetByBounds(r.containerPoint,h))||(d=t.renderer.findInteractiveTarget(u)),!(d&&d.listens(h,!0)||u===l._container));)u=u.parentNode;d=d&&d.listens(h,!0)?d:l}d&&d.listens(h,!0)&&(d.fire(h,r,!0),"panstart"==h?(l.removeAllChosen(r),l.panTarget=d):"panend"==h&&(l.panTarget=null),a&&"tap"===h&&(clearTimeout(e),e=setTimeout(function(){l.removeAllChosen(r)},o)))}this.vanchart=t,this._container=n;var a=i.hasTouch(),s=this.hammer=new Hammer.Manager(n,{_handler:this});s.add(new Hammer.Pan({threshold:0})),s.add(new Hammer.Tap),i.isSupportSVG()&&s.add(new Hammer.Press),s.on("panstart panmove panend tap press pressup",r),a||s.on("mouseover mousemove mouseout",r);var l=this;this.panTarget=null,l.on(l.getEvents())},_findTargetByBounds:function(t,e){var r=this.vanchart,o=(r.series,r.getPlotBounds()),s=r.getComponent(a.LEGEND_COMPONENT),l=r.getComponent(a.RANGE_LEGEND_COMPONENT);if(s=s||l,"panstart"==e&&s&&s.bounds&&i.containsPoint(s.bounds,t))return s;if(!i.containsPoint(o,t)){var h=r.seriesOfType(n.GAUGE_CHART);if(h&&h.length)for(var u=0,c=h.length;c>u;u++){var d=h[u];if(d.bounds&&i.containsPoint(d.bounds,t))return d}}},onContainerMouseOver:function(t){},onContainerMouseMove:function(t){var e=this.vanchart.getPlotBounds(),n=this.vanchart,r=n.renderer;if(i.containsPoint(e,t.containerPoint)){var a=t.srcEvent;a.target||a.srcElement;if(this._container.style.cursor="",!this._highlightShared(t)){this._removeHightlight(t);var o;if(n.isLargeMode()&&!n.hoverSeries)o=this._getCanvasClosestPoint(t.containerPoint),o&&(o._events||o.getEvents&&o.on(o.getEvents(),o),n.showTooltip(o,t),n.hoverPoint=o,o.hyperlink&&(this._container.style.cursor="pointer"));else{var s=n.hoverSeries;if(!s&&i.hasTouch()&&(s=n.hoverSeries=n.series[0]),s&&(o=n.hoverSeries.getClosestPoint(t.containerPoint),o&&(o._events||o.getEvents&&o.on(o.getEvents(),o),o.fire("mouseover",t),o.hyperlink&&(this._container.style.cursor="pointer"),o.series.defaultMarker))){var l=o.series.defaultMarker;r._targets[i.stamp(l.node())]=l,r._targets[i.stamp(l)]=o}}}}else i.containsPoint(this.vanchart._getDefaultBounds(),t.containerPoint)||this.vanchart.hideTooltip(),this.removeAllChosen(t)},removeAllChosen:function(t){var e=this.vanchart;this._removeHightlight(t),e.hoverPoint&&(e.hoverPoint.fire("mouseout",t),e.hoverPoint=null),e.hoverSeries&&e.hoverSeries.fire("seriesUnChosen",t);var n=e.getComponent(a.TOOLTIP_COMPONENT);n&&!e.isMap()&&n.immediateHide();var r=e.getComponent(a.LEGEND_COMPONENT);if(r=r||e.getComponent(a.RANGE_LEGEND_COMPONENT),r&&r.highlighted){var o=t&&i.containsPoint(r.bounds,t.containerPoint);o||(r.highlighted=!1,e.cancelLegendHighlight())}},_getCanvasClosestPoint:function(t){var e=this.vanchart,r=e.seriesOfType(n.BUBBLE_CHART).concat(e.seriesOfType(n.SCATTER_CHART)),o=this.vanchart._leaflet,s=e.seriesOfType(n.HEAT_MAP);this.vanchart.getComponent(a.GEO_COMPONENT);r=r.concat(s);for(var l,h=this.vanchart.getPlotBounds(),t=i.isArray(t)?{x:t[0],y:t[1]}:t,u=Number.MAX_VALUE,c=r.length-1;c>=0;c--)for(var d=r[c],f=d.points.length-1;f>=0;f--){var p=d.points[f],g=o&&p.lnglat?o.latLngToContainerPoint(p.getLatLng()):{x:p.posX+h.x,y:p.posY+h.y},m=g.x-t.x,v=g.y-t.y,y=Math.sqrt(m*m+v*v),_=p.radius||p.marker&&p.marker.radius||4.5;
    if(_>=y&&p.visible)return p;u>y&&!p.isNull&&(l=p,u=y)}return l},onContainerMouseOut:function(t){},onContainerTap:function(t){this.onContainerMouseMove(t);var e=this.vanchart.hoverPoint;e&&e.fire("tap",t)},onContainerPanStart:function(t){var e=this.vanchart,n=e.renderer,r=t.containerPoint,o=e.bounds;!this.selectRect&&this._supportCoordinateZoom()&&i.containsPoint(o,r)&&(this.selectRect=n.rect().style({fill:"rgb(69,114,167)","fill-opacity":.25}).add(),this.downPos=r,e.hoverPoint&&e.hoverPoint.fire("mouseout"));var s=e.getComponent(a.ZOOM_COMPONENT);this._zoomAsTarget(s,r)&&s._panStart(t,s.centerRect)},_zoomAsTarget:function(t,e){var n=this.vanchart,r=n.bounds,o=!1,s=n.getComponent(a.DATA_SHEET_COMPONENT);return s&&(o=i.containsPoint(s.bounds,e)),o=o||i.containsPoint(r,e),t&&t.zoomToolEnabled()&&o},onContainerPanMove:function(t){var e=this.vanchart,i=(e.renderer,e.hoverPoint,e.bounds),n=e.getOptions(),r=t.containerPoint,o=this.downPos,s=e.isInverted();if(this.selectRect){var l=n.zoom.zoomType,h=Math.min(r[0],o[0]),u=Math.min(r[1],o[1]),c=Math.abs(r[0]-o[0]),d=Math.abs(r[1]-o[1]),f=-1!=l.indexOf("x"),p=-1!=l.indexOf("y");s&&(f=-1!=l.indexOf("y"),p=-1!=l.indexOf("x")),f&&!p?(u=i.y,d=i.height):p&&!f&&(h=i.x,c=i.width),this.selectRect.attr({x:h,y:u,width:c,height:d})}var g=e.getComponent(a.ZOOM_COMPONENT);g&&g.zoomToolEnabled()&&g._panContainerMove(t)},onContainerPanEnd:function(t){var e=this.vanchart,n=(e.renderer,e.hoverPoint,e.bounds,e.getOptions(),t.containerPoint),r=this.downPos,o=e.components[a.TOOLBAR_COMPONENT];this.selectRect&&(i.distance(r,n)>14&&(e.dealAxisZoom(r,n),o&&o.showRefreshIconWhenZoom()),this.selectRect.remove(),this.selectRect=null),this.panTarget=null;var s=e.getComponent(a.ZOOM_COMPONENT);s&&s.zoomToolEnabled()&&s._panEnd()},_highlightShared:function(t){var e=this.vanchart.getSharedAxis();if(e&&e.getPointsInCategory){var i=t.containerPoint,n=e.getPointsInCategory(i);if(n&&n.length)return n[0]._onPointMouseOver.call(n[0],t),e.drawHighlightBackground(n),!0}return!1},_removeHightlight:function(t){var e=this.vanchart,i=e.getSharedAxis(),n=e.hoverPoints;i&&i.removeHighlightBackground&&i.removeHighlightBackground(),n&&n.length&&n[0]._onPointMouseOut.call(n[0],t),e.hoverPoints=null},getEvents:function(){return{mouseover:this.onContainerMouseOver,mousemove:this.onContainerMouseMove,mouseout:this.onContainerMouseOut,tap:this.onContainerTap,panstart:this.onContainerPanStart,panmove:this.onContainerPanMove,panend:this.onContainerPanEnd}},_supportCoordinateZoom:function(){var t=this.vanchart.hoverPoint&&"vanChartForceBubble"==this.vanchart.vanChartType,e=this.vanchart.getOptions();return i.isSupportSVG()&&e.zoom&&e.zoom.zoomType&&!t},destroy:function(){this.hammer.destroy()},_inZoomBar:function(t){var e=this.vanchart.getComponent(a.ZOOM_COMPONENT);return e&&e.bounds&&i.containsPoint(e.bounds,t)},preventDefault:function(t){var e=t.srcEvent,n=i.getMousePos(e,this._container),r=this.pressed||this._inZoomBar(n),o=this.vanchart.getComponent(a.ZOOM_COMPONENT);return!r&&o&&(r=o.target||this._zoomAsTarget(o,n),r=r&&(Math.abs(t.angle)<45||Math.abs(t.angle)>135)),r}});return s}),i("vector/ElementWrapper",["require","../utils/Class"],function(t){var e=t("../utils/Class"),i=e.extend({initialize:function(t,e){return this.rawElement=t,this.renderer=e,this},node:function(){return this.rawElement},addTo:function(t){return this.renderer.addChildElement(this,t),this},add:function(){return"div"===this.type?this.addTo(this.renderer._divContainer):this.addTo(this.renderer._container)},append:function(t){return this.renderer.addChildElement(t,this),t},datum:function(){return arguments.length?(this._datum=arguments[0],this):this._datum},remove:function(){return this.renderer&&this.renderer.removeChildElement(this),this},attr:function(){return"div"===this.type?this.style.apply(this,arguments):this.renderer.attr(this,arguments),this},style:function(){var t;return 2===arguments.length?(t={},t[arguments[0]]=arguments[1]):t=arguments[0],this.renderer.style(this,t),this},setType:function(t){return this.type=t,this},textContent:function(t){return this.renderer.textContent(this,t),this},imageContent:function(t){return this.renderer.imageContent(this,t),this},animate:function(t,e,i,n){e.call(t,this.rawElement,i,n)},vRotate:function(t,e){return this.renderer.vRotate(this,t,e),this},vMiddle:function(){this.renderer.vMiddle(this)}});return i}),i("vector/Renderer",["require","../utils/Class","../utils/BaseUtils","./ElementWrapper"],function(t){var e=t("../utils/Class"),i=t("../utils/BaseUtils"),n=t("./ElementWrapper"),r=e.extend({initialize:function(t,e,n){this._container=this._initContainerDom(t,e,n),this.vanchart=e,this._targets={},this.isSupportSVG=i.isSupportSVG()},remove:function(){this._container.remove(),this._divContainer.remove()},div:function(t){var e=new n(document.createElement("div"),this).setType("div").style({position:"absolute",left:0,top:0});return e.isHtml=t,e},vgroup:function(){var t=this.div(),e=this.group();return{divG:t,renderG:e,type:"vgroup",attr:function(){return this.divG.attr.apply(this.divG,arguments),this.renderG.attr.apply(this.renderG,arguments),this},style:function(){return this.divG.style.apply(this.divG,arguments),this.renderG.style.apply(this.renderG,arguments),this},append:function(i){return"div"===i.type&&i.isHtml?t.append(i):"vgroup"===i.type?(t.append(i.divG),e.append(i.renderG)):e.append(i),i},add:function(){return this.renderG.add(),this.divG.add(),this},remove:function(){this.divG.node()&&this.divG.remove(),this.renderG.node()&&this.renderG.remove()},node:function(){return e.node()},vRotate:function(t){isNaN(t)||(this.divG.vRotate(t),this.renderG.vRotate(t))}}},vtext:function(t){return t||!this.isSupportSVG?this.div(t):this.text()},vtspan:function(t){return t||!this.isSupportSVG?this.div(t):this.tspan()},addChildElement:function(t,e){var i=(e||this._container).rawElement;i.appendChild(t.rawElement)},removeChildElement:function(t){var e=t.rawElement;e.parentNode&&e.parentNode.removeChild(e)},registerInteractiveTarget:function(t,e){this._targets[i.stamp(e.rawElement)]=e,this._targets[i.stamp(e)]=t,t&&(t._events=null,t.getEvents&&t.on(t.getEvents(),t))},findInteractiveTarget:function(t){var e=this._targets[i.stamp(t)];return e&&this._targets[i.stamp(e)]},removeInteractiveTarget:function(t){this._targets[i.stamp(t.rawElement)]=null;var e=this._targets[i.stamp(t)];e&&(e._events=null)},resize:function(){}});return r}),i("utils/DomUtils",["require","./BaseUtils"],function(t){var e=t("./BaseUtils"),i={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=L.DomUtil.getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(void 0!==t.classList)for(var i=L.Util.splitWords(e),n=0,r=i.length;r>n;n++)t.classList.add(i[n]);else if(!L.DomUtil.hasClass(t,e)){var a=L.DomUtil.getClass(t);L.DomUtil.setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){void 0!==t.classList?t.classList.remove(e):L.DomUtil.setClass(t,L.Util.trim((" "+L.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e},getClass:function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&L.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(r){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},attr:function(){if(!(arguments.length<2)){var t,i,n=arguments[0],r=arguments[1],a=arguments[2];if("string"==typeof r)e.hasDefined(a)?n.setAttribute(r,a):n&&n.getAttribute&&(i=n.getAttribute(r));else if(e.hasDefined(r)&&"object"==typeof r)for(t in r)n.setAttribute(t,r[t]);return i}}};return i}),i("vector/SvgRenderer",["require","./Renderer","../utils/DomUtils","./ElementWrapper","../utils/BaseUtils"],function(t){function e(t){var e,i;return e=t.match(/translate\(\s*([\d|.|e|-]+)(?:[,\s]*)([\d|.|e|-]*)\s*\)/i),e&&e.shift(),i=t.match(/rotate\(\s*([\d|.|e|-]+[degratun]*)(?:[,\s]*)([\d|.|e|-]*)(?:[,\s]*)([\d|.|e|-]*)\s*\)/i),i=i&&i[1]||0,{translate:e,rotate:i}}var i=t("./Renderer"),n=t("../utils/DomUtils"),r=t("./ElementWrapper"),a=t("../utils/BaseUtils"),o=i.extend({_initContainerDom:function(t,e){var i=new r(this.create("svg"),this);return i.style({width:e.width+"px",height:e.height+"px"}),t.appendChild(i.rawElement),this.defs=new r(this.create("defs"),this).addTo(i),e._leaflet&&i.style("pointer-events","none"),this._divContainer=this.div().style({"white-space":"nowrap","pointer-events":"none"}),t.appendChild(this._divContainer.node()),i},resize:function(){var t=this.vanchart.width,e=this.vanchart.height;this._container.style({width:t+"px",height:e+"px"})},line:function(t){return new r(this.create("line"),this).attr(t)},rect:function(t){return new r(this.create("rect"),this).attr(t)},circle:function(t){return new r(this.create("circle"),this).attr(t)},path:function(t){return new r(this.create("path"),this).attr(t)},text:function(t){return new r(this.create("text"),this).attr(t)},tspan:function(t){return new r(this.create("tspan"),this).attr(t)},image:function(t){return new r(this.create("image"),this).attr(t)},group:function(t){return new r(this.create("g"),this).attr(t)},textContent:function(t,e){"div"===t.type?t.node().innerHTML=e:t.node().textContent=e},imageContent:function(t,e){t.node().setAttributeNS("http://www.w3.org/1999/xlink","href",e)},colorGradient:function(t,e,i){i=i||"linearGradient";var n=new r(this.create(i),this);t.id=a.stamp(n),n.attr(t),n.stops=[];for(var o=0,s=e.length;s>o;o++)n.stops[o]=new r(this.create("stop"),this).attr("offset",e[o].offset).style({"stop-color":e[o]["stop-color"]}).addTo(n);return n.addTo(this.defs)},updateColorGradient:function(t,e,i){t.attr(e);for(var n=0,r=i.length;r>n;n++)t.stops[n].attr("offset",i[n].offset).style({"stop-color":i[n]["stop-color"]})},createClip:function(t,e){e=e||"rect";var i=new r(this.create("clipPath"),this);return i.attr("id",a.stamp(i)),i.setType(e),i[e]=new r(this.create(e),this).attr(t).addTo(i),i.addTo(this.defs),i},clip:function(t,e){t.attr("clip-path","url(#"+a.stamp(e)+")")},updateClip:function(t,e){t&&t[t.type].attr(e)},imagePattern:function(t,e,i){var n=new r(this.create("pattern"),this);return t.id=a.stamp(n),n.attr(t),n.image=new r(this.create("image"),this).addTo(n),n.image.attr(e),n.image.imageContent(i),n.image._imageUrl=i,n.addTo(this.defs),n},updateImagePattern:function(t,e,i,n){t.attr(e),t.image.attr(i),t.image._imageUrl!=n&&(t.image.imageContent(n),t.image._imageUrl=n)},createDropShadowFilter:function(t,e,i,n,o,s,l){o=o||0,s=s||0,l=l||0;var h=new r(this.create("filter"),this),u=a.stamp(h);return h.attr({id:u,x:"-50%",y:"-50%",width:"200%",height:"200%"}),this.updateDropShadowFilter(h,t,e,i,n,o,s,l),h.feBlend=h.feBlend||new r(this.create("feBlend"),this).addTo(h),h.feBlend.attr({"in":"SourceGraphic",in2:"blurOut",mode:"normal"}),h.addTo(this.defs),h},updateDropShadowFilter:function(t,e,i,n,a,o,s,l){o=o||0,s=s||0,l=l||0,t.feOffset=t.feOffset||new r(this.create("feOffset"),this).addTo(t),t.feOffset.attr({"in":"SourceGraphic",dx:e,dy:i,result:"offOut"}),t.feColorMatrix=t.feColorMatrix||new r(this.create("feColorMatrix"),this).addTo(t),t.feColorMatrix.attr({"in":"offOut",type:"matrix",values:o+" 0 0 0 0 0 "+s+" 0 0 0 0 0 "+l+" 0 0 0 0 0 "+n+" 0",result:"matrixOut"}),t.feGaussianBlur=t.feGaussianBlur||new r(this.create("feGaussianBlur"),this).addTo(t),t.feGaussianBlur.attr({"in":"matrixOut",stdDeviation:a,result:"blurOut"})},createInnerShadowFilter:function(t,e,i,n){var o=new r(this.create("filter"),this),s=a.stamp(o);return o.attr({id:s,x:"-50%",y:"-50%",width:"200%",height:"200%"}),o.feComponentTransfer=o.feComponentTransfer||new r(this.create("feComponentTransfer"),this).attr({"in":"SourceAlpha"}).addTo(o),o.feComponentTransfer.feFuncA=o.feComponentTransfer.feFuncA||new r(this.create("feFuncA"),this).attr({type:"table",tableValues:"1 0"}).addTo(o.feComponentTransfer),o.feGaussianBlur=o.feGaussianBlur||new r(this.create("feGaussianBlur"),this).addTo(o),o.feGaussianBlur.attr("stdDeviation",n),o.feOffset=o.feOffset||new r(this.create("feOffset"),this).addTo(o),o.feOffset.attr({dx:t,dy:e,result:"offsetblur"}),o.feFlood=o.feFlood||new r(this.create("feFlood"),this).addTo(o),o.feFlood.attr({"flood-color":"black","flood-opacity":i,result:"color"}),o.feComposite1=o.feComposite1||new r(this.create("feComposite"),this).attr({in2:"offsetblur",operator:"in"}).addTo(o),o.feComposite2=o.feComposite2||new r(this.create("feComposite"),this).attr({in2:"SourceAlpha",operator:"in"}).addTo(o),o.merge=o.merge||new r(this.create("feMerge"),this).addTo(o),o.merge.feMergeNode1=o.merge.feMergeNode1||new r(this.create("feMergeNode"),this).attr("in","SourceGraphic").addTo(o.merge),o.merge.feMergeNode2=o.merge.feMergeNode2||new r(this.create("feMergeNode"),this).addTo(o.merge),o.addTo(this.defs),o},create:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},attr:function(t,e){n.attr.apply(null,[].concat.apply(t.rawElement,e))},style:function(t,i){var n,r=t.styles,o={},s=t.rawElement,l="",h=!r;if(i&&i.color&&(i.fill=i.color),i&&i.fill&&"div"===t.type&&(i.color=i.fill),r)for(n in i)i[n]!==r[n]&&(o[n]=i[n],h=!0);if(h){if("div"===t.type){var u={x:"left",y:"top",dx:"margin-left"};for(var c in u){var d;null!=(d=o[c])&&(o[u[c]]=/em/gi.test(d)?d:d+"px",delete o[c])}if(o.transform){var f=e(o.transform.replace(/px/gi,""));f.translate&&(o[a.transPrefix+"transform"]="translate("+f.translate[0]+"px,"+f.translate[1]+"px)")}}r&&(i=a.extend(r,o)),t.styles=i;var p=function(t,e){return"-"+e.toLowerCase()};for(n in i)l+=n.replace(/([A-Z])/g,p)+":"+i[n]+";";s.style.cssText=l,i.fill&&(s.style.fill=i.fill)}},vRotate:function(t,i,n){var r,o,s,l=t.node();if("div"===t.type){o=t.styles[a.transPrefix+"transform"]||"",o&&(r=e(o.replace(/px/gi,"")),o="",r.translate&&(o="translate("+r.translate[0]+"px,"+r.translate[1]+"px) ")),s="rotate("+i+"deg)",o+=s;var h=a.transPrefix+"transform";t.styles[h]=o,l.style[h]=o}else{var u=(l.scrollWidth||l.getBBox().width)/2,c=(l.scrollHeight||l.getBBox().height)/2-1;u+=+l.getAttribute("x")||0,c+=+l.getAttribute("y")||0,o=l.getAttribute("transform")||"",o&&(r=e(o),o="",r.translate&&(o="translate("+r.translate[0]+" "+r.translate[1]+") ")),s="rotate("+i+" "+u+" "+c+")",o+=s,n||t.attr("transform",o)}t.rotateStr=s},vMiddle:function(t){if("div"===t.type){var e=t.node(),i=e.offsetWidth;e.style.marginLeft=-i/2+"px"}else t.attr("text-anchor","middle")}});return o}),i("utils/PathUtils",["require"],function(t){function e(t){var e=/([clmz]),?([^clmz]*)/gi,i={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},n=/[ahqstv]/gi,a=l;if(String(t).match(n)&&(a=r),n=/[clmz]/g,a==l&&!String(t).match(n)){var o=String(t).replace(e,function(t,e,n){var r=[],a="m"==e.toLowerCase(),o=i[e];return n.replace(C,function(t){a&&2===r.length&&(o+=r+i["m"==e?"l":"L"],r=[]),r.push(x(t*E))}),o+r});return o}var s,h,u=a(t);o=[];for(var c=0,d=u.length;d>c;c++){s=u[c],h=u[c][0].toLowerCase(),"z"==h&&(h="x");for(var f=1,p=s.length;p>f;f++)h+=x(s[f]*E)+(f!=p-1?",":M);o.push(h)}return o.join(P)}function i(t){if(!t&&"string"!=typeof t)return null;var e={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];return String(t).replace(f,function(t,n,r){var a=[],o=n.toLowerCase();if(r.replace(p,function(t,e){e&&a.push(+e)}),"m"==o&&a.length>2&&(i.push([n][g](a.splice(0,2))),o="l",n="m"==n?"l":"L"),"r"==o)i.push([n][g](a));else for(;a.length>=e[o]&&(i.push([n][g](a.splice(0,e[o]))),e[o]););}),i.toString=n,i}function n(){return this.join(",").replace(L,"$1")}function r(t,e){for(var i=l(t),n=e&&l(e),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=(function(t,e,i){var n,r,l={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in l)&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][g](s[m](0,[e.x,e.y][g](t.slice(1))));break;case"S":"C"==i||"S"==i?(n=2*e.x-e.bx,r=2*e.y-e.by):(n=e.x,r=e.y),t=["C",n,r][g](t.slice(1));break;case"T":"Q"==i||"T"==i?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"][g](a(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][g](a(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][g](o(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][g](o(e.x,e.y,t[1],e.y));break;case"V":t=["C"][g](o(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][g](o(e.x,e.y,e.X,e.Y))}return t}),c=function(t,e){if(t[e].length>7){t[e].shift();for(var r=t[e];r.length;)f[e]="A",n&&(p[e]="A"),t.splice(e++,0,["C"][g](r.splice(0,6)));t.splice(e,1),T=y(i.length,n&&n.length||0)}},d=function(t,e,r,a,o){t&&e&&"M"==t[o][0]&&"M"!=e[o][0]&&(e.splice(o,0,["M",a.x,a.y]),r.bx=0,r.by=0,r.x=t[o][1],r.y=t[o][2],T=y(i.length,n&&n.length||0))},f=[],p=[],v="",_="",x=0,T=Math.max(i.length,n&&n.length||0);T>x;x++){i[x]&&(v=i[x][0]),"C"!=v&&(f[x]=v,x&&(_=f[x-1])),i[x]=u(i[x],r,_),"A"!=f[x]&&"C"==v&&(f[x]="C"),c(i,x),n&&(n[x]&&(v=n[x][0]),"C"!=v&&(p[x]=v,x&&(_=p[x-1])),n[x]=u(n[x],h,_),"A"!=p[x]&&"C"==v&&(p[x]="C"),c(n,x)),d(i,n,r,h,x),d(n,i,h,r,x);var b=i[x],A=n&&n[x],L=b.length,C=n&&A.length;r.x=b[L-2],r.y=b[L-1],r.bx=parseFloat(b[L-4])||r.x,r.by=parseFloat(b[L-3])||r.y,h.bx=n&&(parseFloat(A[C-4])||h.x),h.by=n&&(parseFloat(A[C-3])||h.y),h.x=n&&A[C-2],h.y=n&&A[C-1]}return n?[i,n]:i}function a(t,e,i,n,r,a){var o=1/3,s=2/3;return[o*t+s*i,o*e+s*n,o*r+s*i,o*a+s*n,r,a]}function o(t,e,i,n){return[t,e,i,n,i,n]}function s(t,e,i,n,r,a,o,l,h,u){var c,d=120*T/180,f=T/180*(+r||0),p=[],m=function(t,e,i){var n=t*_.cos(i)-e*_.sin(i),r=t*_.sin(i)+e*_.cos(i);return{x:n,y:r}};if(u)w=u[0],O=u[1],M=u[2],E=u[3];else{c=m(t,e,-f),t=c.x,e=c.y,c=m(l,h,-f),l=c.x,h=c.y;var v=(_.cos(T/180*r),_.sin(T/180*r),(t-l)/2),y=(e-h)/2,x=v*v/(i*i)+y*y/(n*n);x>1&&(x=_.sqrt(x),i=x*i,n=x*n);var L=i*i,C=n*n,P=(a==o?-1:1)*_.sqrt(b((L*C-L*y*y-C*v*v)/(L*y*y+C*v*v))),M=P*i*y/n+(t+l)/2,E=P*-n*v/i+(e+h)/2,w=_.asin(((e-E)/n).toFixed(9)),O=_.asin(((h-E)/n).toFixed(9));w=M>t?T-w:w,O=M>l?T-O:O,0>w&&(w=2*T+w),0>O&&(O=2*T+O),o&&w>O&&(w-=2*T),!o&&O>w&&(O-=2*T)}var S=O-w;if(b(S)>d){var k=O,R=l,B=h;O=w+d*(o&&O>w?1:-1),l=M+i*_.cos(O),h=E+n*_.sin(O),p=s(l,h,i,n,r,0,o,R,B,[O,k,M,E])}S=O-w;var D=_.cos(w),G=_.sin(w),I=_.cos(O),N=_.sin(O),H=_.tan(S/4),F=4/3*i*H,U=4/3*n*H,z=[t,e],V=[t+F*G,e-U*D],W=[l+F*N,h-U*I],X=[l,h];if(V[0]=2*z[0]-V[0],V[1]=2*z[1]-V[1],u)return[V,W,X][g](p);p=[V,W,X][g](p).join()[A](",");for(var Y=[],q=0,Q=p.length;Q>q;q++)Y[q]=q%2?m(p[q-1],p[q],f).y:m(p[q],p[q+1],f).x;return Y}function l(t){if("string"==typeof t&&(t=i(t)),!t||!t.length)return[["M",0,0]];var e=[],r=0,a=0,o=0,s=0,l=0;"M"==t[0][0]&&(r=+t[0][1],a=+t[0][2],o=r,s=a,l++,e[0]=["M",r,a]);for(var u,c,d=3===t.length&&"M"===t[0][0]&&"R"===t[1][0].toUpperCase()&&"Z"===t[2][0].toUpperCase(),f=l,p=t.length;p>f;f++){if(e.push(u=[]),c=t[f],c[0]!=v.call(c[0]))switch(u[0]=v.call(c[0]),u[0]){case"A":u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=+(c[6]+r),u[7]=+(c[7]+a);break;case"V":u[1]=+c[1]+a;break;case"H":u[1]=+c[1]+r;break;case"R":for(var m=[r,a][g](c.slice(1)),y=2,_=m.length;_>y;y++)m[y]=+m[y]+r,m[++y]=+m[y]+a;e.pop(),e=e[g](h(m,d));break;case"M":o=+c[1]+r,s=+c[2]+a;default:for(y=1,_=c.length;_>y;y++)u[y]=+c[y]+(y%2?r:a)}else if("R"==c[0])m=[r,a][g](c.slice(1)),e.pop(),e=e[g](h(m,d)),u=["R"][g](c.slice(-2));else for(var x=0,T=c.length;T>x;x++)u[x]=c[x];switch(u[0]){case"Z":r=o,a=s;break;case"H":r=u[1];break;case"V":a=u[1];break;case"M":o=u[u.length-2],s=u[u.length-1];default:r=u[u.length-2],a=u[u.length-1]}}return e.toString=n,e}function h(t,e){for(var i=[],n=0,r=t.length;r-2*!e>n;n+=2){var a=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];e?n?r-4==n?a[3]={x:+t[0],y:+t[1]}:r-2==n&&(a[2]={x:+t[0],y:+t[1]},a[3]={x:+t[2],y:+t[3]}):a[0]={x:+t[r-2],y:+t[r-1]}:r-4==n?a[3]=a[2]:n||(a[0]={x:+t[n],y:+t[n+1]}),i.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return i}function u(t,i,n,r,a){return a?[["M",t+a,i],["l",n-2*a,0],["a",a,a,0,0,1,a,a],["l",0,r-2*a],["a",a,a,0,0,1,-a,a],["l",2*a-n,0],["a",a,a,0,0,1,-a,-a],["l",0,2*a-r],["a",a,a,0,0,1,a,-a],["z"]]:e([["M",t,i],["l",n,0],["l",0,r],["l",-n,0],["z"]])}function c(t,i,n){return e([["M",t,i],["m",0,-n],["a",n,n,0,1,1,0,2*n],["a",n,n,0,1,1,0,-2*n],["z"]])}function d(t,i,n,r){return e([["M",t,i],["L",n,r]])}var f=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,p=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,g="concat",m="apply",v=String.prototype.toUpperCase,y=Math.max,_=Math,x=_.round,T=_.PI,b=Math.abs,A="split",L=/,?([achlmqrstvxz]),?/gi,C=/-?\d*\.?\d+(?:[eE][\-+]?\d+)?/g,P=" ",M="",E=1;return window.tmp={path2vml:e,rectPath:u,linePath:d,circlePath:c},window.tmp}),i("vector/VmlRenderer",["require","./Renderer","../utils/PathUtils","../utils/BaseUtils","../utils/ColorUtils","./ElementWrapper","../utils/PathUtils"],function(t){function e(t){var e,i;return e=t.match(/translate\(\s*([\d|.|e|-]+)(?:[,\s]*)([\d|.|e|-]*)\s*\)/i),e&&e.shift(),i=t.match(/rotate\(\s*([\d|.|e|-]+[degratun]*)(?:[,\s]*)([\d|.|e|-]*)(?:[,\s]*)([\d|.|e|-]*)\s*\)/i),i=i&&i[1]||0,{translate:e,rotate:i}}var i=t("./Renderer"),n=t("../utils/PathUtils"),r=t("../utils/BaseUtils"),a=t("../utils/ColorUtils"),o=t("./ElementWrapper"),n=t("../utils/PathUtils"),s="position:absolute;left:0px;top:0px;width:1px;height:1px;behavior:url(#default#VML);display:inline-block;",l="position:absolute;behavior:url(#default#VML);display:inline-block;",h=i.extend({_initContainerDom:function(t){var e=this.div().style({"white-space":"nowrap",display:"inline-block"});return t.appendChild(e.node()),this._divContainer=e,e},line:function(t){return this._shapeWithPath(t,"line")},rect:function(t){return this._shapeWithPath(t,"rect")},circle:function(t){return this._shapeWithPath(t,"circle")},path:function(t){return this._shapeWithPath(t,"path")},image:function(t){var e=new o(this.create("image"),this).setType("image");return e.attr(t),e},group:function(t){var e=this.div().style({"white-space":"nowrap","pointer-events":"none"});return e.attr(t)},colorGradient:function(t,e,i){return i=i||"linearGradient",{type:i,attrs:t,stops:e,elements:[]}},updateColorGradient:function(t,e,i){t.attrs=e,t.stops=i},_updateGradientFill:function(t,e){var i=t.node(),n=t._fill,r=e.stops,a=e.attrs;if(n){i.removeChild(n),n.on=!0,n.method="none",n.color=r[0]["stop-color"],n.color2=r[r.length-1]["stop-color"];for(var o=[],s=0,l=r.length;l>s;s++){var h=100*r[s].offset+"%";o.push(h+" "+r[s]["stop-color"])}n.type="gradient",n.angle=a.x1==a.x2?0:270,i.appendChild(n)}},textContent:function(t,e){t.isHtml?t.node().innerHTML=e:t.node().innerText=e},imageContent:function(t,e){this.style(t,{src:e})},text:function(){return this.vtext(!1)},tspan:function(){return this.vtspan(!1)},_shapeWithPath:function(t,e){var i=new o(this.create("shape"),this).setType(e),n=i.rawElement;return n.style.cssText=s,n.coordsize="1 1",i.attr(t)},create:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),createClip:function(t,e){return e&&"rect"!=e?void 0:{x:t.x,y:t.y,width:t.width,height:t.height,clipped:[]}},_getClipStr:function(t,e){var i=e.y||0,n=e.x||0,r=n+e.width,a=i+e.height;if("div"!=t.type){var o=t.isLineChart?t.node().parentNode.firstChild:t.node();i-=o.offsetTop,a-=o.offsetTop}return"rect("+i+"px "+r+"px "+a+"px "+n+"px)"},clip:function(t,e){if(e){var i;t.node&&(i=t.node())&&(i.style.clip=this._getClipStr(t,e),e.clipped.push(t))}},updateClip:function(t,e){var i=this;t&&(r.extend(t,e),t.clipped.forEach(function(e){var n=e.node();n&&(n.style.clip=i._getClipStr(e,t))}))},imagePattern:function(t,e){},createDropShadowFilter:function(){return{}},createInnerShadowFilter:function(){return{}},attr:function(t,i){if(i&&!(i.length<=0)&&i[0]){var a={},o=t.rawElement;2===i.length?a[i[0]]=i[1]:a=i[0];var s=t.attrs,l=t.type;if(s&&(a=r.extend(s,a)),t.attrs=a,a.transform){var h=e(a.transform);try{h.translate&&(o.style.left=h.translate[0]+"px",o.style.top=h.translate[1]+"px")}catch(u){}h.rotate}if("image"==l)o.style.position="absolute",o.style.left=a.x+"px",o.style.top=a.y+"px",o.style.width=a.width+"px",o.style.height=a.height+"px";else if("group"!=l){var c="";"rect"==l?c=n.rectPath(a.x||0,a.y||0,a.width,a.height):"line"==l?c=n.linePath(a.x1,a.y1,a.x2,a.y2):"path"==l?c=n.path2vml(a.d):"circle"==l&&(c=n.circlePath(a.cx||0,a.cy||0,a.r)),o.path=c}}},style:function(t,i){var n,o=t.styles,s={},h=t.rawElement;if(i&&i.color&&(i.fill=i.color),i&&i.fill&&"div"===t.type&&(i.color=i.fill),o)for(n in i)i[n]!==o[n]&&(s[n]=i[n]);if("div"===t.type){if(s.transform){var u=e(s.transform.replace(/px/gi,""));s.transform="",s.x=u.translate[0],s.y=u.translate[1]}var c={x:"left",y:"top",dx:"margin-left"};for(var d in c){var f;null!=(f=s[d])&&(s[c[d]]=/em/gi.test(f)?f:f+"px",delete s[d])}}if(o&&(i=r.extend(o,s)),t.styles=i,"div"===t.type){var p=function(t,e){return"-"+e.toLowerCase()},g=1;if(/rgba/i.test(i.color)){var m=a.colorToHexAlpha(i.color);i.color=m.hex,g=m.alpha}r.hasDefined(i["fill-opacity"])&&(g*=i["fill-opacity"]),1>g&&(i.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*g+")");var v="";for(n in i)v+=n.replace(/([A-Z])/g,p)+":"+i[n]+";";h.style.cssText=v}else if("group"!=t.type)if("image"==t.type)t.node().src=i.src;else{var y=t._stroke,_=t._fill,x=t.node();x.stroked=!0,x.filled=!!(i.fill&&"none"!=i.fill||"image"==t.type),y||(y=t._stroke=this.create("stroke"),y.style.cssText=l),x.appendChild(y),y.weight=(i["stroke-width"]||0)+"px";var T=i.stroke,b=r.hasDefined(i["stroke-opacity"])?i["stroke-opacity"]:1;if(T&&-1!=T.indexOf("rgba")&&(T=a.colorToHexAlpha(T),b*=T.alpha,T=T.hex),y.color=T,y.opacity=i["stroke-width"]?b:0,i["stroke-dasharray"]?y.dashStyle=i["stroke-dasharray"].replace(/( *, *)/g," "):y.dashStyle="","round"==i["stroke-linecap"]&&(y.endcap="round"),x.filled){_||(_=t._fill=this.create("fill"),_.style.cssText=l),x.appendChild(_);var A=i.fill,L=r.hasDefined(i["fill-opacity"])?i["fill-opacity"]:1;-1!=A.indexOf("rgba")&&(A=a.colorToHexAlpha(A),L*=A.alpha,A=A.hex),_.color=A,_.opacity=L}else _&&(x.removeChild(_),t._fill=null)}"display"in i&&(t.node().style.display=i.display),"cursor"in i&&(t.node().style.cursor=i.cursor)},vRotate:function(t,e){e%=360;var i=t.node();r.domRotate(i,0);var n=i.offsetWidth,a=i.offsetHeight;r.domRotate(i,e);var o=i.offsetWidth,s=i.offsetHeight;i.style.marginLeft=(n-o)/2+"px",i.style.marginTop=(a-s)/2+"px"},vMiddle:function(t){var e=t.node(),i=e.offsetWidth;e.style.marginLeft=-i/2+"px"}});return h}),i("component/TrendLine",["require","../utils/Class","../utils/BaseUtils","../utils/ColorUtils","../Constants"],function(t){function e(t){return t===r.LEFT||t===r.RIGHT}function i(t,e){var i=function(t,e){return t+e},n=1*t.reduce(i)/t.length,r=1*e.reduce(i)/e.length,a=t.map(function(t){return Math.pow(t-n,2)}).reduce(i),o=(e.map(function(t){return Math.pow(t-r,2)}).reduce(i),t.map(function(t,i){return(t-n)*(e[i]-r)}).reduce(i)),s=o/a,l=r-n*s;return[s,l]}var n=(t("../utils/Class"),t("../utils/BaseUtils")),r=(t("../utils/ColorUtils"),t("../Constants"));return{trendLines:[],calcTrendLines:function(){for(var t=[],i=this,n=i.series,a=0,o=n.length;o>a;a++){var s=n[a],l=s.trendLine;if(l&&s.visible){var h;switch(l.type){case r.LINEAR:h=i.linear;break;case r.LOGARITHMIC:h=i.logarithmic;break;case r.POLYNOMIAL:h=i.polynomial;break;default:case r.EXPONENTIAL:h=i.exponential}var u=s.getTrendLineXYValues(s);if(!(u[0].length<=1)){var c,d,f=e(u[2]);f?(d=u[0],c=u[1]):(c=u[0],d=u[1]);var p=h(c,d,this.extendXs(c,l.period)),g=d3.svg.line().interpolate("cardinal");f&&g.x(function(t){return t[1]}).y(function(t){return t[0]});var m={d:g(p),trendLine:l};t.push(m)}}}this.trendLines=t},extendXs:function(t,e){function i(t,e){return Array.apply(null,Array(t)).map(e)}if(e&&2===e.length&&t.length>1){var n=t[1]-t[0];return i(-e[0],function(e,i){return t[0]-(i+1)*n}).reverse().concat(t).concat(i(e[1],function(e,i){return t[t.length-1]+(i+1)*n}))}return t},linear:function(t,e,n){var r,a,o,s,l=i(t,e);return r=n[0],o=l[0]*r+l[1],a=n[n.length-1],s=l[0]*a+l[1],[[r,o],[a,s]]},logarithmic:function(t,e,n){var r=[],a=[],o=Math.min.apply(null,n);t.map(function(t,i){0>=o&&(t+=-o+1),r.push(Math.log(t)),a.push(e[i])});var s=i(r,a);return n.map(function(t){var e=t;return 0>=o&&(t+=-o+1),[e,s[0]*Math.log(t)+s[1]]})},exponential:function(t,e,n){var r=[],a=[],o=Math.min.apply(null,e);t.map(function(t,i){0>=o&&(e[i]+=-o+1),r.push(t),a.push(Math.log(e[i]))});var s=i(r,a),l=s[0];return s[0]=Math.exp(s[1]),s[1]=l,n.map(function(t){var e=s[0]*Math.exp(t*s[1]);return 0>=o&&(e-=-o+1),[t,e]})},polynomial:function(t,e,i){var n=Math.min(t.length-1,6);n++;for(var r,a=[],o=[],s=0;n>s;s++)a[s]=[],o[s]=[];var s,l,h,u,c=[],d=[],f=[];for(s=0;n>s;s++)for(l=0;l<t.length;l++){for(r=1,u=0;s>u;u++)r*=t[l];a[s][l]=r}for(s=0;n>s;s++)for(h=0;n>h;h++){for(r=0,l=0;l<t.length;l++)r+=a[s][l]*a[h][l];o[s][h]=r}for(s=0;n>s;s++){for(r=0,l=0;l<t.length;l++)r+=e[l]*a[s][l];c[s]=r}for(s=1;n>s;s++)o[s][0]=o[s][0]/o[0][0];for(s=1;n>s;s++)for(l=s;n>l;l++){var p=0;for(h=0;s>h;h++)p+=o[h][l]*o[s][h];if(o[s][l]=o[s][l]-p,l+1!=n){var g=0;for(h=0;s>h;h++)g+=o[h][s]*o[l+1][h];o[l+1][s]=(o[l+1][s]-g)/o[s][s]}}for(d[0]=c[0],s=1;n>s;s++){for(r=0,l=0;s>l;l++)r+=o[s][l]*d[l];d[s]=c[s]-r}for(f[n-1]=d[n-1]/o[n-1][n-1],s=n-2;s>=0;s--){for(r=0,l=s+1;n>l;l++)r+=o[s][l]*f[l];f[s]=(d[s]-r)/o[s][s]}return i.map(function(t){return[t,f.reduce(function(e,i,n){return e+i*Math.pow(t,n)},0)]})},_renderTrendLine:function(){this.calcTrendLines();var t=this.trendLines,e=this.getPlotBounds(),i=this.renderer;this.trendLineGroup||(this.trendLineGroup=i.group().add(),i.clip(this.trendLineGroup,this.plotClip)),this.trendLineGroup.trendLines=this.trendLineGroup.trendLines||[];for(var a=this.trendLineGroup.trendLines,o=0,s=t.length;s>o;o++){var l=t[o],h={d:l.d},u={fill:"none",stroke:l.trendLine.color,"stroke-width":l.trendLine.width,"stroke-dasharray":r.DASH_TYPE[l.trendLine.dashStyle]};a[o]?a[o].attr(h).style(u):a[o]=i.path(h).style(u).addTo(this.trendLineGroup),a[o].attr("transform",n.makeTranslate(e))}for(var o=t.length;o<a.length;o++)a[o].remove(),a[o]=null;return a.length=t.length,this.trendLineGroup}}}),i("theme/config",["require","../Constants","../utils/QueryUtils","../utils/BaseUtils"],function(t){
    function e(){var t={pie:{plotOptions:{rotatable:!0,startAngle:0,endAngle:360,borderWidth:1,borderColor:"white",dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"inside"},tooltip:a()},options:{colors:T,style:b,legend:d()}},multiPie:{plotOptions:{borderWidth:1,borderColor:"rgb(255,255,255)",rotatable:!0,gradual:"lighter",innerRadius:0,startAngle:0,endAngle:360,drilldown:!0,tooltip:o(),dataLabels:{formatter:{identifier:"${NAME}"},enabled:!1,align:"inside"}},options:{colors:T,legend:d()}},treeMap:{plotOptions:{borderWidth:1,borderColor:"rgb(255,255,255)",zoom:!0,tooltip:o(),dataLabels:{formatter:{identifier:"${NAME}"},enabled:!1,align:"top"}},options:{colors:T,legend:d()}},bar:{plotOptions:{categoryGap:"20%",gap:"20%",borderRadius:0,borderWidth:1,borderColor:"white",dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"inside"},tooltip:i()},options:{colors:T,style:b,zoom:h(),legend:d(),xAxis:[g()],yAxis:[m()]}},column:{plotOptions:{categoryGap:"20%",gap:"20%",borderRadius:0,borderWidth:1,borderColor:"white",dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"inside"},tooltip:i()},options:{colors:T,style:b,zoom:h(),legend:d(),xAxis:[f()],yAxis:[p()]}},line:{plotOptions:{large:!1,connectNulls:!1,lineWidth:2,step:!1,curve:!1,marker:{radius:4.5},dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"outside"},tooltip:i()},options:{colors:T,zoom:h(),legend:d(),xAxis:[f()],yAxis:[p()]}},area:{plotOptions:{large:!1,connectNulls:!1,lineWidth:2,step:!1,curve:!1,marker:{radius:4.5},dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"outside"},tooltip:i(),fillColor:!0,fillColorOpacity:.15},options:{colors:T,zoom:h(),legend:d(),xAxis:[f()],yAxis:[p()]}},gauge:{thermometer:{layout:"horizontal",tooltip:n(),percentageLabel:{enabled:!1,useHtml:!1,align:"left",style:{color:"#333333",fontSize:"0.75rem",fontFamily:"Verdana",fontWeight:"bold"},formatter:{identifier:"${PERCENT}",percentFormat:d3.format(".2%")}},valueLabel:{enabled:!1,useHtml:!1,align:"left",style:{color:"#bababa",fontSize:"0.75rem",fontFamily:"Verdana"},formatter:{identifier:"${CATEGORY}${VALUE}",valueFormat:d3.format(".2")}},needle:"#ffffff",slotBackgroundColor:"#eeeeee",thermometerLayout:"vertical"},ring:{layout:"horizontal",tooltip:n(),percentageLabel:{enabled:!1,useHtml:!1,style:{fontSize:"1.5rem",fontFamily:"Verdana",fontWeight:"bold"},formatter:{identifier:"${PERCENT}",percentFormat:d3.format(".2%")}},valueLabel:{enabled:!1,useHtml:!1,style:{color:"#777777",fontSize:"0.75rem",fontFamily:"Verdana"},formatter:{identifier:"${CATEGORY}${VALUE}",valueFormat:d3.format(".2")}},clockwise:!1,paneBackgroundColor:"#eeeeee",innerPaneBackgroundColor:"#f4f4f4"},pointer:{layout:"horizontal",tooltip:n(),seriesLabel:{enabled:!1,align:_.BOTTOM,useHtml:!1,style:{color:"#333333",fontSize:"0.875rem",fontFamily:"Verdana"},formatter:{identifier:"${CATEGORY}"}},valueLabel:{enabled:!1,useHtml:!1,backgroundColor:"#F5F5F7",style:{color:"#333333",fontSize:"0.6875rem",fontFamily:"Verdana"},formatter:{identifier:"${SERIES}${VALUE}",valueFormat:d3.format(".2")}},needle:"#E5715A",hinge:"#656B6D",hingeBackgroundColor:"#DCF2F9",paneBackgroundColor:"#FCFCFC"},slot:{layout:"horizontal",tooltip:n(),percentageLabel:{enabled:!1,useHtml:!1,style:{fontSize:"2.25rem",fontFamily:"Verdana",fontWeight:"bold",textShadow:"0px 2px 0px rgba(0,0,0,0.08)"},formatter:{identifier:"${PERCENT}",percentFormat:d3.format(".2%")}},valueLabel:{enabled:!1,useHtml:!1,style:{color:"#666666",fontSize:"0.875rem",fontFamily:"Verdana"},formatter:{identifier:"${CATEGORY}${VALUE}",valueFormat:d3.format(".2")}},needle:"#ffffff",slotBackgroundColor:"#eeeeee"},options:{colors:T,legend:d(),gaugeAxis:[{type:"value",showLabel:!0,step:1,enableTick:!0,tickColor:"#BBBBBB",tickWidth:1,enableMinorTick:!0,minorTickColor:"#e2e2e2",minorTickWidth:1,labelStyle:{color:"#666666",fontFamily:"Verdana",fontSize:"0.625rem"}}]}},radar:{plotOptions:{fillColor:!1,fillColorOpacity:.15,columnType:!1,marker:{radius:4.5},lineWidth:2,shape:"circle",dataLabels:{formatter:{identifier:"${Y}"},enabled:!1,align:"outside"},tooltip:i()},options:{colors:T,polar:{},legend:d(),angleAxis:[v()],radiusAxis:[y()]}},scatter:{plotOptions:{large:!1,lineWidth:0,curve:!1,marker:{radius:4.5},opacity:1,tooltip:r(),dataLabels:{formatter:{identifier:"${X}${Y}${SIZE}"},enabled:!1,align:"outside"}},options:{colors:T,zoom:h(),legend:d(),rangeLegend:c(),xAxis:[g()],yAxis:[p()]}},bubble:{plotOptions:{large:!1,displayNegative:!0,shadow:!0,minSize:12,maxSize:60,sizeBy:"area",opacity:.7,tooltip:r(),dataLabels:{formatter:{identifier:"${X}${Y}${SIZE}"},enabled:!1,align:"inside"}},options:{colors:T,zoom:h(),rangeLegend:c(),legend:d(),xAxis:[g()],yAxis:[p()]}},funnel:{plotOptions:{borderColor:"rgb(255,255,255)",borderWidth:1,sort:!0,useSameSlantAngle:!0,dataLabels:{formatter:{identifier:"${VALUE}"},enabled:!1,connectorWidth:1,align:"outside"}},options:{colors:T,legend:d(),style:b}},wordCloud:{plotOptions:{fontFamily:"Microsoft YaHei",maxRotation:0,minRotation:0,tooltip:o(),dataLabels:{enabled:!1}},options:{colors:T,legend:d(),style:b,rangeLegend:c()}},forceBubble:{plotOptions:{large:!1,displayNegative:!0,shadow:!0,minSize:12,maxSize:60,sizeBy:"area",opacity:1,tooltip:i(),dataLabels:{formatter:{identifier:"{SERIES}"},enabled:!1,align:"inside"}},options:{colors:T,legend:d(),zoom:h(),rangeLegend:c()}},areaMap:{plotOptions:{color:"#cccccc",opacity:.75,borderColor:"#ffffff",borderWidth:1,borderOpacity:1,tooltip:s(),dataLabels:{formatter:{identifier:"${NAME}"},enabled:!1,align:"inside"}},options:{colors:T,title:l(),rangeLegend:u(),legend:d(),dTools:{style:{fontFamily:"Microsoft Yahei",color:"#b2b2b2",fontSize:"0.75rem",fontWeight:""},currentColor:"#62b2ef",backgroundColor:"white",enabled:!1}}},pointMap:{plotOptions:{opacity:1,icon:{iconUrl:"../../doc/example/marker-icon.png",iconSize:[25,41]},dataLabels:{formatter:{identifier:"${NAME}"},enabled:!1,align:"outside"},tooltip:s()},options:{colors:T,title:l(),rangeLegend:u(),legend:d(),dTools:{style:{fontFamily:"Microsoft Yahei",color:"#b2b2b2",fontSize:"0.75rem",fontWeight:""},currentColor:"#62b2ef",backgroundColor:"white",enabled:!1}}},heatMap:{plotOptions:{maxOpacity:1,minOpacity:0,radius:15,blur:.15},options:{colors:T,title:l(),rangeLegend:u(),legend:d()}},lineMap:{plotOptions:{lineWidth:.5,curveness:.3,mouseOverColor:"rgb(253,221,49)",opacity:1},options:{colors:T,title:l(),rangeLegend:u(),legend:d()}}};return t}function i(){return{formatter:{identifier:"${CATEGORY}${SERIES}${VALUE}"},enabled:!0,animation:!0,follow:!1,backgroundColor:"rgba(0,0,0,0.5)",borderColor:null,borderWidth:0,borderRadius:2,shadow:!0,hideDelay:500,shared:!1,padding:5}}function n(){return x.merge(i(),{formatter:{enabled:!1}},!0)}function r(){return x.merge(i(),{formatter:{identifier:"${SERIES}${X}${Y}${SIZE}"}},!0)}function a(){return x.merge(i(),{formatter:{identifier:"${SERIES}${VALUE}"}},!0)}function o(){return x.merge(i(),{formatter:{identifier:"${NAME}${SERIES}${VALUE}",shared:!0}},!0)}function s(){return x.merge(i(),{formatter:{identifier:"${NAME}${SERIES}${VALUE}${SIZE}",shared:!0}},!0)}function l(){return{align:"center",backgroundColor:null,borderRadius:0,floating:!1,x:0,y:0,text:null,style:{color:"#333333",fontSize:"1.375rem",fontFamily:"Verdana"},useHtml:!1}}function h(){return{zoomType:"xy",zoomTool:{enabled:!1,resize:!0}}}function u(){return{visible:!0,enabled:!0,borderColor:"#cccccc",borderWidth:0,hiddenColor:"#cccccc",hoverColor:"#293C55",style:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"},position:"right",floating:!1,x:0,y:0,layout:"vertical",continuous:!0,margin:10}}function c(){return x.merge(u(),{enabled:!1},!0)}function d(){return{visible:!0,enabled:!1,hiddenColor:"#cccccc",hoverColor:"#293C55",borderRadius:0,borderColor:"#cccccc",borderWidth:0,backgroundColor:null,style:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"},position:"right",floating:!1,layout:"vertical",x:0,y:0,shadow:!1,margin:10}}function f(){return{type:"category",position:"bottom",onZero:!1,reversed:!1,title:{text:null,align:"center",rotation:0,useHtml:!1,style:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"}},lineWidth:1,lineColor:"#cccccc",showArrow:!1,enableTick:!0,enableMinorTick:!1,minorTickColor:"#cccccc",minorTickWidth:1,minorTickLength:2,tickColor:"#cccccc",tickWidth:1,tickLength:4,tickPadding:6,gridLineWidth:0,gridLineColor:"#dddddd",showLabel:!0,labelStyle:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"},labelRotation:0,useHtml:!1}}function p(){return{type:"value",position:"left",onZero:!1,reversed:!1,title:{text:null,align:"center",rotation:0,useHtml:!1,style:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"}},lineWidth:0,lineColor:"#cccccc",showArrow:!1,enableTick:!1,enableMinorTick:!1,minorTickColor:"#cccccc",minorTickWidth:1,minorTickLength:2,tickColor:"#cccccc",tickWidth:1,tickLength:4,tickPadding:6,gridLineWidth:1,gridLineColor:"#dddddd",showLabel:!0,labelStyle:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"},labelRotation:0,useHtml:!1}}function g(){return x.merge(f(),{type:"value"},!0)}function m(){return x.merge(p(),{type:"category"},!0)}function v(){return{type:"category",lineWidth:1,lineColor:"#cccccc",gridLineWidth:1,gridLineColor:"#dddddd",showLabel:!0,labelStyle:{color:"#666666",fontFamily:"Verdana",fontSize:"0.875rem"},labelRotation:0,useHtml:!1}}function y(){return x.merge(v(),{type:"value"},!0)}var _=t("../Constants"),x=t("../utils/QueryUtils"),T=(t("../utils/BaseUtils"),["#63b2ee","#76da91","#f8cb7f","#f89588","#7cd6cf","#9192ab","#7898e1","#efa666","#eddd86","#9987ce"]),b="gradual";return e}),i("VanChart",["require","./utils/BaseUtils","./utils/QueryUtils","./utils/Class","./VanChartLayout","./ComponentLibrary","./ChartLibrary","./Constants","./HammerHandler","./vector/SvgRenderer","./vector/VmlRenderer","./component/TrendLine","./theme/config"],function(t){var e=t("./utils/BaseUtils"),i=t("./utils/QueryUtils"),n=t("./utils/Class"),r=t("./VanChartLayout"),a=t("./ComponentLibrary"),o=t("./ChartLibrary"),s=t("./Constants"),l=t("./HammerHandler"),h=t("./vector/SvgRenderer"),u=t("./vector/VmlRenderer"),c=t("./component/TrendLine"),d=250,f=500,p=250,g=5,m=[a.X_AXIS_COMPONENT,a.Y_AXIS_COMPONENT,a.ANGLE_AXIS_COMPONENT],v=n.extend({vanChartType:"vanChart",initialize:function(t,i,n){this.wrapDom=i,this.width=e.getDomWidth(i),this.height=e.getDomHeight(i),isNaN(+this.width)||isNaN(+this.height)||(i=this._initLeafLet?this._initLeafLet(i,t):i,this.dom=i,this.vancharts=n,this.handler=new l(this,i),this.renderer=e.isSupportSVG()?new h(i,this):new u(i,this),this.series=[],this.components={},this._changeDataState=!1,this.fullScreenChart=null,this._initIntermediateState(),e.extend(this,c),this.refresh(t))},_initIntermediateState:function(){this.colorMap={},this.orderMap={},this.cateMap={},this.scale=1,this.timeQueue=this.clearTimeQueue(),this.clipPool={},this.axisSize={left:0,right:0,bottom:0,top:0},this.parentPoint=null},_getAllMoreLabelAnimationTime:function(){return d+f+p},getShowMoreLabelTime:function(){return this._changeDataState===!0&&e.hasDefined(this.options.moreLabel)?this._getAllMoreLabelAnimationTime():0},_removeChangeDataState:function(t){this._changeDataState&&(this._changeDataSeries=this._changeDataSeries||[],this._changeDataSeries.push(t),this._changeDataSeries.length>=this.series.length&&(this._changeDataState=!1,this._changeDataSeries=[]))},refresh:function(t){return t&&t.plotOptions?(t.animation=t.plotOptions.animation&&e.isSupportSVG(),this._init(t),this._originSeries&&this._originSeries(),this._refreshOptions(),void(this.fullScreenChart&&this.fullScreenChart.setData(t))):(this.bounds=e.makeBounds(0,0,0,0),void this.vancharts.endLoading())},refreshRestore:function(){var t=this,e=t.components;m.forEach(function(i){e[i]&&t._restoreCategoryAxisBasedSeries(e[i])});var i=this.seriesOfType(s.GAUGE_CHART);i.length==this.series.length&&this.series.sort(function(t,e){return t.index-e.index}),this.seriesOfType(s.PIE_CHART).forEach(function(t){var e=t.points.map(function(t){return t.graphic}),i={};t.options.data.forEach(function(t,e){i[t.x]=e}),t.points.sort(function(t,e){return i[t.x]-i[e.x]}),t.points.forEach(function(t,i){t.graphic=e[i]})});var n=this.seriesOfType(s.MULTIPIE_CHART);n.length&&n[0].orderData(null),this._refreshOptions()},orderData:function(){var t=this,e=t.components;m.forEach(function(i){e[i]&&t._orderCategoryAxisBasedSeries(e[i])});var i=this.orderType==s.ASCENDING,n=i?1:-1,r=this.seriesOfType(s.GAUGE_CHART);r.length==this.series.length&&this.series.sort(function(t,e){var i=t.getSeryTotalValue(),r=e.getSeryTotalValue();return(i-r)*n}),this.seriesOfType(s.PIE_CHART).forEach(function(t){var e=t.points.filter(function(t){return t.visible}).map(function(t){return t.graphic});t.points.sort(function(t,e){return i?t.y-e.y:e.y-t.y});var n=0;t.points.forEach(function(t){t.visible&&(t.graphic=e[n],++n)})});var o=this.seriesOfType(s.MULTIPIE_CHART);o&&o.length&&o[0].orderData(i),this.reRenderSeries(),m.concat([a.ZOOM_COMPONENT,a.DATA_SHEET_COMPONENT,a.POLAR_COMPONENT]).forEach(function(t){e[t]&&e[t].render()})},_restoreCategoryAxisBasedSeries:function(t){for(var i=0,n=t.getAxisCount();n>i;i++){var r=t.getAxis(i),a=r.series;if(r._isBaseAxis()&&r.isCategory()&&this.orderMap&&Object.keys(this.orderMap).length){var o=this.orderMap[r.componentType][i],s={};o.forEach(function(t,e){s[t]=e});for(var l=r._dataDomain,h=0,u=a.length;u>h;h++){var c=[],d=a[h],f=!0;d.points.forEach(function(t){c[e.indexInArray(l,t.category)]=t.graphic,t.graphic||(f=!1)}),d.points.forEach(function(t){t.graphic=f?c[s[t.category]]:t.graphic,d.updatePointGraphic(t)})}}}},_orderCategoryAxisBasedSeries:function(t){for(var i=this.orderType==s.ASCENDING?1:-1,n=0,r=t.getAxisCount();r>n;n++){var a=t.getAxis(n);if(this.orderMap[a.componentType]=this.orderMap[a.componentType]||[],this.orderMap[a.componentType][n]||(this.orderMap[a.componentType][n]=a._dataDomain),a._isBaseAxis()&&a.isCategory()){for(var o=a.series,l=[],h=o[0].points,u=0,c=h.length;c>u;u++){var d=h[u],f=0;d.points.forEach(function(t){t.visible&&t.series.visible&&(f+=Math.abs(t.getTargetValue()))}),l.push({key:d.category,value:f})}l.sort(function(t,e){return(t.value-e.value)*i});var p={},g=[];l.forEach(function(t,e){p[t.key]=e,g.push(t.key)});for(var m=a.getOriginalCategories(),u=0,c=o.length;c>u;u++){var v=[],y=o[u],_=!0;y.points.forEach(function(t){v[e.indexInArray(m,t.category)]=t.graphic,t.graphic||(_=!1)}),y.points.forEach(function(t){t.graphic=_?v[p[t.category]]:t.graphic,y.updatePointGraphic(t)})}a.setCategories(g)}}},_refreshOptions:function(){this._initIntermediateState();for(var t,i,n=this.options,r=this,l=n.series,h=n.chartType,u=a.getRegisteredComponents(),c=a.ComponentsOrder,d=0,f=c.length;f>d;d++){if(t=c[d],i=u[t],t==a.RANGE_LEGEND_COMPONENT&&n[t]){var p=n[t].continuous?a.GradientRangeLegend:a.INTERVAL_RANGE_LEGEND;this.components[t]&&this.components[t].type!=p&&(this.components[t].remove(),this.components[t]=null),i=a.get(p)}if(i){var g=n[t]&&(e.hasNotDefined(n[t].enabled)||n[t].enabled);g||t!=a.TOOLBAR_COMPONENT||(g=!0,n[t]={enabled:!0,hidden:!1}),n[t]&&g?this.components[t]?this.components[t].refresh(n[t],r):this.components[t]=new i(n[t],t,r):this.components[t]&&(this.components[t].remove(),this.components[t]=null,delete this.components[t])}}var m,v={},y=[];r.series.forEach(function(t){v[t.name+t.type]=t}),l.forEach(function(t,i){m=t.type||h;var n=e.pick(t.name,"Series"+m+i)+m,a=v[n],s=o.get(m);a=a?a.refresh(t,i):new s(t,r,i),y.push(a),v[n]=null});for(var _ in v)v[_]&&v[_].remove();r.series=y;var x=this.components[a.GAUGE_AXIS_COMPONENT];x&&x.initAttributesWithSeries();var T=this.components[a.RANGE_LEGEND_COMPONENT];T&&T.initAttributesWithSeries(),y.forEach(function(t){if(t.type!==s.LINE_MAP||!t.large)for(var e=0,i=t.points.length;i>e;e++)t.points[e].refreshPointColor()}),r.layoutComponentsAndCharts()},layoutComponentsAndCharts:function(){this.hoverPoint=this.hoverSeries=null,r.PLANE_SYSTEM_LAYOUT(this),this.render()},_getDefaultBounds:function(){var t=this.options&&this.options.padding||g,i=this.options&&this.options.borderWidth||0;return t=i+t,e.makeBounds(t,t,Math.max(this.width-2*t,0),Math.max(this.height-2*t,0))},reRenderWholePlot:function(){r.reLayoutPlotBounds(this),r.calculateSeries(this),r.calculateSeriesShapes(this),this.render()},dealAxisZoom:function(t,e){var i=this.options.zoom.zoomType,n=this.components.xAxis,r=this.components.yAxis;n&&-1!==i.indexOf("x")&&n.axisZoom(t,e),r&&-1!==i.indexOf("y")&&r.axisZoom(t,e),this.reRenderWholePlot()},cancelLegendHighlight:function(){this.highlightTarget=null,this._updateSeriesStyle()},makeLegendHighlight:function(t){this.highlightTarget=t,this._updateSeriesStyle()},_updateSeriesStyle:function(){this.series.forEach(function(t){t.isSupportLegendHighlight()&&(t.useCanvas()?t._canvasRender():(t._updateSeriesGraphicStyle(),t.getDataToDraw().forEach(function(e){t._updatePointGraphicStyle(e)})))})},reRenderSeries:function(){r.calculateSeries(this),r.calculateSeriesShapes(this),this.renderSeries()},isSupportAnimation:function(){return this.options.animation},_init:function(t){if(t.series=t.series||[],t.series.forEach(function(t){t.data=t.data||[]}),this._mergeThemeConfig(t),t.chartType==s.SCATTER_CHART||t.chartType==s.BUBBLE_CHART){var e=t.tools.sort||{};e.enabled=!1}t.plotOptions.inverted&&t.dataSheet&&(t.dataSheet.enabled=!1),this.options=t},_mergeThemeConfig:function(n){var r=t("./theme/config")(),a={};n.series.forEach(function(t){var o=t.type||n.chartType,l=r[o].plotOptions;if(o==s.GAUGE_CHART){var h=t.style||n.plotOptions.gauge&&n.plotOptions.gauge.style||n.plotOptions.style;h="pointer_semi"==h?"pointer":h,l=r.gauge[h];var u=["seriesLabel","valueLabel","percentageLabel"];u.forEach(function(n){e.hasDefined(t[n])&&i.merge(t[n],l[n],!1)})}a[o]||(a[o]=!0,i.merge(n,r[o].options,!1),n.plotOptions[o]?n.plotOptions[o]=i.merge(n.plotOptions[o],l,!1):n.plotOptions=i.merge(n.plotOptions,l,!1))}),this.isMap()&&(n.xAxis=n.yAxis=n.zoom=void 0),n.chartType==s.RADAR_CHART&&(n.polar=n.polar||{}),n.tooltip=n.tooltip||{}},getPlotBackgroundOption:function(){var t=this.options;return{backgroundColor:t.plotBackgroundColor,backgroundImage:t.plotBackgroundImage,borderColor:t.plotBorderColor,borderWidth:t.plotBorderWidth,borderRadius:t.plotBorderRadius,shadow:t.plotShadow}},getChartBackgroundOption:function(){var t=this.options,e=this.options.geo;return{backgroundColor:e?"":t.backgroundColor,backgroundImage:e?"":t.backgroundImage,borderColor:t.borderColor,borderWidth:e?0:t.borderWidth,borderRadius:t.borderRadius,shadow:t.shadow}},getMinMaxFromSeries:function(){var t=this,e=t.isMap(),i=t.series,n=Number.MAX_VALUE,r=-n;return i.forEach(function(t){for(var i,a,o=t.type,l=t.points,h={},u=o==s.BUBBLE_CHART,c=0,d=l.length;d>c;c++)if(i=l[c],!(i.isNull||u&&!i.displayNegative&&i.getTargetValue()<0)){if(a=t.getPointValue4MinMax(i),e&&i.lnglat){if(h[i.lnglat.join("-")])continue;h[i.lnglat.join("-")]=!0}n=Math.min(a,n),r=Math.max(a,r)}}),n>r&&(n=0,r=100),[n,r]},getParentDom:function(){return this.dom},getDivParentDom:function(){return this.wrapDom},isInverted:function(){return!!this.getOptions().plotOptions.inverted},setPlotBounds:function(t){this.bounds=t},getPlotClipBounds:function(){var t=0,e=0,i=this.bounds.width,n=this.bounds.height,r={},a=[];return this.components.xAxis&&(a=a.concat(this.components.xAxis._axisList)),this.components.yAxis&&(a=a.concat(this.components.yAxis._axisList)),a.forEach(function(t){var e=t.getPosition();t.isOnZero()||r[e]||(r[e]=t.getLineWidth())}),e=r[s.TOP]?Math.ceil(r[s.TOP]/2):0,n-=e,n=r[s.BOTTOM]?n-Math.ceil(r[s.BOTTOM]/2-.5):n,t=r[s.LEFT]?Math.ceil(r[s.LEFT]/2):0,i-=t,i=r[s.RIGHT]?i-Math.ceil(r[s.RIGHT]/2):i,{x:t+this.bounds.x,y:e+this.bounds.y,width:Math.max(i,0),height:Math.max(n,0)}},getPlotBounds:function(){return this.bounds},getChartBounds:function(){return e.makeBounds(0,0,this.width,this.height)},xAxis:function(t){t||(t=0);var e=this.components.xAxis;return e?e.getAxis(t):null},yAxis:function(t){t||(t=0);var e=this.components.yAxis;return e?e.getAxis(t):null},polar:function(t){t||(t=0);var e=this.components.polar;return e?e.getAxis(t):null},angleAxis:function(t){t||(t=0);var e=this.components.angleAxis;return e?e.getAxis(t):null},radiusAxis:function(t){t||(t=0);var e=this.components.radiusAxis;return e?e.getAxis(t):null},gaugeAxis:function(t){t||(t=0);var e=this.components.gaugeAxis;return e?e.getAxis(t):null},getSharedAxis:function(){for(var t=[this.xAxis(),this.yAxis(),this.angleAxis()],e=0;e<t.length;e++){var i=t[e];if(i&&i.isCategory())return i}return null},getComponent:function(t){return this.components[t]},getOptions:function(){return this.options},getDefaultSeriesColor:function(t){if(t+="",!this.colorMap[t]){var e=this.options.colors,i=0;for(var n in this.colorMap)++i;this.colorMap[t]=e[i%e.length]}return this.colorMap[t]},registerPointsPara:function(t){if(e.hasDefined(t.category)){var i=this.cateMap;i[t.category]=i[t.category]||[],i[t.category].push(t),t.points=i[t.category]}},getValidPointsPara:function(t,e){var i=this.cateMap[t]||e&&e.points||[];return i&&i.length?i.filter(function(t){return t._hasEvents(t)&&t.tooltip&&t.tooltip.shared&&t.visible&&t.series.visible}):[]},getSharedPoints:function(t,e){var i=this.cateMap[t]||e&&e.points||[];return i&&i.length?i.filter(function(t){return t.tooltip&&t.tooltip.shared}):[]},render:function(){this.vancharts.endLoading();var t=this,e=this.renderer,i=this.getPlotClipBounds();this.plotClip?e.updateClip(this.plotClip,i):this.plotClip=e.createClip(i),this._renderBackground(),this.renderComponents(a.ComponentsOrder,function(t){return!t.isFloat}),t.clipSeriesGroup||e.clip(t.clipSeriesGroup=e.group().add(),t.plotClip),t.seriesGroup||(t.seriesGroup=e.group().add()),t.seriesTextRenderGroup||e.clip(t.seriesTextRenderGroup=e.group().add(),t.plotClip),t.seriesTextDivGroup||(t.seriesTextDivGroup=e.div().add()),t.seriesTextDivGroup.style({clip:"rect("+[i.y,i.x+i.width,i.y+i.height,i.x].join("px ")+"px)"}),this.renderSeries(),this.renderComponents(a.ComponentsOrder,function(t){return t.isFloat}),this._consoleDone()},_consoleDone:function(){window.console&&console.log("done")},renderComponents:function(t,e){e=e||function(){return!0},t.map(function(t){if(t in this.components){var i=this.components[t];e(i)&&i.render()}},this),t.map(function(t){if(t in this.components){var i=this.components[t];e(i)&&i.renderSpecial&&i.renderSpecial()}},this)},renderSeries:function(){this.getComponent(a.TOOLTIP_COMPONENT).immediateHide();for(var t=0,e=this.series.length;e>t;t++)this.series[t].render();this._renderTrendLine(),this._updateSeriesState()},_renderBackground:function(){var t=e.makeBounds(0,0,this.width,this.height),i=this.getChartBackgroundOption(),n=this.getPlotBounds(),r=this.getPlotBackgroundOption();this.chartBackgroundGroup||(this.chartBackgroundGroup=this.renderer.group().add(),this.plotBackgroundGroup=this.renderer.group().add()),i.shadow&&(t.width-=5,t.height-=5),this._renderRectangleBackground(this.chartBackgroundGroup,i,t),this._renderRectangleBackground(this.plotBackgroundGroup,r,n)},_renderRectangleBackground:function(t,i,n){var r=i.borderWidth||0,a=this.renderer,o=r/2,s=e.rectSubPixelOpt(n.x+o,n.y+o,Math.max(n.width-r,0),Math.max(n.height-r,0),r);if(s.rx=s.ry=i.borderRadius,i.shadow){var l=e.rectSubPixelOpt(n,1),h=[5,3,1],u=[.05,.1,.15];h.forEach(function(e,n){var r="shadowRect"+n;t[r]=t[r]||a.rect().style({fill:"none",stroke:"black","stroke-width":h[n],"stroke-opacity":u[n]}).addTo(t),t[r].attr(l).attr({rx:i.borderRadius,ry:i.borderRadius,transform:"translate(1, 1)"})})}if(i.backgroundColor&&"object"==typeof i.backgroundColor)if(e.isSupportSVG()){var c=i.backgroundColor,d={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2},f={offset:"0%","stop-color":c.startColor},p={offset:"100%","stop-color":c.endColor};t.gradientFill?a.updateColorGradient(t.gradientFill,d,[f,p]):t.gradientFill=a.colorGradient(d,[f,p])}else i.backgroundColor=i.backgroundColor.startColor;(i.backgroundColor||i.borderWidth)&&(t.backgroundColor=t.backgroundColor||a.rect().addTo(t),t.backgroundColor.attr(s).style({fill:i.backgroundColor?"string"==typeof i.backgroundColor?i.backgroundColor:"url(#"+e.stamp(t.gradientFill)+")":"none",stroke:i.borderColor,"stroke-width":e.pick(i.borderWidth,0)})),i.backgroundImage&&(t.backgroundImage=t.backgroundImage||a.image().addTo(t),t.backgroundImage.attr(n).attr("preserveAspectRatio","none").imageContent(i.backgroundImage))},filterRender:function(){for(var t=0,e=this.series.length;e>t;t++)this.series[t].filterRender()},showTooltip:function(t,e,i){this.handler.selectRect||this.components[a.TOOLTIP_COMPONENT].showWithPoint(t,e,i)},hideTooltip:function(){this.hoverPoint=null,this.components[a.TOOLTIP_COMPONENT].hide()},set:function(t){"enable"in t&&this.handler&&(t.enable?this.handler.hammer.set({enable:!0}):(this.handler.hammer.set({enable:!1}),this.handler.removeAllChosen()))},_updateSeriesState:function(){for(var t=this.series,e=0,i=t.length;i>e;e++)t[e].state=t[e].state==s.STATE_TO_DROP?s.STATE_DROPPED:t[e].state,t[e].state=t[e].state==s.STATE_TO_SHOW?s.STATE_SHOW:t[e].state},isMap:function(){return"vanChartMap"==this.vanChartType},chartType:function(){return this.options.chartType},isHeatMap:function(){return this.options.chartType==s.HEAT_MAP},isAreaMap:function(){return this.options.chartType==s.AREA_MAP},isForceBubble:function(){return"vanChartForceBubble"==this.vanChartType},isLargeMode:function(){return this.options.plotOptions.large},seriesOfType:function(t){return this.series.filter(function(e){return e.type==t})},pointsOfType:function(t){var e=[];return this.series.forEach(function(i){i.type==t&&(e=e.concat(i.points))}),e},setTimeout:function(t,e,i){this.timeQueue[t]&&window.clearTimeout(this.timeQueue[t]),i?this.timeQueue[t]=window.setTimeout(e,i):(e&&e(),this.timeQueue[t]=null)},clearTimeQueue:function(){var t=this.timeQueue||{};return Object.keys(t).map(function(e){window.clearTimeout(t[e])}),{}},removePointGraphics:function(t){t&&t.remove()},remove:function(){var t=this;t.series&&t.series.forEach(function(e){e.points&&e.points.forEach(function(e){t.removePointGraphics(e)})}),this.clearTimeQueue(),this.renderer&&this.renderer.remove(),this._leaflet&&this._leaflet.remove(),this.handler&&this.handler.destroy(),this.mainRenderer&&this.mainRenderer.remove(),this.animationRenderer&&this.animationRenderer.remove(),this.mainRenderer=null,this.animationRenderer=null,this.renderer=this.plotClip=this._leaflet=this.handler=this.chartBackgroundGroup=this.trendLineGroup=this.seriesGroup=this.clipSeriesGroup=this.seriesTextRenderGroup=this.seriesTextDivGroup=null},resize:function(){this._leaflet&&this._leaflet._onResize();var t=this.wrapDom;if(this.width=e.getDomWidth(t),this.height=e.getDomHeight(t),!isNaN(+this.width)&&!isNaN(+this.height)){if(this.renderer.resize(),this.isMap()){this._layoutMapComponents();var i=this.getCurrentGeo();i&&i.fitMapBounds()}else r.fixCoordinateSystem(this);this.render()}}});return v}),i("utils/Formatter",["require","./BaseUtils"],function(t){function e(t,e){return e=i.getFormatterFunction(e),e?e.bind(t)(t):t}var i=t("./BaseUtils");return{format:e}}),i("chart/Point",["require","../utils/QueryUtils","../utils/BaseUtils","../utils/ColorUtils","../utils/Formatter","../Constants","../ComponentLibrary","../dom/Evented"],function(t){var e=t("../utils/QueryUtils"),i=t("../utils/BaseUtils"),n=t("../utils/ColorUtils"),r=(t("../utils/Formatter"),t("../Constants")),a=t("../ComponentLibrary"),o=t("../dom/Evented"),s=o.extend({initialize:function(t,e){this.series=e,this.refresh(t||{})},refresh:function(t){this.options=t;var o=this._getQueryList(),s=this.series,l=s.vanchart;if(s.type===r.LINE_MAP&&s.large)return s._refreshPoint&&s._refreshPoint(this,o),this.visible=!0,this.seriesName=this.series.name,void(this.tooltip=e.queryList(o.concat([l.options]),"tooltip"));var h=this.series.type==r.BAR_CHART?t.y:t.x,u=this.series.name,c=this.series.isSeriesAccumulated(),d=e.queryList(o,"borderColor"),f=e.queryList(o,"borderOpacity");if(d){var p=n.getStandardColorAndOpacity(d,f);d=p.hex,f=p.alpha}var g=e.queryList(o,"lnglat"),m=t.x,v=s[s.getBaseAxisType()];if(v&&v.type==a.VALUE_AXIS_COMPONENT&&(m=+m),i.extend(this,{x:m,y:t.y,size:t.size,value:t[this.series.getTargetKey()],category:c?u:h,seriesName:c?h:u,name:t.name||t.x||"",className:t.name||""+u+(g||[]).join("-"),visible:i.pick(e.queryList(o,"visible"),!0),hyperlink:e.queryList(o,"hyperlink"),jsonHyperlink:e.queryList(o,"jsonHyperlink"),drillUpLink:e.queryList(o,"drillUpLink"),click:e.queryList(o,"click"),drilldown:e.queryList(o,"drilldown"),shadow:e.queryList(o,"shadow"),displayNegative:e.queryList(o,"displayNegative"),maxSize:t.maxSize,minSize:t.minSize,sizeBy:e.queryList(o,"sizeBy"),lnglat:g,borderWidth:e.queryList(o,"borderWidth"),borderRadius:e.queryList(o,"borderRadius"),borderColor:d,borderOpacity:f,image:e.queryList(o,"image"),imageWidth:e.queryList(o,"imageWidth"),imageHeight:e.queryList(o,"imageHeight"),icon:e.queryList(o,"icon"),dataLabels:e.queryList(o,"dataLabels"),tooltip:e.queryList(o.concat([l.options]),"tooltip"),style:e.queryList(o,"style")||l.options.style,effect:e.queryList(o,"effect")}),i.convertToREMUseDefault16PX(this.dataLabels&&this.dataLabels.style),i.convertToREMUseDefault16PX(this.tooltip&&this.tooltip.style),s.isNullValue)this.isNull=s.isNullValue(this);else{var y=this[s.getTargetKey()];this.isNull="-"==y||i.hasNotDefined(y)}if(s._refreshPoint&&s._refreshPoint(this,o),c?this.points=s.points:l.registerPointsPara(this),this.visible&&(this.graphic&&!this.graphic.ctx&&this.graphic.style("display","inline"),this.effectGraphic&&this.effectGraphic.style({display:"inline"}),this.textGraphic&&this.textGraphic.style({display:"inline"})),this.drilldown&&this.drilldown.geo){var _=a.get(a.GEO_COMPONENT);this.geo=new _(this.drilldown.geo,a.GEO_COMPONENT,l)}},refreshPointColor:function(){this.visible=!0;var t=this,r=t.series,a=r.vanchart,o=t._getQueryList();if(!r.isTreeSeries()){var s=this._getColorAndMarkerColor(r,a,e.queryList(o,"opacity")),l=i.clone(e.queryList(o,"marker"));i.hasDefined(l)&&(l.fillColor=s.markerColor,l.fillColorOpacity=s.markerOpacity,l.radius=isNaN(l.radius)?4.5:l.radius,l.symbol=l.symbol||r.marker&&r.marker.symbol||"");var h,u,c=s.color,d=e.queryList(o,"mouseOverColor");i.hasNotDefined(c)?this.visible=!1:(d=d||n.getHighLightColor(c),h=n.getClickColor(c),u=.95*s.opacity),i.extend(this,{marker:l,mouseOverColor:d,clickColor:h,clickOpacity:u,color:c,opacity:s.opacity})}},_getColorAndMarkerColor:function(t,e,o){var s=o,l=o,h=t.isSeriesAccumulated()?i.pick(this.options.x,this.options.name):t.name,u=e.getDefaultSeriesColor(h),c=u,d=e.options.plotOptions,f=d[t.type],p=f&&f.marker||d.marker;i.hasDefined(p)&&(c=p.fillColor||c),t.type==r.AREA_MAP&&this.isNull&&(u=d.color);var g=e.getComponent(a.RANGE_LEGEND_COMPONENT);g&&(u=g.getColorWithSize(this[t.getTargetKey()]),c=u),u=t.options.color||u,c=t.options.color||c;var m=t.options.marker;i.hasDefined(m)&&(c=m.fillColor||c),u=this.options.color||u,c=this.options.color||c;var v=this.options.marker;if(i.hasDefined(v)&&(c=v.fillColor||c),t._refreshPointColor&&(u=t._refreshPointColor(this,u)),i.hasDefined(u)){var y=n.getStandardColorAndOpacity(u,o);u=y.hex,s=y.alpha}if(i.hasDefined(c)){var y=n.getStandardColorAndOpacity(c,o);c=y.hex,l=y.alpha}return{color:u,opacity:s,markerColor:c,markerOpacity:l}},getTargetValue:function(){var t=this[this.series.getTargetKey()];return isNaN(+t)?0:+t},getLatLng:function(t){var e=this.lnglat;if(!e){var i=this.series.vanchart.getCurrentGeo();t||(t=i.getFeaturesByName(this.name,this.series.type),t=t&&t[0]),t&&(e=i.getDataPointLngLat(this,t))}return e?[e[1],e[0]]:null},remove:function(){clearInterval(this.effectInterval),this.visible=!1,this.graphic&&this.graphic.remove(),this.textGraphic&&this.textGraphic.remove(),this.leadLine&&this.leadLine.remove(),this.moreLabelG&&this.moreLabelG.remove(),this.effectGraphic&&this.effectGraphic.remove(),this.graphic=this.textGraphic=this.moreLabelG=this.effectGraphic=this.leadLine=null;
},_getQueryList:function(){return[this.options].concat(this.series._getQueryList())},_hasEvents:function(t){return t&&t.visible&&!t.isNull},_onPointMouseOver:function(t){var e=this,n=this.series,r=n.vanchart,a=r.renderer,o=r.hoverPoint,s=r.hoverSeries,l=r.hoverPoints,h=r.getSharedAxis();if((e.tooltip&&e.tooltip.follow||o!==e)&&e._hasEvents(e))if(o&&o!=e&&o._onPointMouseOut.call(o,t),e.tooltip&&e.tooltip.shared&&e.points){var u=r.getValidPointsPara(e.category,e),c=u.reduce(function(e,n){n.series.onPointMouseOver.call(n,t);var r=n;if(r._events||r.getEvents&&r.on(r.getEvents(),r),r.series.defaultMarker){var o=r.series.defaultMarker;a._targets[i.stamp(o.node())]=o,a._targets[i.stamp(o)]=r}return e?n.getTargetValue()>e.getTargetValue()?n:e:n},0);l&&l.length&&l[0]!=u[0]&&l[0]._onPointMouseOut.call(l[0],t),h&&h.drawHighlightBackground(u),n.vanchart.showTooltip(c,t,r.getSharedPoints(e.category,e)[0]),r.hoverPoints=u}else n.onPointMouseOver.call(e,t),n.vanchart.showTooltip(e,t),s!=e.series&&(s&&s.fire("seriesUnChosen",t),e.series.fire("mouseover",t)),r.hoverSeries=e.series,r.hoverPoint=e},_onPointMouseOut:function(t){var e=this,i=this.series;e._hasEvents(e)&&(e.tooltip&&e.tooltip.shared&&e.points&&e.points.length?e.points.map(function(e){e.graphic&&e.series.onPointMouseOut.call(e,t),e.series.fire("seriesUnChosen",t)}):i.onPointMouseOut.call(e,t),i.vanchart.hideTooltip())},_onPointTap:function(t){var e=this,n=this.series;e._hasEvents(e)&&(n.onPointTap.call(e,t),e.onClick(t.srcEvent),i.hasTouch()&&e.fire("mouseover",t))},_onPointPress:function(t){var e=this,i=this.series,n=i.vanchart,r=n.hoverPoint;r&&i.onPointPress.call(e,t)},_onPointPressUp:function(t){var e=this,i=this.series,n=i.vanchart,r=n.hoverPoint;r&&(i.onPointPressUp.call(e,t),r._onPointTap(t))},onClick:function(t){var e=this;if(e.click)e.click.call(e,t);else if(e.hyperlink){t=t.touches?t.touches.length?t.touches[0]:t.changedTouches[0]:t;var i=e.hyperlink;i&&window.FR&&FR.doHyperlink(t,new Function("return "+i)(),!0)}},getTooltipRect:function(){var t=this.series.vanchart.getComponent(a.TOOLTIP_COMPONENT);return t?t._tooltipRect:void 0},getEvents:function(){return this.series.pointEvents?this.series.pointEvents():{mouseover:this._onPointMouseOver,mouseout:this._onPointMouseOut,mousemove:this.series.onPointMouseMove,tap:this._onPointTap,press:this._onPointPress,pressup:this._onPointPressUp}}});return s}),i("utils/BezierEasing",[],function(){function t(t,e){return 1-3*e+3*t}function e(t,e){return 3*e-6*t}function i(t){return 3*t}function n(n,r,a){return((t(r,a)*n+e(r,a))*n+i(r))*n}function r(n,r,a){return 3*t(r,a)*n*n+2*e(r,a)*n+i(r)}function a(t,e,i,r,a){var o,s,l=0;do s=e+(i-e)/2,o=n(s,r,a)-t,o>0?i=s:e=s;while(Math.abs(o)>u&&++l<c);return s}function o(t,e,i,o){function s(e,a){for(var o=0;l>o;++o){var s=r(a,t,i);if(0===s)return a;var h=n(a,t,i)-e;a-=h/s}return a}function u(){for(var e=0;d>e;++e)v[e]=n(e*f,t,i)}function c(e){for(var n=0,o=1,l=d-1;o!=l&&v[o]<=e;++o)n+=f;--o;var u=(e-v[o])/(v[o+1]-v[o]),c=n+u*f,p=r(c,t,i);return p>=h?s(e,c):0===p?c:a(e,n,n+f,t,i)}function g(){y=!0,(t!=e||i!=o)&&u()}if(4!==arguments.length)throw new Error("BezierEasing requires 4 arguments.");for(var m=0;4>m;++m)if("number"!=typeof arguments[m]||isNaN(arguments[m])||!isFinite(arguments[m]))throw new Error("BezierEasing arguments should be integers.");if(0>t||t>1||0>i||i>1)throw new Error("BezierEasing x values must be in [0, 1] range.");var v=p?new Float32Array(d):[],y=!1,_=function(r){return y||g(),t===e&&i===o?r:0===r?0:.001>1-r?1:n(c(r),e,o)};_.getControlPoints=function(){return[{x:t,y:e},{x:i,y:o}]};var x=[t,e,i,o],T="BezierEasing("+x+")";return _.toString=function(){return T},_}var s=this,l=4,h=.001,u=1e-7,c=10,d=11,f=1/(d-1),p="Float32Array"in s;return o.css={ease:o(.25,.1,.25,1),linear:o(0,0,1,1),"ease-in":o(.42,0,1,1),"ease-out":o(0,0,.58,1),"ease-in-out":o(.42,0,.58,1),"ease-in-out-quad":o(.455,.03,.515,.955),swing:o(.02,.01,.47,1),"ease-in-quart":o(.895,.03,.685,.22),"ease-out-back":o(.175,.885,.32,1.275),"ease-out-quart":o(.165,.84,.44,1),"ease-in-quint":o(.755,.05,.855,.06),"ease-out-quint":o(.23,1,.32,1),"ease-in-quad":o(.55,.085,.68,.53),"ease-out-quad":o(.25,.46,.45,.94)},o}),i("vector/Cut",["require","../utils/BezierEasing"],function(t){var e=t("../utils/BezierEasing"),i=function(t){if(!t)throw'animation "targets" empty';null==t.length?this.targets=[t]:this.targets=t,this._needsRemove=!1,this._lastSectionTime=null,this._sections=[],this.onend=null};return i.prototype={step:function(t){this._lastSectionTime||(this._lastSectionTime=t);var e=t-this._lastSectionTime,i=this.targets,n=this._sections[0],r=Math.min(e/n.time,1);if(!(!r>0)){n.easing&&(r=n.easing(r));for(var a=n.props,o=i.length,s=0;o>s;s++)for(var l in a)a.hasOwnProperty(l)&&(i[s][l]=a[l][s](r));return 1===r&&(this._lastSectionTime=t,this._sections.shift(),0===this._sections.length)?(this._needsRemove=!0,"end"):void 0}},_fillProps:function(t){return this.targets.map(function(e){return t(e)})},delay:function(t){return this._sections.push({time:t,props:{}}),this},duration:function(t){return this._sections.push({time:t,props:{}}),this},tween:function(t,e){var i=this._sections.length,n=this._sections[i-1].props;return"function"==typeof e?n[t]=this._fillProps(e):n[t]=this._fillProps(function(i){var n=i[t];return function(t){return n+(e-n)*t}}),this},end:function(t){return this.onend=t,this},stop:function(){return this._needsRemove=!0,this},ease:function(t){var i=this._sections.length;return this._sections[i-1].easing="string"==typeof t?e.css[t]:t,this}},i}),i("vector/Animation",["require","./Cut"],function(t){var e=t("./Cut"),i=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,16)},n=function(){this._initTime=null,this._running=!1,this._cuts=[],this._callback=[],this.onframe=null,this.onend=null};return n.prototype={_update:function(){var t=(new Date).getTime(),e=this._cuts,i=e.length;if(!e.length)return!1;for(var n=0;i>n;)e[n]._needsRemove?(e[n]=e[i-1],e.pop(),i--):n++;for(var n=0;i>n;n++){var r=e[n].step(t);r&&e[n]["on"+r]&&this._callback.push(e[n]["on"+r])}this.onframe&&this.onframe();for(var a,n=-1;a=this._callback[++n];)a();return this._callback=[],!0},_startLoop:function(){function t(){e._running&&(e._running=e._update(),i(t))}var e=this;i(t)},frame:function(t){return this.onframe=t,this},start:function(){return this._running||(this._running=!0,this._startLoop()),this},stop:function(){return this._running=!1,this},clear:function(){return this._running=!1,this._cuts=[],this},animate:function(t){var i=new e(t);return i.animation=this,this._cuts.push(i),this.start(),i}},n}),i("dom/Browser",["require"],function(t){var e=navigator.userAgent.toLowerCase(),i=document.documentElement,n="ActiveXObject"in window,r=-1!==e.indexOf("webkit"),a=-1!==e.indexOf("phantom"),o=-1!==e.search("android [23]"),s=-1!==e.indexOf("chrome"),l=-1!==e.indexOf("gecko")&&!r&&!window.opera&&!n,h="undefined"!=typeof orientation||-1!==e.indexOf("mobile"),u=!window.PointerEvent&&window.MSPointerEvent,c=window.PointerEvent||u,d=n&&"transition"in i.style,f="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!o,p="MozPerspective"in i.style,g="OTransition"in i.style,m=!window.L_NO_TOUCH&&(c||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);return{ie:n,ielt9:n&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:r,gecko:l,android:-1!==e.indexOf("android"),android23:o,chrome:s,safari:!s&&-1!==e.indexOf("safari"),ie3d:d,webkit3d:f,gecko3d:p,opera12:g,any3d:!window.L_DISABLE_3D&&(d||f||p)&&!g&&!a,mobile:h,mobileWebkit:h&&r,mobileWebkit3d:h&&f,mobileOpera:h&&window.opera,mobileGecko:h&&l,touch:!!m,msPointer:!!u,pointer:!!c,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1}}),i("vector/shape/Arc",["require","../../utils/BaseUtils","../../dom/Browser"],function(t){var e=t("../../utils/BaseUtils"),i=t("../../dom/Browser").touch,n=i?10:2,r=2*Math.PI,a=Math.max,o=Math.atan2,s=Math.abs,l=Math.sqrt,h=e.normalRadian,u=function(t){this.renderer=t,this.ctx=t.ctx,this.cut=null,this.style={ox:null,oy:null,r:null,startAngle:null,endAngle:null,lineWidth:null,color:null,fillStyle:"rgba(0, 0, 0, 0)"}};return u.prototype={setStyle:function(t){for(var e in this.style)t.hasOwnProperty(e)&&(this.style[e]=t[e]);return this},drawStyle:function(){var t=this.ctx,e=this.style;return(e.lineWidth&&e.lineWidth!==t.lineWidth||e.color&&e.color!==t.strokeStyle)&&(t.stroke(),t.beginPath(),t.lineWidth=e.lineWidth,t.strokeStyle=e.color),e.fillStyle&&e.fillStyle!==t.fillStyle&&(t.fill(),t.fillStyle=e.fillStyle),this},draw:function(){var t=this.ctx,e=this.style;return e.lineWidth?(t.moveTo(e.ox+e.r*Math.cos(e.startAngle),e.oy+e.r*Math.sin(e.startAngle)),t.arc(e.ox,e.oy,e.r,e.startAngle,e.endAngle),this):this},animate:function(){return this.cut||(this.cut=this.renderer.animation.animate(this.style)),this},delay:function(t){return this.cut.delay(t),this},duration:function(t){return this.cut.duration(t),this},tween:function(t,e){return this.cut.tween(t,e),this},end:function(t){return this.cut.end(t),this},stop:function(){return this.cut.stop(),this},ease:function(t){return this.cut.ease(t),this},remove:function(){this.cut&&this.cut.stop(),this.needToRemove=!0},contain:function(t){var e=t[0],i=t[1],u=this.style,c=a(u.lineWidth,n),d=e-u.ox,f=i-u.oy,p=s(l(d*d+f*f)-u.r);if(p>c)return!1;var g=h(o(f,d));return(g+r-u.startAngle)%r<=u.endAngle-u.startAngle}},u}),i("vector/shape/Circle",["require"],function(t){var e=2*Math.PI,i=function(t){this.renderer=t,this.ctx=t.ctx,this.cut=null,this.style={ox:null,oy:null,r:null,lineWidth:null,strokeStyle:null,fillStyle:null}};return i.prototype={setStyle:function(t){for(var e in this.style)t.hasOwnProperty(e)&&(this.style[e]=t[e]);return this},drawStyle:function(){var t=this.ctx,e=this.renderer,i=this.style;return(i.lineWidth&&i.lineWidth!==t.lineWidth||i.strokeStyle&&i.strokeStyle!==t.strokeStyle)&&(t.stroke(),t.lineWidth=i.lineWidth,t.strokeStyle=i.strokeStyle),i.fillStyle&&i.fillStyle!==e.fillStyle&&(t.fill(),t.beginPath(),t.fillStyle=i.fillStyle,e.fillStyle=i.fillStyle),this},draw:function(){var t=this.ctx,i=this.style;return t.moveTo(i.r+i.ox,i.oy),t.arc(i.ox,i.oy,i.r,0,e),this}},i}),i("vector/shape/Image",["require"],function(t){var e=function(t){this.renderer=t,this.ctx=t.ctx,this.cut=null,this.style={imagedata:null,dx:null,dy:null,dirtyX:null,dirtyY:null,dirtyWidth:null,dirtyHeight:null}};return e.prototype={setStyle:function(t){for(var e in this.style)t.hasOwnProperty(e)&&(this.style[e]=t[e]);return this},drawStyle:function(){return this},draw:function(){var t=this.style;return this.ctx.putImageData(t.imagedata,t.dx,t.dy),this}},e}),i("vector/CanvasRenderer",["require","./Renderer","../Constants","./Animation","./shape/Arc","./shape/Circle","./shape/Image"],function(t){var e=t("./Renderer"),i=t("../Constants"),n=t("./Animation"),r=t("./shape/Arc"),a=t("./shape/Circle"),o=t("./shape/Image"),s=["lineWidth","strokeStyle"],l=e.extend({_initContainerDom:function(t,e,i){var r=i||e.getPlotBounds(),a=i&&i.dpr||1;this.dom=this._createCanvas(t,r,a),this.ctx=this.dom.getContext("2d"),this.ctx.scale(a,a),this.elements=[],this.animation=(new n).frame(this.flush.bind(this))},arc:function(t){return this._create(r,t)},circle:function(t){return this._create(a,t)},image:function(t){return this._create(o,t)},_create:function(t,e){var i=new t(this);return i.rawElement=i,this.elements.push(i),e&&i.setStyle(e),i},style:function(){},_createCanvas:function(t,e,i){var n=document.createElement("canvas"),r=this.left=e.x,a=this.top=e.y,o=this.width=e.width,s=this.height=e.height;return this.dpr=i,n.style.position="absolute",n.style.left=r+"px",n.style.top=a+"px",n.style.width=o+"px",n.style.height=s+"px",n.width=o*i,n.height=s*i,n.onselectstart=function(){return!1},n.style["-webkit-user-select"]="none",n.style["user-select"]="none",n.style["pointer-events"]="none",n.style["-webkit-touch-callout"]="none",n.style.transform="translateZ(0)",t.appendChild(n),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(n),n},flush:function(){this.clearAll(),this.ctx.beginPath();for(var t=this.elements,e=t.length,i=[],n=0;e>n;n++)t[n].needToRemove||(i.push(t[n]),t[n].drawStyle().draw());this.elements=i,this.ctx.stroke(),this.ctx.fill()},_updateCtxStatus:function(){for(var t,e,i=-1;t=s[++i];)this[t]!==this.ctx[t]&&(this[t]=this.ctx[t],e=!0);e&&this.ctx.stroke(),this.fillStyle!==this.ctx.fillStyle&&(this.fillStyle=this.ctx.fillStyle,this.ctx.fill())},clearAll:function(){this.ctx.clearRect(0,0,this.width,this.height)},remove:function(){this.animation.clear(),this.ctx=null,this.dom.parentNode&&this.dom.parentNode.removeChild(dom)},addBubbleSeries:function(t){var e=this.ctx;e.save();for(var i=0,n=t.points.length;n>i;i++){var r=t.points[i];r.visible&&!r.isNull&&(e.fillStyle=r.color,e.globalAlpha=this.getPointOpacity(r),e.beginPath(),e.arc(r.posX,r.posY,r.radius,0,2*Math.PI),e.fill())}e.restore()},getPointOpacity:function(t){var e=t.series,i=e.vanchart.highlightTarget;if(i){var n=e.name;return n==i||t._rangeItem==i?1:.3}return t.opacity},addScatterSeries:function(t){var e=this.ctx;e.save();for(var i=0,n=t.points.length;n>i;i++){var r=t.points[i];if(r.visible&&!r.isNull){var a=r.marker.symbol,o=isNaN(r.marker.radius)?4.5:r.marker.radius,s=r.marker.fillColor||r.color;e.translate(r.posX,r.posY),e.fillStyle=s,e.strokeStyle=s,e.globalAlpha=this.getPointOpacity(r),this._drawMarker(e,a,o),e.translate(-r.posX,-r.posY)}}e.restore()},addSeries:function(t){t.visible&&(t.type==i.SCATTER_CHART?this.addScatterSeries(t):this.addBubbleSeries(t))},_drawMarker:function(t,e,n){-1!=e.indexOf(i.CIRCLE)?(t.beginPath(),t.arc(0,0,n,0,2*Math.PI)):-1!=e.indexOf(i.SQUARE)?(t.beginPath(),t.moveTo(-n,-n),t.lineTo(n,-n),t.lineTo(n,n),t.lineTo(-n,n),t.closePath()):-1!=e.indexOf(i.DIAMOND)?(n=2*n/Math.sqrt(2),t.beginPath(),t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()):-1!=e.indexOf(i.TRIANGLE)?(t.beginPath(),t.moveTo(-n,n/Math.sqrt(3)),t.lineTo(0,-(2*Math.sqrt(3)/3)*n),t.lineTo(n,n/Math.sqrt(3)),t.closePath()):(t.beginPath(),t.arc(0,0,n,0,2*Math.PI)),-1==e.indexOf("hollow")?t.fill():(t.fillStyle="white",t.lineWidth=2,t.fill(),t.stroke())}});return l}),i("chart/Series",["require","../utils/BaseUtils","../utils/QueryUtils","../utils/ColorUtils","../Constants","./Point","../dom/Evented","../utils/Formatter","../utils/BezierEasing","../ComponentLibrary","../vector/CanvasRenderer"],function(t){var e=t("../utils/BaseUtils"),i=t("../utils/QueryUtils"),n=t("../utils/ColorUtils"),r=t("../Constants"),a=t("./Point"),o=t("../dom/Evented"),s=t("../utils/Formatter"),l=t("../utils/BezierEasing"),h=t("../ComponentLibrary"),u=t("../vector/CanvasRenderer"),c="{SERIES}",d="{X}",f="{Y}",p="{SIZE}",g="{NAME}",m="{CATEGORY}",v="{VALUE}",y="{PERCENT}",_=2,x=250,T=500,b=250,A=[.9,.85,.8,.75,.7,.65,.6,.55,.5],L="right-top",C="right-bottom",P="left-top",M="left-bottom",E=(2*Math.PI,Math.PI/180),w=600,O="quad-out",S=o.extend({initialize:function(t,e,i){this.vanchart=e,this.points=[],this.refresh(t,i)},refresh:function(t,o){this.options=t;var s=this.vanchart,l=t.type||s.options.chartType,h=e.pick(t.name,"Series"+l+o),u=this._getQueryList(l),c=e.pick(i.queryList(u,"visible"),!0);if(!this.isSeriesAccumulated()){var d=this.options.color||s.getDefaultSeriesColor(h),f=i.queryList(u,"opacity");if(e.hasDefined(d)){var p=n.getStandardColorAndOpacity(d,f);d=p.hex,f=p.alpha}var g=i.queryList(u,"fillColor");g=g===!0?d:g;var m=i.queryList(u,"fillColorOpacity");if(m=isNaN(m)?this._getDefaultFillColorOpacity():m,g){var p=n.getStandardColorAndOpacity(g,m);g=p.hex,m=p.alpha}var v=e.clone(i.queryList(u,"marker"));if(e.hasDefined(v)){var y=this._getMarkerColorAlpha(s,l,h,i.queryList(u,"opacity"));v.fillColor=y.markerColor,v.fillColorOpacity=y.markerOpacity}}if(e.extend(this,{type:l,name:h,index:o,className:"vancharts-series-"+o,visible:c,state:c?r.STATE_SHOW:r.STATE_DROPPED,stack:i.queryList(u,"stack"),stackByPercent:i.queryList(u,"stackByPercent"),style:i.queryList(u,"style")||s.options.style,large:i.queryList(u,"large"),trendLine:i.queryList(u,"trendLine"),bands:i.queryList(u,"bands"),image:i.queryList(u,"image"),animation:i.queryList(u,"animation")&&s.options.animation,marker:v,icon:i.queryList(u,"icon"),color:d,opacity:f,fillColor:g,fillColorOpacity:m,effect:i.queryList(u,"effect")}),this._bindAxis(),this._refresh(o),this._loadData)var _=this._loadData(t.data);else var _=t.data||[];var x=[],T=this,b={};this.points.forEach(function(t){var e=T._getPointKey(t);b[e]=b[e]||[],b[e].push(t)});for(var A=0,L=_.length;L>A;A++){var C=T._getPointKey(_[A]),P=b[C],M=null;if(P){for(var E=0,w=P.length;w>E;E++)if(M=P[E]){P[E]=null;break}M&&(M._lastValue=M[T.getTargetKey()],M.drillSeries=null,M.geo=null,M.moreLabelG&&M.moreLabelG.remove(),M.moreLabelG=null,M.refresh(_[A]))}M||(M=new a(_[A],this)),x.push(M)}for(var C in b)b[C]&&b[C].forEach(function(t){s.removePointGraphics(t,l)});return this.sort&&(x=x.filter(function(t){return!t.isNull}).sort(function(t,e){return Math.abs(e.getTargetValue())-Math.abs(t.getTargetValue())})),this.points=x,this},_getPointKey:function(t){return t.x},_getDefaultFillColorOpacity:function(){return 1},getStackAxis:function(){return this[this.getTargetKey()+"Axis"]},_getMarkerColorAlpha:function(t,i,r,a){var o=t.options.plotOptions,s=o[i],l=s&&s.marker||o.marker,h=this.options.marker,u=h&&h.fillColor||this.options.color||l&&l.fillColor||t.getDefaultSeriesColor(r),c=a;if(e.hasDefined(u)){var d=n.getStandardColorAndOpacity(u,a);u=d.hex,c=d.alpha}return{markerColor:u,markerOpacity:c}},_bindAxis:function(){var t=this,e=t.options,i=t.vanchart;t._getAxisTypes().forEach(function(n){if(i[n]){var r=i[n](e[n]);r&&(r.series.push(t),t[n]=r)}})},_getAxisTypes:function(){return["xAxis","yAxis"]},getTargetKey:function(){return"y"},getBaseAxisType:function(){return"xAxis"},getPointValue4MinMax:function(t){return t.getTargetValue()},_getQueryList:function(t){t=t||this.type;var e=this.vanchart.options.plotOptions;return[this.options,e[t],e]},_getBandsColor:function(t){var i=this.bands,n=this.getTargetKey();if(i){i=e.isArray(i)?i:[i];for(var r=0,a=i.length;a>r;r++){var o=i[r];if(o.axis){var s="x"==o.axis?this.xAxis:this.yAxis,l=s.getValueFromData(t.options),h=o.from,u=o.to;s.isCategory()&&(l=s.indexOfLabel(l),h=h?s.indexOfLabel(h):h,u=u?s.indexOfLabel(h):u);var c=e.hasDefined(h)?l>=h:!0,d=e.hasDefined(u)?u>=l:!0;if(c&&d)return o.color}else{var h=Math.min(o.from,o.to),u=Math.max(o.from,o.to);if(t[n]>=h&&t[n]<=u)return o.color}}if(o=i[0],o&&t[n]<=Math.min(o.from,o.to))return o.color;if(o=i[i.length-1],o&&t[n]>=Math.max(o.from,o.to))return o.color}},_calculateAutoLabelPos:function(t,i,n,r){function a(t,n,a,o){for(var s=t;0>a?s>n:n>s;s+=a){var l={x:i.x,y:s};if(!r.isOverlapped(e.makeBounds(l,o)))return l}}function o(t,n,a,o){for(var s=t;0>a?s>n:n>s;s+=a){var l={x:s,y:i.y};if(!r.isOverlapped(e.makeBounds(l,o)))return l}}var s,l=3,h=t.labelDim,u=this.vanchart.getPlotBounds();if(n){var c,d;c=Math.max(0,i.y),d=u.height-h.height,s=a(c,d,l,h),s||(d=0,c=Math.min(i.y,u.height-h.height),s=a(c,d,-l,h))}else{var f,p;f=Math.max(0,i.x),p=u.width-h.width,s=o(f,p,l,h),s||(p=0,f=Math.min(i.x,u.width-h.width),s=o(f,p,-l,h))}return s?s:i},getTooltipPos:function(t,e,i){var n;if(t.tooltip.follow){var r=i.containerPoint,a=r[0]||r.x,o=r[1]||r.y;n=[a+10,o+10]}else n=this._getFixedPos(t,e);if(n){var s=this.vanchart.getChartBounds(),l=s.y,h=s.x,u=s.y+s.height,c=s.x+s.width,d=n[0],f=n[1];return h>d?d+=h-d:d+e.width>c&&(d-=d+e.width-c),l>f?f+=l-f:f+e.height>u&&(f-=f+e.height-u),[d,f]}},_getArcPoint:function(t,e){return[this._dealWithFloat(t*Math.sin(e)),this._dealWithFloat(-t*Math.cos(e))]},_getNormalTrendLineXYValues:function(t){var e=[],i=[],n=this.vanchart.isInverted()?"posY":"posX",a=this.vanchart.isInverted()?r.LEFT:r.BOTTOM;return t.points.sort(function(t,e){return t[n]-e[n]}),t.points.forEach(function(t){t.isNull||(e.push(t.posX),i.push(t.posY))}),[e,i,a]},_getSeriesInterpolate:function(t){var e=i.queryList(t,"step"),n=i.queryList(t,"curve"),r=this.options,a="linear";return r.step||e&&!r.curve?a="step-after":(r.curve||n&&!r.step)&&(a="cardinal"),a},calculateMapLabel:function(t,i){if(!t||t.isNull||!i||!i.enabled)return t.labelContent=t.labelDim=null,{};var n=i.formatter,a=i.useHtml,o=t.series.type,l=o==r.SCATTER_CHART||o==r.POINT_MAP?r.OUTSIDE:r.INSIDE,h=[];if("object"==typeof n){var u=n.identifier;if(-1!=u.indexOf(g)){var d=s.format(t.name,n.nameFormat),f=t.series.getCategorySeriesStyle(i,l,t),m=e.getTextDimension(d,f,a);h.push({text:d,style:f,dim:m})}var _="",x=-1!=u.indexOf(c),T=-1!=u.indexOf(v)||-1!=u.indexOf(p),b=-1!=u.indexOf(y),A=s.format(t.seriesName,n.seriesFormat),L=s.format(t.getTargetValue(),n.valueFormat),C=s.format(t.percentage,n.percentFormat);if(x&&(_+=A,(T||b)&&(_+=":")),T&&(_+=L,b&&(_+=" ")),b&&(_+=C),_){var f=t.series.getValuePercentageStyle(i,l,t),m=e.getTextDimension(_,f,a);h.push({text:_,style:f,dim:m})}}else t.series.pushCustomLabelContent(t,n,i,a,h,l);var P=t.series.calculateTextDim(h);return{labelContent:h,labelDim:P}},calculateLabelInfo:function(t){if(this.vanchart.isMap())return void e.extend(t,this.calculateMapLabel(t,t.dataLabels));var i=t.dataLabels,n=this.calculateFormatterContent(t,i);e.extend(t,{labelContent:n,labelDim:this.calculateTextDim(n)})},calculateFormatterContent:function(t,e){if(!t||t.isNull||!e||!e.enabled)return[];var i=e.formatter,n=e.useHtml,r=[];return"object"==typeof i?this.pushNormalLabelContent(t,i,e,n,r):this.pushCustomLabelContent(t,i,e,n,r),r},_createMultiLineLabelContent:function(t,i){if(!t)return[];if("object"==typeof t){var n=[],r=t.identifier,a=s.format(i.category,t.categoryFormat),o=s.format(i.seriesName,t.seriesFormat),l=s.format(i[this.getTargetKey()],t.valueFormat),h=s.format(i.percentage,t.percentFormat);return-1!=r.indexOf(m)&&n.push(a),-1!=r.indexOf(c)&&n.push(o),-1!=r.indexOf(v)&&n.push(l),-1!=r.indexOf(y)&&n.push(h),n}return[e.getFormatterFunction(t).call(i)]},pushNormalLabelContent:function(t,e,i,n,r){return this._pushNormalLabelContent(t,e,i,n,r)},_pushNormalLabelContent:function(t,i,n,a,o){function l(t){return t.map(h).filter(u)}function h(e){return-1!==p.indexOf(e)?s.format(t[_[e][0]],i[_[e][1]]):null}function u(t){return null!==t}function d(i,o,s){if(o.length){var l=o.join(r.BLANK_VALUE_PERCENTAGE),h=s(n,null,t),u=e.getTextDimension(l,h,a);i.push({text:l,style:h,dim:u})}}var f=this,p=i.identifier,_={};_[g]=["name","nameFormat"],_[m]=["category","categoryFormat"],_[c]=["seriesName","seriesFormat"],_[v]=[this.getTargetKey(),"valueFormat"],_[y]=["percentage","percentFormat"];var x=[g,m,c],T=[v,y],b=f.getCategorySeriesStyle,A=f.getValuePercentageStyle;this.type===r.TREEMAP_CHART&&(T.unshift(x.shift()),A=b),d(o,l(x),b),d(o,l(T),A)},pushCustomLabelContent:function(t,i,n,r,a,o){var s="";try{s=e.getFormatterFunction(i).call(t)}catch(l){}var h=this.getValuePercentageStyle(n,o,t),u=e.getTextDimension(s,h,r);n.useHtml&&(u.width=isNaN(parseFloat(n.labelWidth))?u.width:parseFloat(n.labelWidth),u.height=isNaN(parseFloat(n.labelHeight))?u.height:parseFloat(n.labelHeight)),a.push({text:s,style:h,dim:u})},calculateTextDim:function(t){var e=0,i=0;if(t&&t.length){for(var n=0,r=t.length;r>n;n++){var a=t[n].dim;e=Math.max(e,a.width),i+=a.height}i+=(r-1)*_}return{width:e,height:i}},_labelUseSeriesColor:function(t){return t==r.OUTSIDE||t==r.TOP||t==r.BOTTOM},getCategorySeriesStyle:function(t,i,n){if(n=n||this,t&&t.style)return t.style;var a=i||(n.series&&n.series.columnType?r.INSIDE:t.align||r.OUTSIDE),o=a===r.OUTSIDE?.1:.15;return e.convertToREMUseDefault16PX({color:n.series._labelUseSeriesColor(a)?n.marker&&n.marker.fillColor||n.color:"#ffffff",fontSize:"0.75rem",fontFamily:"Verdana",textShadow:"1px 1px 1px rgba(0,0,0,"+o+")",fontWeight:"bold"})},getValuePercentageStyle:function(t,i,n){if(n=n||this,t&&t.style)return t.style;var a=i||(n.series&&n.series.columnType?r.INSIDE:t.align||r.OUTSIDE);return e.convertToREMUseDefault16PX({fontSize:"0.75rem",fontFamily:"Verdana",textShadow:"1px 1px 1px rgba(0,0,0,0.15)",color:n.series._labelUseSeriesColor(a)?n.marker&&n.marker.fillColor||n.color:"#ffffff"})},pushBubbleNormalLabelContent:function(t,i,n,r,a,o){var l=i.identifier;if(-1!=l.indexOf(c)){var h=s.format(t.seriesName,i.seriesFormat),u=this.getCategorySeriesStyle(n,o,t),g=e.getTextDimension(h,u,r);a.push({text:h,style:u,dim:g})}if(-1!=l.indexOf(d)||-1!=l.indexOf(f)||-1!=l.indexOf(p)){var m=this._getXYSizeString(t,i,l),v=this.getValuePercentageStyle(n,o,t),y=e.getTextDimension(m,v,r);a.push({text:m,style:v,dim:y})}},_getXYSizeString:function(t,e,i){var n=s.format(t.x,e.XFormat),a=s.format(t.y,e.YFormat),o="-"==t.size?"-":s.format(t.size,e.sizeFormat),l="";return(-1!=i.indexOf(d)||-1!=i.indexOf(f))&&(l="(",-1!=i.indexOf(d)?(l+=n,-1!=i.indexOf(f)&&(l=l+","+a),l+=")"):(l+=a,l+=")"),l+=r.BLANK_VALUE_PERCENTAGE),-1!=i.indexOf(p)&&"-"!=o&&(l+=o),l},calculateTooltipContent:function(t){return this._calculateTooltipContent(t)},_calculateBubbleTooltipContent:function(t){var i=t.tooltip,n=this;if(i&&i.enabled){var r=i.formatter,a="";if("object"==typeof r){var o=i.style,s=r.identifier;a+=n._createBubbleTooltipSeriesLine(t,s,o,r),a+=n._createBubbleTooltipXYSizeLine(t,s,o,r)}else a=e.getFormatterFunction(r).call(t);return a}},_calculateTooltipContent:function(t){var i=t.tooltip,n=this,r=t.points;if(i&&i.enabled){var a=i.formatter,o="";if("object"==typeof a){var s=i.style,l=a.identifier,u="vanChartMap"==this.vanchart.vanChartType,c=this.vanchart.getComponent(h.RANGE_LEGEND_COMPONENT);i.shared&&r&&r.length?(o+=this._createCategoryLine(t,l,s,a),r.filter(function(t){return t.visible&&t.series.visible&&!t.isNull&&t.tooltip&&t.tooltip.shared}).forEach(function(t){var i=u&&c?r[0].color:t.color,a=t.tooltip;o+='<span style="font-size:'+(e.isSupportSVG()?"0.75rem":"12px")+";font-style:normal; color: "+i+";opacity:"+t.opacity+'">&#9679  </span>',o+=n._createSeriesLine(t,l,s,a.formatter),o+="<br />"})):(o+=n._createCategoryLine(t,l,s,a),o+=n._createSeriesLine(t,l,s,a))}else o=e.getFormatterFunction(a).call(t);return o}},_createCategoryLine:function(t,i,n,a){var o="",l=t.series.type,h="vanChartMap"==this.vanchart.vanChartType;return l!=r.SCATTER_CHART||h?(l===r.MULTIPIE_CHART?-1!=i.indexOf(c)&&(o=s.format(t.seriesName,a.seriesFormat)):(-1!=i.indexOf(m)&&(o=s.format(t.category,a.categoryFormat)),-1!=i.indexOf(g)&&l!==r.WORD_CLOUD_CHART&&(o=s.format(t.name,a.nameFormat))),o&&(o=(n?"<span>":e.TOOLTIP_CATEGORY_STYLE)+o+"</span>",o+="<br />"),o):this._createBubbleTooltipSeriesLine(t,i,n,a)},_createSeriesLine:function(t,i,n,a){var o,l="",h=t.series.type,u="vanChartMap"==this.vanchart.vanChartType,d=s.format(t[this.getTargetKey()],a.valueFormat),f=s.format(t.percentage,a.percentFormat),m=-1!=i.indexOf(p)||-1!=i.indexOf(v);return h!=r.SCATTER_CHART||u?(h===r.MULTIPIE_CHART||h===r.WORD_CLOUD_CHART?-1!=i.indexOf(g)&&(o=s.format(t.name,a.nameFormat)):-1!=i.indexOf(c)&&(o=s.format(t.seriesName,a.seriesFormat)),o&&((m||-1!=i.indexOf(y))&&(o+=":"),l+=(n?"<span >":e.TOOLTIP_SERIES_STYLE)+o+"</span>"),m&&-1!=i.indexOf(y)?l+=(n?"<span>":e.TOOLTIP_VALUE_STYLE)+d+"  "+f+"</span>":m?l+=(n?"<span>":e.TOOLTIP_VALUE_STYLE)+d+"</span>":-1!=i.indexOf(y)&&(l+=(n?"<span>":e.TOOLTIP_VALUE_STYLE)+f+"</span>"),l):this._createBubbleTooltipXYSizeLine(t,i,n,a)},_createBubbleTooltipSeriesLine:function(t,i,n,r){var a="";if(-1!=i.indexOf(c)){var o=s.format(t.seriesName,r.seriesFormat);a+=(n?"<span >":e.TOOLTIP_SERIES_STYLE)+o+"</span>",a+="<br />"}return a},_createBubbleTooltipXYSizeLine:function(t,i,n,r){var a="";if(-1!=i.indexOf(d)||-1!=i.indexOf(f)||-1!=i.indexOf(p)){var o=this._getXYSizeString(t,r,i);a+=(n?"<span>":e.TOOLTIP_VALUE_STYLE)+o+"</span>"}return a},_calculateSingleLineLabelContent:function(t,i){if(!t)return"";if("object"==typeof t){var n="",r=t.identifier,a=s.format(i.category,t.categoryFormat),o=s.format(i.seriesName,t.seriesFormat);if((-1!=r.indexOf(m)||-1!=r.indexOf(c))&&(n+=-1!=r.indexOf(m)&&-1!=r.indexOf(c)?a+" "+o:-1!=r.indexOf(m)?a:o),!i.isNull&&-1!=r.indexOf(v)||-1!=r.indexOf(y)){e.isEmpty(n)||(n+=":");var l=s.format(i[i.series.getTargetKey()],t.valueFormat),h=s.format(i.percentage,t.percentFormat);n+=-1!=r.indexOf(v)&&-1!=r.indexOf(y)?l+" "+h:-1!=r.indexOf(v)?l:h}return n}return e.getFormatterFunction(t).call(i)},_getAngle:function(t,e){return Math.atan2(t[1]-e[1],t[0]-e[0])/(Math.PI/180)},_getBackgroundColor:function(){var t=this.vanchart.options,e="string"==typeof t.plotBackgroundColor,i="string"==typeof t.backgroundColor,r=e?t.plotBackgroundColor:i?t.backgroundColor:"white";return n.colorToHex(r)},getFillFilter:function(t,e){return t},filterRender:function(){this.useCanvas()?this._canvasRender():this._svgFilterRender()},render:function(){this.useCanvas()?this._canvasRender():this._svgRender()},useCanvas:function(){return this.large&&(this.type==r.BUBBLE_CHART||this.type==r.SCATTER_CHART)},_createGroup:function(t,e){return t.group().addTo(e.clipSeriesGroup)},getSeryTotalValue:function(){var t=0;return this.points.forEach(function(e){t+=e.getTargetValue()}),t},_svgRender:function(){this.initialAnimationMoving=!this.group;var t=this.vanchart,i=t.renderer;this.group||(this.group=this._createGroup(i,t).style("cursor",this._pointerStyle()).attr("transform",e.makeTranslate(this._getTranslate())).attr("class",this.className+" "+this.type)),this.animation&&this.type==r.GAUGE_CHART?d3.select(this.group.node()).transition().duration(w).ease(O).attr("transform",e.makeTranslate(this._getTranslate())):this.group.attr("transform",e.makeTranslate(this._getTranslate())),this.drawSeries&&this.drawSeries(),this.drawPoints(),this.updateGraphics&&this.updateGraphics(),this._removeDataLabels();var n=this;t.setTimeout(n.className+"point_animate",function(){n._animateEnd()},n.animation?n._getAnimationTime():0)},_pointerStyle:function(){return this.points[0]&&this.points[0].hyperlink?"pointer":""},_isSeriesInteractive:function(){return!1},_svgFilterRender:function(){var t=this.visible,e=this;this.getDataToDraw().forEach(function(i){t&&i.visible?(i.graphic&&i.graphic.style({display:"inline"}),i.textGraphic||e._createTextGraphic(i),i.effectGraphic||e.drawPointEffect(i,i.series)):(i.graphic&&i.graphic.style({display:"none"}),i.effectGraphic&&i.effectGraphic.remove(),i.textGraphic&&i.textGraphic.remove(),i.textGraphic=i.effectGraphic=null)})},_canvasRender:function(){this._canvas||(this._canvas=new u(this.vanchart.dom,this.vanchart)),this._canvas.clearAll(),this._canvas.addSeries(this)},getEvents:function(){return{mouseover:this.onSeriesMouseOver,seriesUnChosen:this.onSeriesUnChosen,tap:this.onSeriesMouseOver}},onSeriesMouseOver:function(t){var i=this,n=i.vanchart,r=n.hoverSeries,a=n.hoverPoint,o=n.renderer;r!=i&&(r&&r.fire("seriesUnChosen",t),n.hoverSeries=i,i._onSeriesMouseOver&&i._onSeriesMouseOver());var s=i.getClosestPoint(t.containerPoint);if(!a||a.series==i&&a==s||a.fire("mouseout",t),s&&s!=a&&(s._events||s.getEvents&&s.on(s.getEvents(),s),s.fire("mouseover",t),s.series.defaultMarker)){var l=s.series.defaultMarker;o._targets[e.stamp(l.node())]=l,o._targets[e.stamp(l)]=s}},onSeriesUnChosen:function(t){this==this.vanchart.hoverSeries&&(this.vanchart.hoverSeries=null),this._onSeriesUnChosen&&this._onSeriesUnChosen(t)},_getAnimationTime:function(){switch(this.state){case r.STATE_SHOW:return this.getInitShowTime();case r.STATE_TO_SHOW:return this.getReAppearTime();case r.STATE_TO_DROP:return this.getDropTime();default:return 0}},getInitShowTime:function(){return 0},getReAppearTime:function(){return 0},getDropTime:function(){return 0},getDataToDraw:function(){return this.points},getTextDataToDraw:function(){return this.getDataToDraw()},updatePointGraphic:function(t){},_updateMarkerPointGraphic:function(t){var i=t.graphic,n=t.marker,r=n.symbol;i&&(e.isImageMarker(r)&&!i.image?(i.strokePath&&i.strokePath.remove(),i.fillPath&&i.fillPath.remove(),
i.markerPath&&i.markerPath.remove(),i.strokePath=i.fillPath=i.markerPath=null,this._createMarker(n,i)):!e.isImageMarker(r)&&i.image&&(i.image&&i.image.remove(),i.image=null,this._createMarker(n,i)))},drawPoints:function(){var t=this,e=t.vanchart,i=e.renderer,n=this._calculateAnimationDelay(),r=this._getPointGraphicGroup();this._isSeriesInteractive()&&i.registerInteractiveTarget(this,r),r._normalGroup=r._normalGroup||i.group(),r._effectGroup=r._effectGroup||i.group(),r._normalGroup.addTo(r),r._effectGroup.addTo(r),t.getDataToDraw().forEach(function(e){var i=e.effect&&e.effect.enabled?r._effectGroup:r._normalGroup;t.drawPoint(i,e,n)})},_drawEffectPoints:function(){var t=this;t.getTextDataToDraw().forEach(function(e){t.drawPointEffect(t,e)})},drawPointEffect:function(t,i){function n(){if(r){var e=i.graphic?i.graphic.node():null;t.effectAnimation(e,i)}}var r=t.visible&&i.visible&&!i.isNull;if(clearInterval(i.effectInterval),i.effectGraphic&&i.effectGraphic.remove(),i.effectGraphic=null,e.isSupportSVG()&&r&&i.effect&&i.effect.enabled){var a=t._getEffectTime(i);a&&(n(),i.effectInterval=setInterval(n,a))}},drawPoint:function(t,e,i){i=i||0;var n=e.series,r=n.vanchart,a=r.renderer,o=n.visible,s=n.animation,l=r.getComponent(h.RANGE_LEGEND_COMPONENT),u=n.getAttrs(e),c=o&&e.visible&&!e.isNull;c&&e.graphic&&!e.removed?(e.graphic.addTo(t),s?e.graphic.animate(n,n.updateAnimation,e,i):e.graphic.attr(u)):c?(e.graphic?(e.graphic.addTo(t),e.removed=!1):(n._createPointGraphic(e).addTo(t),n._updatePointGraphicStyle(e)),s?e.graphic.animate(n,n.createAnimation,e,i):e.graphic.attr(u)):c||!e.graphic||e.removed||(l?e.graphic.attr(u):(s?e.graphic.animate(n,n.dropAnimation,e,i):e.graphic.remove(),a.removeInteractiveTarget(e.graphic),e.removed=!0)),!e.removed&&e.graphic&&(n._updatePointGraphicStyle(e),a.registerInteractiveTarget(e,e.graphic)),clearInterval(e.effectInterval),e.effectGraphic&&e.effectGraphic.remove(),e.effectGraphic=null},_getEffectTime:function(t){return isNaN(t.effect.period)?t.series.getDefaultEffectTime():t.effect.period},_getPointEffectGroup:function(t){var e=t.series,i=e.vanchart.renderer;return t.effectGraphic=t.effectGraphic||i.group().addTo(e._getPointGraphicGroup()).style("pointer-events","none")},_createPointGraphic:function(t){var e=this.getPointGraphicKey(t),i=this.vanchart.renderer;return t.graphic=i[e](),t.graphic},getLegendKey:function(t){return this.isSeriesAccumulated()?t.name:this.name},_updateSeriesGraphicStyle:function(){this.drawSeries&&this.drawSeries();var t=this._getPointGraphicGroup();t&&(t._normalGroup&&t._normalGroup.addTo(t),t._effectGroup&&t._effectGroup.addTo(t))},_updatePointGraphicStyle:function(t){var e=this.getStyle(t),i=this.vanchart.highlightTarget;if(i&&this.isSupportLegendHighlight()){var n=this.getLegendKey(t),r=n==i||t._rangeItem==i?1:.3;e["fill-opacity"]=e["stroke-opacity"]=r}t.graphic&&t.graphic.style(e)},_createMarker:function(t,i){var n=t.symbol,a=t.radius,o=this.vanchart.renderer,i=i||o.group();if(e.isImageMarker(n)){var s=t.width,l=t.height;i.image=o.image({preserveAspectRatio:"none",x:-s/2,y:-l/2,width:s,height:l}).imageContent(n).addTo(i)}else{var h=this._isHollowMarker(n),u=this.type==r.LINE_CHART;h&&u?(i.strokePath=o.path({d:e.getMarkerPath(n,a+2)}).addTo(i),i.fillPath=o.path({d:e.getMarkerPath(n,a-1)}).addTo(i)):i.markerPath=o.path({d:e.getMarkerPath(n,a)}).addTo(i)}return i},_updateMarker:function(t,i,n){i=i||t.graphic,n=n||t.marker;var a=n.fillColorOpacity,o=this.vanchart.highlightTarget;if(o){var s=this.getLegendKey(t);a=s==o||t._rangeItem==o?1:.3}var l=n.symbol,h=this._getBackgroundColor();if(e.isImageMarker(l));else{var u=this._isHollowMarker(l),c=this.type==r.LINE_CHART;u&&c?(i.strokePath.style({fill:n.fillColor,"fill-opacity":a,stroke:h,"stroke-width":2}),i.fillPath.style({fill:h})):u?i.markerPath.style({stroke:n.fillColor,"stroke-opacity":a,"stroke-width":2,fill:h}):c?i.markerPath.style({fill:n.fillColor,"fill-opacity":a,"stroke-width":2,stroke:h}):i.markerPath.style({fill:n.fillColor,"fill-opacity":a})}},_onMarkerPressed:function(t){if(t.graphic){var i=t.marker,n=i.symbol,a=(t.series,{fill:t.clickColor,"fill-opacity":t.clickOpacity});if(!e.isImageMarker(n)){var o=this._isHollowMarker(n),s=this.type==r.LINE_CHART;o&&s?t.graphic.strokePath.style(a):t.graphic.markerPath.style(a)}}},_onMarkerMouseOver:function(t){if(t.graphic){var i=t.marker,n=i.symbol,a=(t.series.animation,i.radius+2);if(e.isImageMarker(n)){var o=i.width+4,s=i.height+4;t.graphic.image.attr({x:-o/2,y:-s/2,width:o,height:s})}else{var l=this._isHollowMarker(n),h=this.type==r.LINE_CHART;l&&h?(t.graphic.strokePath.attr({d:e.getMarkerPath(n,a+2)}),t.graphic.fillPath.attr({d:e.getMarkerPath(n,a-1)})):t.graphic.markerPath.attr({d:e.getMarkerPath(n,a)})}}else{var i=this._getDefaultMarker(t);t.series.vanchart.renderer;t.series.defaultMarker=t.series.defaultMarker||this._createMarker(i).addTo(this.group),t.series.defaultMarker.attr("transform",e.makeTranslate([t.posX,t.posY])),this._updateMarker(t,t.series.defaultMarker,i)}},_onMarkerMouseOut:function(t){var i=t.marker,n=i.symbol,a=(t.series.animation,i.radius);if(t.graphic)if(e.isImageMarker(n)){var o=i.width,s=i.height;t.graphic.image.attr({x:-o/2,y:-s/2,width:o,height:s})}else{var l=this._isHollowMarker(n),h=this.type==r.LINE_CHART;l&&h?(t.graphic.strokePath.attr({d:e.getMarkerPath(n,a+2)}),t.graphic.fillPath.attr({d:e.getMarkerPath(n,a-1)})):t.graphic.markerPath.attr({d:e.getMarkerPath(n,a)})}},_getDefaultMarker:function(t){return{symbol:r.CIRCLE,fillColor:t.marker.fillColor,fillColorOpacity:t.marker.fillColorOpacity,radius:4.5,enabled:!0}},_calculateAnimationDelay:function(){return 0},_isHollowMarker:function(t){return t&&-1!=t.indexOf("hollow")},_animateEnd:function(){this._showLabels(),this._drawEffectPoints()},_drawLabels:function(){var t=this,i=(t.vanchart,this.visible),n=t.animation;t.getTextDataToDraw().forEach(function(r){var a=i&&r.visible&&!r.isNull&&r.labelPos;if(a&&r.textGraphic){var o=r.labelPos.x,s=r.labelPos.y;r.dataLabels.useHtml?n?d3.select(r.textGraphic).transition().ease(l.css.swing).duration(250).style({left:o+"px",top:s+"px"}):(r.textGraphic.style.left=o+"px",r.textGraphic.style.top=s+"px"):n?d3.select(r.textGraphic.node()).transition().ease(l.css.swing).duration(250).attr("transform",e.makeTranslate([o,s])):r.textGraphic.attr("transform",e.makeTranslate([o,s])),r.labelPos.startPos&&(r.leadLine?r.leadLine.attr("d",t._getLeadLinePath(r)):r.leadLine=t._getLeadLine(r))}else a&&!r.textGraphic?t._createTextGraphic(r):!a&&r.textGraphic&&(r.textGraphic.remove(),r.leadLine&&r.leadLine.remove(),r.textGraphic=null,r.leadLine=null)})},_showLabels:function(){var t=this,e=t.vanchart;e.setTimeout(t.className+"more_label_animate",function(){if(e._removeChangeDataState(t),t._clearMoreLabels(),t._removeDataLabels(),t._updateDataLabels(),t.animation){var i=t._getPointTextLabelGroup();d3.select(i.node()).style("opacity",0).transition("linear").duration(400).style("opacity",1)}},e.getShowMoreLabelTime()),t._updateMoreLabels()},_updateMoreLabels:function(){var t=this,e=t.vanchart;0!==e.getShowMoreLabelTime()&&t.visible&&t.getTextDataToDraw().forEach(function(e){e.visible&&t._showAndExitMoreLabel(e)})},_clearMoreLabels:function(){this.getTextDataToDraw().forEach(function(t){t.moreLabelG&&t.moreLabelG.remove(),t.moreLabelG=null})},_getMoreLabelStyle:function(){var t=this.vanchart.options.moreLabel;return t.style||{fontFamily:"verdana",fontSize:"9pt"}},_showAndExitMoreLabel:function(t,i,r,a,o,s){if(0!==t.depth){var h=this,u=h.vanchart,c=u.renderer,d=h.animation,f=s||h.group,p=t._lastValue||0,g=e.accAdd(t[h.getTargetKey()],-p),m=u.options.moreLabel,v=0>g?m.minusColor||"#f4b145":m.plusColor||"#52d1b8";if(g>0)g="+"+g;else if(!(0>g))return;var y=h._getMoreLabelStyle(),_=e.getTextDimension(g,y);if(e.hasNotDefined(i)||e.hasNotDefined(r)){var A=h._getMoreLabelDefaultCenter(t,_);i=A.centerX,r=A.centerY,e.hasDefined(t.labelPos)&&e.hasDefined(t.labelDim)&&(i=t.labelPos.x+t.labelDim.width/2,r=t.labelPos.y+t.labelDim.height/2)}a&&(i=a(i,_.width)),o&&(r=o(r,_.height)),t.moreLabelG=c.text().addTo(f),d?d3.select(t.moreLabelG.node()).attr("dy",".32em").attr("text-anchor","middle").text(g).call(e.setTextStyle,y).style({fill:v}).attr("opacity",0).attr("x",i).attr("y",r+5).transition().duration(x).ease("back-out").attr("y",r).attrTween("opacity",function(){return function(t){return l.css.swing(t)}}).transition().delay(T).duration(b).ease("back-in").attr("y",r+5).attrTween("opacity",function(){return function(t){return 1-l.css.swing(t)}}):(y["white-space"]="nowrap",t.moreLabelG.textContent(g).attr("x",i-_.width/2).attr("y",r-_.height/2).style(y).style({color:n.colorToHex(v)}))}},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.x+t.width/2,centerY:t.y-e.height/2}},_updateDataLabels:function(){var t=this;t.getTextDataToDraw().forEach(function(e){t._createTextGraphic(e)})},_removeDataLabels:function(){var t=this;t.getTextDataToDraw().forEach(function(t){t.textGraphic&&(t.textGraphic.remove(),t.textGraphic=null),t.leadLine&&(t.leadLine.remove(),t.leadLine=null)})},_createTextGraphic:function(t){var i=this,n=function(t){return i.visible&&!t.isNull&&t.visible&&t.labelPos&&!isNaN(t.labelPos.x)&&!isNaN(t.labelPos.y)&&t.dataLabels&&t.dataLabels.enabled};if(n(t)){var a=i.vanchart,o=a.renderer,s=t.labelContent,l=t.labelPos.x,h=t.labelPos.y,u=t.dataLabels,c=u.useHtml,d=this._getPointTextLabelGroup(),f=o.vtext(c).attr("transform",e.makeTranslate([l,h])).style({"pointer-events":"none"});h=0;for(var p=0,g=s.length;g>p;p++){var m,v=s[p],y=v.dim,_=v.text,x=v.style;switch(t.dataLabels._align){case r.LEFT:m=0;break;case r.RIGHT:m=t.labelDim.width-y.width;break;case r.CENTER:default:m=(t.labelDim.width-y.width)/2}o.vtspan(c).style({width:u.labelWidth+"px",height:u.labelHeight+"px"}).attr("y",h).attr("x",0).attr("dy",.85*y.height).attr("dx",m).textContent(_).style(x).addTo(f),h+=y.height+2}t.textGraphic=d.append(f),t.labelPos.startPos&&(t.leadLine=d.append(this._getLeadLine(t)))}},_getLeadLine:function(t){return this.vanchart.renderer.path().attr("d",this._getLeadLinePath(t)).style({fill:"none",stroke:t.dataLabels.connectorColor||t.color,"stroke-width":t.dataLabels.connectorWidth||0})},_getLeadLinePath:function(t){var e=t.labelPos.startPos,i=t.labelPos.midPos,n=t.labelPos.endPos,r=this._dealWithFloat;return"M"+r(e.x)+","+r(e.y)+"L"+r(i.x)+","+r(i.y)+"L"+r(n.x)+","+r(n.y)},_dealWithFloat:function(t){return Math.abs(t)<1e-6?0:t},_getPointGraphicGroup:function(){return this.group},_getPointTextLabelGroup:function(){if(this.textGraphicGroup)this.textGraphicGroup.attr("transform",e.makeTranslate(this._getTranslate()));else{var t=this.vanchart,i=t.seriesTextRenderGroup,n=t.seriesTextDivGroup;this.textGraphicGroup=t.renderer.vgroup(),i.append(this.textGraphicGroup.renderG),n.append(this.textGraphicGroup.divG),this.textGraphicGroup.attr("transform",e.makeTranslate(this._getTranslate()))}return this.textGraphicGroup},_getTranslate:function(){return this.vanchart.getPlotBounds()},onPointTap:function(){},onPointMouseMove:function(t){var e=this.series.vanchart;e.showTooltip(e.hoverPoint,t)},calcOutsideLabel:function(t,e,i,n){var r=this,a={};if(t.map(function(t){var e=r.getLocByArc(r.getCenterAngle(t));a[e]=a[e]||[],a[e].push(t)}),n)return a=r.ignoreMin(a,n),r.placeOutSideLabels(a,n),n;n=Math.min(i[0]-e.x,e.x+e.width-i[0],i[1]-e.y,e.y+e.height-i[1]);for(var o=0,s=A.length;s>o;o++){var l=n*A[o],h=r.ignoreMin(a,l);if(r.placeOutSideLabels(h,l),r.testWithinBounds(h,i,e))break}return l},calculateInsideLabelBounds:function(t){var e=this;t.map(function(i,n){var r=t[n],a=e.getCenterAngle(r),o=e._getInnerRadius(r),s=e._getOuterRadius(r),l=o+(s-o)/2,h=e._getArcPoint(l,a),u=h[0]-r.labelDim.width/2,c=h[1]-r.labelDim.height/2;r.labelPos={x:u,y:c}})},calculateLeadLineStartPos:function(t){var e=this;t.map(function(t){var i=e._getOuterRadius(t),n=e.getCenterAngle(t);t.labelPos&&(t.labelPos.startPos={x:(i+1)*Math.sin(n),y:(i+1)*Math.cos(n+Math.PI)})})},getCenterAngle:function(t){var i=this.chartInfo.rotate||0,n=i+(this._getStartAngle(t)+this._getEndAngle(t))/2;return e.makeValueInRange(0,2*Math.PI,n)},getLocByArc:function(t){return t%=2*Math.PI,t<Math.PI/2?L:t<Math.PI?C:t<3*Math.PI/2?M:P},ignoreMin:function(t,e){var i={};for(var n in t)t[n].map(function(t){t.labelPos=null}),i[n]=this._ignoreMinArcLabel(e,t[n]);return i},_ignoreMinArcLabel:function(t,e){for(var i=0,n=0,r=e.length;r>n;n++){var a=e[n].labelDim;i+=a.height}if(i>1.2*t){var o=i-1.2*t;e.sort(function(t,e){return t.value-e.value});for(var n=0,r=e.length;r>n&&!(0>o);n++){var s=e[n].labelDim.height;o-=s}e=e.slice(n,e.length)}var l=this;return e.sort(function(t,e){return l.getCenterAngle(t)-l.getCenterAngle(e)}),e},placeOutSideLabels:function(t,e){var i=this;Object.keys(t).map(function(n){i.findNiceBounds(!0,t[n],e,n)||i.findNiceBounds(!1,t[n],e,n)})},findNiceBounds:function(t,e,i,n){var r,a,o=1.2*i,s=.1*i,l=this._getStartAndEndAngle(n),h=t?l.endAngle:l.startAngle,u=t?E:-E;e.map(function(t){t.labelPos=null});for(var c=0,d=e.length;d>c;c++){var f=t?c:d-c-1,p=t?Math.max:Math.min,g=e[f],m=g.labelDim,v=this.getCenterAngle(g);v=a?p(v,a):v;for(var y=!1,_=v;t?h>_:_>h;_+=u){var x=o*Math.sin(_),T=o*Math.cos(_+Math.PI),b=this._getLabelBounds(n,x,T,s,m);if(r?!this._isOverlapOrShadow(r,b):!0){y=!0,a=_;break}}if(!y)return!1;var A,P={x:x,y:T};A=n==L||n==C?{x:x+s,y:T}:{x:x-s,y:T},r=b,g.labelPos={x:b.x,y:b.y,midPos:P,endPos:A}}return!0},_getStartAndEndAngle:function(t){switch(t){case L:return{startAngle:0,endAngle:Math.PI/2};case C:return{startAngle:Math.PI/2,endAngle:Math.PI};case M:return{startAngle:Math.PI,endAngle:3*Math.PI/2};case P:return{startAngle:3*Math.PI/2,endAngle:2*Math.PI}}},_getLabelBounds:function(t,e,i,n,r){var a,o;return a=t==L||t==C?e+n+_:e-n-_-r.width,o=i-r.height/2,{x:a,y:o,width:r.width,height:r.height}},_isOverlapOrShadow:function(t,i){var n=Math.max(t.y,i.y),r=Math.min(t.y+t.height/2,i.y+i.height/2),a=Math.max(t.y+t.height/2,i.y+i.height/2),o=Math.min(t.y+t.height,i.y+i.height);return e.rectangleOverlapped(t,i)||r>=n||o>=a},testWithinBounds:function(t,i,n){for(var r in t){var a,o,s,l,h;switch(o=s=0,r){case L:case C:s=n.y-i[1],l=n.width+n.x-i[0],h=n.height;break;case M:case P:o=n.x-i[0],s=n.y-i[1],l=-o,h=n.height}a={x:o,y:s,width:l,height:h};for(var u=0;u<t[r].length;u++){var c=t[r][u];if(c.labelPos){var d={x:c.labelPos.x,y:c.labelPos.y,width:c.labelDim.width,height:c.labelDim.height};if(!e.containsRect(a,d))return!1}}}return!0},_getInnerRadius:function(t){return t.innerRadius},_getOuterRadius:function(t){return t.outerRadius},_getStartAngle:function(t){return t.startAngle},_getEndAngle:function(t){return t.endAngle},_getPercentValue:function(t,e){return t?(t+="",-1!=t.indexOf("%")&&(t=parseFloat(t)*e/100),parseFloat(t)):0},remove:function(){var t=this.vanchart;this.points.forEach(function(e){t.removePointGraphics(e,this.type)}),this._canvas&&this._canvas.remove(),this.textGraphicGroup&&this.textGraphicGroup.remove(),this.group&&this.group.remove(),this.textGraphicGroup=this._canvas=this.group=null},getPressedStyle:function(){return null},onPointPress:function(){var t=this,e=t.series,i=e.getPressedStyle(t);i&&t.graphic.style(i)},onPointPressUp:function(){var t=this,e=t.series,i=e.getHighLightStyle(t);i&&t.graphic.style(i)},isSupportLegendHighlight:function(){return!0},isSeriesAccumulated:function(){return!1},isTreeSeries:function(){return!1},onPointMouseOver:function(){},onPointMouseOut:function(){},getClosestPoint:function(){return null}});return S}),i("EffectHelper",["require","./utils/BaseUtils","./utils/BezierEasing"],function(t){function e(t,e){function i(){return function(t){return c.makeTranslate3d({x:p.x,y:p.y-25*t})}}function n(){return function(t){return c.makeTranslate3d({x:p.x,y:p.y-25*(1-t)})}}function r(){return m.path().addTo(y).style(v).attr("d",f)}function a(t,e,i){t.style(v).attr("transform",b),d3.select(t.node()).transition().delay(e).ease("linear").duration(i).attrTween("transform",function(){return function(t){return T+"scale("+(x+1.4*x*t)+")"}}).styleTween("fill-opacity",function(){return function(t){return.6*(1-t)}})}var o=e.series,s=o.vanchart,l=s._leaflet,h=e.getLatLng(),p=l.latLngToLayerPoint(h),g=o._getEffectTime(e);d3.select(t).interrupt("point-map-effect").transition("point-map-effect").ease(d.css["ease-out-quint"]).duration(.25*g).styleTween("transform",i).transition().ease(d.css["ease-in-quint"]).duration(.25*g).styleTween("transform",n).transition().ease(d.css["ease-out-quint"]).duration(.25*g).styleTween("transform",i).transition().ease(d.css["ease-in-quint"]).duration(.25*g).styleTween("transform",n);var m=s.renderer,v={"fill-opacity":0,fill:e.color},y=u(e,o),_=e.icon.iconSize,x=_[0]/90,T=c.makeTranslate({x:p.x,y:p.y}),b=T+" scale("+x+")",A=y.firstG=y.firstG||r(),L=y.secondG=y.secondG||r(),C=y.thirdG=y.thirdG||r(),P=g/o.getDefaultEffectTime();a(A,0,2e3*P),a(L,600*P,2e3*P),a(C,1200*P,2e3*P)}function i(t,e,i,n){var a=r(e,i,n);d3.select(t).attr("transform-origin","center").transition().ease(d.css["ease-out-quad"]).duration(.5*a.period).attrTween("filter",a.firstTweenFun).attr("transform",a.translate+"scale(1.05)").transition().ease(d.css["ease-in-quad"]).duration(.5*a.period).attrTween("filter",a.secondTweenFun).attr("transform",a.translate+"scale(1)")}function n(t,e){var i=r(e);d3.select(t).style("transform",i.translate+"scale(1)").style("transform-origin","center").transition().ease(d.css["ease-out-quad"]).duration(.5*i.period).attrTween("filter",i.firstTweenFun).style("transform",i.translate+"scale(1.05)").transition().ease(d.css["ease-in-quad"]).duration(.5*i.period).attrTween("filter",i.secondTweenFun).style("transform",i.translate+"scale(1)")}function r(t,e,i){function n(){return function(e){return s.updateDropShadowFilter&&s.updateDropShadowFilter(t.effectShadowFilter,3*e,3*e,.75*e,5*e,91/255,91/255,91/255),l}}function r(){return function(e){return s.updateDropShadowFilter&&s.updateDropShadowFilter(t.effectShadowFilter,3*(1-e),3*(1-e),.75*(1-e),5*(1-e),91/255,91/255,91/255),l}}var a=t.series,o=a.vanchart,s=o.renderer;t.effectShadowFilter=t.effectShadowFilter||s.createDropShadowFilter(3,3,.75,5,91/255,91/255,91/255);var l="url(#"+c.stamp(t.effectShadowFilter)+")",h=a._getEffectTime(t),u=isNaN(e)||isNaN(i)?"":c.makeTranslate({x:e,y:i});return{period:h,translate:u,firstTweenFun:n,secondTweenFun:r}}function a(t,e){o(t,null,e)}function o(t,e,i){function n(e){return a({outerRadius:t.radius+e*t.radius*1.5})}var r={"fill-opacity":0,stroke:"none",fill:t.color},a=d3.svg.arc().innerRadius(t.radius).startAngle(0).endAngle(360);h(t,{isMap:i,initStyle:r,pathFun:n,trans:e})}function s(t,e){function i(t){return t*o*2.5}function n(t){return c.getMarkerPath(a,o+i(t)/2-1)}if(t.marker&&t.marker.symbol){var r=t.marker,a=r.symbol,o=r.radius;if(c.isImageMarker(a))return;var s={fill:"none",stroke:r.fillColor,"stroke-width":0,"stroke-opacity":0};h(t,{isMap:e,initStyle:s,opacityKey:"stroke-opacity",pathFun:n,borderFun:i})}else l(t,e)}function l(t,e){function i(t){return o({outerRadius:t*r*3.5})}var n=t.marker,r=n.radius,a={"fill-opacity":0,stroke:"none",fill:n.fillColor},o=d3.svg.arc().innerRadius(0).startAngle(0).endAngle(360);h(t,{isMap:e,initStyle:a,pathFun:i})}function h(t,e){function i(){return s.path().addTo(r).style(l)}function n(t,i,n){t.style(l),d3.select(t.node()).transition().delay(i).ease("linear").duration(n).styleTween("stroke-width",function(){return e.borderFun}).styleTween(e.opacityKey||"fill-opacity",function(){return function(t){return.3*(1-t)}}).attrTween("d",function(){return e.pathFun})}var r,a=t.series,o=a.vanchart,s=o.renderer,l=e.initStyle,h=e.trans||{x:t.posX,y:t.posY};if(e.isMap){var d=o._leaflet,f=t.getLatLng(),p=d.latLngToLayerPoint(f);h=p,r=u(t,a)}else r=a._getPointEffectGroup(t);r.attr("transform",c.makeTranslate(h));var g=r.firstG=r.firstG||i(),m=r.secondG=r.secondG||i(),v=r.thirdG=r.thirdG||i(),y=a._getEffectTime(t),_=y/a.getDefaultEffectTime();n(g,0,1600*_),n(m,440*_,1600*_),n(v,880*_,1600*_)}function u(t,e){var i=e.vanchart,n=i._leaflet,r=i.renderer;return i._effectLayer||(i._effectLayer=L.layerGroup().addTo(n),i._effectLayer.rawElement=i._effectLayer._g),t.effectGraphic=t.effectGraphic||r.group().addTo(i._effectLayer).style("pointer-events","none"),t.effectGraphic}var c=t("./utils/BaseUtils"),d=t("./utils/BezierEasing"),f="M-56,0a56,16 0 1,0 112,0a56,16 0 1,0 -112,0";return{MARKER_EFFECT_TIME:2560,markerEffectAnimation:s,bubbleEffectAnimation:a,AREA_STYLE_EFFECT_TIME:2e3,areaStyleEffectAnimation:i,areaMapEffectAnimation:n,POINT_MAP_EFFECT_TIME:3200,pointMapEffectAnimation:e,forceBubbleEffectAnimation:o}}),i("chart/Map",["require","../Constants","../utils/BaseUtils","../utils/QueryUtils","../ComponentLibrary","./Series","../EffectHelper","../ChartLibrary","../ChartLibrary","../ChartLibrary"],function(t){var e,i=t("../Constants"),n=t("../utils/BaseUtils"),r=t("../utils/QueryUtils"),a=t("../ComponentLibrary"),o=t("./Series"),s=t("../EffectHelper"),l=4e3,h=o.extend({_refresh:function(){var t=this._getQueryList();n.extend(this,{icon:r.queryList(t,"icon")})},getTargetKey:function(){return"value"},_getPointKey:function(t){return t.name},mapEffectAnimation:function(t,e){this.type==i.POINT_MAP?s.pointMapEffectAnimation(t._icon,e):s.areaMapEffectAnimation(t._path,e)},getDefaultEffectTime:function(){return this.type==i.POINT_MAP?s.POINT_MAP_EFFECT_TIME:s.AREA_STYLE_EFFECT_TIME},_onPointMouseMove:function(t){var e=this,i=e.series;t.containerPoint=[t.containerPoint.x,t.containerPoint.y],i.vanchart.showTooltip(e,t)},_onPointClick:function(t){var i=this,r=i.series,o=r.vanchart.getComponent(a.TOOLTIP_COMPONENT);r._onPointMouseMove.call(i,t),i.onClick(t.originalEvent),n.hasTouch()&&(clearTimeout(e),e=setTimeout(function(){o.hide()},l))},pointEvents:function(){return{mousemove:this._onPointMouseMove,click:this._onPointClick}},_getFixedPos:function(t){var e=t.series.vanchart,n=e._leaflet,r=(e.getComponent(a.GEO_COMPONENT),t.series.type),o=t.getLatLng();if(o){var s=n.latLngToContainerPoint(o);if(r==i.AREA_MAP){var l=0,h=0;return t.dataLabels&&t.labelDim&&t.labelPos&&(l=t.labelDim.width/2,h=t.labelDim.height/2),[s.x+l,s.y+h]}return[s.x,s.y]}},getMapStyle:function(t){return this.type==i.POINT_MAP?{icon:L.icon(t.icon)}:{fillColor:t.color,fillOpacity:t.opacity,color:t.borderColor,weight:t.borderWidth,opacity:t.borderOpacity,filter:"none"}},getMapMouseOverStyle:function(t){return this.type==i.POINT_MAP?{}:{fillColor:t.mouseOverColor,weight:2,filter:"url(#"+n.stamp(this.vanchart._dropShadow)+")"}}});return t("../ChartLibrary").register(i.POINT_MAP,h),t("../ChartLibrary").register(i.AREA_MAP,h),t("../ChartLibrary").register(i.HEAT_MAP,h),h}),i("VanChartMap",["require","./VanChart","./VanChartLayout","./utils/BaseUtils","./utils/PathUtils","./ComponentLibrary","./ChartLibrary","./Constants","./utils/Formatter","./utils/BoundsManager","./utils/ColorUtils","./utils/QueryUtils","./chart/Map","./vector/CanvasRenderer","./vector/Animation"],function(t){var e,i=t("./VanChart"),n=t("./VanChartLayout"),r=t("./utils/BaseUtils"),a=t("./utils/PathUtils"),o=t("./ComponentLibrary"),s=t("./ChartLibrary"),l=t("./Constants"),h=(t("./utils/Formatter"),t("./utils/BoundsManager")),u=(t("./utils/ColorUtils"),t("./utils/QueryUtils")),c=(t("./chart/Map"),t("./vector/CanvasRenderer")),d=(t("./vector/Animation"),4e3),f=i.extend({vanChartType:"vanChartMap",layoutComponentsAndCharts:function(){this.initLayerInfo(),this._layoutMapComponents()},_layoutMapComponents:function(){this.hoverPoint=this.hoverSeries=null;var t=this;t.bounds=t._getDefaultBounds(),o.ComponentsOrder.map(function(e){e in t.components&&t.components[e].doLayout()},this),this.calculateMapSeries(),this.render()},filterRender:function(){this.renderSeries(!0)},_updateSeriesStyle:function(){this.renderSeries(!0)},reRenderWholePlot:function(){this.components[o.LEGEND_COMPONENT]&&this.components[o.LEGEND_COMPONENT].render(),this.reRenderSeries()},reRenderSeries:function(){this.calculateMapSeries(),this.renderSeries(!0)},calculateMapSeries:function(){var t=this;t.hoverPoint=null,t.hoverSeries=null;var e=t.seriesOfType(l.BUBBLE_CHART);n.calculateSeriesMinMaxValue(e),this._calculatePercentageRelated()},_calculatePercentageRelated:function(){for(var t={},e={},i=this.series,n=0,a=i.length;a>n;n++){var o=0,s=i[n],l=s.type,h=s.points;h.forEach(function(t){o=r.accAdd(o,Math.abs(t.getTargetValue()))}),h.forEach(function(i){i.percentage=Math.abs(i.getTargetValue()/o);var n=i.lnglat?i.lnglat.join("-"):i.name;n+=l;var r=i.isNull?e:t;r[n]=r[n]||[],r[n].push(i)})}for(var u in t){var h=t[u].concat(e[u]||[]);h.forEach(function(t){t.points=h,t.series.calculateLabelInfo(t)})}},renderSeries:function(t){var e=this,i=e._leaflet,n=this.layerMap[this.layerMap.length-1].geo,a={onEachFeature:function(t,i){i.on(e._mapHandler(i))}};this._geoJson=this._geoJson||L.geoJson([],a).addTo(i),this._pointLayer=this._pointLayer||L.layerGroup().addTo(i),this._layerToPointMap={},this.validPoints=this._getValidPoints(),e.updateNullAreaShape(this.validPoints.validAreaName),this.validPoints.points.forEach(function(t){var i=t.series,o=n.getFeaturesByName(t.name,i.type);t.layers?e.addLayers(t,i.type):(t.layers=[],o=t.lnglat?["null"]:o,o.forEach(function(i){var n=e.createLayer(i,t,a);e._layerToPointMap[r.stamp(n)]=t,t.layers.push(n)})),e._drawMapPointEffect(t)}),this._dropShadow=this._dropShadow||this._createDropShadowFilter(0,1,.5,2),this._renderHeatMap(),this._renderLineMap(t);var o=this._changeDataState?this._getMapAnimationTime():0,e=this;e.setTimeout("map-update",function(){e.updateLabel()},o)},_drawMapPointEffect:function(t){function e(){t.layers.forEach(function(e){i.mapEffectAnimation(e,t)})}if(t.layers){var i=t.series;if(clearInterval(t.effectInterval),t.effect&&t.effect.enabled){var n=i._getEffectTime(t);n&&(e(),t.effectInterval=setInterval(e,n))}}},_createDropShadowFilter:function(t,e,i,n){if(r.isSupportSVG()){var a=d3.select(this._leaflet._renderer._container).append("defs"),o=a.append("filter").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%"),s=r.stamp(o);return o.attr("id",s),o.append("feOffset").attr("in","SourceAlpha").attr("dx",t).attr("dy",e).attr("result","offOut"),o.append("feColorMatrix").attr("in","offOut").attr("type","matrix").attr("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "+i+" 0").attr("result","matrixOut"),o.append("feGaussianBlur").attr("in","matrixOut").attr("stdDeviation",n).attr("result","blurOut"),o.append("feBlend").attr("in","SourceGraphic").attr("in2","blurOut").attr("mode","normal"),o}return{}},getCurrentGeo:function(){return this.layerMap[this.layerMap.length-1].geo},_getValidPoints:function(){var t=this,e={},i={},n=[],r=t.getCurrentGeo();return t.series.forEach(function(a){var o,s=a.points,h=a.type;if(h!=l.LINE_MAP&&h!=l.HEAT_MAP)for(var u=0,c=s.length;c>u;u++){var d=s[u],f=t.isMapPointVisible(d),p=h==l.AREA_MAP?e:i,g=d.lnglat?d.lnglat.join("-"):d.name;h!=l.AREA_MAP&&d.lnglat||(o=r.getFeaturesByName(d.name,h),f=f&&o&&o.length),p[g]&&!t._drawBubble(h)||!f?t.removePointGraphics(d,h):(n.push(d),p[g]=!0)}}),{validAreaName:e,points:n}},_drawBubble:function(t){return this.getComponent(o.LEGEND_COMPONENT)&&t==l.BUBBLE_CHART},removePointGraphics:function(t,e){if(t){if(e===l.LINE_MAP&&(this.isDataSame||this._lineMapLayer.removeEffect(t),t.remove()),t.layers){var i=e==l.AREA_MAP?this._geoJson:this._pointLayer;t.layers.forEach(function(t){i.removeLayer(t)})}var n=this._textGroup;t.textLayers&&(t.textLayers.forEach(function(t){n.removeLayer(t)}),t.textLayers=null,t.labelPos=null),clearInterval(t.effectInterval),t.effectGraphic&&t.effectGraphic.remove(),t.effectGraphic=null}},_getHeatMapPoints:function(){var t=this.seriesOfType(l.HEAT_MAP),e=[],i=this.getCurrentGeo(),n=this;if(t&&t.length)for(var r=0,a=t.length;a>r;r++)t[r].points.forEach(function(t){if(!t.lnglat){var r=i.getFeaturesByName(t.name,l.HEAT_MAP);t.lnglat=i.getDataPointLngLat(t,r&&r[0])}!t.isNull&&t.visible&&t.lnglat?e.push(t):n.removePointGraphics(t,l.HEAT_MAP)});return e},_renderHeatMap:function(){var t=this.seriesOfType(l.HEAT_MAP),e=this.getComponent(o.RANGE_LEGEND_COMPONENT);if(t&&t.length&&e){var i={min:e._getMin(),max:e._getMax(),data:this._getHeatMapPoints()};if(!this._heatMapOverlay){var n=t[0]._getQueryList(),r={maxOpacity:u.queryList(n,"maxOpacity"),minOpacity:u.queryList(n,"minOpacity"),radius:u.queryList(n,"radius"),blur:u.queryList(n,"blur"),gradient:e._getGradient(),valueField:"value"};this._heatMapOverlay=L.heatMapOverlay(r).addTo(this._leaflet)}this._heatMapOverlay.setData(i)}},_renderLineMap:function(t){var e=this.seriesOfType(l.LINE_MAP),i=e.reduce(function(t,e){return t.concat(e.points)},[]);if(!e.length||!i.length)return void(this._lineMapLayer&&this._lineMapLayer.setData([]));if(!this._lineMapLayer){var n=this,r=this._leaflet,a=this._leaflet.getSize(),o={width:a.x,height:a.y,x:0,y:0,dpr:window.devicePixelRatio||1},s=this.mainRenderer=new c(r._panes.overlayPane,this,o),h=this.animationRenderer=new c(r._panes.overlayPane,this,o);this._lineMapLayer=L.lineMapLayer({mainRenderer:s,animationRenderer:h,vanchart:n}).addTo(r)}t?this._lineMapLayer.redraw():this._lineMapLayer.setData(i)},_getMapAnimationTime:function(){for(var t=!1,e=0,i=this.series.length;i>e;e++){var n=this.series[e];if(n.type==l.BUBBLE_CHART&&n.animation){t=!0;break}}return t?500:0},isMapPointVisible:function(t){var e=this.getComponent(o.RANGE_LEGEND_COMPONENT);return e&&t.points&&t.points.length&&(t=t.points[0]),t.visible&&t.series.visible},getMapStyle:function(t){var e=t.series.getMapStyle(t),i=this.highlightTarget;if(i){var n=t.series.name==i||t._rangeItem==i?1:.3;e.opacity=e.fillOpacity=n}return e},addLayers:function(t,e){var i=e==l.AREA_MAP?this._geoJson:this._pointLayer,n=this,a=n.getMapStyle(t);t.layers.forEach(function(e){e.setStyle(a),i.addLayer(e),n._layerToPointMap[r.stamp(e)]=t})},createLayer:function(t,e,i){var n,a=e.series.type,o=this.getMapStyle(e),s=e.getLatLng(t);switch(a){case l.AREA_MAP:n=this._geoJson.addData(t),n.setStyle(o);break;case l.BUBBLE_CHART:n=L.circleMarker(s,o).addTo(this._pointLayer);break;case l.POINT_MAP:n=L.marker(s,o).addTo(this._pointLayer);break;case l.SCATTER_CHART:n=r.isImageMarker(e.marker.symbol)?L.marker(s,o):L.scatterMarker(s,o,this),n.addTo(this._pointLayer)}return a!=l.AREA_MAP&&i.onEachFeature.call(null,null,n),n},getDataPointByLayer:function(t){return this._layerToPointMap[r.stamp(t)]},updateNullAreaShape:function(t){var e=this,i=e.getCurrentGeo(),n=i._validAreaName,r={};if(this.nullAreaFeatures=this.nullAreaFeatures||{},this.needsNullArea()){var a=this.getDefaultMapStyle();for(var o in n){if(!this.nullAreaFeatures[o]&&!t[o]){var s=n[o];this.nullAreaFeatures[o]=[];for(var l=0,h=s.length;h>l;l++){var u=this._geoJson.addData(s[l]);u.setStyle(a),this.nullAreaFeatures[o].push(u)}}if(t[o]){var c=this.nullAreaFeatures[o];c&&c.forEach(function(t){t.remove()}),this.nullAreaFeatures[o]=null}else r[o]=!0}}for(var o in this.nullAreaFeatures)if(!r[o]&&!t[o]){var c=this.nullAreaFeatures[o];c&&c.forEach(function(t){t.remove()}),this.nullAreaFeatures[o]=null}},needsNullArea:function(){return this.isAreaMap()||this.isHeatMap()||this.seriesOfType(l.AREA_MAP).length},getDefaultMapStyle:function(){var t=this.options.plotOptions,e=[t[l.AREA_MAP],t],i={fillColor:r.pick(u.queryList(e,"color"),"#cccccc"),fillOpacity:r.pick(u.queryList(e,"opacity"),.75),weight:r.pick(u.queryList(e,"borderWidth"),1),color:r.pick(u.queryList(e,"borderColor"),"#ffffff"),opacity:r.pick(u.queryList(e,"borderOpacity"),1)};return i},updateNormalLabel:function(){var t=this,e=t._leaflet,i=t.getCurrentGeo();this._textGroup=this._textGroup||L.layerGroup().addTo(e);var n=this._textGroup;this.getLabelPoints().forEach(function(e){var r=e.series.type,a=i.getFeaturesByName(e.name,r);a=e.lnglat?["null"]:a,e.labelPos&&e.labelContent?e.textLayers?e.textLayers.forEach(function(e){e.addTo(t._textGroup),e.setStyle()}):a&&a.forEach(function(i,n){e.labelPos[n]&&(e.textLayers=e.textLayers||[],e.textLayers[n]=L.text(e.getLatLng(i),{feature:i
},e).addTo(t._textGroup))}):e.textLayers&&(e.textLayers.forEach(function(t){n.removeLayer(t)}),e.textLayers=null)})},_fixConflictLabel:function(){var t=this,e=(t.series,new h),i=t.getCurrentGeo(),n=this.getLabelPoints();n.forEach(function(n){var r=n.series.type;if(r==l.AREA_MAP&&n.labelContent){var a=i.getFeaturesByName(n.name,r);a&&(a.forEach(function(i,r){if(n.labelPos=n.labelPos||[],i.properties.center){var a=t._getTextBounds(n,i);n.labelPos[r]=a,e.addBounds(a)}else n.labelPos[r]=null}),n.labelPos&&!n.labelPos.filter(function(t){return!!t}).length&&(n.labelPos=null))}else n.labelPos=null}),n.forEach(function(n){if(n.labelContent){var r=n.series.type,a=i.getFeaturesByName(n.name,r);a=n.lnglat?["null"]:a,a?a.forEach(function(i,r){if(!n.labelPos||!n.labelPos[r]){var a=t._getTextBounds(n,i);e.isOverlapped(a)?(n.labelPos=n.labelPos||[],n.labelPos[r]=null):(n.labelPos=n.labelPos||[],n.labelPos[r]=a,e.addBounds(a))}n.labelPos&&!n.labelPos.filter(function(t){return!!t}).length&&(n.labelPos=null)}):n.labelPos=null}})},_getTextBounds:function(t,e){var i=this,n=i._leaflet,a=t.getLatLng(e),o=n.latLngToContainerPoint(a),s=o.y,h=t.series.type;if(h==l.AREA_MAP||h==l.BUBBLE_CHART||h==l.HEAT_MAP)s-=t.labelDim.height/2;else if(t.marker&&!r.isImageMarker(t.marker.symbol)){var u=t.marker.radius||4.5;s-=u+t.labelDim.height}else{var c=t.icon?t.icon.iconSize[1]:t.marker.height;s-=c/2+t.labelDim.height}return r.makeBounds([o.x,s],t.labelDim)},_mapHandler:function(t){var i=this,n=i.getComponent(o.TOOLTIP_COMPONENT);return{click:function(a){var o=i.getDataPointByLayer(t);o&&(i.drillDown(o),o.onClick&&o.onClick(a.originalEvent),r.hasTouch()&&(n.showWithPoint(o),clearTimeout(e),e=setTimeout(function(){n.hide()},d)))},mouseover:function(){var e=i.getDataPointByLayer(t);e&&(i.hoverPoint=e,e.layers.forEach(function(t){t.setStyle(e.series.getMapMouseOverStyle(e))}))},mouseout:function(){n.hide();var e=i.getDataPointByLayer(t);e&&e.layers.forEach(function(t){t.setStyle(e.series.getMapStyle(e))})},mousemove:function(){var e=i.getDataPointByLayer(t);n.showWithPoint(e)}}},path2vml:function(t){return a.path2vml(t)},getLabelPoints:function(){var t=this.validPoints&&this.validPoints.points;return(t||[]).concat(this._getHeatMapPoints())},updateLabel:function(){var t=this;this._fixConflictLabel();var e=t.getShowMoreLabelTime();e=this.layerIndex>0?0:e,t._setTextOpacity(e,0),t._moreLabelTimeOut&&clearTimeout(t._moreLabelTimeOut),t._moreLabelTimeOut=setTimeout(function(){t._changeDataState=!1,t._clearMoreLabels(),t._setTextOpacity(e,1),t.updateNormalLabel()},e),t._updateMoreLabel(e)},_setTextOpacity:function(t,e){if(0!==t)for(var i=this,n=i.series,r=0,a=n.length;a>r;r++){var o=n[r],s=o.type,h=o.points;s!=l.LINE_MAP&&s!=l.HEAT_MAP&&h.forEach(function(t){t.textLayers&&t.textLayers.forEach(function(t){t._text&&(t._text.style.fillOpacity=e)})})}},_updateMoreLabel:function(t){if(!(0>=t)){var e=this,i=(e.series,e._leaflet);this._moreLabelLayer=this._moreLabelLayer||L.layerGroup().addTo(i),this._moreLabelLayer.rawElement=this._moreLabelLayer._g,this.validPoints&&this.validPoints.points.forEach(function(t){var n=t.getLatLng();if(e.isMapPointVisible(t)&&n){var r=i.latLngToLayerPoint(n),a=r.y,o=null;t.series.type==l.POINT_MAP&&(a-=t.icon.iconSize[1]/2,o=function(t,e){return t-e/2-5}),t.series._showAndExitMoreLabel(t,r.x,a,null,o,e._moreLabelLayer)}})}},_clearMoreLabels:function(){this.series.forEach(function(t){t.points.forEach(function(t){t.moreLabelG&&t.moreLabelG.remove(),t.moreLabelG=null})})},_checkPointDrillDown:function(t){if(t&&!t.drilldown&&t.points)for(var e=t.points,i=e.length-1;i>=0;i--)e[i].drilldown&&(t.drilldown=e[i].drilldown,t.geo=e[i].geo)},_initLeafLet:function(t,e){function i(){if(a._leaflet){var t=a.hoverPoint,e=a._leaflet.getZoom();if(a._checkPointDrillDown(t),t&&t.geo){var i=t.geo.getZoomListener();if(i&&e>=i)return void a.drillDown(t)}var n=a.layerMap[a.layerIndex-1];n&&n.geo.getZoomListener()>e&&a.drillUp(n),a.viewreset()}}function n(){for(var t=a.series,e=0,i=t.length;i>e;e++){var n=t[e],r=n.type,o=n.points;r!=l.LINE_MAP&&r!=l.HEAT_MAP&&o.forEach(function(t){clearInterval(t.effectInterval),t.effectGraphic&&t.effectGraphic.remove(),t.effectGraphic=null,n.type==l.POINT_MAP&&t.layers&&t.layers.forEach(function(t){d3.select(t._icon).interrupt("point-map-effect").transition("point-map-effect")})})}}var a=this,o={zoomControl:!1,doubleClickZoom:!1,zoomDelta:.5,zoomSnap:.5};return this._leaflet=this._leaflet||L.map(t,o),this._leaflet.on("zoom",i,this._leaflet),this._leaflet.on("zoomstart",n,this._leaflet),this._leaflet.vanchart=this,t.style.cssText+=";overflow:hidden;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;",r.setDomBackground(t,{backgroundImage:e.backgroundImage,backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,borderRadius:e.borderRadius,shadow:e.shadow}),this.mainRenderer=null,this.animationRenderer=null,this._leaflet._controlContainer.getElementsByTagName("div")[0]},_originSeries:function(){0!==this.layerIndex&&this.layerMap&&this.layerMap.length&&(this.series=this.layerMap[0].series)},initLayerInfo:function(){this.layerMap=[],this.layerIndex=0;var t=this.getComponent(o.GEO_COMPONENT),e=this.series;this.layerMap=[{series:e,geo:t,layerIndex:this.layerIndex,drillUpDataPoint:e[0]&&e[0].points[0]}];var i=this.options.initDrillPath;if(i&&i.length>1)for(var n=1;n<i.length;n++){for(var r=i[n],a=null,s=0;s<e.length;s++){for(var l=e[s].points,h=0;h<l.length;h++)if(l[h].drilldown&&l[h].drilldown.geo.name==r){a=l[h];break}if(a)break}if(a){this._createChildSeriesWhenLoaded(a),this.layerMap[this.layerIndex].drillUpDataPoint=a,this.series=e=a.childSeries;var u=this.getComponent(o.RANGE_LEGEND_COMPONENT);u&&u.initAttributesWithSeries(),e.forEach(function(t){for(var e=0,i=t.points.length;i>e;e++)t.points[e].refreshPointColor()}),this.layerIndex++,t=a.geo,this.layerMap[this.layerIndex]={geo:t,series:e,layerIndex:this.layerIndex}}}t.loadGeo(),this.setGeo(t),t.fitMapBounds()},_createChildSeriesWhenLoaded:function(t){if(!t.childSeries){var e=[],i=this;i.parentPoint=t,t.drilldown.series.forEach(function(t,n){var r=t.type||i.options.chartType,a=s.get(r);e.push(new a(t,i,n))}),t.childSeries=e}},drillDown:function(t){this._checkPointDrillDown(t);var e=this.layerMap[this.layerIndex-1];if(t.drilldown&&t.drilldown.series&&(!e||e.drillUpDataPoint!=t)){var i=this.layerMap[this.layerIndex].geo;this._createChildSeriesWhenLoaded(t),this.layerMap[this.layerIndex].drillUpDataPoint=t,this._setNewGeoAndSeries(t.geo,i,t.childSeries,++this.layerIndex)}},drillUp:function(t){var e=this;if(t.series!=e.series){var i=this.layerMap[t.layerIndex+1].geo;this._setNewGeoAndSeries(t.geo,i,t.series,t.layerIndex)}},_setNewGeoAndSeries:function(t,e,i,n){for(var r=this,a=0,s=r.series.length;s>a;a++){var l=r.series[a],h=l.type,u=l.points;u.forEach(function(t){r.removePointGraphics(t,h)})}if(this.nullAreaFeatures){for(var c in this.nullAreaFeatures){var d=this.nullAreaFeatures[c];d&&d.forEach(function(t){t.remove()})}this.nullAreaFeatures=null}r.series=i;var f=r.getComponent(o.RANGE_LEGEND_COMPONENT);f&&f.initAttributesWithSeries(),i.forEach(function(t){for(var e=0,i=t.points.length;i>e;e++)t.points[e].refreshPointColor()}),this.layerMap[n]={geo:t,series:i,layerIndex:n,drillUpDataPoint:i[0]&&i[0].points[0]},this.layerIndex=n,this.layerMap=this.layerMap.slice(0,n+1),this.setGeo(t,e),t.fitMapBounds(),this._layoutMapComponents()},setGeo:function(t,e){var i,n,r;e&&(i=e._tileLayer||e._wmsLayer,n=e._attribution,r=e._imageBackgroundLayer);var a=t._imageBackgroundLayer,o=t._tileLayer||t._wmsLayer,s=t._attribution,l=this._leaflet;a?(i&&i.remove(),n&&n.remove(),L.setOptions(l,{crs:L.CRS.Simple}),r!=a&&(r&&l.removeLayer(r),a.addTo(l))):o&&(r&&l.removeLayer(r),L.setOptions(l,{crs:L.CRS.EPSG3857}),i!=o&&(i&&i.remove(),o.addTo(l),n&&n.remove(),s&&s.addTo(l)))},viewreset:function(){for(var t=this,e=t.series,i=0,n=e.length;n>i;i++){var r=e[i],a=r.type,o=r.points;a!=l.LINE_MAP&&a!=l.HEAT_MAP&&o.forEach(function(e){t._drawMapPointEffect(e)})}clearTimeout(this.labelRelaoutTimeOut),this.labelRelaoutTimeOut=setTimeout(function(){t.updateLabel()},200)}});return f}),i("VanChartForceBubble",["require","./VanChart","./utils/BaseUtils","./ComponentLibrary","./ChartLibrary","./Constants","./utils/Formatter"],function(t){var e=t("./VanChart"),i=t("./utils/BaseUtils"),n=(t("./ComponentLibrary"),t("./ChartLibrary"),t("./Constants")),r=(t("./utils/Formatter"),2),a=4,o=500,s=e.extend({vanChartType:"vanChartForceBubble",dealAxisZoom:function(t,e){this.force&&this.force.stop();var n=this.getPlotBounds(),r=Math.min(t[0],e[0])-n.x,a=Math.min(t[1],e[1])-n.y,o=Math.abs(t[0]-e[0]),s=Math.abs(t[1]-e[1]),l=Math.min(n.width/o,n.height/s),h=n.width/l,u=n.height/l,c=(n.width-h)/2-r,d=(n.height-u)/2-a,f=this;this.forceBubbleNodes.forEach(function(t){t.radius*=l;var e=t.x+c,i=t.y+d;e-=n.width/2,i-=n.height/2,t.x=e*l+n.width/2-c,t.y=i*l+n.height/2-d;var r=t.originalPoint;r.radius=t.radius,f._calculateLabelPos(t),r.effectGraphic&&r.effectGraphic.remove(),r.effectGraphic=null}),this.scale=l*i.pick(this.scale,1),this.scaleRender()},_calculateLabelPos:function(t){if(t.labelContent&&t.labelDim){var e=t.radius;t.labelDim.width>2*e||t.labelDim.height>2*e?t.labelPos=null:t.labelPos={x:-t.labelDim.width/2+t.x,y:-t.labelDim.height/2+t.y}}var i=t.originalPoint;i.labelPos=t.labelPos},orderData:function(){},refreshRestore:function(){this.scale=1,this._refreshOptions()},scaleRender:function(){for(var t=0,e=this.forceBubbleNodes.length;e>t;t++){var n=this.forceBubbleNodes[t],r=n.originalPoint,a=r.series,s=a.getAttrs(n),l=a.animation;l?d3.select(r.graphic.node()).transition().duration(o).ease("back-out").attr("transform",i.makeTranslate(n)).attr("r",s.r):r.graphic.attr(s),this._updatePointTextGraphic(r)}},renderSeries:function(){var t=this,e=t.renderer,r=this.getPlotBounds(),a=t.seriesOfType(n.FORCE_BUBBLE_CHART),o=a[0],s=o&&o.animation;r.width/2,r.height/2;this.group||(this.group=e.group().addTo(t.clipSeriesGroup)),this.group.attr("transform",i.makeTranslate(r));var l=[],h=[],u=0;a.forEach(function(t){var e;t.points.forEach(function(t){var n=i.extend({originalPoint:t},t);if(t.shadow=n,t.graphic&&s){var r=d3.transform(d3.select(t.graphic.node()).attr("transform")).translate;n.x=r[0],n.y=r[1]}else n.x=n.y=void 0;n.isNull||l.push(n),n.visible&&n.series.visible&&!n.isNull&&(h.push(n),u=Math.max(u,t.radius),e=e||n,e=n.radius>e.radius?n:e)}),t.cluster=e}),t.forceBubbleNodes=h,s||this._simulateForce();for(var c=0,d=l.length;d>c;c++){var f=l[c],p=f.visible&&f.series.visible,g=f.originalPoint||f,m=o.getStyle(f),v=o.getAttrs(f);p&&g.graphic?(o._updatePointGraphicStyle(g),s?d3.select(g.graphic.node()).datum(f).transition().duration(750).attr("r",f.radius):g.graphic.attr(v)):p&&!g.graphic?(s?(g.graphic=e.circle().style(m).addTo(this.group),d3.select(g.graphic.node()).datum(f).attr("r",0).transition().duration(750).attr("r",f.radius)):g.graphic=e.circle(v).style(m).addTo(this.group),o._updatePointGraphicStyle(g)):!p&&g.graphic&&(s?d3.select(g.graphic.node()).transition().duration(300).ease("back-in").attr("r",0).remove():g.graphic.remove(),g._events=null,g.graphic=null),g.textGraphic&&g.textGraphic.remove(),g.textGraphic=null,g.graphic&&e.registerInteractiveTarget(g,g.graphic)}s?this._updateWithForce(u):this._updateLabels()},_simulateForce:function(){var t=this.forceBubbleNodes,e=this.getPlotBounds(),i=[e.width,e.height];d3.layout.pack().sort(null).size(i).children(function(t){return t.values}).value(function(t){return t.radius*t.radius}).nodes({values:d3.nest().key(function(t){return t.category+t.seriesName}).entries(t)});var n=.1,r=.005,a=2,o=2,s=.5,l=.02,h=.9;t.forEach(function(t){t.px=t.x,t.py=t.y});for(var u=n;u>=r;u-=u>.07?.001:5e-4){var c,d,f,p,g,m=t.length;if((f=u*l)&&(p=i[0]/2,g=i[1]/2,c=-1,f))for(;++c<m;)d=t[c],d.x+=(p-d.x)*f,d.y+=(g-d.y)*f;for(c=-1;++c<m;)d=t[c],d.x-=(d.px-(d.px=d.x))*h,d.y-=(d.py-(d.py=d.y))*h;t.forEach(function(t){var e=t.series.cluster;if(e&&e!=t){var i=t.x-e.x,n=t.y-e.y,r=Math.sqrt(i*i+n*n),a=t.radius+e.radius;r!=a&&(r=(r-a)/r*u,t.x-=i*=r,t.y-=n*=r,e.x+=i,e.y+=n)}});for(var c=0;m>c;c++)for(var v=t[c],y=0;m>y;y++){var _=t[y];if(_!==v){var p=v.x-_.x,g=v.y-_.y,x=Math.sqrt(p*p+g*g),T=v.radius+_.radius+(v.series.cluster===_.series.cluster?a:o);T>x&&(x=(x-T)/x*s,v.x-=p*=x,v.y-=g*=x,_.x+=p,_.y+=g)}}}},_updatePointTextGraphic:function(t){t.textGraphic?t.labelPos?t.textGraphic.attr("transform",i.makeTranslate(t.labelPos)):(t.textGraphic.remove(),t.textGraphic=null):t.series._createTextGraphic(t)},_updateLabels:function(){var t=this,e=t.forceBubbleNodes;t._moreLabelTimeOut&&clearTimeout(t._moreLabelTimeOut);var i=t.getShowMoreLabelTime();t._moreLabelTimeOut=setTimeout(function(){t._changeDataState=!1,e.forEach(function(e){var i=e.originalPoint;i.moreLabelG&&i.moreLabelG.remove(),i.moreLabelG=null,t._calculateLabelPos(e),t._updatePointTextGraphic(i)})},i),0!==i&&e.forEach(function(e){e.series._showAndExitMoreLabel(e.originalPoint,e.x,e.y,null,null,t.group)})},_updateWithForce:function(t){function e(t){c.each(o(10*t.alpha*t.alpha)).each(s(.5)),c.each(function(){d3.select(this).attr("transform",function(t){return t.originalPoint.textGraphic&&(l._calculateLabelPos(t),l._updatePointTextGraphic(t.originalPoint)),t.originalPoint.effectGraphic&&t.originalPoint.effectGraphic.attr("transform",i.makeTranslate([t.x,t.y])),i.makeTranslate([t.x,t.y])})})}function o(t){return function(e){var i=e.series.cluster;if(i&&i!==e){var n=e.x-i.x,r=e.y-i.y,a=Math.sqrt(n*n+r*r),o=e.radius+i.radius;a!=o&&(a=(a-o)/a*t,e.x-=n*=a,e.y-=r*=a,i.x+=n,i.y+=r)}}}function s(e){var i=d3.geom.quadtree(h);return function(n){var o=n.radius+t+Math.max(r,a),s=n.x-o,l=n.x+o,h=n.y-o,u=n.y+o;i.visit(function(t,i,o,c,d){if(t.point&&t.point!==n){var f=n.x-t.point.x,p=n.y-t.point.y,g=Math.sqrt(f*f+p*p),m=n.radius+t.point.radius+(n.series.cluster===t.point.series.cluster?r:a);m>g&&0!==g&&(g=(g-m)/g*e,n.x-=f*=g,n.y-=p*=g,t.point.x+=f,t.point.y+=p)}return i>l||s>c||o>u||h>d})}}var l=this,h=l.forceBubbleNodes,u=l.getPlotBounds();l.setTimeout("forceBubbleLabel",function(){l._updateLabels(),l.pointsOfType(n.FORCE_BUBBLE_CHART).forEach(function(t){var e=t.series;e.drawPointEffect(e,t)})},800),this.force&&this.force.stop(),this.force=d3.layout.force().nodes(h).size([u.width,u.height]).gravity(.05).charge(0).on("tick",e).start();var c=d3.select(this.group.node()).selectAll("circle").filter(function(t){d3.select(this).call(l.force.drag);var e=t.originalPoint;return e.visible&&e.series.visible})}});return s}),i("VanChartWordCloud",["require","./VanChart","./Constants","./utils/BaseUtils"],function(t){var e=t("./VanChart"),i=t("./Constants"),n=t("./utils/BaseUtils"),r=e.extend({vanChartType:"vanChartWordCloud",dealAxisZoom:function(t,e){var i=this.getPlotBounds(),r=Math.min(t[0],e[0])-i.x,a=Math.min(t[1],e[1])-i.y,o=Math.abs(t[0]-e[0]),s=Math.abs(t[1]-e[1]),l=Math.min(i.width/o,i.height/s),h=i.width/l,u=i.height/l,c=(i.width-h)/2-r,d=(i.height-u)/2-a,f=this,p=f.series;p.forEach(function(t){var e=t.animation;t.points.forEach(function(i){if(i.word){var n=i.word.x,r=i.word.y;i.word.x=(n+c)*l-c,i.word.y=(r+d)*l-d,i.word.size*=l,e?t.updateAnimation(i.graphic.node(),i):i.graphic.attr(t.getAttrs(i)).style(t.getStyle(i))}})}),this.scale=l*n.pick(this.scale,1)},_getTranslate:function(){var t=this.getPlotBounds();return[t.x+t.width/2,t.y+t.height/2]},renderSeries:function(){function t(t){e.group||(e.group=r.group().addTo(e.clipSeriesGroup),e.mouseOverGroup=r.group().addTo(e.clipSeriesGroup)),e.group.attr("transform",n.makeTranslate(e._getTranslate())),e.mouseOverGroup.attr("transform",n.makeTranslate(e._getTranslate()));var a=e.seriesOfType(i.WORD_CLOUD_CHART);if(a&&a.length){var o=a[0];p.forEach(function(t){var i=t.word;i&&(t.labelDim=n.getTextDimension(i.text,{fontSize:i.size+"px",fontFamily:i.fontFamily},!1)),o.drawPoint(e.group,t)}),e.setTimeout("effect",function(){p.forEach(function(t){o.drawPointEffect(o,t)})},800)}e._updateSeriesState(),window.console&&console.log("done")}var e=this,r=e.renderer,a=e.options.plotOptions,o=e.getPlotBounds(),s=o.width,l=o.height,h=a.minRotation,u=a.maxRotation,c=a.fontFamily,d=a.minFontSize,f=a.maxFontSize,p=e.pointsOfType(i.WORD_CLOUD_CHART).filter(function(t){return!t.isNull}).sort(function(t,e){return Math.abs(e.value)-Math.abs(t.value)});if(0!==p.length){d=n.hasDefined(d)?d:10,f=n.hasDefined(f)?f:e._calculateNiceMaxFontSize(s,l,p[0].name,c),e.minFontSize=Math.min(parseFloat(d),parseFloat(f)),e.maxFontSize=Math.max(parseFloat(d),parseFloat(f));var g=d3.scale.linear().domain([Math.abs(p[p.length-1].value),Math.abs(p[0].value)]).range([e.minFontSize,e.maxFontSize]),m=d3.layout.cloud().size([s,l]).words(p.filter(function(t){return t.visible}).map(function(t){var i={text:t.name,size:g(Math.abs(t.value))*e.scale,point:t,fontFamily:c};return t.word=i,i})).simpleLayout(!n.isSupportSVG()).textDimFun(n.getTextDimension).path(a.path).padding(5).rotate(function(){return h+Math.random()*(u-h)}).font(c).fontSize(function(t){return t.size}).on("end",t);m.start()}},_consoleDone:function(){},_calculateNiceMaxFontSize:function(t,e,i,r){for(var a={min:0,max:100},o=function(){return a.max-a.min>2},s={fontSize:a.max+"px",fontFamily:r},l=n.getTextDimension(i,s,!1);o()&&(l.width>t||l.height>e);){var h=Math.ceil(a.min+(a.max-a.min)/2);s.fontSize=h+"px";var u=n.getTextDimension(i,s,!1);u.width>t||u.height>e?(a.max=h,l=u):a.min=h}return o()?a.max:a.min}});return r}),i("utils/LoadingUtils",[],function(){function t(t,e){if(e=e||"loading-div-id",e+=" loading-div-id",!i[e]&&!document.getElementById(e)){var n=document.createElement("div"),r=document.createElement("div");n.id=e,n.style.backgroundColor="white",n.style.opacity=.75,n.style.filter="alpha(opacity=75)",n.style.position="absolute",n.style.width="100%",n.style.height="100%",n.style.left=0,n.style.top=0,n.style.zIndex=9999,(void 0!=r.style.animation||void 0!=r.style.webkitAnimation)&&(r.style.left="50%",r.style.top="50%",r.className="loader-inner ball-scale-ripple-multiple",r.innerHTML="<div></div><div></div><div></div>"),n.appendChild(r),t.appendChild(n),i[e]=n}}function e(t,e){if(e=e||"loading-div-id",e+=" loading-div-id",i[e])t.removeChild(i[e]),i[e]=null;else{var n=document.getElementById(e);n&&t.removeChild(n)}}var i={};return{startLoading:t,endLoading:e}}),i("component/LegendIconFactory",["require","../Constants"],function(t){function e(t){return a[t]}function i(t){return o[t]?o[t]:o[r.NORMAL_ICON]}function n(t){return a[t]}var r=t("../Constants"),a={},o={};return a[r.PIE_ICON]="M15.795,7.943L7.909,12.5L0.205,8.052C1.756,5.333,4.68,3.5,8.032,3.5C11.338,3.5,14.23,5.287,15.795,7.943z",o[r.PIE_ICON]={width:16,height:16},a[r.TREEMAP_ICON]="M9,12H3c-1.6,0-3-1.4-3-3l0-6c0-1.6,1.3-3,3-3l6,0c1.7,0,3,1.4,3,3v6C12,10.6,10.6,12,9,12z",o[r.TREEMAP_ICON]={width:12,height:12},a[r.DONUT_ICON]="M8.945,11.107c1.671,0,3.181,0.684,4.269,1.786l4.271-4.271c-4.686-4.686-12.284-4.686-16.971,0l4.216,4.216C5.815,11.768,7.302,11.107,8.945,11.107z",o[r.DONUT_ICON]={width:18,height:18},a[r.NORMAL_ICON]="M0,0L12,0L12,12L0,12Z",o[r.NORMAL_ICON]={width:12,height:12},a[r.BUBBLE_ICON]="M6,11.5c-1.47,0-2.851-0.572-3.889-1.611C1.072,8.851,0.5,7.47,0.5,6s0.572-2.851,1.611-3.889C3.149,1.072,4.53,0.5,6,0.5s2.851,0.572,3.889,1.611C10.928,3.149,11.5,4.53,11.5,6s-0.572,2.851-1.611,3.889C8.851,10.928,7.47,11.5,6,11.5z",o[r.BUBBLE_ICON]={width:11,height:11},a[r.NULL_MARKER]="M1,8L1,8c0-0.552,0.448-1,1-1h12c0.552,0,1,0.448,1,1v0c0,0.552-0.448,1-1,1H2C1.448,9,1,8.552,1,8z",o[r.NULL_MARKER]={width:16,height:16},a[r.CIRCLE]="M11,8c0,1.657-1.343,3-3,3S5,9.657,5,8s1.343-3,3-3S11,6.343,11,8z M14,7h-2.142C11.942,7.322,12,7.653,12,8s-0.058,0.678-0.142,1H14c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M4,8c0-0.347,0.058-0.678,0.142-1H2C1.448,7,1,7.448,1,8c0,0.552,0.448,1,1,1h2.142C4.058,8.678,4,8.347,4,8z",o[r.CIRCLE]={width:16,height:16},a[r.SCATTER_ICON+r.NULL_MARKER]="M0,0L12,0L12,12L0,12Z",o[r.SCATTER_ICON+r.NULL_MARKER]={width:12,height:12},a[r.SCATTER_ICON+r.NORMAL_ICON]="M0,0L12,0L12,12L0,12Z",o[r.SCATTER_ICON+r.NORMAL_ICON]={width:12,height:12},a[r.SCATTER_ICON+r.CIRCLE]="M4,8C2.897,8,1.897,7.551,1.173,6.827S0,5.103,0,4s0.449-2.103,1.173-2.827S2.897,0,4,0s2.103,0.449,2.827,1.173S8,2.897,8,4S7.551,6.103,6.827,6.827S5.103,8,4,8",o[r.SCATTER_ICON+r.CIRCLE]={width:8,height:8},a[r.SQUARE]="M11,11H5V5h6V11z M14,7h-2v2h2c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M4,7H2C1.448,7,1,7.448,1,8c0,0.552,0.448,1,1,1h2V7z",o[r.SQUARE]={width:16,height:16},a[r.SCATTER_ICON+r.SQUARE]="M0,0h8c0,0,0,3.889,0,8C4,8,0,8,0,8V0z",o[r.SCATTER_ICON+r.SQUARE]={width:8,height:8},a[r.DIAMOND]="M8,11L5,8l3-3l3,3L8,11z M14,7h-2.586l1,1l-1,1H14c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M3.586,8l1-1H2C1.448,7,1,7.448,1,8c0,0.552,0.448,1,1,1h2.586L3.586,8z",o[r.DIAMOND]={width:16,height:16},a[r.SCATTER_ICON+r.DIAMOND]="M0,4.5L4.502,0l4.5,4.5c0,0,0,0-4.5,4.5C0,4.5,0,4.5,0,4.5z",o[r.SCATTER_ICON+r.DIAMOND]={width:9,height:9},a[r.TRIANGLE]="M5,10l3-5.196L11,10H5z M14,7h-3.577l1.155,2H14c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M5.577,7H2C1.448,7,1,7.448,1,8c0,0.552,0.448,1,1,1h2.423L5.577,7z",o[r.TRIANGLE]={width:16,height:16},a[r.SCATTER_ICON+r.TRIANGLE]="M4.5,0L9,8c0,0-4.617,0-9,0L4.5,0z",o[r.SCATTER_ICON+r.TRIANGLE]={width:9,height:8},a[r.CIRCLE_HOLLOW]="M4.142,9H2C1.448,9,1,8.552,1,8c0-0.552,0.448-1,1-1h2.142C4.058,7.322,4,7.653,4,8S4.058,8.678,4.142,9zM14,7h-2.142C11.942,7.322,12,7.653,12,8s-0.058,0.678-0.142,1H14c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M8,7C7.449,7,7,7.449,7,8s0.449,1,1,1s1-0.449,1-1S8.551,7,8,7 M8,5c1.657,0,3,1.343,3,3s-1.343,3-3,3S5,9.657,5,8S6.343,5,8,5L8,5z",o[r.CIRCLE_HOLLOW]={width:16,height:16},a[r.SCATTER_ICON+r.CIRCLE_HOLLOW]="M4,2c1.102,0,2,0.898,2,2S5.102,6,4,6S2,5.102,2,4S2.898,2,4,2 M4,0C1.791,0,0,1.791,0,4s1.791,4,4,4s4-1.791,4-4S6.209,0,4,0",o[r.SCATTER_ICON+r.CIRCLE_HOLLOW]={width:8,height:8},a[r.SQUARE_HOLLOW]="M4,9H2C1.448,9,1,8.552,1,8c0-0.552,0.448-1,1-1h2V9z M14,7h-2v2h2c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M9,7H7v2h2V7 M11,5v6H5V5H11L11,5z",o[r.SQUARE_HOLLOW]={width:16,height:16},a[r.SCATTER_ICON+r.SQUARE_HOLLOW]="M6,6H2V2h4V6z M8,0H0v8h8V0z",o[r.SCATTER_ICON+r.SQUARE_HOLLOW]={width:8,height:8},a[r.DIAMOND_HOLLOW]="M4.157,9H2C1.448,9,1,8.552,1,8c0-0.552,0.448-1,1-1h2.157l-1,1L4.157,9z M14,7h-2.157l1,1l-1,1H14c0.552,0,1-0.448,1-1C15,7.448,14.552,7,14,7z M8,5.986L5.986,8L8,10.014L10.014,8L8,5.986 M8,4.571L11.429,8L8,11.429L4.571,8L8,4.571L8,4.571z",o[r.DIAMOND_HOLLOW]={width:16,height:16},a[r.SCATTER_ICON+r.DIAMOND_HOLLOW]="M2.121,4.999L5,2.121l2.878,2.878L5,7.879L2.121,4.999z M5,0L0,4.999L5,10l4.999-5.001L5,0z",o[r.SCATTER_ICON+r.DIAMOND_HOLLOW]={width:10,height:10},a[r.TRIANGLE_HOLLOW]="M4.5,9H2C1.448,9,1,8.552,1,8s0.448-1,1-1h3.655L4.5,9z M14,7h-3.655L11.5,9H14c0.552,0,1-0.448,1-1S14.552,7,14,7z M8,6.938L6.232,10h3.536L8,6.938 M8,4.938L11.5,11h-7L8,4.938L8,4.938z",o[r.TRIANGLE_HOLLOW]={width:16,height:16},a[r.SCATTER_ICON+r.TRIANGLE_HOLLOW]="M5.001,3.34L7.402,7.5H2.598L5.001,3.34z M5.001,0.34L0,9h10L5.001,0.34z",o[r.SCATTER_ICON+r.TRIANGLE_HOLLOW]={width:10,height:9},{getLegendIconPath:e,getLegendIconSize:i,hasIcon:n}}),i("component/Base",["require","../utils/BaseUtils","../utils/ColorUtils","../Constants","../dom/Evented","../utils/QueryUtils","../utils/Formatter","./LegendIconFactory","../utils/Class"],function(t){var e=t("../utils/BaseUtils"),i=t("../utils/ColorUtils"),n=t("../Constants"),r=t("../dom/Evented"),a=(t("../utils/QueryUtils"),t("../utils/Formatter")),o=(t("./LegendIconFactory"),t("../utils/Class"),4.5),s=r.extend({initialize:function(t,e,i){this.componentType=e,this.vanchart=i,this.refresh(t)},refresh:function(t){this.options=t||this.options,t=this.options,e.extend(this,{isFloat:t.floating,_floatX:this._getPercentValue(t.x,this.vanchart.width),_floatY:this._getPercentValue(t.y,this.vanchart.height)}),e.convertToREMUseDefault16PX(t.style),this._refresh&&this._refresh(t)},useHtmlLabel:function(){return this.options.useHtml||!e.isSupportSVG()},_getLegendType:function(t){var i=t.marker,r="";switch(t.type){case n.MULTIPIE_CHART:case n.PIE_CHART:return t.innerRadius&&parseFloat(t.innerRadius)>0?n.DONUT_ICON:n.PIE_ICON;case n.RADAR_CHART:if(t.columnType)return n.NORMAL_ICON;break;case n.FORCE_BUBBLE_CHART:case n.BUBBLE_CHART:return n.BUBBLE_ICON;case n.TREEMAP_CHART:return n.TREEMAP_ICON;case n.LINE_MAP:return n.NULL_MARKER;default:r=n.NORMAL_ICON}return t.type==n.POINT_MAP&&t.icon?t.icon.iconUrl:(t.image&&e.isSupportSVG()?r=t.image:i&&(r=i.symbol,t.type!=n.SCATTER_CHART||e.isImageMarker(r)||(r=n.SCATTER_ICON+i.symbol)),r)},_getPercentValue:function(t,e){return t?(t+="",-1!=t.indexOf("%")&&(t=parseFloat(t)*e/100),parseFloat(t)):0},_setComponentBounds:function(t,e){this.isFloat||this.options&&this.options.onZero?this._updateFloatBounds(t,e):this._updateComponentBounds(t,e)},isHorizontal:function(){var t=this.getPosition();return t==n.TOP||t==n.BOTTOM},isVertical:function(){return!this.isHorizontal()},getPosition:function(){return this.options.position},_updateFloatBounds:function(t,e){e=Math.ceil(e);var i=this.vanchart.getPlotBounds(),r=this._floatX,a=this._floatY,o=i.x+i.width-r,s=i.y+i.height-a;switch(t){case n.TOP:this.bounds={x:r,y:a,width:o,height:e};break;case n.BOTTOM:this.bounds={x:r,y:a,width:o,height:e};break;case n.LEFT:this.bounds={x:r,y:a,width:e,height:s};break;case n.RIGHT_TOP:case n.RIGHT:this.bounds={x:r,y:a,width:e,height:s}}},_updateComponentBounds:function(t,e){e=Math.ceil(e);var i=this.vanchart.getPlotBounds(),r=i.x,a=i.y,o=i.width,s=i.height;switch(t){case n.TOP:this.bounds={x:r,y:a,width:o,height:e};break;case n.BOTTOM:this.bounds={x:r,y:a+s-e,width:o,height:e};break;case n.LEFT:this.bounds={x:r,y:a,width:e,height:s};break;case n.RIGHT_TOP:case n.RIGHT:this.bounds={x:r+o-e,y:a,width:e,height:s}}this.vanchart.setPlotBounds(i),this._clipPlotBounds(t,e)},_clipPlotBounds:function(t,e){e=Math.ceil(e);var i=this.vanchart.getPlotBounds(),r=i.x,a=i.y,o=i.width,s=i.height;switch(t){case n.TOP:i={x:r,y:a+e,width:o,height:s-e};break;case n.BOTTOM:i={x:r,y:a,width:o,height:s-e};break;case n.LEFT:i={x:r+e,y:a,width:o-e,height:s};break;case n.RIGHT_TOP:case n.RIGHT:i={x:r,y:a,width:o-e,height:s}}this.vanchart.setPlotBounds(i)},_recordForPlotBounds:function(t,e){e=Math.ceil(e),t===n.RIGHT_TOP&&(t=n.RIGHT),this.vanchart.clipPool[t]=Math.max(this.vanchart.clipPool[t]||0,e)},_getBackgroundColor:function(){var t=this.option,e="string"==typeof t.plotBackgroundColor,n="string"==typeof t.backgroundColor,r=e?t.plotBackgroundColor:n?t.backgroundColor:"white";return i.colorToHex(r)},getMousePos:function(t){var i=this.vanchart.getParentDom();return e.getMousePos(t,i)},_maxHeight:function(t){var e=this.vanchart.height;return t||this.options.maxHeight?this._getPercentValue(this.options.maxHeight,e):e},_maxWidth:function(t){var e=this.vanchart.width;return t||this.options.maxWidth?this._getPercentValue(this.options.maxWidth,e):e},_getTickContent:function(t,e){return e?a.format(t,e):t},getDefaultMarkerRadius:function(){return o},getPlotBounds:function(){return this.vanchart.getPlotBounds()},getChartBounds:function(){return this.vanchart.getChartBounds()},getParentDom:function(){return this.vanchart.getParentDom()},getDivParentDom:function(){return this.vanchart.getDivParentDom()},getTooltipComponent:function(){return this.vanchart.components.tooltip},remove:function(){},_bindData:function(t,e,i){var n,r,a,o,s=t.length,l=e.length,h=[],u=[],c=[],d={},f=[];for(n=-1;++n<s;)a=t[n],r=i?i(a.datum()):n,d[r]=a,f[n]=r;for(n=-1;++n<l;)o=e[n],r=i?i(o):n,a=d[r],a?a!==!0&&(a.datum(o),c.push(a)):h.push(o),d[r]=!0;for(n=-1;++n<s;)d[f[n]]!==!0&&u.push(t[n]);return{update:c,enter:h,exit:u}},invisible:function(){return e.hasDefined(this.options.visible)&&this.options.visible===!1},_innerClip:function(t){var i=this,n=i.bounds,r=i.vanchart,a=r.renderer,o=e.makeBounds(0,0,n.width,n.height);if(this._clip?a.updateClip(this._clip,o):this._clip=a.createClip(o),"vgroup"===t.type){var s=0,l=0,h=l+o.width,u=s+o.height;t.divG.style({clip:"rect("+s+"px "+h+"px "+u+"px "+l+"px)"}),a.clip(t.renderG,this._clip)}else a.clip(t,this._clip)}});return s}),i("component/Tooltip",["require","./Base","../utils/BaseUtils","../Constants","../utils/ColorUtils","../ComponentLibrary"],function(t){var e=t("./Base"),i=t("../utils/BaseUtils"),n=(t("../Constants"),t("../utils/ColorUtils")),r=t("../ComponentLibrary"),a=.4,o=e.extend({_gCssText:"position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:2000;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;pointer-events:none;",_style:function(t){if(!t)return"";var e=[];if(t.animation&&!t.follow){var r="left "+a+"s,top "+a+"s";e.push("transition:"+r),e.push("-moz-transition:"+r),e.push("-webkit-transition:"+r),e.push("-o-transition:"+r)}if(t.style){var o=i.cssNormalization(t.style);for(var s in o)"color"==s?e.push(s+":"+n.colorToHex(o[s])):e.push(s+":"+o[s])}if(t.backgroundColor)if("string"==typeof t.backgroundColor)if(i.isSupportSVG())e.push("background-Color:"+t.backgroundColor);else{var l=n.colorToHexAlpha(t.backgroundColor),h="#"+("0"+(255*l.alpha|0).toString(16)).slice(-2)+l.hex.replace("#","");e.push("filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="+h+", endColorstr="+h+", GradientType=0)")}else if("object"==typeof t.backgroundColor){var u=t.backgroundColor,c=n.colorToHex(u.startColor),d=n.colorToHex(u.endColor),f="left",p="left top",g="right top",m=1;u.x1==u.x2&&(f="top",p="left top",g="left bottom",m=0),e.push("background: -ms-linear-gradient("+f+", "+c+", "+d+")"),e.push("background-image: -moz-linear-gradient("+f+", "+c+", "+d+")"),e.push("background-image: -webkit-gradient(linear, "+p+", "+g+", color-stop(0, "+c+"), color-stop(1, "+d+"))"),e.push("filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="+c+", endColorstr="+d+", GradientType="+m+")")}null!=t.borderWidth&&e.push("border-width:"+t.borderWidth+"px"),null!=t.borderColor&&e.push("border-color:"+t.borderColor),null!=t.borderRadius&&(e.push("border-radius:"+t.borderRadius+"px"),e.push("-moz-border-radius:"+t.borderRadius+"px"),e.push("-webkit-border-radius:"+t.borderRadius+"px"),e.push("-o-border-radius:"+t.borderRadius+"px")),t.shadow&&e.push("box-shadow:1px 1px 2px rgba(0,0,0,0.2)");var v=t.padding;return null!=v&&void 0!=v&&(v=i.reformCssArray(v),e.push("padding:"+v[0]+"px "+v[1]+"px "+v[2]+"px "+v[3]+"px")),e=e.join(";")+";"},doLayout:function(t){this._tDom||(t=t||this.vanchart.getDivParentDom(),this._tDom=document.createElement("div"),this._hiddenDom=document.createElement("div"),this._tDom.onselectstart=function(){return!1},this._tDom.style.position="absolute",this._hiddenDom.style.visibility="hidden",t.appendChild(this._tDom),t.appendChild(this._hiddenDom),this._tooltipHideTick=null)},remove:function(){if(this._tDom){var t=this.vanchart.getDivParentDom();t.removeChild(this._tDom),t.removeChild(this._hiddenDom)}},showWithPoint:function(t,e,n){if(t&&t.tooltip){var r=n||t,a=r.tooltip,o=t.series,s=r.series.calculateTooltipContent(r),l=this.calculateTooltipDivDim(a,s),h=o.getTooltipPos(t,l,e);h&&(this._show(h,a,s),this._tooltipRect=i.makeBounds(h,l))}},_getTooltipText:function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");return t.indexOf("Trident/7.0")>0||t.indexOf("Edge/")>0||e>0&&10===parseInt(t.substring(e+5,t.indexOf(".",e)),10)?function(t){for(var e,i="",n=!0,r=-1,a=t.length;++r<a;)e=t.charAt(r),n&&"-"===e?e="&#150;":"<"===e?n=!1:">"===e&&(n=!0),i+=e;return i}:function(t){return t}}(),_show:function(t,e,i){t&&e&&i&&!this.vanchart.isMouseDown&&(clearTimeout(this._tooltipHideTick),this._tDom.innerHTML=this._getTooltipText(i),this._tDom.style.cssText=this._gCssText+this._style(e)+"left:"+t[0]+"px;top:"+t[1]+"px;")},hide:function(){clearTimeout(this._tooltipHideTick),this._tooltipHideTick=setTimeout(function(){this._tDom.style.display="none"}.bind(this),400)},immediateHide:function(){
    this._tDom.style.display="none"},calculateTooltipDivDim:function(t,e){t=t||"";var i=this._hiddenDom;i.innerHTML=e,i.style.cssText=this._gCssText+this._style(t)+"visibility:hidden;";var n=i.offsetWidth,r=i.offsetHeight;return{width:n,height:r}},render:function(){}});return r.register(r.TOOLTIP_COMPONENT,o),o}),i("Carousel",["require","./utils/BaseUtils","./utils/QueryUtils","./utils/DomUtils","./utils/ColorUtils","./utils/PathUtils","./Constants","./utils/BezierEasing","./vector/ElementWrapper","./vector/SvgRenderer","./vector/VmlRenderer","./component/Tooltip"],function(t){function e(t){var e=t.title;return e.text&&e.useHtml?c.getPlainText(e.text):e.text||""}function i(t,e){Object.keys(e).map(function(i){"string"==typeof e[i]&&(t.style[i]=e[i])})}function n(t){var e=p.getRGBAColorArray(t),i=p.rgb2hsb(e[0],e[1],e[2]);return p.toColor(p.hsb2rgb(i[0],.85*i[1],100*(i[2]+.15)/115),"hex")}function r(t){var e=p.getRGBAColorArray(t),i=p.rgb2hsb(e[0],e[1],e[2]);return p.toColor(p.hsb2rgb(i[0],.75*i[1],100*(i[2]+.25)/125),"hex")}function a(t,e){var i=t.className.split(" ");-1===i.indexOf(e)&&(t.className+=" "+e)}function o(t,e){var i=t.className.split(" "),n=i.indexOf(e);-1!==n&&(i.splice(n,n),t.className=i.join(" "))}function s(t,e,i){if(c.isSupportSVG()){var n="<svg width=22 height=22><g>"+L[e]+"</g></svg>";t.innerHTML=n,t.querySelector("g").setAttribute("fill",i),e===m.RADAR_CHART&&t.querySelector("g").setAttribute("stroke",i)}else t.innerHTML='<img width="22" height="22" src="data:image/png;base64,'+C[e]+'">'}function l(t,e){if(c.isSupportSVG())t.style.background=e,t.innerHTML='<svg width=30 height=30><path fill="none" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M11.1,21.5L20.9 15 11.1 8.5 M11.1,21.5z"></path></svg>';else{var i=u("shape");i.path=g.circlePath(15,15,15),i.stroked="False",i.fillcolor=e;var n=u("fill");n.color=e,n.opacity=.5,i.appendChild(n),t.appendChild(i);var r=u("shape");r.path=/vanchart-arrow-left/.test(t.className)?"m19,22 l9,15 l19,9 e":"m11,22 l21,15 l11,9 e",r.filled="False",r.strokecolor="#ffffff",t.appendChild(r),Hammer.on(t,"mouseover",function(){n.opacity=.2}),Hammer.on(t,"mouseout",function(){n.opacity=.5})}}function h(t){var e=u("shape");e.style.width="100%",e.style.height="100%",e.coordsize="10 10",e.path=g.circlePath(5,5,5),e.stroked="False",e.fillcolor="#7f7f7f";var i=u("fill");i.color="#7f7f7f",i.opacity=.5,e.appendChild(i),t.appendChild(e)}function u(t){var e=y.prototype.create(t);return e.style.cssText=P,e.coordsize="1 1",e}var c=t("./utils/BaseUtils"),d=t("./utils/QueryUtils"),f=t("./utils/DomUtils"),p=t("./utils/ColorUtils"),g=t("./utils/PathUtils"),m=t("./Constants"),v=t("./utils/BezierEasing"),y=(t("./vector/ElementWrapper"),t("./vector/SvgRenderer"),t("./vector/VmlRenderer")),_=t("./component/Tooltip"),x=3.4375,T={type:m.BUTTON,color:"#7f7f7f",interval:1e3,style:{fontSize:"16px",color:"#ffffff"}},b={borderWidth:1,borderColor:"#000000",borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.5)",padding:5,shadow:!0,animation:!0,style:{fontSize:"12px",fontFamily:"MicrosoftYaHei, sans-serif",color:"#515151"}},A=function(t){function u(i,n){var r=e(i),a=N[n];return a.mText&&(a.mText.textContent?a.mText.textContent=r:a.mText.innerText=r,B(a)),a._title=r,E(i,t.charts[n],Y[n],n)}function g(t,e,o){t&&t.switchStyle||R();var s=t.options,h=d.merge(T,t.switchStyle,!0);c.isSupportSVG()||h.style.color&&(h.style.color=p.colorToHex(h.style.color)),G=o,D=h.type,Q=s.length,I=I||f.create("div","vanchart-menu",o),U=U||f.create("div","vanchart-cc",o),o.style.overflow="hidden",J.doLayout(o);var u=h.color;switch(e.splice(Q).map(function(t){t.remove()}),N.splice(Q).map(function(t){f.remove(t)}),Y.splice(Q).map(function(t){f.remove(t)}),a(U,"van-ani"),q=q>=Q?0:q,D){case m.CAROUSEL:I.style.bottom=0,I.style.height="18px",I.style.width="100%",I.mWrap=I.mWrap||f.create("div","vanchart-menu-wrap",I),U.style.cssText="top:0;bottom: 18px;left:"+100*-q+"%;width:"+100*Q+"%",c.isSupportSVG()||(U.style.height=G.clientHeight-18+"px"),H=H||f.create("div","vanchart-arrow-wrap",o),F=F||f.create("div","vanchart-arrow-wrap",o),F.style.right=0;var g=H.arrowLeft=H.arrowLeft||f.create("div","vanchart-arrow vanchart-arrow-left",H),v=F.arrowRight=F.arrowRight||f.create("div","vanchart-arrow vanchart-arrow-right",F);l(g,u),l(v,u);var _=h.interval;return new Hammer(g).on("tap",function(t){t.preventDefault(),R(_);var e=(Q+q-1)%Q;O(e,m.LEFT),S(e)}),new Hammer(v).on("tap",function(t){t.preventDefault(),R(_);var e=(q+1)%Q;O(e,m.RIGHT),S(e)}),Hammer.on(o,"mouseover",function(){R()}),Hammer.on(o,"mouseout",function(){R(_)}),R(_),y(s,e);case m.BUTTON:default:var b=n(u),A="width:100%;top:0;background-color:"+u+";filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="+b+", endColorstr="+p.colorToHex(u)+", GradientType=0);";A+="background-image: -webkit-gradient(linear, left top, left bottom, from("+b+"), to("+u+"));",A+="background-image: -moz-linear-gradient(top"+b+", "+u+");",A+="background-image: -webkit-linear-gradient(top"+b+", "+u+");",A+="background-image: linear-gradient(to bottom"+b+", "+u+");",I.style.cssText=A,i(I,h.style),j=c.getTextHeight(h.style);var L=j*x;return U.style.cssText="left:"+100*-q+"%;top:"+L+"px;bottom: 0;width:"+100*Q+"%",c.isSupportSVG()||(U.style.height=G.clientHeight-L+"px"),C(s,e,h.style.color,r(u))}}function y(t,e){z=z||f.create("div","vanchart-chart",U),z.style.width=100/Q+"%",z.style.marginLeft=-100/Q+"%",tt&&(z.style.width=G.clientWidth+"px",z.style.marginLeft=-G.clientWidth+"px");var i=t.map(function(t,i){return A(t,i),E(t,e[i],Y[i],i)});return W=W||f.create("div","vanchart-chart",U),W.style.width=100/Q+"%",W.style.marginRight=-100/Q+"%",tt&&(W.style.width=G.clientWidth+"px",W.style.marginLeft=-G.clientWidth+"px"),i}function A(t,i){var n=e(t),r=N[i];if(!Y[i]){if(Y[i]=f.create("div","vanchart-chart",U),N[i]=r=f.create("div","vanchart-menu-dot",I.mWrap),!c.isSupportSVG()){r.style.background="none";var o=f.create("div","vanchart-menu-dot-ie",r);h(o)}i||a(r,"van-on")}r._title=n,r.i=i,Hammer.on(r,"mouseover",function(){L(r)}),Hammer.on(r,"mouseout",function(){J.immediateHide()}),new Hammer(r).on("tap",function(t){t.preventDefault(),O(i),S(i)})}function L(t){var e=J.calculateTooltipDivDim(b,t._title),i=[G.clientWidth/2-(Q-1)/2*16+16*t.i-e.width/2,G.clientHeight-18-e.height];i[0]=Math.min(Math.max(i[0],0),G.clientWidth-e.width),J._show(i,b,t._title)}function C(t,e,i,n){return t.map(function(t,r){return P(t,r,i,n),E(t,e[r],Y[r],r)})}function P(t,i,n,r){var a=e(t),o=N[i];if(Y[i]||(Y[i]=f.create("div","vanchart-chart",U),N[i]=o=f.create("div","vanchart-menu-btn",I),o.mIcon=f.create("span","vanchart-menu-icon",o),o.mText=f.create("span","vanchart-menu-text",o),c.isSupportSVG()||o.insertAdjacentHTML("afterBegin",'<span class="vanchart-menu-btn_before"></span>'),i||(o.style.background=r)),s(o.mIcon,t.chartType,n),o.style.width=100/Q+"%",!c.isSupportSVG()){var l=G.clientWidth/Q;tt&&(l-=2*j+1),o.style.width=l+"px",0!==o.offsetTop&&(o.style.width=l-1+"px")}o.mText.textContent?o.mText.textContent=a:o.mText.innerText=a,o._title=a,o.i=i,B(o),Hammer.on(o,"mouseover",function(){o.style.background=r,M(o)}),Hammer.on(o,"mouseout",function(){q!==i&&(o.style.background=""),J.immediateHide()}),new Hammer(o).on("tap",function(t){t.preventDefault(),N[q].style.background="",N[i].style.background=r,S(i)})}function M(t){var e=!1;if(e=c.isSupportSVG()?t.scrollWidth>t.clientWidth:t.scrollWidth>=t.clientWidth,e||""===t.mText.innerHTML){var i=J.calculateTooltipDivDim(b,t._title),n=[G.clientWidth*(t.i+.5)/Q-i.width/2,t.offsetHeight];n[0]=Math.min(Math.max(n[0],0),G.clientWidth-i.width),J._show(n,b,t._title)}}function E(e,i,n,r){if(n.style.width=100/Q+"%",!c.isSupportSVG()||n.offsetLeft<G.clientWidth*r){var a=G.clientWidth*r-n.offsetLeft;n.style.width=G.clientWidth+a+"px"}var o,s=n;return r===Q-1?(V||(V=w(n)),s=V):0===r&&(X||(X=w(n)),s=X),o=t._initSingle(e,i,s),r!==q&&o.set({enable:!1}),o}function w(t){var e=f.create("div","vanchart-chart-wrap",t);return e.style.cssText="width:100%;height:100%",e}function O(t,e){var i;e===m.RIGHT&&q===Q-1&&0===t?(Y[0].appendChild(X),z.appendChild(V),o(U,"van-ani"),U.style.left="100%",i=U.clientWidth):e===m.LEFT&&0===q&&t===Q-1?(Y[Q-1].appendChild(V),W.appendChild(X),o(U,"van-ani"),U.style.left=100*-Q+"%",i=U.clientWidth):(Y[0].appendChild(X),Y[Q-1].appendChild(V)),a(U,"van-ani")}function S(e){if(o(N[q],"van-on"),t.charts[q].set({enable:!1}),a(N[e],"van-on"),t.charts[e].set({enable:!0}),$)U.style.left=100*-e+"%";else{var i=v.css.swing;k(U,"left",100*-e+"%",500,i)}q=e}function k(t,e,i,n,r){function a(){c>=n?(u=l,t.style[e]=u+h):(u=o+(l-o)*r(c/n),t.style[e]=u+h,c+=d,K=window.setTimeout(a,d))}window.clearTimeout(K);var o=parseFloat(t.style[e])||0,s=i.match(/([\d.E-]+)(.*)/i),l=+s[1],h=s[2],u=o,c=0,d=17;a()}function R(t){window.clearInterval(Z),t&&(Z=window.setInterval(function(){var t=(q+1)%Q;O(t,m.RIGHT),S(t)},t))}function B(t){t.clientWidth<=22+3*j&&(t.mText.innerHTML="",t.mText.style.marginLeft=0,tt||(t.style.padding=0))}var D=null,G=null,I=null,N=[],H=null,F=null,U=null,z=null,V=null,W=null,X=null,Y=[],q=0,Q=0,Z=null,K=null,j=0,J=new _({},m.TOOLBAR_COMPONENT,{}),$="transition"in document.getElementsByTagName("body")[0].style,tt=/MSIE 7/.test(navigator.userAgent);return{init:g,refresh:u}},L={};L[m.PIE_CHART]='<path d="M12,0.266v10.041l9.519-1.314C20.642,4.339,17,0.742,12,0.266z"/> <path d="M21.744,10.061l-7.309,1.009L11,11.511V11v-0.545V9.651V0.208C5.04,0.208,0.208,5.04,0.208,11 c0,5.96,4.832,10.792,10.792,10.792c0,0,1.214,0,1.602-0.12l0.006-0.012c5.195-0.778,9.183-5.247,9.183-10.659 C21.792,10.683,21.771,10.371,21.744,10.061z"/>',L[m.BAR_CHART]='<rect x="0.937" y="6.794" width="8.112" height="2.704"/> <rect x="0.938" y="12.502" width="13.52" height="2.704"/> <rect x="0.938" y="18.211" width="17.125" height="2.704"/> <rect x="0.937" y="1.086" width="6.309" height="2.704"/>',L[m.COLUMN_CHART]='<rect x="0.625" y="11.943" width="2.83" height="9.432"/> <rect x="6.284" y="8.17" width="2.83" height="13.205"/> <rect x="12.886" y="4.398" width="2.83" height="16.977"/> <rect x="18.545" y="0.625" width="2.83" height="20.75"/>',L[m.LINE_CHART]='<path d="M20.527,2.742c-0.813,0-1.473,0.659-1.473,1.473c0,0.308,0.095,0.593,0.256,0.83l-4.155,7.48 c-0.005,0-0.01-0.002-0.016-0.002c-0.296,0-0.571,0.089-0.802,0.24l-5.74-3.399c0.005-0.05,0.015-0.098,0.015-0.149 c0-0.814-0.66-1.473-1.473-1.473S5.667,8.402,5.667,9.215c0,0.154,0.03,0.299,0.074,0.439L1.987,13.84 c-0.161-0.06-0.333-0.097-0.514-0.097C0.66,13.742,0,14.402,0,15.215s0.66,1.473,1.473,1.473s1.473-0.659,1.473-1.473 c0-0.265-0.076-0.511-0.198-0.726l3.614-4.028c0.227,0.142,0.492,0.227,0.778,0.227c0.399,0,0.76-0.16,1.025-0.418l5.572,3.299 c-0.042,0.136-0.07,0.277-0.07,0.427c0,0.814,0.66,1.473,1.473,1.473s1.473-0.659,1.473-1.473c0-0.445-0.202-0.84-0.514-1.11 l4.033-7.259c0.126,0.035,0.257,0.06,0.395,0.06C21.34,5.688,22,5.029,22,4.215S21.34,2.742,20.527,2.742z"/>',L[m.AREA_CHART]='<path d="M15.255,15.935c0.045,0.075,0.079,0.159,0.079,0.253c0,0.276-0.224,0.5-0.5,0.5s-0.5-0.224-0.5-0.5 c0-0.106,0.041-0.199,0.097-0.28l-7.79-8.953C6.571,6.993,6.493,7.021,6.406,7.021c-0.106,0-0.199-0.04-0.28-0.097L1,12.315V21h21 V9.832L15.255,15.935z"/> <path d="M6.642,6.955C6.797,6.87,6.906,6.711,6.906,6.521c0-0.276-0.224-0.5-0.5-0.5s-0.5,0.224-0.5,0.5 c0,0.17,0.09,0.313,0.22,0.403C6.208,6.981,6.3,7.021,6.406,7.021C6.493,7.021,6.571,6.993,6.642,6.955z"/> <path d="M14.834,16.688c0.276,0,0.5-0.224,0.5-0.5c0-0.094-0.033-0.178-0.079-0.253c-0.087-0.145-0.24-0.247-0.421-0.247 c-0.17,0-0.312,0.09-0.403,0.22c-0.057,0.081-0.097,0.174-0.097,0.28C14.334,16.464,14.558,16.688,14.834,16.688z"/> <polygon points="1,12.315 1,0 0,0 0,22 0.088,22 22,22 22,21 1,21 "/>',L[m.GAUGE_CHART]='<path d="M11,1.149c-6.042,0-10.958,4.916-10.958,10.958c0,2.103,0.597,4.146,1.729,5.908l1.845-1.184 c-0.904-1.408-1.381-3.042-1.381-4.724c0-4.834,3.933-8.766,8.766-8.766s8.766,3.933,8.766,8.766c0,1.682-0.477,3.315-1.38,4.723 l1.845,1.184c1.13-1.762,1.728-3.804,1.728-5.907C21.958,6.065,17.042,1.149,11,1.149z"/> <path d="M11.49,12.11L11,4.273l-0.49,7.837c-0.236,0.16-0.4,0.417-0.4,0.724c0,0.492,0.398,0.89,0.89,0.89s0.89-0.399,0.89-0.89 C11.89,12.527,11.726,12.27,11.49,12.11z"/>',L[m.RADAR_CHART]='<polygon fill="none" stroke-miterlimit="10" points="6.828,20.531 1.417,13.746 3.348,5.286 11.167,1.521 18.985,5.286 20.916,13.746 15.506,20.531 "/> <polyline fill="none" stroke-miterlimit="10" points="3.38,5.38 11.042,10.885 15.506,20.531 "/> <polyline fill="none" stroke-miterlimit="10" points="18.985,5.286 11.057,10.87 1.417,13.746 "/> <line fill="none" stroke-miterlimit="10" x1="11.026" y1="10.885" x2="20.916" y2="13.746"/> <line fill="none" stroke-miterlimit="10" x1="11.167" y1="1.521" x2="11.042" y2="10.901"/> <line fill="none" stroke-miterlimit="10" x1="11.042" y1="10.885" x2="6.835" y2="20.539"/>',L[m.SCATTER_CHART]='<circle cx="14.625" cy="12.158" r="0.916"/> <circle cx="14.625" cy="7.383" r="1.291"/> <circle cx="7.958" cy="12.699" r="0.916"/> <circle cx="21.293" cy="3.702" r="0.707"/> <circle cx="2.041" cy="16.965" r="2.041"/>',L[m.BUBBLE_CHART]=L[m.FORCE_BUBBLE_CHART]='<circle cx="3.521" cy="14.938" r="3.521"/> <circle cx="11.927" cy="5.5" r="1.958"/> <circle cx="20.667" cy="10.219" r="1.333"/>',L[""]='<rect x="2" y="12" width="3" height="9"/> <rect x="7" y="8" width="3" height="13"/> <rect x="12" y="9" width="3" height="12"/> <rect x="17" y="5" width="3" height="16"/> <path d="M20.172,0.911c-0.507,0-0.917,0.411-0.917,0.917c0,0.056,0.022,0.105,0.032,0.158l-4.522,3.532 c-0.156-0.121-0.342-0.205-0.554-0.205c-0.404,0-0.737,0.266-0.859,0.629L8.582,5.56C8.425,5.278,8.135,5.079,7.79,5.079 c-0.507,0-0.917,0.411-0.917,0.917c0,0.053,0.021,0.1,0.031,0.151L2.395,9.78C2.238,9.654,2.046,9.567,1.828,9.567 c-0.506,0-0.917,0.411-0.917,0.917s0.411,0.917,0.917,0.917c0.507,0,0.917-0.411,0.917-0.917c0-0.121-0.026-0.236-0.069-0.342 l4.42-3.563c0.168,0.2,0.411,0.335,0.693,0.335c0.495,0,0.893-0.394,0.91-0.884l4.627,0.372c0.082,0.422,0.437,0.747,0.883,0.747 c0.507,0,0.917-0.411,0.917-0.917c0-0.127-0.026-0.248-0.073-0.358l4.428-3.457c0.168,0.197,0.41,0.329,0.689,0.329 c0.506,0,0.917-0.411,0.917-0.917C21.089,1.322,20.678,0.911,20.172,0.911z"/>',L[m.MULTIPIE_CHART]='<path d="M5.267,10.754c0,0.009-0.002,0.018-0.002,0.028c0,2.918,2.276,5.356,5.194,5.356l0.017-0.002 C7.585,16.12,5.291,13.643,5.267,10.754z"/> <path d="M10.499,18.487l0.003,0c2.997,0,5.568-1.763,6.804-4.219C16.071,16.724,13.5,18.486,10.499,18.487z"/> <path d="M2.916,10.745c0,0.012-0.002,0.025-0.002,0.037c0,4.215,3.329,7.705,7.544,7.705 c0.008,0,0.015-0.001,0.022-0.001C6.288,18.474,2.935,14.937,2.916,10.745z"/> <path fill-opacity = "0.2" d="M18.856,10h2.233C20.546,5,16,0.396,11,0.212v2.213C15,2.604,18.326,6,18.856,10z"/> <path fill-opacity = "0.6" d="M16.104,10h2.752C18.326,6,15,2.604,11,2.424v2.724C13,5.318,15.603,8,16.104,10z"/> <path d="M11,5.149V10h5.104C15.603,8,13,5.318,11,5.149z"/> <path fill-opacity = "0.2" d="M17.752,13.176c-0.119,0.376-0.269,0.741-0.445,1.092c-1.236,2.456-3.807,4.219-6.804,4.219l-0.003,0 l-0.004,0c0,0-0.007-0.001-0.015-0.001c-0.008,0-0.015,0.001-0.022,0.001c-4.215,0-7.544-3.49-7.544-7.705 c0-0.012,0.002-0.025,0.002-0.037c0-0.012-0.002-0.024-0.002-0.036C2.914,6.708,6,3.432,10,3.109V1.2 c-5,0.329-8.994,4.454-8.994,9.509c0,5.269,4.227,9.686,9.496,9.686c5.27,0,9.497-4.395,9.497-9.395h-1.908 C18.091,11.75,17.972,12.482,17.752,13.176z"/> <path fill-opacity = "0.6" d="M2.914,10.709c0,0.012,0.002,0.024,0.002,0.036c0.019,4.192,3.372,7.729,7.564,7.741 c0.007,0,0.015,0.001,0.015,0.001l0.004,0c3-0.001,5.572-1.764,6.808-4.219c0.177-0.351,0.326-0.716,0.445-1.092 c0.22-0.694,0.339-1.426,0.339-2.176h-2.349c0,3-2.321,5.138-5.239,5.138c-0.009,0-0.019-0.001-0.028-0.002l-0.017,0.002 c-2.917,0-5.194-2.438-5.194-5.356c0-0.009,0.002-0.018,0.002-0.028c0-0.015-0.002-0.03-0.002-0.045C5.264,8.007,7,5.783,10,5.468 V3.109C6,3.432,2.914,6.708,2.914,10.709z"/> <path d="M5.264,10.709c0,0.015,0.002,0.03,0.002,0.045c0.024,2.889,2.319,5.366,5.208,5.382c0.009,0,0.019,0.002,0.028,0.002 c2.918,0,5.239-2.138,5.239-5.138H10V5.468C7,5.783,5.264,8.007,5.264,10.709z"/>',L[m.AREA_MAP]=L[m.HEAT_MAP]=L[m.POINT_MAP]='<path d="M28.12 36.6h.03-.05z"/><path d="M19.53 15.7l.04-.02v-.04c0-.08-.1-.16-.2-.13h-.1c-.05 0-.1 0-.12.1 0 0 0 .1-.02.1-.07 0-.14.1-.17.2l-.1.2-.07.1-.1.1-.1.3v.2h-.1v.1h-.1l-.1.1v.5c0 .1 0 .4.1.4l.1-.1v.1h.2v.1h.2v-.2s-.1-.3.1-.5v-.9zM13-8.66h-.05.04zm7.2 16.68L20.18 8h-.1s-.03 0-.04.02h.18zM14.77 18v-.02s-.02.02 0 .02z"/><path d="M21.9 5.6c.05-.05-.02-.12-.05-.17 0 0-.04 0-.03-.02 0 0 .02-.1 0-.1h-.04v-.2c.02-.1 0-.1 0-.1.07 0 .1-.1.1-.1.05-.1 0-.2-.05-.2h.02c.05 0 .04-.1.04-.1l-.1-.1-.2.2h-.1c-.1 0-.1.1-.2.1l-.2.1c-.1 0-.1.1-.2.1l-.1.1c-.1 0-.1.1-.1.1l-.1.2s0 .1-.1.1-.2-.1-.2 0c-.1 0-.3 0-.4-.1V5c0-.1.2-.2.1-.24l.1-.1-.1-.05v.1l-.2-.1h-.4l-.1.1h-.2c.1-.1 0-.1 0-.1V4c0-.15-.1-.24-.2-.26v-.4l-.1-.05V3c0-.1-.1-.1-.1-.1 0-.1 0-.1-.1-.1h-.1c-.1-.1-.2 0-.2 0l-.3-.1-.1-.1v.14h-.5.1c0-.04.1 0 .1-.04L17 3v-.02l-.02-.1v.07-.02V3h-.07.1v.03s-.1 0-.1.02l-.1.04c0 .1-.1.1-.1.1l-.1.1s-.2 0-.2.1h.7-.2v.1l-.1-.1c.1 0 .1.1.1.1v.1h.1v.5c-.1.1-.3.1-.3.2l-.1.1v.2s-.1-.1-.1 0l-.1-.1H16c-.03 0-.1 0-.2.3l-.06.2h-.05c-.1 0-.1.1-.1.1h.1-.1c0 .1 0 .1.1.2 0 0 0 .1.1.1h.4s0 .1.1.1l.2-.2h.1l.1.1h.1l.2.2V6h-.2c-.1 0-.2 0-.2.03-.1 0-.2 0-.2.02l-.1.04c-.1 0-.2.4-.2.5V7H16c-.2 0-.3-.2-.3-.08-.07.1-.17-.04-.2-.02-.2 0-.28-.1-.35 0 0 .06-.03.05-.03.1s-.1.1-.1.1H15s-.04 0 0 0l-.4-.1-.1-.05c-.16 0-.25.2-.27.26-.04.1-.06.2-.05.2.04.2.15.3.2.3h-.06c-.3.2-.36.3-.36.3 0 .1-.1.1-.14.1h-.24s-.03-.1-.2-.1h-.05c-.04 0-.23.2-.3.2l-.1.1h-.03l-.02.1-.43.2-.37.4-.1.3h-.1s0-.2-.02-.2c0 0-.05-.1-.1-.1v-.2.2c-.04 0-.1.2-.16.2h-.1c-.1 0-.25-.3-.3-.4v-.1h-.04c-.2 0-.24-.2-.24-.2v-.1l-.6-.1H9l.03-.1-.08-.1.03.1c-.03-.1-.04 0-.03 0h-.02l.24-.7-.35.5-.06-.1-.04-.1c-.02 0-.03 0-.04-.1 0 0-.04-.2-.07-.2v-.1h-.2L8.3 7c0-.05-.2-.2-.2-.2-.1-.07-.2-.1-.4-.1h-.1l-.1-.04h-.2l-.1-.05s0 .2-.02.2V7H7.1v-.15c0-.02 0-.12-.03-.15v-.1c.05-.05.12-.1.14-.17l.1-.1v-.68l-.1-.1v-.03.3c0-.04 0 .2-.1.2H7c-.04 0-.06-.33-.1-.33s-.06-.2-.1-.2v-.4L6.5 5H6s.2-.05.17-.1l.1-.03c.03-.05.08-.06.08-.08 0-.1-.05-.1-.1-.1l-.12-.1H5.9c-.1 0-.1.1-.1.1V5h-.2c-.1 0-.1 0-.1.04l-.1.06c0 .02-.1.04-.1.07v.36l-.1.03c-.1 0-.1.2-.1.2L5 6s0-.3-.02-.3c0 0 0 .1-.1.1-.03 0-.1.1-.14.1l-.07-.3s0-.2-.05-.2c-.08 0-.1-.1-.1-.1 0-.05-.1-.1-.14-.1s-.1 0-.12.05v.05l-.07.04-.1.13-.1.05-.1.1c-.1 0-.1.03-.1.05v.08s-.1.1-.1.15V6l-.1-.04H3c-.03 0-.1.04-.13.1v.1c.03.07.1.1.14.1v.8s-.5 0-.5.04-.5.15-.5.15v.08l.4.03.1.04c-.1 0 0 .02-.1.03l-.1.03-.1.04H2c-.05 0-.1.03-.1.06-.05 0-.1 0-.1.03h-.1c0-.1-.04-.1-.1-.1h-.3s-.03 0-.05.1c-.04 0-.08.1-.1.1V8v-.2l-.02-.1c0-.04 0-.12-.1-.12 0 0-.1 0-.1.02v.2S1 8 .93 8H.8v-.16c-.03 0-.05-.1-.06-.1-.02 0-.04-.05-.07-.04 0 0 0-.03-.03-.03L.6 7.65H.5c-.06 0-.1.06-.1.07H.3c0 .02-.02.03-.03.04-.05.04-.05.1-.04.12H.15l-.02.02c-.06.04-.06.14-.02.2v.02l.1.02c0 .02-.1.06-.1.12 0 .04 0 .12.1.15v.1c.1.1.1.1.2.1h.1l.1.1.1.1V9s-.1.1 0 .2v-.05H.1c-.02.08 0 .18.06.2l.12.07H.3l.07.03H.4v.16h.1H0h.3c-.02.1.1.1.1.1-.06.1 0 .1 0 .1 0 .1.04.1.1.1 0 .1 0 .1.02.1l.03.1H.7l.04.1s.1.1.17.1H1l.1.1.2.1v.4l.3.1.1.1-.05.1h-.1s-.05 0-.06.1c-.1 0-.1.1-.1.1l-.2.1h-.1.1v.1l-.1.1v.1c-.1.1-.1.1-.1.2-.1 0-.1.1-.1.2v.1s-.1.1 0 .2v.1c-.1 0 0 0 0 .1-.1 0-.1 0-.1.1v.2l.1.1h.2l.1.1.1.1v.1h.1l.1.1h.1s.1 0 .1-.1V13H2v.1c0 .05.06.1.1.1h.1v.1l.1.1c0 .04 0 .04.03.05h.05v.14s.04.1.12.1H3v.1s.03.1.06.1h.05l.1.1h.2c0 .1 0 .1.1.2h.3l.1-.1H4c.05 0 .07.1.1.1 0 0 .03.1.07.1h.15v.3s.2.4.3.4h.05l.1-.3c.1 0 .1-.1.2-.2v-.1l.1-.07.04-.06v.15s0 .1.1.16c0 .1.1.1.2.1h.1c.1 0 .1-.1.1-.1v-.1h.1l.1-.1H6l.1.06h.2l.1.02H6v.1c0 .05.04.1.07.1h.16c-.04 0-.07.06-.07.1v.1c.03.1.17.1.2.1l.22.04H7c.02-.02.08-.03.1-.12l.03-.03.08-.07h.4l.1-.06h.1c.1-.05.1-.1.1-.1l.1-.04h.2l.2.1h.1c.1 0 .2.1.2.1h.2c.1-.05.1-.14.1-.2 0 .04.2.06.2.06v.1H9s-.03.04 0 .1v.2s0 .03.05.05c0 .1.05.1.08.1 0 .1.05.1.05.1v.1h.03v.4H9v.1h-.03c-.03 0-.04.1-.05.1h-.1v.2h-.1l-.1.1v.1l-.02.1v.1l.07.1-.1.1v.1c.04.1.07.1.1.1h.4s.03.1.05.1c0 0 0 .1.03.1-.03.02-.03.04 0 .06V17h.02l.1.28v.06c0 .05 0 .14.04.2H9l.15.03.04.02v.4-.5h.3v.2s0-.1.1-.1v-.2.1s0 .1.1.1h.2s.1 0 .1-.1v-.3l.1-.2v-.1c0 .1.1.1.1.1h.2l.1-.1s0 .3.1.3v.3h.1v-.6l.1-.1.1-.1c.1 0 .1-.1.1-.1h.2v.4l.1.5c.1 0 .2-.4.2-.4s.1 0 .1-.1v.1-.1.1h.1s0 .1.1.1c0 0 0 .1.2.1l.1-.1v-.1h.3v-.05h.4v.1c-.1 0-.2.2-.2.2-.1 0-.1.1-.1.2l-.1.1-.1.04v.1c-.07 0-.07 0-.07.1l.1.2c-.1 0 0 .1 0 .1s0 .1.1.1h.4l.1.02v-.05h.1l.1-.08h.06s.1.03.1 0l.1-.08V18h.1l.1-.2.2-.1-.1-.1c-.1-.1-.1-.1-.2-.14l-.3-.1H13h1v.1-.1h.1v-.14h.2s.1 0 .1-.1c.1.07.1.1.2 0h.1V17s.1-.1.18-.1.1.1.1.1c.1 0 .2-.04.2-.14v.6h.2c.08 0 .1-.4.1-.4V17l.1-.1v-.1l.1-.06c.1 0 .1 0 .1-.1v.4c.1.07.1.5.2.5l.1-.4V17h.1l.04-.03.02-.02c.1 0 .2-.04.2-.12l-.1-.05-.1-.05.2-.02h.2l.3.1-.1-.1h.23s.1 0 .1-.1v-.1h.3l.1-.1V16s.1 0 .1-.05l.1-.02.03-.04v-.1c.1 0 .1-.1.1-.1h.1v-.1c.08-.1.07-.2 0-.2v-.2h.05v-.4l.04-.1h.1l-.1-.1v-.5h.2v-.25c0-.1 0-.1-.03-.1l-.53-.1h.6l.1-.1.06-.08s.08-.1 0-.1l.07-.1V13h-.3c-.1-.06-.1-.07-.2-.07l.1-.1h.1l.1-.07-.1-.1v-.27c-.06-.1-.15-.2-.3-.2l-.06-.1s-.1-.1-.2-.1v-.1c0-.1 0-.1-.1-.2l-.1-.1v-.2c0-.1 0-.1-.03-.1l-.1-.2c-.1-.2-.1-.2-.1-.1-.1 0-.1-.1-.2 0-.1-.1-.4-.1-.5-.1l.3-.1h.2l.1-.1.6-.5-.46.1c0-.1.1-.1.1-.1.07 0 .17-.1.2-.1s.05-.1.04-.1l.1-.1v.2c.03 0 .04.2.05.2l.04-.3.1-.1c.06 0 .1-.1.1-.1l-.7-.1H17h.4l.1.1h.2l.1.1h.6c.1-.08.1-.28.1-.3l.1-.17c.1 0 .1-.1.1-.1v-.1h.1s.1 0 .1-.04l.1-.1c.1 0 .1 0 .1-.1.1 0 .1-.1.1-.1h.4l-.04-.1c-.1-.1 0-.1 0-.1v-.1c.1-.1.1-.1.1-.2.1 0 .17-.1.18-.1l.04-.1.05-.1.1-.1c0-.1.1-.2.1-.2l.06-.1h.3c0-.1.2-.1.2-.1v-.1l.3-.1c.1-.1.3-.2.3-.3s-.1-.1 0-.1v-.1s.1 0 .1-.1v-.3c0-.1 0-.2-.1-.2l-.1-.2c0-.1-.1-.1-.1-.1v-.1c.1-.1.1-.1.1-.2h.5c0-.1.1-.2.1-.3 0-.1-.1-.1-.1-.2zM1.25 11.5zm12.8 6.8h.04-.1z"/><path d="M17.38 10h.04"/><path d="M16 3.5h.23H16zm2.32 6.5l-.04-.02V10h.04zM21 7.34h.05L21 7.3v.03zm-4.4 5.4s-.02-.07-.1-.07h-.02v.15l-.03.14h-.03c-.03 0-.06-.13-.07-.13l-.02-.1c-.05 0-.1.08-.14.1-.1 0-.1.1-.1.1h.3c.1 0 .1.05.1.03v-.18l-.1-.05z"/>',L[m.TREEMAP_CHART]='<polygon fill-opacity = "0.6" points="11,0 11,10 11,13 11,14 11,16 11,22 22,22 22,16 22,14 22,13 22,10 22,0 "/> <rect y="14" fill-opacity = "0.2" width="10" height="8"/> <rect width="10" height="13"/>',L[m.FUNNEL_CHART]='<polygon points="20.06,6.533 1.989,6.533 1.082,1.656 20.966,1.656 "/> <polygon points="17.949,14.412 4.005,14.412 2.051,8.409 19.888,8.409 "/> <polygon points="14.963,20.79 6.944,20.79 4.271,15.912 17.933,15.912 "/>';var C={};C[m.PIE_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWBAMAAAA2mnEIAAAAMFBMVEUAAAD///////////////////////////////////////////////////////////87TQQwAAAAD3RSTlMAEM/vv4Bgr59AcFAg348jFhddAAAAjElEQVQY02MAArGSDx6JDGDAav//w//PASAmo/5/IPv/JwEgW/g/mP1fEcjWh7I/AVX/h7L/L2AQhrMvMOTD2b8Z6uHsfwz+ULZK1ByG/2B25smtLfYQ9hewLEQNRACoFwZ+AM2EgW9Au2DAkIEVzg6AuO0/xG1wRYpgv0CEBaB+/A/2I8Tv/zVAfgcA4kmspsM258YAAAAASUVORK5CYII=",C[m.BAR_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWBAMAAAA2mnEIAAAAElBMVEUAAAD///////////////////8+Uq06AAAABXRSTlMAQIAgEDB5ccoAAAA+SURBVBjTY0AGoqGhgTjZBICjoKCgCFw9SAMm20hJSUkZlwFwNWAgANELBgrobEdBMDDAZQZEPRQI4GQjAwAQhxXw9o2YjgAAAABJRU5ErkJggg==",C[m.COLUMN_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWBAMAAAA2mnEIAAAAG1BMVEUAAAD////////////////////////////////rTT7CAAAACHRSTlMAgEC/IGCPMNAZ/cwAAAAuSURBVBjTY4ADRSEEW6KRALvYDMHWaCbAtmgiwHZSgbOBiG5skJcDRRgcRYEMADB5J9shBWGXAAAAAElFTkSuQmCC",C[m.LINE_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMA74C/IM9AEN+vYDCfcFCP7HfXwgAAAG9JREFUGNPNjzsOxDAIRA0Yf+J1du5/2siKIQ1dmlA9PQ2gSa8nHznSBIo0gOgGlAPdm+M4HQuK4Qn8jEU88QdoZw6MZ0+lQ/Li5muDFpYGrokpu9UbJjUmtqaqdQeqAN2aYln7hx41nbwzLDN9Yi4tRQMa2y+S7gAAAABJRU5ErkJggg==",C[m.AREA_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAgklEQVR42mL4DwQMtACjBg8zg4FCBhRbiMPg+f8hIIFqBiMZCgMGFBuMxVAQeE+q4UD1AnCDgVT/f9zgPlgxcYaC4uc8Ayws/xMG5wkZDjX0Pdix/0kD8/EY6gAzlByDsRqOzcfkGIySDHEFIyMFGWEClC7AJslIqyw9avAQNhggwABVPsGVrLOsUQAAAABJRU5ErkJggg==",C[m.GAUGE_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWBAMAAAA2mnEIAAAAMFBMVEUAAAD///////////////////////////////////////////////////////////87TQQwAAAAD3RSTlMAgL9A3zAQn89wII/vr2A5/8HrAAAAnUlEQVQY02NAA5kq/52mQZjZ/0FgG4jJ6v/fXbDk/5cAIDvmvzJDKIPR/6MMDGz+HxkYjBkY5L8kMLD/FwCzGf8XMKz/xABmM+j/Ytj/GUjPBGL73wz9DUBaEIg5fjAAlYPYIA0M/ydA2ZxA9gMgfQaI+f5D1NyFqOm/AHUh7w+G/b+g7PXfGeK/Q9n1XxmYtKDsRQoMbHAvJTAQAQCj4DRASabatgAAAABJRU5ErkJggg==",C[m.RADAR_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMAEO+A32DPr7+fQFAwIHCP1A0rdQAAAMpJREFUGNOFUFlyRCEIlEXcfdz/tAHxVSr5mOmyQJu2UdI39Mob/pOjcuOK9KeQmbPJbd3CS3oqblWQVpiqnEx00tYnjlXqemlo+ISqZHhwBN25AOih0aQDGxhNuI2QbmGh16ByKSLT9w/FAw6aar0v89zItKMhqzJan3tf8i4qe3aWvHxLE81LQ5IKZU7nImu2Y3gvhcQjvBGsLHTat9srTZ0n+V8Ap4fuYd+h4rxCMkNp6YIEwhZwNfkdeWG+fxIfxQsQfdHTB/wA4h0GZUKWX6QAAAAASUVORK5CYII=",C[m.SCATTER_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAgUlEQVR42mJgGAVA8P//fwFaGFoAxP8ZaWCwAZByGHRhCPYuEKyntsH7oQb/x6WGhUyzF0LpCyMnoRtAkw+6uAMQnwdFIrlhfB5Ko6d3BSA2IDuMgS6aD8T9eDICeV6mNBzn/0eA+dQ0GB1QxeVMtExSDTQJCljBDMQKI7t6AggwAFyzgSCZYutPAAAAAElFTkSuQmCC",C[m.BUBBLE_CHART]=C[m.FORCE_BUBBLE_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAnUlEQVR42mJgGAVQwEiswv///ysAqQQodwIjI+MHqrgAaPD7/wiwn1qGOvxHA1QLM1JdzEKC2YbIYUz31AANNgFqG9oPDar3TFR2sAGUFoCnUSCeD4oUKG1AposNgHg9ECdgTUpQEEBpuNzHYfB9Sg3GBwzINZdQ5H0YlEFhgJZd/0P5BhQXm9CckgBNfyDvbwAWiw9GaxWqAIAAAwA2evfwKvysMwAAAABJRU5ErkJggg==",C[""]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMAQL/PMBBwgCDvn49gUN+vfvzE8AAAAGJJREFUGNPdjUEOgDAIBFkordpW+f9rNdqUQ3mBeyBhMiwURBNFYQu4HsK60E1aUNAlA+7sUgpQmdXMZh/vDORyPs8cJ+l4T7dEjhsPB8DE+bh0LD4IJkRO3K7Agj/xTzjKDUJoCsaJEKt8AAAAAElFTkSuQmCC",C[m.MULTIPIE_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAMAAADzapwJAAAAe1BMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////NgkbwAAAAKHRSTlMAMpkDn0AnIBSz24Dmv4dKOhoQCuzKrJqMLfnyuaZ5dGZaUkIN0pRsCVisMQAAAOZJREFUGNN90dtygyAUhWHWEhA0Gg8xappz0pb3f8LKdkrTXvS/45s9DHtQL8G6TP0qcxYKS3n2gm0UVX9ugblPatFca63IsX4AfdLtB0nF2BbIhHPcNVkV6jBo8Txqj2bkfheCCmG3eA08ZfhC/RYii483GZ9BDkF4qSBLYGE8NDeJw4mUx+DGlU2ssdY9ZeWrFl7bkHcI48gicUHdCFt4+sRHTrCRHcoT33+GL3Cy+wxPVvHlh4Hcfy/fwXi9nL0ntTfo1JqDmSrGqglxxeQw57Iszwbx4lSWYy3/+2td27ad4D99Ae8gE70h03waAAAAAElFTkSuQmCC",C[m.AREA_MAP]=C[m.HEAT_MAP]=C[m.POINT_MAP]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAA5ElEQVR42mJgGHHg////AkDsAMQK1DZ4/38IeE/QcJACIDYgwlAHqIH/kQxvAOLz2BTPB0kA8X1CLoC6FtlgOEBXiA76QWGIx1cO/7GDfpCCAqjzcYH76MEC4hNQr8CAyys4QANUIzqAmbEe7kMcCkkF76HxooCeDqkB1mNLMtQAAdhyznkqGHwfawoikDKIBQ64EnwA1Ob9aLFNLFBgIDK7CpAQByDHNMD0s+AymJGR8QDUgngiyqIHQHwQiPlJLcHeIwXRe7QI+w/1mQLOMCZU7iKxQWXIfVoU7uS5blADgAADACOwXahZ5pbvAAAAAElFTkSuQmCC",C[m.TREEMAP_CHART]="iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAOUlEQVR42mL8DwQMRABGIAAqnclAJGBioBEYNXjU4FGDh5XBLEDMRyuD1YhUe3Y08kYNHqQGAwQYAL9YCMfrIWhGAAAAAElFTkSuQmCC",C[m.FUNNEL_CHART]="iVBORw0KGgoAAAANSUhEUgAAABcAAAAXBAMAAAASBMmTAAAAKlBMVEUAAAD///////////////////////////////////////////////////+Gu8ovAAAADXRSTlMAQMCAIGAw0FAQ8HCwS1BQUgAAAHVJREFUGNNjwA2Y78LAZQYGDjjnKgMDC5xzDahuLYxzAcjRhXEKgJxEQShIAHIcYRwHIGcvTFkAkOML40wActih7DsgJ3Aj7ETYehPsuloIRwHT3UlKYNAAZMKMuzUBzGFEGAZxKkJ/LojjAOWwGhsbW2CYCwC1z2uuESf9qgAAAABJRU5ErkJggg==";var P="position:absolute;width:1px;height:1px;behavior:url(#default#VML);";return A}),i("VanCharts",["require","./utils/BaseUtils","./Constants","./VanChart","./VanChartMap","./VanChartForceBubble","./VanChartWordCloud","./utils/LoadingUtils","./Carousel"],function(t){function e(t){r.initConst();var e=t.getAttribute(a.INSTANCES_KEY);e||(e=a.INSTANCES_KEY+d++,t.setAttribute(a.INSTANCES_KEY,e));var n=f[e]||new i(t);return f[e]=n,n}function i(t){this.dom=t,this.charts=[],this.carousel=c&&c(this),this.dom.style.cssText+=";overflow:hidden;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;",this.dom.onselectstart=this.dom.ondrag=function(){return!1}}function n(t){r.initPaddingScale(t)}var r=t("./utils/BaseUtils"),a=t("./Constants"),o=t("./VanChart"),s=t("./VanChartMap"),l=t("./VanChartForceBubble"),h=t("./VanChartWordCloud"),u=t("./utils/LoadingUtils"),c=t("./Carousel"),d=0,f=Object.create(null);return i.prototype={constructor:i,setOptions:function(t){this.options=t||this.options,r.isArray(t.options)?this.charts=this.carousel.init(t,this.charts,this.dom):this.charts=[this._initSingle(t,this.charts[0],this.dom)]},_initSingle:function(t,e,i){var n;return n=t.geo?s:t.chartType==a.FORCE_BUBBLE_CHART?l:t.chartType==a.WORD_CLOUD_CHART?h:o,e&&e.vanChartType===n.prototype.vanChartType?(e._changeDataState=!0,e.refresh(t),e):(e&&e.remove(),new n(t,i,this))},setData:function(t,e){null!=e?this.charts[e]=this.carousel.refresh(t,e):this.setOptions(t)},refreshRestore:function(){this.setOptions(this.options)},resize:function(t){t?this.setOptions(t):this.charts.forEach(function(t){t.resize()})},clear:function(){for(var t=0,e=this.charts.length;e>t;t++)this.charts[t].remove(),this.charts[t]=null},startLoading:function(){this.dom&&u.startLoading(this.dom,this.dom.getAttribute(a.INSTANCES_KEY))},endLoading:function(){this.dom&&u.endLoading(this.dom,this.dom.getAttribute(a.INSTANCES_KEY))}},{init:e,initPaddingScale:n}}),i("chart/Bar",["require","../utils/BaseUtils","../utils/ColorUtils","../Constants","../utils/QueryUtils","../utils/BezierEasing","./Series","../ComponentLibrary","../dom/Browser","../ChartLibrary","../ChartLibrary"],function(t){var e=t("../utils/BaseUtils"),i=t("../utils/ColorUtils"),n=t("../Constants"),r=t("../utils/QueryUtils"),a=t("../utils/BezierEasing"),o=t("./Series"),s=(t("../ComponentLibrary"),t("../dom/Browser")),l=400,h=150,u=250,c=6,d=.35,f=1,p=3,g=2,m=o.extend({_refresh:function(){var t=this._getQueryList();e.extend(this,{width:r.queryList(t,"width"),categoryGap:r.queryList(t,"categoryGap")||"20%",gap:r.queryList(t,"gap")||"20%"})},doLayout:function(){var t=this.getSeriesOffsetAndWidth(),i=this,r=i.vanchart,a=i.type==n.COLUMN_CHART,o=r.isInverted(),s="x",l="y";a||(s="y",l="x");var h=a&&!o||!a&&o,u=i[s+"Axis"],c=i[l+"Axis"],d=c.getZeroPos(),f=0;u.isOnZero()&&(f=u.options.lineWidth),this.points.forEach(function(n){var r=n.borderWidth,p=u.scale(u.getAxisValue(n[s],n)),g=n[l+"0"],m=c.scale(0===g?c.getStartPosValue():g),v=c.getAxisValue(n[l],n)+n[l+"0"],y=c.scale(v);m===1/0&&(m=c.scale.range()[0]);var _,x,T,b;_=p+t.offset-t.width/2,x=Math.min(m,y),T=t.width,b=Math.abs(m-y),x===d?(x+=f/2,b-=f/2):x+b===d&&(b-=f/2),b=Math.max(b,0);var A={};h?(A.x=_,A.y=x,A.width=T,A.height=b):(A.x=x,A.y=_,A.width=b,A.height=T),n.rect=e.rectSubPixelOpt(A,r),n.rect.rx=n.rect.ry=n.borderRadius,n.isNull||i._calculateAnimationInitRect(n,a,o)})},getSeriesOffsetAndWidth:function(){var t=this,i=0,n={},r=0,a=0,o=this.vanchart.seriesOfType(this.type),s=this.getBaseAxisType();o.forEach(function(e){e[s]==t[s]&&e.visible&&(e.stack&&!n[e.stack]?(i++,n[e.stack]=!0,t.stack&&t.stack==e.stack&&(r=i-1)):e.stack||(i++,t==e&&(r=i-1))),e[s]==t[s]&&(a+=e.points.length)});var l=t[s],h=0,u=0;if(l.isCategory()){var c=t.categoryGap,d=t.gap,f=l.getTickLength();c=e.getPercentValue(c,f),h=(f-c)/i,u=c/2+h*(r+.5),d=e.getPercentValue(d,h),h-=d}else{var p=l._getRange();p=Math.abs(p[1]-p[0]),h=p/a/3,u=0}return{width:e.hasDefined(t.width)?t.width:Math.max(h,g),offset:u}},_getPointKey:function(t){return this.type==n.BAR_CHART?t.y:t.x},getTargetKey:function(){return this.type==n.BAR_CHART?"x":"y"},getBaseAxisType:function(){return this.type==n.COLUMN_CHART?"xAxis":"yAxis"},getTrendLineXYValues:function(t){for(var e=[],i=[],r=t.points,a=t.type==n.COLUMN_CHART?t.yAxis:t.xAxis,o=t.type==n.COLUMN_CHART?t.xAxis:t.yAxis,s=o.isHorizontal(),l=a.isAxisReversed(),h=[],u=0,c=r.length;c>u;u++){var d=r[u];!d.isNull&&d.rect&&h.push(d.rect)}return h.sort(function(t,e){return s?t.x-e.x:t.y-e.y}),h.forEach(function(t){var n,r;s?(n=t.x+t.width/2,
    r=l?t.y+t.height:t.y):(n=l?t.x:t.x+t.width,r=t.y+t.height/2),e.push(n),i.push(r)}),[e,i,o.getPosition()]},_calculateAnimationInitRect:function(t,e,i){var r,a,o=e?"y":"x",s=t.series[o+"Axis"],l=s.getAxisValue(t[o],t),h=s.getStartPos(),u=l>=0,c=e&&!i||!e&&i;c?u^s.isAxisReversed()?(r=n.BOTTOM_TO_TOP,a={x:t.rect.x,y:h,width:t.rect.width,height:0}):(r=n.TOP_TO_BOTTOM,a={x:t.rect.x,y:t.rect.y,width:t.rect.width,height:0}):u^s.isAxisReversed()?(r=n.LEFT_TO_RIGHT,a={x:t.rect.x,y:t.rect.y,width:0,height:t.rect.height}):(r=n.RIGHT_TO_LEFT,a={x:t.rect.x+t.rect.width,y:t.rect.y,width:0,height:t.rect.height}),t.location=r,t.initRect=a},_getFixedPos:function(t,e){var i,r,a=this.vanchart.getPlotBounds(),o=t.rect;return 0===t.initRect.height?(i=a.x+o.x+o.width+f,r=t.location==n.BOTTOM_TO_TOP?a.y+o.y:a.y+o.y+o.height):(r=a.y+o.y+o.height+f,i=t.location==n.LEFT_TO_RIGHT?a.x+o.x+o.width-e.width:a.x+o.x-e.width),[i,r]},_calculateLabelPos:function(t){var i=this;i.points.forEach(function(r){var a=r.dataLabels;if(a&&a.enabled){var o;a.align&&(o=i._calculateAlignLabelPos(r,a.align));var s=r.location==n.TOP_TO_BOTTOM||r.location==n.BOTTOM_TO_TOP;a.autoAdjust&&(o=i._calculateAutoLabelPos(r,o,s,t)),o&&(r.labelPos=o,t.addBounds(e.makeBounds(r.labelPos,r.labelDim)))}})},_calculateAlignLabelPos:function(t,e){var i,r,a=t.labelDim,o=t.rect,s=this.vanchart.getPlotBounds(),l=(s.width,s.height,t.location==n.TOP_TO_BOTTOM||t.location==n.BOTTOM_TO_TOP),h=t.location==n.BOTTOM_TO_TOP||t.location==n.LEFT_TO_RIGHT,u=o.x+o.width/2,c=o.y+o.height/2;switch(e){case n.CENTER:i=u-a.width/2,r=c-a.height/2;break;case n.INSIDE:l?(i=u-a.width/2,r=h?o.y+p:o.y+o.height-p-a.height):(r=c-a.height/2,i=h?o.x+o.width-p-a.width:o.x+p);break;case n.OUTSIDE:l?(i=u-a.width/2,r=h?o.y-p-a.height:o.y+o.height+p):(r=c-a.height/2,i=h?o.x+o.width+p:o.x-p-a.width)}return{x:i,y:r}},_getMoreLabelDefaultCenter:function(t,e){var i=this.type==n.COLUMN_CHART,r=this.vanchart.isInverted();return i&&!r||!i&&r?{centerX:t.rect.x+t.rect.width/2,centerY:t.rect.y-e.height/2}:{centerX:t.rect.x+t.rect.width+e.width/2,centerY:t.rect.y+t.rect.height/2}},getInitShowTime:function(){return l},getReAppearTime:function(){return l+h},getDropTime:function(){return h},getStyle:function(t){return{fill:t.series.getFillFilter(t.color,t),"fill-opacity":t.image?1:t.opacity,stroke:t.borderColor,"stroke-opacity":t.borderOpacity,"stroke-width":t.borderWidth}},getAttrs:function(t){return t.rect},getPointGraphicKey:function(){return"rect"},effectAnimation:function(t,e){function i(){return l.rect().addTo(h).attr(u).style(c)}function r(t){return.5*d*t}function a(t,e,i){t.style(c),d3.select(t.node()).transition().delay(e).ease("linear").duration(i).styleTween("stroke-opacity",function(){return function(t){return.8*(1-t)}}).styleTween("stroke-width",function(){return r}).attrTween("x",function(){return function(t){return u.x-r(t)/2+1}}).attrTween("y",function(){return function(t){return u.y-r(t)/2+1}}).attrTween("width",function(){return function(t){return Math.max(u.width+r(t)-2,0)}}).attrTween("height",function(){return function(t){return Math.max(u.height+r(t)-2,0)}})}if(!e.image){var o=e.series,s=o.vanchart,l=s.renderer,h=o._getPointEffectGroup(e),u=e.rect,c={fill:"none",stroke:e.color,"stroke-opacity":0,"stroke-width":0},d=e.location===n.BOTTOM_TO_TOP||e.location===n.TOP_TO_BOTTOM?u.width:u.height,f=h.firstG=h.firstG||i(),p=h.secondG=h.secondG||i(),g=h.thirdG=h.thirdG||i(),m=o._getEffectTime(e),v=m/o.getDefaultEffectTime();a(f,0,1600*v),a(p,600*v,1600*v),a(g,1200*v,1600*v)}},getDefaultEffectTime:function(){return 2800},getHighLightStyle:function(t){return{stroke:t.mouseOverColor||t.color,fill:t.series.getFillFilter(t.mouseOverColor||t.color,t),"fill-opacity":t.opacity,"stroke-width":c,"stroke-opacity":0===t.opacity?0:d}},getPressedStyle:function(t){return{stroke:t.mouseOverColor||t.color,fill:t.series.getFillFilter(t.clickColor,t),"fill-opacity":t.clickOpacity,"stroke-width":c,"stroke-opacity":0===t.opacity?0:d}},getFillFilter:function(t,r){if(e.isSupportSVG()){var a=this,o=a.vanchart,s=o.renderer;if(r.image){var l,h,u=r.rect;switch(r.location){case n.BOTTOM_TO_TOP:l=u.x,h=u.y+u.height%r.imageHeight;break;case n.TOP_TO_BOTTOM:case n.LEFT_TO_RIGHT:l=u.x,h=u.y;break;case n.RIGHT_TO_LEFT:l=u.x+u.width%r.imageWidth,h=u.y}var c={x:l,y:h,width:r.imageWidth,height:r.imageHeight,patternUnits:"userSpaceOnUse"},d={x:0,y:0,width:r.imageWidth,height:r.imageHeight};return r.imagePattern?s.updateImagePattern(r.imagePattern,c,d,r.image):r.imagePattern=s.imagePattern(c,d,r.image),"url(#"+e.stamp(r.imagePattern)+")"}if(r.style==n.STYLE_GRADUAL){var f,p,g,m;switch(f=p=g=m="0%",r.location){case n.BOTTOM_TO_TOP:p="100%";break;case n.TOP_TO_BOTTOM:m="100%";break;case n.LEFT_TO_RIGHT:g="100%";break;case n.RIGHT_TO_LEFT:f="100%"}var v={x1:f,y1:p,x2:g,y2:m},y={offset:"0%","stop-color":t},_={offset:"100%","stop-color":i.getColorWithDivider(t,.9)};return r.colorGradient?s.updateColorGradient(r.colorGradient,v,[y,_]):r.colorGradient=s.colorGradient(v,[y,_]),"url(#"+e.stamp(r.colorGradient)+")"}}return t},_calculateAnimationDelay:function(){if(this.stack)return 0;if(this.state==n.STATE_SHOW){for(var t=this.vanchart.seriesOfType(this.type),e=0,i=t.length;i>e;e++)if(t[e].state==n.STATE_TO_DROP)return h}else if(this.state==n.STATE_TO_SHOW)return u;return 0},onPointMouseOver:function(t){var e=this,i=e.series,r=i.animation,a=i.getHighLightStyle(e);r?(s.gecko&&/url/i.test(a.fill)&&(e.graphic.style({stroke:e.mouseOverColor||e.color,fill:a.fill}),delete a.fill),d3.select(e.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION).duration(100).ease("ease-out-in").style(a)):e.graphic.style(a)},onPointMouseOut:function(){var t=this,e=t.series,i=e.animation,r=e.getStyle(t);i?(s.gecko&&/url/i.test(r.fill)&&(t.graphic.style({fill:r.fill}),delete r.fill),d3.select(t.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION).duration(100).ease("ease-out-in").style(r)):t.graphic.style(r)},updateAnimation:function(t,e,i){var n=e.rect;t._current_=n,d3.select(t).transition().ease(a.css.swing).duration(u).delay(i).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height)},createAnimation:function(t,e,i){var n=e.rect,r=e.initRect;t._current_=n,d3.select(t).attr("rx",e.borderRadius).attr("ry",e.borderRadius).attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height).transition().ease(a.css.swing).duration(l).delay(i).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height)},dropAnimation:function(t,e,i){var n=e.initRect;n?d3.select(t).transition().duration(h).delay(i).ease(a.css.swing).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",0).remove():d3.select(t).remove()}});return t("../ChartLibrary").register(n.BAR_CHART,m),t("../ChartLibrary").register(n.COLUMN_CHART,m),m}),i("chart/Pie",["require","../Constants","../utils/BaseUtils","../utils/ColorUtils","./Series","../utils/QueryUtils","../utils/BoundsManager","../utils/BezierEasing","../EffectHelper","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("../utils/ColorUtils"),r=t("./Series"),a=t("../utils/QueryUtils"),o=(t("../utils/BoundsManager"),t("../utils/BezierEasing")),s=t("../EffectHelper"),l=2*Math.PI,h=1.1,u=3,c=1e3,d="bounce",f=o.css.swing,p=400,g=r.extend({_refresh:function(){var t=this._getQueryList(),e=a.queryList(t,"startAngle")||0,n=a.queryList(t,"endAngle")||360;e>n?e-=360:e==n&&(n=e+360);var r=a.queryList(t,"center");r&&(r=[].concat(r),r[0]=this._getPercentValue(r[0],this.vanchart.width),r[1]=this._getPercentValue(r[1],this.vanchart.height)),i.extend(this,{startAngle:i.toRadian(e),endAngle:i.toRadian(n),center:r,radius:a.queryList(t,"radius"),innerRadius:a.queryList(t,"innerRadius")||0,roseType:a.queryList(t,"roseType"),rotatable:a.queryList(t,"rotatable")&&i.isSupportSVG(),style:this.vanchart.options.style})},_getAxisTypes:function(){return[]},doLayout:function(){var t=this._calculateSeriesBounds(),i=this;if(!t&&!this.radius&&!this.center)throw new Error("pie has no bounds");var n,r,a;t?(a=this.radius||Math.min(t.width/2,t.height/2),n=t.x+t.width/2,r=t.y+t.height/2,this.bounds=t):(a=this.radius,n=this.center[0],r=this.center[1]);var o=this.chartInfo&&this.chartInfo.rotate||0;this.chartInfo={radius:a,centerX:n,centerY:r,rotate:o};var s=d3.layout.pie().value(function(t){return i.roseType==e.SAME_ARC?1:Math.abs(t.getTargetValue())}).startAngle(i.startAngle).endAngle(i.endAngle).sort(null),l=this.points.filter(function(t){return t.visible}),h=this;l.forEach(function(t){t.lastShape=h._getArcData(t)});var u=s(l);u.forEach(function(t){var e=t.data;e.startAngle=isNaN(t.startAngle)?0:t.startAngle,e.endAngle=isNaN(t.endAngle)?0:t.endAngle})},_getFixedPos:function(t,e){var i=(this.vanchart.getPlotBounds(),t.series.chartInfo),n=i.centerX,r=i.centerY,a=this.getCenterAngle(t),o=t.outerRadius*h,s=o*Math.sin(a)+n,u=o*Math.cos(a+Math.PI)+r;return a<Math.PI/2?u-=e.height:a>=Math.PI&&a<3*Math.PI/2?s-=e.width:a>=3*Math.PI/2&&l>a&&(u-=e.height,s-=e.width),[s,u]},_calculateLabelPos:function(){for(var t=this.roseType,i=this.points.filter(function(t){return t.visible}),n=[],r=[],a=0,o=i.length;o>a;a++){var s=i[a],l=s.dataLabels;s.visible&&l&&l.enabled&&(l.align==e.OUTSIDE?n.push(s):r.push(s))}this._calculateOutsideLabelBounds(n),this.radius||(r.length&&!n.length||!r.length&&!n.length)&&(this.chartInfo.radius=this.chartInfo.radius/h-u);var c=0,d=this.chartInfo.radius;if(this.innerRadius&&(c="string"==typeof this.innerRadius&&-1!=this.innerRadius.indexOf("%")?parseFloat(this.innerRadius)*d/100:parseFloat(this.innerRadius)),this.chartInfo.innerRadius=c,this.points.forEach(function(t){t.innerRadius=c}),t){var f=d-c,p=0;i.forEach(function(t){p=Math.max(p,Math.abs(t.getTargetValue()))});var g=f/p;(isNaN(g)||!isFinite(g))&&(g=0),i.forEach(function(t){t.outerRadius=c+g*Math.abs(t.getTargetValue())})}else i.forEach(function(t){t.outerRadius=d});this.calculateLeadLineStartPos(n),this.calculateInsideLabelBounds(r)},_calculateLabelPosWhenRadiusFixed:function(){for(var t=this.points.filter(function(t){return t.visible}),i=[],n=[],r=0,a=t.length;a>r;r++){var o=t[r],s=o.dataLabels;s&&s.enabled&&(s.align==e.OUTSIDE?i.push(o):n.push(o))}this._calculateLabelBoundsForFixed([this.chartInfo.centerX,this.chartInfo.centerY],this.chartInfo.radius,i),this.calculateLeadLineStartPos(i),this.calculateInsideLabelBounds(n)},_calculateOutsideLabelBounds:function(t){if(t.length){t.forEach(function(t){t.labelPos=null});var e=this.chartInfo,i=e.radius,n=[e.centerX,e.centerY];this.radius?this.calcOutsideLabel(t,this.bounds,n,i):this.chartInfo.radius=this.calcOutsideLabel(t,this.bounds,n)}},_calculateLabelBoundsForFixed:function(t,e,i){var n=this.chartInfo,e=n.radius,t=[n.centerX,n.centerY];this.calcOutsideLabel(i,this.bounds,t,e)},_calculateSeriesBounds:function(){for(var t=this.vanchart.seriesOfType(e.PIE_CHART),i=this.vanchart.getPlotBounds(),n=0,r=0,a=t.length;a>r;r++)t[r].center&&t[r].radius&&n++;for(var o=i.width/Math.max(1,t.length-n),r=0,a=t.length;a>r;r++)if(t[r]==this&&!this.center)return{x:i.x+r*o,y:i.y,width:o,height:i.height}},_getTranslate:function(){return[this.chartInfo.centerX,this.chartInfo.centerY]},_getArcData:function(t){return i.hasDefined(t.startAngle)?{startAngle:t.startAngle,endAngle:t.endAngle,outerRadius:t.outerRadius}:void 0},_getMoreLabelDefaultCenter:function(t,e){var i=this.getCenterAngle(t),n=t.series.chartInfo.innerRadius+(t.outerRadius-t.series.chartInfo.innerRadius)/2,r=this._getArcPoint(n,i);return{centerX:r[0],centerY:r[1]}},effectAnimation:function(t,e){s.areaStyleEffectAnimation(t,e)},getDefaultEffectTime:function(){return s.AREA_STYLE_EFFECT_TIME},getStyle:function(t){return{fill:t.series.getFillFilter(t.color,t),"fill-opacity":t.opacity,stroke:t.borderColor,"stroke-opacity":t.borderOpacity,"stroke-width":t.borderWidth}},getHighLightStyle:function(t){return{fill:t.series.getFillFilter(t.mouseOverColor||t.color,t),"fill-opacity":t.opacity,stroke:t.borderColor||t.mouseOverColor||t.color,"stroke-width":t.borderWidth,"stroke-opacity":t.borderOpacity}},getPressedStyle:function(t){return{fill:t.series.getFillFilter(t.clickColor,t),"fill-opacity":t.clickOpacity,stroke:t.borderColor||t.mouseOverColor||t.color,"stroke-width":t.borderWidth,"stroke-opacity":t.borderOpacity}},getInitShowTime:function(){return c},getReAppearTime:function(){return c},getDropTime:function(){return c},getAttrs:function(t){var e=d3.svg.arc().innerRadius(t.innerRadius);return{d:e(this._getArcData(t))}},getPointGraphicKey:function(){return"path"},_getPositionInPie:function(t){var e=t[0]-this.chartInfo.centerX,i=t[1]-this.chartInfo.centerY;return[e,i]},_rotateLabels:function(){var t=this,e=t.vanchart;e.renderer,this.textLabelGroup;t.points.forEach(function(e){e.textGraphic&&!e.labelPos?(e.textGraphic.remove(),e.leadLine&&e.leadLine.remove(),e.textGraphic=null,e.leadLine=null):e.textGraphic&&e.labelPos?(e.textGraphic.attr("transform",i.makeTranslate(e.labelPos)),e.labelPos.startPos&&(e.leadLine?e.leadLine.attr("d",t._getLeadLinePath(e)):e.leadLine=t._getLeadLine(e))):!e.textGraphic&&e.labelPos&&t._createTextGraphic(e)})},_calculateAnimationDelay:function(){for(var t=0,e=0,i=0,n=this.points.length;n>i;i++){var r=this.points[i];r.visible&&r.series.visible&&t++,r.graphic&&e++}return e==t?0:1},_createGroup:function(t,e){return t.group().addTo(e.seriesGroup)},updateAnimation:function(t,e,i){var n=e.series,r=(n.startAngle,n.endAngle,d3.svg.arc().innerRadius(n.chartInfo.innerRadius)),a=d,o=c;i||(a=f,o=p),d3.select(t).transition().ease(a).duration(o).attrTween("d",function(){var t=n._getArcData(e),i=this._current_||t,a=d3.interpolate(i,t);return this._current_=a(1),function(t){return r(a(t))}})},createAnimation:function(t,e){var i=e.series,n=i.startAngle,r=(i.endAngle,d3.svg.arc().innerRadius(i.chartInfo.innerRadius));d3.select(t).transition().ease(d).duration(c).attrTween("d",function(){var t={startAngle:n,endAngle:n,outerRadius:e.outerRadius};if(!i.initialAnimationMoving){var a=i.getPreVisiblePoint(e);if("first"!=a&&a.lastShape){var o=Math.abs(a.lastShape.endAngle-a.endAngle),s=e.startAngle+o;t={startAngle:s,endAngle:s,outerRadius:e.outerRadius}}}var l=d3.interpolate(t,i._getArcData(e));return this._current_=l(1),function(t){return r(l(t))}})},dropAnimation:function(t,e){var i=e.series,n=i.startAngle,r=(i.endAngle,d3.svg.arc().innerRadius(i.chartInfo.innerRadius));d3.select(t).transition().ease(d).duration(c).attrTween("d",function(){var t=this._current_,a=i.getPreVisiblePoint(e),o=n;if("first"!=a&&a.lastShape){var s=Math.abs(a.lastShape.endAngle-a.endAngle);o=e.startAngle+s}var l={startAngle:o,endAngle:o,outerRadius:t.outerRadius},h=d3.interpolate(t,l);return function(t){return r(h(t))}}).remove()},getPreVisiblePoint:function(t){for(var e=t.series.points,i="first",n=0,r=e.length;r>n;n++){if(e[n]==t)return i;e[n].visible&&(i=e[n])}return i},getFillFilter:function(t,r){if(r.style==e.STYLE_GRADUAL&&i.isSupportSVG()){var a=this,o=a.vanchart,s=o.renderer,l={cx:"0%",cy:"0%",r:Math.max(r.outerRadius,0)+"px",gradientUnits:"userSpaceOnUse"},h={offset:r.innerRadius/Math.max(r.outerRadius,1)*100+"%","stop-color":n.getColorWithDivider(t,.8)},u={offset:"100%","stop-color":t};return r.colorGradient?s.updateColorGradient(r.colorGradient,l,[h,u]):r.colorGradient=s.colorGradient(l,[h,u],"radialGradient"),"url(#"+i.stamp(r.colorGradient)+")"}return t},onPanStart:function(t){this.rotatable&&(this.initPos=t.containerPoint,this.initRotate=i.toDegree(this.chartInfo.rotate))},onPanMove:function(t){if(this.rotatable){var e=this._getAngle(this._getPositionInPie(this.initPos),[0,0]),n=this._getAngle(this._getPositionInPie(t.containerPoint),[0,0]),r=n-e+this.initRotate;this.pathGroup.attr("transform","rotate("+r+")"),this.chartInfo.rotate=i.toRadian(r),this._calculateLabelPosWhenRadiusFixed(),this._rotateLabels()}},onPointMouseOver:function(){var t=this;t.series._onState.call(t,!0)},onPointMouseOut:function(){var t=this;t.series._onState.call(t,!1)},_onState:function(t){var i=this,n=i.series,r=n.animation,a=d3.svg.arc().innerRadius(i.innerRadius),o=t?n.getHighLightStyle(i):n.getStyle(i),s=i.outerRadius*h,l=i.outerRadius;t&&(s=i.outerRadius,l=i.outerRadius*h);var u=d3.interpolate(s,l),c={startAngle:i.startAngle,endAngle:i.endAngle};r?d3.select(i.graphic.style(o).rawElement).interrupt(e.SELECT_ANIMATION).transition(e.SELECT_ANIMATION).ease("elastic").duration(800).attrTween("d",function(){return function(t){return a.outerRadius(u(t))(c)}}):i.graphic.style(o).attr("d",a.outerRadius(l)(c))},_getPointGraphicGroup:function(){return this.pathGroup||(this.pathGroup=this.vanchart.renderer.group().addTo(this.group)),this.pathGroup},_isSeriesInteractive:function(){return!0},_getPointTextLabelGroup:function(){return this.textLabelGroup||(this.textLabelGroup=this.vanchart.renderer.vgroup().add(),this.group.append(this.textLabelGroup.renderG),this.textLabelGroup.divG.attr("transform",i.makeTranslate(this._getTranslate()))),this.textLabelGroup},onPanEnd:function(t){this.vanchart.handler.panTarget=null},getEvents:function(){return{panstart:this.onPanStart,panmove:this.onPanMove,panend:this.onPanEnd}},isSeriesAccumulated:function(){return!0}});return t("../ChartLibrary").register(e.PIE_CHART,g),g}),i("chart/Line",["require","../Constants","../utils/BaseUtils","../utils/QueryUtils","./Series","../utils/Class","../utils/BezierEasing","../utils/ColorUtils","../EffectHelper","../ChartLibrary","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("../utils/QueryUtils"),r=t("./Series"),a=t("../utils/Class"),o=t("../utils/BezierEasing"),s=t("../utils/ColorUtils"),l=t("../EffectHelper"),h=2,u=800,c=250,d=.65,f="quad-in-out",p=o.css.swing,g=function(t){var e=t.indexFromLeft/t.series.points.length;return u*(.5>e?Math.sqrt(e/2):1-Math.sqrt(2-2*e)/2)},m=r.extend({type:e.LINE_CHART,_refresh:function(){var t=this._getQueryList();i.extend(this,{lineWidth:n.queryList(t,"lineWidth"),interpolate:this._getSeriesInterpolate(t),connectNulls:n.queryList(t,"connectNulls"),bands:n.queryList(t,"bands"),inverted:n.queryList(t,"inverted")})},doLayout:function(){var t=this,e=(t.vanchart,t.xAxis),i=t.yAxis,n=t.connectNulls,r=e.scale.rangeBand?e.scale.rangeBand()/2:0,a=t.inverted,o=a?"posY":"posX",s=i.getStartPosValue(),l=[];if(this.large){var h={},u={};t.points.forEach(function(t){var n=e.scale(e.getAxisValue(t.x,t))+r,a=i.scale(i.getAxisValue(t.y,t)+t.y0),o=i.scale(0===t.y0?s:t.y0);this.inverted?(t.posX=a,t.posY=n,t.posX0=o):(t.posX=n,t.posY=a,t.posY0=o),h[t.posX]&&u[t.posY]||(h[t.posX]=!0,u[t.posY]=!0,l.push(t))},this)}else l=t.points;var c=!0,d=[];l.forEach(function(t,l){if(this.large)h=t.posX,u=t.posY;else{var h=e.scale(e.getAxisValue(t.x,t))+r,u=i.scale(i.getAxisValue(t.y,t)+t.y0),f=i.scale(0===t.y0?s:0);this.inverted?(t.posX=u,t.posY=h,t.posX0=f):(t.posX=h,t.posY=u,t.posY0=f)}t.indexFromLeft=l,(!n||n&&!t.isNull)&&(d.length>0&&(c=c&&d[d.length-1][o]<=(a?u:h)),d.push(t))},this),t.y0=Number.MAX_VALUE,t.y=-Number.MAX_VALUE,l.forEach(function(e){Math.abs(e.y0)<Math.abs(t.y0)&&(t.y0=Math.abs(e.y0)),Math.abs(e.y+e.y0)>t.y&&(t.y=Math.abs(e.y+e.y0))}),c||(d.sort(function(t,e){return t[o]-e[o]}),d.forEach(function(t,e){t.indexFromLeft=e}));var f=d3.svg.line().interpolate(t.interpolate).x(function(t){return t.posX}).y(function(t){return t.posY}).defined(function(t){return!t.isNull}),p=d3.svg.area().interpolate(t.interpolate);p=this.inverted?p.y(function(t){return t.posY}).x0(function(e){var i=t._getPreviousStackingPoint(e);return i?i.posX:e.posX0}).x1(function(t){return t.posX}):p.x(function(t){return t.posX}).y0(function(e){var i=t._getPreviousStackingPoint(e);return i?i.posY:e.posY0}).y1(function(t){return t.posY}),p=p.defined(function(t){return!t.isNull}),this.linePath=f(d),this.areaPath=p(d),this.dataBands=this._calculateDataBands()},_getPreviousStackingPoint:function(t){if(i.hasDefined(t.series.stack))for(var e=t.points,n=0,r=e.length;r>n;n++){var a=e[n].series;if(a.stack==t.series.stack&&a.visible&&e[n+1]==t)return e[n]}},_calculateDataBands:function(){var t=this.vanchart.getPlotBounds(),e=this,i=this.bands||[],n=e.color,r=e.opacity,a=e.fillColor,o=e.fillColorOpacity,s=e.yAxis,l=s.scale.domain(),h=s.isHorizontal(),u=t.width,c=t.height,d=[];if(d.push({clipBounds:{x:0,y:0,width:u,height:c},color:n,fillColor:a,fillColorOpacity:o}),!i||!i.length)return d;for(var f=0,p=i.length;p>f;f++){var g=Math.max(l[0],i[f].from),m=Math.min(l[1],i[f].to);g=s.scale(g),m=s.scale(m);var v={x:0,y:Math.min(g,m),width:u,height:Math.abs(g-m)};h&&(v={x:Math.min(g,m),y:0,width:Math.abs(g-m),height:c}),d.push({clipBounds:v,color:i[f].color||n,opacity:i[f].opacity||r,fillColor:i[f].fillColor||a,fillColorOpacity:i[f].fillColorOpacity||o})}return d},_getFixedPos:function(t){var e=t.marker.radius||4.5,i=this.vanchart.getPlotBounds(),n=i.x+t.posX+e,r=i.y+t.posY+e;return[n,r]},_calculateLabelPos:function(t){var n=this,r=this.vanchart.isInverted(),a=(n.points.length,this.vanchart.getPlotBounds());n.points.forEach(function(o,s){var l=o.dataLabels;if(l&&l.enabled){var u,c,d,f=l.align==e.TOP,p=o.labelDim,g=h;o.marker&&o.marker.symbol&&(g+=o.marker.radius||4.5),r?(c=f?o.posX+g:o.posX-g-p.width,d=o.posY-p.height/2,0>=d?d=o.posY:d+p.height>=a.height&&(d=o.posY-p.height)):(c=o.posX-p.width/2,d=f?o.posY-g-p.height:o.posY+g,0>=c?c=o.posX:c+p.width>=a.width&&(c=o.posX-p.width)),u={x:c,y:d},l.autoAdjust&&(u=n._calculateAutoLabelPos(o,u,!r,t)),u&&(o.labelPos=u,t.addBounds(i.makeBounds(o.labelPos,o.labelDim)))}})},getTrendLineXYValues:function(t){return this._getNormalTrendLineXYValues(t)},getAttrs:function(t){return{transform:i.makeTranslate([t.posX,t.posY])}},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.posX+t.marker.radius/2,centerY:t.posY-e.height/2-t.marker.radius/2}},getStyle:function(){return{}},effectAnimation:function(t,e){l.markerEffectAnimation(e)},getDefaultEffectTime:function(){return l.MARKER_EFFECT_TIME},getHighLightStyle:function(){},getInitShowTime:function(){return u},getReAppearTime:function(){return c},getDropTime:function(){return c},getDataToDraw:function(){return this.points.filter(function(t){return t.marker&&t.marker.symbol})},getTextDataToDraw:function(){return this.points},_updatePointGraphicStyle:function(t){this._updateMarker(t)},updatePointGraphic:function(t){this._updateMarkerPointGraphic(t)},_createPointGraphic:function(t){return t.graphic=this._createMarker(t.marker)},onPointPress:function(){var t=this,e=t.series;e._onMarkerPressed(t)},onPointPressUp:function(){var t=this,e=t.series;e._updateMarker(t)},onPointMouseOver:function(){var t=this,e=t.series;e._onMarkerMouseOver(t)},onPointMouseOut:function(){var t=this,e=t.series;e._onMarkerMouseOut(t)},createAnimation:function(t,e){d3.select(t).attr("transform","translate("+e.posX+","+e.posY+") scale(0.01)").transition().delay(g(e)).duration(150).ease("ease-out-in").attr("transform","translate("+e.posX+","+e.posY+") scale(1.5)").transition().duration(150).ease("ease-out-in").attr("transform","translate("+e.posX+","+e.posY+") scale(1)")},updateAnimation:function(t,e){d3.select(t).transition().ease(p).duration(c).attr("transform","translate("+e.posX+","+e.posY+")")},dropAnimation:function(t){d3.select(t).remove()},getClosestPoint:function(t){var e,i=this.vanchart.isInverted(),n=i?"y":"x",r=i?"posY":"posX",a=Number.MAX_VALUE,o=this.vanchart.hoverSeries,s=this.vanchart.getPlotBounds(),l=s[n]-(i?t[1]:t[0]);return o.points.forEach(function(t){var i=Math.abs(t[r]+l);a>i&&!t.isNull&&(e=t,a=i)}),e},_onSeriesMouseOver:function(t){this.dataBandsGraphic.forEach(function(t){t._onSeriesMouseOver()}),i.toFront(this.group.node())},_onSeriesUnChosen:function(t){this.dataBandsGraphic.forEach(function(t){t._onSeriesUnChosen()}),this.defaultMarker&&this.defaultMarker.remove(),this.defaultMarker=null},_isSeriesInteractive:function(){return!0},drawSeries:function(){var t,e,i=this,n=this.vanchart,r=(n.renderer,this.dataBands);for(this.defaultMarker&&this.defaultMarker.remove(),this.defaultMarker=null,this.dataBandsGraphic=this.dataBandsGraphic||[],t=r.length,e=this.dataBandsGraphic.length;e>t;t++)this.dataBandsGraphic[t].remove(),this.dataBandsGraphic[t]=null;for(t=0,e=r.length;e>t;t++)this.dataBandsGraphic[t]?this.dataBandsGraphic[t].refresh(r[t]):this.dataBandsGraphic[t]=new v(r[t],i);this.dataBandsGraphic.length=r.length}}),v=a.extend({initialize:function(t,e){this.series=e,this.refresh(t)},refresh:function(t){this.options=t,this.render()},render:function(){var t=this.options,n=this.series,r=n.animation,a=n.group,o=n.vanchart,s=o.renderer,l=this._getLineStyle(n,t),h=this._getAreaStyle(n,t),d=i.isSupportSVG(),g=t.clipBounds,m=n.type==e.AREA_CHART,v=!this.linePath||this.removed;this.clipRect?s.updateClip(this.clipRect,g):this.clipRect=s.createClip({x:g.x,y:g.y,width:g.width,height:g.height}),n.visible?(this.removed=!1,this.linePath=this.linePath||s.path().attr("d",n.linePath),this.linePath.style(l).addTo(a),this.linePath.isLineChart=!0,d&&s.clip(this.linePath,this.clipRect),m&&(this.areaPath=this.areaPath||s.path().attr("d",n.areaPath),this.areaPath.style(h).addTo(a),this.areaPath.isLineChart=!0,d&&s.clip(this.areaPath,this.clipRect)),r?v?(this.linePath.attr("d",n.linePath),this.areaPath&&this.areaPath.attr("d",n.areaPath),d3.select(this.clipRect.rect.rawElement).attr(n.inverted?"height":"width",0).transition().ease(f).duration(u).attr("x",g.x).attr("y",g.y).attr("width",g.width).attr("height",g.height)):(d3.select(this.linePath.node()).transition().ease(p).duration(c).attr("d",n.linePath),this.areaPath&&d3.select(this.areaPath.node()).transition().ease(p).duration(c).attr("d",n.areaPath),d3.select(this.clipRect.rect.rawElement).transition().ease(p).duration(c).attr("x",g.x).attr("y",g.y).attr("width",g.width).attr("height",g.height)):(this.linePath.attr("d",n.linePath),this.areaPath&&this.areaPath.attr("d",n.areaPath))):(this.linePath&&this.linePath.remove(),this.areaPath&&this.areaPath.remove(),this.removed=!0)},_getAreaStyle:function(t,i){var n,r,a=t.vanchart.highlightTarget;return a?(n=i.fillColor,r=a==t.name?1:.3):(n=this._getFillFilter(i.fillColor,t),r=t.style==e.STYLE_GRADUAL?1:i.fillColorOpacity),{fill:n,"fill-opacity":r}},_getLineStyle:function(t,e){var i=e.opacity,n=t.vanchart.highlightTarget;return n&&(i=n==t.name?1:.3),{fill:"none",stroke:e.color,"stroke-width":t.lineWidth,"stroke-opacity":i}},_getFillFilter:function(t,n){if(i.isSupportSVG()){var r=n.vanchart,a=r.renderer;if(n.style==e.STYLE_GRADUAL){var o,s,l,h;o=s=l=h="0%";var u=Math.abs(n.y)/Math.abs(n.y-n.y0);n.inverted===!0?(o=100*(1-u)+"%",l="100%"):s=100*u+"%";var c={x1:o,y1:s,x2:l,y2:h},d={offset:"0%","stop-color":t+";stop-opacity:0"},f={offset:"100%","stop-color":t+";stop-opacity:0.8"};return this.colorGradient?a.updateColorGradient(this.colorGradient,c,[d,f]):this.colorGradient=a.colorGradient(c,[d,f]),"url(#"+i.stamp(this.colorGradient)+")"}}return t},_onSeriesMouseOver:function(){this.linePath.style({stroke:s.getHighLightColor(this.options.color),"stroke-width":this.series.lineWidth+1}),this.series.type==e.AREA_CHART&&this.areaPath.style({fill:s.getHighLightColor(this.options.fillColor),"fill-opacity":0===this.options.fillColorOpacity?0:d})},_onSeriesUnChosen:function(){this.linePath&&this.linePath.style(this._getLineStyle(this.series,this.options)),this.areaPath&&this.areaPath.style(this._getAreaStyle(this.series,this.options))},remove:function(){this.linePath&&this.linePath.remove(),this.areaPath&&this.areaPath.remove(),this.clipRect&&this.clipRect.remove(),this.linePath=this.areaPath=this.clipRect=null}});return t("../ChartLibrary").register(e.LINE_CHART,m),t("../ChartLibrary").register(e.AREA_CHART,m),m}),i("chart/ColumnRadar",["require","../EffectHelper"],function(t){var e=t("../EffectHelper"),i=500,n="back-out",r=500,a="exp-out",o=6,s=.35,l="radar-top",h="radar-bottom",u="radar-left",c="radar-right",d=8;return{columnType:!0,_calcLabelPos:function(t){var e=this.polar.angleAxis._getPolarPosition(t.category),i=this._getArcPoint(t.outerRadius-d,t.radian),n=t.labelDim;switch(e){case l:t.labelPos={x:-n.width/2,y:i[1]};break;case c:t.labelPos={x:i[0]-n.width,y:i[1]-n.height/2};break;case h:t.labelPos={x:-n.width/2,y:i[1]-n.height};break;case u:t.labelPos={x:i[0],y:i[1]-n.height/2}}},_getMoreLabelDefaultCenter:function(t,e){var i=this._getArcPoint(t.outerRadius/2,t.radian);return{centerX:i[0],centerY:i[1]}},effectAnimation:function(t,i){e.areaStyleEffectAnimation(t,i)},getDefaultEffectTime:function(){return e.AREA_STYLE_EFFECT_TIME},getAttrs:function(t){return{d:this._getRadarColumnPath(t.innerRadius,t.outerRadius,t.radian)}},getStyle:function(t){return{fill:t.color,"fill-opacity":t.opacity,stroke:t.borderColor,"stroke-width":t.borderWidth,"stroke-opacity":1}},getHighLightStyle:function(t){return{stroke:t.mouseOverColor||t.color,fill:t.color,"fill-opacity":1,"stroke-width":o,"stroke-opacity":s}},getPressedStyle:function(t){return{fill:t.clickColor,"fill-opacity":t.clickOpacity}},getPointGraphicKey:function(){return"path"},_getRadarColumnPath:function(t,e,i){var n=.375*this.polar.angleAxis.piece,r=i-n,a=i+n,o=d3.svg.arc().innerRadius(t).outerRadius(e).startAngle(r).endAngle(a);return o()},createAnimation:function(t,e){t._innerRadius_=e.innerRadius,t._outerRadius_=e.outerRadius;var r=this;d3.select(t).transition().duration(i).ease(n).attrTween("d",function(){var t=d3.interpolate(e.animateInitRadius,e.innerRadius),i=d3.interpolate(e.animateInitRadius,e.outerRadius);return function(n){return r._getRadarColumnPath(t(n),i(n),e.radian)}})},updateAnimation:function(t,e){var i=this;d3.select(t).transition().duration(r).ease(a).attrTween("d",function(){var n=d3.interpolate(t._innerRadius_,e.innerRadius),r=d3.interpolate(t._outerRadius_,e.outerRadius);return t._innerRadius_=e.innerRadius,t._outerRadius_=e.outerRadius,function(t){return i._getRadarColumnPath(n(t),r(t),e.radian)}})},dropAnimation:function(t,e){var i=this;d3.select(t).transition().duration(r).ease(a).attrTween("d",function(){var t=d3.interpolate(e.outerRadius,e.innerRadius);return function(n){return i._getRadarColumnPath(e.innerRadius,t(n),e.radian)}}).remove()},onPointMouseOver:function(){var t=this,e=t.series,i=e.animation,n=e.getHighLightStyle(t);i?d3.select(t.graphic.rawElement).transition().duration(100).ease("ease-out-in").style(n):t.graphic.style(n)},onPointMouseOut:function(){var t=this,e=t.series,i=e.animation,n=e.getStyle(t);i?d3.select(t.graphic.rawElement).transition().duration(100).ease("ease-out-in").style(n):t.graphic.style(n)},_getFixedPos:function(t,e){var i=t.radian,n=this.getCenter(),r=t.posX+n[0],a=t.posY+n[1];return i<Math.PI/2?a-=e.height:i>=Math.PI&&i<3*Math.PI/2?r-=e.width:i>=3*Math.PI/2&&i<2*Math.PI&&(a-=e.height,r-=e.width),[r,a]}}}),i("chart/LineRadar",["require","../utils/BaseUtils","../EffectHelper"],function(t){var e=t("../utils/BaseUtils"),i=t("../EffectHelper"),n=500,r="back-out",a=500,o="exp-out",s="radar-top",l="radar-bottom",h="radar-left",u="radar-right",c=8;return{columnType:!1,_calcLabelPos:function(t){var e=this.polar.angleAxis._getPolarPosition(t.category),i=this._getArcPoint(t.outerRadius+c,t.radian),n=t.labelDim;switch(e){case s:t.labelPos={x:-n.width/2,y:i[1]-n.height};break;case u:t.labelPos={x:i[0],y:i[1]-n.height/2};break;case l:t.labelPos={x:-n.width/2,y:i[1]};break;case h:t.labelPos={x:i[0]-n.width,y:i[1]-n.height/2}}},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.posX+t.marker.radius/2,centerY:t.posY-e.height/2-t.marker.radius/2}},_isSeriesInteractive:function(){return!0},drawSeries:function(){this.defaultMarker&&this.defaultMarker.remove(),this.defaultMarker=null;var t=this,e=t.vanchart,i=e.renderer,s=t.fillColor&&t.fillColorOpacity,l=this._getRadarPathStyle();this.radarPath=this.radarPath||i.path(),this.radarPath.style(l).addTo(t.group),t.visible?(this.removed&&(this.radarPath.node()._pathSegment_=null,this.radarPath.addTo(t.group),this.removed=!1),t.animation?d3.select(this.radarPath.node()).transition().duration(n).ease(r).attrTween("d",function(){
    var e=!!this._pathSegment_;if(e&&this._pathSegment_.length==t.pathSegment.length)for(var i=this._pathSegment_,n=0,r=i.length;r>n&&e;n++)i[n].length!=t.pathSegment[n].length&&(e=!1);var a=e?this._pathSegment_:t._getInitPathSegment(t.pathSegment),o=d3.interpolateArray(a,t.pathSegment);return this._pathSegment_=t.pathSegment,function(e){return t._getRadarSeriesPath(o(e),t.connectNulls,s)}}):this.radarPath.attr("d",t._getRadarSeriesPath(t.pathSegment,t.connectNulls,s))):(this.removed=!0,t.animation?d3.select(this.radarPath.node()).transition().duration(a).ease(o).attrTween("d",function(){var e=t._getInitPathSegment(t.pathSegment),i=d3.interpolateArray(t.pathSegment,e);return function(e){return t._getRadarSeriesPath(i(e),t.connectNulls,s)}}).remove():this.radarPath.remove())},_getRadarPathStyle:function(){var t=this,e=t.fillColor&&t.fillColorOpacity,i=t.fillColorOpacity,n=t.opacity,r=t.vanchart.highlightTarget;return r&&(i=r==t.name?1:.3,n=r==t.name?1:.3),{fill:e?t.fillColor:"none","fill-opacity":i,stroke:t.color,"stroke-width":t.lineWidth,"stroke-opacity":n}},getAttrs:function(t){return{transform:e.makeTranslate([t.posX,t.posY])}},getStyle:function(){return{}},effectAnimation:function(t,e){i.markerEffectAnimation(e)},getDefaultEffectTime:function(){return i.MARKER_EFFECT_TIME},_createPointGraphic:function(t){return t.graphic=this._createMarker(t.marker)},_updatePointGraphicStyle:function(t){this._updateMarker(t)},getDataToDraw:function(){return this.points.filter(function(t){return t.marker&&t.marker.symbol})},getTextDataToDraw:function(){return this.points},onPointPress:function(){var t=this,e=t.series;e._onMarkerPressed(t)},onPointPressUp:function(){var t=this,e=t.series;e._updateMarker(t)},onPointMouseOver:function(){var t=this,e=t.series;e._onMarkerMouseOver(t)},onPointMouseOut:function(){var t=this,e=t.series;e._onMarkerMouseOut(t)},createAnimation:function(t,e){d3.select(t).attr("transform","translate(0,0) scale(0.01)").transition().duration(n).ease(r).attr("transform","translate("+e.posX+","+e.posY+") scale(1)")},updateAnimation:function(t,e){d3.select(t).transition().ease(r).duration(n).attr("transform","translate("+e.posX+","+e.posY+") scale(1)")},dropAnimation:function(t){d3.select(t).remove()},_calculateLabelPos:function(){},_getFixedPos:function(t){var e,i,n=isNaN(t.marker.radius)?4.5:t.marker.radius,r=this.getCenter();return e=r[0]+t.posX+n,i=r[1]+t.posY+n,[e,i]},_onSeriesMouseOver:function(){var t=this;t.radarPath&&t.radarPath.style({"stroke-width":t.lineWidth+1}),e.toFront(t.group.node())},_onSeriesUnChosen:function(){var t=this;this.defaultMarker&&this.defaultMarker.remove(),this.defaultMarker=null,t.radarPath&&t.radarPath.style(t._getRadarPathStyle())},updatePointGraphic:function(t){this._updateMarkerPointGraphic(t)},getClosestPoint:function(t){var e,i=this.getCenter(),n=Number.MAX_VALUE;return this.points.forEach(function(r){var a=r.posX+i[0]-t[0],o=r.posY+i[1]-t[1],s=Math.sqrt(a*a+o*o);n>s&&!r.isNull&&(e=r,n=s)}),e}}}),i("chart/Radar",["require","./Series","../utils/BaseUtils","../Constants","../utils/QueryUtils","../utils/BoundsManager","./ColumnRadar","./LineRadar","../ChartLibrary"],function(t){var e=t("./Series"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("../utils/QueryUtils"),a=(t("../utils/BoundsManager"),t("./ColumnRadar")),o=t("./LineRadar"),s=500,l=500,h=e.extend({_refresh:function(){var t=this._getQueryList(),e=r.queryList(t,"columnType"),n=i.pick(r.queryList(t,"connectNulls"),!0),s=r.queryList(t,"lineWidth")||0;i.extend(this,{marker:e?null:this.marker,lineWidth:s,columnType:e,connectNulls:n}),e!=this.columnType&&this.remove(),this.stack=this.columnType?"radar-column"+this.stack:this.stack,i.extend(this,e?a:o)},getInitShowTime:function(){return s},getReAppearTime:function(){return l},_getAxisTypes:function(){return["angleAxis","radiusAxis","polar"]},getBaseAxisType:function(){return"angleAxis"},_bindAxis:function(){var t=this,e=t.options,i=t.vanchart;t._getAxisTypes().forEach(function(n){if(i[n]){var r=i[n](e.polar);r&&(r.series.push(t),t[n]=r)}})},_getDefaultFillColorOpacity:function(){var t=this._getQueryList(),e=r.queryList(t,"columnType");return e?1:.15},_getTranslate:function(){return this.getCenter()},getCenter:function(){return this.polar&&this.polar.center},getRadius:function(){return this.polar&&this.polar.radius},doLayout:function(){var t=this,e=t.polar,i=e.radiusAxis,n=e.angleAxis,r=(this.getCenter(),this.getRadius(),n.piece),a=i.scale,o=n.scale;t.points.forEach(function(e){e.innerRadius=a(e.y0),e.outerRadius=a(e.getTargetValue()+e.y0),e.animateInitRadius=i.getStartPos(),e.radian=o(e.category)*r;var n=t._getArcPoint(e.outerRadius,e.radian);e.posX=n[0],e.posY=n[1],this._calcLabelPos(e)},this),t.pathSegment=t._getPathSegment(t.points,t.connectNulls)},_calculateLabelPos:function(){},getTargetKey:function(){return"y"},_createGroup:function(t,e){return t.group().addTo(e.seriesGroup)},additionalClip:function(t){this.vanchart.renderer.clip(t,this.polar.clip)},_getPathSegment:function(t,e){var i=this,n=i.polar,r=n.angleAxis,a=r.scale;t=[].concat(t),t.sort(function(t,e){return a(t.category)-a(e.category)});var o=[],s=[];if(e)o.push(s),t.forEach(function(t){t.isNull||s.push([t.posX,t.posY])});else{for(var l=0,h=t.length,u=h-1;u>0;u--){var c=t[u],d=t[u-1];!c.isNull&&d.isNull&&(l=u)}for(var u=0;h>u;u++){var f=t[(u+l)%h];f.isNull&&s.length?(s.length>1&&o.push(s),s=[]):f.isNull||s.push([f.posX,f.posY])}s.length&&o.push(s)}return o},_getRadarSeriesPath:function(t,e,n){var r="",a=[];if(1===t.length){a=t[0];var o=a.length==this.angleAxis.getCategoryCount()||e;n=!o&&n,r=n?"M0,0":"";for(var s=0,l=a.length;l>s;s++){var h=s||n?"L":"M";r+=h+i.dealFloatPrecision(a[s][0])+","+i.dealFloatPrecision(a[s][1])}r+=o||n?"Z":""}else t.forEach(function(t){r+=n?"M0,0":"",t.forEach(function(t,e){r+=(e||n?"L":"M")+i.dealFloatPrecision(t[0])+","+i.dealFloatPrecision(t[1])}),r+=n?"Z":""});return r},_getInitPathSegment:function(t){var e=[];return t.forEach(function(t){var i=[];e.push(i),t.forEach(function(){i.push([0,0])})}),e}});return t("../ChartLibrary").register(n.RADAR_CHART,h),h}),i("chart/TreeSeries",["require","./Series","../utils/BaseUtils","../utils/QueryUtils","../utils/ColorUtils","../Constants","./Point","../dom/Evented","../utils/Formatter"],function(t){function e(t){t.children&&t.children.forEach(function(t){e(t),t.remove()}),t.remove()}var i=t("./Series"),n=t("../utils/BaseUtils"),r=t("../utils/QueryUtils"),a=(t("../utils/ColorUtils"),t("../Constants")),o=t("./Point"),s=(t("../dom/Evented"),t("../utils/Formatter"),i.extend({refresh:function(t,e){this.options=t;var i=this.vanchart,o=t.type||i.options.chartType,s=n.pick(t.name,"Series"+o+e),l=this._getQueryList(o),h=n.pick(r.queryList(l,"visible"),!0);return n.extend(this,{type:o,name:s,className:"vancharts-series-"+e,visible:h,state:h?a.STATE_SHOW:a.STATE_DROPPED,animation:r.queryList(l,"animation")&&i.options.animation}),this._refresh(),this._initChildren(),this},_initChildren:function(){this.traverseInitData(this.visitBefore,null),this.points=this.root.children},_getPointKey:function(t){return t.name},getTargetKey:function(){return"value"},_getChildrenKey:function(){return"children"},traverseData:function(t,e,i){function n(a,s,l,h){a.children||(a.children=a.options[r._getChildrenKey()]);var u=a.children;if(a.parent=l,a.depth=s,a.height=0,a.ancestor=h,e&&e.call(r,a),u&&(c=u.length))for(var c,d=-1;++d<c;)u[d]instanceof o||(u[d]=new o(u[d],t.series)),0===s&&(h=u[d]),n(u[d],s+1,a,h),a.height=Math.max(a.height,u[d].visible?u[d].height+1:0);i&&i.call(r,a)}var r=this;n(t,0,null,null)},traverseInitData:function(t,i){function r(s,l,h,u,c){var d=l[a._getChildrenKey()];if(s.parent=u,s.depth=h,s.height=0,s.ancestor=c,s.seriesName=a.name,s.children=s.children||[],t&&t.call(a,s),n.hasDefined(d)){for(var f=[],p=0,g=d.length;g>p;p++){var m,v=!1;s.children.forEach(function(t){var e=a._getPointKey(t);n.hasDefined(e)&&e==a._getPointKey(d[p])&&(t._lastValue=t[a.getTargetKey()],t.refresh(d[p]),v=!0,m=t,f.push(t))}),v||(m=new o(d[p],a),f.push(m)),0===h&&(c=m),m.index=p,r(m,d[p],h+1,s,c),s.height=Math.max(s.height,m.visible?m.height+1:0)}for(var y=0,_=s.children.length;_>y;y++)-1==n.arrayIndexOf(f,s.children[y])&&e(s.children[y]);s.children=f}i&&i.call(a,s)}var a=this,s={children:this.options.data,name:this.name};this.root?this.root.refresh(s):this.root=new o(s,a),r(this.root,s,0,null,null)},visitBefore:function(t){1===t.depth&&(t.color=this.vanchart.getDefaultSeriesColor(t.name))},visitAfter:function(){},_calculatePercentage:function(t,e){var i=0;t.forEach(function(t){i+=Math.abs(t[e])}),i=i>0?i:1,t.forEach(function(t){t.percentage=Math.abs(t[e])/i})},_onPointMouseOver:function(t){var e=this,i=this.series,n=i.vanchart,r=n.hoverPoint;r&&r._onPointMouseOut(r,t),e.depth&&(i.onPointMouseOver.call(e,t),n.showTooltip(e,t),n.hoverPoint=e)},_onPointMouseOut:function(t){var e=this,i=this.series;i.onPointMouseOut.call(e,t),i.vanchart.hideTooltip()},_onPointTap:function(t){this._onPointTap(t)},pointEvents:function(){return{mouseover:this._onPointMouseOver,mousemove:this.onPointMouseMove,mouseout:this._onPointMouseOut,tap:this._onPointTap}},isSeriesAccumulated:function(){return!0},getLegendKey:function(t){for(var e=t.parent;e&&e.parent!=this.root;)e=e.parent;return e?e.name:""},isTreeSeries:function(){return!0}}));return s}),i("chart/TreeMap",["require","../Constants","../utils/BaseUtils","./TreeSeries","../utils/QueryUtils","../utils/ColorUtils","../utils/BoundsManager","./Point","../EffectHelper","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("./TreeSeries"),r=t("../utils/QueryUtils"),a=t("../utils/ColorUtils"),o=(t("../utils/BoundsManager"),t("./Point"),t("../EffectHelper")),s=6,l=800,h="out-bounce",u=1e3,c=800,d=100,f=n.extend({nodes:[],root:null,zoomNow:null,sx:null,sy:null,zoom:null,_refresh:function(){this.sx=d3.scale.linear(),this.sy=d3.scale.linear();var t=this._getQueryList();this.zoom=r.queryList(t,"zoom")},visitBefore:function(t){this._setColor(t)},visitAfter:function(t){var e=t.children,i=t.options.value;if(i=isNaN(i)?0:i,t.chSum=i,e&&(n=e.length)){var n,r=0,a=-1;for(this._calculatePercentage(e,"value");++a<n;)r+=Math.abs(e[a].chSum);t.chSum=r}t.value=i||t.chSum||0,t.ancestor&&!t.ancestor.visible&&(t.value=0)},doLayout:function(){function t(t){t._dx=t.dx,t._dy=t.dy,t._x=t.x,t._y=t.y}this.traverseData(this.root,null,this.visitAfter);var e=this.vanchart.getPlotBounds();this.sx.range([0,e.width]).domain([0,e.width]),this.sy.range([0,e.height]).domain([0,e.height]);var i=d3.layout.treemap().value(function(t){return Math.abs(t.value)}).size([e.width,e.height]);this.nodes=i.nodes(this.root).filter(function(t){return!t.children&&t.depth}).map(function(i){return i.value=i.chSum,i.visible=i.ancestor.visible,i.visible&&this._setVanishPos(i,e),this.calculateLabelInfo(i),this._calculateLabelPos(i),t(i),i},this)},getDataToDraw:function(){return this.nodes},_setVanishPos:function(t,e){t.vanishPos=[Math.round((t.ancestor.x+t.ancestor.dx/2)/e.width)*e.width,Math.round((t.ancestor.y+t.ancestor.dy/2)/e.height)*e.height]},_setColor:function(t){1===t.depth&&(t.color=t.options.color||this.vanchart.getDefaultSeriesColor(t.name),t.mouseOverColor=t.options.mouseOverColor||a.getHighLightColor(t.color),t.clickColor=t.options.clickColor||a.getClickColor(t.color)),t.depth>1&&!t.options.children&&(t.options.color?t.color=t.options.color:t.color=t.ancestor.color,t.options.mouseOverColor?t.mouseOverColor=t.options.mouseOverColor:t.options.color?t.mouseOverColor=a.getHighLightColor(t.options.color):t.mouseOverColor=t.ancestor.mouseOverColor,t.options.clickColor?t.clickColor=t.options.clickColor:t.options.color?t.clickColor=a.getClickColor(t.options.color):t.clickColor=t.ancestor.clickColor);var e=a.getStandardColorAndOpacity(t.color,t.options.opacity);t.color=e.hex,t.opacity=e.alpha},_calculateLabelPos:function(t){var n=t.dataLabels;if(n&&n.enabled){switch(n.align){case e.CENTER:n._align=e.CENTER,t.labelPos={x:t.x+(t.dx-t.labelDim.width)/2,y:t.y+(t.dy-t.labelDim.height)/2};break;case e.TOP:default:n._align=e.LEFT,t.labelPos={x:t.x+s,y:t.y+s}}var r={x:t.x,y:t.y,width:t.dx,height:t.dy},a={x:t.labelPos.x,y:t.labelPos.y,width:t.labelDim.width,height:t.labelDim.height};i.containsRect(r,a)||(t.labelPos=null)}},calculateTooltipContent:function(t){var e=t.tooltip;if(e&&e.enabled&&e.formatter){var n=e.formatter;if("object"==typeof n){var r=e.style,a=n.identifier,o="";if(e.shared){if(-1!=a.indexOf("NAME")){for(var s,l=t,h=[t.name];(s=l.parent)&&s.depth;)l=s,h.unshift(s.name);o+=(r?"<span>":i.TOOLTIP_CATEGORY_STYLE)+h.join(" / ")+"</span><br>"}o+=this._createSeriesLine(t,a,r,n)}else o+=this._createCategoryLine(t,a,r,n),o+=this._createSeriesLine(t,a,r,n)}else o=i.getFormatterFunction(n).call(t);return o}return null},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.x+t.dx/2,centerY:t.y+t.dy/2}},effectAnimation:function(t,e){o.areaStyleEffectAnimation(t,e,e.x+e.dx/2,e.y+e.dy/2)},getDefaultEffectTime:function(){return o.AREA_STYLE_EFFECT_TIME},getStyle:function(t){return{fill:t.color,"fill-opacity":t.opacity,stroke:t.borderColor,"stroke-opacity":t.borderOpacity,"stroke-width":t.borderWidth}},getAttrs:function(t){return{x:-t.dx/2,y:-t.dy/2,width:t.dx,height:t.dy,transform:"translate("+(t.x+t.dx/2)+","+(t.y+t.dy/2)+")"}},getPointGraphicKey:function(){return"rect"},_getFixedPos:function(t){var e=this.vanchart.getPlotBounds(),i=e.x+t.x+t.dx,n=e.y+t.y;return[i,n]},zoomTo:function(t){t=this.zoomNow==t.parent?this.root:t.parent;var e=this.sx.domain([t.x,t.x+t.dx]),i=this.sy.domain([t.y,t.y+t.dy]),n=this.vanchart.getPlotBounds(),r=n.width/t.dx,a=n.height/t.dy;this.nodes.map(function(t){t.dx=r*t._dx,t.dy=a*t._dy,t.x=e(t._x),t.y=i(t._y),this._calculateLabelPos(t)},this),this.render(),this.zoomNow=t},getChartNodes:function(){return this.nodes},getZoom:function(){return this.zoom},_getPointGraphicGroup:function(){return this.pathGroup||(this.pathGroup=this.group.append(this.vanchart.renderer.group())),this.pathGroup},initialAnimation:function(){var t=this,e=this._getPointGraphicGroup().node(),i=this.vanchart.getPlotBounds(),n=i.width/2,r=i.height/2;d3.select(e).transition().duration(l).ease(h).attrTween("transform",function(){var t=d3.interpolate(0,1);return function(e){var i=t(e);return"matrix("+i+",0,0,"+i+","+(n-i*n)+","+(r-i*r)+")"}}).each("end",function(){t.initialAnimationMoving=!1})},updateAnimation:function(t,e,i){e.visible?d3.select(t).transition().duration(this.initialAnimationMoving?0:u).attr("x",-e.dx/2).attr("y",-e.dy/2).attr("width",e.dx).attr("height",e.dy).attr("transform","translate("+(e.x+e.dx/2)+","+(e.y+e.dy/2)+")"):this.dropAnimation(t,e,i)},createAnimation:function(t,e,i){this.initialAnimationMoving&&this.initialAnimation(),d3.select(t).attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("transform","translate("+e.vanishPos[0]+","+e.vanishPos[1]+")"),this.updateAnimation(t,e,i)},dropAnimation:function(t,e,i){d3.select(t).transition().duration(c).attr("width",0).attr("height",0).attr("transform","translate("+e.vanishPos[0]+","+e.vanishPos[1]+")").remove()},onPointMouseOver:function(t){var e=this;e.series._onState.call(e,!0)},onPointMouseOut:function(){var t=this;t.series._onState.call(t,!1)},_onState:function(t){var i=this,n=i.series,r=n.animation,a={"fill-opacity":t?1:i.opacity,fill:t?i.mouseOverColor:i.color};r?d3.select(i.graphic.style(a).rawElement).interrupt(e.SELECT_ANIMATION).transition(e.SELECT_ANIMATION).duration(d):i.graphic.style(a)},onPointTap:function(){this.series.getZoom()&&this.series.zoomTo(this)},_labelUseSeriesColor:function(){return!1},getInitShowTime:function(){return l},getReAppearTime:function(){return u}});t("../ChartLibrary").register(e.TREEMAP_CHART,f)}),i("chart/Bubble",["require","./Series","../utils/BaseUtils","../Constants","../utils/QueryUtils","../ComponentLibrary","../EffectHelper","../ChartLibrary"],function(t){var e=t("./Series"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("../utils/QueryUtils"),a=t("../ComponentLibrary"),o=t("../EffectHelper"),s=500,l=500,h=300,u=300,c="rgb(138, 138, 138)",d=e.extend({_refresh:function(){var t=this._getQueryList();i.extend(this,{sizeBy:r.queryList(t,"sizeBy"),maxSize:r.queryList(t,"maxSize"),minSize:r.queryList(t,"minSize"),shadow:r.queryList(t,"shadow"),displayNegative:r.queryList(t,"displayNegative")})},_refreshPointColor:function(t,e){return this.vanchart.getComponent(a.RANGE_LEGEND_COMPONENT)?e:t.getTargetValue()<0&&t.displayNegative?c:t.getTargetValue()<0?null:e},doLayout:function(){this._calculateBubblePosition()},getTargetKey:function(){return"size"},isNullValue:function(t){return this.type==n.FORCE_BUBBLE_CHART?"-"==t.x||"-"==t.y:"-"==t.x||"-"==t.y||"-"==t.size||i.hasNotDefined(t.size)},_getPointKey:function(t){return this.vanchart.isMap()?t.name:""+t.x+t.y},getPointValue4MinMax:function(t){var e=t.getTargetValue();return 0>e&&!t.displayNegative?0:t.minSize||t.maxSize?0:e},pushNormalLabelContent:function(t,e,i,r,a){this.pushBubbleNormalLabelContent(t,e,i,r,a,n.INSIDE)},_labelUseSeriesColor:function(){return!1},calculateTooltipContent:function(t){return t.series.vanchart.isMap()?this._calculateTooltipContent(t):this._calculateBubbleTooltipContent(t)},_calculateLabelPos:function(){},_calculateBubbleRadius:function(){if(this.points.length>0){var t=Math.max(this.maxSize,this.minSize),e=Math.min(this.minSize,this.maxSize),r=this.sizeBy==n.SIZE_BY_AREA,a=this.seriesMaxValue,o=this.seriesMinValue;if(!this._sizeByCurrentSeries()){var s=this.vanchart.isMap()?this.vanchart.getMinMaxFromSeries():this._calculateBubbleChartMinMax();a=i.pick(s.max,s[1]),o=i.pick(s.min,s[0])}var l=0;o!=a&&(l=r?(t*t-e*e)/(a-o):(t-e)/(a-o));var h=i.pick(this.vanchart.scale,1),u=this.getTargetKey();this.points.forEach(function(t){var i=l*(Math.abs(t[u])-o),a=r?Math.sqrt(e*e+i):e+i;if(t.minSize||t.maxSize){var s=isNaN(t.minSize)?t.maxSize:t.minSize;a=t.sizeBy==n.SIZE_BY_AREA?2*Math.sqrt(s):s}a=t[u]<0&&!t.displayNegative?0:a,t.radius=a/2*h})}},_sizeByCurrentSeries:function(){return i.hasDefined(this.options.minSize)&&i.hasDefined(this.options.maxSize)},_calculateBubbleChartMinMax:function(){var t=this.vanchart.seriesOfType(this.type),e=Number.MAX_VALUE,i=-e;return t.forEach(function(t){t._sizeByCurrentSeries()||(e=Math.min(e,t.seriesMinValue),i=Math.max(i,t.seriesMaxValue))}),{min:e,max:i}},_calculateBubblePosition:function(){var t=this.vanchart.isInverted(),e=this.xAxis,i=this.yAxis;this.points.forEach(function(n){var r=e.scale.rangeBand?e.scale.rangeBand()/2:0,a=e.scale(n.x)+r,o=i.scale(n.y);n.posX=t?o:a,n.posY=t?a:o;var s=!(n.isNull||n.size<0&&!n.displayNegative);s&&n.dataLabels&&n.dataLabels.enabled&&(n.labelPos={x:n.posX-n.labelDim.width/2,y:n.posY-n.labelDim.height/2})})},getTrendLineXYValues:function(t){return this._getNormalTrendLineXYValues(t)},_getFixedPos:function(t){var e,i=this.vanchart,n=i.getPlotBounds(),r=t.radius||0;if("vanChartMap"==i.vanChartType){var o=i._leaflet,s=(i.getComponent(a.GEO_COMPONENT),t.getLatLng());s&&(e=o.latLngToContainerPoint(s))}else e={x:n.x+t.posX,y:n.y+t.posY};return e?(r=(r+1)/1.414,[e.x+r,e.y+r]):void 0},getInitShowTime:function(){return s+800},getReAppearTime:function(){return l},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.posX,centerY:t.posY}},getStyle:function(t){var e=t.series,n=e.vanchart,r=n.renderer;n.bubbleShadowFilter=n.bubbleShadowFilter||r.createDropShadowFilter(0,0,.2,2);var a={fill:t.color,"fill-opacity":t.opacity,stroke:t.color,"stroke-opacity":1,"stroke-width":0};return t.shadow&&!i.isMS&&(a.filter="url(#"+i.stamp(n.bubbleShadowFilter)+")"),a},getMapStyle:function(t){return{radius:t.radius,fill:!0,fillColor:t.color,fillOpacity:t.opacity,stroke:!0,weight:0,color:"none"}},getMapMouseOverStyle:function(t){return{fillColor:t.mouseOverColor,opacity:.35,color:t.mouseOverColor,weight:6,stroke:!0}},getAttrs:function(t){return{r:t.radius,transform:i.makeTranslate({x:t.posX,y:t.posY})}},getPointGraphicKey:function(){return"circle"},mapEffectAnimation:function(t,e){o.bubbleEffectAnimation(e,!0)},effectAnimation:function(t,e){o.bubbleEffectAnimation(e)},getDefaultEffectTime:function(){return o.MARKER_EFFECT_TIME},createAnimation:function(t,e){d3.select(t).attr("transform",i.makeTranslate({x:e.posX,y:e.posY})).attr("r",0).transition().delay(e.delayTime).ease("bounce").duration(this.state==n.STATE_TO_SHOW?u:s).attr("r",e.radius)},updateAnimation:function(t,e){d3.select(t).transition().duration(l).ease("back-out").attr("r",e.radius).attr("transform","translate("+e.posX+","+e.posY+")")},dropAnimation:function(t,e){d3.select(t).transition().duration(h).ease("back-in").attr("r",0).remove()},getHighLightStyle:function(t){return{stroke:t.mouseOverColor,"stroke-opacity":.35,fill:t.mouseOverColor,"fill-opacity":1,"stroke-width":6}},getPressedStyle:function(t){return{stroke:t.mouseOverColor,"stroke-opacity":.35,"stroke-width":6,fill:t.clickColor,"fill-opacity":t.clickOpacity}},onPointMouseOver:function(t){var e=this,i=e.series,r=i.animation,a=i.getHighLightStyle(e);i.vanchart.isLargeMode()||(r?d3.select(e.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION).duration(200).ease("back-out").style(a):e.graphic.style(a))},onPointMouseOut:function(t){var e=this,i=e.series,r=i.animation,a=i.getStyle(e);i.vanchart.isLargeMode()||(r?(d3.select(e.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION),d3.select(e.graphic.rawElement).style(a)):e.graphic.style(a))}});return t("../ChartLibrary").register(n.BUBBLE_CHART,d),d}),i("chart/ForceBubble",["require","./Bubble","../Constants","../utils/BaseUtils","../EffectHelper","../ChartLibrary"],function(t){var e=t("./Bubble"),i=t("../Constants"),n=t("../utils/BaseUtils"),r=t("../EffectHelper"),a=e.extend({_calculateBubblePosition:function(){},pushNormalLabelContent:function(t,e,i,n,r){return this._pushNormalLabelContent(t,e,i,n,r)},_getFixedPos:function(t){var e=t.radius||0,i=t.shadow,n=this.vanchart.getPlotBounds(),r=n.x+i.x+e,a=n.y+i.y+e;return[r,a]},calculateTooltipContent:function(t){return this._calculateTooltipContent(t)},_getAxisTypes:function(){return[]},getTargetKey:function(){return"y"},_getPointKey:function(t){return""+t.x},effectAnimation:function(t,e){r.forceBubbleEffectAnimation(e,e.shadow)},_getPointEffectGroup:function(t){var e=t.series,i=e.vanchart,n=i.renderer;return t.effectGraphic=t.effectGraphic||n.group().addTo(i.group).style("pointer-events","none")},getAttrs:function(t){return{r:t.radius,transform:n.makeTranslate({x:t.x,y:t.y})}},remove:function(){this.points.forEach(function(t){t.graphic&&(t.graphic.remove(),t.graphic=null)}),this.textGraphicGroup&&this.textGraphicGroup.remove(),this.group&&this.group.remove(),this.textGraphicGroup=this._canvas=this.group=null}});return t("../ChartLibrary").register(i.FORCE_BUBBLE_CHART,a),a}),i("chart/Scatter",["require","./Series","../utils/BaseUtils","../Constants","../utils/QueryUtils","../ComponentLibrary","../EffectHelper","../ChartLibrary"],function(t){var e=t("./Series"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("../utils/QueryUtils"),a=t("../ComponentLibrary"),o=t("../EffectHelper"),s=300,l=500,h=2,u=e.extend({_refresh:function(t){i.isNullMarker(this.marker)&&(this.marker.symbol=i.getDefaultMarkerSymbol(t));var e=this._getQueryList();i.extend(this,{lineWidth:r.queryList(e,"lineWidth")||0,interpolate:this._getSeriesInterpolate(e)})},doLayout:function(){var t=this.vanchart.isInverted(),e=this.xAxis,i=this.yAxis;this.points.forEach(function(n){var r=e.scale.rangeBand?e.scale.rangeBand()/2:0,a=e.scale(n.x)+r,o=i.scale(n.y);n.posX=t?o:a,n.posY=t?a:o,n.dataLabels&&n.dataLabels.enabled&&(n.labelPos={x:n.posX-n.labelDim.width/2,y:n.posY-n.marker.radius-h-n.labelDim.height})});var n=this,r=d3.svg.line().interpolate(n.interpolate).x(function(t){return t.posX}).y(function(t){return t.posY}).defined(function(t){return!t.isNull});this.points.sort(function(t,e){return t.x-e.x}),this.linePath=r(this.points)},getTargetKey:function(){return"size"},isNullValue:function(t){return"vanChartMap"==t.series.vanchart.vanChartType?"-"==t.size||i.hasNotDefined(t.size):"-"==t.x||"-"==t.y||i.hasNotDefined(t.y)},pushNormalLabelContent:function(t,e,i,r,a){this.pushBubbleNormalLabelContent(t,e,i,r,a,n.OUTSIDE)},calculateTooltipContent:function(t){return t.series.vanchart.isMap()?this._calculateTooltipContent(t):this._calculateBubbleTooltipContent(t)},_labelUseSeriesColor:function(t){return!0},_calculateLabelPos:function(t){},getTrendLineXYValues:function(t){return this._getNormalTrendLineXYValues(t)},_getFixedPos:function(t){var e,i=this.vanchart,n=i.getPlotBounds(),r=t.marker&&t.marker.radius||0;if("vanChartMap"==i.vanChartType){var o=i._leaflet,s=(i.getComponent(a.GEO_COMPONENT),t.getLatLng());s&&(e=o.latLngToContainerPoint(s))}else e={x:n.x+t.posX,y:n.y+t.posY};return e?(r=(r+1)/1.414,[e.x+r,e.y+r]):void 0},getInitShowTime:function(){return s+800},getReAppearTime:function(){return l},_animateEnd:function(){this._showLabels(),this._drawEffectPoints();var t=this,e=t.group,i=t.vanchart,n=i.renderer;t.lineGraphic=t.lineGraphic||n.path({d:t.linePath}).addTo(e).style({fill:"none","pointer-events":"none","stroke-width":t.lineWidth,stroke:t.color})},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.posX+t.marker.radius/2,centerY:t.posY-e.height/2-t.marker.radius/2}},getStyle:function(t){return{}},mapEffectAnimation:function(t,e){o.markerEffectAnimation(e,!0)},effectAnimation:function(t,e){o.markerEffectAnimation(e)},getDefaultEffectTime:function(){return o.MARKER_EFFECT_TIME},getMapStyle:function(t){var e=this._isHollowMarker(t.marker.symbol),n=i.isImageMarker(t.marker.symbol);return n?{icon:L.icon({iconUrl:t.marker.symbol,iconSize:[t.marker.width,t.marker.height]})}:e?{fill:!1,stroke:!0,color:t.marker.fillColor,weight:2,opacity:t.opacity,markerType:t.marker.symbol,radius:t.marker.radius}:{fill:!0,stroke:!1,fillColor:t.marker.fillColor,fillOpacity:t.opacity,markerType:t.marker.symbol,radius:t.marker.radius}},getMapMouseOverStyle:function(t){var e=this._isHollowMarker(t.marker.symbol),n=i.isImageMarker(t.marker.symbol);return n?{}:e?{color:t.mouseOverColor,radius:t.marker.radius+2}:{fillColor:t.mouseOverColor,radius:t.marker.radius+2}},_getPointKey:function(t){return this.vanchart.isMap()?t.name:""+t.x+t.y},getAttrs:function(t){return{transform:i.makeTranslate({x:t.posX,y:t.posY})}},_updatePointGraphicStyle:function(t){this._updateMarker(t)},_createPointGraphic:function(t){return t.graphic=this._createMarker(t.marker)},createAnimation:function(t,e){d3.select(t).attr("transform","translate("+e.posX+","+e.posY+") scale(0.01)").transition().delay(e.delayTime).duration(s).ease("back-out").attr("transform","translate("+e.posX+","+e.posY+") scale(1)")},updateAnimation:function(t,e){d3.select(t).transition().duration(l).ease("back-out").attr("transform","translate("+e.posX+","+e.posY+") scale(1)")},dropAnimation:function(t,e){d3.select(t).transition().duration(s).ease("back-in").attr("transform","translate("+e.posX+","+e.posY+") scale(0)").remove()},drawSeries:function(){var t=this,e=t.animation;t.visible&&t.lineGraphic&&(e?d3.select(t.lineGraphic.node()).transition().duration(l).ease("back-out").attr("d",t.linePath):t.lineGraphic.attr("d",t.linePath)),t.visible||t.lineGraphic&&t.lineGraphic.remove()},onPointMouseOver:function(t){var e=this,i=e.series;i.vanchart.isLargeMode()||i._onMarkerMouseOver(e)},onPointMouseOut:function(t){var e=this,i=e.series;i.vanchart.isLargeMode()||i._onMarkerMouseOut(e)}});return t("../ChartLibrary").register(n.SCATTER_CHART,u),u}),i("chart/MultiPie",["require","../Constants","../utils/BaseUtils","./TreeSeries","../utils/QueryUtils","../utils/ColorUtils","../utils/BoundsManager","./Point","../utils/BezierEasing","../EffectHelper","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("./TreeSeries"),r=t("../utils/QueryUtils"),a=t("../utils/ColorUtils"),o=(t("../utils/BoundsManager"),t("./Point"),t("../utils/BezierEasing")),s=t("../EffectHelper"),l=2/3,h=15,u=5,c=2*Math.PI,d=1e-10,f=1e3,p=300,g=400,m="bounce",v=o.css.swing,y=o.css.swing,_=n.extend({nodes:[],root:null,ordered:null,drilldownNow:null,center:[],innerRadius:null,radius:null,startAngle:null,endAngle:null,drilldown:null,rotatable:null,chartInfo:{},arc:d3.svg.arc().startAngle(function(t){return t.x}).endAngle(function(t){return t.x+t.dx}).innerRadius(function(t){return t.y}).outerRadius(function(t){return t.y+t.dy}),_refresh:function(){this.chartInfo={rotate:0},this.sx=d3.scale.linear(),this.sy=d3.scale.linear();var t=this._getQueryList(),e=r.queryList(t,"center"),n=r.queryList(t,"innerRadius"),a=r.queryList(t,"radius"),o=r.queryList(t,"gradual"),s=r.queryList(t,"drilldown"),l=r.queryList(t,"startAngle"),h=r.queryList(t,"endAngle"),u=r.queryList(t,"rotatable")&&i.isSupportSVG();l>h?l-=360:l==h&&(h=l+360),l=i.toRadian(l),h=i.toRadian(h),i.extend(this,{center:e,innerRadius:n,radius:a,gradual:o,drilldown:s,startAngle:l,endAngle:h,rotatable:u},!0)},visitAfter:function(t){var e=t.children,i=t.options.value;if(i=isNaN(i)?0:i,t.chSum=i,e&&(n=e.length)){var n,r=0,a=-1;for(this._calculatePercentage(e,"value");++a<n;)r+=Math.abs(e[a].chSum);var o=this.orderType;e.sort(function(t,e){return o&&null!=t.value&&null!=e.value?o*(Math.abs(t.value)-Math.abs(e.value)):t.index-e.index}),t.chSum=Math.max(r,Math.abs(i||0))}t.value=i||t.chSum||0,t.visible||(t.value=0,t.chSum=0)},_visitBefore:function(t){t.isNull=!1,t.depth&&(1===t.depth?t.points=[t]:(t.points=t.parent.points.slice(),t.points.push(t)))},doLayout:function(){var t,e,i=this,n=[],r=this.vanchart.getPlotBounds();i.center&&0!==i.center.length?(n[0]=this._getPercentValue(i.center[0],this.vanchart.width),n[1]=this._getPercentValue(i.center[1],this.vanchart.height)):n=[r.width/2+r.x,r.height/2+r.y],e={x:r.x,y:r.y,width:r.width,height:r.height},t=i.radius||Math.min(n[0]-e.x,e.x+e.width-n[0],n[1]-e.y,e.y+e.height-n[1]),i.chartInfo.innerRadius=i.innerRadius,i.chartInfo.radius=t,i.chartInfo.center=n,i.chartInfo.bounds=e,this.traverseData(this.root,this._visitBefore,this.visitAfter),this._initData(i)},_initData:function(t){t.nodes=t._bfsTraverseData(t.root);var i=t.graphics;if(i&&i.length===t.nodes.length&&t.nodes.map(function(t,e){t.graphic=i[e]}),t.radius)t._calcData(t.root),t._calculateLabelPos();else{t._calcData(t.root);var n=t.nodes.filter(function(t){return t.depth&&t.dx&&t.dataLabels&&t.dataLabels.enabled&&t.dataLabels.align===e.OUTSIDE}),r=t.chartInfo;r.radius=t.calcOutsideLabel(n,r.bounds,r.center),t._calcData(t.root),t._calculateLabelPos()}t.sx=this.sx.range([this.startAngle,this.endAngle]).domain([this.startAngle,this.endAngle]),t.sy=this.sy.range([0,this.innerRadius,this.radius]).domain([0,this.innerRadius,this.radius])},getDataToDraw:function(){return this.nodes},orderData:function(t){this.orderType=t===!0?1:t===!1?-1:null},_bfsTraverseData:function(t){var e=[],i=[];for(e.push(t);n=e.shift();){var n;i.push(n);var r=n.children;if(r&&(a=r.length))for(var a,o=-1;++o<a;)e.push(r[o])}return i},_calcData:function(t){function n(t,a,o,l,h,u,d){var f=t.children;if(t.x=a,t.y=(t.depth-2)*h+u+d,t.dx=o,t.hdx=l,t.dy=h,t.depth?(1!==t.depth||u||(t.y=0,t.dy=d),t.dataLabels&&t.dataLabels.enabled&&(t.dataLabels._align||t.dataLabels.align!==e.OUTSIDE||(t.dataLabels=i.clone(t.dataLabels),t.dataLabels._align=t.dataLabels._align||t.dataLabels.align),t.dataLabels._align===e.OUTSIDE&&(t.depth===s?t.dataLabels.align=e.OUTSIDE:t.dataLabels.align=e.INSIDE)),r._setColor(t,c,s),r.calculateLabelInfo(t)):(t.y=-1,t.dy=u+1),t._x=t.x,t._dx=t.dx,t._hdx=t.hdx,t._y=t.y,t._dy=t.dy,f&&(p=f.length)){var p,g,m,v,y=-1;for(o=t.value?o/Math.abs(t.value):0,l=t.chSum?l/Math.abs(t.chSum):0;++y<p;)g=f[y],m=Math.abs(g.value)*o,v=Math.abs(g.chSum)*l,n(g,a,m,v,h,u,d),a+=v}}var r=this;r.radius=r.chartInfo.radius,r.center=r.chartInfo.center,r.radius&&r.chartInfo.innerRadius&&(r.innerRadius=this._getPercentValue(r.chartInfo.innerRadius,r.radius));var a,o,s=t.height,h=r.radius,u=r.innerRadius,c=r.gradual,d=r.startAngle,f=r.endAngle,p=f-d;
    u?(a=s?(h-u)/s:0,o=a):(a=s>1?h*(1-l)/(s-1):0,o=s>1?h*l:h),n(t,d,p,p,a,u,o)},_setColor:function(t,i,n){if(t&&i&&n){if(t.options.color)t.color=t.options.color;else{var r,o,s=a.getRGBAColorArray(t.ancestor.color),l=a.rgb2hsb(s[0],s[1],s[2]),h=(t.depth-1)/n;i===e.GRADUAL_LIGHTER?(r=-l[1]*h,o=(1-l[2])*h):(r=(1-l[1])*h,o=-l[2]*h),t.color=a.mixColorWithHSB(t.ancestor.color,0,r,o)}if(t.options.mouseOverColor)t.mouseOverColor=t.options.mouseOverColor;else{var r,o;i===e.GRADUAL_LIGHTER?(r=.1,o=-.05):(r=-.1,o=.05),t.mouseOverColor=a.mixColorWithHSB(t.tooltip&&t.tooltip.enabled&&t.tooltip.shared?t.ancestor.color:t.color,0,r,o)}var u=a.getStandardColorAndOpacity(t.color,t.options.opacity);t.color=u.hex,t.opacity=u.alpha}},_calculateLabelPos:function(){var t=this,i=[],n=[];t.nodes.map(function(r){r.labelPos=null,r.dx<d||r.name&&r.depth&&r.dx&&r.dy&&(t.drilldownNow?r!==t.drilldownNow.parent:!0)&&r.dataLabels&&r.dataLabels.enabled&&(r.dataLabels.align===e.OUTSIDE?i.push(r):n.push(r))},t);var r=t.chartInfo;t.calcOutsideLabel(i,r.bounds,r.center,r.radius),t.calculateLeadLineStartPos(i),t.calculateInsideLabelBounds(n)},_getInnerRadius:function(t){return t.y},_getOuterRadius:function(t){return t.y+t.dy},_getStartAngle:function(t){return t.x},_getEndAngle:function(t){return t.x+t.dx},_getFixedPos:function(t,e){var i=this.center[0],n=this.center[1],r=this.getCenterAngle(t),a=t.y+t.dy,o=a*Math.sin(r)+i,s=a*Math.cos(r+Math.PI)+n;return r<Math.PI/2?s-=e.height:r>=Math.PI&&r<3*Math.PI/2?o-=e.width:r>=3*Math.PI/2&&c>r&&(s-=e.height,o-=e.width),[o,s]},drillDown:function(t){function i(t){var e=t.children,n=t;if(e&&(r=e.length))for(var r,a=-1;++a<r;){var o=i(e[a]);o.depth>n.depth&&(n=o)}return n}if(this.drilldownNow!==t){for(var n,a=t;(n=a.parent)&&n.depth;)if(a=n,!n.name)return;this.drilldownNow=t;var o,s,l=this.radius,u=this.innerRadius;if(t.depth){var c=t.ancestor.parent.height;if(0===t.height)o=[t.parent._y,t._y,t._y+t._dy],s=[0,h,l];else if(t.height+t.depth!==c){var d=i(t);o=[t.parent._y,t._y,t._y+t._dy,d._y+d._dy,l],s=[0,h,l/2,l,l]}else o=[t.parent._y,t._y,t._y+t._dy,l],s=[0,h,l/2,l]}else o=[0,u,l],s=[0,u,l];var f=t.depth+t.height;this.sx.domain([t._x,t._x+t._dx]),this.sy.domain(o).range(s),this.nodes.map(function(t){t.depth&&t.dataLabels&&t.dataLabels.enabled&&t.dataLabels._align===e.OUTSIDE&&(t.depth===f?t.dataLabels.align=e.OUTSIDE:t.dataLabels.align=e.INSIDE,r.merge(t,this.calculateLabelInfo(t),!0)),t.x=this.safeAngle(t._x),t.dx=this.safeAngle(t._x+t._dx)-t.x,t.y=this.safeRadius(t._y),t.dy=this.safeRadius(t._y+t._dy)-t.y,t===this.drilldownNow.parent&&(t.dx=this.safeAngle(7))},this),this._calculateLabelPos(),this.drawDrillDown(t)}},safeAngle:function(t){return Math.max(this.startAngle,Math.min(this.endAngle,this.sx(t)))},safeRadius:function(t){return Math.max(0,this.sy(t))},_getTranslate:function(){return this.center},_getMoreLabelDefaultCenter:function(t,e){var i=t.rotate||0,n=i+t.x+t.dx/2,r=t.y+t.dy/2,a=this._getArcPoint(r,n);return{centerX:a[0],centerY:a[1]}},effectAnimation:function(t,e){s.areaStyleEffectAnimation(t,e)},getDefaultEffectTime:function(){return s.AREA_STYLE_EFFECT_TIME},getStyle:function(t){return{display:t.name||!t.depth?"":"none",fill:t.color,"fill-opacity":t.depth?t.opacity:0,stroke:t.borderColor,"stroke-opacity":t.borderOpacity,"stroke-width":t.borderWidth}},getAttrs:function(t){return{d:this.arc(t)}},getPointGraphicKey:function(){return"path"},getChartNodes:function(){return this.nodes},getCenter:function(){return this.center},getInnerRadius:function(){return this.innerRadius},getRadius:function(){return this.radius},getStartAngle:function(){return this.startAngle},getEndAngle:function(){return this.endAngle},getDrilldown:function(){return this.drilldown},getRotatable:function(){return this.rotatable},getIsChanged:function(){return this.isChanged},_getPositionInPie:function(t){var e=t[0]-this.center[0],i=t[1]-this.center[1];return[e,i]},_getPointGraphicGroup:function(){return this.wrapGroup||(this.wrapGroup=this.group.append(this.vanchart.renderer.group()),this.pathGroup=this.wrapGroup.append(this.vanchart.renderer.group()),this.drawRing()),this.pathGroup},_isSeriesInteractive:function(){return!0},_getPointTextLabelGroup:function(){return this.textLabelGroup||(this.textLabelGroup=this.group.append(this.vanchart.renderer.group())),this.textLabelGroup},getAnimationTime:function(){return f},drawRing:function(){this.ringPath||(this.ringPath=this.group.append(this.vanchart.renderer.path()),this.ringPath.attr({d:d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(h).outerRadius(h+u)()}).style({display:"none",fill:"rgba(0,0,0,0.1)","pointer-events":"none"}))},drawDrillDown:function(t){var e=this,n=e.animation;e._removeDataLabels();var r=e.arc;if(n){var a=0;e.nodes.filter(function(t){return t.graphic}).map(function(i){i.graphic.animate(e,function(i,n){d3.select(i).transition().each(function(){++a}).duration(f).style("fill",function(){return n.color}).attrTween("d",function(){var t=this,e=d3.interpolate({x:t.x1,y:t.y1,dx:t.dx1,dy:t.dy1},n);return function(i){var n=e(i);return t.x1=n.x,t.y1=n.y,t.dx1=n.dx,t.dy1=n.dy,r(n)}}).attrTween("opacity",function(){var t=this;return function(e){return n.depth&&t.y1+t.dy1>=h?1:0}}).each("end",function(){d3.select(this).attr("opacity",n.depth&&n.dx&&n.y+n.dy>h?1:0),--a||e._animateEnd(t)})},i)}),t.depth?d3.select(e.ringPath.node()).transition().delay(f).style("display",""):d3.select(e.ringPath.node()).transition().style("display","none")}else e.nodes.map(function(t){t.graphic.attr({d:r(t),opacity:t.depth&&t.dx&&t.y+t.dy>h?1:0})}),e._animateEnd(t),i.isSupportSVG()||e.root.graphic.style({fill:"rgba(0,0,0,0)"}),e.ringPath.style("display",t.depth?"":"none")},_animateEnd:function(t){this.ordered=this.orderType,this._showLabels(),this.ringPath.style("display",t&&t.depth?"":"none"),this._drawEffectPoints()},updateGraphics:function(){var t=this.vanchart.renderer;this.graphics=this.nodes.map(function(e){return e.graphic&&t.registerInteractiveTarget(e,e.graphic),e.graphic})},initialAnimation:function(){var t=this;d3.select(this.wrapGroup.node()).transition().duration(550).ease("linear").attrTween("transform",function(){var t=d3.interpolate(-180,0);return function(e){var i=t(e);return"rotate("+i+")"}}),d3.select(this.pathGroup.node()).transition().duration(400).ease("linear").attrTween("transform",function(){var t=d3.interpolate(0,.9);return function(e){var i=t(e);return"scale("+i+")"}}).transition().duration(1e3).ease("elastic",1.1,.3).attrTween("transform",function(){var t=d3.interpolate(.9,1);return function(e){var i=t(e);return"scale("+i+")"}}).each("end",function(){t.initialAnimationMoving=!1})},updateAnimation:function(t,e,i,n){var r=this.arc,a=this.ordered!==this.orderType,o=a?y:m,s=a?g:f;e.graphic.attr("opacity",e.depth?1:0),d3.select(t).transition().ease(o).duration(s).attrTween("d",function(){var t=this,i=d3.interpolate({x:t.x1,y:t.y1,dx:t.dx1,dy:t.dy1},e);return function(e){var n=i(e);return t.x1=n.x,t.y1=n.y,t.dx1=n.dx,t.dy1=n.dy,r(n)}}).each("end",n)},createAnimation:function(t,e,i){function n(){t.x1=a.x,t.y1=a.y,t.dx1=a.dx,t.dy1=a.dy}var r,a;this.initialAnimationMoving?(this.initialAnimation(),a=e):a={x:e.x,y:e.y,dx:0,dy:e.dy},r=this.arc(a),e.graphic.attr("d",r).attr("opacity",e.depth?1:0),d3.select(t).each(n),this.initialAnimationMoving||this.updateAnimation(t,e)},dropAnimation:function(t,e,i){this.updateAnimation(t,e,i,function(){d3.select(t).remove()})},onPointMouseOver:function(){this.series._onState.call(this,!0)},onPointMouseOut:function(){this.series._onState.call(this,!1)},_onState:function(t){var e=this;if(e.tooltip&&e.tooltip.shared)for(var i,n=e;(i=n.parent)&&i.depth&&i.y+i.dy!==h;)n=i,i.series._onSingleState.call(i,t);e.series._onSingleState.call(e,t)},_onSingleState:function(t){var n=this,r=n.series,a=r.animation,o=n.graphic.rawElement,s={},l={};n.depth&&o.y1+o.dy1===h?l={opacity:t?1:0}:s={"fill-opacity":t?1:n.opacity,fill:t?n.mouseOverColor:n.color},a?(n.graphic.style(s),d3.select(o).interrupt(e.SELECT_ANIMATION).transition(e.SELECT_ANIMATION).duration(p).ease(v).attr(l)):(n.graphic.attr(l).style(s),n.depth||i.isSupportSVG()||n.graphic.style("fill","rgba(0,0,0,0)"))},onPanStart:function(t){this.rotatable&&(this.initPos=t.containerPoint,this.initRotate=i.toDegree(this.chartInfo.rotate))},onPanMove:function(t){if(this.rotatable){var e=this._getAngle(this._getPositionInPie(this.initPos),[0,0]),n=this._getAngle(this._getPositionInPie(t.containerPoint),[0,0]),r=n-e+this.initRotate;this.pathGroup.attr("transform","rotate("+r+")"),this.chartInfo.rotate=i.toRadian(r),this._calculateLabelPos(),this._rotateLabels()}},onPointTap:function(){this.series.getDrilldown()&&this.series.drillDown(this)},onPanEnd:function(t){this.vanchart.handler.panTarget=null},getEvents:function(){return{panstart:this.onPanStart,panmove:this.onPanMove,panend:this.onPanEnd}},_rotateLabels:function(){var t=this,e=t.vanchart;e.renderer,this.textLabelGroup;t.nodes.forEach(function(e){e.textGraphic&&!e.labelPos?(e.textGraphic.remove(),e.leadLine&&e.leadLine.remove(),e.textGraphic=null,e.leadLine=null):e.textGraphic&&e.labelPos?(e.textGraphic.attr("transform",i.makeTranslate(e.labelPos)),e.labelPos.startPos&&(e.leadLine?e.leadLine.attr("d",t._getLeadLinePath(e)):e.leadLine=t._getLeadLine(e))):!e.textGraphic&&e.labelPos&&t._createTextGraphic(e)})},getInitShowTime:function(){return f},getReAppearTime:function(){return g},isSupportLegendHighlight:function(){return!1}});t("../ChartLibrary").register(e.MULTIPIE_CHART,_)}),i("chart/PointerGauge",["require","../Constants","../utils/BaseUtils","../utils/ColorUtils","../utils/BoundsManager"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("../utils/ColorUtils"),r=t("../utils/BoundsManager"),a=150,o=90;return{gaugeType:e.POINTER_GAUGE,_doLayout:function(){this._dealSeriesLabel(),this._dealValueLabel(),"pointer"==this.style?this._fixPointerCenter():this._fixPointerSemiCenter()},_drawDiffMoreLabels:function(){var t=this,e=t.points,n=i.getTextHeight(t._getMoreLabelStyle()),r=n*e.length+n/2*(e.length-1),a=Math.max(0,(t.radius-r)/2),o="pointer"==t.style?a:-t.radius+a;e.forEach(function(e){t._showAndExitMoreLabel(e,0,o+n/2),o+=n+n/2})},getDataToDraw:function(){return this.points},_fixPointerCenter:function(){var t=this,i=t.gaugeRadius,n=t.center,r=t.seriesLabel.align||e.BOTTOM;if(n)t.centerX=n[0],t.centerY=n[1],t.radius=i;else{var a=t.bounds,o=20+t.seriesLabelDim.height,s=a.height-o,l=a.x+a.width/2,h=a.y+a.height/2;if(i=i||Math.min(a.width,s)/2-t.DEFAULT_PADDING,r==e.BOTTOM){if(h+i+o>a.y+a.height){var u=a.height-(2*i+o);u>=0&&(h=a.y+i+u/2)}}else if(h-i-o<a.y){var u=a.height-(2*i+o);u>=0&&(h=a.y+i+o+u/2)}t.centerX=l,t.centerY=h,t.radius=i}if(t.seriesLabelContent){var c=t.seriesLabelDim;t.seriesLabelPos={x:-c.width/2,y:r==e.BOTTOM?i+20:-i-20-c.height}}t.valueLabelContent&&this._dealValueLabelContent(t,i)},_fixPointerSemiCenter:function(){var t=this,i=t.gaugeRadius,n=t.seriesLabel.align;if(t.center)t.centerX=t.center[0],t.centerY=t.center[1],t.radius=i;else{var r=t.bounds,a=20+t.seriesLabelDim.height,o=r.height-a;i=i||Math.min(r.width/2,o/1.14)-t.DEFAULT_PADDING;var s=r.x+r.width/2,l=r.y+r.height/2+i/2;if(n==e.BOTTOM){if(l+.14*i+a>r.y+r.height){var h=r.height-(1.14*i+a);h>=0&&(l=r.y+i+h/2)}}else if(l-i-a<r.y){var h=r.height-(1.14*i+a);h>=0&&(l=r.y+i+a+h/2)}t.centerX=s,t.centerY=l,t.radius=i}if(t.seriesLabelContent){var u=t.seriesLabelDim;t.seriesLabelPos={x:-u.width/2,y:n==e.BOTTOM?.14*i+20:-i-20-u.height}}t.valueLabelContent&&this._dealSemiValueLabelContent(t,i)},_dealValueLabelContent:function(t,e){for(var n=t.gaugeAxis,r=n.options,a=n.scale.domain(),o=d3.scale.linear().domain(a).range([i.toRadian(-150),i.toRadian(150)]),s=i.getTextHeight(r.labelStyle),l=.16*e+s/2,h=t.valueLabel.style,u=t.valueLabel.useHtml,c=i.getTextHeight(h),d=this._getPointerTickBoundsManager(n,e,o,s),f=d.heightBoundsManager,p=d.widthBoundsManager,g=0,m=l,v=Number.MAX_VALUE,y=0,_=t.valueLabelContent.length;_>y;y++){var x=t.valueLabelContent[y],T=Math.min(-x.labelDim.width/2-c/4,v),b={x:T,y:m,width:2*Math.abs(T),height:l+c*(1+this.LINE_GAP)-m},A=x.labelContent,L=!1;if(!t._boundsInCircle(b))break;if(f.isOverlapped(b))break;for(;p.isOverlapped(b)&&A.length;){A=A.substr(0,Math.floor(.9*A.length));var C=i.getTextDimension(A+"...",h,u);T=Math.min(-C.width/2-c/4,v),b={x:T,y:m,width:2*Math.abs(T),height:l+c*(1+this.LINE_GAP)-m},L=!0}L&&(x.labelContent=A+"...",x.labelDim=i.getTextDimension(x.labelContent,h,u),T=Math.min(-x.labelDim.width/2-c/4,v)),x.labelPos={x:-x.labelDim.width/2,y:l+c/2},l+=c*(1+this.LINE_GAP),v=T,g++}t.valueLabelContent.length=g,t.valueLabelBackground={x:v,y:m,width:2*Math.abs(v),height:c*(1+this.LINE_GAP)*g+c}},_dealSemiValueLabelContent:function(t,e){for(var n=t.gaugeAxis,r=n.options,a=n.scale.domain(),o=d3.scale.linear().domain(a).range([i.toRadian(-90),i.toRadian(90)]),s=t.valueLabel.style,l=t.valueLabel.useHtml,h=i.getTextHeight(s),u=i.getTextHeight(r.labelStyle),c=-(.11*e+u/2)-h,d=this._getPointerTickBoundsManager(n,e,o,u),f=d.heightBoundsManager,p=d.widthBoundsManager,g=0,m=c,v=Number.MAX_VALUE,y=0,_=t.valueLabelContent.length;_>y;y++){var x=t.valueLabelContent[y];m-=h*(1+this.LINE_GAP);var T=Math.min(-x.labelDim.width/2-h/4,v),b={x:T,y:m,width:2*Math.abs(T),height:c-m},A=x.labelContent,L=!1;if(!t._boundsInCircle(b)){m+=h*(1+this.LINE_GAP);break}if(f.isOverlapped(b)){m+=h*(1+this.LINE_GAP);break}for(;p.isOverlapped(b)&&A.length;){A=A.substr(0,Math.floor(.9*A.length));var C=i.getTextDimension(A+"...",s,l);T=Math.min(-C.width/2-h/4,v),b={x:T,y:m,width:2*Math.abs(T),height:c-m},L=!0}L&&(x.labelContent=A+"...",x.labelDim=i.getTextDimension(x.labelContent,s,l),T=Math.min(-x.labelDim.width/2-h/4,v)),v=T,g++}t.valueLabelContent.length=g;for(var y=0;g>y;y++){var x=t.valueLabelContent[y];x.labelPos={x:-x.labelDim.width/2,y:m+h/2+y*h*(1+this.LINE_GAP)}}t.valueLabelBackground={x:v,y:m,width:2*Math.abs(v),height:h*(1+this.LINE_GAP)*g+h}},_boundsInCircle:function(t){for(var e=this.radius,i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x,y:t.y+t.height},{x:t.x+t.width,y:t.y+t.height}],n=0;4>n;n++){var r=i[n],a=Math.abs(r.x),o=Math.abs(r.y);if(Math.pow(a*a+o*o,.5)>e)return!1}return!0},_getPointerTickBoundsManager:function(t,e,i,n){var a=new r,o=new r,s=.84*e,l=t.tickData,h=this,u=.5*n;l.forEach(function(t){var e=i(t.tickValue),n=h._getPointerTickCenter(t,s,i);h._addToBoundsManager(e,{x:n.x-t.tickDim.width/2-u,y:n.y-t.tickDim.height/2-u,width:t.tickDim.width+u,height:t.tickDim.height+u},a,o)});var c=t.getMinorTickData()||[],d=.85*e,f=.1*e;return c.forEach(function(t){var e,n,r=i(t),s=h._getArcPoint(d,r);r<Math.PI?(e=s[0],n=s[1]):(e=s[0]-f,n=s[1]),h._addToBoundsManager(r,{x:e,y:n,width:f,height:f},a,o)}),{widthBoundsManager:a,heightBoundsManager:o}},_addToBoundsManager:function(t,e,i,n){t>-Math.PI/4&&t<Math.PI/4&&n.addBounds(e),(t<3*-Math.PI/4||t>3*-Math.PI/4)&&n.addBounds(e),i.addBounds(e)},_getPointerTickCenter:function(t,e,i){var n,r,a=i(t.tickValue),o=this._getArcPoint(e,a),s=o[0],l=o[1],h=t.tickDim,u=Math.atan(h.width/h.height);if(Math.abs(a)<u){var c=h.height/2;n=s+c*s/l,r=l+c}else if(a>=u&&a<=Math.PI-u){var c=h.width/2;n=s-c,r=l-c*l/s}else if(a>=u-Math.PI&&-u>=a){var c=h.width/2;n=s+c,r=l+c*l/s}else{var c=h.height/2;n=s-c*s/l,r=l-c}return{x:n,y:r}},drawSeries:function(){var t=this,e=t.vanchart,i=e.renderer,n=t.group;this.backgruondPath||(this.backgruondPath=i.path().addTo(n),this.hingePath=i.path().addTo(n),this.labelGroup=this._getPointTextLabelGroup(),this.axisGroup=this.labelGroup,this.needleGroup=i.group().addTo(n),this.pointerHingePath=i.path().addTo(n)),i.registerInteractiveTarget(this,n),this.labelGroup=this._getPointTextLabelGroup(),this.dropFilter||(this.dropFilter=i.createDropShadowFilter(0,2,.1,2),this.innerFilter=i.createInnerShadowFilter(0,2,.1,2)),"pointer"==this.style?this._drawPointer(180,.16,.07):this._drawPointer(98,.11,.055)},onSeriesPress:function(){var t=d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(0),e="pointer"==this.style?.16:.11,i="pointer"==this.style?.07:.055;t.outerRadius(e*this.radius*1.25),this.hingePath.attr("d",t()),t.outerRadius(i*this.radius*1.25),this.pointerHingePath.attr("d",t())},onSeriesPressUp:function(){var t=d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(0),e="pointer"==this.style?.16:.11,i="pointer"==this.style?.07:.055;t.outerRadius(e*this.radius),this.hingePath.attr("d",t()),t.outerRadius(i*this.radius),this.pointerHingePath.attr("d",t())},_getScale:function(){var t=this,e=t.style,n="pointer"==e?a:o,r=t.gaugeAxis.scale.domain();return d3.scale.linear().domain(r).range([i.toRadian(-n),i.toRadian(n)])},getStyle:function(t){var e=t.series;return{fill:e.needle,"fill-opacity":n.getColorOpacity(e.needle)}},getAttrs:function(t){return{d:t.series._getArrowPath(i.getValueInDomain(t.y,t.series._getScale().domain()))}},getPointGraphicKey:function(){return"path"},_getPointGraphicGroup:function(){return this.needleGroup},createAnimation:function(t,e){var n=e.series,r=n._getScale(),a=t._current_||r.domain()[0];t._current_=i.getValueInDomain(e.y,r.domain()),d3.select(t).transition().duration(n.ANIMATION_TIME).ease(n.EASE_TYPE).attrTween("d",function(){var e=d3.interpolate(a,t._current_);return function(t){return n._getArrowPath(e(t))}})},updateAnimation:function(t,e){this.createAnimation(t,e)},dropAnimation:function(t){d3.select(t).remove()},_getArrowPath:function(t){var e=this._getScale()(t),i=this.radius,n=this._getArcPoint(.9*i,e),r=this._getArcPoint(.02*i,e+Math.PI/2),a=this._getArcPoint(.02*i,e-Math.PI/2);return"M"+n[0]+","+n[1]+"L"+r[0]+","+r[1]+"L"+a[0]+","+a[1]+"Z"},_drawPointer:function(t,e,r){var a=this,o=a.radius,s=(a.vanchart.renderer,d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(0)),l=d3.svg.arc().startAngle(i.toRadian(-t)).endAngle(i.toRadian(t)).innerRadius(0).outerRadius(o).toCenter(!1);a.backgruondPath.attr("d",l()).style({fill:a.paneBackgroundColor,"fill-opacity":n.getColorOpacity(a.paneBackgroundColor),filter:"url(#"+i.stamp(a.dropFilter)+")"}),s.outerRadius(e*o),a.hingePath.attr("d",s()).style({fill:a.hingeBackgroundColor,"fill-opacity":n.getColorOpacity(a.hingeBackgroundColor),filter:"url(#"+i.stamp(a.innerFilter)+")"}),this._drawPointerTicks(),this._drawGaugeLabels(a.labelGroup),s.outerRadius(r*o),a.pointerHingePath.attr("d",s()).style({fill:a.hinge,"fill-opacity":n.getColorOpacity(a.hinge),filter:"url(#"+i.stamp(a.dropFilter)+")"})},_drawPointerTicks:function(){var t=this,e=t.defaultBands,n=t.vanchart,r=t.gaugeAxis,a=n.renderer,o=this.axisGroup,s=r.getTickData(),l=r.getMinorTickData(),h=r.options,u=h.labelStyle,c=h.useHtml,d=.95*t.radius,f=.84*t.radius,p=this._getScale();this.ticks=this.ticks||[];var g,m,v=r._bindData(this.ticks,s,function(t){return p(t.tickValue)}),y=[];for(v.exit.map(function(t){t.text&&t.text.remove(),t.remove()}),y=v.enter.map(function(t){var e=o.append(a.line().datum(t));return i.hasDefined(t.tickContent)&&(e.text=o.append(a.vtext(c))),e}),this.ticks=y=y.concat(v.update),g=0,m=y.length;m>g;g++){var _=y[g],x=_.datum(),T=p(x.tickValue),b=t._getArcPoint(d,T),A=t._getArcPoint(d-.1*t.radius,T),L=t._getColorFromBands(x.tickValue,e);_.attr("x1",b[0]).attr("y1",b[1]).attr("x2",A[0]).attr("y2",A[1]).style({stroke:L,"stroke-width":1});var C=t._getPointerTickCenter(x,f,p);_.text&&_.text.textContent(x.tickContent).style(u).attr({x:C.x-x.tickDim.width/2,y:C.y-x.tickDim.height/2,dy:".85em"})}this.minorTics=this.minorTics||[];var g,m,v=r._bindData(this.minorTics,l),y=[];for(g=0,m=v.exit.length;m>g;g++)v.exit[g].remove();for(g=0,m=v.enter.length;m>g;g++)y.push(o.append(a.line().datum(v.enter[g])));for(this.minorTics=y=y.concat(v.update),g=0,m=y.length;m>g;g++){var P=y[g],M=P.datum(),T=p(M),b=t._getArcPoint(d,T),A=t._getArcPoint(d-.05*t.radius,T),L=t._getColorFromBands(M,e);P.attr("x1",b[0]).attr("y1",b[1]).attr("x2",A[0]).attr("y2",A[1]).style({stroke:L,"stroke-width":1})}}}}),i("chart/SlotGauge",["require","../Constants","../utils/Formatter","../utils/ColorUtils","../utils/BaseUtils"],function(t){var e=t("../Constants"),i=(t("../utils/Formatter"),t("../utils/ColorUtils")),n=t("../utils/BaseUtils");return{gaugeType:e.SLOT_GAUGE,_getFixedPos:function(t,e){var i=t.series,n=i.centerX+1.08*i.radius+10,r=i.centerY-e.height/2;return[n,r]},_dealValueLabel:function(){var t=this,e=t.points[0],i=t.valueLabel,r=i.useHtml,a=i.formatter;if(e&&!e.isNull){for(var o=this._createMultiLineLabelContent(a,e),s=i.style,l=[],h=0,u=o.length;u>h;h++)l.push({labelContent:o[h],labelStyle:s,labelDim:n.getTextDimension(o[h],s,r)});t.valueLabelContent=l}},_fixCenterAndRadius:function(){var t=this,e=t.gaugeRadius;if(t.center)t.centerX=t.center[0],t.centerY=t.center[1],t.radius=e;else{var i=t.bounds;e||(e=Math.min(i.width/2,i.height/2),e=e/1.08-t.DEFAULT_PADDING);var r=i.x+i.width/2,a=i.y+i.height/2;t.centerX=r,t.centerY=a,t.radius=e}if(t.percentageLabelContent&&t.valueLabelContent&&t.valueLabelContent.length>0){t.percentageLabelPos={x:-t.percentageLabelDim.width/2,y:-t.percentageLabelDim.height*(1+t.LINE_GAP)};for(var o=0,s=0,l=t.valueLabelContent.length;l>s;s++){var h=t.valueLabelContent[s];h.labelPos={x:-h.labelDim.width/2,y:o},o+=h.labelDim.height*(1+t.LINE_GAP)}}else if(t.percentageLabelContent)t.percentageLabelPos={x:-t.percentageLabelDim.width/2,y:-t.percentageLabelDim.height/2};else if(t.valueLabelContent&&t.valueLabelContent.length>0)for(var u=n.getTextHeight(t.valueLabel.style),c=t.valueLabelContent.length,d=u*c+u*(c-1)/2,o=-d/2,s=0;c>s;s++){var h=t.valueLabelContent[s];h.labelPos={x:-h.labelDim.width/2,y:o},o+=u*(1+t.LINE_GAP)}},drawSeries:function(){var t=this,e=t.points[0],r=t.vanchart,a=r.renderer,o=t.group;this.backgruondPath||(this.backgruondPath=a.path().addTo(o),this.slotBackground=a.path().addTo(o),this.needlePath=a.circle().addTo(o)),this.labelGroup=this._getPointTextLabelGroup(),this.innderShadow||(this.innderShadow=a.createInnerShadowFilter(0,2,.05,0),this.dropShadow=a.createDropShadowFilter(0,2,.05,0));var s=d3.svg.arc().startAngle(n.toRadian(-135)).endAngle(n.toRadian(135)).innerRadius(0).outerRadius(t.radius).toCenter(!1).closePath(!1),l=d3.svg.arc().startAngle(n.toRadian(-135)).endAngle(n.toRadian(135)).innerRadius(0).outerRadius(t.radius).toCenter(!1).closePath(!1),h=t.gaugeAxis.scale.domain(),u=d3.scale.linear().domain(h).range([n.toRadian(-135),n.toRadian(135)]);if(t.backgruondPath.attr("d",l()).style({fill:"none",stroke:t.slotBackgroundColor,"stroke-linecap":"round","stroke-width":.16*t.radius,filter:"url(#"+n.stamp(this.innderShadow)+")"}),e&&!e.isNull){var c=u(h[0]),d=u(n.getValueInDomain(e.y,h)),f=n.toDegree(d-c),p=(t._getColorFromBands(h[0],t.defaultBands),e.color);t.slotBackground.style({fill:"none",stroke:i.colorToHex(p),"stroke-linecap":"round","stroke-width":.16*t.radius});var g=this._getArcPoint(t.radius,c);if(t.needlePath.attr("cx",g[0]).attr("cy",g[1]).attr("r",.048*t.radius).style({fill:t.needle,"fill-opacity":i.getColorOpacity(t.needle),filter:"url(#"+n.stamp(this.dropShadow)+")"}),t.animation)d3.select(t.slotBackground.node()).transition().duration(t.ANIMATION_TIME).ease(t.EASE_TYPE).attrTween("d",function(){this._lastRadian_=this._lastRadian_||c;var t=d3.interpolate(this._lastRadian_,d);return this._lastRadian_=d,function(e){return s.endAngle(t(e))()}}),d3.select(t.needlePath.node()).transition().duration(t.ANIMATION_TIME).ease(t.EASE_TYPE).attrTween("transform",function(){this._lastRotate_=this._lastRotate_||0;var t=d3.interpolate(this._lastRotate_,f);return this._lastRotate_=f,function(e){return"rotate("+t(e)+")"}});else{var m=s.endAngle(d)(),v=t._getArcPoint(t.radius,d),y=v[0],_=v[1],x=.008*t.radius;if(Math.abs(d-c)<1e-6){var s="a"+x+","+x+" 0 1,0 ";m="M"+(y-x)+","+_+s+2*x+",0 "+s+2*-x+",0 "}t.slotBackground.attr("d",m),t.needlePath.attr({cx:v[0],cy:v[1]})}this._drawGaugeLabels(this.labelGroup)}},_onSeriesMouseOver:function(){var t=this.points[0];if(t){var e=i.getHighLightColor(t.color),n=i.getHighLightColor(this.needle);this.slotBackground.style({stroke:i.colorToHex(e)}),this.needlePath.style({fill:n})}},_onSeriesUnChosen:function(){var t=this.points[0];t&&(this.slotBackground.style({stroke:t.color}),this.needlePath.style({fill:this.needle}))},onSeriesPress:function(){var t=this.points[0];if(t){var e=i.getColorWithDivider(t.color,1/.95),n=i.getColorWithDivider(this.needle,1/.95);this.slotBackground.style({stroke:i.colorToHex(e)}),this.needlePath.style({fill:n})}},onSeriesPressUp:function(){this._onSeriesMouseOver()}}}),i("chart/RingGauge",["require","../Constants","../utils/ColorUtils","../utils/BaseUtils"],function(t){var e=t("../Constants"),i=t("../utils/ColorUtils"),n=t("../utils/BaseUtils");return{gaugeType:e.RING_GAUGE,_fixCenterAndRadius:function(){var t,e,i=this,n=i.gaugeRadius;if(i.center)t=i.center[0],e=i.center[1];else{var r=i.bounds;n=n||Math.min(r.width/2,r.height/2)-i.DEFAULT_PADDING,t=r.x+r.width/2,e=r.y+r.height/2}i.centerX=t,i.centerY=e,i.radius=n;var a=0,o=i.valueLabelContent?i.valueLabelContent[0]:null;i.percentageLabelContent&&o?a=i.percentageLabelDim.height*(1+i.LINE_GAP)+o.labelDim.height:i.percentageLabelContent?a=i.percentageLabelDim.height:o&&(a=o.labelDim.height);var s=-a/2;i.percentageLabelContent&&(i.percentageLabelPos={x:-i.percentageLabelDim.width/2,y:s},s+=i.percentageLabelDim.height*(1+i.LINE_GAP)),o&&(o.labelPos={x:-o.labelDim.width/2,y:s})},drawSeries:function(){var t=this,e=t.vanchart,r=e.renderer,a=t.group;if(this.backgruondPath||(this.backgruondPath=r.path().addTo(a),this.ringPath=r.path().addTo(a),this.innerBackgroundPath=r.path().addTo(a),this.innerStroke=r.path().addTo(a),this.outerStroke=r.path().addTo(a)),this.labelGroup=this._getPointTextLabelGroup(),!this.colorGradient){var o={x1:"0%",y1:"0%",x2:"0%",y2:"100%"},s={offset:"0%","stop-color":"#ffffff"},l={offset:"100%","stop-color":"#dddddd"};this.colorGradient=r.colorGradient(o,[s,l]),s["stop-color"]="#dddddd",l["stop-color"]="#ffffff",this.clickedGradient=r.colorGradient(o,[s,l]),n.isSupportSVG()||(this.colorGradient="#ffffff",this.clickedGradient="#dddddd")}var h=d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(0).outerRadius(t.radius),u=t.gaugeAxis.scale.domain(),c=(t._getColorFromBands(u[0],t.defaultBands),.8*t.radius),d=c+2,f=c-1.5;this.backgruondPath.attr("d",h()).style({fill:t.paneBackgroundColor,"fill-opacity":i.getColorOpacity(t.paneBackgroundColor)});var p=t.points[0];if(p){var g=d3.svg.arc().startAngle(0).innerRadius(0).outerRadius(t.radius),m=p.color,v=Math.max(p.percentage,0),y=2*Math.PI*v*(t.clockwise?1:-1);t.animation?(this.ringPath.style({fill:i.colorToHex(m),"fill-opacity":i.getColorOpacity(m)}),d3.select(this.ringPath.node()).transition().duration(t.ANIMATION_TIME).ease(t.EASE_TYPE).attrTween("d",function(){this._lastRadian_=this._lastRadian_||0;var t=d3.interpolate(this._lastRadian_,y);return this._lastRadian_=y,function(e){return g.endAngle(t(e))()}})):this.ringPath.attr("d",g.endAngle(y)()).style({fill:m,"fill-opacity":i.getColorOpacity(m)})}this.innerBackgroundPath.attr("d",h.outerRadius(c)()).style({fill:t.innerPaneBackgroundColor,"fill-opacity":i.getColorOpacity(t.innerPaneBackgroundColor)}),this.outerStroke.attr("d",h.outerRadius(d)()).style({fill:"none",stroke:"#000000","stroke-opacity":.05,"stroke-width":4}),this.innerStroke.attr("d",h.outerRadius(f)()).style({fill:"none",stroke:this._getStroke(this.colorGradient),"stroke-width":3}),this._drawGaugeLabels(this.labelGroup)},_onSeriesMouseOver:function(){var t=this.points[0];t&&(this.innerStroke.style({stroke:this._getStroke(this.colorGradient)}),this.ringPath.style({fill:t.mouseOverColor}))},_onSeriesUnChosen:function(){var t=this.points[0];t&&(this.innerStroke.style({stroke:this._getStroke(this.colorGradient)}),this.ringPath.style({fill:t.color}))},onSeriesPress:function(){var t=this.points[0];t&&(this.innerStroke.style({stroke:this._getStroke(this.clickedGradient)}),this.ringPath.style({fill:t.clickColor}))},onSeriesPressUp:function(){this._onSeriesMouseOver()}}}),i("chart/ThermometerGauge",["require","../Constants","../utils/ColorUtils","../utils/BaseUtils"],function(t){var e=t("../Constants"),i=t("../utils/ColorUtils"),n=t("../utils/BaseUtils"),r=6,a=4,o=5,s=.001;return{gaugeType:e.THERMOMETER_GAUGE,_drawDiffMoreLabels:function(){function t(t,e){return t-e/2}var i=this.points[0];if(i&&!i.isNull){var n=this.gaugeAxis.scale.domain(),r=this.thermometerLayout==e.VERTICAL_LAYOUT,a=d3.scale.linear().domain(n).range(r?[this.radius,-this.radius]:[-this.radius,this.radius]),s=a(i.y),l=r?0-2*o:s,h=r?s:0-2*o;this._showAndExitMoreLabel(i,l,h,t,t)}},_fixCenterAndRadius:function(){var t=this.points[0];if(!t||t.isNull)return void(this.centerX=this.centerY=this.radius=0);var i=this,n=i.thermometerLayout==e.HORIZONTAL_LAYOUT?this._fixHorizontalThermometerCenter():this._fixVerticalThermometerCenter(),r=n.centerX,a=n.centerY,o=n.radius,s=i.valueLabelContent?i.valueLabelContent[0]:null;if(i.percentageLabelContent&&(i.percentageLabelPos.x-=r,i.percentageLabelPos.y-=a,i.percentageLabelPos.y=Math.min(i.percentageLabelPos.y,o-i.percentageLabelDim.height)),s){s.labelPos.x-=r,s.labelPos.y-=a;var l=o-s.labelDim.height-s.labelPos.y;0>l&&(s.labelPos.y+=l,i.percentageLabelContent&&(i.percentageLabelPos.y+=l))}i.centerX=r,i.centerY=a,i.radius=o},_fixHorizontalThermometerCenter:function(){var t,i,n,s=this,l=s.gaugeAxis,h=s.percentageLabel,u=s.valueLabel,c=s.valueLabelContent?s.valueLabelContent[0]:null,d=s.gaugeRadius,f=this._getThermometerSize();if(s.center)t=s.center[0],i=s.center[1],n=i;else{var p=s.bounds;n=p.y+(p.height-f)/2,t=p.x+p.width/2,d=d||p.width/2-l.getMaxTickWidth()-s.DEFAULT_PADDING}return(s.percentageLabelContent||c)&&(s.percentageLabelContent&&c&&h.align==e.TOP&&u.align==e.TOP?(s.center&&(n-=s.percentageLabelDim.height*(1+s.LINE_GAP),n-=c.labelDim.height*(1+s.HORIZONTAL_GAP),n-=l.getTickHeight()+a+r+a+o),s.percentageLabelPos={x:-s.percentageLabelDim.width/2+t,y:n},n+=s.percentageLabelDim.height*(1+s.LINE_GAP),c.labelPos={x:-c.labelDim.width/2+t,y:n},n+=c.labelDim.height*(1+s.HORIZONTAL_GAP)):(s.percentageLabelContent&&h.align==e.TOP&&(s.center&&(n-=s.percentageLabelDim.height*(1+s.HORIZONTAL_GAP),n-=l.getTickHeight()+a+r+a+o),s.percentageLabelPos={x:-s.percentageLabelDim.width/2+t,y:n},n+=s.percentageLabelDim.height*(1+s.HORIZONTAL_GAP)),c&&u.align==e.TOP&&(s.center&&(n-=c.labelDim.height*(1+s.HORIZONTAL_GAP),n-=l.getTickHeight()+a+r+a+o),c.labelPos={x:-c.labelDim.width/2+t,y:n},n+=c.labelDim.height*(1+s.HORIZONTAL_GAP)))),s.center?n=i+5:(n+=l.getTickHeight()+a+r+a+2*o,i=n-5),(s.percentageLabelContent||c)&&(s.percentageLabelContent&&c&&h.align==e.BOTTOM&&u.align==e.BOTTOM?(n+=s.percentageLabelDim.height*s.HORIZONTAL_GAP,s.percentageLabelPos={x:-s.percentageLabelDim.width/2+t,y:n},n+=s.percentageLabelDim.height*(1+s.LINE_GAP),c.labelPos={x:-c.labelDim.width/2+t,y:n}):(s.percentageLabelContent&&h.align==e.BOTTOM&&(n+=s.percentageLabelDim.height*s.HORIZONTAL_GAP,s.percentageLabelPos={x:-s.percentageLabelDim.width/2+t,y:n}),c&&u.align==e.BOTTOM&&(n+=c.labelDim.height*s.HORIZONTAL_GAP,c.labelPos={x:-c.labelDim.width/2+t,y:n}))),{centerX:t,centerY:i,radius:d}},_fixVerticalThermometerCenter:function(){var t,i,s,l=this,h=l.gaugeAxis,u=l.percentageLabel,c=l.valueLabel,d=l.gaugeRadius,f=l.points[0],p=h.scale.domain(),g=l.valueLabelContent?l.valueLabelContent[0]:null,m=this._getThermometerSize();if(l.center)t=l.center[0],i=l.center[1],s=t-2*o;else{var v=l.bounds;s=v.x+(v.width-m)/2,i=v.y+v.height/2,d=d||v.height/2-h.getTickHeight()-l.DEFAULT_PADDING}var y=d3.scale.linear().domain(p).range([d,-d]),_=i+y(n.getValueInDomain(f.y,p));return l.percentageLabelDim&&(_-=l.percentageLabelDim.height/3),(l.percentageLabelContent||g)&&(l.percentageLabelContent&&g&&u.align==e.LEFT&&c.align==e.LEFT?(l.center||(s+=Math.max(l.percentageLabelDim.width,g.labelDim.width),t=s+o),l.percentageLabelPos={x:s-l.percentageLabelDim.width,y:_},g.labelPos={x:s-g.labelDim.width,y:_+l.percentageLabelDim.height*(1+l.LINE_GAP)},s+=l.LINE_GAP*Math.max(l.percentageLabelDim.height,g.labelDim.height)):(l.percentageLabelContent&&u.align==e.LEFT&&(l.center&&(s-=l.percentageLabelDim.width+l.LINE_GAP*l.percentageLabelDim.height),
    l.percentageLabelPos={x:s,y:_},s+=l.percentageLabelDim.width+l.LINE_GAP*l.percentageLabelDim.height),g&&c.align==e.LEFT&&(l.center&&(s-=g.labelDim.width+l.LINE_GAP*g.labelDim.height),g.labelPos={x:s,y:_},s+=g.labelDim.width+l.LINE_GAP*g.labelDim.height))),l.center?s=t-o:t=s+o,s+=2*o+a+r+a+h.getMaxTickWidth(),(l.percentageLabelContent||g)&&(l.percentageLabelContent&&g&&u.align==e.RIGHT&&c.align==e.RIGHT?(s+=l.LINE_GAP*Math.max(l.percentageLabelDim.height,g.labelDim.height),l.percentageLabelPos={x:s,y:_},g.labelPos={x:s,y:_+l.percentageLabelDim.height*(1+l.LINE_GAP)}):(l.percentageLabelContent&&u.align==e.RIGHT&&(l.percentageLabelPos={x:s+l.LINE_GAP*l.percentageLabelDim.height,y:_}),g&&c.align==e.RIGHT&&(g.labelPos={x:s+l.LINE_GAP*g.labelDim.height,y:_}))),{centerX:t,centerY:i,radius:d}},_getThermometerSize:function(){var t=this,i=t.valueLabel,n=t.gaugeAxis,s=t.valueLabelContent?t.valueLabelContent[0]:null,l=t.percentageLabel;if(t.thermometerLayout==e.HORIZONTAL_LAYOUT){var h=0;return t.percentageLabelContent&&s?l.align==i.align&&(h+=t.percentageLabelDim.height+s.labelDim.height,h+=t.LINE_GAP*t.percentageLabelDim.height,h+=t.HORIZONTAL_GAP*(i.align==e.TOP?s.labelDim.height:t.percentageLabelDim.height)):t.percentageLabelContent?h+=(1+t.HORIZONTAL_GAP)*t.percentageLabelDim.height:s&&(h+=(1+t.HORIZONTAL_GAP)*s.labelDim.height),h+=2*o+a+r+a+n.getTickHeight()}var u=0;return t.percentageLabelContent&&s?l.align==i.align?(u+=Math.max(t.percentageLabelDim.width,s.labelDim.width),u+=t.VERTICAL_GAP*Math.max(t.percentageLabelDim.height,s.labelDim.height)):(u+=t.percentageLabelDim.width+s.labelDim.width,u+=t.VERTICAL_GAP*(t.percentageLabelDim.height+s.labelDim.height)):t.percentageLabelContent?u+=t.percentageLabelDim.width+t.VERTICAL_GAP*t.percentageLabelDim.height:s&&(u+=s.labelDim.width+t.VERTICAL_GAP*s.labelDim.height),u+=n.getMaxTickWidth(),u+=2*o+a+r+a},drawSeries:function(){var t=this,r=t.points[0],a=t.vanchart,l=a.renderer,h=t.group;if(r&&!r.isNull){var u=t.gaugeAxis,c=u.scale.domain(),d=t.thermometerLayout==e.VERTICAL_LAYOUT,f=n.getValueInDomain(r.y,c),p=r.color,g=t.radius;if(!this.backgruondLine){this.backgruondLine=l.line().addTo(h),this.thermometerLine=l.line().addTo(h),this.needlePath=l.circle().addTo(h),this.axisGroup=l.group().addTo(h);var m=p,v=i.mixColorWithHSB(m,0,-.1,.1),y=i.getStandardColorAndOpacity(m).alpha;1>y&&(v=i.mixColorWithAlpha(v,y));var _="0%",x="0%";d?x="100%":_="100%";var T={offset:"0%","stop-color":d?m:v},b={offset:"100%","stop-color":d?v:m};this.colorGradient=l.colorGradient({x1:"0%",y1:"0%",x2:_,y2:x},[T,b]);var A=i.getColorWithDivider(m,1/.95),L=i.mixColorWithHSB(m,0,-.1,.1);T={offset:"0%","stop-color":d?A:L},b={offset:"100%","stop-color":d?L:A},this.clickedColorGradient=l.colorGradient({x1:"0%",y1:"0%",x2:_,y2:x},[T,b]);var C=i.getColorWithDivider(r.mouseOverColor,1/.95),P=i.mixColorWithHSB(r.mouseOverColor,0,-.1,.1);T={offset:"0%","stop-color":d?C:P},b={offset:"100%","stop-color":d?P:C},this.mouseOverColorGradient=l.colorGradient({x1:"0%",y1:"0%",x2:_,y2:x},[T,b]),n.isSupportSVG()||(this.colorGradient=m,this.clickedColorGradient=A,this.mouseOverColorGradient=C)}this.labelGroup=this._getPointTextLabelGroup();var M=d3.scale.linear().domain(c).range([-g,g]),E="x1",w="y1",_="x2",x="y2",O="cx",S="cy",k=M(f),R=-g;d&&(E="y1",w="x1",_="y2",x="x2",O="cy",S="cx",R=g,k=M.range([g,-g])(f));var B=n.pick(t.thermometerLine.node()._lastX_,R);t.thermometerLine.node()._lastX_=k,t.backgruondLine.attr(E,-g).attr(w,0).attr(_,g).attr(x,s).style({fill:"none",stroke:t.slotBackgroundColor,"stroke-width":2*o,"stroke-linecap":"round"}),t.thermometerLine.attr(E,R).attr(w,0).attr(x,s).attr(_,B).style({stroke:t._getStroke(t.colorGradient),"stroke-width":2*o,"stroke-linecap":"round"}),t.needlePath.attr("r",.9*o).attr(O,B).attr(S,0).style({fill:t.needle,"fill-opacity":i.getColorOpacity(t.needle),"stroke-width":.6*o,stroke:i.mixColorWithHSB(p,0,.1,-.1)}),t.animation?(d3.select(t.thermometerLine.node()).transition().duration(t.ANIMATION_TIME).ease(t.EASE_TYPE).attr(_,k),d3.select(this.needlePath.node()).transition().duration(t.ANIMATION_TIME).ease(t.EASE_TYPE).attr(O,k)):(t.thermometerLine.attr(_,k),this.needlePath.attr(O,k).attr("r",.9*o)),this._drawGaugeLabels(this.labelGroup),this._drawThermometerTicks(M)}},_drawThermometerTicks:function(t){var i=this,r=(i.bands,i.vanchart),a=i.gaugeAxis,o=r.renderer,s=this.labelGroup,l=a.getTickData(),h=a.getMinorTickData(),u=a.options,c=u.labelStyle,d=u.useHtml,f="x1",p="y1",g="x2",m="y2",v=-9,y=-15,_=-13,x=-19,T=function(t,e){return{x:e-t.tickDim.width/2,y:x-.85*t.tickDim.height,dy:"0.85em"}};i.thermometerLayout==e.VERTICAL_LAYOUT&&(f="y1",p="x1",g="y2",m="x2",v=9,y=15,_=13,x=19,T=function(t,e){return{x:x,y:e-t.tickDim.height/2,dy:".85em"}}),this.ticks=this.ticks||[];var b,A,L=a._bindData(this.ticks,l,function(e){return t(e.tickValue)}),C=[];for(L.exit.map(function(t){t.text&&t.text.remove(),t.remove()}),C=L.enter.map(function(t){var e=s.append(o.line().datum(t));return n.hasDefined(t.tickContent)&&(e.text=s.append(o.vtext(d))),e}),this.ticks=C=C.concat(L.update),b=0,A=C.length;A>b;b++){var P=C[b],M=P.datum(),E=n.lineSubPixelOpt(t(M.tickValue),1);P.attr(f,E).attr(p,v).attr(g,E).attr(m,y).style({stroke:u.tickColor,"stroke-width":u.tickWidth}),P.text&&P.text.textContent(M.tickContent).style(c).attr(T(M,E))}this.minorTics=this.minorTics||[];var b,A,L=a._bindData(this.minorTics,h),C=[];for(b=0,A=L.exit.length;A>b;b++)L.exit[b].remove();for(b=0,A=L.enter.length;A>b;b++)C.push(s.append(o.line().datum(L.enter[b])));for(this.minorTics=C=C.concat(L.update),b=0,A=C.length;A>b;b++){var w=C[b],O=w.datum(),E=n.lineSubPixelOpt(t(O),1);w.attr(f,E).attr(p,v).attr(g,E).attr(m,_).style({stroke:u.minorTickColor,"stroke-width":u.minorTickWidth})}},_getFixedPos:function(t,i){var n,s,l=t.series,h=l.thermometerLayout;if(h==e.HORIZONTAL_LAYOUT){n=l.centerX-i.width/2;var u=l.centerY;if(s=u+o+10,l.percentageLabelContent&&l.percentageLabel.align==e.BOTTOM&&(s=u+l.percentageLabelPos.y+l.percentageLabelDim.height+10),l.valueLabelContent&&l.valueLabel.align==e.BOTTOM){var c=l.valueLabelContent[0];s=u+c.labelPos.y+c.labelDim.height+10}}else{s=l.centerY-i.height/2;var d=l.gaugeAxis.getMaxTickWidth(),f=l.centerX;if(n=f+o+a+r+a+d+10,l.percentageLabelContent&&l.percentageLabel.align==e.RIGHT&&(n=f+l.percentageLabelPos.x+l.percentageLabelDim.width+10),l.valueLabelContent&&l.valueLabel.align==e.RIGHT){var c=l.valueLabelContent[0];n=Math.max(n,f+c.labelPos.x+c.labelDim.width+10)}}return[n,s]},_onSeriesMouseOver:function(){var t=this.points[0];t&&(this.thermometerLine.style("stroke",this._getStroke(this.mouseOverColorGradient)),this.needlePath.style({stroke:i.getHighLightColor(t.color),fill:i.getHighLightColor(this.needle)}))},_onSeriesUnChosen:function(){var t=this.points[0];t&&(this.thermometerLine.style("stroke",this._getStroke(this.colorGradient)),this.needlePath.style({stroke:t.color,fill:this.needle}))},onSeriesPress:function(){var t=this.points[0];t&&(this.thermometerLine.style("stroke",this._getStroke(this.clickedColorGradient)),this.needlePath.style({stroke:i.getClickColor(t.color),fill:i.getClickColor(this.needle)}))},onSeriesPressUp:function(){this._onSeriesMouseOver()}}}),i("chart/Gauge",["require","../Constants","../utils/BaseUtils","./Series","../utils/QueryUtils","../utils/BoundsManager","../utils/Formatter","../utils/ColorUtils","./PointerGauge","./SlotGauge","./RingGauge","./ThermometerGauge","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("./Series"),r=t("../utils/QueryUtils"),a=(t("../utils/BoundsManager"),t("../utils/Formatter"),t("../utils/ColorUtils")),o=t("./PointerGauge"),s=t("./SlotGauge"),l=t("./RingGauge"),h=t("./ThermometerGauge"),u={pointer:o,slot:s,ring:l,thermometer:h},c=n.extend({DEFAULT_PADDING:5,LINE_GAP:.3,VERTICAL_GAP:.3,HORIZONTAL_GAP:.8,ANIMATION_TIME:1e3,EASE_TYPE:"quad-out",_refresh:function(){var t=this._getQueryList(),n=r.queryList(t,"style");n="pointer_semi"==n?e.POINTER_GAUGE:n;var a=r.queryList(t,"thermometerLayout"),o=r.queryList(t,"seriesLabel")||{},s=r.queryList(t,"valueLabel")||{},l=r.queryList(t,"percentageLabel")||{},h=r.queryList(t,"center");h&&(h=[].concat(h),h[0]=this._getPercentValue(h[0],this.vanchart.width),h[1]=this._getPercentValue(h[1],this.vanchart.height)),i.extend(this,{layout:r.queryList(t,"layout")||e.HORIZONTAL_LAYOUT,gaugeRadius:r.queryList(t,"radius"),center:h,style:r.queryList(t,"style"),bands:r.queryList(t,"bands"),seriesLabel:o,valueLabel:s,percentageLabel:l,needle:r.queryList(t,"needle"),hinge:r.queryList(t,"hinge"),clockwise:r.queryList(t,"clockwise"),hingeBackgroundColor:r.queryList(t,"hingeBackgroundColor"),paneBackgroundColor:r.queryList(t,"paneBackgroundColor"),slotBackgroundColor:r.queryList(t,"slotBackgroundColor"),innerPaneBackgroundColor:r.queryList(t,"innerPaneBackgroundColor")}),i.convertToREMUseDefault16PX(this.seriesLabel&&this.seriesLabel.style),i.convertToREMUseDefault16PX(this.valueLabel&&this.valueLabel.style),i.convertToREMUseDefault16PX(this.percentageLabel&&this.percentageLabel.style),(this.gaugeType!=n||this.thermometerLayout!=a)&&(this.remove(),this.backgruondPath=null,this.backgruondLine=null,this.ticks=this.minorTics=null,this.points.forEach(function(t){t.graphic&&(t.graphic.remove(),t.graphic=null)})),this.gaugeType=n,this.thermometerLayout=a,this.valueLabelBackground=this.seriesLabelContent=this.percentageLabelContent=this.valueLabelContent=null,i.extend(this,c.prototype,u[n])},_getPointTextLabelGroup:function(){if(!this.textGraphicGroup){var t=this.vanchart,e=(t.seriesTextRenderGroup,t.seriesTextDivGroup);this.textGraphicGroup=t.renderer.vgroup(),this.textGraphicGroup.renderG.addTo(this.group),e.append(this.textGraphicGroup.divG)}return this.textGraphicGroup.divG.attr("transform",i.makeTranslate(this._getTranslate())),this.textGraphicGroup},doLayout:function(){var t=this._calculateGaugeBounds();if(!t&&!this.gaugeRadius&&!this.center)throw new Error("gauge has no bounds");this.bounds=t,this._calculatePercentage();var e=this;e.defaultBands=(e.bands||[]).concat(e._getDefaultBands(e.gaugeAxis.scale.domain())),e.points.forEach(function(t){var i=e._getColorFromBands(t.getTargetValue(),e.defaultBands);i&&(i=a.getStandardColorAndOpacity(i),t.color=i.hex,t.opacity=i.alpha),t.mouseOverColor=a.getHighLightColor(t.color),t.clickColor=a.getClickColor(t.color)}),this._doLayout()},_doLayout:function(){this._dealPercentLabel(),this._dealValueLabel(),this._fixCenterAndRadius()},_createGroup:function(t,e){return t.group().addTo(e.seriesGroup)},_getAxisTypes:function(){return["gaugeAxis"]},getDataToDraw:function(){return[]},_calculatePercentage:function(){if(this.points.length){var t=this.gaugeAxis,e=t.scale.domain(),i=this.points;i.forEach(function(t){t.points=i,t.percentage=(t.y-e[0])/(e[1]-e[0])})}},_calculateLabelPos:function(){},_getTranslate:function(){return[Math.round(this.centerX),Math.round(this.centerY)]},_validPoint:function(){return this.points.filter(function(t){return!t.isNull})[0]},_dealSeriesLabel:function(){var t=this;if(t.seriesLabelContent="",t.seriesLabelDim={width:0,height:0},t.seriesLabel&&t.seriesLabel.enabled){var e=t.seriesLabel.style,i=t.calculateFormatterContent(t._validPoint(),t.seriesLabel),n=this.calculateTextDim(i);t.seriesLabelContent=i[0]?i[0].text:"",t.seriesLabelStyle=e,t.seriesLabelDim=n}},_dealPercentLabel:function(){var t=this;t.percentageLabelContent="",t.percentageLabelDim={width:0,height:0};var e=t.points[0];if(e&&!e.isNull&&t.percentageLabel&&t.percentageLabel.enabled){var n=i.clone(t.percentageLabel.style);n.color||(n.color=e.color);var r=t.calculateFormatterContent(e,t.percentageLabel),a=this.calculateTextDim(r);t.percentageLabelContent=r[0]?r[0].text:"",t.percentageLabelStyle=n,t.percentageLabelDim=a}},_dealValueLabel:function(){var t=this,e=t.valueLabel,n=e.style,r=e.useHtml,a=e.formatter;if(t.valueLabelContent="",t.valueLabelDim={width:0,height:0},t.valueLabel&&t.valueLabel.enabled){for(var o=[],s=0,l=t.points.length;l>s;s++){var h=t.points[s];if(!h.isNull){var u=this._calculateSingleLineLabelContent(a,h),c=i.getTextDimension(u,n,r);o.push({labelContent:u,labelDim:c,labelStyle:n})}}t.valueLabelContent=o}},_getDefaultBands:function(t){var e=r.queryList(this._getQueryList(),"color"),n=[];if(e)n.push({from:t[0],to:t[1],color:e});else{var a=t[0],o=t[1],s=i.accDiv(o-a,3),l=i.accAdd(a,s),h=i.accAdd(l,s),u=this.vanchart.options.colors;n=[{from:a,to:l,color:u[0]},{from:l,to:h,color:u[1]},{from:h,to:o,color:u[2]}]}return n},_getColorFromBands:function(t,e){if(e&&e.length)for(var i=0,n=e.length;n>i;i++){var r=e[i],a=Math.min(r.from,r.to),o=Math.max(r.from,r.to);if(t>=a&&o>=t)return r.color}},_calculateGaugeBounds:function(){for(var t=this.vanchart.seriesOfType(e.GAUGE_CHART),i=this.vanchart.getPlotBounds(),n=0,r=0,a=t.length;a>r;r++)t[r].center&&t[r].gaugeRadius&&n++;for(var o=this.layout==e.HORIZONTAL_LAYOUT,s=o?"width":"height",l=i[s]/Math.max(1,t.length-n),r=0,a=t.length;a>r;r++)if(t[r]==this&&!this.center)return o?{x:i.x+r*l,y:i.y,width:l,height:i.height}:{x:i.x,y:i.y+r*l,width:i.width,height:l};return{x:0,y:0,width:0,height:0}},_getFixedPos:function(t,e){var i,n,r=t.series,a=r.style;return"pointer_semi"==a?(i=r.centerX-e.width/2,n=r.centerY+.14*r.radius+10):(i=r.centerX+r.radius+10,n=r.centerY-e.height/2),[i,n]},_animateEnd:function(){},_isSeriesInteractive:function(){return!0},_drawGaugeLabels:function(t){var e=this,i=e.vanchart;e._removeNormalLabels(t),i.setTimeout(e.className+"more_label_animate",function(){i._removeChangeDataState(e),e._removeMoreLabels(),e._drawNormalLabels(t)},i.getShowMoreLabelTime()),e._drawMoreLabels()},_removeMoreLabels:function(){this.points.forEach(function(t){t.moreLabelG&&t.moreLabelG.remove(),t.moreLabelG=null})},_drawMoreLabels:function(){var t=this,e=t.vanchart;0!==e.getShowMoreLabelTime()&&t.visible&&t._drawDiffMoreLabels()},_drawDiffMoreLabels:function(){var t=this.points[0];t&&!t.isNull&&this._showAndExitMoreLabel(t,0,0)},_removeNormalLabels:function(t){for(var e=t.labels||[],i=0,n=e.length;n>i;i++)e[i]&&e[i].remove(),e[i]=null},_drawNormalLabels:function(t){var e=this,n=e.vanchart,r=n.renderer;if(t.labels=[],e.seriesLabelContent&&e._drawLabel(t,e.seriesLabelContent,e.seriesLabelPos,e.seriesLabelDim,e.seriesLabelStyle,e.seriesLabel.useHtml),e.percentageLabelContent&&e._drawLabel(t,e.percentageLabelContent,e.percentageLabelPos,e.percentageLabelDim,e.percentageLabelStyle,e.percentageLabel.useHtml),e.valueLabelContent&&e.valueLabelContent.length){if(e.valueLabelBackground){var o=i.rectSubPixelOpt(e.valueLabelBackground,0);o.rx=o.rx=.02*e.radius,t.labels.push(t.append(r.rect(o).style({fill:e.valueLabel.backgroundColor,"fill-opacity":a.getColorOpacity(e.valueLabel.backgroundColor),filter:"url(#"+i.stamp(e.innerFilter)+")"})))}for(var s=0,l=e.valueLabelContent.length;l>s;s++){var h=e.valueLabelContent[s];e._drawLabel(t,h.labelContent,h.labelPos,h.labelDim,h.labelStyle,e.valueLabel.useHtml)}}},_drawLabel:function(t,e,n,r,a,o){if(n){var s=this,l=s.vanchart,h=l.renderer,u=i.getTextHeight(a);t.labels.push(t.append(h.vtext(o).attr({x:n.x,y:n.y,dy:.85*u}).textContent(e).style(a)))}},_onSinglePointerTap:function(t){this.points&&1===this.points.length&&this.points[0].onClick(t.srcEvent)},_onSinglePointerMouseMove:function(t){this.points&&1===this.points.length&&this.vanchart.showTooltip(this.points[0],t),this.onSeriesMouseOver(t)},getClosestPoint:function(){return 1===this.points.length?this.points[0]:null},_getStroke:function(t){return i.isSupportSVG()?"url(#"+i.stamp(t)+")":t},getEvents:function(){return{mousemove:this._onSinglePointerMouseMove,seriesUnChosen:this.onSeriesUnChosen,tap:this._onSinglePointerTap,press:this.onSeriesPress,pressup:this.onSeriesPressUp}},isSupportLegendHighlight:function(){return!1},isSeriesAccumulated:function(){return!0}});return t("../ChartLibrary").register(e.GAUGE_CHART,c),c}),i("chart/Funnel",["require","./Series","../utils/BaseUtils","../Constants","../utils/QueryUtils","../utils/BezierEasing","../utils/Formatter","../EffectHelper","../ChartLibrary"],function(t){var e=t("./Series"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("../utils/QueryUtils"),a=t("../utils/BezierEasing"),o=t("../utils/Formatter"),s=t("../EffectHelper"),l=.03,h=.05,u=.03,c=.05,d=u+c,f=.4,p=.02,g=6,m=.35,v=400,y=400,_=500,x=500,T=e.extend({_refresh:function(){var t=this._getQueryList();i.extend(this,{sort:r.queryList(t,"sort"),useSameSlantAngle:r.queryList(t,"useSameSlantAngle")})},_getAxisTypes:function(){return[]},getTargetKey:function(){return"value"},getPointValue4MinMax:function(t){return Math.abs(t[this.getTargetKey()])},_getPointKey:function(t){return t.name},_calculatePercentage:function(){var t,e=this.points.filter(function(t){return t._bottomPoint=null,!t.isNull&&t.visible}),i=e.length;e.forEach(function(e,n){t?(t._bottomPoint=e,e.percentage=Math.abs(e.value/(t.value||1))):e.percentage=1,e.delayTime=v*Math.sqrt(n/i),t=e})},calculateLabelInfo:function(t){},calculateFunnelLabelInfo:function(t){var e=t.dataLabels,n=this.calculateFormatterContent(t,e),r=n&&(n.nameLabelContent||n.valueLabelContent);i.extend(t,{labelContent:n,labelDim:r?this.calculateOutSideTextDim(n):this.calculateTextDim(n)})},pushNormalLabelContent:function(t,e,r,a,s){var l=this;if(r.align==n.INSIDE)return l._pushNormalLabelContent(t,e,r,a,s);var h=e.identifier;if(-1!=h.indexOf("{NAME}")){var u=o.format(t.name,e.nameFormat),c=l.getCategorySeriesStyle(r,n.OUTSIDE,t),d=i.getTextDimension(u,c,a);s.nameLabelContent={text:u,style:c,dim:d},l.maxNameLabelWidth||(l.maxNameLabelWidth=0),l.maxNameLabelWidth=Math.max(l.maxNameLabelWidth,d.width)}if(-1!=h.indexOf("{VALUE}")||-1!=h.indexOf("{PERCENT}")){var f="";-1!=h.indexOf("{VALUE}")&&(f+=o.format(t.value,e.valueFormat),-1!=h.indexOf("{PERCENT}")&&(f+=n.BLANK_VALUE_PERCENTAGE)),-1!=h.indexOf("{PERCENT}")&&(f+=o.format(t.percentage,e.percentFormat));var p=l.getValuePercentageStyle(r,n.OUTSIDE,t),g=i.getTextDimension(f,p,a);s.valueLabelContent={text:f,style:p,dim:g},l.maxValueLabelWidth||(l.maxValueLabelWidth=0),l.maxValueLabelWidth=Math.max(l.maxValueLabelWidth,g.width)}},calculateOutSideTextDim:function(t){var e=0,i=0,n=0;if(t.nameLabelContent){var r=t.nameLabelContent.dim;e+=r.width,i=Math.max(i,r.height)}if(t.valueLabelContent){var r=t.valueLabelContent.dim;e+=r.width,i=Math.max(i,r.height)}if(t.nameLabelContent&&t.valueLabelContent){var a=this,o=a.vanchart,s=o.getPlotBounds();n=s.width*p,e+=n}return{width:e,height:i,nameValueGap:n}},_outSideSpecialLabel:function(t){var e=t.labelContent;return e&&(e.nameLabelContent||e.valueLabelContent)},doLayout:function(){var t=this;t.points.forEach(function(e){t.calculateFunnelLabelInfo(e)}),this._calculatePosAndSize()},_calculateTotalValue:function(t,e){var i=0;return this.points.filter(t).forEach(function(t){i+=Math.abs(t[e])}),i},_calculateSeriesMaxValue:function(t,e){var i=0;return this.points.filter(t).forEach(function(t){i=Math.max(i,Math.abs(t[e]))}),i},_calculatePosAndSize:function(){var t=this,e=t.vanchart,i=e.getPlotBounds(),n=function(t){return!t.isNull&&t.visible},r=t.getTargetKey(),a=i.width,o=i.height,s=a*(1-2*l),u=o*(1-2*h),c=t._calculateTotalLabelSize();s-=c.useWidth>0?c.useWidth+i.width*d:0,t.useCurveConnectorLine=!1;var f,p=t.points.filter(n),g=p.length;if(!(1>g)){var m=p[0],v=p[g-1],y=m.labelDim?m.labelDim.height:0,_=v.labelDim?v.labelDim.height:0;if(t.useSameSlantAngle){var x=t._calculateTotalValue(n,r),T=Math.abs(m[r])*u/x,b=Math.abs(v[r])*u/x,A=Math.max(0,y-T)/2;u-=A,u-=Math.max(0,_-b)/2,p.forEach(function(e){e.posX=Math.round(A*s/2/u),e.width=Math.round(s-2*e.posX),e.posY=Math.round(A),e.height=Math.round(Math.abs(e[r])*u/x),A+=e.height,t._calculateInsideLabelPos(e,f),f=e})}else{var L=t._calculateSeriesMaxValue(n,r),C=u/g,P=Math.max(0,y-C)/2;u-=P,u-=Math.max(0,_-C)/2,p.forEach(function(e,i){e.width=Math.round(s*Math.abs(e[r])/L),e.posX=Math.round((s-e.width)/2),e.posY=Math.round(P+i*C),e.height=Math.round(C),t._calculateInsideLabelPos(e,f),f=e})}t._calculateOutSideLabelPos(n,c.useWidth,c.useHeight)}},_calculateInsideLabelPos:function(t,e){t.dataLabels&&t.dataLabels.enabled&&(t.dataLabels.align==n.INSIDE?t.labelPos={x:t.posX+t.width/2-t.labelDim.width/2,y:t.posY+t.height/2-t.labelDim.height/2}:e&&(this.useCurveConnectorLine=this.useCurveConnectorLine||t.height+e.height<t.labelDim.height+e.labelDim.height))},_calculateOutSideLabelPos:function(t,e,i){var r=this,a=r.vanchart,o=a.getPlotBounds(),s=o.width*c,u=o.height*(1-2*h),d=Math.max(1,this.points.filter(t).length-1),f=Math.max(0,(u-i)/d),p=o.width*(1-2*l)-e,g=0;this.points.filter(t).forEach(function(t){var i=t.dataLabels;if(i&&i.enabled&&i.align==n.OUTSIDE&&u>g){var a=t.labelContent,o=t.labelDim,l=o.height,h=r.useCurveConnectorLine?g:t.posY+t.height/2-l/2,c=t._bottomPoint,d=((c?c.width:0)-t.width)/4,m={x:p,y:h+l/2},v={x:p-s,y:h+l/2},y={x:t.posX+t.width+d,y:t.posY+t.height/2};if(t.labelPos={x:p,y:h,endPos:m,midPos:v,startPos:y},g+=t.labelDim.height+f,r._outSideSpecialLabel(t)){var _=a.nameLabelContent,x=a.valueLabelContent,T=o.nameValueGap,b=Math.min(e,r.maxValueLabelWidth);if(_){var A=_.dim,L=_.text,C=e-T-b;L=r._omitLabel(L,C,_.style),_.text=L,_.x=0,_.y=(l-A.height)/2}if(x){var P=x.dim,M=x.text;M=r._omitLabel(M,b,x.style),x.text=M,x.x=e-b,x.y=(l-P.height)/2}}}})},_omitLabel:function(t,e,n){for(var r=i.getTextDimension(t,n,!1),a=!1;r.width>e&&t.length;)t=t.substr(0,Math.floor(.9*t.length)),r=i.getTextDimension(t+"...",n,!1),a=!0;return a&&t&&(t+="..."),t},_calculateTotalLabelSize:function(){var t=this,e=t.vanchart,i=e.getPlotBounds(),r=0,a=0;return t.points.filter(function(t){return!t.isNull&&t.visible&&t.dataLabels&&t.dataLabels.enabled}).forEach(function(e){e.dataLabels.align==n.OUTSIDE&&(r=+t.maxNameLabelWidth||+t.maxValueLabelWidth?Math.max(r,(t.maxNameLabelWidth||0)+(t.maxValueLabelWidth||0)+e.labelDim.nameValueGap):Math.max(r,e.labelDim.width),a+=e.labelDim.height)}),r=Math.min(r,i.width*f),{useWidth:r,useHeight:a}},_calculateLabelPos:function(){},_getFixedPos:function(t,e){var i=t.series._getTranslate();return[i[0]+t.posX+t.width/2,i[1]+t.posY+t.height/2]},_getMoreLabelDefaultCenter:function(t,e){return{centerX:t.posX+t.width/2,centerY:t.posY+t.height/2}},getInitShowTime:function(){return y+v},getReAppearTime:function(){return x},getFillFilter:function(t,e){if(e.style==n.STYLE_GRADUAL&&i.isSupportSVG()){var r=this,a=r.vanchart,o=a.renderer,s={x1:"0%",y1:"0%",x2:"100%",y2:"0%"},l={offset:"0%","stop-color":ColorUtils.getColorWithDivider(t,.9)},h={offset:"100%","stop-color":t};return e.colorGradient?o.updateColorGradient(e.colorGradient,s,[l,h]):e.colorGradient=o.colorGradient(s,[l,h]),"url(#"+i.stamp(e.colorGradient)+")"}return t},getAttrs:function(t){return{transform:i.makeTranslate({x:t.posX+t.width/2,y:t.posY+t.height/2}),d:t.series._getPointPath(t)}},_getPointPath:function(t){var e=t._bottomPoint,i=-t.width/2+","+-t.height/2,n=t.width/2+","+-t.height/2;if(e){var r=e.width/2+","+t.height/2,a=-e.width/2+","+t.height/2;return"M"+i+"L"+n+"L"+r+"L"+a+"Z"}var o="0,"+t.height/2;return"M"+i+"L"+n+"L"+o+"L"+o+"Z"},getPointGraphicKey:function(){return"path"},getStyle:function(t){return{fill:t.series.getFillFilter(t.color,t),"fill-opacity":t.opacity,stroke:t.borderColor,"stroke-opacity":t.borderOpacity,"stroke-width":t.borderWidth}},getHighLightStyle:function(t){return{stroke:t.mouseOverColor||t.color,fill:t.series.getFillFilter(t.mouseOverColor||t.color,t),"fill-opacity":t.opacity,"stroke-width":g,"stroke-opacity":0===t.opacity?0:m}},getPressedStyle:function(t){return{stroke:t.clickColor||t.color,fill:t.series.getFillFilter(t.clickColor,t),"fill-opacity":t.clickOpacity,"stroke-width":g,"stroke-opacity":0===t.opacity?0:m}},effectAnimation:function(t,e){s.areaStyleEffectAnimation(t,e,e.posX+e.width/2,e.posY+e.height/2)},getDefaultEffectTime:function(){return s.AREA_STYLE_EFFECT_TIME},createAnimation:function(t,e){var i=e.series,n=i.initialAnimationMoving;d3.select(t).attr("d",i._getPointPath(e)).attr("transform","translate("+(e.posX+e.width/2)+","+(e.posY+e.height/2)+") scale(0.01)").transition().delay(n?e.delayTime:0).ease(n?a.css["ease-out-quart"]:a.css.swing).duration(n?y:x).attr("transform","translate("+(e.posX+e.width/2)+","+(e.posY+e.height/2)+") scale(1)")},updateAnimation:function(t,e){d3.select(t).transition().duration(_).ease(a.css.swing).attr("d",e.series._getPointPath(e)).attr("transform","translate("+(e.posX+e.width/2)+","+(e.posY+e.height/2)+")")},dropAnimation:function(t,e){d3.select(t).remove()},onPointMouseOver:function(t){var e=this,i=e.series,r=i.animation,a=i.getHighLightStyle(e);r?d3.select(e.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION).duration(200).ease("back-out").style(a):e.graphic.style(a)},onPointMouseOut:function(t){var e=this,i=e.series,r=i.animation,a=i.getStyle(e);r?(d3.select(e.graphic.rawElement).interrupt(n.SELECT_ANIMATION).transition(n.SELECT_ANIMATION),d3.select(e.graphic.rawElement).style(a)):e.graphic.style(a)},_getTranslate:function(){var t=this.vanchart.getPlotBounds();return[t.x+t.width*l,t.y+t.height*h]},_updateDataLabels:function(){var t=this;t.getTextDataToDraw().forEach(function(e){t._outSideSpecialLabel(e)?t._createOutSideTextGraphic(e):t._createTextGraphic(e)})},_createOutSideTextGraphic:function(t){var e=this,n=function(t){return e.visible&&!t.isNull&&t.visible&&t.labelPos&&!isNaN(t.labelPos.x)&&!isNaN(t.labelPos.y)&&t.dataLabels&&t.dataLabels.enabled};if(n(t)){var r=e.vanchart,a=r.renderer,o=t.labelContent,s=t.labelPos.x,l=t.labelPos.y,h=t.dataLabels,u=h.useHtml,c=this._getPointTextLabelGroup(),d=a.vtext(u).attr("transform",i.makeTranslate([s,l])).style({"pointer-events":"none"}),f=function(t){if(t){var e=t.dim,i=t.text,n=t.style;a.vtspan(u).style({width:h.labelWidth+"px",height:h.labelHeight+"px"}).attr("y",t.y).attr("x",t.x).attr("dy",.85*e.height).attr("dx",0).textContent(i).style(n).addTo(d)}};f(o.nameLabelContent),f(o.valueLabelContent),t.textGraphic=c.append(d),t.labelPos.startPos&&(t.leadLine=c.append(this._getLeadLine(t)))}},isSeriesAccumulated:function(){return!0}});return t("../ChartLibrary").register(n.FUNNEL_CHART,T),T}),i("chart/WordCloud",["require","./Series","../Constants","../utils/BezierEasing","../EffectHelper","../utils/BaseUtils","../ChartLibrary"],function(t){var e=t("./Series"),i=t("../Constants"),n=t("../utils/BezierEasing"),r=(t("../EffectHelper"),t("../utils/BaseUtils")),a=800,o=600,s=320,l=320,h=e.extend({isNullValue:function(t){var e=t[t.series.getTargetKey()];return"-"==e||r.hasNotDefined(e)||r.hasNotDefined(t.name)},getTargetKey:function(){return"value"},_getPointKey:function(t){return t.name},_refresh:function(){},doLayout:function(){},_calculateLabelPos:function(){},_getFixedPos:function(t,e){var i=t.word,n=t.labelDim,a=t.series._getTranslate(),o=n.width/2,s=n.height/2,l=r.toRadian(i.rotate),h=l===Math.PI/2?s:o*Math.cos(l)-s*Math.sin(l),u=o*Math.sin(l)+s*Math.cos(l),c=.35*n.height*Math.cos(l),d=.35*n.height*Math.sin(l);return r.isSupportSVG()?[a[0]+i.x+h+d,a[1]+i.y+u-c]:[a[0]+i.x+n.width,a[1]+i.y+n.height]},_getTranslate:function(){var t=this.vanchart.getPlotBounds();return[t.x+t.width/2,t.y+t.height/2]},effectAnimation:function(t,e){var i=e.word,r=e.series,a=r._getEffectTime(e);d3.select(t).style("text-shadow","rgba(91,91,91,0.75) 0px 0px 0px").transition().ease(n.css["ease-out-quint"]).duration(.5*a).style("font-size",1.2*i.size+"px").style("text-shadow","rgba(91,91,91,0.75) 3px 3px 5px").transition().ease(n.css["ease-in-quint"]).duration(.5*a).style("font-size",i.size+"px").style("text-shadow","rgba(91,91,91,0.75) 0px 0px 0px")},getDefaultEffectTime:function(){return 2e3},_updateSeriesGraphicStyle:function(){this.drawSeries&&this.drawSeries()},_createPointGraphic:function(t){var e=this.getPointGraphicKey(t),i=this.vanchart.renderer;return t.graphic=i[e](),t.graphic.textContent(t.word.text),t.graphic},getPointGraphicKey:function(){return"text"},getAttrs:function(t){var e=t.word;return e?{"text-anchor":"middle",transform:"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}:{}},getStyle:function(t){var e=t.word;return e?{"font-size":e.size+"px","font-family":e.fontFamily,fill:t.color,"text-shadow":"","stroke-width":0,"stroke-opacity":1,"fill-opacity":t.opacity,filter:""}:{}},getHighLightStyle:function(t){function e(){for(var t=[0,15,35,50,65,85,1/0],e=[2,4,6,8,10,12],i=0,r=e.length;r>i;i++)if(n>t[i]&&n<=t[i+1])return e[i]}var i=t.word,n=i.size,a={"font-size":n+"px","font-family":i.fontFamily,fill:t.color,stroke:"white","stroke-opacity":1,"stroke-width":e(),"text-shadow":"rgba(91,91,91,0.75) 3px 3px 4px"};if(r.isMS){var o=t.series,s=o.vanchart,l=s.renderer;s.wordCloudShadowFilter=s.wordCloudShadowFilter||l.createDropShadowFilter(3,3,.75,4),a.filter="url(#"+r.stamp(s.wordCloudShadowFilter)+")"}return a},onPointMouseOver:function(){var t=this,e=t.series,i=e.getHighLightStyle(t),n=e.vanchart,a=n.renderer;t.effectInterval&&(clearInterval(t.effectInterval),d3.select(t.graphic.node()).interrupt()),!t.mouseOverGraphic&&r.isSupportSVG()&&(t.mouseOverGraphic=a.text().attr("class","mouseOverGraphic").style("pointer-events","none").textContent(t.name).addTo(n.mouseOverGroup)),t.mouseOverGraphic&&t.mouseOverGraphic.attr(e.getAttrs(t)).style(e.getStyle(t)).style("fill-opacity",1),t.graphic.style(i)},onPointMouseOut:function(){var t=this,e=t.series,i=e.getStyle(t);t.mouseOverGraphic&&t.mouseOverGraphic.style("fill-opacity",0),t.graphic.style(i),e.drawPointEffect(e,t)},_getInitFontSize:function(){var t=this,e=t.vanchart;return e.minFontSize/2+"px"},createAnimation:function(t,e){var i=e.series,r=i.initialAnimationMoving,o=e.word;d3.select(t).attr("text-anchor","middle").attr("transform","translate("+[o.x,o.y]+")rotate("+o.rotate+")").style("font-size",i._getInitFontSize()).transition().ease(n.css["ease-out-quart"]).duration(r?a:l).style("font-size",o.size+"px")},updateAnimation:function(t,e){var i=e.word;d3.select(t).transition().duration(o).ease(n.css["ease-out-quart"]).style("font-size",i.size+"px").attr("transform","translate("+[i.x,i.y]+")rotate("+i.rotate+")")},dropAnimation:function(t,e){d3.select(t).transition().duration(s).ease(n.css["ease-in-quart"]).style("font-size","0px").remove()},isSeriesAccumulated:function(){return!0}});return t("../ChartLibrary").register(i.WORD_CLOUD_CHART,h),h}),i("LineMapDataNormalizer",["require","./utils/BaseUtils"],function(t){function e(t,e){e.loadGeo();var i=t.name||t,n=e.getFeaturesByName(i);return n&&n.length?n.map(function(t){return{name:i,lnglat:t.geometry.coordinates}}):void 0}function i(t,e,i,r){if(t&&e){var a=0,o=t[0]||t;do{var s=0,l=e[0]||e;do{var h={};n(h,i),h.from=o,h.to=l,r.push(h)}while(l=e[++s])}while(o=t[++a])}}var n=t("./utils/BaseUtils").extend;return function(t,n){for(var r,a=[],o=-1;r=t[++o];){var s,l,h=r.from&&r.from.lnglat,u=r.to&&r.to.lnglat;h&&u?a.push(r):(s=h?r.from:e(r.from,n),l=u?r.to:e(r.to,n),i(s,l,r,a))}return a}}),i("LineMapLayer",["require","./utils/BaseUtils","./utils/ColorUtils","./Constants","./dom/Browser"],function(t){function e(t,e,i,n){if(!d[t]){var r=document.createElement("canvas");r.style.width=e+"px",r.style.height=i+"px",r.width=e*n,r.height=i*n;var a=r.getContext("2d");a.scale(n,n),d[t]=a}return d[t]}function i(t){if(f[t])return f[t];var e=new Image;return e.crossOrigin="Anonymous",e.onload=function(){f[t]=e},e.src=t,!1}function n(t,n,r,a,o){var s=l*Math.max(n,r),h=e(t,s,s,a),u=null;return(u=i(t))?(h.clearRect(0,0,s,s),h.translate(s/2,s/2),h.rotate(o),h.drawImage(u,-n/2,-r/2,n,r),h.rotate(-o),h.translate(-s/2,-s/2),h.getImageData(0,0,s*a,s*a)):null}function r(t,e,i){function r(t){return T=t,this}function s(){return T=[],this}function d(t){f(!0,t)}function f(e,n){var r=T.length;if(r&&T[0]&&T[0].series.large){T[0].refreshPointColor();var a=o.mixColorWithAlpha(T[0].color,T[0].opacity)}T.map(function(s){var l=s.series,d=l.large,f=s.visible&&l.visible,m=s.graphic,y=s.from.lnglat[0],_=s.from.lnglat[1],x=s.to.lnglat[0],T=s.to.lnglat[1];if(y!==x||_!==T){var b=i.latLngToContainerPoint([_,y]),A=i.latLngToContainerPoint([T,x]);
    if(s.ax=b.x,s.ay=b.y,s.bx=A.x,s.by=A.y,0===s.curveness&&(s.curveness=.01),f)if(d)t.ctx.globalCompositeOperation="lighter",s._color=a;else{var L=s.opacity;n&&(L*=s.series.name==n||s._rangeItem==n?1:.3),s._color=o.mixColorWithAlpha(s.color,L)}if(f&&!m){var C,P;if(s.graphic=t.arc(),s.graphic.point=s,C=g(s.graphic,s),!e&&!d&&l.animation&&s.lineWidth&&(s.graphic.style.endAngle=C[3],P=s.graphic.animate().duration(u).ease(c).tween("endAngle",C[4])),h&&!d&&f&&s.effect&&s.effect.enabled){var M=l.points.indexOf(s);P?P.end(v.bind(this,s,r,M)):v(s,r,M)}}else f&&m?g(s.graphic,s):!f&&m&&(s.graphic.needToRemove=!0,s.graphic=null,p(s))}})}function p(t){t._effect&&(t._effect.stop(),t._effect=null),t._symbol&&(t._symbol.map(function(t){t.needToRemove=!0}),t._symbol=null)}function g(t,e){var i=a.computeArc(e.ax,e.ay,e.bx,e.by,e.curveness);return t.setStyle({ox:i[0],oy:i[1],r:i[2],startAngle:i[3],endAngle:i[4],lineWidth:e.lineWidth,color:e._color}),i}function m(){e.clearAll()}function v(t,i,n){if(t.graphic){var r=t.effect.period||2e3;t._effect=e.animation.animate(t.graphic.style).delay(r/5*n/i).duration(r).tween("track",function(e){return y(e,t)}).end(v.bind(this,t,i,n))}}function y(t,e){var i=t.startAngle,n=t.endAngle,r=(n-i)/3,a=n-i+r,o=e.effect;if(o.symbol){var s=o.symbol,l=o.width,h=o.height,u=window.devicePixelRatio||1;return function(i){e._symbol&&(e._symbol[0].needToRemove=!0),e._symbol=_(a*i,t.ox,t.oy,t.r,t.startAngle,t.endAngle,r,s,l,h,u)}}var c=1.4,d=1.5;return function(i){e._symbol&&e._symbol.map(function(t){t.needToRemove=!0}),e._symbol=x(a*i,t.ox,t.oy,t.r,t.startAngle,t.endAngle,r,d,c,e.color)}}function _(t,i,r,a,o,s,h,u,c,d,f){var p=t-h+o;if(!(t+o>s)){var g=h+p,m=a*Math.cos(g)+i,v=a*Math.sin(g)+r,y=null;if(y=n(u,c,d,f,Math.PI+g)){var _=l*Math.max(c,d);return[e.image({imagedata:y,dx:(m-_/2)*f,dy:(v-_/2)*f})]}}}function x(t,i,n,r,a,o,s,l,h,u){for(var c=t>s?0:s-t,d=o>t+a?s:s-(t+a-o),f=t-s+a,p=[],g=d;g>c;g-=h/r){var m=g+f,v=r*Math.cos(m)+i,y=r*Math.sin(m)+n,_=g/s;p.push(e.circle({ox:v,oy:y,r:_*l,strokeStyle:"rgba(0, 0, 0, 0)",fillStyle:u}))}return p}var T=[];return{data:r,clear:s,draw:f,redraw:d,stop:m,removeEffect:p}}var a=t("./utils/BaseUtils"),o=t("./utils/ColorUtils"),s=(t("./Constants").LINE_MAP,t("./dom/Browser").touch),l=Math.SQRT2,h=a.isSupportSVG(),u=800,c="ease-in-out-quad",d={},f={};window.L&&(L.LineMapLayer=(L.Layer?L.Layer:L.Class).extend({options:{mainRenderer:null,animationRenderer:null,vanchart:null},initialize:function(t){L.setOptions(this,t)},setData:function(t){return this._pairs=t,this._draw()},addData:function(t){return this._pairs.push(t),this._draw()},setOptions:function(t){return L.setOptions(this,t),this._lineMap&&this._updateOptions(),this._draw()},redraw:function(){return this._lineMap.redraw(this.options.vanchart.highlightTarget),this.options.mainRenderer.flush(),this},removeEffect:function(t){this._lineMap&&this._lineMap.removeEffect(t)},onAdd:function(t){this._map=t,this._lineMap||this._initRenderer(),t.on("moveend",this._reset,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),t.on(this._events,this),this._reset()},onRemove:function(t){this.options.pane?(this.getPane().removeChild(this._canvas),this.getPane().removeChild(this._animCanvas)):(t.getPanes().overlayPane.removeChild(this._canvas),t.getPanes().overlayPane.removeChild(this._animCanvas)),t.off("moveend",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this),t.off(this._events,this)},addTo:function(t){return t.addLayer(this),this},_initRenderer:function(){var t=this._canvas=this.options.mainRenderer.dom,e=this._animCanvas=this.options.animationRenderer.dom,i=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);t.style[i]=e.style[i]="50% 50%";var n=this._map.options.zoomAnimation&&L.Browser.any3d,a="leaflet-zoom-"+(n?"animated":"hide"),o="leaflet-linemap-layer leaflet-layer ";L.DomUtil.addClass(t,o+a),L.DomUtil.addClass(e,o+a),this._lineMap=r(this.options.mainRenderer,this.options.animationRenderer,this._map)},_updateOptions:function(){},_reset:function(){this._lineMap.stop();var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),L.DomUtil.setPosition(this._animCanvas,t),this._draw()},_draw:function(){return this._map&&this._pairs&&this._pairs.length?(this._lineMap.data(this._pairs).draw(),void this.options.mainRenderer.flush()):void this.options.mainRenderer.flush()},_animateZoom:function(t){this._lineMap.stop();var e=this._map.getZoomScale(t.zoom),i=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());if(L.DomUtil.setTransform)L.DomUtil.setTransform(this._canvas,i,e),L.DomUtil.setTransform(this._animCanvas,i,e);else{var n=L.DomUtil.getTranslateString(i)+" scale("+e+")";this._canvas.style[L.DomUtil.TRANSFORM]=n,this._animCanvas.style[L.DomUtil.TRANSFORM]=n}},_click:function(t){s&&this._mousemove(t);var e=this.hoverPoint;e&&e.onClick&&e.onClick(t.originalEvent)},_mousemove:function(t){for(var e,i,n=this.options.mainRenderer,r=this.options.vanchart,o=this,s=n.elements,l=n.elements.length,h=a.getMousePos(t,n.dom);e=s[--l];)if(e.contain(h)){i=e;break}var u=i&&i.point,c=u&&u.series.large;u?(r.showTooltip(u,t),n.dom.parentElement.style.cursor="pointer",u.mouseOverColor&&!c&&u!==o.hoverPoint&&(i.style.color=i.point.mouseOverColor)):(r.hoverPoint||r.hideTooltip(),n.dom.parentElement.style.cursor=""),c||o.hoverPoint==u||(o.hoverPoint&&(o.hoverPoint.graphic.style.color=o.hoverPoint._color),o.hoverPoint=u,n.flush())},_events:{click:function(t){this._click(t)},mousemove:function(t){this._mousemove(t)}}}),L.lineMapLayer=function(t){return new L.LineMapLayer(t)})}),i("chart/LineMap",["require","../Constants","../utils/BaseUtils","../utils/QueryUtils","../ComponentLibrary","./Series","../utils/Formatter","../LineMapDataNormalizer","../LineMapLayer","../ChartLibrary"],function(t){var e=t("../Constants"),i=t("../utils/BaseUtils"),n=t("../utils/QueryUtils"),r=t("../ComponentLibrary"),a=t("./Series"),o=t("../utils/Formatter"),s=t("../LineMapDataNormalizer"),l=(t("../LineMapLayer"),"{SERIES}"),h="{VALUE}",u="{PERCENT}",c="{FROM.NAME}",d="{TO.NAME}",f=6,p=Math.PI,g=a.extend({_loadData:function(t){var e=this.vanchart.getComponent(r.GEO_COMPONENT);return s(t,e)},_refresh:function(){},_refreshPoint:function(t,e){var i=t.series.vanchart;i.getComponent(r.GEO_COMPONENT);t.lineWidth=n.queryList(e,"lineWidth"),t.curveness=n.queryList(e,"curveness"),t.from=t.options.from,t.to=t.options.to},getTargetKey:function(){return"value"},_getPointKey:function(t){return t.from.lnglat.join()+t.to.lnglat.join()},_getFixedPos:function(t,e){var n=i.computeArc(t.ax,t.ay,t.bx,t.by,t.curveness),r=(n[3]+n[4])/2;r%=2*p;var a=n[2]+f,o=a*Math.cos(r)+n[0],s=a*Math.sin(r)+n[1];return p/2>=r||(p>=r?o-=e.width:1.5*p>=r?(o-=e.width,s-=e.height):s-=e.height),[o,s]},_calculateTooltipContent:function(t){var e=t.tooltip,n=this;if(e&&e.enabled){var r=e.formatter,a="";if("object"==typeof r){var o=e.style,s=r.identifier;a+=n._createCategoryLine(t,s,o,r),a+=n._createSeriesLine(t,s,o,r)}else a=i.getFormatterFunction(r).call(t);return a}},_createCategoryLine:function(t,e,n,r){var a="";if(-1!=e.indexOf(l)){var s=o.format(t.seriesName,r.seriesFormat);a+=(n?"<span >":i.TOOLTIP_SERIES_STYLE)+s+"</span>",a+="<br />"}return a},_createSeriesLine:function(t,e,n,r){var a="",s=function(t){return-1!==e.indexOf(t)},l=[];s(c)&&t.from.name&&l.push(t.from.name),s(d)&&t.to.name&&l.push(t.to.name),l.length&&(a+=(n?"<span>":i.TOOLTIP_SERIES_STYLE)+l.join("\u2192")+"</span>&nbsp;");var f=[];if(s(h)){var p=o.format(t[this.getTargetKey()],r.valueFormat);p&&f.push(p)}if(s(u)){var g=o.format(t.percentage,r.percentFormat);g&&f.push(g)}return f.length&&(a+=(n?"<span>":i.TOOLTIP_VALUE_STYLE)+f.join("&nbsp;&nbsp;")+"</span>"),a},remove:function(){this.points.map(function(t){t.remove()}),this.points=[]}});return t("../ChartLibrary").register(e.LINE_MAP,g),g}),i("component/BaseAxis",["require","../Constants","../utils/BaseUtils","../utils/QueryUtils","../utils/Formatter","../ComponentLibrary","../utils/BoundsManager","./Base","../utils/BezierEasing"],function(t){var e,i,n=t("../Constants"),r=t("../utils/BaseUtils"),a=(t("../utils/QueryUtils"),t("../utils/Formatter"),t("../ComponentLibrary")),o=(t("../utils/BoundsManager"),t("./Base")),s=t("../utils/BezierEasing"),l=400,h=s.css.swing,u=function(){return null==e&&(e=r.paddingConvertWithScale("0.1875rem")),e},c=5,d=function(){return null==i&&(i=r.paddingConvertWithScale("0.3125rem")),i},f=5,p=4,g=100,m=5,v="main",y="minor",_=15,x=o.extend({labelRotation:0,_refresh:function(){this.series=[],this.isRangePoints=!0,this.animation=this.vanchart.isSupportAnimation(),this.piece=null,this.forecast=[0,0],this._zoomDomain=this._dataDomain=this._domain=this._tickStart=this._step=0,this.initScale();var t=this.options,e=t.title;r.convertToREMUseDefault16PX(t.labelStyle),r.convertToREMUseDefault16PX(e&&e.style),t.tickPadding=isNaN(t.tickPadding)?6:t.tickPadding,t.tickLength=t.enableTick?isNaN(t.tickLength)?4:t.tickLength:0,t.minorTickLength=t.enableMinorTick?isNaN(t.minorTickLength)?2:t.minorTickLength:0},_calculateSize:function(t){var e=this.options;this.tickLabelLength=this._getTickLabelLength(t);var i=this._getAxisTitleLength();i+=i>0?d():0;var n=this.tickLabelLength+i,r=this.isHorizontal(),a=this.vanchart.isInverted();if(r){var o=a?e.maxWidth:e.maxHeight;n=o?Math.min(this._maxHeight(o),n):n}else{var o=a?e.maxHeight:e.maxWidth;n=o?Math.min(this._maxWidth(o),n):n}this._size=Math.round(n)},_recordAxisSize:function(){this.isOnZero()||(this.vanchart.axisSize[this.getPosition()]+=this._size)},calculateDomainFromData:function(t){if(!t){var e=this.series;if(this.byPercent=!1,!this._isBaseAxis())for(var i=0,n=e.length;n>i&&!this.byPercent;i++)this.byPercent=e[i].stackByPercent;t=this._getDomainFromData()}this._dataDomain=t;var r=this.vanchart.getComponent(a.ZOOM_COMPONENT),o=this._zoomDomain||r&&r.getZoomInitDomain(this);if(this._isBaseAxis()&&o){var s=parseFloat(o[0]),l=parseFloat(o[1]);if(!isNaN(s)&&!isNaN(l)){var h=s;s=Math.min(s,l),l=Math.max(h,l)}this._calculateNiceDomain(this._dataDomain[0],this._dataDomain[1],isNaN(s)?null:s,isNaN(l)?null:l)}else{var u=this.options;this._calculateNiceDomain(this._dataDomain[0],this._dataDomain[1],u.min,u.max)}this._calculateDateFormat&&this._calculateDateFormat()},_calculateNiceDomain:function(t,e,i,n){var r=this.options;return r.log?this._calculateLogNiceDomain(t,e,i,n):this.byPercent?this._calculatePercentValueDomain(t,e,i,n):this._calculateValueNiceDomain(t,e,i,n)},calculateDomainFromZoom:function(){var t=this._zoomDomain,e=this.options;if(this._isBaseAxis())this._calculateNiceDomain(this._dataDomain[0],this._dataDomain[1],t[0],t[1]);else{var i=r.hasDefined(e.min)?Math.max(e.min,t[0]):t[0],n=r.hasDefined(e.max)?Math.min(e.max,t[1]):t[1];if(i>n)return;var o=this.type==a.VALUE_AXIS_COMPONENT&&r.hasNotDefined(e.min),s=this.isLog()?1:0;i=o?Math.min(s,i):i,this._calculateNiceDomain(t[0],t[1],i,n)}},isCategory:function(){return this.type==a.CATEGORY_AXIS_COMPONENT},zoomRefresh:function(t){this._zoomDomain=t,this.calculateDomainFromZoom()},axisZoom:function(t,e){var i,n,o=this.type==a.DATE_AXIS_COMPONENT,s=o?1e3:1e-11,l=this.vanchart.getPlotBounds();this.isHorizontal()?(i=Math.min(t[0],e[0])-l.x,n=Math.max(t[0],e[0])-l.x,i=Math.max(i,0),n=Math.min(n,l.width)):(i=Math.min(t[1],e[1])-l.y,n=Math.max(t[1],e[1])-l.y,i=Math.max(i,0),n=Math.min(n,l.height));var h=this.scale.invert(i),u=this.scale.invert(n);o&&(h=r.date2int(h),u=r.date2int(u)),Math.abs(h-u)<s||this.zoomRefresh([Math.min(h,u),Math.max(h,u)])},getAxisValue:function(t){return t},getTrendLineForecast:function(t){if(t.trendLine&&t.trendLine.period&&2===t.trendLine.period.length){var e=t.trendLine.period;this.forecast[0]=Math.min(0,e[0]),this.forecast[1]=Math.max(0,e[1])}},_getStartAndEndTick:function(){return this._domain},updateClipBounds:function(t){var e,i,r,a,o=this.isHorizontal(),s=this.isAxisReversed(),l=this.options;if(this.options.showLabel){var h=this._getStartAndEndTick(),u=this._getTickDim(this._getTickContent(h[0],l.formatter)),c=this._getTickDim(this._getTickContent(h[1],l.formatter));s?(r=c,a=u):(r=u,a=c),e=o?r.width:r.height,i=o?a.width:a.height,e=Math.round(e/2)+m,i=Math.round(i/2)+m,this.showArrow()&&(i=Math.max(i,_))}else e=0,i=this.showArrow()?_:0;var d=this.vanchart.getPlotBounds();if(o){var f=this.vanchart.axisSize,p=d.x+f.left+m,g=f.right+m;if(this.isCategory()&&!this.isRangePoints){var v=this._zoomDomain||this._dataDomain,y=(d.width-f.left-f.right)/v.length;p+=Math.round(y/2),g+=Math.round(y/2)}this.options.labelRotation<=-15?e=Math.round(2*(e-m)):this.options.labelRotation>=15&&(i=Math.round(2*(i-m))),e=Math.max(e-p,0)+m,i=Math.max(i-g,0)+m,t[n.LEFT]=Math.max(t[n.LEFT]||0,e),t[n.RIGHT]=Math.max(t[n.RIGHT]||0,i)}else t[n.TOP]=Math.max(t[n.TOP]||0,i),t[n.BOTTOM]=Math.max(t[n.BOTTOM]||0,e)},updateAxisSizeAndBounds:function(){this._setComponentBounds(this.getPosition(),this._size)},fixScaleAndTickData:function(){this.scale.domain(this._domain).rangeRound(this._getRange()),this._updateOriginTickData(),this._calculateTickPosAndStep()},dealOnZero:function(){var t=this.options;if(t.onZero){var e=t.onZero===!0?0:t.onZero,i=this.componentType==a.X_AXIS_COMPONENT?a.Y_AXIS_COMPONENT:a.X_AXIS_COMPONENT;i=this.vanchart.getComponent(i).getAxis(e);var r,o,s,l,h=i.getZeroPos(),u=this.vanchart.getPlotBounds();this.isHorizontal()?(r=u.x,o=h+u.y-(this.getPosition()==n.TOP?this.bounds.height:0),s=u.width,l=this.bounds.height):(r=h+u.x-(this.getPosition()==n.LEFT?this.bounds.width:0),o=u.y,s=this.bounds.width,l=u.height),this.bounds={x:r,y:o,width:s,height:l}}},_getTickLabelLength:function(t){var e=this.options,i=0,n=0,r=this.isHorizontal();if(e.showLabel&&(i=isNaN(+e.tickPadding)?u():e.tickPadding),e.enableTick&&(i+=isNaN(+e.tickLength)?c:e.tickLength),t)t.forEach(function(t){var e=t.tickDim;n=Math.max(n,r?e.height:e.width)});else for(var a=this._getTickValues(),o=0,s=a.length;s>o;o++){var l=this._getTickDim(this._getTickContent(a[o],e.formatter));n=Math.max(r?l.height:l.width,n)}return i+(e.showLabel?n:0)},_getTickDim:function(t){var e=this.options,i=e.useHtml,n=e.labelRotation||0,a=e.labelStyle||{};return r.getTextDimensionWithRotation(t,a,i,n)},_updateOriginTickData:function(){var t=this._getTickValues(),e=this.options,i=e.formatter,n=e.useHtml;isNaN(e.labelRotation)?e.autoRotate?this.labelRotation=this.getLabelAutoRotation(t,e,i):this.labelRotation=0:this.labelRotation=e.labelRotation,this.tickData=[];for(var o=e.labelStyle||{},s=r.extend({writingMode:"tb-rl","writing-mode":"tb-rl","-webkit-writing-mode":n?"vertical-rl":""},o),l=0,h=t.length;h>l;l++){var u=t[l],c=this._getTickContent(u,i);this.type===a.CATEGORY_AXIS_COMPONENT&&(c=c.trim());var d,f,p=o,g=this.labelRotation;90===Math.abs(g)&&r.hasChn(c)&&(g=360,p=s),d=r.getTextDimension(c,p,n),f=r.getTextDimRotated(d,g),n&&(f.width=isNaN(parseFloat(e.labelWidth))?f.width:parseFloat(e.labelWidth),f.height=isNaN(parseFloat(e.labelHeight))?f.height:parseFloat(e.labelHeight)),this.tickData.push({tickValue:u,tickContent:c,tickDim:f,tickRectDim:d,labelRotation:g})}},_isBaseAxis:function(){return this.series.length?this.componentType==this.series[0].getBaseAxisType():!1},getLabelAutoRotation:function(){return 0},_getAxisTitleLength:function(){var t=this.options.title,e=0;if(t){var i,n;this.titleRotation=t.rotation,r.hasChn(t.text)&&90===Math.abs(t.rotation)&&(this.titleRotation=360,r.extend(t.style,{writingMode:"tb-rl","writing-mode":"tb-rl","-webkit-writing-mode":t.useHtml?"vertical-rl":""})),i=r.getTextDimension(t.text,t.style,t.useHtml),n=r.getTextDimRotated(i,this.titleRotation),this.titleRectDim=i,this.titleDim=n,e=this.isHorizontal()?n.height:n.width}return e},getAxisTitleBounds:function(){var t=this.bounds,e=this.tickLabelLength+d(),i=this.getPosition(),r=t.x,a=t.y,o=t.width,s=t.height;switch(i){case n.LEFT:o-=e;break;case n.BOTTOM:a+=e,s-=e;break;case n.RIGHT:r+=e,o-=e;break;case n.TOP:s-=e}return{x:r,y:a,width:Math.max(o,0),height:Math.max(s,0)}},getTickLength:function(){var t=this.scale.range();return Math.abs(t[0]-t[1])/Math.max(this.tickData.length,1)},adjustDomain4Radius:function(){if(this.type===a.VALUE_AXIS_COMPONENT||this.type===a.DATE_AXIS_COMPONENT){var t=this._domain,e=this.type==a.DATE_AXIS_COMPONENT,i=this._getRange(),o=this._dataDomain,s=Math.max((t[0]+"").length,(t[1]+"").length);e&&(t=[r.int2date(t[0]),r.int2date(t[1])]);var l=this.scale.domain(t).range(i),h=this,u=this._isBaseAxis(),c=this.componentType===a.X_AXIS_COMPONENT?"x":"y",d=Number.MAX_VALUE,f=-Number.MAX_VALUE;if(this.series.map(function(t){if(t.visible&&((t.type===n.BUBBLE_CHART||t.type===n.SCATTER_CHART)&&t.points.map(function(t){var e=l(h.getAxisValue(t[c],t));if(!t.isNull&&!isNaN(e)){var i=r.pick(t.radius,t.marker&&t.marker.radius);d=Math.min(d,e-i),f=Math.max(f,e+i)}}),u&&(t.type===n.COLUMN_CHART||t.type===n.BAR_CHART||t.type===n.LINE_CHART||t.type===n.AREA_CHART))){var e=t.points;if(!e.length)return;var i,a=l(o[0]),s=l(o[1]),p=Math.min(a,s),g=Math.max(a,s);i=t.type===n.COLUMN_CHART||t.type===n.BAR_CHART?t.getSeriesOffsetAndWidth().width/2:e[0].marker&&e[0].marker.radius||1,isNaN(p)||(d=Math.min(d,p-i)),isNaN(g)||(f=Math.max(f,g+i))}}),d===Number.MAX_VALUE||f===-Number.MAX_VALUE)return;var p=l.invert(d),g=l.invert(f);e&&(p=r.date2int(p),g=r.date2int(g)),this.calculateDomainFromData([Math.min(Math.min(p,g),o[0]),Math.max(Math.max(p,g),o[1])]);var m=Math.max((this._domain[0]+"").length,(this._domain[1]+"").length);if(m>s)return!0}},_getRange:function(){return this._getPlotRange()},_getPlotRange:function(){var t=this.vanchart.getPlotBounds();return this.isHorizontal()?this.isAxisReversed()?[t.width,0]:[0,t.width]:this.isAxisReversed()?[0,t.height]:[t.height,0]},_getPlotBands:function(){var t=this.options.plotBands,e=this.scale,i=!(!e.rangeBand||!e.rangeBand());if("string"==typeof t){var n=t;t=[];for(var a=this._getTickValuesWithEndValue(),o=i?-1:0,s=a.length-1;s>o;s-=2)t.push({color:n,from:i?a[s]:a[s-1],to:a[s]})}else{t=t||[];for(var l=[],h=0,u=t.length;u>h;h++){var c=t[h];r.hasDefined(c.from)&&r.hasDefined(c.to)&&l.push(c)}t=l}return t},_getTickValuesWithEndValue:function(){var t=this._getTickValues(),e=this._domain[1],i=this.type==a.DATE_AXIS_COMPONENT;if(t.length){var n=t[t.length-1];i?r.date2int(n)<e&&t.push(r.int2date(e)):e>n&&t.push(e)}return t},getTickData:function(){return this.tickData},getMinorTickData:function(){var t=[],e=this.options,i=this._step;if(this.options.enableMinorTick&&this.tickData.length)if(this.type==a.CATEGORY_AXIS_COMPONENT){var n=Math.round(this.getTickLength()/5),o=this.tickData.length;o=this.isRangePoints?o-1:o;for(var s=0;o>s;s++)for(var l=this.tickData[s].tickPos,h=1;5>h;h++)t.push(l+n*h)}else{for(var u=e.minorTickInterval?e.minorTickInterval:i/5,s=0,c=this.tickData.length;c-1>s;s++){var d=this.tickData[s].tickValue,f=this.tickData[s+1].tickValue,p=d instanceof Date&&f instanceof Date;d=p?r.date2int(d):d,f=p?r.date2int(f):f;for(var g=r.accAdd(d,u);f>g;g=r.accAdd(g,u))t.push(p?r.int2date(g):g)}var m=this.tickData[this.tickData.length-1].tickValue,v=this.scale.domain()[1],p=m instanceof Date&&v instanceof Date;if(m=p?r.date2int(m):m,v=p?r.date2int(v):v,v>m)for(var g=m+u;v>=g;g+=u)t.push(p?r.int2date(g):g);var y=this.tickData[0].tickValue,_=this.scale.domain()[0];if(p=y instanceof Date&&_ instanceof Date,y=p?r.date2int(y):y,_=p?r.date2int(_):_,y>_)for(g=y-u;g>=_;g-=u)t.push(p?r.int2date(g):g)}return t},getMaxTickWidth:function(){var t=0;return this.tickData.forEach(function(e){t=Math.max(t,e.tickDim.width)}),t},getTickHeight:function(){return this.options.labelStyle&&this.options.showLabel?r.getTextHeight(this.options.labelStyle):0},_calculateTickPosAndStep:function(){var t=this.options,e=this.scale,i=this.getTickLength(),n=e.rangeBand?e.rangeBand()/2:0;if(this.tickData.forEach(function(t){t.tickPos=e(t.tickValue),t.tickLabelPos=t.tickPos+n}),t.showLabel)if(t.step){var a=0;this.tickData.forEach(function(e){a++%t.step&&(e.tickContent="")})}else{var o,s=this.isHorizontal(),l=1,h=1,u=Math.abs(Math.abs(this.labelRotation)-(s?0:90)),c=u>=15&&90!==u;o=r.toRadian(u);var d,f,p,g,m=-1,v=Math.sin(o);this.tickData.forEach(function(t){if(""!==t.tickContent)if(c)g=t.tickRectDim.height,f=Math.abs(t.tickPos-d),p=(g+m)/2,f*v>p||-1===m?(l=1,d=t.tickPos,m=g):(l++,h=Math.max(h,l));else{var e=s?t.tickDim.width:t.tickDim.height;i&&(h=Math.max(h,Math.ceil(e/i)))}});var a=0;this.tickData.forEach(function(t){a++%h&&(t.tickContent="")})}else this.tickData.forEach(function(t){t.tickContent=""})},_getAxisOriginPoint:function(){var t,e,i=this.bounds,r=this.getPosition();switch(r){case n.TOP:t=i.x,e=i.y+i.height;break;case n.BOTTOM:t=i.x,e=i.y;break;case n.LEFT:t=i.x+i.width,e=i.y;break;case n.RIGHT:t=i.x,e=i.y}return{x:t,y:e}},getPosition:function(){var t=this.componentType==a.X_AXIS_COMPONENT?"bottom":"left",e=this.options.position||t;if(!this.vanchart.isInverted())return e;switch(e){case n.TOP:return n.RIGHT;case n.RIGHT:return n.BOTTOM;case n.BOTTOM:return n.LEFT;case n.LEFT:return n.TOP}},isAxisReversed:function(){return this.componentType===a.X_AXIS_COMPONENT&&this.vanchart.isInverted()?!this.options.reversed:this.options.reversed},isOnZero:function(){return this.options.onZero},getLineWidth:function(){return this.options.lineWidth},showArrow:function(){return this.options.showArrow},getTitleAlign:function(){var t=this.options.title;if(!t)return null;if(this.vanchart.isInverted())switch(t.align){case n.TOP:return n.RIGHT;case n.RIGHT:return n.BOTTOM;case n.BOTTOM:return n.LEFT;case n.LEFT:return n.TOP}return this.isHorizontal()?t.align||n.LEFT:t.align||n.TOP},_calculateLogNiceDomain:function(t,e,i,n){var a=this.options,o=a.log,s=parseInt(r.pick(a.tickInterval,1));t=t>=1?1:t,t=0>=t?1:t,t=r.pick(i,t),e=r.pick(n,e),t=Math.pow(o,Math.floor(r.log(o,t))),e=Math.pow(o,Math.ceil(r.log(o,e))),this._domain=[t,e],this._tickStart=t,this._step=s},_calculatePercentValueDomain:function(t,e,i,n){var a=this.options,o=r.pick(i,0),s=r.pick(n,1),l=r.pick(a.tickInterval,.25);this._domain=[o,s],this._tickStart=o,this._step=l},_calculateValueNiceDomain:function(t,e,i,n){var o=this.type==a.VALUE_AXIS_COMPONENT&&!this._isBaseAxis(),s=this.options;o&&(t>0?t=0:0>e&&(e=0)),t=r.hasDefined(i)?i:t,e=r.hasDefined(n)?n:e,t>=e&&(e=t+g*(this.type===a.DATE_AXIS_COMPONENT?1e3:1));var l=s.tickInterval||this._linearTickInterval(t,e),h=this._linearNiceDomain(t,e,l);t=r.hasDefined(i)?i:h[0],e=r.hasDefined(n)?n:h[1],t>=e&&(e=t+g*(this.type===a.DATE_AXIS_COMPONENT?1e3:1));var u=h[0];if(r.hasDefined(i)){var c=r.accMul(Math.ceil(r.accDiv(r.accAdd(i,-u),l)),l);u=r.accAdd(u,c)}this._domain=[t,e],this._tickStart=u,this._step=l},_linearTickInterval:function(t,e,i){i=i||this._getDefaultTickCount();var n=e-t,r=Math.pow(10,Math.floor(Math.log(n/i)/Math.LN10)),o=i/n*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),this.type===a.DATE_AXIS_COMPONENT&&(r=Math.max(r,1e3)),r},_linearNiceDomain:function(t,e,i){return t=r.accMul(Math.floor(t/i),i),e=r.accMul(Math.ceil(e/i),i),[t,e]},_getDefaultTickCount:function(){return this.vanchart.options.chartType==n.RADAR_CHART?p:f},getIndexByPosition:function(t){var e,i=this.getPlotBounds(),n=this.scale,o=n(this.isAxisReversed()?n.domain()[n.domain().length-1]:n.domain()[0]);e=this.isHorizontal()?t[0]-i.x-o:t[1]-i.y-o;var s;switch(this.type){case a.DATE_AXIS_COMPONENT:s=r.date2int(n.invert(e));break;default:s=n.invert(e)}return s=Math.round(s)},_valueInDomain:function(){return!0},render:function(){this.lastScale=this.scale&&this.scale.copy();var t=this.vanchart,e=t.renderer;this.axisGroup||(this.axisGroup=e.group().add(),e.clip(this.clipAxisGroup=e.group().add(),t.plotClip));var i=this.bounds,n={x:i.x,y:i.y,width:i.width,height:i.height};this.isHorizontal()?(n.x=0,n.width=t.width):(n.y=0,n.height=t.height),this.axisGroupClip?e.updateClip(this.axisGroupClip,n):(this.axisGroupClip=e.createClip(n),e.clip(this.axisGroup,this.axisGroupClip)),this.axisLineGroup||(this.axisLineGroup=e.group().add()),0!==this.series.length&&(this._drawPlotBands(),this._drawGridLine(),this._drawTickLine(),this._drawTickLabel(),this._drawPlotLines(),this._drawAxisTitle())},isLog:function(){return this.options.log},getZeroPos:function(){switch(this.type){case a.VALUE_AXIS_COMPONENT:return this.isLog()?this.scale(1):this.scale(0);case a.DATE_AXIS_COMPONENT:return this.scale(r.int2date(0));case a.CATEGORY_AXIS_COMPONENT:return 0}},renderSpecial:function(){if(0===this.series.length||!this.options.lineWidth)return this.axisLine&&this.axisLine.remove(),this.arrowGroup&&this.arrowGroup.remove(),void(this.axisLine=this.arrowGroup=null);var t=this.vanchart;t.renderer;this._drawAxisLine()},_drawPlotBands:function(){var t,e,i,n,a,o=this._getPlotBands(),s=this.scale,u=s.rangeBand,c=u?s.rangeBand():0,d=this.vanchart.renderer,f=this.animation,p=this.vanchart.getPlotBounds(),g=this,m=g.isHorizontal(),v=0,y=0,_=p.width,x=p.height;for(this.plotBandsGroup||(this.plotBandsGroup=d.group().addTo(this.clipAxisGroup),this.plotBands=[]),this.plotBandsGroup.attr({transform:r.makeTranslate(p)}),t=o.length;t<this.plotBands.length;t++)this.plotBands[t]&&this.plotBands[t].remove(),this.plotBands[t]=null;for(this.plotBands.length=o.length,t=0,e=o.length;e>t;t++){var T=o[t],b=s(T.from),A=s(T.to);i=Math.min(b,A),n=Math.max(b+c,A+c),i=Math.max(m?v:y,i),n=Math.min(m?_:x,n),a=m?{x:i,y:y,width:Math.max(n-i,0),height:x}:{x:v,y:i,width:_,height:Math.max(n-i,0)},this.plotBands[t]=this.plotBands[t]||d.rect(a).addTo(this.plotBandsGroup),f?(this.plotBands[t].style({fill:T.color}),d3.select(this.plotBands[t].rawElement).transition().duration(l).ease(h).attr("x",a.x).attr("y",a.y).attr("width",a.width).attr("height",a.height)):this.plotBands[t].attr(a).style({fill:T.color})}},_drawAxisLine:function(){var t=this.options,e=t.lineWidth,i=t.lineColor,n=this.getPlotBounds(),a=this._getAxisOriginPoint(),o="x1",s="y1",l="x2",h="y2",u=n.width,c=this.vanchart.renderer;this.isHorizontal()||(o="y1",s="x1",l="y2",h="x2",u=n.height);var d=r.lineSubPixelOpt(0,e);this.axisLine||(this.axisLine=c.line().addTo(this.axisLineGroup));var f={};if(f[o]=0,f[l]=u,f[s]=f[h]=d,f.transform=r.makeTranslate(a),this.axisLine.attr(f).style({stroke:i,"stroke-width":e}),this.showArrow()){this.arrowGroup||(this.arrowGroup=c.group().addTo(this.axisLineGroup));var p=this.arrowGroup.line||c.line().addTo(this.arrowGroup),g=this.arrowGroup.path||c.path().addTo(this.arrowGroup);this.arrowGroup.line=p,this.arrowGroup.path=g,this.isHorizontal()?(this.arrowGroup.attr("transform",r.makeTranslate([a.x+n.width,a.y])),p.attr({x1:0,y1:d,x2:6,y2:d}).style({stroke:i,"stroke-width":e}),g.attr({d:"M2,-4 L10,0 L2,4 L6,0 L2,-4"}).style({fill:i})):(this.arrowGroup.attr("transform",r.makeTranslate(a)),p.attr({x1:d,y1:0,x2:d,y2:-6}).style({stroke:i,"stroke-width":e}),g.attr({d:"M-4,-2 L0,-10 L4,-2 L0,-6 L-4,-2"}).style({fill:i}))}else this.arrowGroup&&this.arrowGroup.remove()},_drawGridLine:function(){var t=this.options,e=this.getPlotBounds(),i=this.animation,o=this.getTickData(),s=this.scale,u=this.lastScale||s,c=t.gridLineColor,d=t.gridLineWidth;0===d&&(c="");var f=r.lineSubPixelOpt(0,d),p=this.vanchart.renderer,g="x1",m="y1",v="x2",y="y2",_=e.height;this.isHorizontal()||(g="y1",m="x1",v="y2",y="x2",_=e.width),this.gridLinesGroup||(this.gridLinesGroup=p.group().addTo(this.axisLineGroup),this.gridLines=[]),this.gridLinesGroup.attr("transform",r.makeTranslate(e));for(var x=this.type==a.CATEGORY_AXIS_COMPONENT?[{tickPos:this.getPosition()==n.BOTTOM?e.width:e.height-1}]:[],T=this._bindData(this.gridLines,o.concat(x),function(t){return t.tickValue}),b=[],A=0,L=T.exit.length;L>A;A++)if(i){var C=T.exit[A].datum(),P=s(C.tickValue);d3.select(T.exit[A].rawElement).transition().duration(l).ease(h).style("opacity",0).attr(g,P).attr(v,P).remove()}else T.exit[A]&&T.exit[A].remove();for(var A=0,L=T.enter.length;L>A;A++){var C=T.enter[A],M=p.line().style({stroke:c,"stroke-width":d}).addTo(this.gridLinesGroup),E=u(C.tickValue)+f,P=C.tickPos+f;E=isNaN(E)?P:E,M.attr(g,E).attr(v,E).attr(m,0).attr(y,_),i?d3.select(M.rawElement).transition().duration(l).ease(h).attr(g,P).attr(v,P).attr(m,0).attr(y,_):M.attr(g,P).attr(v,P).attr(m,0).attr(y,_),M.datum(C),b.push(M)}b=b.concat(T.update);for(var A=0,L=b.length;L>A;A++){var M=b[A].style({stroke:c,"stroke-width":d}),C=M.datum(),P=C.tickPos+f;i?d3.select(M.rawElement).transition().duration(l).ease(h).attr(g,P).attr(m,0).attr(v,P).attr(y,_):M.attr(g,P).attr(v,P).attr(m,0).attr(y,_)}this.gridLines=b},_drawTickLine:function(){function t(t,e,n){var o,s,l=m._bindData(t,e),h=[];for(o=0,s=l.exit.length;s>o;o++)l.exit[o].remove();for(o=0,s=l.enter.length;s>o;o++)h.push(g.line().datum(l.enter[o]).addTo(m.tickLinesGroup));for(h=h.concat(l.update),o=0,s=h.length;s>o;o++){var u,c=h[o].datum(),d={};u=r.hasDefined(c.tickPos)?c.tickPos:m.type==a.CATEGORY_AXIS_COMPONENT?c:m.scale(c);var f=i.x,p=i.y;m.isHorizontal()||(f=i.y,p=i.x),d[_]=u+n.det+f,d[T]=d[_],d[x]=p,d[b]=(A*n.tickLength||0)+p,h[o].attr(d).style({stroke:n.tickColor,"stroke-width":n.tickWidth})}return h}var e=this.options,i=this._getAxisOriginPoint(),o=this.getPosition(),s=this.getTickData(),l=e.enableTick?e.tickLength||0:0,h=e.tickWidth||1,u=e.tickColor,c=this.getMinorTickData(),d=e.enableMinorTick?e.minorTickLength||0:0,f=e.minorTickColor,p=e.minorTickWidth||1,g=this.vanchart.renderer,m=this,_="x1",x="y1",T="x2",b="y2";this.isHorizontal()||(_="y1",x="x1",T="y2",b="x2");var A=o==n.TOP||o==n.LEFT?-1:1,L=r.lineSubPixelOpt(0,h),C=r.lineSubPixelOpt(0,p);this.tickLinesGroup||(this.tickLinesGroup=g.group().addTo(this.axisGroup),this.tickLines={},this.tickLines[v]=[],this.tickLines[y]=[]),this.tickLines[v]=t(this.tickLines[v],s,{det:L,tickWidth:h,tickLength:l,tickColor:u}),this.tickLines[y]=t(this.tickLines[y],c,{det:C,tickWidth:p,tickLength:d,tickColor:f})},_drawPlotLines:function(){function t(t){return{stroke:t.color,"stroke-width":t.width,"stroke-dasharray":t.dataArray}}function e(t){return f.text().textContent(t.text).style(t.style).attr({x:t.textX,y:t.textY,"text-anchor":"left",dy:.85*t.textDim.height})}function i(t,i){i._textG&&(i._textG.remove(),i._textG=null),t.text&&t.textDim&&(i._textG=e(t).addTo(i))}var o=this.options.plotLines||[],s=(this.getPosition(),this.vanchart.getPlotBounds()),l=this.scale,h=this.type==a.DATE_AXIS_COMPONENT,c=[],d=this,f=this.vanchart.renderer;o.forEach(function(t){if(!r.isEmpty(t.value)){var e,i,a,o,f=l(h?r.object2date(t.value):t.value)+(l.rangeBand?l.rangeBand()/2:0),p=r.lineSubPixelOpt(f,t.width);if(d.isHorizontal()){if(0>f||f>s.width)return;e=i=p,a=0,o=s.height}else{if(0>f||f>s.height)return;e=0,i=s.width,a=o=p}var g,m,v,y;if(t.label&&t.label.text&&t.label.style){y=t.label.style,v=t.label.text;var _=t.label.align,x=r.getTextDimension(v,y,t.label.useHtml);switch(_){case n.TOP:g=e-x.width,m=a;break;case n.BOTTOM:g=e-x.width,m=o-x.height;break;case n.LEFT:g=e,m=a-x.height-u();break;case n.RIGHT:g=i-x.width,m=o-x.height-u()}}c.push({color:t.color,line:{x1:e,y1:a,x2:i,y2:o},width:t.width,dataArray:n.DASH_TYPE[t.dashStyle],text:v,textDim:x,style:y,textX:g,textY:m})}}),this.plotLinesGroup||(this.plotLinesGroup=f.group().addTo(this.axisLineGroup),this.plotLines=[]),this.plotLinesGroup.attr("transform",r.makeTranslate(s));var p,g,m=this._bindData(this.plotLines,c);for(this.plotLines=[],p=0,g=m.exit.length;g>p;p++)m.exit[p].remove();for(p=0,g=m.enter.length;g>p;p++){var v=m.enter[p],y=f.group();this.plotLines.push(y),y._lineG=y.append(f.line(v.line).style(t(v))),i(v,y),y.addTo(this.plotLinesGroup)}for(p=0,g=m.update.length;g>p;p++){var y=m.update[p],v=y.datum();y._lineG.attr(v.line).style(t(v)),i(v,y),this.plotLines.push(y)}},_drawTickLabel:function(){this._drawSvgTickLabel()},_drawSvgTickLabel:function(){var t=this,e=this.vanchart,i=e.renderer,n=this.scale,r=this.lastScale||n,a=this.options,o=a.labelStyle,s=this.animation,u=a.useHtml,c=this.getTickData().filter(function(t){return""!==t.tickContent});this.tickLabelsGroup||(this.tickLabelsGroup=i.vgroup().add(),
    this.axisGroup.append(this.tickLabelsGroup.renderG),this.tickLabels=[]);var d,f,p=this._bindData(this.tickLabels,c,function(t){return t.tickValue}),g=[];for(d=0,f=p.exit.length;f>d;d++)if(s){var m=p.exit[d].datum(),v=n(m.tickValue);d3.select(p.exit[d].rawElement).transition().duration(l).ease(h).style("opacity",0).attr(t.isHorizontal()?"x":"y",v).remove()}else p.exit[d]&&p.exit[d].remove();for(d=0,f=p.enter.length;f>d;d++){var m=p.enter[d],y=this._getLabelAttr(r,m),_=this.tickLabelsGroup.append(i.vtext(u).textContent(m.tickContent).style({opacity:0})),x=m.labelRotation%360?_.vRotate(m.labelRotation,!0).rotateStr:"";y.transform+=x,_.attr(y),_.datum(m),g.push(_)}for(g=g.concat(p.update),d=0,f=g.length;f>d;d++){var _=g[d],m=_.datum();_.textContent(m.tickContent).style(o);var y=this._getLabelAttr(n,m),T=this._valueInDomain(m.tickValue)?1:0;if(s&&!u){var x=m.labelRotation%360?_.vRotate(m.labelRotation,!0).rotateStr:"";y.transform+=x,d3.select(_.node()).transition().duration(l).ease(h).attr(y).style({opacity:T})}else _.attr(y).style({opacity:T}),_.vRotate(m.labelRotation)}this.tickLabels=g},_getLabelAttr:function(t,e){var i,a,o=this._getAxisOriginPoint(),s=t.rangeBand?t.rangeBand()/2:0,l=t(e.tickValue)+s,h=this.options,u=this.isHorizontal(),c=h.enableTick?h.tickLength:0,d=h.tickPadding+c||0,f=e.labelRotation||0,p=(h.labelStyle,h.useHtml),g=this.getPosition(),m=g==n.TOP||g==n.LEFT?-1:1,v=e.tickRectDim,y=e.tickDim,_=0,x=0,T=0,b=.85*v.height,A=r.toRadian(f);360===f&&(T=p||r.isMS?0:.85*v.width/2,b=0,a="tb-rl"),u?(i=Math.abs(f%90)<15?0:f>0?1:-1,x+=m*(y.height-v.height)/2,_+=m*i*(y.width-Math.abs(v.height*Math.sin(A)))/2,g===n.TOP&&(x-=v.height),x+=m*d,_+=o.x+l-v.width/2,x+=o.y):(i=Math.abs(f%90)>85?0:f>0?1:-1,_+=m*(y.width-v.width)/2,x+=m*i*(y.height-v.height*Math.cos(A))/2,g===n.LEFT&&(_-=v.width),_+=m*d,_+=o.x,x+=o.y+l-v.height/2);var L=p?"px":"",C="translate("+_+L+" "+x+L+")",P={transform:C,dy:b,dx:T,writingMode:a,"writing-mode":a};return p&&a&&(P["-webkit-writing-mode"]="vertical-rl"),P},_drawAxisTitle:function(){var t=this.options,e=t.title;if(!e||!e.text)return this.titleGroup&&this.titleGroup.remove(),void(this.titleGroup=null);var i=this.vanchart.renderer,a=this.axisGroup,o=e.useHtml,s=this.titleRotation,l=this.getTitleAlign(),h=e.text,u=e.style,c=this.titleDim,d=this.titleRectDim,f=this.getAxisTitleBounds();this.titleGroup||(this.titleGroup=i.vgroup().add(),a.append(this.titleGroup.renderG)),this.titleGroup.attr({transform:r.makeTranslate(f)});var p=this.titleGroup;p.text||(p.text=p.append(i.vtext(o)));var g=0,m=0,v=0,y=.85*d.height;switch(l){case n.TOP:m=0;break;case n.BOTTOM:m=f.height-c.height;break;case n.LEFT:g=0;break;case n.RIGHT:g=f.width-c.width;break;case n.CENTER:default:this.isHorizontal()?g=(f.width-c.width)/2:m=(f.height-c.height)/2}360===this.titleRotation?(v=o||r.isMS?0:.85*d.width/2,y=0):(g+=(c.width-d.width)/2,m+=(c.height-d.height)/2),p.text.textContent(h).attr({x:g,y:m,dy:y,dx:v}).style(u),s%360&&p.text.vRotate(s)},remove:function(){this.axisGroup&&this.axisGroup.remove(),this.clipAxisGroup&&this.clipAxisGroup.remove(),this.axisGroup=this.clipAxisGroup=null,this.axisLineGroup&&this.axisLineGroup.remove(),this.axisLineGroup=null,this.tickLabelsGroup&&this.tickLabelsGroup.remove(),this.tickLabelsGroup=null}});return x}),i("component/CategoryAxis",["require","./Base","./BaseAxis","../utils/BaseUtils","../Constants","../ComponentLibrary"],function(t){var e,i=(t("./Base"),t("./BaseAxis")),n=t("../utils/BaseUtils"),r=t("../Constants"),a=t("../ComponentLibrary"),o=function(){return null==e&&(e=n.paddingConvertWithScale("0.1875rem")),e},s=i.extend({type:a.CATEGORY_AXIS_COMPONENT,initScale:function(){this.lastScale=this.scale,this.scale=d3.scale.ordinal()},calculateDomainFromData:function(){this._dataDomain=this._getDomainFromData();var t=this.vanchart.getComponent(a.ZOOM_COMPONENT);this._zoomDomain=this._zoomDomain||t&&t.getZoomDomain(this),this._domain=this._zoomDomain||this._dataDomain},calculateDomainFromZoom:function(){this._domain=this._zoomDomain},_getStartAndEndTick:function(){return[this._domain[0],this._domain[this._domain.length-1]]},_getDomainFromData:function(){var t=this.options,e=this.series,i=this,n={},a=t.categories||[];return a.forEach(function(t){n[t]=!0}),e.forEach(function(t){var e=t.type==r.BAR_CHART?"y":"x";this.getTrendLineForecast(t);for(var o=0,s=t.points.length;s>o;o++){var l=t.points[o][e];n[l]||(n[l]=!0,a.push(l))}t.type!==r.AREA_CHART&&(i.isRangePoints=!1)},this),this.addTrendLineCategories(a)},setCategories:function(t){var e=this._dataDomain;this._dataDomain=this.addTrendLineCategories(t);var i=this.vanchart.getComponent(a.ZOOM_COMPONENT);if(this._isBaseAxis()&&i&&i.zoomToolEnabled()){i.updateRangeLeftAndRight(this,e,t);var n=i&&i.getZoomDomain(this);this._zoomDomain=n,this.calculateDomainFromZoom()}else this._domain=this._dataDomain,this._zoomDomain=null;this.fixScaleAndTickData()},addTrendLineCategories:function(t){function e(t,e){return Array.apply(null,Array(t)).map(e)}if(this.forecast&&(this.forecast[0]||this.forecast[1])){var i=0;t=e(-this.forecast[0],function(){return Array(2+i++).join(" ")}).concat(t).concat(e(this.forecast[1],function(){return Array(2+i++).join(" ")}))}return t},getOriginalCategories:function(){return this.forecast&&(this.forecast[0]||this.forecast[1])?this._dataDomain.slice(-this.forecast[0],this._dataDomain.length-this.forecast[1]):this._dataDomain},updateAxisSizeAndBounds:function(){this._updateOriginTickData(),this._calculateSize(this.tickData),this._setComponentBounds(this.getPosition(),this._size)},_getTickValuesWithEndValue:function(){return this._getTickValues()},fixScaleAndTickData:function(){this.scale.domain(this._dataDomain),this.isRangePoints?this.scale.rangePoints(this._getRange()):this.scale.rangeBands(this._getRange()),this._updateOriginTickData(),this._calculateTickPosAndStep()},_getRange:function(){var t=this._getPlotRange();if(this._dataDomain.length==this._domain.length)return t;var e,i=Math.abs(t[1]-t[0]);e=this.isRangePoints?i/Math.max(this._domain.length-1,1):i/this._domain.length;var r=n.indexInArray(this._dataDomain,this._domain[0]),a=this._dataDomain.length-n.indexInArray(this._dataDomain,this._domain[this._domain.length-1])-1;if(!(this.isAxisReversed()^this.isHorizontal())){var o=r;r=a,a=o}var s=-r*e,l=i+a*e;return this.isHorizontal()?this.isAxisReversed()?[l,s]:[s,l]:this.isAxisReversed()?[s,l]:[l,s]},getLabelAutoRotation:function(t,e,i){if(e.autoRotate&&!e.labelRotation){var r,a,s=this.vanchart.isInverted(),l=t.reduce(function(t,e){return n.getTextDimension(t).width>n.getTextDimension(e).width?t:e}),h=this._getTickContent(l,i),u=n.getTextDimensionWithRotation(h,e.labelStyle,e.useHtml,e.labelRotation),c=Math.max.apply(null,this._getPlotRange())/this._domain.length-o();s?(r=u.height,a=u.width):(r=u.width,a=u.height);var d=Math.sqrt(r*r+a*a);if(a>c)return-90;if(r>c){var f=Math.acos(c/d),p=Math.atan(a/r),g=f+p;return-n.toDegree(g)}}},getCategoryCount:function(){return this._dataDomain.length},indexOfLabel:function(t){return n.indexInArray(this._dataDomain,t)},getTickLength:function(){var t=this.scale.domain(),e=this.scale.rangeExtent(),i=Math.abs(e[1]-e[0]);return this.isRangePoints&&t.length<=1?i:this.isRangePoints?i/(t.length-1):this.scale.rangeBand()},_getTickValues:function(){return this._domain},getCategories:function(){return this._dataDomain},axisZoom:function(t,e){var i,r,a=this.vanchart.getPlotBounds();this.isHorizontal()?(i=Math.min(t[0],e[0])-a.x,r=Math.max(t[0],e[0])-a.x):(i=Math.min(t[1],e[1])-a.y,r=Math.max(t[1],e[1])-a.y);var o=this.scale.domain(),s=this._getRange(),l=d3.scale.quantize().domain(s).range(o),h=n.indexInArray(this._dataDomain,l(i)),u=n.indexInArray(this._dataDomain,l(r));this.zoomRefresh(this._dataDomain.slice(Math.min(h,u),Math.max(h,u)+1))},getIndexByPosition:function(t){return this._getIndexByXYCoordinate(t)},_getIndexByXYCoordinate:function(t){var e,i=this.getPlotBounds(),n=this.scale,r=this.isHorizontal(),a=this.isAxisReversed()^!r,o=n(a?n.domain()[n.domain().length-1]:n.domain()[0]);e=r?t[0]-i.x-o:t[1]-i.y-o;var s,l=this.getCategories();if(l.length>1){var h=Math.abs(n(n.domain()[1])-n(n.domain()[0]));s=a?l.length-1-e/h:e/h}else s=0;return s=this.isRangePoints?Math.round(s):a?Math.ceil(s):Math.floor(s)},getPointsInCategory:function(t){var e=this.vanchart.getPlotBounds(),i=this.scale.domain(),n=this._getRange(),r=d3.scale.quantize().domain(n).range(i),a=r(this.isHorizontal()?t[0]-e.x:t[1]-e.y);return this.vanchart.getValidPointsPara(a)},drawHighlightBackground:function(t){var e=t[0].category,i="line";t.map(function(t){var e=t.series;(e.type===r.BAR_CHART||e.type===r.COLUMN_CHART)&&(i="band")});var a=this.getPlotBounds(),o=this.isHorizontal(),s=this.scale,l=s.rangeBand?s.rangeBand():0,h=s(e),u=h+l,c=this.vanchart.renderer,d="x",f="y",p="width",g="height",m=a.height,v="x1",y="x2",_="y1",x="y2";switch(o||(d="y",f="x",p="height",g="width",m=a.width,v="y1",y="y2",_="x1",x="x2"),i){case"band":this.highlightBand||(this.highlightBand=c.rect().style({fill:"rgb(98,179,240)","fill-opacity":.2}).addTo(this.clipAxisGroup)),this.highlightBand.attr("transform",n.makeTranslate(a)).attr(d,h).attr(f,0).attr(p,Math.abs(h-u)).attr(g,m),this.highlightLine&&this.highlightLine.remove(),this.highlightLine=null;break;case"line":default:l&&(h=(h+u)/2),this.highlightLine||(this.highlightLine=c.line().style({stroke:"rgb(140,140,140)","stroke-width":1}).addTo(this.clipAxisGroup)),this.highlightLine.attr("transform",n.makeTranslate(a)).attr(v,h).attr(_,0).attr(y,h).attr(x,m),this.highlightBand&&this.highlightBand.remove(),this.highlightBand=null}},removeHighlightBackground:function(){this.highlightBand&&this.highlightBand.remove(),this.highlightLine&&this.highlightLine.remove(),this.highlightBand=null,this.highlightLine=null}});return a.register(a.CATEGORY_AXIS_COMPONENT,s),s}),i("component/ValueAxis",["require","./Base","./BaseAxis","../utils/BaseUtils","../utils/QueryUtils","../Constants","../ComponentLibrary"],function(t){var e=(t("./Base"),t("./BaseAxis")),i=t("../utils/BaseUtils"),n=(t("../utils/QueryUtils"),t("../Constants"),t("../ComponentLibrary")),r=e.extend({type:n.VALUE_AXIS_COMPONENT,initScale:function(){this.lastScale=this.scale,this.scale=this.options.log?d3.scale.log().base(this.options.log):d3.scale.linear()},getAxisValue:function(t,e){return this.byPercent?e.percentage:+t},_valueInDomain:function(t){var e=this.scale.domain();return t>=Math.min(e[0],e[1])&&t<=Math.max(e[0],e[1])},_getDomainFromData:function(){for(var t=Number.MAX_VALUE,e=-t,i=!0,n=this.series,r={},a=!1,o=0,s=n.length;s>o&&!a;o++)a=n[o].visible;for(var o=0,s=n.length;s>o;o++)(n[o].visible||!a)&&(this._getSeriesValue(r,n[o]),this.getTrendLineForecast(n[o]));var l=0;for(var h in r){var u=r[h];l=u[1]-u[0]||0;for(var c=0,d=u.length;d>c;c++)isNaN(u[c])||this.options.log&&u[c]<=0||(t=Math.min(t,u[c]),e=Math.max(e,u[c]),i=!1)}return this._isBaseAxis()&&l&&this.forecast&&(t+=l*this.forecast[0],e+=l*this.forecast[1]),i&&(t=0,e=100),[t,e]},_getSeriesValue:function(t,e){var r=e.name||"",a=this.componentType==n.X_AXIS_COMPONENT?"x":"y";if(i.hasNotDefined(e.stack)||this._isBaseAxis())t[r]=t[r]||[],e.points.forEach(function(e){!e.isNull&&e.visible&&t[r].push(e[a])});else{var o=e.stack+e.type+"STACK_POSITIVE",s=e.stack+e.type+"STACK_NEGATIVE";t[o]=t[o]||[],t[s]=t[s]||[],e.points.forEach(function(e,i){if(!e.isNull&&e.visible){var n=+e[a];n>0?null!=t[o][i]&&void 0!=t[o][i]?t[o][i]+=n:t[o][i]=n:null!=t[s][i]&&void 0!=t[s][i]?t[s][i]+=n:t[s][i]=n}})}},getValueFromData:function(t){var e=this.componentType==n.X_AXIS_COMPONENT?0:1,r=this.componentType==n.X_AXIS_COMPONENT?"x":"y",a=i.isArray(t)?t[e]:t[r];return a=i.pick(a,t),a=+a,isNaN(a)?"-":a},getStartPos:function(){return this.scale(this.getStartPosValue())},getStartPosValue:function(){var t=this.options;return t.log&&1!==t.log?1:0},_getTickValues:function(){var t=[];if(this.options.log)for(var e,n=0;(e=this._tickStart*Math.pow(this.options.log,n))<=this._domain[1];)t.push(e),n+=this._step;else for(var r=this._tickStart;r<=this._domain[1];r=i.accAdd(r,this._step))t.push(r);return t}});return n.register(n.VALUE_AXIS_COMPONENT,r),r}),i("component/DateAxis",["require","./Base","./BaseAxis","../utils/BaseUtils","../Constants","../utils/Formatter","../ComponentLibrary"],function(t){var e=(t("./Base"),t("./BaseAxis")),i=t("../utils/BaseUtils"),n=(t("../Constants"),t("../utils/Formatter")),r=t("../ComponentLibrary"),a=1e3,o=60*a,s=60*o,l=24*s,h=31*l,u=12*h,c=e.extend({type:r.DATE_AXIS_COMPONENT,getAxisValue:function(t){return i.object2date(t)},fixScaleAndTickData:function(){var t=[i.int2date(this._domain[0]),i.int2date(this._domain[1])];this.scale.domain(t).rangeRound(this._getRange()),this._calculateDateFormat(),this._updateOriginTickData(),this._calculateTickPosAndStep()},_calculateDateFormat:function(){var t=this._step,e="Dyyyy";a>=t?e="Dss":o>=t?e="Dmm:ss":s>=t?e="Dhh:mm":l>=t?e="Ddd-hh":h>=t?e="DMM-dd":u>=t&&(e="Dyyyy-MM"),this.dateFormat=e},_getTickContent:function(t,e){function i(t){return window.FR&&window.FR.contentFormat(t,r)||t}var r=this.dateFormat;return e=e||i,n.format(t,e)},initScale:function(){this.lastScale=this.scale,this.scale=d3.time.scale()},_getStartAndEndTick:function(){return[i.int2date(this._domain[0]),i.int2date(this._domain[1])]},_getTickValues:function(){for(var t=[],e=this._tickStart;e<=this._domain[1];e=i.accAdd(e,this._step))t.push(i.int2date(e));return t},_valueInDomain:function(t){var e=this.scale.domain();return t>=Math.min(e[0],e[1])&&t<=Math.max(e[0],e[1])},_getDomainFromData:function(){for(var t=Math.ceil(Number.MAX_VALUE),e=-t,n=this.series,r=!1,a=0,o=0,s=n.length;s>o;o++){var l=n[o],h=l[this.componentType];if(h==this&&l.visible){this.getTrendLineForecast(n[o]);var u=l.points;u.length>1&&(a=this.getValueFromData(u[1])-this.getValueFromData(u[0])||0);for(var o=0,s=u.length;s>o;o++){var c=this.getValueFromData(u[o]);c.getTime&&(r=!0,c=i.date2int(c),t=Math.min(t,c),e=Math.max(e,c))}}}return this._isBaseAxis()&&a&&this.forecast&&(t+=a*this.forecast[0],e+=a*this.forecast[1]),r||(t=e=(new Date).getTime()),e=t>=e?t+1e3:e,[t,e]},getValueFromData:function(t){var e=this.componentType==r.X_AXIS_COMPONENT?0:1,n=this.componentType==r.X_AXIS_COMPONENT?"x":"y",a=i.isArray(t)?t[e]:t[n];return i.object2date(a)}});return r.register(r.DATE_AXIS_COMPONENT,c),c}),i("component/Axis",["require","./Base","../utils/BaseUtils","../Constants","../ComponentLibrary","./CategoryAxis","./ValueAxis","./DateAxis"],function(t){var e=t("./Base"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("../ComponentLibrary"),a=t("./CategoryAxis"),o=t("./ValueAxis"),s=t("./DateAxis"),l=e.extend({_refresh:function(){this._axisList=this._axisList||[];var t=this.options;t=i.isArray(t)?t:[t];for(var e=t.length,n=e;n<this._axisList.length;n++)this._axisList[n].remove(),this._axisList[n]=null;this._axisList.length=e;for(var n=e-1;n>=0;n--)if(t[n].axisIndex=n,this._axisList[n]&&this._axisList[n].type!=t[n].type&&(this._axisList[n].remove(),this._axisList[n]=null),this._axisList[n])this._axisList[n].refresh(t[n]);else{var l,h=t[n].type||r.VALUE_AXIS_COMPONENT;h==r.VALUE_AXIS_COMPONENT?l=o:h==r.CATEGORY_AXIS_COMPONENT?l=a:h==r.DATE_AXIS_COMPONENT&&(l=s),this._axisList[n]=new l(t[n],this.componentType,this.vanchart)}},doLayout:function(){for(var t=this._axisList.length,e=t-1;e>=0;e--)this._axisList[e].calculateDomainFromData(),this._axisList[e]._calculateSize(),this._axisList[e]._recordAxisSize()},reCalculateSize:function(){for(var t=this._axisList.length,e=t-1;e>=0;e--)this._axisList[e]._calculateSize(),this._axisList[e]._recordAxisSize()},updateAxisClip:function(){for(var t={},e=this._axisList.length,i=e-1;i>=0;i--)this._axisList[i].updateClipBounds(t);this._recordForPlotBounds(n.LEFT,t[n.LEFT]||0),this._recordForPlotBounds(n.RIGHT,t[n.RIGHT]||0),this._recordForPlotBounds(n.TOP,t[n.TOP]||0),this._recordForPlotBounds(n.BOTTOM,t[n.BOTTOM]||0)},updateAxisSizeAndBounds:function(){for(var t=this._axisList.length,e=t-1;e>=0;e--)this._axisList[e].updateAxisSizeAndBounds()},adjustDomain4Radius:function(){for(var t=!1,e=this._axisList.length,i=e-1;i>=0;i--)t=this._axisList[i].adjustDomain4Radius()||t;return t},fixBoundsByPlot:function(){for(var t=this.vanchart.getPlotBounds(),e={},r=0,a=this._axisList.length;a>r;r++){var o=this._axisList[r],s=o.getPosition();o.isOnZero()?(h?o.bounds.width=t.width:o.bounds.height=t.height,o.fixScaleAndTickData()):(e[s]=e[s]||[],e[s].push(o))}for(var s in e)for(var l=e[s],h=s==n.TOP||s==n.BOTTOM,r=0,u=l.length;u>r;r++){var o=l[r],c=o.bounds,d=l[r-1]&&l[r-1].bounds||t;if(h){var f=s==n.TOP?d.y-c.height:d.y+d.height;o.bounds=i.makeBounds(d.x,f,d.width,c.height)}else{var p=s==n.LEFT?d.x-c.width:d.x+d.width;o.bounds=i.makeBounds(p,d.y,c.width,d.height)}o.fixScaleAndTickData()}},getAxis:function(t){return t>=this._axisList.length&&(t=0),this._axisList[t]},getAxisCount:function(){return this._axisList.length},axisZoom:function(t,e){this._axisList.forEach(function(i){i.axisZoom(t,e)})},dealOnZero:function(){this._axisList.forEach(function(t){t.dealOnZero()})},render:function(){for(var t=0,e=this._axisList.length;e>t;t++)this._axisList[t].render()},renderSpecial:function(){for(var t=0,e=this._axisList.length;e>t;t++)this._axisList[t].renderSpecial&&this._axisList[t].renderSpecial()}});return r.register(r.X_AXIS_COMPONENT,l),r.register(r.Y_AXIS_COMPONENT,l),l}),i("component/GaugeAxis",["require","../Constants","./Axis","../ComponentLibrary"],function(t){var e=(t("../Constants"),t("./Axis")),i=t("../ComponentLibrary"),n=e.extend({initAttributesWithSeries:function(){for(var t=this._axisList.length,e=t-1;e>=0;e--){var i=this._axisList[e];i.calculateDomainFromData(),i.scale.domain(i._domain),i._updateOriginTickData(),i.options.showLabel||i.tickData.forEach(function(t){t.tickContent=""})}},doLayout:function(){},render:function(){},renderSpecial:function(){}});return i.register(i.GAUGE_AXIS_COMPONENT,n),n}),i("component/LegendItem",["require","../dom/Evented","../Constants","../utils/BaseUtils","./LegendIconFactory","../ComponentLibrary"],function(t){var e,i=t("../dom/Evented"),n=t("../Constants"),r=t("../utils/BaseUtils"),a=t("./LegendIconFactory"),o=t("../ComponentLibrary"),s=function(){return null==e&&(e=r.paddingConvertWithScale("0.5rem")),e},l=i.extend({initialize:function(t,e){this.legendX=0,this.legendY=0,this.legend=t,this.refresh(e)},refresh:function(t){this.options=t,t.renderItem=this},render:function(){var t=this.legend,e=t.vanchart,i=e.renderer,o=t.options.style;this.graphic||(this.graphic=t.legendItemsGroup.append(i.group()),this.options.isTrendLine||this.graphic.style({cursor:"pointer"})),i.registerInteractiveTarget(this,this.graphic);var l=this.graphic,h=this.options,u=h.visible?h.color:h.hiddenColor,c=a.getLegendIconSize(h.legendIconType),d=r.getTextDimension(h.itemName,o,t.options.useHtml),f=Math.max(c.height,d.height);this.graphic.attr({transform:r.makeTranslate([this.legendX,Math.round(this.legendY+f/2)])}),a.hasIcon(h.legendIconType)?(l.image&&l.image.remove(),l.image=null,l.path=l.path||i.path().addTo(l),l.path.attr("d",a.getLegendIconPath(h.legendIconType)).attr("transform",r.makeTranslate([0,-c.height/2])).style({fill:u,"fill-opacity":h.opacity}),h.series.type==n.BUBBLE_CHART&&l.path.style("stroke",u).style("stroke-width",1)):(l.path&&l.path.remove(),l.path=null,l.image=l.image||i.image().addTo(l),l.image.attr({x:0,y:-c.height/2,width:12,height:12,preserveAspectRatio:"none"}).imageContent(h.legendIconType));var p=r.isSupportSVG()?{dy:"0.32em"}:{};l.text=l.text||l.append(i.vtext()),l.text.textContent(h.itemName||"").style("margin-top","-0.7em").attr(p).attr("x",c.width+s()).style({cursor:this.options.isTrendLine?"default":"pointer","white-space":"nowrap"}).style(r.extend(o,{fill:h.visible?o.color:h.hiddenColor}))},getEvents:function(){return this.options.isTrendLine?{}:{mouseover:this.onMouseOver,mouseout:this.onMouseOut,tap:this.onTap}},onMouseOver:function(){this.graphic&&this.graphic.text&&this.graphic.text.style({fill:this.options.hoverColor}),this.legend.options.highlight&&(this.legend.highlighted=!0,this.legend.vanchart.makeLegendHighlight(this.options.itemName))},onMouseOut:function(t){var e=this,i=e.legend,n=e.options,r=n.visible?i.options.style.color:n.hiddenColor;this.graphic&&this.graphic.text&&this.graphic.text.style({fill:r})},onTap:function(){for(var t=this.options.bindName,e=this.legend.vanchart,i=e.series,a={},s=0,l=i.length;l>s;s++){var h=i[s];if(h.isSeriesAccumulated()){var u="name";h.points.map(function(e){e[u]==t&&(e.visible=!e.visible)})}else h.name===t&&(h.visible=!h.visible,h.state=h.visible?n.STATE_TO_SHOW:n.STATE_TO_DROP,h._getAxisTypes().forEach(function(t){var e=h[t];!e||e._isBaseAxis()||a[r.stamp(e)]||(a[r.stamp(e)]=!0,e.calculateDomainFromData(),e.componentType===o.X_AXIS_COMPONENT||e.componentType===o.Y_AXIS_COMPONENT?e.adjustDomain4Radius():e.fixScaleAndTickData())}))}this.options.visible=!this.options.visible,this.options.pairLegendOpt&&(this.options.pairLegendOpt.visible=this.options.visible,this.options.pairLegendOpt.renderItem.render(),this.options.pairLegendOpt.renderItem.onMouseOut()),e.reRenderWholePlot()},remove:function(){this.graphic&&this.graphic.remove(),this.graphic=null}});return l}),i("component/Legend",["require","./Base","../utils/BaseUtils","../Constants","./LegendIconFactory","./LegendItem","../dom/Evented","../utils/BezierEasing","../ComponentLibrary"],function(t){var e,i,n,r,a=t("./Base"),o=t("../utils/BaseUtils"),s=t("../Constants"),l=t("./LegendIconFactory"),h=t("./LegendItem"),u=t("../dom/Evented"),c=t("../utils/BezierEasing"),d=t("../ComponentLibrary"),f=function(){return null==e&&(e=o.paddingConvertWithScale("0.312rem")),e},p=function(){return null==i&&(i=o.paddingConvertWithScale("0.5rem")),i},g=12,m=function(){return null==n&&(n=o.paddingConvertWithScale("0.25rem")),n},v=function(){return null==r&&(r=o.paddingConvertWithScale("1rem")),r},y="rgb(67,67,72)",_="rgb(204,204,204)",x=a.extend({doLayout:function(){return this.invisible()?void this.remove():(this.items=this.items||[],this.yPanEnabled=!1,this.xPanEnabled=!1,this.hasPages=!1,this._updateLegendItems(),void this._layoutLegendItemBounds())},_updateLegendItems:function(){var t,e,i=this.vanchart.series,n={},r={},a=this,o=this.vanchart,l=[];for(t=0,e=i.length;e>t;t++){var u=i[t],c=u.type;if(c!=s.GAUGE_CHART)if(u.isSeriesAccumulated()){var d="name";u.points.map(function(t){if(!n[t[d]]){var e={color:o.getDefaultSeriesColor(t[d]),opacity:t.opacity,bindName:t[d],itemName:t[d],visible:t.visible};a._mergeCommonLegendAttr(u,e),n[t[d]]=!0,l.push(e)}})}else{if(!n[u.name]){var f={color:u.color,opacity:u.opacity,bindName:u.name,itemName:u.name,visible:u.visible};a._mergeCommonLegendAttr(u,f),n[u.name]=f,l.push(f)}if(u.trendLine&&!r[u.name]){var f={isTrendLine:!0,color:u.trendLine.color,opacity:u.opacity,bindName:u.name,itemName:u.trendLine.name,visible:u.visible};a._mergeCommonLegendAttr(u,f),f.legendIconType=void 0,n[u.name].pairLegendOpt=f,f.pairLegendOpt=n[u.name],r[u.name]=f,l.push(f)}}}for(t=l.length,e=this.items.length;e>t;t++)this.items[t].remove(),this.items[t]=null;for(t=0,e=l.length;e>t;t++)this.items[t]?this.items[t].refresh(l[t]):this.items[t]=new h(a,l[t]);this.items.length=l.length},_mergeCommonLegendAttr:function(t,e){var i=this.options,n=i.hiddenColor,r=i.hoverColor||i.style.color;o.extend(e,{series:t,hiddenColor:n,hoverColor:r,legendIconType:this._getLegendType(t),lineIndex:0})},_layoutLegendItemBounds:function(){var t=this.options,e=t.position||s.RIGHT;if(this.items.length)if(e==s.TOP||e==s.BOTTOM){var i=this._layoutHorizontalLegendItemBounds(),n=i.height+2*f(),r=this._maxHeight();this.yPanEnabled=t.maxHeight&&n>r,this.maxYPan=-i.height+20,r=this.yPanEnabled?r:n,this._setComponentBounds(e,r);var a=this.bounds.x+f(),o=this.bounds.y+f(),l=this.bounds.height-2*f()+2*(this.options.borderWidth||0),h=this.bounds.width-2*f(),u=i.width-2*f();a+=(h-u)/2,this.yPanEnabled&&(o=this.bounds.y,l=this.bounds.height),this.bounds={x:a,y:o,width:u,height:l}}else{var c=0;if((e==s.RIGHT||e==s.RIGHT_TOP)&&!this.isFloat){var p=this.vanchart.getComponent(d.TOOLBAR_COMPONENT);p&&(c=37);var v=this.vanchart.getComponent(d.TITLE_COMPONENT);v&&v.bounds&&!v.isFloat&&(c-=v.bounds.height)}var i=this._layoutVerticalLegendItemBounds(),n=i.width+(this.isFloat?0:2*f()),y=this._maxWidth(),l=this.vanchart.getPlotBounds().height-(this.isFloat?0:2*f())-c;if(this.hasPages=i.height-m()>l,this.hasPages){l-=g+f(),this.pageIndex=this.pageIndex||0,this.translateMap=[0];for(var _=0,x=0,T=this.items.length;T>x;x++){var b=this.items[x].legendY;b-_>l&&(_=b-m(),this.translateMap.push(-b))}this.pageCount=this.translateMap.length,n=Math.max(n,this._getPageButtonWidth(this.pageCount))}this.yPanEnabled=this.hasPages,this.xPanEnabled=t.maxWidth&&n>y,this.maxYPan=-i.height+20,this.maxXPan=y-n,n=this.xPanEnabled?y:n,this._setComponentBounds(e,n);var a=this.bounds.x+(this.isFloat?0:f()),o=this.bounds.y+(this.isFloat?0:f()),h=this.bounds.width-(this.isFloat?0:2*f()),l=this.bounds.height-(this.isFloat?0:2*f())-c,A=Math.min(i.height,l);o=Math.max(c,o),this.isFloat||e==s.RIGHT_TOP||(o+=Math.round((l-A)/2)),this.bounds={x:a,y:o,width:h,height:A}}},_getPageButtonWidth:function(t){var e={fontFamily:this.options.style.fontFamily||"Verdana",fontSize:"14px"},i=t+"/"+t,n=(f(),o.getTextDimension(i,e,!1));return 2*g+n.width},_layoutVerticalLegendItemBounds:function(){for(var t=0,e=f(),i=this.options.borderWidth||0,n=0,r=this.items.length;r>n;n++){var a=this.items[n],s=a.options,h=o.getTextDimension(s.itemName,this.options.style,this.options.useHtml),u=l.getLegendIconSize(this.items[n].legendIconType);t=Math.max(h.width+p()+u.width,t),a.legendX=f()+i/2,a.legendY=e,e+=Math.max(h.height,u.height)+m()}return{width:2*f()+t,height:e+f()}},_layoutHorizontalLegendItemBounds:function(){for(var t=this.vanchart.getPlotBounds(),e=t.width-4*f(),i=f(),n=f(),r=i,a=[],s=[],h=0,u=0,c=this.items.length;c>u;u++){var d=this.items[u],g=d.options,m=l.getLegendIconSize(g.legendIconType),y=o.getTextDimension(g.itemName,this.options.style,this.options.useHtml),_=Math.min(m.width+p()+y.width,e-1);e>i+_?(d.legendX=i,d.legendY=n):(a.push({items:s,usedWidth:i}),h=0,i=f(),n+=Math.max(y.height,m.height),d.legendX=i,d.legendY=n,s=[]),s.push(d),h=Math.max(h,y.height),i+=_+v(),r=Math.max(i,r)}return a.push({items:s,usedWidth:i}),a.forEach(function(t){var e=t.usedWidth,i=t.items,n=Math.max((r-e)/2,0);i.forEach(function(t){t.legendX+=n})}),n+=h,{width:Math.round(r)+f(),height:Math.round(n)+f()}},render:function(){if(!this.invisible()&&this.items.length){var t=this.bounds,e=this,i=e.vanchart,n=i.renderer;this.legendGroup||(this.legendGroup=n.group().add(),this.backgroundGroup=n.group().addTo(this.legendGroup),this.clipGroup=n.group().addTo(this.legendGroup),this.legendItemsGroup=n.group().addTo(this.clipGroup),this.vanchart._leaflet&&this.legendGroup.style("pointer-events","all"),n.registerInteractiveTarget(this,this.legendGroup)),this.legendGroup.attr("transform",o.makeTranslate(t)),i._renderRectangleBackground(this.backgroundGroup,this.options,o.makeBounds(0,0,t.width,t.height));for(var r=0,a=this.items.length;a>r;r++)this.items[r].render();var s={x:0,y:0,width:t.width,height:t.height};this.hasPages?(s.height-=g,this.pageButton=this.pageButton||new T(e),this.pageButton.refresh()):this.pageButton&&(this.pageButton.remove(),this.pageButton=null),this.verticalClip?n.updateClip(this.verticalClip,s):(this.verticalClip=n.createClip(s),n.clip(this.clipGroup,this.verticalClip))}},getEvents:function(){return{mouseout:this.mouseOut,panstart:this.onPanStart,panmove:this.onPanMove,panend:this.onPanEnd}},mouseOut:function(){this.highlighted&&(this.highlighted=!1,this.vanchart.cancelLegendHighlight())},onPanStart:function(t){this.initPos=t.containerPoint;var e;if(o.isSupportSVG())e=d3.transform(d3.select(this.legendItemsGroup.node()).attr("transform")).translate;else{var i=this.legendItemsGroup.node().style;e=[parseFloat(i.left),parseFloat(i.top)]}this.initTranslateX=e[0],this.initTranslateY=e[1]},onPanMove:function(t){var e=0,i=0;if(this.xPanEnabled&&(e=t.containerPoint[0]-this.initPos[0]+this.initTranslateX,e=Math.max(this.maxXPan,Math.min(0,e))),this.yPanEnabled&&(i=t.containerPoint[1]-this.initPos[1]+this.initTranslateY,i=Math.max(this.maxYPan,Math.min(0,i))),this.hasPages&&this.pageButton){for(var n=this.translateMap.length-1,r=0,a=this.translateMap.length-1;a>r;r++){var s=this.translateMap[r],l=this.translateMap[r+1];s>=i&&i>l&&(n=r)}this.pageIndex!=n&&(this.pageIndex=n,this.pageButton.updatePage())}this.legendItemsGroup.attr("transform",o.makeTranslate([e,i]))},onPanEnd:function(){this.vanchart.handler.panTarget=null},remove:function(){this.legendGroup&&this.legendGroup.remove(),this.legendGroup=null,this.items&&(this.items.length=0)}}),T=u.extend({initialize:function(t){this.legend=t},refresh:function(){var t=this.legend,e=t.vanchart.renderer,i=t.bounds,n=t._getPageButtonWidth(t.pageCount),r=i.height,a=r-g,s=(i.width-n)/2;this.pageGroup||(this.pageGroup=e.group().addTo(t.legendGroup),e.registerInteractiveTarget(this,this.pageGroup),this.leftButton=e.path().style({cursor:"pointer"}).addTo(this.pageGroup),this.rightButton=e.path().style({cursor:"pointer"}).addTo(this.pageGroup),this.pageText=e.text().style({fontFamily:t.options.style.fontFamily||"Verdana",fontSize:"14px"}).addTo(this.pageGroup));var l=n-g,h=s+(n-l)/2,u=s+(n+l)/2,c=s+n/2;this.pageGroup.attr("transform",o.makeTranslate([0,a])),this.leftButton.attr("d",this._prePageButtonPath(h)),this.rightButton.attr("d",this._nextPageButtonPath(u)),this.pageText.attr({x:c,y:"-.14em",dy:".85em"}).attr("text-anchor","middle"),this.updatePage()},remove:function(){this.pageGroup&&(this.pageGroup.remove(),this.pageGroup=null)},updatePage:function(){var t=this.legend,e=t.pageIndex,i=t.pageCount;this.leftButton.style({fill:0>=e?_:y}),this.rightButton.style({fill:i-1>e?y:_});var n=e+1+"/"+i;this.pageText.textContent(n),this.pageText.vMiddle()},_prePageButtonPath:function(t){var e=12,i=0,n=t-e/2,r=e/2*Math.sqrt(3),a=t+e/2,o=r;return"M"+t+","+i+"L"+n+","+r+"L"+a+","+o+"Z"},_nextPageButtonPath:function(t){var e=12,i=0,n=t-e/2,r=i,a=t+e/2,o=i,s=t,l=e/2*Math.sqrt(3);return"M"+n+","+r+"L"+a+","+o+"L"+s+","+l+"Z"},onTap:function(t){var e=t.srcEvent,i=e.target||e.srcElement,n=this.legend;if(this.leftButton.node()==i){if(n.pageIndex<=0)return;n.pageIndex--}else if(this.rightButton.node()==i){if(n.pageIndex==n.pageCount-1)return;n.pageIndex++}var r=n.pageIndex,a=n.translateMap[r];this.legend.vanchart.isSupportAnimation()?d3.select(n.legendItemsGroup.rawElement).transition().duration(500).ease(c.css.swing).attr("transform","translate(0,"+a+")"):n.legendItemsGroup.attr("transform","translate(0,"+a+")"),this.updatePage()},getEvents:function(){return{tap:this.onTap}}});return d.register(d.LEGEND_COMPONENT,x),x}),i("component/Zoom",["require","./Base","../utils/BaseUtils","../Constants","../ComponentLibrary","../ComponentLibrary"],function(t){var e,i=t("./Base"),n=t("../utils/BaseUtils"),r=t("../Constants"),a=t("../ComponentLibrary"),o=30,s=10,l="none",h="left-to-right",u="right-to-left",c=function(){return null==e&&(e=n.paddingConvertWithScale("0.3125rem")),e},d=i.extend({_refresh:function(){this.rangeLeftTop=this.rangeRightBottom=null},doLayout:function(){if(this.byAxisType=this.vanchart.chartType()==r.BAR_CHART?"yAxis":"xAxis",this.byAxis=this.vanchart[this.byAxisType](),this.zoomToolEnabled()){var t=this.vanchart.getComponent(a.DATA_SHEET_COMPONENT),e=0,i=this.byAxis.getPosition();(t||i==r.TOP||i==r.RIGHT||this.byAxis.isOnZero())&&(e=c()),this._setComponentBounds(this.byAxis.isHorizontal()?r.BOTTOM:r.LEFT,o+e)}},fixBoundsByPlot:function(){if(this.zoomToolEnabled()){for(var t,e=this.vanchart.components[this.byAxisType],i=e.getAxisCount(),o=0;i>o;o++){var s=e.getAxis(o),l=s.getPosition();(l==r.BOTTOM||l==r.LEFT)&&(t=s)}t=t||this.byAxis,l=t.getPosition();var h=this.vanchart.getPlotBounds();if(t.isHorizontal()){var u,d=this.vanchart.getComponent(a.DATA_SHEET_COMPONENT);
    u=d?d.bounds.y+d.bounds.height+c():t.isOnZero()||l==r.TOP?h.y+h.height+c():t.bounds.y+t.bounds.height,this.bounds=n.makeBounds(h.x,u,h.width,this.bounds.height)}else{var f;f=t.isOnZero()||l==r.RIGHT?h.x-this.bounds.width:t.bounds.x-this.bounds.width,this.bounds=n.makeBounds(f,h.y,this.bounds.width,h.height)}}},getZoomInitDomain:function(t){var e=this.byAxis;if(this.zoomToolEnabled()&&e._isBaseAxis()&&t==e){var i=this.options.zoomTool;return i.from=n.hasDefined(i.from)&&""!==i.from?i.from:null,i.to=n.hasDefined(i.to)&&""!==i.to?i.to:null,[i.from,i.to]}},getZoomDomain:function(t){var e=this.byAxis,i=t.isCategory()?e._dataDomain:e._domain;if(this.zoomToolEnabled()&&e._isBaseAxis()&&t==e){var r=this.options.zoomTool;r.from=n.hasDefined(r.from)&&""!==r.from?r.from:null,r.to=n.hasDefined(r.to)&&""!==r.to?r.to:null;var a=n.pick(this.rangeLeftTop,r.from,i[0]),o=n.pick(this.rangeRightBottom,r.to,i[i.length-1]);return this._getValidDomain(a,o,i,e.isCategory())}},getMinAndMaxPos:function(){var t=this.getZoomDomain(this.byAxis),e=this.axisScale,i=e(t[0]),n=e(t[t.length-1]);return[Math.min(i,n),Math.max(i,n)+(e.rangeBand?e.rangeBand():0)]},updateRangeLeftAndRight:function(t,e,i){var r=n.indexInArray(e,this.rangeLeftTop),a=n.indexInArray(e,this.rangeRightBottom),o=i.slice(Math.min(r,a),Math.max(r,a)+1);t.isAxisReversed()^t.isHorizontal()?(this.rangeLeftTop=o[0],this.rangeRightBottom=o[o.length-1]):(this.rangeLeftTop=o[o.length-1],this.rangeRightBottom=o[0])},_getValidDomain:function(t,e,i,r){var a;if(r){var o=i.length-1,s=0;return t=n.indexInArray(i,t),e=n.indexInArray(i,e),t=Math.min(Math.max(t,s),o),e=Math.min(Math.max(e,s),o),t>e&&(a=e,e=t,t=a),i.slice(t,e+1)}return t=parseFloat(t),e=parseFloat(e),t>e&&(a=e,e=t,t=a),[t,e]},zoomToolEnabled:function(){var t=this.options;return this.vanchart.series.length&&t&&t.zoomTool&&t.zoomTool.enabled&&n.isSupportSVG()},_getAxisScale:function(){var t=this.byAxis,e=t.scale.copy();if(t.type==a.CATEGORY_AXIS_COMPONENT)e.rangeBand?e.rangeBands(t._getPlotRange()):e.range(t._getPlotRange());else{var i=t._dataDomain,r=this.getZoomDomain(t),o=Math.min(i[0],r[0]),s=Math.max(i[1],r[1]);t.type==a.DATE_AXIS_COMPONENT&&(o=n.int2date(o),s=n.int2date(s)),e.domain([o,s])}return e},render:function(){if(this.remove(),!this.zoomBarGroup&&this.zoomToolEnabled()){this.axisScale=this._getAxisScale();var t=this,e=t.bounds,i=t.vanchart,r=i.renderer,a=this.getMinAndMaxPos(),o=this.byAxis.isVertical(),s=a[0],l=a[1];this.zoomBarGroup||(this.zoomBarGroup=r.group().attr("transform",n.makeTranslate(e)).style("cursor",o?"ns-resize ":"ew-resize").add(),r.registerInteractiveTarget(this,this.zoomBarGroup)),this._createLines(),this.leftTopRect=this._createSideRect(o,s,!0),this.rightBottomRect=this._createSideRect(o,l,!1),this.centerRect=this._createCenterRect(o,s,l),this.leftTopButton=this._createButton(o,s,!0),this.rightBottomButton=this._createButton(o,l,!1);var h=this.leftTopButton.pos,u=this.rightBottomButton.pos;this.rangeLeftTop=this._getValueByPosition(h),this.rangeRightBottom=this._getValueByPosition(u)}},_createLines:function(){var t=this.axisScale,e=this.byAxisType,i=this.vanchart,n=i.renderer,r=(i.series,t.rangeBand?t.rangeBand()/2:0),a=i.cateMap,s=[],l=Number.MAX_VALUE,h=-Number.MAX_VALUE,u=this.byAxis.isHorizontal();for(var c in a){var d=a[c];if(d[0].series[e]){var f=0;d.forEach(function(t){f+=t.getTargetValue()})}d[0].isNull||s.push({x:t(c)+r,y:f}),l=Math.min(l,f),h=Math.max(h,f)}var p=u?[o,0]:[0,o],g=d3.scale.linear().domain([l,h]).range(p),m=d3.svg.line().interpolate("linear").x(function(t){return u?t.x:g(t.y)}).y(function(t){return u?g(t.y):t.x});s.sort(function(t,e){return t.x-e.x}),this._line=this._line||n.path().style({fill:"none",stroke:"black","stroke-width":1}),this._line.attr("d",m(s)).addTo(this.zoomBarGroup)},_createSideRect:function(t,e,i){var n=this.vanchart.renderer,r="x",a="y",s="width",l="height",h=this.bounds.width;t&&(r="y",a="x",s="height",l="width",h=this.bounds.height);var u,c;return i?(u=0,c=e):(u=e,c=Math.abs(h-u)),n.rect().attr(r,u).attr(a,0).attr(s,c).attr(l,o).style({fill:"rgba(220,221,221,0.4)"}).addTo(this.zoomBarGroup)},_createCenterRect:function(t,e,i){var n=this.vanchart.renderer,r="x",a="y",l="width",h="height";return t&&(r="y",a="x",l="height",h="width"),n.rect().attr(r,e+s).attr(a,0).attr(l,i-e-2*s).attr(h,o).style({fill:"rgba(255,255,255,0)",stroke:"#29ABE2","stroke-width":1}).addTo(this.zoomBarGroup)},_createButton:function(t,e,i){e=i?e:e-s;var n,r=this.vanchart.renderer,a=r.group().attr("transform",this._getButtonTranslate(t,e)),o={fill:"#FFFFFF",stroke:"#7ADAF4","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10};n=i?t?"M30,4v6H0L0,4C0,1.791,1.791,0,4,0h22C28.209,0,30,1.791,30,4z":"M4,30h6V0L4,0C1.791,0,0,1.791,0,4v22C0,28.209,1.791,30,4,30z":t?"M30,6V0H0v6c0,2.209,1.791,4,4,4h22C28.209,10,30,8.209,30,6z":"M6,30H0V0h6c2.209,0,4,1.791,4,4v22C10,28.209,8.209,30,6,30z",r.path().attr("d",n).style({fill:"#29ABE2"}).addTo(a);var l="x1",h="y1",u="x2",c="y2";return t&&(l="y1",h="x1",u="y2",c="x2"),r.line().attr(l,3).attr(h,11).attr(u,3).attr(c,18).style(o).addTo(a),r.line().attr(l,7).attr(h,11).attr(u,7).attr(c,18).style(o).addTo(a),a.pos=e,a.addTo(this.zoomBarGroup),a},_findDraggingTarget:function(t){for(var e,i=t.srcEvent,n=i.target||i.srcElement,r=this.byAxis.isHorizontal()?t.containerPoint[0]-this.bounds.x:t.containerPoint[1]-this.bounds.y,a=this._resizeable();n;){var o=this.leftTopButton.pos-r,l=r-(this.rightBottomButton.pos+s);if(o>0&&10>o&&a&&(e=this.leftTopButton),l>0&&10>l&&a&&(e=this.rightBottomButton),e)break;if(n==this.leftTopButton.node()&&a?e=this.leftTopButton:n==this.rightBottomButton.node()&&a?e=this.rightBottomButton:(n==this.centerRect.node()||n==this.zoomBarGroup.node())&&(e=this.centerRect),e)break;n=n.parentNode}return e},_panStart:function(t,e){this.target=e||this._findDraggingTarget(t),this.target&&(this.downPos=this.byAxis.isHorizontal()?t.containerPoint[0]:t.containerPoint[1],this.initPos=this.target.pos,this.initTranslate=0)},_panContainerMove:function(t){if(this.target){var e=this.byAxis.isHorizontal()?t.containerPoint[0]:t.containerPoint[1],i=e<this.downPos?h:u;this._centerRectMove(this.downPos,this.downPos+this.downPos-e),this._zoomRefresh(i)}},_panMove:function(t){var e=l,i=this.byAxis.isHorizontal()?t.containerPoint[0]:t.containerPoint[1];if(this.target&&this.downPos!=i){switch(this.target){case this.leftTopButton:this._leftButtonMove(this.downPos,this.initPos,i);break;case this.rightBottomButton:this._rightButtonMove(this.downPos,this.initPos,i);break;case this.centerRect:e=this._centerRectMove(this.downPos,i)}this._zoomRefresh(e)}},_leftButtonMove:function(t,e,i){var n=0,r=this.rightBottomButton.pos-s,a=e+i-t,o=this.byAxis.isVertical();a=Math.max(Math.min(a,r),n),this.leftTopButton.pos=a;var l="width",h="x";o&&(l="height",h="y"),this.leftTopButton.attr("transform",this._getButtonTranslate(o,a)),this.leftTopRect.attr(l,a),this.centerRect.attr(h,a+s).attr(l,r-a)},_rightButtonMove:function(t,e,i){var n=this.bounds.width,r="x",a="width",o=this.byAxis.isVertical();o&&(n=this.bounds.height,r="y",a="height");var l=n-s,h=this.leftTopButton.pos+s,u=e+i-t;u=Math.max(Math.min(u,l),h),this.rightBottomButton.pos=u,this.rightBottomButton.attr("transform",this._getButtonTranslate(o,u)),this.rightBottomRect.attr(r,u+s).attr(a,n-(u+s)),this.centerRect.attr(a,u-h)},_centerRectMove:function(t,e){var i=this.bounds.width,n=e-t-this.initTranslate,r="x",a="width",o=this.byAxis.isVertical();if(o&&(i=this.bounds.height,r="y",a="height"),this.initTranslate=e-t,this.leftTopButton.pos+n>=0&&this.rightBottomButton.pos+s+n<=i){var l=this.leftTopButton.pos+n;this.leftTopButton.pos=l,this.leftTopButton.attr("transform",this._getButtonTranslate(o,l)),this.leftTopRect.attr(a,l);var c=this.rightBottomButton.pos+n;this.rightBottomButton.pos=c,this.rightBottomButton.attr("transform",this._getButtonTranslate(o,c)),this.rightBottomRect.attr(r,c+s).attr(a,i-(c+s)),this.centerRect.attr(r,l+s)}return this.initTranslate>0?h:u},_getValueByPosition:function(t){var e=this.byAxis,i=this.axisScale;switch(e.type){case a.CATEGORY_AXIS_COMPONENT:for(var r=i.domain(),o=i.range(),s=0,l=o.length-1;l>s;s++){if(t>=o[s]&&t<o[s+1])return r[s];if(t<o[s]&&t>=o[s+1])return r[s+1]}return o[0]>o[o.length-1]?r[0]:r[r.length-1];case a.DATE_AXIS_COMPONENT:return n.date2int(this.axisScale.invert(t));default:return this.axisScale.invert(t)}},_getButtonTranslate:function(t,e){var i=t?[0,e]:[e,0];return"translate("+i+")"},_zoomRefresh:function(t){var e,i=this.leftTopButton.pos,r=this.rightBottomButton.pos+s,o=this._getValueByPosition(i),c=this._getValueByPosition(r),d=this.vanchart,f=this.byAxis,p=f._dataDomain,g=n.indexInArray,m=d.getComponent(a.DATA_SHEET_COMPONENT);if(f.isCategory()){if(t==l)e=this._getValidDomain(o,c,p,!0);else{var v=g(p,this.rangeLeftTop)-g(p,this.rangeRightBottom);if(v=Math.abs(v)+1,t==h&&c!=this.rangeRightBottom)if(f.isAxisReversed()^f.isHorizontal()){var y=g(p,c),_=y-v+1;o=p[_],c=p[y],e=p.slice(_,y+1)}else{var _=g(p,c),y=_+v-1;o=p[y],c=p[_],e=p.slice(_,y+1)}else if(t==u&&o!=this.rangeLeftTop)if(f.isAxisReversed()^f.isHorizontal()){var _=g(p,o),y=_+v-1;o=p[_],c=p[y],e=p.slice(_,y+1)}else{var y=g(p,o),_=y-v+1;o=p[y],c=p[_],e=p.slice(_,y+1)}else o=this.rangeLeftTop,c=this.rangeRightBottom}(this.rangeLeftTop!=o||this.rangeRightBottom!=c)&&(this.rangeLeftTop=o,this.rangeRightBottom=c,f.zoomRefresh(e),f.fixScaleAndTickData(),f.render(),m&&m.zoomRefresh(),d.reRenderSeries())}else e=this._getValidDomain(o,c,p,!1),this.rangeLeftTop=o,this.rangeRightBottom=c,f.zoomRefresh(e),f.fixScaleAndTickData(),f.render(),d.reRenderSeries()},_panEnd:function(){this.target=null},_resizeable:function(){return this.options&&this.options.zoomTool&&this.options.zoomTool.resize},getEvents:function(){return{panstart:this._panStart,panmove:this._panMove,panend:this._panEnd}},remove:function(){this.zoomBarGroup&&this.zoomBarGroup.remove(),this.zoomBarGroup=null}});return t("../ComponentLibrary").register(a.ZOOM_COMPONENT,d),d}),i("component/ToolbarIcon",["require","./Base","../utils/BaseUtils","../Constants","../dom/Evented"],function(t){function e(){return{fill:"black","fill-opacity":.05}}function i(){return{fill:"black","fill-opacity":.1}}function n(){return{fill:"black","fill-opacity":0}}function r(){return{fill:"black","fill-opacity":.05}}var a=2,o=32,s=(t("./Base"),t("../utils/BaseUtils")),l=t("../Constants"),h=t("../dom/Evented"),u=h.extend({initialize:function(t,e,i,n){this.iconType=t,this.toolbar=e,this.visible=n,this.pos=i,this.currentPos={x:i.x,y:i.y}},render:function(){var t=this.toolbar,i=t.vanchart,r=i.renderer,s=this;this.iconG||(this.iconG=r.group().style({cursor:"pointer"}).addTo(t.toolbarGroup)),r.registerInteractiveTarget(this,this.iconG),this.iconG.attr("transform","translate("+s.pos.x+","+s.pos.y+")").style({display:this.visible?"":"none"}),this.iconG.rect=this.iconG.rect||r.rect().attr("width",o).attr("height",o).attr("rx",a).attr("ry",a).addTo(this.iconG),this.iconG.rect.style(t.hidden?n():e()),this.iconG.path=this.iconG.path||this._getIconPathGraphic(i,r,s)},_getIconPathGraphic:function(t,e,i){switch(this.iconType){case l.REFRESH_ICON:return e.path().attr("d",i.getRefreshIconPath()).style({fill:"#FF9933"}).addTo(this.iconG);case l.SORT:return t.orderType==l.ASCENDING?e.path().attr("d",i.getDecreaseIconPath()).style({fill:"#33CCFF"}).addTo(this.iconG):e.path().attr("d",i.getIncreaseIconPath()).style({fill:"#33CCFF"}).addTo(this.iconG);case l.EXPORT_ICON:return e.path().attr("d",i.getExportIconPath()).style({fill:"#6666CC"}).addTo(this.iconG);case l.FULL_SCREEN_ICON:return t.vancharts.fullScreenFather?e.path().attr("d",i.getMinIconPath()).style({fill:"#33CC66"}).addTo(this.iconG):e.path().attr("d",i.getMaxIconPath()).style({fill:"#33CC66"}).addTo(this.iconG);case l.MENU_ICON:return e.path().attr("d",i.getMenuIconPath()).style({"stroke-width":2,stroke:"#AAAAAA"}).addTo(this.iconG)}},refreshMove:function(t,e){var i=this.pos,n=this.currentPos,r=n.x-t,a=r+e;s.isSupportSVG()?d3.select(this.iconG.node()).transition().ease("circle-out").duration(220).attr("transform","translate("+r+","+i.y+")").transition().ease("circle-in").duration(220).attr("transform","translate("+a+","+i.y+")"):this.iconG.attr("transform","translate("+a+","+i.y+")"),this.currentPos.x=a},refreshMoveWithoutAnimation:function(t,e){var i=this.currentPos.x-t+e;this.iconG.attr("transform","translate("+i+","+this.pos.y+")"),this.currentPos.x=i},showIcon:function(){this.visible=!0,arguments.length?this._iconAnimation(arguments[0],arguments[1]):this.iconG.style({display:""})},hideIcon:function(){this.visible=!1,arguments.length?this._iconAnimation(arguments[0],arguments[1]):(this.iconG.style({display:"none"}),this.iconG.attr("transform","translate("+this.pos.x+","+this.pos.y+")"),this.currentPos.x=this.pos.x)},_iconAnimation:function(t,i){var r=this.iconG,a=this.pos,o=this.visible;s.isSupportSVG()?setTimeout(function(){o&&r.style({display:""});var i=4*t,s=a.x-i;d3.select(r.node()).transition().ease("circle-out").duration(100).attr("transform","translate("+s+","+a.y+")").transition().ease("circle-in").duration(100).attr("transform","translate("+a.x+","+a.y+")").each("end",function(){r.style({display:o?"":"none"})}),d3.select(r.rect.node()).style(o?n():e()).transition().ease("linear").duration(200).style(o?e():n())},i):(r.attr("transform","translate("+a.x+","+a.y+")").style({display:o?"":"none"}),r.rect.style(o?e():n())),this.currentPos.x=this.pos.x},onMouseOver:function(){this.iconG.rect.style(this.toolbar.hidden?r():i())},onMouseOut:function(){this.iconG.rect.style(this.toolbar.hidden?n():e())},onTap:function(){var t=this.toolbar,e=t.vanchart,i=(e.renderer,this),n=e.getDivParentDom();switch(i.iconType){case l.REFRESH_ICON:e.refreshRestore(),i.hideIcon();break;case l.SORT:e.orderType==l.ASCENDING?(e.orderType=l.DESCENDING,i.iconG.path.attr({d:i.getIncreaseIconPath()})):(e.orderType=l.ASCENDING,i.iconG.path.attr({d:i.getDecreaseIconPath()})),t.refreshEnabled()&&t.refreshIcon.showIcon(),e.orderData();break;case l.EXPORT_ICON:var r=this.toolbar.options.toImage;r&&r.imageUrl&&s.toPng(r.imageUrl);break;case l.FULL_SCREEN_ICON:e.vancharts.fullScreenFather?s.hideLightBox(n,e.vancharts.fullScreenFather):s.showLightBox(e);break;case l.MENU_ICON:t.showOrHide()}},getEvents:function(){return{mouseover:this.onMouseOver,mouseout:this.onMouseOut,tap:this.onTap}},getMaxIconPath:function(){return"M24,8v6.5L21.5,12l-3,3L17,13.5l3-3L17.5,8H24z M15,18.5l-3,3l2.5,2.5H8v-6.5l2.5,2.5l3-3L15,18.5z"},getMinIconPath:function(){return"M15,17v6.5L12.5,21l-3,3L8,22.5l3-3L8.5,17H15z M24,9.5l-3,3l2.5,2.5H17V8.5l2.5,2.5l3-3L24,9.5z"},getIncreaseIconPath:function(){return"M8,20h16v2H8V20z M10,16h2v3h-2V16z M13,14h2v5h-2V14z M16,12h2v7h-2V12z M19,9h2v10h-2V9z"},getDecreaseIconPath:function(){return"M8,20h16v2H8V20z M10,9h2v10h-2V9z M13,12h2v7h-2V12z M16,15h2v4h-2V15z M19,16h2v3h-2V16z"},getExportIconPath:function(){return"M22,8H8v16h16V10L22,8z M16,10h2v4h-2V10z M22,22H10V10h1v5h9v-5h1.171L22,10.829V22z"},getRefreshIconPath:function(){return"M21.656,10.344C20.209,8.896,18.209,8,16,8c-3.43,0-6.354,2.158-7.492,5.19l1.873,0.703C11.234,11.619,13.428,10,16,10c1.657,0,3.156,0.672,4.243,1.757L18,14h6V8L21.656,10.344z M16,22c-1.657,0-3.156-0.671-4.243-1.757L14,18H8v6l2.344-2.344C11.791,23.104,13.791,24,16,24c3.43,0,6.354-2.158,7.492-5.19l-1.873-0.703C20.766,20.381,18.572,22,16,22z"},getMenuIconPath:function(){return"M8,10L24,10 M8,15L24,15 M8,20L24,20"}});return u}),i("component/ToolBar",["require","./Base","../utils/BaseUtils","../Constants","./ToolbarIcon","../ComponentLibrary"],function(t){var e=t("./Base"),i=t("../utils/BaseUtils"),n=t("../Constants"),r=t("./ToolbarIcon"),a=t("../ComponentLibrary"),o=32,s=1,l=5,h=e.extend({doLayout:function(){var t=this.options,e=t.hidden,i=this._filterSort()?["sort","toImage","fullScreen"]:["toImage","fullScreen"],a=[n.REFRESH_ICON];i.forEach(function(e){t[e]&&t[e].enabled&&a.push(e)}),e&&a.push(n.MENU_ICON);var h=o+s,u=a.length*h+l;if(this.startX=this.vanchart.width-u,!this.toolbarGroup){this.toolbarIcons=[],this.hidden=e;for(var c=0,d=a.length;d>c;c++){var f={x:c*h,y:l},p=a[c],g=!e;p==n.MENU_ICON?this.menuIcon=new r(p,this,f,!0):p==n.REFRESH_ICON?this.refreshIcon=new r(p,this,f,!1):this.toolbarIcons.push(new r(p,this,f,g))}this.isFloat=!0}},_filterSort:function(){var t=!1,e=this.vanchart.options,i=e.chartType,r=e.series;return i&&i!=n.FORCE_BUBBLE_CHART?!0:(r.forEach(function(e){e.type&&e.type!=n.FORCE_BUBBLE_CHART&&(t=!0)}),t)},render:function(){var t=this.vanchart.renderer;return this.toolbarGroup?void this.toolbarGroup.attr("transform",i.makeTranslate([this.startX,0])):(this.toolbarGroup=t.group().add().attr("transform",i.makeTranslate([this.startX,0])),this.vanchart._leaflet&&this.toolbarGroup.style("pointer-events","all"),this.toolbarIcons.forEach(function(t){t.render()}),this.menuIcon&&this.menuIcon.render(),void(this.refreshIcon&&this.refreshIcon.render()))},showOrHide:function(){this.hidden?this.show():this.hide(),this.hidden=!this.hidden},hide:function(){for(var t=this.toolbarIcons,e=t.length,i=[],n=0;e>n;n++)i.push(100+80*n);for(var n=0;e>n;n++){var r=e-n;t[n].hideIcon(r,i[n])}var a=4*(e+1),o=4*(e+1)+33*e;this.refreshIcon.visible&&this.refreshIcon.refreshMove(a,o)},show:function(){for(var t=[0],e=this.toolbarIcons,i=e.length,n=0;i-1>n;n++)t.push(100+80*n);for(var n=0;i>n;n++){var r=i-n;e[n].showIcon(r,t[n])}var a=4*(i+1)+33*i,o=4*(i+1);this.refreshIcon.visible&&this.refreshIcon.refreshMove(a,o)},showRefreshIconWhenZoom:function(){if(!this.refreshIcon.visible&&this.refreshEnabled())if(this.menuIcon)if(this.hidden){var t=this.toolbarIcons.length,e=4*(t+1),i=4*(t+1)+33*t;this.refreshIcon.refreshMoveWithoutAnimation(e,i),this.refreshIcon.showIcon()}else this.refreshIcon.showIcon();else this.refreshIcon.showIcon()},refreshEnabled:function(){return!(this.options.refresh&&this.options.refresh.enabled===!1)},getToolBarInitWidth:function(){return this.options.enabled?this.options.hidden?o+l:this.toolbarIcons.length*(o+s)-s+l:0},remove:function(){this.toolbarGroup&&this.toolbarGroup.remove(),this.toolbarGroup=null}});return a.register(a.TOOLBAR_COMPONENT,h),h}),i("dom/EventObject",["require","../dom/Evented"],function(t){var e=t("../dom/Evented"),i=e.extend({initialize:function(t){this.events=t},getEvents:function(){return this.events}});return i}),i("component/RangeLegend",["require","./Base","../utils/BaseUtils","../Constants","../utils/ColorUtils","../utils/Formatter","../ComponentLibrary"],function(t){var e,i=t("./Base"),n=t("../utils/BaseUtils"),r=t("../Constants"),a=(t("../utils/ColorUtils"),t("../utils/Formatter"),t("../ComponentLibrary")),o=function(){return null==e&&(e=n.paddingConvertWithScale("0.625rem")),e},s=i.extend({doLayout:function(){if(this.invisible())return void this.remove();var t=this.options,e=t.position||r.RIGHT,i=o()*(this.isFloat?2:4);if(e==r.TOP||e==r.BOTTOM?this._layoutHorizontal(e,i):this._layoutVertical(e,i),!this.isFloat){var n=this.options.borderWidth+2*o();if(this.bounds.x+=n/2,this.bounds.y+=n/2,this.bounds.width-=n,this.bounds.height-=n,e==r.BOTTOM){var s=this.vanchart.getComponent(a.ZOOM_COMPONENT);s&&s.zoomToolEnabled()&&s.bounds&&(this.bounds.y+=s.bounds.height||0)}if(e==r.RIGHT_TOP){var l=this.vanchart.getComponent(a.TOOLBAR_COMPONENT);l&&(this.bounds.y=Math.max(37,this.bounds.y))}}},_layoutHorizontal:function(t,e){var i=this.calculateHorizontalDim(),n=i.height+e;n=this.options.maxHeight?Math.min(n,this._maxHeight()):n,this._setComponentBounds(t,n);var r=i.width+e;this.isFloat||(this.bounds.x+=Math.max((this.bounds.width-r)/2,0)),this.bounds.width=r},_layoutVertical:function(t,e){var i=this.calculateVerticalDim(),n=i.width+e;n=this.options.maxWidth?Math.min(n,this._maxWidth()):n,this._setComponentBounds(t,n);var a=i.height+e;this.isFloat||t==r.RIGHT_TOP||(this.bounds.y+=Math.max((this.bounds.height-a)/2,0)),this.bounds.height=a},render:function(){if(!this.invisible()){var t=this.bounds,e=this,i=e.vanchart,r=i.renderer;this.group||(this.backgroundGroup=r.group().add(),this.group=r.vgroup().add(),this.legendGroup=this.group.append(r.vgroup()),this.vanchart._leaflet&&this.group.style("pointer-events","all"));var a;a=this.useHtmlLabel()?this.legendGroup.divG:this.legendGroup.renderG,r.registerInteractiveTarget(this,a),this._innerClip(this.group),this.group.attr("transform",n.makeTranslate(t)),i._renderRectangleBackground(this.backgroundGroup,this.options,t),this.renderBody(this.legendGroup,t)}},getEvents:function(){return{mouseout:this.mouseOut}},mouseOut:function(){this.highlighted&&(this.highlighted=!1,this.vanchart.cancelLegendHighlight())},remove:function(){this.group&&this.group.remove(),this.group=null}});return s}),i("component/IntervalRangeLegend",["require","../utils/BaseUtils","../Constants","../utils/ColorUtils","../utils/Formatter","../dom/EventObject","./RangeLegend","../ComponentLibrary"],function(t){var e,i,n,r=t("../utils/BaseUtils"),a=t("../Constants"),o=t("../utils/ColorUtils"),s=t("../utils/Formatter"),l=t("../dom/EventObject"),h=t("./RangeLegend"),u=t("../ComponentLibrary"),c=function(){return null==e&&(e=r.paddingConvertWithScale("0.625rem")),e},d=15,f=function(){return null==i&&(i=r.paddingConvertWithScale("0.3125rem")),i},p=25,g=function(){return null==n&&(n=r.paddingConvertWithScale("0.125rem")),n},m=h.extend({type:u.INTERVAL_RANGE_LEGEND,initAttributesWithSeries:function(){var t=this.options,e=t.range||{};if(!r.isArray(e)){var i=e.splitNumber||5,n=e.color||this.vanchart.options.colors[0],a=this.vanchart.isHeatMap()?["rgb(0,0,255)","rgb(0,255,0)","rgb(255,255,0)","rgb(255,0,0)"]:o.createColorsWithHsb(n,i),s=this.vanchart.getMinMaxFromSeries(),h=r.calculateAutoMinMaxAndGap(s[0],s[1],i),u=h[0],c=h[2];if(e=[],this.vanchart.isHeatMap())for(var d=[0,.25,.55,.85,1],f=r.accMul(c,i),p=1;5>p;p++)e.push({from:r.accAdd(u,r.accMul(f,d[p-1])),to:r.accAdd(u,r.accMul(f,d[p])),color:a[p-1]});else for(var p=0;i>p;p++)e.push({from:r.accAdd(u,r.accMul(c,i-p-1)),to:r.accAdd(u,r.accMul(c,i-p)),color:a[p]})}this.items=this.items||[];for(var g=e.length,m=this.items.length,v=g;m>v;v++)this.items[v].graphic&&this.items[v].graphic.remove(),this.items[v]=null;for(var y=t.formatter,_=0;g>_;_++){var x=this.items[_]||new l(this.getItemEvents());this.items[_]=x;var T=e[_];x.from=T.from,x.to=T.to,x.color=T.color,x.label=this._getIntervalLabelContent(T.from,T.to,y),x.visible=!0,x.hiddenColor=t.hiddenColor,x.hoverColor=t.hoverColor,x.points=[],x.legend=this}var b=this,A=this.vanchart.series;this.items.sort(function(t,e){var i=Math.min(t.from,t.to),n=Math.min(e.from,e.to);return b.isHorizontal()?i-n:n-i});for(var p=0,L=A.length;L>p;p++){var C=A[p],P=C.getTargetKey(),M=C.points;M.forEach(function(t){var e=t[P],i=b._getPointItem(e);i&&(i.points.push(t),t._rangeItem=i)})}},_getMin:function(){var t=this.isHorizontal()?0:this.items.length-1;return this.items[t].from},_getMax:function(){var t=this.isHorizontal()?this.items.length-1:0;return this.items[t].to},_getGradient:function(){for(var t={0:"white"},e=this._getMin(),i=this._getMax(),n=i-e,r=this.items.length-1;r>=0;r--){var a=this.items[r];t[(a.to-e)/n]=a.color}return t},_getIntervalLabelContent:function(t,e,i){return i?s.format({from:t,to:e},i):t+"-"+e},_getPointItem:function(t){for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e],r=Math.min(n.from,n.to),a=Math.max(n.from,n.to);if(t>=r&&a>=t)return n}},calculateHorizontalDim:function(){var t=this.items.length,e=0,i=0;if(t>0){var n=r.getTextDimension(this.items[0].label,this.options.style,this.options.useHtml),a=r.getTextDimension(this.items[t-1].label,this.options.style,this.options.useHtml),o=Math.max(0,n.width-p,a.width-p);e=t*p+(t-1)*g()+o,i=d+2*f()+2*n.height}return{width:e,height:i}},calculateVerticalDim:function(){var t=this.items.length,e=0,i=0,n=this.options.style,a=this;return this.items.forEach(function(t){var o=r.getTextDimension(t.label,n,a.options.useHtml);e=Math.max(e,o.width),i=Math.max(0,o.height-p)}),{width:e+d+f(),height:t*p+(t-1)*g()+i}},getColorWithSize:function(t){var e=this._getPointItem(t);return e&&e.color},renderBody:function(t,e){this.isHorizontal()?this._renderHorizontalInterval(t,e):this._renderVerticalInterval(t,e)},_renderHorizontalInterval:function(t,e){var i=this.items,n=(e.width-i.length*p-(i.length-1)*g())/2;t.attr("transform",r.makeTranslate([n,c()])),this._absX=e.x+n,this._absY=e.y+c();var a=this.options.style,o=this.vanchart,s=o.renderer,l=this.useHtmlLabel(),h=0,u=this;i.forEach(function(e,i){e.graphic=e.graphic||t.append(s.vgroup().style({cursor:"pointer"}));var n=e.graphic;s.registerInteractiveTarget(e,l?n.divG:n.renderG);var o=e.label,c=r.getTextDimension(o,a,u.options.useHtml),m=c.height,v=m+f(),y=v+d+f();n.rect=n.rect||n.append(s.rect()),n.rect.style(u._getItemIconStyle(e)).attr("rx",2).attr("ry",2).attr("x",h).attr("y",v).attr("width",p).attr("height",d);var _=h+p/2-c.width/2,x=i%2===0?0:y;u._renderItemLabel(e,n,_,x,c,i),h+=p+g()})},_renderVerticalInterval:function(t,e){var i=this.items,n=(e.height-i.length*p-(i.length-1)*g())/2;t.attr("transform",r.makeTranslate([c(),n])),this._absX=e.x+c(),this._absY=e.y+n;var a=this.options.style,o=this.vanchart.renderer,s=this.useHtmlLabel(),l=0,h=this;i.forEach(function(e,i){e.graphic=e.graphic||t.append(o.vgroup().style({cursor:"pointer"}));var n=e.graphic;o.registerInteractiveTarget(e,s?n.divG:n.renderG);var u=r.getTextDimension(e.label,a,s);n.rect=n.rect||n.append(o.rect()),n.rect.style(h._getItemIconStyle(e)).attr("rx",2).attr("ry",2).attr("x",0).attr("y",l).attr("width",d).attr("height",p);var c=Math.round(d+f()),m=Math.round(l+p/2-u.height/2);h._renderItemLabel(e,n,c,m,u,i),l+=p+g()})},_renderItemLabel:function(t,e,i,n,r,a){var o=this,s=o.vanchart,l=s.renderer,h=o.options,u=t.label,c=h.style,d=this.useHtmlLabel(),f=t.visible?c.color:t.hiddenColor;e.text=e.text||e.append(l.vtext(d)),e.text.textContent(u).attr("dy",".88em").attr("x",i).attr("y",n).style(c),e.text.style({color:f})},_getItemIconStyle:function(t){return{fill:t.visible?t.color:t.hiddenColor,"fill-opacity":1,stroke:"none"}},getItemEvents:function(){return{mouseover:this.onItemMouseOver,mousemove:this.onItemMouseMove,mouseout:this.onItemMouseOut,tap:this.onItemTap}},onItemMouseOver:function(t){var e=this,i=e.legend,n=e.graphic&&e.graphic.text;i.useHtmlLabel()?n.style.color=o.colorToHex(e.hoverColor):n.style({fill:e.hoverColor}),this.legend.options.highlight&&(this.legend.highlighted=!0,this.legend.vanchart.makeLegendHighlight(e))},onItemMouseMove:function(t){},onItemMouseOut:function(t){var e=this,i=e.legend,n=i.options,r=e.graphic&&e.graphic.text,a=n.style.color,s=e.visible?a:e.hiddenColor;i.useHtmlLabel()?r.style.color=o.colorToHex(s):r.style({fill:s})},onItemTap:function(t){var e=this,i=e.legend,n=i.options,r=i.vanchart,s=e.graphic&&e.graphic.text,l=e.graphic&&e.graphic.rect;e.visible=!e.visible;var h=n.style.color,u=e.visible?e.color:e.hiddenColor,c=e.visible?h:e.hiddenColor;if(l.style({fill:u}),i.useHtmlLabel()?s.style.color=o.colorToHex(c):s.style({fill:c}),e.points&&e.points.length>0){var d="vanChartMap"==r.vanChartType;e.points.forEach(function(t){var i=t.series.type===a.LINE_MAP;if((!d||d&&t.points&&t.points[0]==t||i)&&(t.visible=e.visible,d&&!i))for(var n=t.points,r=1,o=n.length;o>r;r++)n[r].visible=t.visible}),r.filterRender()}}});return u.register(u.INTERVAL_RANGE_LEGEND,m),m}),i("component/GradientRangeLegend",["require","../utils/BaseUtils","../Constants","../utils/Formatter","../utils/ColorUtils","./RangeLegend","../ComponentLibrary"],function(t){var e,i,n=t("../utils/BaseUtils"),r=t("../Constants"),a=t("../utils/Formatter"),o=t("../utils/ColorUtils"),s=t("./RangeLegend"),l=t("../ComponentLibrary"),h=function(){return null==e&&(e=n.paddingConvertWithScale("0.625rem")),e},u=15,c=100,d=15,f=10,p=function(){return null==i&&(i=n.paddingConvertWithScale("0.3125rem")),i},g="M7.236,10H13c1.105,0,2-0.895,2-2V2c0-1.105-0.895-2-2-2L2.618,0C1.875,0,1.391,0.782,1.724,1.447l3.724,7.447C5.786,9.572,6.479,10,7.236,10z",m="M7.236,0L13,0c1.105,0,2,0.895,2,2v6c0,1.105-0.895,2-2,2H2.618c-0.743,0-1.227-0.782-0.894-1.447l3.724-7.447C5.786,0.428,6.479,0,7.236,0z",v="M0,7.236V13c0,1.105,0.895,2,2,2h6c1.105,0,2-0.895,2-2V2.618c0-0.743-0.782-1.227-1.447-0.894L1.106,5.447C0.428,5.786,0,6.479,0,7.236z",y="M10,7.236V13c0,1.105-0.895,2-2,2H2c-1.105,0-2-0.895-2-2L0,2.618c0-0.743,0.782-1.227,1.447-0.894l7.447,3.724C9.572,5.786,10,6.479,10,7.236z",_=s.extend({type:l.GradientRangeLegend,initAttributesWithSeries:function(){var t=this.options,e=t.range||{};this.valueAndColors=e.color||this._getDefaultValueAndColors();var i=e.min,r=e.max;if(n.hasNotDefined(i)&&n.hasNotDefined(r)){var a=this.vanchart.getMinMaxFromSeries(),o=n.calculateAutoMinMaxAndGap(a[0],a[1],Math.max(2,this.valueAndColors.length-1));i=o[0],r=o[1]}this.min=n.pick(e.min,i),this.max=n.pick(e.max,r),this.minPos=0,this.maxPos=c,this.valueAndColors.sort(function(t,e){return t[0]-e[0]});for(var s=[],l=[],h=0,u=this.valueAndColors.length;u>h;h++)s[h]=this.valueAndColors[h][0],l[h]=this.valueAndColors[h][1];this.valueScale=d3.scale.linear().domain([this.min,this.max]).range([0,1]),this.colorScale=d3.scale.linear().domain(s).range(l)},_getMin:function(){return this.min},_getMax:function(){return this.max},_getGradient:function(){var t={};return this.valueAndColors.forEach(function(e){t[e[0]]=e[1]}),t},_getDefaultValueAndColors:function(){var t=o.createColorsWithHsb(this.vanchart.options.colors[0],3);return[[0,t[2]],[.5,t[1]],[1,t[0]]]},calculateHorizontalDim:function(){var t=n.getTextDimension(this._getGradientMinLabelContent(),this.options.style,this.options.useHtml),e=n.getTextDimension(this._getGradientMaxLabelContent(),this.options.style,this.options.useHtml),i=Math.max(t.width,e.width,f),r=c+2*i,a=u+d+p()+t.height;return{width:r,height:a}},calculateVerticalDim:function(){var t=n.getTextDimension(this._getGradientMinLabelContent(),this.options.style,this.options.useHtml),e=n.getTextDimension(this._getGradientMaxLabelContent(),this.options.style,this.options.useHtml),i=u+d+p()+Math.max(t.width,e.width),r=2*Math.max(t.height/2,f/2),a=c+2*r;return{width:i,height:a}},getColorWithSize:function(t){return t>=this.min&&t<=this.max?this.colorScale(this.valueScale(t)):null},_getGradientMinLabelContent:function(){return this._getGradientLabelWithFormatter(this.min)},_getGradientMaxLabelContent:function(){return this._getGradientLabelWithFormatter(this.max)},_getGradientLabelWithFormatter:function(t){var e=this.options.formatter;return e?a.format(t,e):t},_getGradientLabelContent:function(t){return this._getGradientLabelWithFormatter(this._gradientScale(t))},_gradientScale:function(t){var e=n.accDiv(n.accAdd(this.max,-this.min),c);return t=n.accMul(e,this.isHorizontal()?t:c-t),t=n.accAdd(t,this.min)},_getBarBackgroundStyle:function(){return{fill:"#eaeaea","stroke-width":0}},_getGradientFillColor:function(t,e){var i={x1:"0%",y1:t?"0%":"100%",x2:t?"100%":"0%",y2:"0%"},r=[];return this.valueAndColors.forEach(function(t){var e=t[0],i=t[1];r.push({offset:e,"stop-color":i})}),this._bar.colorGradient?e.updateColorGradient(this._bar.colorGradient,i,r):this._bar.colorGradient=e.colorGradient(i,r),"url(#"+n.stamp(this._bar.colorGradient)+")"},_updateHorizontalGradientClipRect:function(){var t=this,e=t.vanchart,i=e.renderer,n={x:this.minPos,y:0,width:this.maxPos-this.minPos,height:u};this._bar.clipG?i.updateClip(this._bar.clipG,n):(this._bar.clipG=i.createClip(n),i.clip(this._bar,this._bar.clipG))},_updateVerticalGradientClipRect:function(){var t=this,e=t.vanchart,i=e.renderer,n={x:0,y:this.minPos,width:u,height:this.maxPos-this.minPos};this._bar.clipG?i.updateClip(this._bar.clipG,n):(this._bar.clipG=i.createClip(n),i.clip(this._bar,this._bar.clipG))},renderBody:function(t,e){var i=this,r=i.vanchart,a=r.renderer,o=(r.getPlotBounds(),i.isHorizontal()),s=o?(e.width-c)/2:h(),l=o?h():(e.height-c)/2;t.attr("transform",n.makeTranslate([s,l])),this._absX=e.x+s,this._absY=e.y+l,this._barBackground=this._barBackground||t.append(a.rect()),
    this._bar=this._bar||t.append(a.rect()),this._minButton=this._minButton||t.append(a.path().style({cursor:"pointer"})),this._maxButton=this._maxButton||t.append(a.path().style({cursor:"pointer"})),this._minLabel=this._minLabel||t.append(a.vtext(this.useHtmlLabel())),this._maxLabel=this._maxLabel||t.append(a.vtext(this.useHtmlLabel()));var d={rx:2,ry:2,x:0,y:0,width:o?c:u,height:o?u:c};this._barBackground.style(this._getBarBackgroundStyle()).attr(d),this._bar.attr(d).style({fill:this._getGradientFillColor(o,a),"stroke-width":0}),n.isSupportSVG()||a._updateGradientFill(this._bar,this._bar.colorGradient),this._minButton.attr("d",o?v:g),this._maxButton.attr("d",o?y:m),this._minLabel.attr("dy",".85em").style(this.options.style),this._maxLabel.attr("dy",".85em").style(this.options.style),this._updateMax(),this._updateMin()},_updateMin:function(){this.isHorizontal()?this._updateHorizontalMinBar():this._updateVerticalMinBar()},_updateMax:function(){this.isHorizontal()?this._updateHorizontalMaxBar():this._updateVerticalMaxBar()},_updateVerticalMinBar:function(){this._minButton.attr("transform","translate("+u+","+this.maxPos+")").style({fill:this.colorScale((c-this.maxPos)/c)});var t=this._getGradientLabelContent(this.maxPos),e=n.getTextDimension(t,this.options.style,!0),i=Math.round(u+d+p()),r=Math.round(this.maxPos+f/2-e.height/2);this._minLabel.textContent(t).attr("x",i).attr("y",r),this._updateVerticalGradientClipRect()},_updateHorizontalMinBar:function(){var t=this.minPos-f;this._minButton.attr("transform","translate("+t+","+u+")").style({fill:this.colorScale(this.minPos/c)});var e=this._getGradientLabelContent(this.minPos),i=n.getTextDimension(e,this.options.style,!0),r=Math.round(this.minPos-i.width),a=Math.round(u+d+p());this._minLabel.textContent(e).attr("x",r).attr("y",a),this._updateHorizontalGradientClipRect()},_updateVerticalMaxBar:function(){var t=this.minPos-f;this._maxButton.attr("transform","translate("+u+","+t+")").style({fill:this.colorScale((c-this.minPos)/c)});var e=this._getGradientLabelContent(this.minPos),i=n.getTextDimension(e,this.options.style,!0),r=Math.round(u+d+p()),a=Math.round(this.minPos-f/2-i.height/2);this._maxLabel.textContent(e).attr("x",r).attr("y",a),this._updateVerticalGradientClipRect()},_updateHorizontalMaxBar:function(){this._maxButton.attr("transform","translate("+this.maxPos+","+u+")").style({fill:this.colorScale(this.maxPos/c)});var t=this._getGradientLabelContent(this.maxPos),e=Math.round(this.maxPos),i=Math.round(u+d+p());this._maxLabel.textContent(t).attr("x",e).attr("y",i),this._updateHorizontalGradientClipRect()},getEvents:function(){return{panstart:this._panStart,panmove:this._panMove,panend:this._panEnd}},_panStart:function(t){var e=this.options.position;this.currentX=t.containerPoint[0],this.currentY=t.containerPoint[1],this.eventTarget=e==r.TOP||e==r.BOTTOM?this._findHorizontalTarget():this._findVerticalTarget()},_findHorizontalTarget:function(){var t=(this.maxPos-this.minPos)/2;return this.currentX<this._absX+this.minPos+t?this._minButton:this._maxButton},_findVerticalTarget:function(){var t=(this.minPos-this.maxPos)/2;return this.currentY<this._absY+this.maxPos+t?this._maxButton:this._minButton},_panMove:function(t){this.eventTarget==this._minButton?this._minButtonMove(this.currentX,this.currentY,t.containerPoint[0],t.containerPoint[1]):this.eventTarget==this._maxButton&&this._maxButtonMove(this.currentX,this.currentY,t.containerPoint[0],t.containerPoint[1])},_minButtonMove:function(t,e,i,n){var r=0;if(this.isHorizontal()){var a=this.minPos;this.minPos+=Math.round(i-t),this.minPos=Math.max(this.minPos,0),this.minPos=Math.min(this.minPos,this.maxPos),r=this.minPos-a}else{var a=this.maxPos;this.maxPos+=Math.round(n-e),this.maxPos=Math.min(this.maxPos,c),this.maxPos=Math.max(this.maxPos,this.minPos),r=this.maxPos-a}Math.abs(r)>=1&&(this.currentX=i,this.currentY=n,this._updateMin(),this.refreshPoints())},_maxButtonMove:function(t,e,i,n){var r=0;if(this.isHorizontal()){var a=this.maxPos;this.maxPos+=Math.round(i-t),this.maxPos=Math.min(this.maxPos,c),this.maxPos=Math.max(this.maxPos,this.minPos),r=this.maxPos-a}else{var a=this.minPos;this.minPos+=Math.round(n-e),this.minPos=Math.max(this.minPos,0),this.minPos=Math.min(this.minPos,this.maxPos),r=this.minPos-a}Math.abs(r)>=1&&(this.currentX=i,this.currentY=n,this._updateMax(),this.refreshPoints())},_panEnd:function(t){this.eventTarget=null},refreshPoints:function(){for(var t,e=this._gradientScale(this.minPos),i=this._gradientScale(this.maxPos),n=this.vanchart,a=n.series,o=!1,s="vanChartMap"==n.vanChartType,l=0,h=a.length;h>l;l++){var u=a[l];u.points.forEach(function(n){var a=n.series.type===r.LINE_MAP;if(!s||s&&n.points&&n.points[0]==n||a){var l=n.visible,h=n.getTargetValue();if(n.visible=h>=e&&i>=h||h>=i&&e>=h,o=o||l!=n.visible,s&&!a){t=n.points;for(var u=1,c=t.length;c>u;u++)t[u].visible=n.visible}}})}o&&n.filterRender()}});return l.register(l.GradientRangeLegend,_),_}),i("component/Polar",["require","../Constants","../utils/BaseUtils","./Base","../ComponentLibrary"],function(t){var e=(t("../Constants"),t("../utils/BaseUtils")),i=t("./Base"),n=(t("../ComponentLibrary"),i.extend({_refresh:function(){this.series=[]},_isBaseAxis:function(){return!0},doLayout:function(){var t=this.options,i=t.radius,n=t.center;if(!n||0===n.length){var r=this.vanchart.getPlotBounds();n=[r.width/2+r.x,r.height/2+r.y]}this.setCenter(n),e.hasDefined(i)?this.setRadius(i):this.radius=null;var a=this.vanchart.options.plotOptions,o=a.radar&&a.radar.shape||a.shape;this.shape=o||this.shape},setRadius:function(t){t&&(this.radius=this._getPercentValue(t,Math.min(this.vanchart.width,this.vanchart.height)/2))},setCenter:function(t){t&&(this.center=[],this.center[0]=this._getPercentValue(t[0],this.vanchart.width),this.center[1]=this._getPercentValue(t[1],this.vanchart.height))},render:function(){var t=this.vanchart.renderer,e=this.radiusAxis,i={d:e._getRadiusGridPath(e.scale.domain()[1])};this.clip?t.updateClip(this.clip,i):this.clip=t.createClip(i,"path"),this.radiusAxis.render(),this.angleAxis.render()}}));return n}),i("component/AngleAxis",["require","./Base","./CategoryAxis","../utils/BaseUtils","../Constants","../ComponentLibrary"],function(t){var e,i=(t("./Base"),t("./CategoryAxis")),n=t("../utils/BaseUtils"),r=(t("../Constants"),t("../ComponentLibrary"),function(){return null==e&&(e=n.paddingConvertWithScale("0.625rem")),e}),a="radar-top",o="radar-bottom",s="radar-left",l="radar-right",h=i.extend({_refresh:function(t){this.series=[],this.animation=this.vanchart.isSupportAnimation(),this.piece=null,this.initScale(),this.refreshPolar(t)},refreshPolar:function(t){this.polar=this.vanchart.polar(t.axisIndex),this.polar.angleAxis=this},doLayout:function(){this.calculateDomainFromData(),this.scale.domain(this._dataDomain).rangePoints([0,this._dataDomain.length-1]),this.piece=2*Math.PI/Math.max(this._dataDomain.length,1),this._updateOriginTickData(),this._updatePolarBounds(),this._calculateTickData()},fixScaleAndTickData:function(){this.scale.domain(this._dataDomain).rangePoints([0,this._dataDomain.length-1]),this._updateOriginTickData(),this._calculateTickData()},_calculateTickData:function(){var t,e=this.polar.radius;this.isBreakLabels&&(t=this._getTestBoundsAndRadius().testBounds),this.tickData.map(function(i){this._getCateLabelBounds(e,i,t)},this)},_getTestBoundsAndRadius:function(){var t=this.vanchart.getPlotBounds(),e=this.polar.center,i=[e[1]-t.y,t.x+t.width-e[0],t.y+t.height-e[1],e[0]-t.x],n=Math.min.apply(null,i);n-=r();var a={x:-i[3],y:-i[0],width:t.width,height:t.height};return{testBounds:a,radius:n}},_updatePolarBounds:function(){if(!this.polar.radius){var t=this._getTestBoundsAndRadius(),e=t.radius,i=t.testBounds;this.options.showLabel&&(this._testRadius(e,i)||(e=this._findNiceRadius(i),this._testRadius(e,i))),this.polar.setRadius(e)}},getIndexByPosition:function(t){return this._getIndexByPolarCoordinate(t)},_getIndexByPolarCoordinate:function(t){var e=this.polar.center,i=this.polar.radius,r=this.isAxisReversed(),a=t[0]-e[0],o=e[1]-t[1];if(a*a+o*o>i*i)return-1;var s,l=n.getArcByPoint(a,o),h=this.getCategories();if(h.length>1){var u=2*Math.PI/h.length;s=r?h.length-1-l/u:l/u}else s=0;return s=Math.round(s),s%=h.length},getAngleGridLineData:function(){var t=[],e=this.polar.angleAxis,i=e.scale.domain(),r=this;return i.forEach(function(i){var a=e.scale(i)*e.piece,o=r.polar.radius;t.push(n.getArcPoint(o,a))}),t=t.length?t:[n.getArcPoint(this.polar.radius,0)]},_testRadius:function(t,e){for(var i=0,r=this.tickData.length;r>i;i++){var a=this.tickData[i],o=this._getCateLabelBounds(t,a);if(!n.containsRect(e,o))return!1}return!0},_getCateLabelBounds:function(t,e,i){var h,u=e.tickValue,c=e.tickRectDim,d=this.scale.domain(),f=d.indexOf(u),p=n.getArcPoint(t+r(),f*this.piece),g=this.options,m=this._getPolarPosition(u),v=n.extend({width:"","white-space":"","text-align":""},g.labelStyle);switch(m){case a:h={style:v,x:-c.width/2,y:-t-.65*c.height-r()};break;case l:if(h={style:v,x:p[0],y:p[1]-c.height/2},i&&this.isBreakLabels&&h.x+c.width>i.x+i.width){var y=i.x+i.width-p[0],_=n.extend({width:y+"px","white-space":"normal","text-align":"left"},g.labelStyle);c=n.getTextWrapDimension(e.tickContent,_),h={style:_,x:p[0],y:p[1]-c.height/2}}break;case o:h={style:v,x:-c.width/2,y:t+r()};break;case s:if(h={style:v,x:p[0]-c.width,y:p[1]-c.height/2},i&&this.isBreakLabels&&h.x<i.x){var y=p[0]-i.x,_=n.extend({width:y+"px","white-space":"normal","text-align":"right"},g.labelStyle);c=n.getTextWrapDimension(e.tickContent,_),h={style:_,x:p[0]-c.width,y:p[1]-c.height/2}}}return e.tickPos=h,n.makeBounds(h,c)},_getPolarPosition:function(t){var e=this.scale.domain(),i=e.indexOf(t),n=e.length/2;return 0===i?a:i>0&&n>i?l:i==n?o:i>n?s:void 0},_findNiceRadius:function(t){var e=[-t.y,t.width+t.x,t.height+t.y,-t.x],i=Math.min.apply(null,e),n=i,h=this.scale.domain(),u=this;return this.tickData.forEach(function(t){if(t.tickContent){var i,r=t.tickValue,c=t.tickDim,d=h.indexOf(r),f=u._getPolarPosition(r);switch(f){case a:i=e[0]-c.height;break;case l:i=(e[1]-c.width)/Math.abs(Math.sin(d*u.piece));break;case o:i=e[2]-c.height;break;case s:i=(e[3]-c.width)/Math.abs(Math.sin(d*u.piece))}n=Math.min(n,i)}}),2*i/3>n&&(n=2*i/3,this.options.labelRotation||this.options.useHtml||(this.isBreakLabels=!0)),n-r()},getPointsInCategory:function(t){var e=this.polar.center,i=this.polar.radius,r=t[0]-e[0],a=e[1]-t[1];if(r*r+a*a>i*i)return null;var o=n.getArcByPoint(r,a),s=this.scale.domain(),l=this.scale.rangeExtent(),h=d3.scale.quantize().domain(l).range(s),u=s.length,c=Math.round(o/(2*Math.PI)*u)%u,d=h(c);return this.vanchart.getValidPointsPara(d)},render:function(){var t=this.vanchart,e=t.renderer;this.axisGroup||(this.axisGroup=e.vgroup().add()),this.axisGroup.attr("transform",n.makeTranslate(this.polar.center)),this._drawAxisLine(this.axisGroup),this._drawGridLine(this.axisGroup),this._drawTickLabel(this.axisGroup)},_drawAxisLine:function(t){var e=this.vanchart.renderer,i=this.polar.radiusAxis,n=this,r=n.options.lineWidth,a=n.options.lineColor,o=i.scale.domain()[1];this.axisLine||(this.axisLine=t.append(e.path())),this.axisLine.attr({d:i._getRadiusGridPath(o)}).style({fill:"none",stroke:a,"stroke-width":r})},_drawGridLine:function(t){var e=this.vanchart.renderer,i=this.polar.radiusAxis.options,n=i.lineWidth,r=i.lineColor;this.gridLinesGroup||(this.gridLinesGroup=t.append(e.group()),this.gridLines=[]);var a=this.gridLinesGroup,o=this.getAngleGridLineData(),s=this._bindData(this.gridLines,o);s.exit.map(function(t){t.remove()});var l=s.enter.map(function(t){return a.append(e.line()).datum(t)});this.gridLines=l.concat(s.update).map(function(t){var e=t.datum();return t.style({stroke:r,"stroke-width":n}).attr({x1:0,y1:0,x2:e[0],y2:e[1]})})},_drawTickLabel:function(t){this._drawSvgTickLabel(t)},_drawSvgTickLabel:function(t){var e=this.vanchart.renderer,i=this,n=i.options,r=this.isBreakLabels,a=n.useHtml||r,o=i.tickData;this.tickLabelsGroup||(this.tickLabelsGroup=t.append(e.vgroup()),this.tickLabels=[]),a&&this.tickLabels.length&&"div"!==this.tickLabels[0].type&&(this.tickLabels.map(function(t){t.remove()}),this.tickLabels=[]);var s=this.tickLabelsGroup,l=this._bindData(this.tickLabels,o,function(t){return t.tickValue});if(l.exit.map(function(t){t.remove()}),n.showLabel){var h=l.enter.map(function(t){return s.append(e.vtext(a).datum(t))});this.tickLabels=h.concat(l.update).filter(function(t){return t.datum().tickPos}).map(function(t){var e=t.datum(),i=e.tickPos.x,n=e.tickPos.y,r="div"===t.type?"px":"",a={transform:"translate("+i+r+" "+n+r+")",dy:"0.85em"};return t.textContent(e.tickContent).style(e.tickPos.style).attr(a),t.vRotate(e.labelRotation),t})}},drawHighlightBackground:function(t){var e=t[0].category,i=this.scale,r=this.series[0]&&this.series[0].columnType||!1,a=this.vanchart.renderer,o=i.domain(),s=this.polar.radius,l=i(e)/o.length*2*Math.PI;if(r){var h=1/o.length*2*Math.PI*.5,u=l-h,c=l+h,d=d3.svg.arc().innerRadius(0).outerRadius(s).startAngle(u).endAngle(c);this.highlightBand||(this.highlightBand=this.axisGroup.append(a.path().style({fill:"rgba(98,179,240,0.2)"}))),this.highlightBand.attr("d",d())}else{var f=n.getArcPoint(s,l);this.highlightLine||(this.highlightLine=this.axisGroup.append(a.line({stroke:"rgb(140,140,140)","stroke-width":"1"}))),this.highlightLine.attr("x2",f[0]).attr("y2",f[1])}},remove:function(){this.axisGroup&&this.axisGroup.remove(),this.axisGroup=null}});return h}),i("component/RadiusAxis",["require","./Base","./ValueAxis","../utils/BaseUtils","../Constants","../ComponentLibrary"],function(t){var e,i=(t("./Base"),t("./ValueAxis")),n=t("../utils/BaseUtils"),r=t("../Constants"),a=(t("../ComponentLibrary"),function(){return null==e&&(e=n.paddingConvertWithScale("0.125rem")),e}),o=i.extend({_refresh:function(t){this.series=[],this.animation=this.vanchart.isSupportAnimation(),this.initScale(),this.refreshPolar(t)},refreshPolar:function(t){this.polar=this.vanchart.polar(t.axisIndex),this.polar.radiusAxis=this},doLayout:function(){this.calculateDomainFromData(),this.scale.domain(this._domain).range([0,this.polar.radius]),this._updateOriginTickData()},fixScaleAndTickData:function(){this.scale.domain(this._domain).range([0,this.polar.radius]),this._updateOriginTickData()},getRadiusPlotBands:function(){var t=this._getPlotBands(),e=[],i=this;return t.forEach(function(t){e.push({path:i._getRadiusPlotBandsPath(t.from,t.to),color:t.color})}),e},_getRadiusPlotBandsPath:function(t,e){var i=this.polar.shape;if(i===r.POLYGON_RADAR)return this._getRadiusGridPath(Math.min(t,e))+this._getRadiusGridPath(Math.max(t,e),!0);var n=d3.svg.arc().startAngle(0).endAngle(2*Math.PI);return n.innerRadius(this.scale(Math.min(t,e))).outerRadius(this.scale(Math.max(t,e)))()},getPlotLines:function(){var t=this.options.plotLines||[],e=this,i=[];return t.forEach(function(t){var n,a,o;t.label&&t.label.text&&t.label.style&&(n=t.label.text,a=t.label.style,o=t.label.align),i.push({color:t.color,value:t.value,width:t.width,dataArray:r.DASH_TYPE[t.dashStyle],text:n,baseY:-e.scale(t.value),textAnchor:o==r.LEFT?"end":"start",style:a})}),i},_getRadiusGridPath:function(t,e){var i=this._getRadiusGridData(t,e);return this._getRadiusGridPathByData(i)},_getRadiusGridData:function(t,e,i){var a=i||this.scale,o=this.polar.angleAxis,s=this.polar.shape;if(s===r.POLYGON_RADAR){var l=[],h=o.scale,u=h.domain();return u.forEach(function(e){var i=h(e)*o.piece,r=a(t);l.push(n.getArcPoint(r,i))}),e&&l.reverse(),l}return a(t)},_getRadiusGridPathByData:function(t){if(n.isArray(t)){var e="";if(t.length){for(var i=0,r=t.length;r>i;i++){var a=i?"L":"M";e+=a+n.dealFloatPrecision(t[i][0])+","+n.dealFloatPrecision(t[i][1])}e+="Z"}return e}var o=d3.svg.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(0);return o.outerRadius(t)()},render:function(){var t=this.vanchart,e=t.renderer;this.axisGroup||(this.axisGroup=e.vgroup().add(),e.clip(this.axisGroup.renderG,this.polar.clip)),this.axisGroup.attr("transform",n.makeTranslate(this.polar.center)),this._drawPlotBands(this.axisGroup),this._drawGridLine(this.axisGroup),this._drawPlotLines(this.axisGroup),this._drawTickLabel(this.axisGroup)},_drawGridLine:function(t){var e=this.vanchart.renderer,i=this,n=i.animation,r=i.lastScale||i.scale,a=i.options,o=i.getTickData(),s=a.gridLineColor,l=a.gridLineWidth;this.gridLinesGroup||(this.gridLinesGroup=t.append(e.group()),this.gridLines=[]);var h=this.gridLinesGroup,u=this._bindData(this.gridLines,o);u.exit.map(function(t){if(n){var e=t.datum(),a=i._getRadiusGridData(e.tickValue,!1,r),o=i._getRadiusGridData(e.tickValue);d3.select(t.node()).transition().attrTween("d",function(){var t=d3.interpolate(a,o);return function(e){return i._getRadiusGridPathByData(t(e))}}).remove()}else t.remove()});var c=u.enter.map(function(t){return h.append(e.path()).datum(t)});this.gridLines=c.concat(u.update).map(function(t){var e=t.datum(),a=i._getRadiusGridData(e.tickValue);if(t.style({fill:"none",stroke:s,"stroke-width":l,opacity:1}),n){var o=i._getRadiusGridData(e.tickValue,!1,r);d3.select(t.node()).transition().attrTween("d",function(){var t=d3.interpolate(o,a);return function(e){return i._getRadiusGridPathByData(t(e))}})}else t.attr({d:i._getRadiusGridPathByData(a)});return t})},_drawPlotLines:function(t){var e=this.vanchart.renderer,i=this.animation,n=this.getPlotLines();this.plotLinesGroup||(this.plotLinesGroup=t.append(e.vgroup()),this.plotLines=[]);var r=this.plotLinesGroup,a=this._bindData(this.plotLines,n);a.exit.map(function(t){t.text&&t.text.remove(),t.remove()});var o=a.enter.map(function(t){var i=r.append(e.path().datum(t));return t.text&&(i.text=r.append(e.vtext())),i});this.plotLines=o.concat(a.update).map(function(t){var e=t.datum(),n=this._getRadiusGridPath(e.value);return i?d3.select(t.node()).transition().attr("d",n).style({fill:"none",stroke:e.color,"stroke-width":e.width,"stroke-dasharray":e.dataArray}):t.attr("d",n).style({fill:"none",stroke:e.color,"stroke-width":e.width,"stroke-dasharray":e.dataArray}),t.text&&t.text.textContent(e.text).style(e.style).attr({y:e.baseY}),t},this)},_drawPlotBands:function(t){var e=this.vanchart.renderer,i=this.animation,n=this.getRadiusPlotBands();this.plotBandsGroup||(this.plotBandsGroup=t.append(e.group()),this.plotBands=[]);var r=this.plotBandsGroup,a=this._bindData(this.plotBands,n);a.exit.map(function(t){t.remove()});var o=a.enter.map(function(t){return r.append(e.path()).datum(t)});this.plotBands=o.concat(a.update).map(function(t){var e=t.datum();return t.style("fill",e.color),i?d3.select(t.node()).transition().attr("d",e.path):t.attr("d",e.path),t},this)},_drawTickLabel:function(t){this._drawSvgTickLabel(t)},_drawSvgTickLabel:function(t){var e=this.vanchart.renderer,i=this,n=this.animation,r=i.scale,o=i.lastScale||i.scale,s=i.options,l=i.getTickData().slice(0,-1),h=s.labelStyle,u=s.useHtml;this.tickLabelsGroup||(this.tickLabelsGroup=t.append(e.vgroup()),this.tickLabels=[]);var c=this.tickLabelsGroup,d=this._bindData(this.tickLabels,l,function(t){return t.tickValue});if(d.exit.map(function(t){t.remove()}),s.showLabel){var f=d.enter.map(function(t){return c.append(e.vtext(u).datum(t))});this.tickLabels=f.concat(d.update).map(function(t){var e=t.datum();t.textContent(e.tickContent).style(h);var i=-(e.tickRectDim.width+e.tickDim.width)/2-a(),s=-r(e.tickValue)-(e.tickRectDim.height+e.tickDim.height)/2,l={transform:"translate("+i+" "+s+")",dy:"0.85em"};if(n&&!u){var c=e.labelRotation%360?t.vRotate(e.labelRotation).rotateStr:"";l.transform+=c;var d=-(e.tickRectDim.width+e.tickDim.width)/2-a(),f=-o(e.tickValue)-(e.tickRectDim.height+e.tickDim.height)/2,p={transform:"translate("+d+" "+f+")",dy:"0.85em"};p.transform+=c,d3.select(t.node()).attr(p).transition().attr(l)}else t.attr(l),t.vRotate(e.labelRotation);return t})}}});return o}),i("component/PolarAxis",["require","./Base","../utils/BaseUtils","../Constants","./Axis","./Polar","./AngleAxis","./RadiusAxis","../ComponentLibrary"],function(t){var e=(t("./Base"),t("../utils/BaseUtils")),i=(t("../Constants"),t("./Axis")),n=t("./Polar"),r=t("./AngleAxis"),a=t("./RadiusAxis"),o=t("../ComponentLibrary"),s=i.extend({_refresh:function(){this._axisList=this._axisList||[];var t=this.options;t=e.isArray(t)?t:[t];for(var i=t.length,s=i;s<this._axisList.length;s++)this._axisList[s].remove(),this._axisList[s]=null;this._axisList.length=i;for(var s=i-1;s>=0;s--)if(t[s].axisIndex=s,this._axisList[s]&&this._axisList[s].type!=t[s].type&&(this._axisList[s].remove(),this._axisList[s]=null),this._axisList[s])this._axisList[s].refresh(t[s]);else{var l;if(this.componentType===o.POLAR_COMPONENT)l=n;else{var h=t[s].type||o.VALUE_AXIS_COMPONENT;h==o.VALUE_AXIS_COMPONENT?l=a:h==o.CATEGORY_AXIS_COMPONENT&&(l=r)}this._axisList[s]=new l(t[s],this.componentType,this.vanchart)}},doLayout:function(){for(var t=this._axisList.length,e=t-1;e>=0;e--)this._axisList[e].doLayout()},render:function(){this._axisList.map(function(t){t.componentType===o.POLAR_COMPONENT&&t.render()})},renderSpecial:function(){this._axisList.map(function(t){t.componentType===o.POLAR_COMPONENT&&t.renderSpecial&&t.renderSpecial()})}});return o.register(o.RADIUS_AXIS_COMPONENT,s),o.register(o.ANGLE_AXIS_COMPONENT,s),o.register(o.POLAR_COMPONENT,s),s}),i("component/Title",["require","./Base","../utils/BaseUtils","../Constants","../ComponentLibrary"],function(t){var e,i=t("./Base"),n=t("../utils/BaseUtils"),r=t("../Constants"),a=t("../ComponentLibrary"),o=function(){return null==e&&(e=n.paddingConvertWithScale("0.3125rem")),e},s=i.extend({doLayout:function(){var t=this.options;if(t.text){var e,i=this.vanchart.getPlotBounds(),s=i.width,l=i.height;if(this.isFloat)s-=this._floatX-i.x,l-=this._floatY-i.y;else{var h=this.vanchart.components[a.TOOLBAR_COMPONENT];this.initBarWidth=h&&h.getToolBarInitWidth()||0,s-=this.initBarWidth,"center"===t.align&&(s-=this.initBarWidth)}if(s-=2*o(),l-=2*o(),e=n.getTextDimension(t.text,t.style,t.useHtml),e.width>s){var u=n.clone(t.style);u.width=Math.max(s,0)+"px",e=n.getTextWrapDimension(t.text,u,t.useHtml)}else e.width+=.5;if(e.height=Math.min(this._maxHeight(),l,e.height),this.isFloat)this.bounds={x:this._floatX,y:this._floatY,width:e.width+2*o(),height:e.height+2*o()};else{var c=e.height+2*o();this._setComponentBounds(r.TOP,c)}if(this.isFloat)this.textBounds={x:o(),y:o(),width:e.width,height:e.height};else{var d;switch(t.align){case"right":d=s-e.width;break;case"center":d=this.bounds.width/2-e.width/2;break;case"left":default:d=this.bounds.x+o()}this.textBounds={x:d,y:o(),width:e.width,height:e.height}}if(t.useHtml)this.labels=[],this.labels.push({text:t.text,dim:e,style:t.style});else{var f=n.splitText(t.text,t.style,this.textBounds.width);this.labels=f.map(function(e){return{text:e,dim:n.getTextDimension(e,t.style,t.useHtml),style:t.style}})}}},render:function(){if(!this.textBounds||this.textBounds.width<0||this.textBounds.height<0)return void this.remove();var t=this.vanchart,e=t.renderer;this.titleGroup||(this.titleGroup=e.vgroup().add(),this.titleGroup.divG.style("pointer-events","auto")),this.titleGroup.attr("transform",n.makeTranslate([this.bounds.x,this.bounds.y])),this._innerClip(this.titleGroup),this.drawBackground(this.titleGroup.renderG),this.drawTitle(this.titleGroup)},drawBackground:function(t){var e=this.options,i=this.bounds;e.backgroundColor&&this.vanchart._renderRectangleBackground(t,e,{x:0,y:0,width:i.width,height:i.height})},drawTitle:function(t){this.text&&(this.text.remove(),this.text=null);var e=this.vanchart.renderer,i=this.options,a=this.textBounds,o=i.useHtml,s=i.align,l=e.vtext(o).attr({transform:n.makeTranslate([a.x,a.y]),width:a.width+"px","text-align":s,"white-space":"normal"});this.text=l;var h=o?{}:n.isMS?{dy:"1em"}:{"dominant-baseline":"central",dy:a.height/this.labels.length/2},u=0;this.labels.map(function(t){var i,n=t.dim;switch(s){case r.LEFT:i=0;break;case r.RIGHT:i=a.width-n.width;break;case r.CENTER:default:i=(a.width-n.width)/2}l.append(e.vtspan(o).attr({y:u,x:0,dx:i}).attr(h).textContent(t.text).style(t.style)),u+=n.height}),t.append(l)},remove:function(){this.titleGroup&&this.titleGroup.remove(),this._clip&&this._clip.remove(),this.titleGroup=this._clip=null}});return a.register(a.TITLE_COMPONENT,s),s}),i("component/Geo",["require","./Base","../utils/BaseUtils","../utils/QueryUtils","../Constants","../theme/config","../ComponentLibrary"],function(t){function e(t,e){t&&g.hasOwnProperty(t.type)&&g[t.type](t,e)}function i(t,e){for(var i,n=-1,r=t.length;++n<r;)i=t[n],e.push(i)}function n(t,e){for(var n=-1,r=t.length;++n<r;)i(t[n],e)}function r(t){var e,i;return"string"==typeof t?window.FR&&window.FR.ajax?FR.ajax({type:"GET",url:t,dataType:"json",async:!1,success:function(n){i=t,e=n}}):d3.json(t,function(n){i=t,e=n}):t&&"object"==typeof t&&(e=t),e}var a=t("./Base"),o=t("../utils/BaseUtils"),s=(t("../utils/QueryUtils"),t("../Constants")),l=(t("../theme/config")(),t("../ComponentLibrary")),h={},u="Point",c="LineString",d="MultiLineString",f=function(t,i){t&&p.hasOwnProperty(t.type)?p[t.type](t,i):e(t,i)},p={Feature:function(t,i){e(t.geometry,i)},FeatureCollection:function(t,i){for(var n=t.features,r=-1,a=n.length;++r<a;)e(n[r].geometry,i)}},g={Point:function(t,e){e.push(t.coordinates)},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.push(t)},LineString:function(t,e){i(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)i(n[r],e)},Polygon:function(t,e){n(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,r=-1,a=i.length;++r<a;)n(i[r],e)},GeometryCollection:function(t,i){for(var n=t.geometries,r=-1,a=n.length;++r<a;)e(n[r],i)}},m=a.extend({doLayout:function(){},render:function(){},geoName:function(){return this.options.name},loadGeo:function(){if(!this._loaded||this.options.data!=this._dataUrl){this.vanchart.isDataSame=this.options.data==this.vanchart.lastGeoData,this.vanchart.lastGeoData=this.options.data,this._loaded=!0,this._dataUrl=this.options.data,this.scale=1;var t=this.options,e=this,i=this.vanchart._leaflet;this.maps=[],this._validPointName={},this._validAreaName={},this._extendedLineFeature=[];var n=o.stamp(this.vanchart);if(h[n]=h[n]||{},t.data){var a=o.isArray(t.data)?t.data:[t.data];this.maps=a.map(r),this.imageString=this.imageSuffix=this.imageWidth=this.imageHeight=null,this.maps.length&&(this.imageString=this.maps[0].imageString,this.imageSuffix=this.maps[0].imageSuffix,this.imageWidth=this.maps[0].imageWidth,this.imageHeight=this.maps[0].imageHeight),this.maps.forEach(function(t){for(var i=t.features||[],n=0,r=i.length;r>n;n++){var a=i[n],o=a.geometry;o.type==u?(e._validPointName[a.properties.name]=e._validPointName[a.properties.name]||[],e._validPointName[a.properties.name].push(a)):o.type==c||o.type==d?e._extendedLineFeature.push(a):(e._validAreaName[a.properties.name]=e._validAreaName[a.properties.name]||[],e._validAreaName[a.properties.name].push(a))}})}var s=t.tileLayer||this.vanchart.options.geo.tileLayer,l=t.attribution||this.vanchart.options.geo.attribution||"",f=t.wmsUrl||this.vanchart.options.geo.wmsUrl,p=t.wmsLayer||this.vanchart.options.geo.wmsLayer;if(this.imageString){var g=this.vanchart.width,m=this.vanchart.height,v=g/this.imageWidth,y=m/this.imageHeight;this.scale=Math.min(v,y);var _=this.imageWidth,x=this.imageHeight;_*=this.scale,x*=this.scale,this._scaleGeoJson(this.maps,this.scale);var T=[[0,0],[x,_]],s=this.options.imageUrl||"data:image/"+this.imageSuffix+";base64,"+this.imageString;this._imageBackgroundLayer=L.imageOverlay(s,T).addTo(i)}else s?(this._attribution=h[n][l]||L.control.attribution({position:"bottomright"}).addAttribution(l),h[n][l]=this._attribution,this._tileLayer=h[n][s]||L.tileLayer(s),h[n][s]=this._tileLayer):f?(this._wmsLayer=h[n][f]||L.tileLayer.wms(f,{layers:p.join(",")}),h[n][f]=this._wmsLayer,this._attribution&&this._attribution.remove(),this._attribution=null,this._tileLayer&&this._tileLayer.remove(),this._tileLayer=null,this._imageBackgroundLayer&&i.removeLayer(this._imageBackgroundLayer),this._imageBackgroundLayer=null):(this._attribution&&this._attribution.remove(),this._attribution=null,this._tileLayer&&this._tileLayer.remove(),this._tileLayer=null,this._wmsLayer&&this._wmsLayer.remove(),this._wmsLayer=null,this._imageBackgroundLayer&&i.removeLayer(this._imageBackgroundLayer),this._imageBackgroundLayer=null)}},_scaleGeoJson:function(t,e){t&&t.length&&t.forEach(function(t){for(var i=t.features,n=0,r=i.length;r>n;n++){var a=i[n].properties.center;a&&(a[0]*=e,a[1]*=e)}var o=[];f(t,o);for(var n=0,r=o.length;r>n;n++)o[n][0]*=e,o[n][1]*=e})},getDataPointLngLat:function(t,e){if(e){this.loadGeo();var i=t.series&&t.series.type==s.AREA_MAP?e.properties.center:e.geometry.coordinates;if(!i)if(this._isImageMap()){var n=[],r=this.imageWidth,a=0,o=this.imageHeight,l=0;f(e,n),n.forEach(function(t){r=Math.min(r,t[0]),a=Math.max(a,t[0]),o=Math.min(o,t[1]),l=Math.max(l,t[1])}),i=[(a+r)/2,(l+o)/2]}else{var h=d3.geo.bounds(e),u=(h[0][0]+h[1][0])/2,c=(h[0][1]+h[1][1])/2;i=[u,c]}return i}},_mergeValidProperty:function(t,e){var i={},n={fill:"color","fill-opacity":"opacity",stroke:"borderColor","stroke-width":"borderWidth","stroke-opacity":"borderOpacity"};return e.forEach(function(e){o.hasDefined(t[e])&&(i[n[e]]=t[e])}),i},getMapStyleFromProperties:function(t){return t&&t.properties?this._mergeValidProperty(t.properties,["fill","fill-opacity","stroke","stroke-width","stroke-opacity"]):{}},getZoomListener:function(){return this.options.zoomListener||this.options.zoomLevel},getFeaturesByName:function(t,e){return e==s.AREA_MAP?this._validAreaName[t]:this._validPointName[t]},fitMapBounds:function(){this.loadGeo();var t,e=this.vanchart._leaflet,i=this.options;o.hasDefined(i.zoomListener)?t=i.zoomListener:o.hasDefined(i.zoomLevel)&&(t=i.zoomLevel);var n=i.viewCenter?L.latLng(i.viewCenter[1],i.viewCenter[0]):null;if(!isNaN(+t)&&n)e.setView(n,t);else{if(isNaN(+t))e.fitBounds(this._getFitBounds());else{e.fitBounds(this._getFitBounds(),{animate:!1});var n=e.getCenter();e.setView(n,t)}n&&e.panTo(n)}},_isImageMap:function(){return this.imageString},_getFitBounds:function(){function t(t){var s=t.lnglat;if(s)e=!1;else{var l=i.getFeaturesByName(t.name,t.series.type);s=i.getDataPointLngLat(this,l&&l[0])}s&&(n=Math.min(n,s[0]),r=Math.max(r,s[0]),a=Math.min(a,s[1]),o=Math.max(o,s[1]))}var e=!0,i=this,n=180,r=-180,a=90,o=-90;if(this._isImageMap())n=this.imageWidth*this.scale,r=0,a=this.imageHeight*this.scale,o=0;else{for(var l=this.vanchart.series,h=0,u=l.length;u>h;h++)l[h].visible&&l[h].type!=s.AREA_MAP&&(l[h].type===s.LINE_MAP?l[h].points.forEach(function(e){t(e.from),t(e.to)}):l[h].points.forEach(t));if(e&&this.maps&&this.maps.length){for(var c=this.maps.map(d3.geo.bounds),d=c[0][0],f=c[0][1],h=c.length-1;h>0;h--){var p=c[h];d[0]=Math.min(p[0][0],d[0]),d[1]=Math.min(p[0][1],d[1]),f[0]=Math.max(p[1][0],f[0]),f[1]=Math.max(p[1][1],f[1])}return[[d[1],d[0]],[f[1],f[0]]]}}return[[a,n],[o,r]]}});return l.register(l.GEO_COMPONENT,m),m}),i("component/DrillTools",["require","./Base","../utils/BaseUtils","../utils/ColorUtils","../Constants","../ComponentLibrary"],function(t){var e=t("./Base"),i=t("../utils/BaseUtils"),n=t("../utils/ColorUtils"),r=t("../Constants"),a=t("../ComponentLibrary"),o=.417,s=.583,l=.25,h=.333,u=.1665,c=e.extend({_refresh:function(){this.iconData=[]},doLayout:function(){var t=i.getTextDimension("test",this.options.style);this._setComponentBounds(r.TOP,t.height*(2*u+1))},getBookMarkPath:function(t){var e=this.options.style,n=t.layerIndex,r=i.getTextDimension(t.geo.geoName(),e),a=(0===n?o:s)+l;a=r.height*a+r.width;var c=r.height*h,d=(1+2*u)*r.height,f=[0,0],p=[a,0],g=[a+c,d/2],m=[a,d],v=[0,d];return"M"+f+"L"+p+"L"+g+"L"+m+"L"+v+"Z"},isCurrent:function(t){var e=this.iconData[this.iconData.length-1];return e.series==t.series},textColor:function(t){return this.isCurrent(t)?this.options.currentColor:this.options.style.color},mouseOverColor:function(t){var e;if(!(e=this.options.mouseOverColor)){var i=this.textColor(t),r=n.getRGBAColorArray(i),a=n.rgb2hsb(r[0],r[1],r[2]),o=n.hsb2rgb(a[0],a[1]/2,(a[2]+1)/2);
    e=n.toColor(o,"rgb")}return e},leftPadding:function(t){return 0===t.layerIndex?o:s},calculateExitAnimation:function(t){for(var e=600,i=0,n=t.length;n>i;i++)t[i].time=e,e=Math.max(e-100,0);var r=0;for(i=n-1;i>=0;i--)t[i].time?(t[i].delay=r,r+=200):t[i].delay=0},getMarkPos:function(t){for(var e=0,i=0;i<t.layerIndex;i++)e+=this.getBookMarkLength(this.iconData[i],i);return e},getMarkAnimationStartPos:function(t){var e=t.layerIndex;return 0===e?0:this.getMarkPos(this.iconData[e-1])-this.getBookMarkLength(t,e)},getBookMarkLength:function(t,e){var n=i.getTextDimension(t.geo.geoName(),this.options.style).height,r=i.getTextDimension(t.geo.geoName(),this.options.style).width,a=(0===e?o:s)+l;return r+a*n},render:function(){var t=this,e=t.vanchart,n=e.renderer,r=e.isSupportAnimation(),a={x:0,y:0,width:this.bounds.width,height:this.bounds.height};this.dToolsGroup||(this.dToolsGroup=n.group().add(),this.clip=n.createClip(a),this.shadow=n.createDropShadowFilter(0,0,.15,1),n.clip(this.dToolsGroup,this.clip),this.drillItems=[],n.registerInteractiveTarget(this,this.dToolsGroup),this.vanchart._leaflet&&this.dToolsGroup.style("pointer-events","all")),this.iconData=this.vanchart.layerMap,this.dToolsGroup.attr("transform",i.makeTranslate([this.bounds.x,this.bounds.y])),n.updateClip(this.clip,a);for(var o=this.iconData.length-1;o>=0;o--){var s=this.iconData[o];if(this.drillItems[o]){var l=this.drillItems[o];l.path.attr({d:t.getBookMarkPath(s)}),l.text.style({fill:this.textColor(s)}).textContent(s.geo.geoName())}else s.aniStart=this.getMarkAnimationStartPos(s),s.aniEnd=this.getMarkPos(s),this.drillItems[o]=this._createItem(s)}var h=this.drillItems.splice(this.iconData.length,this.drillItems.length);this.calculateExitAnimation(h);for(var o=0,u=h.length;u>o;o++){var s=h[o];r?d3.select(s.node()).transition().duration(s.time).delay(s.delay).ease("quad-in").attr("transform",i.makeTranslate([s.datum().aniStart,0])).style("opacity",0).remove():s.remove()}this.drillItems.length=this.iconData.length},_createItem:function(t){var e=this,n=e.vanchart,r=n.renderer,a=n.isSupportAnimation(),o=this.options,s=i.getTextDimension(t.geo.geoName(),o.style).height,l=r.group().style({cursor:"pointer"}).datum(t);return l.path=r.path({d:e.getBookMarkPath(t)}).style({fill:o.backgroundColor,filter:"url(#"+i.stamp(this.shadow)+")"}).addTo(l),l.text=r.text().attr({x:e.leftPadding(t)*s,y:u*s,dy:".85em"}).style(o.style).style({fill:this.textColor(t)}).textContent(t.geo.geoName()).addTo(l),a?(l.attr("transform",i.makeTranslate([t.aniStart,0])).addTo(this.dToolsGroup),d3.select(l.node()).transition().duration(500).ease("cubic-out").attr("transform",i.makeTranslate([t.aniEnd,0]))):l.attr("transform",i.makeTranslate([t.aniEnd,0])).addTo(this.dToolsGroup),i.toBack(l.node()),l},_findDrillTarget:function(t){for(var e,i=t.srcEvent,n=i.target||i.srcElement;n;){for(var r=this.drillItems.length-1;r>=0;r--)this.drillItems[r].node()==n&&(e=this.drillItems[r]);if(e||n==this.dToolsGroup.node())break;n=n.parentNode}return e},onTap:function(t){var e=this._findDrillTarget(t);if(e){var n=e.datum();if(this.options.click&&n.drillUpDataPoint){var r=i.getFormatterFunction(this.options.click);r(n.drillUpDataPoint,t.srcEvent)}this.vanchart.drillUp(n)}},onMouseOver:function(t){var e=this._findDrillTarget(t);e&&e.text.style({fill:this.mouseOverColor(e.datum())})},onMouseOut:function(t){var e=this._findDrillTarget(t);e&&e.text.style({fill:this.textColor(e.datum())})},getEvents:function(){return{tap:this.onTap,mouseover:this.onMouseOver,mouseout:this.onMouseOut}},remove:function(){this.dToolsGroup&&this.dToolsGroup.remove(),this.dToolsGroup=null,this.iconData=this.drillItems=[]}});return a.register(a.DRILL_TOOLS,c),c}),i("component/DataSheet",["require","./Base","../utils/BaseUtils","../utils/Formatter","../Constants","./LegendIconFactory","../ComponentLibrary","../utils/BezierEasing"],function(t){var e,i,n=t("./Base"),r=t("../utils/BaseUtils"),a=(t("../utils/Formatter"),t("../Constants")),o=t("./LegendIconFactory"),s=t("../ComponentLibrary"),l=t("../utils/BezierEasing"),h=400,u=l.css.swing,c=function(){return null==e&&(e=r.paddingConvertWithScale("0.25rem")),e},d=function(){return null==i&&(i=r.paddingConvertWithScale("0.125rem")),i},f=18,p={color:"#666666",fontSize:"0.875rem",fontFamily:"Verdana"},g=n.extend({doLayout:function(){this._recordForPlotBounds(a.LEFT,Math.round(this.getSeriesNameLength()))},reCalculateSize:function(){this.doLayout()},updateAxisSizeAndBounds:function(){this.maxCateLineHeight=this.maxSeriesLineHeight=null,this._setComponentBounds(a.BOTTOM,this._calculateLineHeight())},_calculateLineHeight:function(){this.calculateShowText();var t=this._categoryStyle(),e=0,i=r.getTextHeight(this._seriesStyle()),n=r.getTextHeight(this._valueStyle());this.maxCateLineHeight=2*c()+this.maxCateLine*r.getTextHeight(t)+(this.maxCateLine-1)*c(),this.maxSeriesLineHeight=[];for(var a=0,o=this.seriesNames.length;o>a;a++){var s=this.maxSeriesLine[a],l=2*c()+s*i+(s-1)*c(),h=this.maxValueLine[a],u=2*c()+h*n+(h-1)*c();this.maxSeriesLineHeight[a]=Math.max(l,u),e+=this.maxSeriesLineHeight[a]}return this.sheetHeight=Math.ceil(this.maxCateLineHeight+e),this.sheetHeight},calculateShowText:function(){this.maxCateLine=0,this.maxValueLine=[],this.showTextMap=this.showTextMap||{};var t=this.vanchart.xAxis(),e=t._dataDomain,i=t._domain,n=this._categoryStyle(),a=r.getTextHeight(n)+c(),o=this.vanchart.getPlotBounds().width/i.length,s=this;e.forEach(function(t){var e=r.splitText(t,n,o,c());if(s.maxCateLineHeight){var l=Math.min(parseInt(s.maxCateLineHeight/a,10),e.length);e=e.slice(0,l)}-1!=r.indexInArray(i,t)&&(s.maxCateLine=Math.max(s.maxCateLine,e.length)),s.showTextMap[t]=s.showTextMap[t]||{},s.showTextMap[t].categoryArray=e});var l=this._valueStyle(),h=r.getTextHeight(l)+c(),u=this.options.formatter,d=this.vanchart.series;d.forEach(function(t,e){for(var n=t.points,a=0,d=n.length;d>a;a++){var f=n[a],p=f.getTargetValue(),g=f.category,m=f.isNull?"-":s._getTickContent(p,u),v=r.splitText(m,l,o,c());if(s.maxSeriesLineHeight&&s.maxSeriesLineHeight[e]){var y=Math.min(parseInt(s.maxSeriesLineHeight[e]/h,10),v.length);v=v.slice(0,y)}s.showTextMap[g].value=s.showTextMap[g].value||[],s.showTextMap[g].value[e]=s.showTextMap[g].value[e]||{},s.showTextMap[g].value[e].valueArray=v,-1!=r.indexInArray(i,g)&&(s.maxValueLine[e]=Math.max(s.maxValueLine[e]||0,v.length))}})},fixBoundsByPlot:function(){var t=this.vanchart.getPlotBounds(),e=this.vanchart.getComponent(s.X_AXIS_COMPONENT),i=t.y+t.height;e&&e._axisList.length&&e._axisList.forEach(function(t){t.getPosition()==a.BOTTOM&&(i=Math.max(i,t.bounds.y+t.bounds.height))}),this.bounds={x:t.x-this.maxSeriesWidth,y:i,width:this.maxSeriesWidth+t.width,height:this.sheetHeight}},getSeriesNameLength:function(){this.seriesNames=[],this.maxSeriesLine=[],this.seriesIconType=[];var t=this,e=t.vanchart,i=e.series,n=this._seriesStyle(),a=e.getChartBounds().width/4-(f+2*d()),s=0,l=0;return i.forEach(function(e){var i=r.getTextDimension(e.name,n,!1).width+2*c();if(i>a){var h=r.splitText(e.name,n,a,c());t.maxSeriesLine.push(h.length),t.seriesNames.push(h),s=a}else t.maxSeriesLine.push(1),t.seriesNames.push([e.name]),s=Math.max(i,s);var u=t._getLegendType(e);t.seriesIconType.push(u),l=Math.max(l,o.getLegendIconSize(u).width)}),this.maxSeriesWidth=Math.ceil(s+2*d()+l),this.maxSeriesWidth+c()},_categoryStyle:function(){var t=this.vanchart.xAxis();return t?r.convertToREMUseDefault16PX(t.options.labelStyle):p},_seriesStyle:function(){var t=this.vanchart.getComponent(s.LEGEND_COMPONENT);return t?r.convertToREMUseDefault16PX(t.options.style):p},_valueStyle:function(){return r.convertToREMUseDefault16PX(this.options.style)},getTextPadding:function(){return c()},render:function(){if(this.remove(),this.vanchart.series.length){this.calculateShowText();var t=this.vanchart,e=this.bounds,i=t.renderer,n={x:this.maxSeriesWidth,y:0,width:e.width-this.maxSeriesWidth,height:e.height};this.animationClip=i.createClip(n),this.dataSheetGroup=i.group().attr("transform",r.makeTranslate(this.bounds)).add(),this.animationGroup=i.group().addTo(this.dataSheetGroup),i.clip(this.animationGroup,this.animationClip),this._drawBaseTable(),this._drawTableContent()}},_drawBaseTable:function(){var t=this.options,e=this.maxSeriesWidth,i=this.maxCateLineHeight,n=this.vanchart,r=n.renderer,a=this.dataSheetGroup,o=this.bounds.width,s=this.bounds.height,l={fill:"none",stroke:t.borderColor,"stroke-width":t.borderWidth};r.path().attr("d","M"+e+",0L"+o+",0L"+o+" "+s+"L0,"+s+"L0,"+i).style(l).addTo(a);for(var h=0,u=this.seriesNames.length;u>h;h++)r.line().attr("x1",0).attr("y1",i).attr("x2",o).attr("y2",i).style(l).addTo(a),i+=this.maxSeriesLineHeight[h];this._drawSeries()},_drawTableContent:function(){for(var t=this.vanchart,e=t.xAxis(),i=t.renderer,n=e._domain,a=e._dataDomain,o=this.getPlotBounds().width,s=o/n.length,l=-r.indexInArray(a,n[0])*s+this.maxSeriesWidth,c=t.isSupportAnimation()&&r.isSupportSVG(),d={fill:"none",stroke:this.options.borderColor,"stroke-width":this.options.borderWidth},f=0,p=a.length;p>f;f++){var g=this.showTextMap[a[f]],m=l+s*f;this._drawCategory(g,m,s),this._drawValues(g,m,s);var v={x1:m,y1:0,x2:m,y2:this.bounds.height};g._line=g._line||i.line(v).style(d).addTo(this.animationGroup),c?d3.select(g._line.node()).transition().duration(h).ease(u).attr("x1",m).attr("x2",m):g._line.attr(v)}},zoomRefresh:function(){this.calculateShowText(),this._drawTableContent()},_drawCategory:function(t,e,i){var n=t.categoryArray,a=this.vanchart.renderer;t._category=t._category||[];for(var o,s,l=this._categoryStyle(),c=r.getTextHeight(l),d=this.getTextPadding(),f=this._getStartY(n,l,this.maxCateLineHeight),p=this.vanchart.isSupportAnimation()&&r.isSupportSVG(),g=0;g<n.length;g++)o=e+i/2,s=f+(c+d)*g+c/2,t._category[g]=t._category[g]||a.text().attr({"text-anchor":"middle",dy:".32em",x:o,y:s}).style("margin-top","-0.53em").style(l).addTo(this.animationGroup),t._category[g].textContent(n[g]).vMiddle(),p?d3.select(t._category[g].node()).transition().duration(h).ease(u).attr("x",o).attr("y",s):t._category[g].attr("x",o).attr("y",s).vMiddle();for(var g=n.length;g<t._category.length;g++)t._category[g].remove();t._category.length=n.length},_drawValues:function(t,e,i){var n=this.vanchart.renderer,a=this._valueStyle(),o=r.getTextHeight(a),s=this.getTextPadding(),l=this.maxCateLineHeight,c=this.vanchart.isSupportAnimation()&&r.isSupportSVG();if(!t.value){t.value=[];for(var d=0,f=this.vanchart.series.length;f>d;d++)t.value.push({valueArray:[""]})}for(var p,g,m=0;m<t.value.length;m++){var v=t.value[m],y=this.maxSeriesLineHeight[m],_=v.valueArray;v._value=v._value||[];for(var x=l+this._getStartY(_,a,y),d=0;d<_.length;d++)p=e+i/2,g=x+(o+s)*d+o/2,v._value[d]=v._value[d]||n.text().attr({"text-anchor":"middle",dy:".32em",x:p,y:g}).style("margin-top","-0.53em").style(a).addTo(this.animationGroup),v._value[d].textContent(_[d]).vMiddle(),c?d3.select(v._value[d].node()).transition().duration(h).ease(u).attr("x",p).attr("y",g):v._value[d].attr("x",p).attr("y",g).vMiddle();for(var d=_.length;d<v._value.length;d++)v._value[d].remove();v._value.length=_.length,l+=y}},_drawSeries:function(){for(var t=this.vanchart.renderer,e=t.group().addTo(this.dataSheetGroup),i=this.seriesNames,n=this.maxSeriesWidth,a=this.maxCateLineHeight,s=16,l=a,h=this._seriesStyle(),u=r.getTextHeight(h),c=this.getTextPadding(),d=this.vanchart.series,f=(n+s)/2,p=0,g=i.length;g>p;p++){for(var m=i[p],v=this.maxSeriesLineHeight[p],y=l+this._getStartY(m,h,v)+.85*u,_=0;_<m.length;_++)t.text().attr("x",f).attr("text-anchor","middle").attr("y",y+(u+c)*_).textContent(m[_]).style(h).style("margin-top","-1em").addTo(e).vMiddle();var x=this.seriesIconType[p],T=o.getLegendIconSize(x).height;o.hasIcon(x)?t.path().addTo(e).attr("d",o.getLegendIconPath(x)).attr("transform","translate(2,"+((v-T)/2+l)+")").style({fill:d[p].color}):t.image({preserveAspectRatio:"none",x:2,y:(v-T)/2+l,width:12,height:12}).imageContent(x).addTo(e),l+=v}},_getStartY:function(t,e,i){var n=this.getTextPadding(),a=t.length,o=r.getTextHeight(e)*a+(a-1)*n;return(i-o)/2},remove:function(){this.dataSheetGroup&&this.dataSheetGroup.remove(),this.dataSheetGroup=null,this.showTextMap=null}});return s.register(s.DATA_SHEET_COMPONENT,g),g}),i("FullChartTypes",["require","./VanCharts","./VanChart","./Carousel","./chart/Bar","./chart/Pie","./chart/Line","./chart/Radar","./chart/TreeMap","./chart/Bubble","./chart/ForceBubble","./chart/Scatter","./chart/MultiPie","./chart/Gauge","./chart/Map","./chart/Funnel","./chart/WordCloud","./chart/LineMap","./component/Tooltip","./component/Axis","./component/GaugeAxis","./component/Legend","./component/Zoom","./component/ToolBar","./component/IntervalRangeLegend","./component/GradientRangeLegend","./component/Polar","./component/PolarAxis","./component/Title","./component/Geo","./component/DrillTools","./component/DataSheet","./component/TrendLine"],function(t){t("./VanCharts"),t("./VanChart"),t("./Carousel"),t("./chart/Bar"),t("./chart/Pie"),t("./chart/Line"),t("./chart/Radar"),t("./chart/TreeMap"),t("./chart/Bubble"),t("./chart/ForceBubble"),t("./chart/Scatter"),t("./chart/MultiPie"),t("./chart/Gauge"),t("./chart/Map"),t("./chart/Funnel"),t("./chart/WordCloud"),t("./chart/LineMap"),t("./component/Tooltip"),t("./component/Axis"),t("./component/GaugeAxis"),t("./component/Legend"),t("./component/Zoom"),t("./component/ToolBar"),t("./component/IntervalRangeLegend"),t("./component/GradientRangeLegend"),t("./component/Polar"),t("./component/PolarAxis"),t("./component/Title"),t("./component/Geo"),t("./component/DrillTools"),t("./component/DataSheet"),t("./component/TrendLine")});var n=e("VanCharts");return e("./VanChart"),e("./Carousel"),e("./chart/Bar"),e("./chart/Pie"),e("./chart/Line"),e("./chart/Radar"),e("./chart/TreeMap"),e("./chart/Bubble"),e("./chart/ForceBubble"),e("./chart/Scatter"),e("./chart/MultiPie"),e("./chart/Gauge"),e("./chart/Map"),e("./chart/Funnel"),e("./chart/WordCloud"),e("./chart/LineMap"),e("./component/Tooltip"),e("./component/Axis"),e("./component/GaugeAxis"),e("./component/Legend"),e("./component/Zoom"),e("./component/ToolBar"),e("./component/IntervalRangeLegend"),e("./component/GradientRangeLegend"),e("./component/Polar"),e("./component/PolarAxis"),e("./component/Title"),e("./component/Geo"),e("./component/DrillTools"),e("./component/DataSheet"),e("./component/TrendLine"),n});
/**
 * Created by eason on 15/10/19.
 */
/**
 * Created by eason on 15/8/26.
 */
VanChartWrapper = function(options, dom){
    this.options = options;
    this.dom = dom;
    this.chartID = options.chartID;
    this.autoRefreshTime = options.autoRefreshTime || 0;

    this.width = options.width || dom.width();// dom.
    this.height = options.height || dom.height();
    this.sheetIndex = options.sheetIndex || 0;
    this.ecName = options.ecName || '';

    FR.Chart.WebUtils._installChart(this, this.chartID);
};

VanChartWrapper.prototype = {

    constructor:VanChartWrapper,

    inits:function(){

        var options = this.options.chartAttr;

        //domoverflow
        if(options.geo && options.borderWidth){
            this.dom.css("width", this.width - options.borderWidth * 2)
                .css('height', this.height - options.borderWidth * 2);
        }

        VanCharts.initPaddingScale(options.scale);

        this.vanCharts = VanCharts.init(this.dom[0]);

        this.vanCharts.setOptions(options);

        this._autoRefresh();
    },

    resize:function(){
        this.vanCharts.resize();
    },

    clearAll:function(){
        this.vanCharts.clear();
        this.vanCharts = null;
    },

    refresh:function(){

    },

    refreshData:function(options){
        this.vanCharts.setData(options);
    },

    //
    setData:function(options, index){
        this.vanCharts.setData(options, index);
    },

    _autoRefresh:function(){

        if (Array.isArray(this.autoRefreshTime)){
            this._autoMultiRefresh(this.autoRefreshTime);
        }else {
            this._autoSingleRefresh(this.autoRefreshTime || 0);
        }

    },

    _autoSingleRefresh: function (time) {
        if(time < 1){
            return;
        }

        var self = this;

        setInterval(function () {
            var ID = FR.cjkEncode(self.chartID);
            var width = self.width || 0;
            var height = self.height || 0;
            var sheetIndex = self.sheetIndex;
            var ecName = self.ecName;
            if(FR.servletURL) {
                FR.ajax({
                    type: 'GET',
                    url: FR.servletURL + '?op=chartauto',
                    data: {
                        cmd: 'chart_auto_refresh',
                        sessionID: FR.SessionMgr.getSessionID(),
                        chartID: ID,
                        chartWidth: width,
                        chartHeight: height,
                        sheetIndex : sheetIndex,
                        ecName : ecName,
                        __time: new Date().getTime()
                    },
                    dataType: 'json',
                    success: function (chartRelateJS) {
                        var attrList = chartRelateJS.relateChartList;
                        for (var i = 0, len = attrList.length; i < len; i++) {
                            var chartID = FR.Chart.WebUtils._getChartIDAndIndex(attrList[i].id);
                            var chartSet = FR.ChartManager[chartID[0]];
                            if (chartSet && chartSet[chartID[1]]) {
                                var chartAttr = attrList[i].chartAttr;
                                //var animation = attrList[i].animation;
                                chartSet[chartID[1]].setData(chartAttr);
                            }
                        }
                    }
                });
            }

        }, time * 1000);

    },

    _autoMultiRefresh: function (timeList) {
        var count = timeList.length;
        var self = this;
        var time;

        for (var index = 0; index < count; index++){
            time = timeList[index];
            if(time < 1){
                continue;
            }
            this._intervalRequest(self, time, index);
        }
    },

    _intervalRequest: function (self, time, index) {
        setInterval(function () {
            var ID = FR.cjkEncode(self.chartID);
            var width = self.width || 0;
            var height = self.height || 0;
            var sheetIndex = self.sheetIndex;
            var ecName = self.ecName;
            if (FR.servletURL) {
                FR.ajax({
                    type: 'GET',
                    url: FR.servletURL + '?op=chartauto',
                    data: {
                        cmd: 'chart_auto_refresh',
                        sessionID: FR.SessionMgr.getSessionID(),
                        chartID: ID,
                        chartWidth: width,
                        chartHeight: height,
                        sheetIndex: sheetIndex,
                        ecName: ecName,
                        index: index,
                        __time: new Date().getTime()
                    },
                    dataType: 'json',
                    success: function (chartRelateJS) {
                        var attrList = chartRelateJS.relateChartList;
                        for (var i = 0, len = attrList.length; i < len; i++) {
                            var chartID = FR.Chart.WebUtils._getChartIDAndIndex(attrList[i].id);
                            var chartSet = FR.ChartManager[chartID[0]];
                            if (chartSet && chartSet[chartID[1]]) {
                                var chartAttr = attrList[i].chartAttr;
                                //var animation = attrList[i].animation;
                                chartSet[chartID[1]].setData(chartAttr, index);
                            }
                        }
                    }
                });
            }

        }, time * 1000);
    },

    _chartRelated: function (attrList) {
        for (var i = 0; i < attrList.length; i++) {
            var chartID = FR.Chart.WebUtils._getChartIDAndIndex(attrList[i].id);
            var chartSet = FR.ChartManager[chartID[0]];
            if (chartSet && chartSet[chartID[1]]) {
                var chartAttr = attrList[i].chartAttr;
                chartAttr.startLoading = false;
                chartAttr.endLoading = true;
                chartAttr.moreLabel = null;
                chartSet[chartID[1]].refreshData(chartAttr);
            }
        }
    },

    dealChartAjax: function (para) {
        this.vanCharts.startLoading();

        var data =  {
            'sessionID': FR.SessionMgr.getSessionID(),
            'chartID': FR.cjkEncode(this.chartID),
            'chartWidth': this.width || 0,
            'chartHeight': this.height || 0,
            'sheetIndex' : this.sheetIndex,
            'ecName' : this.ecName,
            '__time': new Date().getTime()
        };

        para = para || {};

        for (var w in para) {
            var value = para[w];
            if (w.startWith("$")) {
                w = w.substring(1)
            }
            // %,
            value = FR.encodePrecentPlus(value);
            if (value == undefined) {
                value = null;
            }
            data[w] = value;
        }

        var self = this;

        FR.ajax({
            type: 'GET',
            url: FR.servletURL + '?op=chartlink&cmd=refresh_relate_data',
            data: data,
            dataType: 'json',
            success: function (chartRelateJS) {
                self._chartRelated(chartRelateJS.relateChartList);
            }
        });
    }

};
(function(a){FR.ViewPane=FR.extend(FR.BasePane,{rtype:"view",doAfterCollapse:function(){var b=a(".frozen-center",this.$container);if(b&&b.length>0){FR.layoutFrozen(contentPane.curLGP.$sheet_container,contentPane.curLGP.$sheet_container.offset().top)}}});a.shortcut("view",FR.ViewPane)})(jQuery);
(function(a){FR.AnalysisPane=FR.extend(FR.BasePane,{rtype:"analysis"});a.shortcut("analysis",FR.AnalysisPane)})(jQuery);
(function(a){FR.EditPane=FR.extend(FR.BasePane,{rtype:"edit"});a.shortcut("edit",FR.EditPane)})(jQuery);
(function(a){FR.WritePane=FR.extend(FR.BasePane,{rtype:"write",doAfterCollapse:function(){if(contentPane.curLGP&&contentPane.curLGP.$sheet_container&&contentPane.curLGP.isFrozen()){FR.layoutFrozen(contentPane.curLGP.$sheet_container,contentPane.curLGP.$sheet_container.offset().top)}}});a.shortcut("write",FR.WritePane)})(jQuery);
if(window.FR==null){window.FR={}}if(FR.WE==null){FR.WE={}}$.extend(FR.WE,{expressionStore:function(){var a={};return{getParsedExpression:function(b){return a[b]},setParsedExpression:function(c,b){a[c]=b}}}(),Operators:function(){var b={Add:{ops:["+","-"],priority:10},Multi:{ops:["*","/","%"],priority:20},Power:{ops:["^"],priority:30},Relation:{ops:[">","<","=",">=","<=","==","!=","<>"],priority:5},ConditonOr:{ops:["||"],priority:50},ConditonAnd:{ops:["&&"],priority:60}};var c={getOperators:function(){var e=[];
for(var f in b){$.merge(e,b[f].ops)}return e},getOperatorPriority:function(e){for(var f in b){if($.inArray(e,b[f].ops)!==-1){return b[f].priority}}return null},getTypePriority:function(f){var e=FR.WE.Operators["get"+f+"Priority"];return e()},getTypeOperators:function(f){var e=FR.WE.Operators["get"+f+"Operators"];return e()},getOpsByOrder:function(f){var e=[];for(var g in b){e.push({name:g,priority:b[g].priority})}e.sort(function(h,i){return(h.priority-i.priority)*(f?1:(-1))});return $.map(e,function(h){return h.name
})}};var d=[];for(var a in b){d.push(a)}$.each(d,function(e,f){c["get"+f+"Operators"]=function(){return b[f].ops};c["get"+f+"Priority"]=function(){return b[f].priority}});return c}(),REG:{columnRow:/^[a-zA-Z]+\d+/,columnRow2:/[a-zA-Z]+\d+/g,functionName:/^[a-zA-Z]\w+/,functionName2:/[a-zA-Z]\w+/g,functionName3:/[a-zA-Z]\w+\(/g,parameterName:/^[a-zA-Z]\w+/,parameterName2:/[a-zA-Z]\w+/g},removeSpace:function(f){var a=[];var e=false;var d=null;for(var b=0;b<f.length;b++){var g=f.charAt(b);if(g!=" "){a.push(g)
}if(g=="'"||g=='"'){if(!e){d=g;e=true}else{if(g==d){d=null;e=false}}}else{if(g==" "){if(e){a.push(g)}}}}return a.join("")},findMatchQuote:function(a){if(a==null||(typeof a!="string")){return null}if(a.charAt(0)=="'"){return a.substring(1,a.length).indexOf("'")+1}else{if(a.charAt(0)=='"'){return a.substring(1,a.length).indexOf('"')+1}else{return null}}},findMatchParentheses:function(h){if(h==null||(typeof h!="string")){return null}var f=h.charAt(0);if(f!="("&&f!="["){return null}var d;if(f=="("){d=")"
}else{if(f="["){d="]"}}var a=0;var g=false;var e=null;for(var b=1;b<h.length;b++){var j=h.charAt(b);if(j=="'"||j=='"'){if(!g){g=true;e=j}else{if(g&&j==e){g=false;e=null}}}else{if(g){continue}if(j==f){a++}else{if(j==d){if(a===0&&!g){return b}else{a--}}}}}return null},getInQuoteArea:function(e){if(e==null||typeof e!="string"){return null}var d=[];for(var b=0;b<e.length;b++){var f=e.charAt(b);if(f=="'"||f=='"'){var a=FR.WE.findMatchQuote(e.substring(b,e.length));d.push({from:b,to:b+a});b+=a}}return d
},checkInQuoteArea:function(f,e){if(typeof f!="string"||e==null){return false}var d=false;var a=null;for(var b=0;b<f.length;b++){if(b==e){return d}var g=f.charAt(b);if(g=="'"||g=='"'){if(!d){d=true;a=g}else{if(d&&a==g){d=false;a=null}}}}return false},splitArgs:function(f){var b=[];var e=0;for(var c=0;c<f.length;c++){var d=f.charAt(c);var a;if(d=="'"||d=='"'){a=this.findMatchQuote(f.substring(c,f.length));c+=a}else{if(d=="["||d=="("){a=this.findMatchParentheses(f.substring(c,f.length));c+=a}else{if(d==","){b.push(f.substring(e,c));
e+=c-e+1}}}}b.push(f.substring(e,f.length));return b},getRelatedColumnRow:function(g){var k=[];var h=g.match(FR.WE.REG.columnRow2);if(h!=null){for(var d=0;d<h.length;d++){var e=h[d];var f=g.allIndexOf(e);var a=true;for(var b=0;b<f.length;b++){if(FR.WE.checkInQuoteArea(g,f)){a=false}}if(a){var c=e.toUpperCase();if(k.indexOf(c)===-1){k.push(c)}}}}return k},getFunctionNames:function(g){var e=[];var d=g.match(FR.WE.REG.functionName3);if(d!=null){for(var c=0;c<d.length;c++){var a=d[c];var h=g.allIndexOf(a);
var f=false;for(var b=0;b<h.length;b++){if(!FR.WE.checkInQuoteArea(g,h[c])){f=true;break}}if(f){e.push(a.substring(0,a.length-1))}}}return e},makeArray:function(d,c){var a=[];for(var b=0;b<c;b++){a[b]=d}return a},ERROR_NAME:"#NAME?",ERROR_VALUE:"#VALUE?",ERROR_NAN:"*NUM!",ERROR_NOT_SUPPORT:"#NOTSUPPORT!",isErrorResult:function(a){return a==FR.WE.ERROR_NAME||a==FR.WE.ERROR_VALUE||a==FR.WE.ERROR_NAN||a==FR.WE.ERROR_NOT_SUPPORT},DefaultParas:["$$$","item","$$page_number","$$totalPage_number","$fr_username","$fr_authority","$fr_userposition","NULL","NOFILTER","reportName","servletURL","serverSchema","serverName","serverPort","serverURL","contextPath","sessionID"],Counter:function(){var a=0;
return{getSEQ:function(){return a},setSEQ:function(){a++}}}()});FR.CAL=function(a){this.options=$.extend(this._defaultConfig(),a);window.currentCal=this};$.extend(FR.CAL.prototype,{_defaultConfig:function(){return{lgp:null,relatedCells:{A1:"A1value"},currentCell:{col:0,row:0},parameters:{$$$:"",p1:""}}},parse:function(l){if(l==null||!(typeof l=="string")){return null}var b=this;if(!k(l)){FR.Msg.toast("invalid function");return null}if(l.startWith("=")){l=l.substring(1,l.length)}l=FR.WE.removeSpace(l);
var a=FR.WE.expressionStore.getParsedExpression(l);if(a){function h(o){if(o instanceof FR.AbstractExpression){for(var n=0;n<o.nodes.length;n++){h(o.nodes[n])}}else{if(o instanceof FR.ExpressionNode){if(o.cal){o.cal=b}}else{if(o instanceof FR.FunctionCall){for(var n=0;n<o.args.length;n++){h(o.args[n])}}}}}h(a);return a}var g=l;var e=[];var c=[];while(l.length>0){l=f(l)}var i=new FR.Expression(e,c,b);var m=i.parse();FR.WE.expressionStore.setParsedExpression(g,m);return m;function f(z){var t=z;var q=z.charAt(0);
var J=0;var A=null;if(q=='"'||q=="'"){J=FR.WE.findMatchQuote(z)+1;A=new FR.StringNode(z.substring(0,J))}else{if(q.match(/[0-9]/)||(q.match(/[+-]/)&&z.charAt(1).match(/[0-9]/))){var r=z.match(/^[-+]{0,1}.{0,1}[0-9]+/);if(r==null){FR.Msg.toast("formula error");return}var F=r[0];J=F.length;A=new FR.NumberNode(F)}else{if(q=="$"){var K=z.substring(1,z.length).match(FR.WE.REG.parameterName);var y;if(K){y=K[0];J=y.length+1}else{var I=z.substring(1,z.length).match(/^\$\w+/);if(I){y="$"+I[0];J=y.length}else{var G=z.match(/^\${3}[^\w]+/);
if(G){y=G[0].substring(0,3);J=y.length}else{if(z=="$$$"){y=z;J=y.length}}}}A=new FR.ParameterNode(y,b)}else{if(q=="("){J=FR.WE.findMatchParentheses(z)+1;A=b.parse(z.substring(1,J-1))}else{if(q=="["){J=FR.WE.findMatchParentheses(z)+1;A=new FR.ArrayNode(z.substring(1,J-1),b)}else{if(j(z)){var p=z.match(FR.WE.REG.columnRow);var n=p[0];J=n.length;A=new FR.ColumnRowNode(n,b)}else{if(d(z)){var H=z.match(FR.WE.REG.functionName);var u=H[0];J=u.length+FR.WE.findMatchParentheses(z.substring(u.length,z.length))+1;
var v=z.substring(u.length+1,J-1);var E=FR.WE.splitArgs(v);var o=[];for(var C=0;C<E.length;C++){o.push(b.parse(E[C]))}A=new FR.FunctionCall(u,o,b)}else{var x=z.match(/\w+/);var B=x[0];J=B.length;var D=B.toUpperCase();if(D=="TRUE"||D=="FALSE"){A=new FR.BooleanNode(B)}else{if(FR.WE.DefaultParas.indexOf(B)!==-1){A=new FR.ParameterNode(B,b)}else{}}}}}}}}}z=z.substring(J,z.length);if(A!=null){c.push(A)}if(z!=""){var w=FR.WE.Operators.getOperators();var s=null;if($.inArray(z.substring(0,2),w)!==-1){s=z.substring(0,2)
}else{if($.inArray(z.substring(0,1),w)!==-1){s=z.substring(0,1)}}if(s!=null){z=z.substring(s.length,z.length);e.push(s)}}if(z==t){FR.Msg.toast("Parse Error");return""}return z}function j(o){var n=o.match(FR.WE.REG.columnRow);if(n!=null&&n[0]!=null){if(o.indexOf(n)===0&&$.inArray(o.charAt(n.length),FR.WE.Operators.getOperators())){return true}}return false}function d(n){if(n.indexOf("(")!==-1){if(n.substring(0,n.indexOf("(")).match(FR.WE.REG.functionName)){return true}}return false}function k(n){if(n==null||typeof n!="string"){return false
}return true}},eval:function(str){if(typeof str=="string"){var exp=this.parse(str);return exp==null?null:exp.eval()}else{if(str instanceof FR.Expression||str instanceof FR.ExpressionNode||str instanceof FR.AbstractExpression||str instanceof FR.FunctionCall){return str.eval()}else{return str}}},getParameter:function(b){if(typeof b!="string"){return null}var a=this.options.parameters[b];if(a!=null){return a}if(this.options.lgp!=null){return this.options.lgp.writePane.parameters[b.toUpperCase()]}},getColumnRowValue:function(a){var b=this.options.relatedCells[a];
if(b!=null){return b}if(this.options.lgp!=null){return this.options.lgp.getCellValue(0,0)}},setParameter:function(a,b){this.options.parameters[a]=b},setColumnRowValue:function(a,b){var c;if(typeof a=="string"){c=a.toUpperCase()}else{if(a.row){c=FR.columnRow2CellStr(a)}else{c=a+""}}this.options.relatedCells[c]=b},setCurrentCellValue:function(a){this.options.parameter.$$$=a},getCurrentCell:function(){return this.options.currentCell}});FR.Expression=function(d,b,a){if(d==null||!$.isArray(d)||!$.isArray(b)){return
}var n=FR.WE.Operators.getOpsByOrder(false);var e=null;if(d.length>0){for(var m=0;m<n.length;m++){for(var h=0;h<d.length;h++){var o=FR.WE.Operators.getTypePriority(n[m]);if(FR.WE.Operators.getOperatorPriority(d[h])==o){var g=[];var c=[];g.push(b[h]);g.push(b[h+1]);c.push(d[h]);for(var f=h+1;f<d.length;f++){if(FR.WE.Operators.getOperatorPriority(d[f])==o){g.push(b[f+1]);c.push(d[f])}else{break}}var l=FR[n[m]+"Expression"];if(l!=null){e=new l(c,g,a);d.splice(h,c.length);b.splice(h,c.length+1,e)}}}}}else{if(b.length>0){e=b[0]
}}this.parsedExp=e};$.extend(FR.Expression.prototype,{parse:function(){return this.parsedExp},eval:function(){var val;if($.isFunction(this.parsedExp.eval)){val=this.parsedExp.eval()}return val}});FR.ExpressionNode=function(b,a){this.str=b;this.cal=a};$.extend(FR.ExpressionNode.prototype,{getValue:function(){return null},eval:function(){return this.getValue()}});FR.NumberNode=FR.extend(FR.ExpressionNode,{getValue:function(){return FR.object2Number(this.str)}});FR.StringNode=FR.extend(FR.ExpressionNode,{getValue:function(){var b=this.str,a=null;
if(typeof b=="string"){if((b.startWith("'")&&b.endWith("'"))||(b.startWith('"')&&b.endWith('"'))){a=b.substring(1,b.length-1)}else{a=b}}else{a=b+""}return a}});FR.ParameterNode=FR.extend(FR.ExpressionNode,{getValue:function(){var a=this.str;var b=this.cal;if(b==null){return null}var c=b.getParameter(a);if(c!=null){return c}c=b.getServerParameter(a);return c}});FR.ColumnRowNode=FR.extend(FR.ExpressionNode,{getValue:function(){var a=this.str;if(typeof a!="string"){return null}else{a=a.toUpperCase()
}var b=this.cal;if(b==null){return null}return b.getColumnRowValue(a)}});FR.ArrayNode=FR.extend(FR.ExpressionNode,{getValue:function(){var arr;arr=FR.WE.splitArgs(this.str);for(var i=0;i<arr.length;i++){arr[i]=this.cal.eval(arr[i])}return arr}});FR.BooleanNode=FR.extend(FR.ExpressionNode,{getValue:function(){return this.str.toUpperCase()=="TRUE"}});FR.AbstractExpression=function(b,a,c){this.ops=b;this.nodes=a;this.cal=c;this.nodeResult=[]};$.extend(FR.AbstractExpression.prototype,{eval:function(){if(!$.isArray(this.ops)||!$.isArray(this.nodes)||this.ops.length+1!=this.nodes.length){return FR.WE.ERROR_NAME
}for(var i=0;i<this.nodes.length;i++){var val;if(this.nodes[i] instanceof FR.AbstractExpression){val=this.nodes[i].eval()}else{if(this.nodes[i] instanceof FR.ExpressionNode){val=this.nodes[i].eval()}else{if(this.nodes[i] instanceof FR.FunctionCall){val=this.nodes[i].eval()}else{val=this.nodes[i]}}}if(FR.WE.isErrorResult(val)){return val}this.nodeResult[i]=val}return this.evalTerminal()},evalTerminal:function(){return eval(this.makeString())},makeString:function(){var b=this.wrapResult(this.nodeResult[0]);
for(var a=0;a<this.ops.length;a++){b+=this.wrapOp(this.ops[a])+this.wrapResult(this.nodeResult[a+1])}return b},wrapResult:function(a){if(typeof a=="string"){if((a.startWith("'")&&a.endWith("'"))||(a.startWith('"')&&a.endWith('"'))){return a}else{if(a.indexOf('"')===-1){return'"'+a+'"'}else{return"'"+a+"'"}}}else{if(typeof a=="number"&&a<0){return"("+a+")"}else{return a+""}}},wrapOp:function(a){return a},getType:function(){return"Add"},getPriority:function(){return FR.WE.Operators.getTypePriority(this.getType())
},getOperators:function(){return FR.WE.Operators.getTypeOperators(this.getType())}});FR.AddExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"Add"}});FR.MultiExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"Multi"}});FR.PowerExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"Power"},evalTerminal:function(){var a=this.nodeResult[0];for(var b=0;b<this.ops.length;b++){a=Math.pow(a,this.nodeResult[b+1])}return a}});FR.RelationExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"Relation"
},wrapOp:function(a){if(a=="="){return"=="}else{return a}}});FR.ConditionalOrExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"ConditionOr"}});FR.ConditionalAndExpression=FR.extend(FR.AbstractExpression,{getType:function(){return"ConditionAdd"}});FR.FunctionCall=function(c,b,d){if(typeof c!="string"){c=c+""}if(!$.isArray(b)){var a=[];a.push(b);b=a}this.name=c.toUpperCase();this.args=b;this.cal=d};$.extend(FR.FunctionCall.prototype,{eval:function(){var fn=FR.FUN[this.name];if(fn==null){return FR.WE.ERROR_NOT_SUPPORT
}var holds=this.holdArgsFunctions;var shouldCalArgs=holds.indexOf(this.name)===-1;var argResults=[];var cal=this.cal||new FR.CAL();for(var i=0;i<this.args.length;i++){if(shouldCalArgs){var value=cal.eval(this.args[i]);if(FR.WE.isErrorResult(value)){return value}if(this.args[i] instanceof FR.ColumnRowNode&&$.isArray(value)){for(var j=0;j<value.length;j++){var sub=value[j];if($.isArray(sub)){argResults.concat(sub)}else{argResults.push(sub)}}}else{argResults.push(value)}}else{argResults.push(this.args[i])
}}if(!shouldCalArgs){argResults.push(cal)}return fn(argResults)},holdArgsFunctions:function(){return["GREPARRAY","MAPARRAY","IF","OR","AND","SWITCH"]}()});
;
(function ($) {
    $.extend(FR.Report.Plugin.Fit, {

        extendPara: function (para, contentPane) {
            var isIE8 = FR.Browser.isIE8Before();
            var documentHeight = isIE8 ? $(window.document).height() : $(window).height();
            var toolBar = $('.x-toolbar');
            var sheetToolBar = $('.fr-tabpane-controlbuttons');
            var extraHeight = 0;
            for (var i = 0; i < toolBar.length; i++) {
                extraHeight += $(toolBar[i]).height();
            }
            //heightsougou1px
            for (var i = 0; i < sheetToolBar.length; i++) {
                extraHeight += $(sheetToolBar[i]).height() + 1;
            }
            extraHeight += $('.parameter-container').height();

            documentHeight -= extraHeight;
            $.extend(para, {
                __webpage__: true,
                _paperWidth: isIE8 ? $(window.document).width() : $(window).width(),
                _paperHeight: documentHeight,
                __fit__: contentPane.__fit__
            });
        }
    });

    if(FR.Form) {
        FR.Form.getFitConfigFromServer = function (contenConfig) {
            if (contenConfig.__FIT__) {
                var sessionID = contenConfig.widgetUrl.getQuery('sessionID');
                var isIE8 = FR.Browser.isIE8Before();
                FR.ajax({
                    url: FR.servletURL,
                    data: {
                        op: 'fr_form',
                        cmd: 'fit_config',
                        sessionID: sessionID,
                        _: new Date().getTime(),
                        _PAPERWIDTH: isIE8 ? $(window.document).width() : $(window).width(),
                        _PAPERHEIGHT: isIE8 ? $(window.document).height() : $(window).height(),
                        _SHOWPARA: $('.parameter-container-collapseimg-down').length === 0
                    },
                    async: false,
                    complete: function (res, status) {
                        if (status == 'success') {
                            contenConfig = FR.jsonDecode(res.responseText);
                        }
                    }
                })
            }

            return contenConfig;
        };
        FR.Form.bindFitResize = function (form, noBindResize) {
            if (noBindResize) {
                return;
            }
            $(window).load(function () {
                form.oriWidth = $(window).width();
                form.oriHeight = $(window).height();

            });
            $(window).resize(function () {
                //firefox fstabresize,
                var width = $(window).width();
                var height = $(window).height();
                if (form.oriWidth === width && form.oriHeight === height) {
                    return;
                }
                form.oriWidth = width;
                form.oriHeight = height;
                form.loadContentPane(true);
            });
        };
    }
})(jQuery);